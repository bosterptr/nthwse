<html><head>
    <title>0xPat blog – Red/purple teamer</title>

        <meta charset="utf-8">
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

    
    <meta name="description" content="Red/purple teamer">
    <meta property="og:description" content="Red/purple teamer">
    
    <meta name="author" content="0xPat blog">

    

    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="stylesheet" type="text/css" href="/style.css">
    <link rel="alternate" type="application/rss+xml" title="0xPat blog - Red/purple teamer" href="/feed.xml">

  </head>

  <body>
    <div class="wrapper-masthead">
      <div class="container">
        <header class="masthead clearfix">
          
          <div class="site-info">
            <h1 class="site-name"><a href="/">0xPat blog</a></h1>
            <p class="site-description">Red/purple teamer</p>
          </div>

          <nav>
            <a href="/">Blog</a>
            <a href="/about">About</a>
          </nav>
        </header>
      </div>
    </div>

    <div id="main" role="main" class="container">
      <div class="posts">
  
    <article class="post">

      <h1><a href="/Vuln_discovery_Java/">Vulnerability discovery in Java applications</a></h1>

      <div class="entry">
        <h2 id="intro">Intro</h2>
<p>Something different this time. This post is based on a speech I’m giving on June 24th at <a href="https://yavaconf.com">Ya!vaConf</a> in Poland. So, we will analyze WebGoat application which is written in Java to discover some vulnerabilities in the source code and then write an exploit using Python.</p>


      </div>

      <a href="/Vuln_discovery_Java/" class="read-more">Read More</a>
      <br><br><br>
    </article>
  
    <article class="post">

      <h1><a href="/Malware_development_part_9/">Malware development part 9 - hosting CLR and managed code injection</a></h1>

      <div class="entry">
        <h2 id="introduction">Introduction</h2>
<p>This is the 9th post of a series which regards the development of malicious software. In this series we will explore and try to implement multiple techniques used by malicious applications to execute code, hide from defenses and persist.<br>
Today we explore techniques for executing managed code from a native code.</p>


      </div>

      <a href="/Malware_development_part_9/" class="read-more">Read More</a>
      <br><br><br>
    </article>
  
    <article class="post">

      <h1><a href="/Malware_development_part_8/">Malware development part 8 - COFF injection and in-memory execution</a></h1>

      <div class="entry">
        <h2 id="introduction">Introduction</h2>
<p>This is the eigth post of a series which regards the development of malicious software. In this series we will explore and try to implement multiple techniques used by malicious applications to execute code, hide from defenses and persist.<br>
This time we will implement a COFF object file loader, which is similar to <a href="https://www.cobaltstrike.com/help-beacon-object-files">BOF (beacon object file) feature of Cobalt Strike</a>. This has been also tackled by <a href="https://www.trustedsec.com/blog/coffloader-building-your-own-in-memory-loader-or-how-to-run-bofs/">TrustedSec</a>.</p>


      </div>

      <a href="/Malware_development_part_8/" class="read-more">Read More</a>
      <br><br><br>
    </article>
  
    <article class="post">

      <h1><a href="/Malware_development_part_7/">Malware development part 7 - Secure Desktop keylogger</a></h1>

      <div class="entry">
        <h2 id="introduction">Introduction</h2>
<p>This is the seventh post of a series which regards the development of malicious software. In this series we will explore and try to implement multiple techniques used by malicious applications to execute code, hide from defenses and persist.<br>
Today we will talk about “Secure Desktop” on Windows and implement a keylogger.</p>


      </div>

      <a href="/Malware_development_part_7/" class="read-more">Read More</a>
      <br><br><br>
    </article>
  
    <article class="post">

      <h1><a href="/Malware_development_part_6/">Malware development part 6 - advanced obfuscation with LLVM and template metaprogramming</a></h1>

      <div class="entry">
        <h2 id="introduction">Introduction</h2>
<p>This is the sixth post of a series which regards the development of malicious software. In this series we will explore and try to implement multiple techniques used by malicious applications to execute code, hide from defenses and persist.<br>
Today we will explore anti-disassembly obfuscation using LLVM and template metaprogramming.</p>


      </div>

      <a href="/Malware_development_part_6/" class="read-more">Read More</a>
      <br><br><br>
    </article>
  
    <article class="post">

      <h1><a href="/Malware_development_part_5/">Malware development part 5 - tips &amp; tricks</a></h1>

      <div class="entry">
        <h2 id="introduction">Introduction</h2>
<p>This is the fifth post of a series which regards the development of malicious software. In this series we will explore and try to implement multiple techniques used by malicious applications to execute code, hide from defenses and persist.<br>
In the previous posts we explored anti-VM, anti-sandbox, anti-debugging and anti-static-analysis methods.<br>
In this post we’ll explore some cool tricks to further obscure our code like parent PID spoofing, process protection, environmental keying and bruteforce decryption of malware data and configuration. So this will be a mix of some cool features I’ve been implementing recently.</p>


      </div>

      <a href="/Malware_development_part_5/" class="read-more">Read More</a>
      <br><br><br>
    </article>
  
    <article class="post">

      <h1><a href="/Malware_development_part_4/">Malware development part 4 - anti static analysis tricks</a></h1>

      <div class="entry">
        <h2 id="introduction">Introduction</h2>
<p>This is the fourth post of a series which regards the development of malicious software. In this series we will explore and try to implement multiple techniques used by malicious applications to execute code, hide from defenses and persist.<br>
In the previous part of the series we discussed methods for detecting sandboxes, virtual machines, automated analysis and making manual debugging harder for an analyst.<br>
In this post we will talk more about compiling and linking the code with Visual Studio. Then we will focus on static analysis and obfuscation.</p>


      </div>

      <a href="/Malware_development_part_4/" class="read-more">Read More</a>
      <br><br><br>
    </article>
  
    <article class="post">

      <h1><a href="/Malware_development_part_3/">Malware development part 3 - anti-debugging</a></h1>

      <div class="entry">
        <h2 id="introduction">Introduction</h2>
<p>This is the third post of a series which regards development of malicious software. In this series we will explore and try to implement multiple techniques used by malicious applications to execute code, hide from defenses and persist.<br>
In the previous part of the series we discussed methods for detecting sandboxes, virtual machines and automated analysis.<br>
This time let’s see how the application can detect that it’s being debugged or inspected by an analyst.</p>


      </div>

      <a href="/Malware_development_part_3/" class="read-more">Read More</a>
      <br><br><br>
    </article>
  
    <article class="post">

      <h1><a href="/Malware_development_part_2/">Malware development part 2 - anti dynamic analysis &amp; sandboxes</a></h1>

      <div class="entry">
        <h2 id="introduction">Introduction</h2>
<p>This is the second post of a series which regards development of malicious software. In this series we will explore and try to implement multiple techniques used by malicious applications to execute code, hide from defenses and persist.<br>
Previously, we’ve created basic Metasploit shellcode launcher in C++ and explored basic techniques which helped to lower detection rate of the compiled executable - payload encoding/encryption, binary signing with custom code-signing certificate and switching to x64 architecture.<br>
Now let’s dive deep into dynamic analysis and how to defend against it.</p>


      </div>

      <a href="/Malware_development_part_2/" class="read-more">Read More</a>
      <br><br><br>
    </article>
  
    <article class="post">

      <h1><a href="/Malware_development_part_1/">Malware development part 1 - basics</a></h1>

      <div class="entry">
        <h2 id="introduction">Introduction</h2>
<p>This is the first post of a series which regards development of malicious software. In this series we will explore and try to implement multiple techniques used by malicious applications to execute code, hide from defenses and persist.<br>
Let’s create a C++  application that will run malicious shellcode while trying to not be caught by AV software.<br>
Why C++ and not C# or PowerShell script? Because it’s much more difficult to analyze compiled binary when compared to managed code or script.<br>
For the purpose of this and following articles we will use MS Visual Studio 2017 or 2019 on Windows 10.</p>


      </div>

      <a href="/Malware_development_part_1/" class="read-more">Read More</a>
      <br><br><br>
    </article>
  
    <article class="post">

      <h1><a href="/Abusing_COM_Objects/">Abusing COM objects</a></h1>

      <div class="entry">
        <h2 id="quick-introduction">Quick introduction</h2>
<p>Component Object Model is a Windows binary interface for inter-process communication. Communication is performed in a form of client-server interaction - a client can call methods provided by a COM object (acting as a server) by referencing the COM object by pointer or reference.<br>
Applications can implement COM interface in multiple ways - the bottom line is that the binary (compiled) object must provide methods for other processes to interact with. Such methods can be used for anything - for example, MS Office applications serve interfaces (APIs) for document creation, manipulation etc.<br>
COM classes can be identified by CLSID or name. COM object is of course an instance of specific COM class.</p>


      </div>

      <a href="/Abusing_COM_Objects/" class="read-more">Read More</a>
      <br><br><br>
    </article>
  
</div>

    </div>

    <div class="wrapper-footer">
      <div class="container">
        <footer class="footer">
          



<a href="https://github.com/0xPat"><i class="svg-icon github"></i></a>

<a href="https://www.linkedin.com/in/patryk-czeczko"><i class="svg-icon linkedin"></i></a>


<a href="https://www.twitter.com/0xPat"><i class="svg-icon twitter"></i></a>



        </footer>
      </div>
    </div>

    

  

</body></html>