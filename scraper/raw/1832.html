<html lang="en" data-rh="lang"><head><title>DYLD — Do You Like Death? (I) | Medium</title><meta data-rh="true" charset="utf-8"><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"><meta data-rh="true" name="theme-color" content="#000000"><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"><meta data-rh="true" property="al:ios:app_name" content="Medium"><meta data-rh="true" property="al:ios:app_store_id" content="828256236"><meta data-rh="true" property="al:android:package" content="com.medium.reader"><meta data-rh="true" property="fb:app_id" content="542599432471018"><meta data-rh="true" property="og:site_name" content="Medium"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-02-08T15:03:28.184Z"><meta data-rh="true" name="title" content="DYLD — Do You Like Death? (I) | Medium"><meta data-rh="true" property="og:title" content="DYLD — Do You Like Death? (I)"><meta data-rh="true" property="al:android:url" content="medium://p/8199faad040e"><meta data-rh="true" property="al:ios:url" content="medium://p/8199faad040e"><meta data-rh="true" property="al:android:app_name" content="Medium"><meta data-rh="true" name="description" content="The lifecycle of a Dynamic Loader from its creation to its termination. Debugging Dyld and analysing its source code from the start () to handleDyldInCache()."><meta data-rh="true" property="og:description" content="The lifecycle of a Dynamic Loader from its creation to its termination."><meta data-rh="true" property="og:url" content="https://karol-mazurek.medium.com/dyld-do-you-like-death-i-8199faad040e"><meta data-rh="true" property="al:web:url" content="https://karol-mazurek.medium.com/dyld-do-you-like-death-i-8199faad040e"><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/da:true/resize:fit:1200/0*eC65dt7XWcdWafVu"><meta data-rh="true" property="article:author" content="https://karol-mazurek.medium.com"><meta data-rh="true" name="author" content="Karol Mazurek"><meta data-rh="true" name="robots" content="index,follow,max-image-preview:large"><meta data-rh="true" name="referrer" content="unsafe-url"><meta data-rh="true" property="twitter:title" content="DYLD — Do You Like Death? (I)"><meta data-rh="true" name="twitter:site" content="@Medium"><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/8199faad040e"><meta data-rh="true" property="twitter:description" content="The lifecycle of a Dynamic Loader from its creation to its termination."><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/da:true/resize:fit:1200/0*eC65dt7XWcdWafVu"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="twitter:label1" content="Reading time"><meta data-rh="true" name="twitter:data1" content="8 min read"><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/1*m-R_BkNf1Qjr1YbyOIJY2w.png"><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:152:152/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:120:120/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:76:76/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:60:60/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/Medium-Avatar-500x500.svg" color="#171717"><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossorigin=""><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"><link data-rh="true" rel="author" href="https://karol-mazurek.medium.com"><link data-rh="true" rel="canonical" href="https://karol-mazurek.medium.com/dyld-do-you-like-death-i-8199faad040e"><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/8199faad040e"><style type="text/css" data-fela-rehydration="429" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="429" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-webkit-keyframes k1{0%{transform:translate(-50%, -100px)}100%{transform:translate(-50%, 0)}}@-moz-keyframes k1{0%{transform:translate(-50%, -100px)}100%{transform:translate(-50%, 0)}}@keyframes k1{0%{transform:translate(-50%, -100px)}100%{transform:translate(-50%, 0)}}</style><style type="text/css" data-fela-rehydration="429" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{margin-left:16px}.av{border:none}.aw{border-radius:20px}.ax{width:240px}.ay{background:#F9F9F9}.az path{fill:#6B6B6B}.bb{outline:none}.bc{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bd{font-size:14px}.be{width:100%}.bf{padding:10px 20px 10px 0}.bg{background-color:transparent}.bh{color:#242424}.bi::placeholder{color:#6B6B6B}.bj{display:inline-block}.bk{margin-left:12px}.bl{margin-right:12px}.bm{border-radius:4px}.bn{margin-left:24px}.bo{height:24px}.bu{background-color:#F9F9F9}.bv{border-radius:50%}.bw{height:32px}.bx{width:32px}.by{justify-content:center}.ce{max-width:680px}.cf{min-width:0}.cg{animation:k1 1.2s ease-in-out infinite}.ch{height:100vh}.ci{margin-bottom:16px}.cj{margin-top:48px}.ck{align-items:flex-start}.cl{flex-direction:column}.cm{justify-content:space-between}.cn{margin-bottom:24px}.ct{width:80%}.cu{background-color:#F2F2F2}.da{height:44px}.db{width:44px}.dc{margin:auto 0}.dd{margin-bottom:4px}.de{height:16px}.df{width:120px}.dg{width:80px}.dm{margin-bottom:8px}.dn{width:96%}.do{width:98%}.dp{width:81%}.dq{margin-left:8px}.dr{color:#6B6B6B}.ds{font-size:13px}.dt{height:100%}.el{color:#FFFFFF}.em{fill:#FFFFFF}.eo{background:#1A8917}.ep{border-color:#1A8917}.et:disabled{cursor:inherit !important}.eu:disabled{opacity:0.3}.ev:disabled:hover{background:#1A8917}.ew:disabled:hover{border-color:#1A8917}.ex{border-radius:99em}.ey{border-width:1px}.ez{border-style:solid}.fa{box-sizing:border-box}.fb{text-decoration:none}.fc{text-align:center}.ff{margin-right:32px}.fg{position:relative}.fh{fill:#6B6B6B}.fk{background:transparent}.fl svg{margin-left:4px}.fm svg{fill:#6B6B6B}.fo{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fp{position:absolute}.fr{display:none}.fx{margin:0 24px}.gb{background:rgba(255, 255, 255, 1)}.gc{border:1px solid #F2F2F2}.gd{box-shadow:0 1px 4px #F2F2F2}.ge{max-height:100vh}.gf{overflow-y:auto}.gg{left:0}.gh{top:calc(100vh + 100px)}.gi{bottom:calc(100vh + 100px)}.gj{width:10px}.gk{pointer-events:none}.gl{word-break:break-word}.gm{word-wrap:break-word}.gn:after{display:block}.go:after{content:""}.gp:after{clear:both}.gq{clear:both}.gr{margin-top:0px}.gs{max-width:100%}.gt{height:auto}.gz{margin-right:4px}.ha{margin-top:2px}.hb{box-sizing:content-box}.hc{line-height:1.23}.hd{letter-spacing:0}.he{font-style:normal}.hf{font-weight:700}.ia{@media all and (max-width: 551.98px):8px}.ib{@media all and (min-width: 552px) and (max-width: 727.98px):8px}.ic{@media all and (min-width: 728px) and (max-width: 903.98px):16px}.id{@media all and (min-width: 904px) and (max-width: 1079.98px):16px}.ie{@media all and (min-width: 1080px):16px}.ik{align-items:baseline}.il{width:48px}.im{height:48px}.in{border:2px solid rgba(255, 255, 255, 1)}.io{z-index:0}.ip{box-shadow:none}.iq{border:1px solid rgba(0, 0, 0, 0.05)}.ir{margin-bottom:2px}.is{flex-wrap:nowrap}.it{font-size:16px}.iu{line-height:24px}.iw{margin:0 8px}.ix{display:inline}.iy{color:#1A8917}.iz{fill:#1A8917}.jc{flex:0 0 auto}.jf{flex-wrap:wrap}.jg{padding-left:8px}.jh{padding-right:8px}.ki> *{flex-shrink:0}.kj{overflow-x:scroll}.kk::-webkit-scrollbar{display:none}.kl{scrollbar-width:none}.km{-ms-overflow-style:none}.kn{width:74px}.ko{flex-direction:row}.kp{z-index:2}.ks{-webkit-user-select:none}.kt{border:0}.ku{fill:rgba(117, 117, 117, 1)}.kx{outline:0}.ky{user-select:none}.kz> svg{pointer-events:none}.li{cursor:progress}.lj{opacity:1}.lk{padding:4px 0}.ln{width:16px}.lp{display:inline-flex}.lv{padding:8px 2px}.lw svg{color:#6B6B6B}.mn{line-height:1.58}.mo{letter-spacing:-0.004em}.mp{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.nk{margin-bottom:-0.46em}.nl{border-top:none}.nr{height:52px}.ns{max-height:52px}.nt{position:static}.nu{z-index:1}.nw{max-width:155px}.oc{margin-right:20px}.oi{align-items:flex-end}.oj{width:76px}.ok{height:76px}.ol{border:2px solid #F9F9F9}.om{height:72px}.on{width:72px}.oo{padding:8px 16px}.op{width:auto}.oq{stroke:#F2F2F2}.or{height:36px}.os{width:36px}.ot{color:#F2F2F2}.ou{fill:#F2F2F2}.ov{background:#F2F2F2}.ow{border-color:#F2F2F2}.pc{font-weight:500}.pd{font-size:24px}.pe{line-height:30px}.pf{letter-spacing:-0.016em}.pg{margin-top:8px}.ph{margin-top:16px}.pi{height:0px}.pj{border-bottom:solid 1px #E5E5E5}.pk{margin-top:72px}.pl{padding:24px 0}.pm{margin-bottom:0px}.pn{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.eq:hover{background:#156D12}.er:hover{border-color:#156D12}.es:hover{cursor:pointer}.fi:hover{color:#242424}.fj:hover{fill:#242424}.fn:hover svg{fill:#242424}.fq:hover{background-color:rgba(0, 0, 0, 0.1)}.iv:hover{text-decoration:underline}.ja:hover:not(:disabled){color:#156D12}.jb:hover:not(:disabled){fill:#156D12}.kw:hover{fill:rgba(8, 8, 8, 1)}.ll:hover{fill:#000000}.lm:hover p{color:#000000}.lo:hover{color:#000000}.lx:hover svg{color:#000000}.ox:hover{background:#F2F2F2}.oy:hover{border-color:#F2F2F2}.oz:hover{cursor:wait}.pa:hover{color:#F2F2F2}.pb:hover{fill:#F2F2F2}.ba:focus-within path{fill:#242424}.kv:focus{fill:rgba(8, 8, 8, 1)}.ly:focus svg{color:#000000}.la:active{border-style:none}</style><style type="text/css" data-fela-rehydration="429" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bt{width:64px}.cd{margin:0 64px}.cs{height:48px}.cz{margin-bottom:52px}.dl{margin-bottom:48px}.ec{font-size:14px}.ed{line-height:20px}.ej{font-size:13px}.ek{padding:5px 12px}.fe{display:flex}.fw{margin-bottom:68px}.ga{max-width:680px}.gy{margin-top:40px}.hw{font-size:42px}.hx{margin-bottom:32px}.hy{line-height:52px}.hz{letter-spacing:-0.011em}.ij{align-items:center}.ju{border-top:solid 1px #F2F2F2}.jv{border-bottom:solid 1px #F2F2F2}.jw{margin:32px 0 0}.jx{padding:3px 8px}.kg> *{margin-right:24px}.kh> :last-child{margin-right:0}.lh{margin-top:0px}.lu{margin:0}.ng{font-size:20px}.nh{margin-top:2.14em}.ni{line-height:32px}.nj{letter-spacing:-0.003em}.nq{margin-bottom:88px}.ob{display:inline-block}.oh{padding-top:72px}</style><style type="text/css" data-fela-rehydration="429" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.lg{margin-top:0px}.oa{display:inline-block}</style><style type="text/css" data-fela-rehydration="429" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.lf{margin-top:0px}.nz{display:inline-block}</style><style type="text/css" data-fela-rehydration="429" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.ld{margin-top:0px}.le{margin-right:0px}.ny{display:inline-block}</style><style type="text/css" data-fela-rehydration="429" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bp{width:24px}.bz{margin:0 24px}.co{height:40px}.cv{margin-bottom:44px}.dh{margin-bottom:32px}.du{font-size:13px}.dv{line-height:20px}.ee{padding:0px 8px 1px}.fs{margin-bottom:4px}.gu{margin-top:32px}.hg{font-size:32px}.hh{margin-bottom:24px}.hi{line-height:38px}.hj{letter-spacing:-0.014em}.if{align-items:flex-start}.jd{flex-direction:column}.ji{margin:24px -24px 0}.jj{padding:0}.jy> *{margin-right:8px}.jz> :last-child{margin-right:24px}.kq{margin-left:0px}.lb{margin-top:0px}.lc{margin-right:0px}.lq{margin:0}.lz{border:1px solid #F2F2F2}.ma{border-radius:99em}.mb{padding:0px 16px 0px 12px}.mc{height:38px}.md{align-items:center}.mf svg{margin-right:8px}.mq{font-size:18px}.mr{margin-top:1.56em}.ms{line-height:28px}.mt{letter-spacing:-0.003em}.nm{margin-bottom:80px}.nx{display:inline-block}.od{padding-top:48px}.me:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="429" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bs{width:64px}.cc{margin:0 64px}.cr{height:48px}.cy{margin-bottom:52px}.dk{margin-bottom:48px}.ea{font-size:14px}.eb{line-height:20px}.eh{font-size:13px}.ei{padding:5px 12px}.fd{display:flex}.fv{margin-bottom:68px}.fz{max-width:680px}.gx{margin-top:40px}.hs{font-size:42px}.ht{margin-bottom:32px}.hu{line-height:52px}.hv{letter-spacing:-0.011em}.ii{align-items:center}.jq{border-top:solid 1px #F2F2F2}.jr{border-bottom:solid 1px #F2F2F2}.js{margin:32px 0 0}.jt{padding:3px 8px}.ke> *{margin-right:24px}.kf> :last-child{margin-right:0}.lt{margin:0}.nc{font-size:20px}.nd{margin-top:2.14em}.ne{line-height:32px}.nf{letter-spacing:-0.003em}.np{margin-bottom:88px}.og{padding-top:72px}</style><style type="text/css" data-fela-rehydration="429" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.br{width:64px}.cb{margin:0 48px}.cq{height:48px}.cx{margin-bottom:52px}.dj{margin-bottom:48px}.dy{font-size:13px}.dz{line-height:20px}.eg{padding:0px 8px 1px}.fu{margin-bottom:68px}.fy{max-width:680px}.gw{margin-top:40px}.ho{font-size:42px}.hp{margin-bottom:32px}.hq{line-height:52px}.hr{letter-spacing:-0.011em}.ih{align-items:center}.jm{border-top:solid 1px #F2F2F2}.jn{border-bottom:solid 1px #F2F2F2}.jo{margin:32px 0 0}.jp{padding:3px 8px}.kc> *{margin-right:24px}.kd> :last-child{margin-right:0}.ls{margin:0}.my{font-size:20px}.mz{margin-top:2.14em}.na{line-height:32px}.nb{letter-spacing:-0.003em}.no{margin-bottom:88px}.of{padding-top:72px}</style><style type="text/css" data-fela-rehydration="429" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bq{width:24px}.ca{margin:0 24px}.cp{height:40px}.cw{margin-bottom:44px}.di{margin-bottom:32px}.dw{font-size:13px}.dx{line-height:20px}.ef{padding:0px 8px 1px}.ft{margin-bottom:4px}.gv{margin-top:32px}.hk{font-size:32px}.hl{margin-bottom:24px}.hm{line-height:38px}.hn{letter-spacing:-0.014em}.ig{align-items:flex-start}.je{flex-direction:column}.jk{margin:24px 0 0}.jl{padding:0}.ka> *{margin-right:8px}.kb> :last-child{margin-right:8px}.kr{margin-left:0px}.lr{margin:0}.mg{border:1px solid #F2F2F2}.mh{border-radius:99em}.mi{padding:0px 16px 0px 12px}.mj{height:38px}.mk{align-items:center}.mm svg{margin-right:8px}.mu{font-size:18px}.mv{margin-top:1.56em}.mw{line-height:28px}.mx{letter-spacing:-0.003em}.nn{margin-bottom:80px}.oe{padding-top:48px}.ml:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="429" data-fela-type="RULE" media="print">.nv{display:none}</style><script async="" src="https://cdn.branch.io/branch-latest.min.js"></script><script type="application/ld+json" data-rh="true">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fda:true\u002Fresize:fit:1200\u002F0*eC65dt7XWcdWafVu"],"url":"https:\u002F\u002Fkarol-mazurek.medium.com\u002Fdyld-do-you-like-death-i-8199faad040e","dateCreated":"2024-01-31T16:55:21.056Z","datePublished":"2024-01-31T16:55:21.056Z","dateModified":"2024-02-08T15:03:28.184Z","headline":"DYLD — Do You Like Death? (I) | Medium","name":"DYLD — Do You Like Death? (I) | Medium","description":"The lifecycle of a Dynamic Loader from its creation to its termination. Debugging Dyld and analysing its source code from the start () to handleDyldInCache().","identifier":"8199faad040e","author":{"@type":"Person","name":"Karol Mazurek","url":"https:\u002F\u002Fkarol-mazurek.medium.com"},"creator":["Karol Mazurek"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fkarol-mazurek.medium.com\u002F","logo":{"@type":"ImageObject","width":308,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:385\u002F1*OMF3fSqH8t4xBJ9-6oZDZw.png"}},"mainEntityOfPage":"https:\u002F\u002Fkarol-mazurek.medium.com\u002Fdyld-do-you-like-death-i-8199faad040e","isAccessibleForFree":"False","hasPart":{"@type":"WebPageElement","isAccessibleForFree":"False","cssSelector":".meteredContent"}}</script><style data-fela-type="RULE" type="text/css" media="(prefers-reduced-motion: no-preference)"></style><script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-7JY7T788PK" data-rh="true"></script><script data-rh="true">window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'G-7JY7T788PK');</script><script type="text/javascript" data-rh="true">(function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src="https://cdn.branch.io/branch-latest.min.js";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,"script","branch",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},"addListener applyCode autoAppIndex banner closeBanner closeJourney creditHistory credits data deepview deepviewCta first getCode init link logout redeem referrals removeListener sendSMS setBranchViewData setIdentity track validateCode trackCommerceEvent logEvent".split(" "), 0);
branch.init('key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm', {metadata: {}, 'no_journeys': true, 'disable_exit_animation': true, 'disable_entry_animation': true, 'tracking_disabled': null}, function(err, data) {});</script><script src="https://www.google.com/recaptcha/enterprise.js?render=6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp" data-rh="true"></script></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div><script>if (window.self !== window.top) window.location = "about:blank"</script></div><div class="l c"><div class="l m n o c" style="transform: translateY(0px);"><div class="p q r s t u v w x i d y z"><a class="dr ag ds bc ak b am an ao ap aq ar as at s u w i d q dt z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8199faad040e&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderUser&amp;source=---two_column_layout_nav----------------------------------" rel="noopener follow">Open in app<svg width="10" height="10" viewBox="0 0 10 10" fill="none" class="dq"><path d="M.98 8.48a.37.37 0 1 0 .54.54l-.54-.54zm7.77-7.23h.38c0-.2-.17-.38-.38-.38v.38zM8.37 6.5a.37.37 0 1 0 .76 0h-.76zM3.5.87a.37.37 0 1 0 0 .76V.88zM1.52 9.03l7.5-7.5-.54-.54-7.5 7.5.54.54zm6.86-7.77V6.5h.74V1.25h-.74zm-4.88.38h5.25V.88H3.5v.74z" fill="currentColor"></path></svg></a><div class="ab q"><p class="bc b du dv dw dx dy dz ea eb ec ed dr"><span><button class="bc b du dv ee dw dx ef dy dz eg eh eb ei ej ed ek el em eo ep eq er es et eu ev ew ex ey ez fa bj fb fc" data-testid="headerSignUpButton">Sign up</button></span></p><div class="au l"><p class="bc b du dv dw dx dy dz ea eb ec ed dr"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fdyld-do-you-like-death-i-8199faad040e&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=---two_column_layout_nav----------------------------------" rel="noopener follow"><svg width="120" height="27" viewBox="0 0 120 27" fill="none"><mask id="logo-wordmark-pride_svg__a" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="1" y="0" width="119" height="27"><path d="M29.69 2.36h.03v-.29h-7.26L15.7 18.05 8.96 2.07H1.12v.28l.04.01c1.32.3 2 .75 2 2.37v19c0 1.62-.68 2.07-2 2.37h-.04v.29h5.31v-.28H6.4c-1.33-.3-2-.76-2-2.38V5.83l8.67 20.56h.5l8.91-21.13V24.2c-.1 1.28-.78 1.67-1.98 1.95h-.03v.28h9.25v-.27l-.03-.01c-1.2-.28-1.89-.67-2-1.95V4.73c0-1.62.67-2.07 2-2.37zm4.23 12.58c.15-3.41 1.37-5.87 3.4-5.92.64.01 1.17.22 1.58.62.87.86 1.28 2.64 1.22 5.3h-6.2zm-.1.96h10.86v-.04c-.03-2.61-.78-4.64-2.23-6.03a7.3 7.3 0 0 0-5.05-1.87h-.04a7.31 7.31 0 0 0-5.75 2.78 10.4 10.4 0 0 0-2.08 5.72l-.02.2a7.61 7.61 0 0 0-.02.56v.58c.11 5.09 2.84 9.16 7.69 9.16 4.25 0 6.73-3.14 7.35-7.34l-.32-.11c-1.08 2.26-3.03 3.63-5.25 3.46-3.03-.23-5.35-3.32-5.13-7.06m23.12 6.89c-.36.85-1.1 1.32-2.1 1.32s-1.9-.7-2.55-1.94a12.23 12.23 0 0 1-1.06-5.49c0-4.68 1.45-7.7 3.68-7.7.94 0 1.68.47 2.03 1.28V22.8zm7.2 3.33c-1.33-.31-2-.78-2-2.49V.96l-8.07 2.39v.3l.05-.01c1.11-.1 1.87.06 2.3.47.35.32.52.8.52 1.5v3.1a5.18 5.18 0 0 0-2.89-.75c-2.33 0-4.45.98-5.99 2.78-1.6 1.86-2.44 4.42-2.44 7.38 0 5.28 2.58 8.84 6.43 8.84a5.09 5.09 0 0 0 4.89-3.34v2.81h7.23v-.29h-.03zm6.9-22.09c0-1.65-1.23-2.9-2.87-2.9a2.87 2.87 0 0 0-2.9 2.9c0 1.63 1.27 2.9 2.9 2.9a2.82 2.82 0 0 0 2.88-2.9zm1.91 22.1c-1.32-.32-2-.8-2-2.5V8.01l-7.24 2.1v.28h.05c1.56.14 1.99.68 1.99 2.53v13.51H73v-.29h-.04zm18.54 0c-1.33-.32-2-.8-2-2.5V8.01l-6.89 2.02v.29h.04c1.28.14 1.65.71 1.65 2.56v9.88a2.48 2.48 0 0 1-2.2 1.4c-1.57 0-2.43-1.08-2.43-3.02V8.01l-7.24 2.1v.28h.04c1.57.14 2 .68 2 2.53v8.36c0 .58.05 1.16.15 1.74l.13.57c.61 2.21 2.22 3.37 4.73 3.37 2.13 0 4-1.33 4.82-3.4v2.88h7.23v-.3h-.03zm28.1.3v-.3h-.03c-1.44-.34-2-.97-2-2.26V13.25c0-3.31-1.85-5.3-4.95-5.3a5.08 5.08 0 0 0-4.9 3.37c-.58-2.17-2.25-3.36-4.73-3.36a4.7 4.7 0 0 0-4.61 3.1V8.02l-7.23 2v.3h.04c1.55.14 2 .7 2 2.49v13.63h6.74v-.29h-.03c-1.15-.28-1.52-.78-1.52-2.05V11.9c.3-.71.91-1.56 2.13-1.56 1.5 0 2.26 1.05 2.26 3.12v12.97h6.75v-.29h-.03c-1.15-.28-1.52-.78-1.52-2.05V13.25a7 7 0 0 0-.1-1.21c.32-.78.97-1.7 2.23-1.7 1.53 0 2.27 1.02 2.27 3.12v12.97h7.23z" fill="#242424"></path></mask><g filter="url(#logo-wordmark-pride_svg__filter0_f_238_6555)" mask="url(#logo-wordmark-pride_svg__a)"><path d="M42.3-64.7l-15.52-6.74L-24.62 47l15.53 6.74L42.3-64.7z" fill="#000"></path><path d="M53.18-59.98L42.3-64.7-9.1 53.74l10.88 4.72 51.4-118.44z" fill="#603917"></path><path d="M64.96-54.87l-11.78-5.11L1.78 58.46l11.79 5.11 51.4-118.44z" fill="#71E2FD"></path><path d="M75.84-50.15l-10.88-4.72-51.4 118.44 10.89 4.72L75.84-50.15z" fill="#FF9BC9"></path><path d="M86.71-45.43l-10.87-4.72L24.44 68.3l10.88 4.72 51.4-118.44z" fill="#FF472F"></path><path d="M97.6-40.7L86.7-45.44 35.32 73.01l10.88 4.72L97.6-40.7z" fill="#FF8312"></path><path d="M108.47-35.99L97.6-40.7 46.2 77.73l10.88 4.72 51.4-118.44z" fill="#FFCE00"></path><path d="M120.25-30.88l-11.78-5.1-51.4 118.43 11.79 5.11 51.4-118.44z" fill="#48E348"></path><path d="M131.13-26.16l-10.88-4.72L68.86 87.56l10.88 4.72 51.4-118.44z" fill="#008EF0"></path><path d="M148.48-18.63l-17.35-7.53-51.4 118.44 17.35 7.53 51.4-118.44z" fill="#9A50FC"></path></g><defs><filter id="logo-wordmark-pride_svg__filter0_f_238_6555" x="-29.5" y="-76.33" width="182.87" height="181.03" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood><feBlend in="SourceGraphic" in2="BackgroundImageFix" result="shape"></feBlend><feGaussianBlur stdDeviation="2.45" result="effect1_foregroundBlur_238_6555"></feGaussianBlur></filter></defs></svg></a><div class="au h"><div class="ab av aw ax ay q az ba"><div class="bj" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bk bl ab"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.1 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0zm6.94-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .8-.79l-3.74-3.73A8.05 8.05 0 0 0 11.04 3v.01z" fill="currentColor"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="av bb bc bd z be bf bg bh bi" placeholder="Search" value=""></div></div></div><div class="h k w fd fe"><div class="ff ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---two_column_layout_nav-----------------------new_post_topnav-----------" rel="noopener follow"><div class="bc b bd z dr fg fh ab q fi fj"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-label="Write"><path d="M14 4a.5.5 0 0 0 0-1v1zm7 6a.5.5 0 0 0-1 0h1zm-7-7H4v1h10V3zM3 4v16h1V4H3zm1 17h16v-1H4v1zm17-1V10h-1v10h1zm-1 1a1 1 0 0 0 1-1h-1v1zM3 20a1 1 0 0 0 1 1v-1H3zM4 3a1 1 0 0 0-1 1h1V3z" fill="currentColor"></path><path d="M17.5 4.5l-8.46 8.46a.25.25 0 0 0-.06.1l-.82 2.47c-.07.2.12.38.31.31l2.47-.82a.25.25 0 0 0 .1-.06L19.5 6.5m-2-2l2.32-2.32c.1-.1.26-.1.36 0l1.64 1.64c.1.1.1.26 0 .36L19.5 6.5m-2-2l2 2" stroke="currentColor"></path></svg><div class="dq l">Write</div></div></a></span></div></div><div class="k j i d"><div class="ff ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" href="https://medium.com/search?source=---two_column_layout_nav----------------------------------" rel="noopener follow"><div class="bc b bd z dr fg fh ab q fi fj"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-label="Search"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.1 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0zm6.94-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .8-.79l-3.74-3.73A8.05 8.05 0 0 0 11.04 3v.01z" fill="currentColor"></path></svg></div></a></div></div><div class="ff h k j"><div class="ab q"><p class="bc b du dv dw dx dy dz ea eb ec ed dr"><span><button class="bc b du dv ee dw dx ef dy dz eg eh eb ei ej ed ek el em eo ep eq er es et eu ev ew ex ey ez fa bj fb fc" data-testid="headerSignUpButton">Sign up</button></span></p><div class="au l"><p class="bc b du dv dw dx dy dz ea eb ec ed dr"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fdyld-do-you-like-death-i-8199faad040e&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="av fk am ab q ao fl fm fn" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fg"><img alt="" class="l fa bv bw bx cu" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"><div class="fo bv l bw bx fp n av fq"></div></div></button></div></div></div><div class="fr"><a rel="me" href="https://infosec.exchange/@karmaz">Mastodon</a></div><div class="l"><div class="nv" role="dialog" aria-modal="true" tabindex="-1"><div class="pv pw be dt px py pz ao qa gk qb" aria-hidden="true" role="presentation"></div><div class="qc px qd qe qf pv dt fa qg qh qi lj qj qk ql qm qn qo qp qq qr" aria-hidden="true"></div></div><div class="fs ft fu fv fw l"><div class="ab by"><div class="cf be fx fy fz ga"></div></div><article class="meteredContent"><div class="l"><div class="l"><span class="l"></span><section><div><div class="fp gg gh gi gj gk"></div><div class="gl gm gn go gp"><div class="gq be"><figure class="gr gq be paragraph-image"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*eC65dt7XWcdWafVu 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*eC65dt7XWcdWafVu 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*eC65dt7XWcdWafVu 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*eC65dt7XWcdWafVu 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*eC65dt7XWcdWafVu 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*eC65dt7XWcdWafVu 1100w, https://miro.medium.com/v2/resize:fit:3200/format:webp/0*eC65dt7XWcdWafVu 3200w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1600px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/0*eC65dt7XWcdWafVu 640w, https://miro.medium.com/v2/resize:fit:720/0*eC65dt7XWcdWafVu 720w, https://miro.medium.com/v2/resize:fit:750/0*eC65dt7XWcdWafVu 750w, https://miro.medium.com/v2/resize:fit:786/0*eC65dt7XWcdWafVu 786w, https://miro.medium.com/v2/resize:fit:828/0*eC65dt7XWcdWafVu 828w, https://miro.medium.com/v2/resize:fit:1100/0*eC65dt7XWcdWafVu 1100w, https://miro.medium.com/v2/resize:fit:3200/0*eC65dt7XWcdWafVu 3200w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1600px"><img alt="" class="be gs gt c" width="1600" height="914" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:2000/0*eC65dt7XWcdWafVu"></picture></figure></div><div class="ab by"><div class="cf be fx fy fz ga"><div><div class="speechify-ignore l"><div class="gu gv gw gx gy l"></div><div class="ab by"><div class="cn be qs cf l"><div class="fg qt qu qv qw qx qy ov"><p class="bc b bd z bh">You're reading for free via <a class="af ag ah ai aj ak al am an ao ap aq ar rg" href="https://medium.com/@monethic?source=post_page-----8199faad040e--------------------------------" rel="noopener follow">Monethic.io's</a> Friend Link. <span><a class="af ag ah ai aj ak al am an ao ap aq ar rg" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fdyld-do-you-like-death-i-8199faad040e&amp;source=-----8199faad040e---------------------post_friend_link_meter-----------" rel="noopener follow">Become a member</a></span> to access the best of Medium.</p></div><div class="rh ri rj rk rl l"><div class="fp qz ra gn rb rc rd re rf"></div></div></div></div><div class="ci l"><div class="hb ab"><div class="bj" aria-hidden="false" aria-describedby="58" aria-labelledby="58"><button class="l av ao am" aria-label="Member-only story"><div class="h k j i d"><div><div class="bj" aria-hidden="false" aria-describedby="59" aria-labelledby="59"><svg width="16" height="16" viewBox="0 0 64 64" fill="none"><path d="M39.64 40.83L33.87 56.7a1.99 1.99 0 0 1-3.74 0l-5.77-15.87a2.02 2.02 0 0 0-1.2-1.2L7.3 33.88a1.99 1.99 0 0 1 0-3.74l15.87-5.77a2.02 2.02 0 0 0 1.2-1.2L30.12 7.3a1.99 1.99 0 0 1 3.74 0l5.77 15.87a2.02 2.02 0 0 0 1.2 1.2l15.86 5.76a1.99 1.99 0 0 1 0 3.74l-15.87 5.77a2.02 2.02 0 0 0-1.2 1.2z" fill="#FFC017"></path></svg></div></div></div><div class="s u w fd fe q"><svg width="16" height="16" viewBox="0 0 64 64" fill="none" class="gz ha"><path d="M39.64 40.83L33.87 56.7a1.99 1.99 0 0 1-3.74 0l-5.77-15.87a2.02 2.02 0 0 0-1.2-1.2L7.3 33.88a1.99 1.99 0 0 1 0-3.74l15.87-5.77a2.02 2.02 0 0 0 1.2-1.2L30.12 7.3a1.99 1.99 0 0 1 3.74 0l5.77 15.87a2.02 2.02 0 0 0 1.2 1.2l15.86 5.76a1.99 1.99 0 0 1 0 3.74l-15.87 5.77a2.02 2.02 0 0 0-1.2 1.2z" fill="#FFC017"></path></svg><p class="bc b bd z dr">Member-only story</p></div></button></div></div></div></div><h1 id="9a9a" class="pw-post-title hc hd he bc hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz gr bh" data-testid="storyTitle" data-selectable-paragraph="">DYLD — Do You Like Death? (I)</h1><div class="po pp pq pr ps"><div class="speechify-ignore ab cm"><div class="speechify-ignore be l"><div class="if ig ih ii ij ab"><div><div class="ab ik"><a rel="noopener follow" href="/?source=post_page-----8199faad040e--------------------------------"><div><div class="bj" aria-hidden="false" aria-describedby="60" aria-labelledby="60"><div class="l il im bv in io"><div class="l fg"><img alt="Karol Mazurek" class="l fa bv da db cu" src="https://miro.medium.com/v2/da:true/resize:fill:55:55/0*BLalJfMaz_JDj6fg" width="44" height="44" loading="lazy" data-testid="authorPhoto"><div class="ip bv l da db fp n iq fq"></div></div></div></div></div></a></div></div><div class="bk be l"><div class="ab"><div style="flex: 1 1 0%;"><span class="bc b bd z bh"><div class="ir ab q"><div class="ab q is"><div class="ab q"><div><div class="bj" aria-hidden="false" aria-describedby="61" aria-labelledby="61"><p class="bc b it iu bh"><a class="af ag ah ai aj ak al am an ao ap aq ar iv" data-testid="authorName" rel="noopener follow" href="/?source=post_page-----8199faad040e--------------------------------">Karol Mazurek</a></p></div></div></div><span class="iw ix" aria-hidden="true"><span class="bc b bd z dr">·</span></span><p class="bc b it iu dr"><span><a class="iy iz ah ai aj ak al am an ao ap aq ar eu ja jb" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3f7ab05f0f68&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fdyld-do-you-like-death-i-8199faad040e&amp;user=Karol+Mazurek&amp;userId=3f7ab05f0f68&amp;source=post_page-3f7ab05f0f68----8199faad040e---------------------post_header-----------" rel="noopener follow">Follow</a></span></p></div></div></span></div></div><div class="l jc"><span class="bc b bd z dr"><div class="ab ck jd je jf"><span class="bc b bd z dr"><div class="ab ae"><span data-testid="storyReadTime">8 min read</span><div class="jg jh l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bc b bd z dr">·</span></span></div><span data-testid="storyPublishDate">Jan 31, 2024</span></div></span></div></span></div></div></div><div class="ab cm ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx"><div class="h k w fd fe q"><div class="kn l"><div class="ab q ko kp"><div class="pw-multi-vote-icon fg gz kq kr ks"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F8199faad040e&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fdyld-do-you-like-death-i-8199faad040e&amp;user=Karol+Mazurek&amp;userId=3f7ab05f0f68&amp;source=-----8199faad040e---------------------clap_footer-----------" rel="noopener follow"><div><div class="bj" aria-hidden="false" aria-describedby="62" aria-labelledby="62"><div class="kt ao ku kv kw kx am ky kz la ks"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lb lc ld le lf lg lh"><p class="bc b ds z dr"><span class="li">--</span></p></div></div></div><div><div class="bj" aria-hidden="false" aria-describedby="63" aria-labelledby="63"><button class="ao kt lj lk ab q fh ll lm" aria-label="responses"><svg width="24" height="24" viewBox="0 0 24 24" class="gr"><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></button></div></div></div><div class="ab q jy jz ka kb kc kd ke kf kg kh ki kj kk pt pu"><div class="ln k j i d"></div><div class="h k"><div><div class="bj" aria-hidden="false" aria-describedby="64" aria-labelledby="64"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8199faad040e&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fdyld-do-you-like-death-i-8199faad040e&amp;source=-----8199faad040e---------------------bookmark_footer-----------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dr lo" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div><div class="fa lp ck"><div class="l ae"><div class="ab by"><div class="lq lr ls lt lu gs cf be"><div class="ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2Fplans%3Fdimension%3Dpost_audio_button%26postId%3D8199faad040e&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fdyld-do-you-like-death-i-8199faad040e&amp;source=-----8199faad040e---------------------post_audio_button-----------" rel="noopener follow"><div><div class="bj" aria-hidden="false" aria-describedby="65" aria-labelledby="65"><button aria-label="Listen" data-testid="audioPlayButton" class="af fh ah ai aj ak al lv an ao ap eu lw lx lm ly lz ma mb mc s md me mf mg mh mi mj u mk ml mm"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0zm9-10a10 10 0 1 0 0 20 10 10 0 0 0 0-20zm3.38 10.42l-4.6 3.06a.5.5 0 0 1-.78-.41V8.93c0-.4.45-.63.78-.41l4.6 3.06c.3.2.3.64 0 .84z" fill="currentColor"></path></svg><div class="j i d"><p class="bc b bd z dr">Listen</p></div></button></div></div></a></span></div></div></div></div></div><div class="bj" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bj" aria-hidden="false" aria-describedby="66" aria-labelledby="66"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fh ah ai aj ak al lv an ao ap eu lw lx lm ly lz ma mb mc s md me mf mg mh mi mj u mk ml mm"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.22 4.93a.42.42 0 0 1-.12.13h.01a.45.45 0 0 1-.29.08.52.52 0 0 1-.3-.13L12.5 3v7.07a.5.5 0 0 1-.5.5.5.5 0 0 1-.5-.5V3.02l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.8a.42.42 0 0 1 .07.5zm-.1.14zm.88 2h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11a2 2 0 0 1-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.14c.1.1.15.22.15.35a.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9V8.96c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1z" fill="currentColor"></path></svg><div class="j i d"><p class="bc b bd z dr">Share</p></div></button></div></div></div></div></div></div></div></div></div><p id="e77f" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">The lifecycle of a Dynamic Loader from its creation to its termination.</p></div></div></div><div class="ab by rm rn ro rp" role="separator"><span class="rq bv bj rr rs oc"></span><span class="rq bv bj rr rs oc"></span><span class="rq bv bj rr rs"></span></div><div class="gl gm gn go gp"><div class="ab by"><div class="cf be fx fy fz ga"><p id="ad32" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">This series contains my notes on debugging Dyld-1122 and analysing its source code. They are arranged in order from the beginning of the startup process, specifically when XNU just loaded the Dyld to memory.</p><p id="3f12" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">I will not publish the whole analysis in one article, as it would be hard to follow and require a lot of scrolling, so I divided it into parts. Each article will start from the map showing the start and end of the current analysis, along with the lldb command to set appropriate breakpoints.</p><p id="ca13" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph=""><em class="rt">Please note that this analysis may contain some errors as I am still learning and working on it alone. No one has checked it for mistakes. Please let me know in the comments or contact me </em><a class="af rg" href="https://github.com/karmaz95#-social-media-" rel="noopener ugc nofollow" target="_blank"><em class="rt">through my social media</em></a><em class="rt"> if you find anything.</em></p><blockquote class="ru rv rw"><p id="93af" class="mn mo rt mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">The article is long, so to not overextend, let’s dive straight into it.</p></blockquote></div></div></div><div class="ab by rm rn ro rp" role="separator"><span class="rq bv bj rr rs oc"></span><span class="rq bv bj rr rs oc"></span><span class="rq bv bj rr rs"></span></div><div class="gl gm gn go gp"><div class="ab by"><div class="cf be fx fy fz ga"><h1 id="0ab2" class="rx ry he bc rz sa sb sc sd se sf sg sh si sj sk sl sm sn so sp sq sr ss st su bh" data-selectable-paragraph="">WORKING MAP</h1><p id="dea0" class="pw-post-body-paragraph mn mo he mp b mq sv ms mt mu sw mw mx my sx na nb nc sy ne nf ng sz ni nj nk gl bh" data-selectable-paragraph="">We begin our journey by decompiling the Dyld using a <a class="af rg" href="https://www.hopperapp.com/" rel="noopener ugc nofollow" target="_blank">Hopper</a>. <em class="rt">I know the source code is available, but good luck with reading it in the correct order ^^.</em></p><pre class="ta tb tc td te tf tg th bm ti ay bh"><span id="bb33" class="tj ry he tg b bd tk tl l tm tn" data-selectable-paragraph="">hopper -e '/usr/lib/dyld'</span></pre></div></div><div class="gq be"><figure class="ta tb tc td te gq be paragraph-image"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Jq2MkQcV6fD8fs0Nmxb0ww.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Jq2MkQcV6fD8fs0Nmxb0ww.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Jq2MkQcV6fD8fs0Nmxb0ww.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Jq2MkQcV6fD8fs0Nmxb0ww.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Jq2MkQcV6fD8fs0Nmxb0ww.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Jq2MkQcV6fD8fs0Nmxb0ww.png 1100w, https://miro.medium.com/v2/resize:fit:4800/format:webp/1*Jq2MkQcV6fD8fs0Nmxb0ww.png 4800w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 100vw" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*Jq2MkQcV6fD8fs0Nmxb0ww.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Jq2MkQcV6fD8fs0Nmxb0ww.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Jq2MkQcV6fD8fs0Nmxb0ww.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Jq2MkQcV6fD8fs0Nmxb0ww.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Jq2MkQcV6fD8fs0Nmxb0ww.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Jq2MkQcV6fD8fs0Nmxb0ww.png 1100w, https://miro.medium.com/v2/resize:fit:4800/1*Jq2MkQcV6fD8fs0Nmxb0ww.png 4800w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 100vw"><img alt="" class="be gs gt c" width="2400" height="572" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:3670/1*Jq2MkQcV6fD8fs0Nmxb0ww.png"></picture><figcaption class="to fc qs tp tq tr ts bc b bd z dr" data-selectable-paragraph="">Starting point in the decompiled pseudo code.</figcaption></figure></div><div class="gq"><div class="ab by"><div class="lq tt lr tu ls tv cc tw cd tx cf be"><figure class="tz ua ub uc ud gq ue uf paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq ty"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*iZJNT2WFE_yPJGM7VtSglA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*iZJNT2WFE_yPJGM7VtSglA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*iZJNT2WFE_yPJGM7VtSglA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*iZJNT2WFE_yPJGM7VtSglA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*iZJNT2WFE_yPJGM7VtSglA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*iZJNT2WFE_yPJGM7VtSglA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*iZJNT2WFE_yPJGM7VtSglA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*iZJNT2WFE_yPJGM7VtSglA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*iZJNT2WFE_yPJGM7VtSglA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*iZJNT2WFE_yPJGM7VtSglA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*iZJNT2WFE_yPJGM7VtSglA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*iZJNT2WFE_yPJGM7VtSglA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*iZJNT2WFE_yPJGM7VtSglA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*iZJNT2WFE_yPJGM7VtSglA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be gs gt c" width="1000" height="211" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*iZJNT2WFE_yPJGM7VtSglA.png"></picture></div></div><figcaption class="to fc qs tp tq tr ts bc b bd z dr" data-selectable-paragraph="">Starting point in the assembly.</figcaption></figure><figure class="gr gq ue uf paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq uk"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*iCV7b26LJXG5xMfxwu6X3g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*iCV7b26LJXG5xMfxwu6X3g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*iCV7b26LJXG5xMfxwu6X3g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*iCV7b26LJXG5xMfxwu6X3g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*iCV7b26LJXG5xMfxwu6X3g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*iCV7b26LJXG5xMfxwu6X3g.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*iCV7b26LJXG5xMfxwu6X3g.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*iCV7b26LJXG5xMfxwu6X3g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*iCV7b26LJXG5xMfxwu6X3g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*iCV7b26LJXG5xMfxwu6X3g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*iCV7b26LJXG5xMfxwu6X3g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*iCV7b26LJXG5xMfxwu6X3g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*iCV7b26LJXG5xMfxwu6X3g.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*iCV7b26LJXG5xMfxwu6X3g.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be gs gt c" width="1000" height="144" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*iCV7b26LJXG5xMfxwu6X3g.png"></picture></div></div><figcaption class="to fc qs tp tq tr ts bc b bd z dr" data-selectable-paragraph="">Ending point in the assembly.</figcaption></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><p id="df81" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph=""><strong class="mp hf">Dyld GitHub repository:</strong></p><ul class=""><li id="8f6b" class="mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk ul um un bh" data-selectable-paragraph="">Start: <code class="cu uo up uq tg b">start()</code> in <a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/dyldMain.cpp#L1183" rel="noopener ugc nofollow" target="_blank">dyld-1122.1 — dyldMain.cpp#L1183</a></li><li id="e55e" class="mn mo he mp b mq ur ms mt mu us mw mx my ut na nb nc uu ne nf ng uv ni nj nk ul um un bh" data-selectable-paragraph="">End: <code class="cu uo up uq tg b">handleDyldInCache</code> in <a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/dyldMain.cpp#L1030" rel="noopener ugc nofollow" target="_blank">dyld-1122.1 — dyldMain.cpp#L1030</a></li></ul><p id="cde6" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph=""><strong class="mp hf">LLDB breakpoints:</strong></p><pre class="ta tb tc td te tf tg th bm ti ay bh"><span id="9a01" class="tj ry he tg b bd tk tl l tm tn" data-selectable-paragraph=""># START - dyld`start+0<br>br set -n start -s dyld<br><br># END - dyld`start+988<br>br set -n isBuiltForSimulator -s dyld</span></pre><blockquote class="ru rv rw"><p id="86c9" class="mn mo rt mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">The next article will start at the exact point where this one finishes.</p></blockquote></div></div></div><div class="ab by rm rn ro rp" role="separator"><span class="rq bv bj rr rs oc"></span><span class="rq bv bj rr rs oc"></span><span class="rq bv bj rr rs"></span></div><div class="gl gm gn go gp"><div class="ab by"><div class="cf be fx fy fz ga"><h1 id="617e" class="rx ry he bc rz sa sb sc sd se sf sg sh si sj sk sl sm sn so sp sq sr ss st su bh" data-selectable-paragraph="">START — Dyld Startup</h1><p id="a95e" class="pw-post-body-paragraph mn mo he mp b mq sv ms mt mu sw mw mx my sx na nb nc sy ne nf ng sz ni nj nk gl bh" data-selectable-paragraph="">In the <a class="af rg" rel="noopener" href="/snake-apple-i-mach-o-a8eda4b87263">Snake&amp;Apple I — Mach-O</a>, I introduced the <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L316" rel="noopener ugc nofollow" target="_blank">LC_MAIN</a></code> load command, which specifies the entry point — <code class="cu uo up uq tg b">main()</code> of the program:</p><figure class="ta tb tc td te gq tp tq paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq uw"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*u0fFxCvDS8BsiOpu.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*u0fFxCvDS8BsiOpu.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*u0fFxCvDS8BsiOpu.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*u0fFxCvDS8BsiOpu.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*u0fFxCvDS8BsiOpu.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*u0fFxCvDS8BsiOpu.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*u0fFxCvDS8BsiOpu.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/0*u0fFxCvDS8BsiOpu.png 640w, https://miro.medium.com/v2/resize:fit:720/0*u0fFxCvDS8BsiOpu.png 720w, https://miro.medium.com/v2/resize:fit:750/0*u0fFxCvDS8BsiOpu.png 750w, https://miro.medium.com/v2/resize:fit:786/0*u0fFxCvDS8BsiOpu.png 786w, https://miro.medium.com/v2/resize:fit:828/0*u0fFxCvDS8BsiOpu.png 828w, https://miro.medium.com/v2/resize:fit:1100/0*u0fFxCvDS8BsiOpu.png 1100w, https://miro.medium.com/v2/resize:fit:1400/0*u0fFxCvDS8BsiOpu.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be gs gt c" width="700" height="171" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/0*u0fFxCvDS8BsiOpu.png"></picture></div></div></figure><p id="2aa7" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">However, the program execution, in reality, <a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/dyldMain.cpp#L1168" rel="noopener ugc nofollow" target="_blank"><strong class="mp hf">starts way before</strong></a>. As described in <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/main/dyld/dyldStartup.s" rel="noopener ugc nofollow" target="_blank">dyldStartup.s</a></code> —<em class="rt"> </em><strong class="mp hf"><em class="rt">in the Dyld. </em></strong>The kernel must first map binary and Dyld:</p><figure class="ta tb tc td te gq tp tq paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq ux"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*tZ6RsicVh7D5tH9VoJvhZw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*tZ6RsicVh7D5tH9VoJvhZw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*tZ6RsicVh7D5tH9VoJvhZw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*tZ6RsicVh7D5tH9VoJvhZw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*tZ6RsicVh7D5tH9VoJvhZw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*tZ6RsicVh7D5tH9VoJvhZw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tZ6RsicVh7D5tH9VoJvhZw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*tZ6RsicVh7D5tH9VoJvhZw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*tZ6RsicVh7D5tH9VoJvhZw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*tZ6RsicVh7D5tH9VoJvhZw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*tZ6RsicVh7D5tH9VoJvhZw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*tZ6RsicVh7D5tH9VoJvhZw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*tZ6RsicVh7D5tH9VoJvhZw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*tZ6RsicVh7D5tH9VoJvhZw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be gs gt c" width="700" height="285" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*tZ6RsicVh7D5tH9VoJvhZw.png"></picture></div></div></figure><p id="bf32" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">Then, the kernel starts the process by pushing all the necessary parameters onto the stack, such as <em class="rt">argc</em>, <em class="rt">argv</em>, <em class="rt">envp</em>, and <em class="rt">apple</em> and sets the program counter to <code class="cu uo up uq tg b">__dyld_start</code> in Dyld. The stack appears as follows:</p></div></div><div class="gq"><div class="ab by"><div class="lq tt lr tu ls tv cc tw cd tx cf be"><figure class="ta tb tc td te gq ue uf paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq uy"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*0BtaycD2If3I97jiXPhKww.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*0BtaycD2If3I97jiXPhKww.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*0BtaycD2If3I97jiXPhKww.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*0BtaycD2If3I97jiXPhKww.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*0BtaycD2If3I97jiXPhKww.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*0BtaycD2If3I97jiXPhKww.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*0BtaycD2If3I97jiXPhKww.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*0BtaycD2If3I97jiXPhKww.png 640w, https://miro.medium.com/v2/resize:fit:720/1*0BtaycD2If3I97jiXPhKww.png 720w, https://miro.medium.com/v2/resize:fit:750/1*0BtaycD2If3I97jiXPhKww.png 750w, https://miro.medium.com/v2/resize:fit:786/1*0BtaycD2If3I97jiXPhKww.png 786w, https://miro.medium.com/v2/resize:fit:828/1*0BtaycD2If3I97jiXPhKww.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*0BtaycD2If3I97jiXPhKww.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*0BtaycD2If3I97jiXPhKww.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be gs gt c" width="1000" height="507" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*0BtaycD2If3I97jiXPhKww.png"></picture></div></div></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><pre class="ta tb tc td te tf tg th bm ti ay bh"><span id="db03" class="tj ry he tg b bd tk tl l tm tn" data-selectable-paragraph=""># (lldb) breakpoint @ dyld:start(), just after dyld`_dyld_start<br>br set -n start -s dyld</span></pre><p id="bacc" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">After aligning the stack, it jumps into the Dyld’s entry point <code class="cu uo up uq tg b">dyld::start()</code>:</p><figure class="ta tb tc td te gq tp tq paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq uz"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ubi_GtzT3thh7C3aMwgzlA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ubi_GtzT3thh7C3aMwgzlA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ubi_GtzT3thh7C3aMwgzlA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ubi_GtzT3thh7C3aMwgzlA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ubi_GtzT3thh7C3aMwgzlA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ubi_GtzT3thh7C3aMwgzlA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ubi_GtzT3thh7C3aMwgzlA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*ubi_GtzT3thh7C3aMwgzlA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ubi_GtzT3thh7C3aMwgzlA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ubi_GtzT3thh7C3aMwgzlA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ubi_GtzT3thh7C3aMwgzlA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ubi_GtzT3thh7C3aMwgzlA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ubi_GtzT3thh7C3aMwgzlA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ubi_GtzT3thh7C3aMwgzlA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be gs gt c" width="700" height="252" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*ubi_GtzT3thh7C3aMwgzlA.png"></picture></div></div><figcaption class="to fc qs tp tq tr ts bc b bd z dr" data-selectable-paragraph=""><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/dyldStartup.s#L74" rel="noopener ugc nofollow" target="_blank">dyldStartup.s</a></figcaption></figure><blockquote class="ru rv rw"><p id="38dd" class="mn mo rt mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">Finally, we end up in the <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/dyldMain.cpp#L1182" rel="noopener ugc nofollow" target="_blank"><em class="he">dyldMain.cpp</em></a></code>, specifically in the <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/dyldMain.cpp#L1183" rel="noopener ugc nofollow" target="_blank"><em class="he">start()</em></a></code>.</p></blockquote><h2 id="8c09" class="va ry he bc rz vb vc dv sd vd ve dx sh my vf vg vh nc vi vj vk ng vl vm vn vo bh" data-selectable-paragraph="">kdebug_trace_dyld_marker</h2><p id="8520" class="pw-post-body-paragraph mn mo he mp b mq sv ms mt mu sw mw mx my sx na nb nc sy ne nf ng sz ni nj nk gl bh" data-selectable-paragraph="">The first thing that Dyld do after initialization is call the tracing function to indicate the start of the Dyld bootstrap process <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/dyldMain.cpp#L1189" rel="noopener ugc nofollow" target="_blank">kdebug_trace_dyld_marker</a></code>:</p><figure class="ta tb tc td te gq tp tq paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq vp"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*lFcLyh5gFWr6LfcIrzUc0A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*lFcLyh5gFWr6LfcIrzUc0A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*lFcLyh5gFWr6LfcIrzUc0A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*lFcLyh5gFWr6LfcIrzUc0A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*lFcLyh5gFWr6LfcIrzUc0A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*lFcLyh5gFWr6LfcIrzUc0A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lFcLyh5gFWr6LfcIrzUc0A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*lFcLyh5gFWr6LfcIrzUc0A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*lFcLyh5gFWr6LfcIrzUc0A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*lFcLyh5gFWr6LfcIrzUc0A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*lFcLyh5gFWr6LfcIrzUc0A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*lFcLyh5gFWr6LfcIrzUc0A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*lFcLyh5gFWr6LfcIrzUc0A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*lFcLyh5gFWr6LfcIrzUc0A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be gs gt c" width="700" height="167" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*lFcLyh5gFWr6LfcIrzUc0A.png"></picture></div></div><figcaption class="to fc qs tp tq tr ts bc b bd z dr" data-selectable-paragraph=""><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/dyldMain.cpp#L1189" rel="noopener ugc nofollow" target="_blank">dyldMain.cpp</a></figcaption></figure><p id="1785" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">The function is part of the <code class="cu uo up uq tg b"><a class="af rg" href="https://www.theiphonewiki.com/wiki/Kdebug" rel="noopener ugc nofollow" target="_blank">kdebug</a></code> subsystem, a kernel-level tracing mechanism that allows to instrument code and trace events in the system.</p><figure class="ta tb tc td te gq tp tq paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq vq"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*b9LdkmgRGa9Mwvx7ULsxpQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*b9LdkmgRGa9Mwvx7ULsxpQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*b9LdkmgRGa9Mwvx7ULsxpQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*b9LdkmgRGa9Mwvx7ULsxpQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*b9LdkmgRGa9Mwvx7ULsxpQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*b9LdkmgRGa9Mwvx7ULsxpQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b9LdkmgRGa9Mwvx7ULsxpQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*b9LdkmgRGa9Mwvx7ULsxpQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*b9LdkmgRGa9Mwvx7ULsxpQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*b9LdkmgRGa9Mwvx7ULsxpQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*b9LdkmgRGa9Mwvx7ULsxpQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*b9LdkmgRGa9Mwvx7ULsxpQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*b9LdkmgRGa9Mwvx7ULsxpQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*b9LdkmgRGa9Mwvx7ULsxpQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be gs gt c" width="700" height="254" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*b9LdkmgRGa9Mwvx7ULsxpQ.png"></picture></div></div><figcaption class="to fc qs tp tq tr ts bc b bd z dr" data-selectable-paragraph=""><code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/Tracing.cpp#L134" rel="noopener ugc nofollow" target="_blank">Tracing.cpp</a></code></figcaption></figure><p id="9983" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">However, a tracepoint is emitted (<code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/Tracing.cpp#L140" rel="noopener ugc nofollow" target="_blank">kdebug_trace</a></code>) <strong class="mp hf">only if kdebug tracing for the specified code is enabled</strong> (<code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/Tracing.cpp#L135" rel="noopener ugc nofollow" target="_blank">kdebug_is_enabled</a></code>), which is <strong class="mp hf">off by default</strong>.</p><figure class="ta tb tc td te gq tp tq paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq vr"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*m0bwHn2hExcERqb6SeORpQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*m0bwHn2hExcERqb6SeORpQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*m0bwHn2hExcERqb6SeORpQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*m0bwHn2hExcERqb6SeORpQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*m0bwHn2hExcERqb6SeORpQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*m0bwHn2hExcERqb6SeORpQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m0bwHn2hExcERqb6SeORpQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*m0bwHn2hExcERqb6SeORpQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*m0bwHn2hExcERqb6SeORpQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*m0bwHn2hExcERqb6SeORpQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*m0bwHn2hExcERqb6SeORpQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*m0bwHn2hExcERqb6SeORpQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*m0bwHn2hExcERqb6SeORpQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*m0bwHn2hExcERqb6SeORpQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be gs gt c" width="700" height="271" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*m0bwHn2hExcERqb6SeORpQ.png"></picture></div></div></figure><blockquote class="ru rv rw"><p id="5d02" class="mn mo rt mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">I will not discuss kernel-level debugging here, but if you are curious, <a class="af rg" href="https://newosxbook.com/tools/kdv.html" rel="noopener ugc nofollow" target="_blank">KDV — KDebug Unleashed for OS X</a> is an excellent place to start.</p></blockquote><h2 id="5f98" class="va ry he bc rz vb vc dv sd vd ve dx sh my vf vg vh nc vi vj vk ng vl vm vn vo bh" data-selectable-paragraph="">rebaseSelf</h2><p id="0ebf" class="pw-post-body-paragraph mn mo he mp b mq sv ms mt mu sw mw mx my sx na nb nc sy ne nf ng sz ni nj nk gl bh" data-selectable-paragraph="">The Dyld is placed in a virtual memory without <a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/common/MachOLoaded.cpp#L766" rel="noopener ugc nofollow" target="_blank">rebasing chained fixups</a>. In this step, Dyld conducts rebasing according to the slide used by the kernel.</p><p id="a3ed" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph=""><em class="rt">Whether the </em><a class="af rg" rel="noopener" href="/snake-apple-iii-checksec-ed64a4b766c1"><em class="rt">PIE</em></a><em class="rt"> flag exists in the target executable header flags or not, the rebasing process that originates from PIE usage will be dealt with later.</em></p><p id="76a1" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">First, there is a check if the current instance of Dyld is not loaded into the Dyld Shared Cache already, and if it is not, the Dyld rebase itself:</p><figure class="ta tb tc td te gq tp tq paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq vs"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*1jkf4ijr7KqPVINvy9sNow.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*1jkf4ijr7KqPVINvy9sNow.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*1jkf4ijr7KqPVINvy9sNow.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*1jkf4ijr7KqPVINvy9sNow.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*1jkf4ijr7KqPVINvy9sNow.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*1jkf4ijr7KqPVINvy9sNow.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1jkf4ijr7KqPVINvy9sNow.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*1jkf4ijr7KqPVINvy9sNow.png 640w, https://miro.medium.com/v2/resize:fit:720/1*1jkf4ijr7KqPVINvy9sNow.png 720w, https://miro.medium.com/v2/resize:fit:750/1*1jkf4ijr7KqPVINvy9sNow.png 750w, https://miro.medium.com/v2/resize:fit:786/1*1jkf4ijr7KqPVINvy9sNow.png 786w, https://miro.medium.com/v2/resize:fit:828/1*1jkf4ijr7KqPVINvy9sNow.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*1jkf4ijr7KqPVINvy9sNow.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*1jkf4ijr7KqPVINvy9sNow.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be gs gt c" width="700" height="180" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*1jkf4ijr7KqPVINvy9sNow.png"></picture></div></div><figcaption class="to fc qs tp tq tr ts bc b bd z dr" data-selectable-paragraph=""><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/dyldMain.cpp#L1192" rel="noopener ugc nofollow" target="_blank">dyldMain.cpp</a></figcaption></figure><p id="b855" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">The <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/dyldMain.cpp#L1194C19-L1194C30" rel="noopener ugc nofollow" target="_blank">inDyldCache</a></code> checks if the file type in the Mach Header flags of the current instance of the Dyld is set to <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/xnu/blob/1031c584a5e37aff177559b9f69dbd3c8c3fd30a/EXTERNAL_HEADERS/mach-o/loader.h#L225" rel="noopener ugc nofollow" target="_blank">MH_DYLIB_IN_CACHE</a></code>:</p><figure class="ta tb tc td te gq tp tq paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq vt"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ngfS_3wEJBkL5u96u0OKMg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ngfS_3wEJBkL5u96u0OKMg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ngfS_3wEJBkL5u96u0OKMg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ngfS_3wEJBkL5u96u0OKMg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ngfS_3wEJBkL5u96u0OKMg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ngfS_3wEJBkL5u96u0OKMg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ngfS_3wEJBkL5u96u0OKMg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*ngfS_3wEJBkL5u96u0OKMg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ngfS_3wEJBkL5u96u0OKMg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ngfS_3wEJBkL5u96u0OKMg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ngfS_3wEJBkL5u96u0OKMg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ngfS_3wEJBkL5u96u0OKMg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ngfS_3wEJBkL5u96u0OKMg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ngfS_3wEJBkL5u96u0OKMg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be gs gt c" width="700" height="121" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*ngfS_3wEJBkL5u96u0OKMg.png"></picture></div></div><figcaption class="to fc qs tp tq tr ts bc b bd z dr" data-selectable-paragraph=""><code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/common/MachOFile.cpp#L718" rel="noopener ugc nofollow" target="_blank">MachOFile.cpp</a></code></figcaption></figure><p id="d41f" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">In <a class="af rg" href="https://medium.com/@karol-mazurek/snake-apple-iv-dylibs-2c955439b94e" rel="noopener">Snake&amp;Apple IV</a>, I briefly discussed the Dyld Shared Cache. It is worth noting that the cache stores not only dylibs but also the dynamic linker image. This is done to enhance the booting speed and startup time.</p><figure class="ta tb tc td te gq tp tq paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq vu"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*e258qG09iNtrrKOC5zjY5g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*e258qG09iNtrrKOC5zjY5g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*e258qG09iNtrrKOC5zjY5g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*e258qG09iNtrrKOC5zjY5g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*e258qG09iNtrrKOC5zjY5g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*e258qG09iNtrrKOC5zjY5g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e258qG09iNtrrKOC5zjY5g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*e258qG09iNtrrKOC5zjY5g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*e258qG09iNtrrKOC5zjY5g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*e258qG09iNtrrKOC5zjY5g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*e258qG09iNtrrKOC5zjY5g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*e258qG09iNtrrKOC5zjY5g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*e258qG09iNtrrKOC5zjY5g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*e258qG09iNtrrKOC5zjY5g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be gs gt c" width="700" height="628" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*e258qG09iNtrrKOC5zjY5g.png"></picture></div></div></figure><p id="eeec" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">If the Dyld is loaded from the Dyld Shared Cache, we will jump directly to the <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/dyldMain.cpp#L1119" rel="noopener ugc nofollow" target="_blank">mach_init</a></code> step. However, in most cases, we will load Dyld from <code class="cu uo up uq tg b">/usr/lib/dyld</code>. Thus, we will fall into the <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/dyldMain.cpp#L1082" rel="noopener ugc nofollow" target="_blank">rebaseSelf</a></code> function:</p></div></div><div class="gq"><div class="ab by"><div class="lq tt lr tu ls tv cc tw cd tx cf be"><figure class="ta tb tc td te gq ue uf paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq vv"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*JJBHbC5_S2Ufr_W6DYd3Yg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*JJBHbC5_S2Ufr_W6DYd3Yg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*JJBHbC5_S2Ufr_W6DYd3Yg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*JJBHbC5_S2Ufr_W6DYd3Yg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*JJBHbC5_S2Ufr_W6DYd3Yg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*JJBHbC5_S2Ufr_W6DYd3Yg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*JJBHbC5_S2Ufr_W6DYd3Yg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*JJBHbC5_S2Ufr_W6DYd3Yg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*JJBHbC5_S2Ufr_W6DYd3Yg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*JJBHbC5_S2Ufr_W6DYd3Yg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*JJBHbC5_S2Ufr_W6DYd3Yg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*JJBHbC5_S2Ufr_W6DYd3Yg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*JJBHbC5_S2Ufr_W6DYd3Yg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*JJBHbC5_S2Ufr_W6DYd3Yg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be gs gt c" width="1000" height="473" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*JJBHbC5_S2Ufr_W6DYd3Yg.png"></picture></div></div><figcaption class="to fc qs tp tq tr ts bc b bd z dr" data-selectable-paragraph=""><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/dyldMain.cpp#L1082" rel="noopener ugc nofollow" target="_blank">dyldMain.cpp</a></figcaption></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><p id="1e3a" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">The <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/dyldMain.cpp#L1084" rel="noopener ugc nofollow" target="_blank">rebaseSelf</a></code> function first checks if <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/common/MachOFile.cpp#L2418" rel="noopener ugc nofollow" target="_blank">hasChainedFixups</a></code> returns a <code class="cu uo up uq tg b">true</code> value. If the expression is false, it triggers an <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/glue.c#L152C6-L152C18" rel="noopener ugc nofollow" target="_blank">__assert_rtn</a></code> failure.</p><figure class="ta tb tc td te gq tp tq paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq vw"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Itu4VYACFnIsyIwHieYPzQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Itu4VYACFnIsyIwHieYPzQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Itu4VYACFnIsyIwHieYPzQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Itu4VYACFnIsyIwHieYPzQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Itu4VYACFnIsyIwHieYPzQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Itu4VYACFnIsyIwHieYPzQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Itu4VYACFnIsyIwHieYPzQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*Itu4VYACFnIsyIwHieYPzQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Itu4VYACFnIsyIwHieYPzQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Itu4VYACFnIsyIwHieYPzQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Itu4VYACFnIsyIwHieYPzQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Itu4VYACFnIsyIwHieYPzQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Itu4VYACFnIsyIwHieYPzQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Itu4VYACFnIsyIwHieYPzQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be gs gt c" width="700" height="154" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*Itu4VYACFnIsyIwHieYPzQ.png"></picture></div></div><figcaption class="to fc qs tp tq tr ts bc b bd z dr" data-selectable-paragraph=""><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/glue.c#L147" rel="noopener ugc nofollow" target="_blank">glue.c</a></figcaption></figure><p id="f228" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">Basically, <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/common/MachOFile.cpp#L2418" rel="noopener ugc nofollow" target="_blank">hasChainedFixups</a></code> uses <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/common/MachOFile.cpp#L2393" rel="noopener ugc nofollow" target="_blank">hasLoadCommand</a></code> to assess if Dyld contains either <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/common/MachOFile.cpp#L2424" rel="noopener ugc nofollow" target="_blank">LC_DYLD_INFO_ONLY</a></code><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/common/MachOFile.cpp#L2424" rel="noopener ugc nofollow" target="_blank"> or </a><code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/common/MachOFile.cpp#L2424" rel="noopener ugc nofollow" target="_blank">LC_DYLD_CHAINED_FIXUPS</a></code> load command:</p><figure class="ta tb tc td te gq tp tq paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq vx"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*2vdcz53RVoic1K637cHLJQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*2vdcz53RVoic1K637cHLJQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*2vdcz53RVoic1K637cHLJQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*2vdcz53RVoic1K637cHLJQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*2vdcz53RVoic1K637cHLJQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*2vdcz53RVoic1K637cHLJQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2vdcz53RVoic1K637cHLJQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*2vdcz53RVoic1K637cHLJQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*2vdcz53RVoic1K637cHLJQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*2vdcz53RVoic1K637cHLJQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*2vdcz53RVoic1K637cHLJQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*2vdcz53RVoic1K637cHLJQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*2vdcz53RVoic1K637cHLJQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*2vdcz53RVoic1K637cHLJQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be gs gt c" width="700" height="207" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*2vdcz53RVoic1K637cHLJQ.png"></picture></div></div><figcaption class="to fc qs tp tq tr ts bc b bd z dr" data-selectable-paragraph=""><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/common/MachOFile.cpp#L2411" rel="noopener ugc nofollow" target="_blank">MachOFile.cpp</a></figcaption></figure><p id="8a13" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">The <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/common/MachOFile.cpp#L2393" rel="noopener ugc nofollow" target="_blank">hasLoadCommand</a></code> checks if a specific load command (identified by <code class="cu uo up uq tg b">cmdNum</code>) is present. It iterates through all load commands using the <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/common/MachOFile.cpp#L1029" rel="noopener ugc nofollow" target="_blank">forEachLoadCommand</a></code> and sets a flag (<code class="cu uo up uq tg b">hasLC</code>) to <code class="cu uo up uq tg b">true</code> if it exists.</p><figure class="ta tb tc td te gq tp tq paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq vy"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*SsbVC7eKQbpuq5zl_AtXXg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*SsbVC7eKQbpuq5zl_AtXXg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*SsbVC7eKQbpuq5zl_AtXXg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*SsbVC7eKQbpuq5zl_AtXXg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*SsbVC7eKQbpuq5zl_AtXXg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*SsbVC7eKQbpuq5zl_AtXXg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SsbVC7eKQbpuq5zl_AtXXg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*SsbVC7eKQbpuq5zl_AtXXg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*SsbVC7eKQbpuq5zl_AtXXg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*SsbVC7eKQbpuq5zl_AtXXg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*SsbVC7eKQbpuq5zl_AtXXg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*SsbVC7eKQbpuq5zl_AtXXg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*SsbVC7eKQbpuq5zl_AtXXg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*SsbVC7eKQbpuq5zl_AtXXg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be gs gt c" width="700" height="296" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*SsbVC7eKQbpuq5zl_AtXXg.png"></picture></div></div><figcaption class="to fc qs tp tq tr ts bc b bd z dr" data-selectable-paragraph=""><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/common/MachOFile.cpp#L2393" rel="noopener ugc nofollow" target="_blank">MachOFile.cpp</a></figcaption></figure><p id="d684" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">The assertion is followed by a <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/dyldMain.cpp#L1086" rel="noopener ugc nofollow" target="_blank">getSlide</a></code> that iterates over load commands using <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/common/MachOFile.cpp#L1029" rel="noopener ugc nofollow" target="_blank">forEachLoadCommand</a></code> to find the <code class="cu uo up uq tg b">LC_SEGMENT_64</code> command with the <code class="cu uo up uq tg b">__TEXT</code> name. The function calculates the <code class="cu uo up uq tg b">slide</code> by subtracting the virtual address of this segment from the current instance of Dyld.</p><figure class="ta tb tc td te gq tp tq paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq vz"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*mOsuBO2jZcd7NPE1JYPbDg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*mOsuBO2jZcd7NPE1JYPbDg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*mOsuBO2jZcd7NPE1JYPbDg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*mOsuBO2jZcd7NPE1JYPbDg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*mOsuBO2jZcd7NPE1JYPbDg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*mOsuBO2jZcd7NPE1JYPbDg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mOsuBO2jZcd7NPE1JYPbDg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*mOsuBO2jZcd7NPE1JYPbDg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*mOsuBO2jZcd7NPE1JYPbDg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*mOsuBO2jZcd7NPE1JYPbDg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*mOsuBO2jZcd7NPE1JYPbDg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*mOsuBO2jZcd7NPE1JYPbDg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*mOsuBO2jZcd7NPE1JYPbDg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*mOsuBO2jZcd7NPE1JYPbDg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be gs gt c" width="700" height="377" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*mOsuBO2jZcd7NPE1JYPbDg.png"></picture></div></div><figcaption class="to fc qs tp tq tr ts bc b bd z dr" data-selectable-paragraph=""><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/common/MachOLoaded.cpp#L388" rel="noopener ugc nofollow" target="_blank">MachOLoaded.cpp</a></figcaption></figure><p id="d20b" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">We calculate here where, in memory, the XNU placed our Dyld loaded from <code class="cu uo up uq tg b">/usr/lib/dyld</code>. When loaded from the disk, <code class="cu uo up uq tg b">vmaddr</code> is <code class="cu uo up uq tg b">0x00</code>:</p></div></div><div class="gq"><div class="ab by"><div class="lq tt lr tu ls tv cc tw cd tx cf be"><figure class="ta tb tc td te gq ue uf paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq wa"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*jQLGdT9gSEajphg7-CcDgg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*jQLGdT9gSEajphg7-CcDgg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*jQLGdT9gSEajphg7-CcDgg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*jQLGdT9gSEajphg7-CcDgg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*jQLGdT9gSEajphg7-CcDgg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*jQLGdT9gSEajphg7-CcDgg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*jQLGdT9gSEajphg7-CcDgg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*jQLGdT9gSEajphg7-CcDgg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*jQLGdT9gSEajphg7-CcDgg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*jQLGdT9gSEajphg7-CcDgg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*jQLGdT9gSEajphg7-CcDgg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*jQLGdT9gSEajphg7-CcDgg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*jQLGdT9gSEajphg7-CcDgg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*jQLGdT9gSEajphg7-CcDgg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be gs gt c" width="1000" height="344" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*jQLGdT9gSEajphg7-CcDgg.png"></picture></div></div></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><pre class="ta tb tc td te tf tg th bm ti ay bh"><span id="85f4" class="tj ry he tg b bd tk tl l tm tn" data-selectable-paragraph=""># (lldb) Printing vmaddr of Dyld __TEXT segment loaded in memory<br>image dump sections</span></pre><p id="81c1" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph=""><em class="rt">Why bother and not use </em><code class="cu uo up uq tg b"><em class="rt">0x00</em></code><em class="rt"> instead? Because when Dyld is loaded from Cache, its vmaddr will not start from 0, and as we discover later, this function will be hit for the second time when we would not use a special environment variable.</em></p><p id="6747" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">To double-check it in lldb, we can set a breakpoint at <code class="cu uo up uq tg b">getSlide()</code> return address and inspect the <code class="cu uo up uq tg b">x0</code> register to view the function’s return value:</p><figure class="ta tb tc td te gq tp tq paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq wb"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*cpOPt8ltp1scSaK3LLTwIQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*cpOPt8ltp1scSaK3LLTwIQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*cpOPt8ltp1scSaK3LLTwIQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*cpOPt8ltp1scSaK3LLTwIQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*cpOPt8ltp1scSaK3LLTwIQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*cpOPt8ltp1scSaK3LLTwIQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cpOPt8ltp1scSaK3LLTwIQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*cpOPt8ltp1scSaK3LLTwIQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*cpOPt8ltp1scSaK3LLTwIQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*cpOPt8ltp1scSaK3LLTwIQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*cpOPt8ltp1scSaK3LLTwIQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*cpOPt8ltp1scSaK3LLTwIQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*cpOPt8ltp1scSaK3LLTwIQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*cpOPt8ltp1scSaK3LLTwIQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be gs gt c" width="700" height="140" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*cpOPt8ltp1scSaK3LLTwIQ.png"></picture></div></div></figure><p id="af39" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">Next, the <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/common/MachOAnalyzer.cpp#L3251" rel="noopener ugc nofollow" target="_blank">withChainStarts</a></code> method checks if chained fixups are used and provides a pointer to its header <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/include/mach-o/fixup-chains.h#L49" rel="noopener ugc nofollow" target="_blank">dyld_chained_starts_in_image</a></code>.</p></div></div><div class="gq"><div class="ab by"><div class="lq tt lr tu ls tv cc tw cd tx cf be"><figure class="ta tb tc td te gq ue uf paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq wc"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*-vuUyz1wWfYUILcyNJegYA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*-vuUyz1wWfYUILcyNJegYA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*-vuUyz1wWfYUILcyNJegYA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*-vuUyz1wWfYUILcyNJegYA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*-vuUyz1wWfYUILcyNJegYA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*-vuUyz1wWfYUILcyNJegYA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*-vuUyz1wWfYUILcyNJegYA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*-vuUyz1wWfYUILcyNJegYA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*-vuUyz1wWfYUILcyNJegYA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*-vuUyz1wWfYUILcyNJegYA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*-vuUyz1wWfYUILcyNJegYA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*-vuUyz1wWfYUILcyNJegYA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*-vuUyz1wWfYUILcyNJegYA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*-vuUyz1wWfYUILcyNJegYA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be gs gt c" width="1000" height="161" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*-vuUyz1wWfYUILcyNJegYA.png"></picture></div></div><figcaption class="to fc qs tp tq tr ts bc b bd z dr" data-selectable-paragraph=""><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/common/MachOAnalyzer.cpp#L3251" rel="noopener ugc nofollow" target="_blank">MachOAnalyzer.cpp</a></figcaption></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><p id="41f5" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">Then <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/common/MachOLoaded.cpp#L767" rel="noopener ugc nofollow" target="_blank">fixupAllChainedFixups</a></code> rebase the chained fixups using previously calculated <code class="cu uo up uq tg b">slide</code> and <a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/common/MachOLoaded.cpp#L795" rel="noopener ugc nofollow" target="_blank">resign each pointer if PAC is in use</a>.</p><figure class="ta tb tc td te gq tp tq paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq wd"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*_fAa8ltU5ARct2ytCuO45Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*_fAa8ltU5ARct2ytCuO45Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*_fAa8ltU5ARct2ytCuO45Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*_fAa8ltU5ARct2ytCuO45Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*_fAa8ltU5ARct2ytCuO45Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*_fAa8ltU5ARct2ytCuO45Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_fAa8ltU5ARct2ytCuO45Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*_fAa8ltU5ARct2ytCuO45Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*_fAa8ltU5ARct2ytCuO45Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*_fAa8ltU5ARct2ytCuO45Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*_fAa8ltU5ARct2ytCuO45Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*_fAa8ltU5ARct2ytCuO45Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*_fAa8ltU5ARct2ytCuO45Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*_fAa8ltU5ARct2ytCuO45Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be gs gt c" width="700" height="88" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*_fAa8ltU5ARct2ytCuO45Q.png"></picture></div></div><figcaption class="to fc qs tp tq tr ts bc b bd z dr" data-selectable-paragraph=""><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/dyldMain.cpp#L1089" rel="noopener ugc nofollow" target="_blank">dyldMain.cpp</a></figcaption></figure><p id="5eb7" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">The last step in the <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/dyldMain.cpp#L1195" rel="noopener ugc nofollow" target="_blank">rebaseSelf</a></code> method is to make <code class="cu uo up uq tg b">__DATA_CONST</code> segment read-only because the kernel mapped it as read and write:</p><figure class="ta tb tc td te gq tp tq paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq vp"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*RDOusxxztt3jiz-AgbCplA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*RDOusxxztt3jiz-AgbCplA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*RDOusxxztt3jiz-AgbCplA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*RDOusxxztt3jiz-AgbCplA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*RDOusxxztt3jiz-AgbCplA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*RDOusxxztt3jiz-AgbCplA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RDOusxxztt3jiz-AgbCplA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*RDOusxxztt3jiz-AgbCplA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*RDOusxxztt3jiz-AgbCplA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*RDOusxxztt3jiz-AgbCplA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*RDOusxxztt3jiz-AgbCplA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*RDOusxxztt3jiz-AgbCplA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*RDOusxxztt3jiz-AgbCplA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*RDOusxxztt3jiz-AgbCplA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be gs gt c" width="700" height="230" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*RDOusxxztt3jiz-AgbCplA.png"></picture></div></div><figcaption class="to fc qs tp tq tr ts bc b bd z dr" data-selectable-paragraph=""><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/dyldMain.cpp#L1095" rel="noopener ugc nofollow" target="_blank">dyldMain.cpp#L1095</a></figcaption></figure><p id="2a7e" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">To confirm it, we can set a breakpoint on the <code class="cu uo up uq tg b">dyld`start+392</code>, and examine the virtual memory of the executable process using <code class="cu uo up uq tg b">vmmap</code>:</p><figure class="ta tb tc td te gq tp tq paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq we"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*SsWgrKwhSzHox8ciMMBuBw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*SsWgrKwhSzHox8ciMMBuBw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*SsWgrKwhSzHox8ciMMBuBw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*SsWgrKwhSzHox8ciMMBuBw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*SsWgrKwhSzHox8ciMMBuBw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*SsWgrKwhSzHox8ciMMBuBw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SsWgrKwhSzHox8ciMMBuBw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*SsWgrKwhSzHox8ciMMBuBw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*SsWgrKwhSzHox8ciMMBuBw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*SsWgrKwhSzHox8ciMMBuBw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*SsWgrKwhSzHox8ciMMBuBw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*SsWgrKwhSzHox8ciMMBuBw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*SsWgrKwhSzHox8ciMMBuBw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*SsWgrKwhSzHox8ciMMBuBw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be gs gt c" width="700" height="365" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*SsWgrKwhSzHox8ciMMBuBw.png"></picture></div></div></figure><p id="318b" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">Then, proceed with execution to the <code class="cu uo up uq tg b">dyld`start+396</code> and examine again. We should be able to observe the read-write protections for the <code class="cu uo up uq tg b">__DATA_CONST</code> segment for Dyld has changed to read-only:</p><figure class="ta tb tc td te gq tp tq paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq wf"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*jlq-LVJ3cGpkbY5SAnMOdQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*jlq-LVJ3cGpkbY5SAnMOdQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*jlq-LVJ3cGpkbY5SAnMOdQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*jlq-LVJ3cGpkbY5SAnMOdQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*jlq-LVJ3cGpkbY5SAnMOdQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*jlq-LVJ3cGpkbY5SAnMOdQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jlq-LVJ3cGpkbY5SAnMOdQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*jlq-LVJ3cGpkbY5SAnMOdQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*jlq-LVJ3cGpkbY5SAnMOdQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*jlq-LVJ3cGpkbY5SAnMOdQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*jlq-LVJ3cGpkbY5SAnMOdQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*jlq-LVJ3cGpkbY5SAnMOdQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*jlq-LVJ3cGpkbY5SAnMOdQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*jlq-LVJ3cGpkbY5SAnMOdQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be gs gt c" width="700" height="154" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*jlq-LVJ3cGpkbY5SAnMOdQ.png"></picture></div></div></figure><h2 id="ca2e" class="va ry he bc rz vb vc dv sd vd ve dx sh my vf vg vh nc vi vj vk ng vl vm vn vo bh" data-selectable-paragraph="">initializeLibc</h2><p id="ec04" class="pw-post-body-paragraph mn mo he mp b mq sv ms mt mu sw mw mx my sx na nb nc sy ne nf ng sz ni nj nk gl bh" data-selectable-paragraph="">It initializes the Mach messaging system, sets up a random stack canary for security purposes, and initializes subsystem-related functionality.</p><figure class="ta tb tc td te gq tp tq paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq wg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*kaR1Qk06LhUMK2jSyvC0eQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*kaR1Qk06LhUMK2jSyvC0eQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*kaR1Qk06LhUMK2jSyvC0eQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*kaR1Qk06LhUMK2jSyvC0eQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*kaR1Qk06LhUMK2jSyvC0eQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*kaR1Qk06LhUMK2jSyvC0eQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kaR1Qk06LhUMK2jSyvC0eQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*kaR1Qk06LhUMK2jSyvC0eQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*kaR1Qk06LhUMK2jSyvC0eQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*kaR1Qk06LhUMK2jSyvC0eQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*kaR1Qk06LhUMK2jSyvC0eQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*kaR1Qk06LhUMK2jSyvC0eQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*kaR1Qk06LhUMK2jSyvC0eQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*kaR1Qk06LhUMK2jSyvC0eQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be gs gt c" width="700" height="97" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*kaR1Qk06LhUMK2jSyvC0eQ.png"></picture></div></div><figcaption class="to fc qs tp tq tr ts bc b bd z dr" data-selectable-paragraph=""><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/dyldMain.cpp#L1205C5-L1205C19" rel="noopener ugc nofollow" target="_blank">dyldMain.cpp</a></figcaption></figure><p id="cb10" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">It utilise <code class="cu uo up uq tg b">mach_init</code>, <code class="cu uo up uq tg b">findApple</code>, <code class="cu uo up uq tg b">__guard_setup</code>, and <code class="cu uo up uq tg b">_subsystem_init()</code>:</p><figure class="ta tb tc td te gq tp tq paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq wh"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*dEZTpnqOkbcJ9yZsRpqGhg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*dEZTpnqOkbcJ9yZsRpqGhg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*dEZTpnqOkbcJ9yZsRpqGhg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*dEZTpnqOkbcJ9yZsRpqGhg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*dEZTpnqOkbcJ9yZsRpqGhg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*dEZTpnqOkbcJ9yZsRpqGhg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dEZTpnqOkbcJ9yZsRpqGhg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*dEZTpnqOkbcJ9yZsRpqGhg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*dEZTpnqOkbcJ9yZsRpqGhg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*dEZTpnqOkbcJ9yZsRpqGhg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*dEZTpnqOkbcJ9yZsRpqGhg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*dEZTpnqOkbcJ9yZsRpqGhg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*dEZTpnqOkbcJ9yZsRpqGhg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*dEZTpnqOkbcJ9yZsRpqGhg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be gs gt c" width="700" height="266" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*dEZTpnqOkbcJ9yZsRpqGhg.png"></picture></div></div><figcaption class="to fc qs tp tq tr ts bc b bd z dr" data-selectable-paragraph=""><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/dyldMain.cpp#L1119" rel="noopener ugc nofollow" target="_blank">dyldMain.cpp#L1119</a></figcaption></figure><p id="4a74" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">The <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/glue.c#L854" rel="noopener ugc nofollow" target="_blank">mach_init()</a></code> initializes <code class="cu uo up uq tg b">mach_task_self_</code> by invoking <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/xnu/blob/1031c584a5e37aff177559b9f69dbd3c8c3fd30a/osfmk/kern/ipc_tt.c#L1395" rel="noopener ugc nofollow" target="_blank">task_self_trap()</a></code> syscall, and <code class="cu uo up uq tg b">_task_reply_port</code> by invoking <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/xnu/blob/1031c584a5e37aff177559b9f69dbd3c8c3fd30a/osfmk/kern/ipc_tt.c#L1420" rel="noopener ugc nofollow" target="_blank">mach_reply_port()</a></code> syscall.</p><figure class="ta tb tc td te gq tp tq paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq wi"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*_cqFi3az4ZHJI3ubpBamUQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*_cqFi3az4ZHJI3ubpBamUQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*_cqFi3az4ZHJI3ubpBamUQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*_cqFi3az4ZHJI3ubpBamUQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*_cqFi3az4ZHJI3ubpBamUQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*_cqFi3az4ZHJI3ubpBamUQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_cqFi3az4ZHJI3ubpBamUQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*_cqFi3az4ZHJI3ubpBamUQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*_cqFi3az4ZHJI3ubpBamUQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*_cqFi3az4ZHJI3ubpBamUQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*_cqFi3az4ZHJI3ubpBamUQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*_cqFi3az4ZHJI3ubpBamUQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*_cqFi3az4ZHJI3ubpBamUQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*_cqFi3az4ZHJI3ubpBamUQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be gs gt c" width="700" height="151" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*_cqFi3az4ZHJI3ubpBamUQ.png"></picture></div></div><figcaption class="to fc qs tp tq tr ts bc b bd z dr" data-selectable-paragraph=""><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/glue.c#L854" rel="noopener ugc nofollow" target="_blank">glue.c#L854</a> — the</figcaption></figure><p id="3cf7" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">The repository source code has a commented-out <code class="cu uo up uq tg b">856</code> line, which is used. We can double-check it by following it in the debugger:</p><figure class="ta tb tc td te gq tp tq paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq wj"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*kw45VHaEkq8_pclTaP99jA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*kw45VHaEkq8_pclTaP99jA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*kw45VHaEkq8_pclTaP99jA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*kw45VHaEkq8_pclTaP99jA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*kw45VHaEkq8_pclTaP99jA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*kw45VHaEkq8_pclTaP99jA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kw45VHaEkq8_pclTaP99jA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*kw45VHaEkq8_pclTaP99jA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*kw45VHaEkq8_pclTaP99jA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*kw45VHaEkq8_pclTaP99jA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*kw45VHaEkq8_pclTaP99jA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*kw45VHaEkq8_pclTaP99jA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*kw45VHaEkq8_pclTaP99jA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*kw45VHaEkq8_pclTaP99jA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be gs gt c" width="700" height="341" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*kw45VHaEkq8_pclTaP99jA.png"></picture></div></div></figure><p id="9ab4" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">The <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/xnu/blob/1031c584a5e37aff177559b9f69dbd3c8c3fd30a/osfmk/kern/ipc_tt.c#L1395" rel="noopener ugc nofollow" target="_blank">task_self_trap()</a></code> syscall gives the caller send rights for his own thread port, and the <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/xnu/blob/1031c584a5e37aff177559b9f69dbd3c8c3fd30a/osfmk/kern/ipc_tt.c#L1420" rel="noopener ugc nofollow" target="_blank">mach_reply_port()</a></code> syscall allocates a port for the caller.</p><p id="122b" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph=""><em class="rt">The task port represents the Mach task for the current process and is essential for interacting with the </em><a class="af rg" href="https://developer.apple.com/library/archive/documentation/Darwin/Conceptual/KernelProgramming/Mach/Mach.html" rel="noopener ugc nofollow" target="_blank"><em class="rt">Mach microkernel</em></a><em class="rt">, which I will discuss in another article.</em></p></div></div><div class="gq"><div class="ab by"><div class="lq tt lr tu ls tv cc tw cd tx cf be"><figure class="ta tb tc td te gq ue uf paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq wk"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*otGw9EHPr_z_PU-Y3tBI-g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*otGw9EHPr_z_PU-Y3tBI-g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*otGw9EHPr_z_PU-Y3tBI-g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*otGw9EHPr_z_PU-Y3tBI-g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*otGw9EHPr_z_PU-Y3tBI-g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*otGw9EHPr_z_PU-Y3tBI-g.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*otGw9EHPr_z_PU-Y3tBI-g.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*otGw9EHPr_z_PU-Y3tBI-g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*otGw9EHPr_z_PU-Y3tBI-g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*otGw9EHPr_z_PU-Y3tBI-g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*otGw9EHPr_z_PU-Y3tBI-g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*otGw9EHPr_z_PU-Y3tBI-g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*otGw9EHPr_z_PU-Y3tBI-g.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*otGw9EHPr_z_PU-Y3tBI-g.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be gs gt c" width="1000" height="300" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*otGw9EHPr_z_PU-Y3tBI-g.png"></picture></div></div><figcaption class="to fc qs tp tq tr ts bc b bd z dr" data-selectable-paragraph=""><a class="af rg" href="https://github.com/apple-oss-distributions/xnu/blob/1031c584a5e37aff177559b9f69dbd3c8c3fd30a/osfmk/kern/ipc_tt.c#L1406" rel="noopener ugc nofollow" target="_blank">ipc_tt.c#L1406</a></figcaption></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><p id="2949" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">After that, Dyld extracts <code class="cu uo up uq tg b">apple</code> variables from the <code class="cu uo up uq tg b">KernelArgs</code>. These shown up earlier in the stack frame at the <code class="cu uo up uq tg b">__dyld_start</code> (marked as red):</p></div></div><div class="gq"><div class="ab by"><div class="lq tt lr tu ls tv cc tw cd tx cf be"><figure class="ta tb tc td te gq ue uf paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq wl"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*L0lE8xjpevtc-Lsuc_bENA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*L0lE8xjpevtc-Lsuc_bENA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*L0lE8xjpevtc-Lsuc_bENA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*L0lE8xjpevtc-Lsuc_bENA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*L0lE8xjpevtc-Lsuc_bENA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*L0lE8xjpevtc-Lsuc_bENA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*L0lE8xjpevtc-Lsuc_bENA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*L0lE8xjpevtc-Lsuc_bENA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*L0lE8xjpevtc-Lsuc_bENA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*L0lE8xjpevtc-Lsuc_bENA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*L0lE8xjpevtc-Lsuc_bENA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*L0lE8xjpevtc-Lsuc_bENA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*L0lE8xjpevtc-Lsuc_bENA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*L0lE8xjpevtc-Lsuc_bENA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be gs gt c" width="1000" height="507" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*L0lE8xjpevtc-Lsuc_bENA.png"></picture></div></div><figcaption class="to fc qs tp tq tr ts bc b bd z dr" data-selectable-paragraph="">They are described in XNU <a class="af rg" href="https://github.com/apple-oss-distributions/xnu/blob/1031c584a5e37aff177559b9f69dbd3c8c3fd30a/bsd/kern/kern_exec.c#L5816" rel="noopener ugc nofollow" target="_blank">kern_exec.c#L5816</a></figcaption></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><p id="854a" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">Three functions provide convenient ways to access specific arrays within the args array of the <code class="cu uo up uq tg b">KernelArgs</code> class. The <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/DyldProcessConfig.cpp#L173" rel="noopener ugc nofollow" target="_blank">findArgv()</a></code> returns the <code class="cu uo up uq tg b">argv</code> array, <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/DyldProcessConfig.cpp#L178" rel="noopener ugc nofollow" target="_blank">findEnvp()</a></code> returns the <code class="cu uo up uq tg b">envp</code> array, and <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/DyldProcessConfig.cpp#L184" rel="noopener ugc nofollow" target="_blank">findApple()</a></code> returns the <code class="cu uo up uq tg b">apple</code> array by finding its starting point after the <code class="cu uo up uq tg b">envp</code> array:</p><figure class="ta tb tc td te gq tp tq paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq wm"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*IdY9K2NmExNfMZkyXgX_uQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*IdY9K2NmExNfMZkyXgX_uQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*IdY9K2NmExNfMZkyXgX_uQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*IdY9K2NmExNfMZkyXgX_uQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*IdY9K2NmExNfMZkyXgX_uQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*IdY9K2NmExNfMZkyXgX_uQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IdY9K2NmExNfMZkyXgX_uQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*IdY9K2NmExNfMZkyXgX_uQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*IdY9K2NmExNfMZkyXgX_uQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*IdY9K2NmExNfMZkyXgX_uQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*IdY9K2NmExNfMZkyXgX_uQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*IdY9K2NmExNfMZkyXgX_uQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*IdY9K2NmExNfMZkyXgX_uQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*IdY9K2NmExNfMZkyXgX_uQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be gs gt c" width="700" height="503" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*IdY9K2NmExNfMZkyXgX_uQ.png"></picture></div></div><figcaption class="to fc qs tp tq tr ts bc b bd z dr" data-selectable-paragraph=""><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/DyldProcessConfig.cpp#L173" rel="noopener ugc nofollow" target="_blank">DyldProcessConfig.cpp#L173</a></figcaption></figure><p id="cacc" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">Then the <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/glue.c#L203" rel="noopener ugc nofollow" target="_blank">__guard_setup()</a></code> function extracts the <code class="cu uo up uq tg b">stack_guard</code> value from all <code class="cu uo up uq tg b">apple</code> values and utilizes it as a <a class="af rg" href="https://medium.com/@karol-mazurek/snake-apple-iii-checksec-ed64a4b766c1" rel="noopener">stack cookie</a> <code class="cu uo up uq tg b">__stack_chk_guard</code>.</p><figure class="ta tb tc td te gq tp tq paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq wn"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*p7aKKn0zDl0wy5IyMRKimQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*p7aKKn0zDl0wy5IyMRKimQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*p7aKKn0zDl0wy5IyMRKimQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*p7aKKn0zDl0wy5IyMRKimQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*p7aKKn0zDl0wy5IyMRKimQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*p7aKKn0zDl0wy5IyMRKimQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p7aKKn0zDl0wy5IyMRKimQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*p7aKKn0zDl0wy5IyMRKimQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*p7aKKn0zDl0wy5IyMRKimQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*p7aKKn0zDl0wy5IyMRKimQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*p7aKKn0zDl0wy5IyMRKimQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*p7aKKn0zDl0wy5IyMRKimQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*p7aKKn0zDl0wy5IyMRKimQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*p7aKKn0zDl0wy5IyMRKimQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be gs gt c" width="700" height="441" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*p7aKKn0zDl0wy5IyMRKimQ.png"></picture></div></div><figcaption class="to fc qs tp tq tr ts bc b bd z dr" data-selectable-paragraph=""><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/glue.c#L203" rel="noopener ugc nofollow" target="_blank">https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/glue.c#L203</a></figcaption></figure><p id="1b5e" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">As we follow the execution in lldb, we can confirm the value in <code class="cu uo up uq tg b">__stack_chk_guard</code> is the same as the value from <code class="cu uo up uq tg b">apple</code> <code class="cu uo up uq tg b">stack_guard</code>:</p></div></div><div class="gq"><div class="ab by"><div class="lq tt lr tu ls tv cc tw cd tx cf be"><figure class="ta tb tc td te gq ue uf paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq wo"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*KjUBnlnp-U8mrhDZtlSyhQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*KjUBnlnp-U8mrhDZtlSyhQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*KjUBnlnp-U8mrhDZtlSyhQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*KjUBnlnp-U8mrhDZtlSyhQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*KjUBnlnp-U8mrhDZtlSyhQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*KjUBnlnp-U8mrhDZtlSyhQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*KjUBnlnp-U8mrhDZtlSyhQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*KjUBnlnp-U8mrhDZtlSyhQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*KjUBnlnp-U8mrhDZtlSyhQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*KjUBnlnp-U8mrhDZtlSyhQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*KjUBnlnp-U8mrhDZtlSyhQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*KjUBnlnp-U8mrhDZtlSyhQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*KjUBnlnp-U8mrhDZtlSyhQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*KjUBnlnp-U8mrhDZtlSyhQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be gs gt c" width="1000" height="382" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*KjUBnlnp-U8mrhDZtlSyhQ.png"></picture></div></div></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><p id="28c0" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">The final step in the <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/dyldMain.cpp#L1205" rel="noopener ugc nofollow" target="_blank">initializeLibc</a></code> function is to initialize subsystem support in Libc by calling <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/Libc/blob/c5a3293354e22262702a3add5b2dfc9bb0b93b85/darwin/subsystem.c#L43" rel="noopener ugc nofollow" target="_blank">_subsystem_init</a></code>, using extracted <code class="cu uo up uq tg b">apple</code> array.</p><figure class="ta tb tc td te gq tp tq paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq wp"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*8TmMlkGwIKFU7TvdpgluCQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*8TmMlkGwIKFU7TvdpgluCQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*8TmMlkGwIKFU7TvdpgluCQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*8TmMlkGwIKFU7TvdpgluCQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*8TmMlkGwIKFU7TvdpgluCQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*8TmMlkGwIKFU7TvdpgluCQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8TmMlkGwIKFU7TvdpgluCQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*8TmMlkGwIKFU7TvdpgluCQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*8TmMlkGwIKFU7TvdpgluCQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*8TmMlkGwIKFU7TvdpgluCQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*8TmMlkGwIKFU7TvdpgluCQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*8TmMlkGwIKFU7TvdpgluCQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*8TmMlkGwIKFU7TvdpgluCQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*8TmMlkGwIKFU7TvdpgluCQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be gs gt c" width="700" height="241" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*8TmMlkGwIKFU7TvdpgluCQ.png"></picture></div></div><figcaption class="to fc qs tp tq tr ts bc b bd z dr" data-selectable-paragraph=""><a class="af rg" href="https://github.com/apple-oss-distributions/Libc/blob/c5a3293354e22262702a3add5b2dfc9bb0b93b85/darwin/subsystem.c#L39" rel="noopener ugc nofollow" target="_blank">subsystem.c</a></figcaption></figure><p id="d0fd" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">It only works if a <code class="cu uo up uq tg b">SUBSYSTEM_ROOT_PATH_KEY</code> exists in the apple array. Below, you can see a breakpoint at the return address from <code class="cu uo up uq tg b">_subsystem_init</code>:</p><figure class="ta tb tc td te gq tp tq paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq wq"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*_YfjxNt4rcjJlJU8Hsu2Ng.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*_YfjxNt4rcjJlJU8Hsu2Ng.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*_YfjxNt4rcjJlJU8Hsu2Ng.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*_YfjxNt4rcjJlJU8Hsu2Ng.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*_YfjxNt4rcjJlJU8Hsu2Ng.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*_YfjxNt4rcjJlJU8Hsu2Ng.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_YfjxNt4rcjJlJU8Hsu2Ng.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*_YfjxNt4rcjJlJU8Hsu2Ng.png 640w, https://miro.medium.com/v2/resize:fit:720/1*_YfjxNt4rcjJlJU8Hsu2Ng.png 720w, https://miro.medium.com/v2/resize:fit:750/1*_YfjxNt4rcjJlJU8Hsu2Ng.png 750w, https://miro.medium.com/v2/resize:fit:786/1*_YfjxNt4rcjJlJU8Hsu2Ng.png 786w, https://miro.medium.com/v2/resize:fit:828/1*_YfjxNt4rcjJlJU8Hsu2Ng.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*_YfjxNt4rcjJlJU8Hsu2Ng.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*_YfjxNt4rcjJlJU8Hsu2Ng.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be gs gt c" width="700" height="380" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*_YfjxNt4rcjJlJU8Hsu2Ng.png"></picture></div></div></figure><blockquote class="ru rv rw"><p id="e151" class="mn mo rt mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">The final step — <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/Libc/blob/c5a3293354e22262702a3add5b2dfc9bb0b93b85/darwin/subsystem.c#L43" rel="noopener ugc nofollow" target="_blank"><em class="he">_subsystem_init</em></a></code> allows to use <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/Libc/blob/c5a3293354e22262702a3add5b2dfc9bb0b93b85/darwin/subsystem.h#L31" rel="noopener ugc nofollow" target="_blank"><em class="he">open_with_subsystem</em></a></code>.</p></blockquote></div></div></div><div class="ab by rm rn ro rp" role="separator"><span class="rq bv bj rr rs oc"></span><span class="rq bv bj rr rs oc"></span><span class="rq bv bj rr rs"></span></div><div class="gl gm gn go gp"><div class="ab by"><div class="cf be fx fy fz ga"><h1 id="2d54" class="rx ry he bc rz sa sb sc sd se sf sg sh si sj sk sl sm sn so sp sq sr ss st su bh" data-selectable-paragraph="">END — handleDyldInCache</h1><p id="0a46" class="pw-post-body-paragraph mn mo he mp b mq sv ms mt mu sw mw mx my sx na nb nc sy ne nf ng sz ni nj nk gl bh" data-selectable-paragraph="">Now, we are on this big conditional branch that will jump from 1 to 2 because the <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/common/MachOFile.cpp#L718" rel="noopener ugc nofollow" target="_blank">inDyldCache()</a></code> (explained earlier) returns <code class="cu uo up uq tg b">false</code>.</p><figure class="ta tb tc td te gq tp tq paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq wr"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*z2Sfe04rXQGzrWfmfkn1Dg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*z2Sfe04rXQGzrWfmfkn1Dg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*z2Sfe04rXQGzrWfmfkn1Dg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*z2Sfe04rXQGzrWfmfkn1Dg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*z2Sfe04rXQGzrWfmfkn1Dg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*z2Sfe04rXQGzrWfmfkn1Dg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z2Sfe04rXQGzrWfmfkn1Dg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*z2Sfe04rXQGzrWfmfkn1Dg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*z2Sfe04rXQGzrWfmfkn1Dg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*z2Sfe04rXQGzrWfmfkn1Dg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*z2Sfe04rXQGzrWfmfkn1Dg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*z2Sfe04rXQGzrWfmfkn1Dg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*z2Sfe04rXQGzrWfmfkn1Dg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*z2Sfe04rXQGzrWfmfkn1Dg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be gs gt c" width="700" height="1016" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*z2Sfe04rXQGzrWfmfkn1Dg.png"></picture></div></div></figure><p id="3667" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">If we use lldb, the jump is taken from <code class="cu uo up uq tg b">start+460</code> to <code class="cu uo up uq tg b">start+984</code>:</p><figure class="ta tb tc td te gq tp tq paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq ws"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*C9J0PIyFxVL0P3N7WdnDig.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*C9J0PIyFxVL0P3N7WdnDig.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*C9J0PIyFxVL0P3N7WdnDig.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*C9J0PIyFxVL0P3N7WdnDig.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*C9J0PIyFxVL0P3N7WdnDig.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*C9J0PIyFxVL0P3N7WdnDig.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C9J0PIyFxVL0P3N7WdnDig.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*C9J0PIyFxVL0P3N7WdnDig.png 640w, https://miro.medium.com/v2/resize:fit:720/1*C9J0PIyFxVL0P3N7WdnDig.png 720w, https://miro.medium.com/v2/resize:fit:750/1*C9J0PIyFxVL0P3N7WdnDig.png 750w, https://miro.medium.com/v2/resize:fit:786/1*C9J0PIyFxVL0P3N7WdnDig.png 786w, https://miro.medium.com/v2/resize:fit:828/1*C9J0PIyFxVL0P3N7WdnDig.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*C9J0PIyFxVL0P3N7WdnDig.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*C9J0PIyFxVL0P3N7WdnDig.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be gs gt c" width="700" height="191" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*C9J0PIyFxVL0P3N7WdnDig.png"></picture></div></div></figure><p id="498a" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">We then land two steps from the function <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/main/common/MachOFile.cpp#L812" rel="noopener ugc nofollow" target="_blank">isBuiltForSimulator</a></code>:</p><figure class="ta tb tc td te gq tp tq paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq wt"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*FOe1Y3ijLOdS6pE3jSzIFw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*FOe1Y3ijLOdS6pE3jSzIFw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*FOe1Y3ijLOdS6pE3jSzIFw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*FOe1Y3ijLOdS6pE3jSzIFw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*FOe1Y3ijLOdS6pE3jSzIFw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*FOe1Y3ijLOdS6pE3jSzIFw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FOe1Y3ijLOdS6pE3jSzIFw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*FOe1Y3ijLOdS6pE3jSzIFw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*FOe1Y3ijLOdS6pE3jSzIFw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*FOe1Y3ijLOdS6pE3jSzIFw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*FOe1Y3ijLOdS6pE3jSzIFw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*FOe1Y3ijLOdS6pE3jSzIFw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*FOe1Y3ijLOdS6pE3jSzIFw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*FOe1Y3ijLOdS6pE3jSzIFw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be gs gt c" width="700" height="172" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*FOe1Y3ijLOdS6pE3jSzIFw.png"></picture></div></div></figure><p id="6bf9" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">The branch we fall into in the Dyld GitHub repository source code is under <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/dyldMain.cpp#L1030" rel="noopener ugc nofollow" target="_blank">handleDyldInCache</a></code> function, which follows previously <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/dyldMain.cpp#L1205" rel="noopener ugc nofollow" target="_blank">initializeLibc</a></code>.</p><figure class="ta tb tc td te gq tp tq paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq wu"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*6N5ZA2pNW3Y37UznMYbZMA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*6N5ZA2pNW3Y37UznMYbZMA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*6N5ZA2pNW3Y37UznMYbZMA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*6N5ZA2pNW3Y37UznMYbZMA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*6N5ZA2pNW3Y37UznMYbZMA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*6N5ZA2pNW3Y37UznMYbZMA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6N5ZA2pNW3Y37UznMYbZMA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*6N5ZA2pNW3Y37UznMYbZMA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*6N5ZA2pNW3Y37UznMYbZMA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*6N5ZA2pNW3Y37UznMYbZMA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*6N5ZA2pNW3Y37UznMYbZMA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*6N5ZA2pNW3Y37UznMYbZMA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*6N5ZA2pNW3Y37UznMYbZMA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*6N5ZA2pNW3Y37UznMYbZMA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be gs gt c" width="700" height="114" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*6N5ZA2pNW3Y37UznMYbZMA.png"></picture></div></div><figcaption class="to fc qs tp tq tr ts bc b bd z dr" data-selectable-paragraph=""><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/dyldMain.cpp#L1207" rel="noopener ugc nofollow" target="_blank">dyldMain.cpp</a></figcaption></figure><p id="87d5" class="pw-post-body-paragraph mn mo he mp b mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk gl bh" data-selectable-paragraph="">In the following articles, we will explore this function branch-by-branch, as shown in the image below, until we reach <code class="cu uo up uq tg b"><a class="af rg" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/dyld/dyldMain.cpp#L1070" rel="noopener ugc nofollow" target="_blank">restartWithDyldInCache</a></code>.</p></div></div><div class="gq"><div class="ab by"><div class="lq tt lr tu ls tv cc tw cd tx cf be"><figure class="ta tb tc td te gq ue uf paragraph-image"><div role="button" tabindex="0" class="ug uh fg ui be uj"><div class="tp tq wv"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*b9duZLC8fhHjBiqL3zv3KA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*b9duZLC8fhHjBiqL3zv3KA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*b9duZLC8fhHjBiqL3zv3KA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*b9duZLC8fhHjBiqL3zv3KA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*b9duZLC8fhHjBiqL3zv3KA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*b9duZLC8fhHjBiqL3zv3KA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*b9duZLC8fhHjBiqL3zv3KA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*b9duZLC8fhHjBiqL3zv3KA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*b9duZLC8fhHjBiqL3zv3KA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*b9duZLC8fhHjBiqL3zv3KA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*b9duZLC8fhHjBiqL3zv3KA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*b9duZLC8fhHjBiqL3zv3KA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*b9duZLC8fhHjBiqL3zv3KA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*b9duZLC8fhHjBiqL3zv3KA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be gs gt c" width="1000" height="649" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*b9duZLC8fhHjBiqL3zv3KA.png"></picture></div></div></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><blockquote class="ww"><p id="bb16" class="wx wy he bc wz xa xb xc xd xe xf nk dr" data-selectable-paragraph="">Continued in <a class="af rg" rel="noopener" href="/dyld-do-you-like-death-ii-b74360b8af47">DYLD — Do You Like Death? (II)</a></p></blockquote></div></div></div></div></section></div></div></article><div class="ab by"><div class="cf be fx fy fz ga"></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><div class="xg xh ab jf"><div class="pg ab"><a class="xi av am ao" href="https://medium.com/tag/programming?source=post_page-----8199faad040e---------------programming-----------------" rel="noopener follow"><div class="oo fg cu xj gc xk xl bc b bd z bh xm">Programming</div></a></div><div class="pg ab"><a class="xi av am ao" href="https://medium.com/tag/apple?source=post_page-----8199faad040e---------------apple-----------------" rel="noopener follow"><div class="oo fg cu xj gc xk xl bc b bd z bh xm">Apple</div></a></div><div class="pg ab"><a class="xi av am ao" href="https://medium.com/tag/macos?source=post_page-----8199faad040e---------------macos-----------------" rel="noopener follow"><div class="oo fg cu xj gc xk xl bc b bd z bh xm">Macos</div></a></div><div class="pg ab"><a class="xi av am ao" href="https://medium.com/tag/cybersecurity?source=post_page-----8199faad040e---------------cybersecurity-----------------" rel="noopener follow"><div class="oo fg cu xj gc xk xl bc b bd z bh xm">Cybersecurity</div></a></div><div class="pg ab"><a class="xi av am ao" href="https://medium.com/tag/reverse-engineering?source=post_page-----8199faad040e---------------reverse_engineering-----------------" rel="noopener follow"><div class="oo fg cu xj gc xk xl bc b bd z bh xm">Reverse Engineering</div></a></div></div></div></div><div class="l"></div><footer class="nl nm nn no np nq nr ns hb ab q nt nu c"><div class="l ae"><div class="ab by"><div class="cf be fx fy fz ga"><div class="ab cm nv"><div class="ab q ko"><div class="nw l"><span class="l nx ny nz e d"><div class="ab q ko kp"><div class="pw-multi-vote-icon fg gz kq kr ks"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F8199faad040e&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fdyld-do-you-like-death-i-8199faad040e&amp;user=Karol+Mazurek&amp;userId=3f7ab05f0f68&amp;source=-----8199faad040e---------------------clap_footer-----------" rel="noopener follow"><div><div class="bj" aria-hidden="false" aria-describedby="9" aria-labelledby="9"><div class="kt ao ku kv kw kx am ky kz la ks"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lb lc ld le lf lg lh"><div><div class="bj" aria-hidden="false" aria-describedby="68" aria-labelledby="68"><p class="bc b ds z dr"><button class="af ag ah ai aj ak al am an ao ap aq ar as at xn lo">115<span class="l h g f oa ob"></span></button></p></div></div></div></div></span><span class="l h g f oa ob"><div class="ab q ko kp"><div class="pw-multi-vote-icon fg gz kq kr ks"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F8199faad040e&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fdyld-do-you-like-death-i-8199faad040e&amp;user=Karol+Mazurek&amp;userId=3f7ab05f0f68&amp;source=-----8199faad040e---------------------clap_footer-----------" rel="noopener follow"><div><div class="bj" aria-hidden="false" aria-describedby="10" aria-labelledby="10"><div class="kt ao ku kv kw kx am ky kz la ks"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lb lc ld le lf lg lh"><div><div class="bj" aria-hidden="false" aria-describedby="70" aria-labelledby="70"><p class="bc b ds z dr"><button class="af ag ah ai aj ak al am an ao ap aq ar as at xn lo">115</button></p></div></div></div></div></span></div><div class="bn ab"><div><div class="bj" aria-hidden="false" aria-describedby="11" aria-labelledby="11"><button class="ao kt lj lk ab q fh ll lm" aria-label="responses"><svg width="24" height="24" viewBox="0 0 24 24" class="gr"><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></button></div></div></div></div><div class="ab q"><div class="oc l jc"><div><div class="bj" aria-hidden="false" aria-describedby="12" aria-labelledby="12"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8199faad040e&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fdyld-do-you-like-death-i-8199faad040e&amp;source=--------------------------bookmark_footer-----------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dr lo" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div><div class="oc l jc"><div class="bj" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bj" aria-hidden="false" aria-describedby="13" aria-labelledby="13"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fh ah ai aj ak al lv an ao ap eu lw lx lm ly"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.22 4.93a.42.42 0 0 1-.12.13h.01a.45.45 0 0 1-.29.08.52.52 0 0 1-.3-.13L12.5 3v7.07a.5.5 0 0 1-.5.5.5.5 0 0 1-.5-.5V3.02l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.8a.42.42 0 0 1 .07.5zm-.1.14zm.88 2h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11a2 2 0 0 1-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.14c.1.1.15.22.15.35a.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9V8.96c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1z" fill="currentColor"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="od oe of og oh l bu"><div class="ab by"><div class="cf be fx fy fz ga"><div class="ci ab oi cm"><div class="ab ik"><a rel="noopener follow" href="/?source=post_page-----8199faad040e--------------------------------"><div class="l oj ok bv ol io"><div class="l fg"><img alt="Karol Mazurek" class="l fa bv om on cu" src="https://miro.medium.com/v2/da:true/resize:fill:144:144/0*BLalJfMaz_JDj6fg" width="72" height="72" loading="lazy"><div class="ip bv l om on fp n iq fq"></div></div></div></a></div><div class="j i d"><div class="ab"><span><button class="bc b bd z el oo em eo ep eq er es et eu ev ew ex op ey ez fa bj fb fc">Follow</button></span><div class="dq l"><div><div><div class="bj" aria-hidden="false" aria-describedby="92" aria-labelledby="92"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe71c64288bc8&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fdyld-do-you-like-death-i-8199faad040e&amp;newsletterV3=3f7ab05f0f68&amp;newsletterV3Id=e71c64288bc8&amp;user=Karol+Mazurek&amp;userId=3f7ab05f0f68&amp;source=-----8199faad040e---------------------subscribe_user-----------" rel="noopener follow"><button class="bc b bd z ot am ou ov ow ox oy oz pa pb et eu ev ew ex ey ez fa bj fb fc" aria-label="Subscribe"><svg width="38" height="38" viewBox="0 0 38 38" fill="none" class="oq or os"><rect x="26.25" y="9.25" width="0.5" height="6.5" rx="0.25"></rect><rect x="29.75" y="12.25" width="0.5" height="6.5" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5L19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="ab ck cm"><div class="l"><div class="ab q"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/?source=post_page-----8199faad040e--------------------------------"><h2 class="pw-author-name bc pc pd pe pf bh"><span class="gl jh">Written by <!-- -->Karol Mazurek</span></h2></a></div><div class="pg ab"><div class="l jc"><span class="pw-follower-count bc b bd z bh"><a class="af ag ah ai aj ak al am an ao ap aq ar iv" rel="noopener follow" href="/followers?source=post_page-----8199faad040e--------------------------------">1.1K Followers</a></span></div></div><div class="ph l"><p class="bc b bd z bh"><span class="gl">Offensive Security Engineer</span></p></div></div><div class="h k"><div class="ab"><span><button class="bc b bd z el oo em eo ep eq er es et eu ev ew ex op ey ez fa bj fb fc">Follow</button></span><div class="dq l"><div><div><div class="bj" aria-hidden="false" aria-describedby="93" aria-labelledby="93"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe71c64288bc8&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fdyld-do-you-like-death-i-8199faad040e&amp;newsletterV3=3f7ab05f0f68&amp;newsletterV3Id=e71c64288bc8&amp;user=Karol+Mazurek&amp;userId=3f7ab05f0f68&amp;source=-----8199faad040e---------------------subscribe_user-----------" rel="noopener follow"><button class="bc b bd z ot am ou ov ow ox oy oz pa pb et eu ev ew ex ey ez fa bj fb fc" aria-label="Subscribe"><svg width="38" height="38" viewBox="0 0 38 38" fill="none" class="oq or os"><rect x="26.25" y="9.25" width="0.5" height="6.5" rx="0.25"></rect><rect x="29.75" y="12.25" width="0.5" height="6.5" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5L19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="pi be pj gu gv gw gx gy"></div></div></div><div class="h k j"><div class="pi be pj pk"></div><div class="ab by"><div class="cf be fx fy fz ga"><div class="pl ab ko jf"><div class="pm pn l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----8199faad040e--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Help</p></a></div><div class="pm pn l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----8199faad040e--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Status</p></a></div><div class="pm pn l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/about?autoplay=1&amp;source=post_page-----8199faad040e--------------------------------" rel="noopener follow"><p class="bc b ds z dr">About</p></a></div><div class="pm pn l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----8199faad040e--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Careers</p></a></div><div class="pm pn l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="mailto:pressinquiries@medium.com?source=post_page-----8199faad040e--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Press</p></a></div><div class="pm pn l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----8199faad040e--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Blog</p></a></div><div class="pm pn l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8199faad040e--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Privacy</p></a></div><div class="pm pn l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8199faad040e--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Terms</p></a></div><div class="pm pn l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----8199faad040e--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Text to speech</p></a></div><div class="pm l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/business?source=post_page-----8199faad040e--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20240614-221838-3ba87a70fa"</script><script>window.__GRAPHQL_URI__ = "https://karol-mazurek.medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-8199faad040e","user-3f7ab05f0f68"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"updatedPostPreviewsEnabled":true,"lohpExperimentEnabled":"group_2","prideLogoEnabled":true},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":true,"routingEntity":{"type":"USER","id":"3f7ab05f0f68","explicit":true},"viewerIsBot":false},"debug":{"requestId":"6f2f4836-01c6-4f64-a37e-1a479126eb05","hybridDevServices":[],"originalSpanCarrier":{"ot-tracer-spanid":"7e5ca4ab144624ee","ot-tracer-traceid":"37896a461d2fb766","ot-tracer-sampled":"true"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fkarol-mazurek.medium.com\u002Fdyld-do-you-like-death-i-8199faad040e","host":"karol-mazurek.medium.com","hostname":"karol-mazurek.medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20240614-221838-3ba87a70fa","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20240614-221838-3ba87a70fa","commit":"3ba87a70fa89456c9162015acb3c1797c92f4b41"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"1*OMF3fSqH8t4xBJ9-6oZDZw.png","height":106,"width":545},"postLogo":{"imageId":"1*kFrc4tBFM_tCis-2Ic87WA.png","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","isLoggedIn":false,"viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"karol-mazurek.medium.com\"})":null,"postResult({\"id\":\"8199faad040e\"})":{"__ref":"Post:8199faad040e"}},"MastodonAccount:karmaz@infosec.exchange":{"__typename":"MastodonAccount","domain":"infosec.exchange","username":"karmaz","id":"karmaz@infosec.exchange"},"LinkedAccounts:3f7ab05f0f68":{"__typename":"LinkedAccounts","mastodon":{"__ref":"MastodonAccount:karmaz@infosec.exchange"},"id":"3f7ab05f0f68"},"UserViewerEdge:userId:3f7ab05f0f68-viewerId:lo_9b8a45aa89d5":{"__typename":"UserViewerEdge","id":"userId:3f7ab05f0f68-viewerId:lo_9b8a45aa89d5","isFollowing":false,"isUser":false,"isMuting":false},"NewsletterV3:e71c64288bc8":{"__typename":"NewsletterV3","id":"e71c64288bc8","type":"NEWSLETTER_TYPE_AUTHOR","slug":"3f7ab05f0f68","name":"3f7ab05f0f68","collection":null,"user":{"__ref":"User:3f7ab05f0f68"}},"User:3f7ab05f0f68":{"__typename":"User","id":"3f7ab05f0f68","name":"Karol Mazurek","username":"karol-mazurek","newsletterV3":{"__ref":"NewsletterV3:e71c64288bc8"},"linkedAccounts":{"__ref":"LinkedAccounts:3f7ab05f0f68"},"isSuspended":false,"imageId":"0*BLalJfMaz_JDj6fg","mediumMemberAt":0,"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":1142},"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"karol-mazurek.medium.com"}},"hasSubdomain":true,"bio":"Offensive Security Engineer","isPartnerProgramEnrolled":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:3f7ab05f0f68-viewerId:lo_9b8a45aa89d5"},"viewerIsUser":false,"postSubscribeMembershipUpsellShownAt":0,"allowNotes":true,"membership":null,"twitterScreenName":""},"ImageMetadata:0*eC65dt7XWcdWafVu":{"__typename":"ImageMetadata","id":"0*eC65dt7XWcdWafVu","originalHeight":914,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:0f52d893cb4f_0":{"__typename":"Paragraph","id":"0f52d893cb4f_0","name":"91a9","type":"IMG","href":null,"layout":"FULL_WIDTH","metadata":{"__ref":"ImageMetadata:0*eC65dt7XWcdWafVu"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0f52d893cb4f_1":{"__typename":"Paragraph","id":"0f52d893cb4f_1","name":"9a9a","type":"H3","href":null,"layout":null,"metadata":null,"text":"DYLD — Do You Like Death? (I)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0f52d893cb4f_2":{"__typename":"Paragraph","id":"0f52d893cb4f_2","name":"e77f","type":"P","href":null,"layout":null,"metadata":null,"text":"The lifecycle of a Dynamic Loader from its creation to its termination.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0f52d893cb4f_3":{"__typename":"Paragraph","id":"0f52d893cb4f_3","name":"ad32","type":"P","href":null,"layout":null,"metadata":null,"text":"This series contains my notes on debugging Dyld-1122 and analysing its source code. They are arranged in order from the beginning of the startup process, specifically when XNU just loaded the Dyld to memory.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:0f52d893cb4f_4":{"__typename":"Paragraph","id":"0f52d893cb4f_4","name":"3f12","type":"P","href":null,"layout":null,"metadata":null,"text":"I will not publish the whole analysis in one article, as it would be hard to follow and require a lot of…","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Tag:programming":{"__typename":"Tag","id":"programming","displayTitle":"Programming","normalizedTagSlug":"programming"},"Tag:apple":{"__typename":"Tag","id":"apple","displayTitle":"Apple","normalizedTagSlug":"apple"},"Tag:macos":{"__typename":"Tag","id":"macos","displayTitle":"Macos","normalizedTagSlug":"macos"},"Tag:cybersecurity":{"__typename":"Tag","id":"cybersecurity","displayTitle":"Cybersecurity","normalizedTagSlug":"cybersecurity"},"Tag:reverse-engineering":{"__typename":"Tag","id":"reverse-engineering","displayTitle":"Reverse Engineering","normalizedTagSlug":"reverse-engineering"},"Post:8199faad040e":{"__typename":"Post","id":"8199faad040e","collection":null,"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":true,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":null,"startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:0f52d893cb4f_0"},{"__ref":"Paragraph:0f52d893cb4f_1"},{"__ref":"Paragraph:0f52d893cb4f_2"},{"__ref":"Paragraph:0f52d893cb4f_3"},{"__ref":"Paragraph:0f52d893cb4f_4"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:3f7ab05f0f68"},"inResponseToEntityType":null,"isLocked":true,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_UGC","mediumUrl":"https:\u002F\u002Fkarol-mazurek.medium.com\u002Fdyld-do-you-like-death-i-8199faad040e","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"programming"}],"isPublished":true,"latestPublishedVersion":"0f52d893cb4f","visibility":"LOCKED","postResponses":{"__typename":"PostResponses","count":0},"createdAt":1706703733679,"firstPublishedAt":1706720121056,"latestPublishedAt":1707404608184,"clapCount":115,"allowResponses":true,"isLimitedState":false,"title":"DYLD — Do You Like Death? (I)","isSeries":false,"sequence":null,"uniqueSlug":"dyld-do-you-like-death-i-8199faad040e","socialTitle":"","socialDek":"","noIndex":null,"canonicalUrl":"","metaDescription":"","readingTime":7.955660377358491,"previewContent":{"__typename":"PreviewContent","subtitle":"The lifecycle of a Dynamic Loader from its creation to its termination."},"previewImage":{"__ref":"ImageMetadata:0*eC65dt7XWcdWafVu"},"isShortform":false,"seoTitle":"DYLD — Do You Like Death? (I)","updatedAt":1707404608184,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"The lifecycle of a Dynamic Loader from its creation to its termination. Debugging Dyld and analysing its source code from the start () to handleDyldInCache().","isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:programming"},{"__ref":"Tag:apple"},{"__ref":"Tag:macos"},{"__ref":"Tag:cybersecurity"},{"__ref":"Tag:reverse-engineering"}],"isNewsletter":false,"statusForCollection":null,"pendingCollection":null,"detectedLanguage":"en","wordCount":1353,"layerCake":0}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"MISS"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.3cc5e3b6.js"></script><script src="https://cdn-client.medium.com/lite/static/js/2640.3217006c.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.7db0aaff.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.4ddbf12e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.2021fe63.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4398.db4d4378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7883.0e445e04.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9281.e9be8bce.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7111.b294e9da.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6481.362dec70.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8695.6f58679b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8978.4b110123.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3418.eb013b5a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3894.e3d01e2c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5514.32e692f6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5203.e7f058c5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7098.93054372.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8051.0a9d3f4b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8558.abbaadfd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1711.7605eb3e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8597.762eae49.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9174.b1b0f607.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8883.2f95bbf4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/705.e5898c57.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2911.d072adec.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8580.feeb2549.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6046.f9be485b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/500.d5389c14.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9408.22b56993.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6605.84e81b15.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6637.661bd7cf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7421.3f94f5ea.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/51.d8fb2684.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2133.c8ba56b1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.81dff084.chunk.js"></script><script>window.main();</script><script defer="" src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon="{&quot;rayId&quot;:&quot;89427b4a39fcb347&quot;,&quot;version&quot;:&quot;2024.4.1&quot;,&quot;token&quot;:&quot;0b5f665943484354a59c39c6833f7078&quot;}" crossorigin="anonymous"></script>
<div><div class="px n xo xp ph xq xr xs xt xu xv xw qw xx qx ce bm rq xy xz lj ya yb"><div class="bc b ds z yc"><div class="ab cm yd ye"><div class="l" role="alert">To make Medium work, we log user data. By using Medium, you agree to our <a class="af ag ah ai aj ak al am an ao ap yf yg rg" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9" rel="noopener follow" target="_blank">Privacy Policy</a>, including cookie policy.</div><div class="yh yi yj yk yl ym l yn jc yo"><div class="l fg n yp"><button class="af ag ah ai aj ak al am an ao ap yf yg yq yr ab" data-testid="close-button" aria-label="close"><svg width="19" height="19" viewBox="0 0 19 19" class="em el"><path d="M13.8 4.6L9.5 8.89 5.21 4.6l-.61.61 4.29 4.3-4.29 4.28.61.62 4.3-4.3 4.28 4.3.62-.62-4.3-4.29 4.3-4.29" fill-rule="evenodd"></path></svg></button></div></div></div></div></div></div></body></html>