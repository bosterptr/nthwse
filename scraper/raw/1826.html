<html lang="en" data-rh="lang"><head><title>Snake&amp;Apple I — Mach-O files on ARM64 | Medium</title><meta data-rh="true" charset="utf-8"><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"><meta data-rh="true" name="theme-color" content="#000000"><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"><meta data-rh="true" property="al:ios:app_name" content="Medium"><meta data-rh="true" property="al:ios:app_store_id" content="828256236"><meta data-rh="true" property="al:android:package" content="com.medium.reader"><meta data-rh="true" property="fb:app_id" content="542599432471018"><meta data-rh="true" property="og:site_name" content="Medium"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-12-24T10:44:34.009Z"><meta data-rh="true" name="title" content="Snake&amp;Apple I — Mach-O files on ARM64 | Medium"><meta data-rh="true" property="og:title" content="Snake&amp;Apple I —  Mach-O"><meta data-rh="true" property="al:android:url" content="medium://p/a8eda4b87263"><meta data-rh="true" property="al:ios:url" content="medium://p/a8eda4b87263"><meta data-rh="true" property="al:android:app_name" content="Medium"><meta data-rh="true" name="description" content="This article is a deep dive into Mach-O files on ARM-based macOS and provides low-level information about the Mach-O file format."><meta data-rh="true" property="og:description" content="Deep dive in Mach-O files on ARM64 macOS with Python."><meta data-rh="true" property="og:url" content="https://karol-mazurek.medium.com/snake-apple-i-mach-o-a8eda4b87263"><meta data-rh="true" property="al:web:url" content="https://karol-mazurek.medium.com/snake-apple-i-mach-o-a8eda4b87263"><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/da:true/resize:fit:1200/0*HgjbPiuRBfG57HPL"><meta data-rh="true" property="article:author" content="https://karol-mazurek.medium.com"><meta data-rh="true" name="author" content="Karol Mazurek"><meta data-rh="true" name="robots" content="index,follow,max-image-preview:large"><meta data-rh="true" name="referrer" content="unsafe-url"><meta data-rh="true" property="twitter:title" content="Snake&amp;Apple I —  Mach-O"><meta data-rh="true" name="twitter:site" content="@Medium"><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/a8eda4b87263"><meta data-rh="true" property="twitter:description" content="Deep dive in Mach-O files on ARM64 macOS with Python."><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/da:true/resize:fit:1200/0*HgjbPiuRBfG57HPL"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="twitter:label1" content="Reading time"><meta data-rh="true" name="twitter:data1" content="20 min read"><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/1*m-R_BkNf1Qjr1YbyOIJY2w.png"><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:152:152/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:120:120/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:76:76/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:60:60/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/Medium-Avatar-500x500.svg" color="#171717"><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossorigin=""><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"><link data-rh="true" rel="author" href="https://karol-mazurek.medium.com"><link data-rh="true" rel="canonical" href="https://karol-mazurek.medium.com/snake-apple-i-mach-o-a8eda4b87263"><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/a8eda4b87263"><style type="text/css" data-fela-rehydration="471" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="471" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-webkit-keyframes k1{0%{transform:translate(-50%, -100px)}100%{transform:translate(-50%, 0)}}@-moz-keyframes k1{0%{transform:translate(-50%, -100px)}100%{transform:translate(-50%, 0)}}@keyframes k1{0%{transform:translate(-50%, -100px)}100%{transform:translate(-50%, 0)}}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{margin-left:16px}.av{border:none}.aw{border-radius:20px}.ax{width:240px}.ay{background:#F9F9F9}.az path{fill:#6B6B6B}.bb{outline:none}.bc{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bd{font-size:14px}.be{width:100%}.bf{padding:10px 20px 10px 0}.bg{background-color:transparent}.bh{color:#242424}.bi::placeholder{color:#6B6B6B}.bj{display:inline-block}.bk{margin-left:12px}.bl{margin-right:12px}.bm{border-radius:4px}.bn{margin-left:24px}.bo{height:24px}.bu{background-color:#F9F9F9}.bv{border-radius:50%}.bw{height:32px}.bx{width:32px}.by{justify-content:center}.ce{max-width:680px}.cf{min-width:0}.cg{animation:k1 1.2s ease-in-out infinite}.ch{height:100vh}.ci{margin-bottom:16px}.cj{margin-top:48px}.ck{align-items:flex-start}.cl{flex-direction:column}.cm{justify-content:space-between}.cn{margin-bottom:24px}.ct{width:80%}.cu{background-color:#F2F2F2}.da{height:44px}.db{width:44px}.dc{margin:auto 0}.dd{margin-bottom:4px}.de{height:16px}.df{width:120px}.dg{width:80px}.dm{margin-bottom:8px}.dn{width:96%}.do{width:98%}.dp{width:81%}.dq{margin-left:8px}.dr{color:#6B6B6B}.ds{font-size:13px}.dt{height:100%}.el{color:#FFFFFF}.em{fill:#FFFFFF}.eo{background:#1A8917}.ep{border-color:#1A8917}.et:disabled{cursor:inherit !important}.eu:disabled{opacity:0.3}.ev:disabled:hover{background:#1A8917}.ew:disabled:hover{border-color:#1A8917}.ex{border-radius:99em}.ey{border-width:1px}.ez{border-style:solid}.fa{box-sizing:border-box}.fb{text-decoration:none}.fc{text-align:center}.ff{margin-right:32px}.fg{position:relative}.fh{fill:#6B6B6B}.fk{background:transparent}.fl svg{margin-left:4px}.fm svg{fill:#6B6B6B}.fo{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fp{position:absolute}.fr{display:none}.fx{margin:0 24px}.gb{background:rgba(255, 255, 255, 1)}.gc{border:1px solid #F2F2F2}.gd{box-shadow:0 1px 4px #F2F2F2}.ge{max-height:100vh}.gf{overflow-y:auto}.gg{left:0}.gh{top:calc(100vh + 100px)}.gi{bottom:calc(100vh + 100px)}.gj{width:10px}.gk{pointer-events:none}.gq{margin-right:4px}.gr{margin-top:2px}.gs{box-sizing:content-box}.gt{word-break:break-word}.gu{word-wrap:break-word}.gv:after{display:block}.gw:after{content:""}.gx:after{clear:both}.gy{line-height:1.23}.gz{letter-spacing:0}.ha{font-style:normal}.hb{font-weight:700}.hw{margin-top:0px}.hx{@media all and (max-width: 551.98px):8px}.hy{@media all and (min-width: 552px) and (max-width: 727.98px):8px}.hz{@media all and (min-width: 728px) and (max-width: 903.98px):16px}.ia{@media all and (min-width: 904px) and (max-width: 1079.98px):16px}.ib{@media all and (min-width: 1080px):16px}.ih{align-items:baseline}.ii{width:48px}.ij{height:48px}.ik{border:2px solid rgba(255, 255, 255, 1)}.il{z-index:0}.im{box-shadow:none}.in{border:1px solid rgba(0, 0, 0, 0.05)}.io{margin-bottom:2px}.ip{flex-wrap:nowrap}.iq{font-size:16px}.ir{line-height:24px}.it{margin:0 8px}.iu{display:inline}.iv{color:#1A8917}.iw{fill:#1A8917}.iz{flex:0 0 auto}.jc{flex-wrap:wrap}.jd{padding-left:8px}.je{padding-right:8px}.kf> *{flex-shrink:0}.kg{overflow-x:scroll}.kh::-webkit-scrollbar{display:none}.ki{scrollbar-width:none}.kj{-ms-overflow-style:none}.kk{width:74px}.kl{flex-direction:row}.km{z-index:2}.kp{-webkit-user-select:none}.kq{border:0}.kr{fill:rgba(117, 117, 117, 1)}.ku{outline:0}.kv{user-select:none}.kw> svg{pointer-events:none}.lf{cursor:progress}.lg{margin-left:4px}.lh{opacity:1}.li{padding:4px 0}.ll{width:16px}.ln{display:inline-flex}.lt{max-width:100%}.lu{padding:8px 2px}.lv svg{color:#6B6B6B}.mm{line-height:1.58}.mn{letter-spacing:-0.004em}.mo{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.nj{margin-bottom:-0.46em}.nk{margin-left:auto}.nl{margin-right:auto}.nm{max-width:1600px}.ns{clear:both}.nu{cursor:zoom-in}.nv{z-index:auto}.nx{height:auto}.ny{line-height:1.12}.nz{letter-spacing:-0.022em}.oa{font-weight:600}.ov{margin-bottom:-0.28em}.pb{border-top:none}.ph{height:52px}.pi{max-height:52px}.pj{position:static}.pk{z-index:1}.pm{max-width:155px}.ps{margin-right:20px}.py{align-items:flex-end}.pz{width:76px}.qa{height:76px}.qb{border:2px solid #F9F9F9}.qc{height:72px}.qd{width:72px}.qe{padding:8px 16px}.qf{width:auto}.qg{stroke:#F2F2F2}.qh{height:36px}.qi{width:36px}.qj{color:#F2F2F2}.qk{fill:#F2F2F2}.ql{background:#F2F2F2}.qm{border-color:#F2F2F2}.qs{font-weight:500}.qt{font-size:24px}.qu{line-height:30px}.qv{letter-spacing:-0.016em}.qw{margin-top:8px}.qx{margin-top:16px}.qy{height:0px}.qz{border-bottom:solid 1px #E5E5E5}.ra{margin-top:72px}.rb{padding:24px 0}.rc{margin-bottom:0px}.rd{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.eq:hover{background:#156D12}.er:hover{border-color:#156D12}.es:hover{cursor:pointer}.fi:hover{color:#242424}.fj:hover{fill:#242424}.fn:hover svg{fill:#242424}.fq:hover{background-color:rgba(0, 0, 0, 0.1)}.is:hover{text-decoration:underline}.ix:hover:not(:disabled){color:#156D12}.iy:hover:not(:disabled){fill:#156D12}.kt:hover{fill:rgba(8, 8, 8, 1)}.lj:hover{fill:#000000}.lk:hover p{color:#000000}.lm:hover{color:#000000}.lw:hover svg{color:#000000}.qn:hover{background:#F2F2F2}.qo:hover{border-color:#F2F2F2}.qp:hover{cursor:wait}.qq:hover{color:#F2F2F2}.qr:hover{fill:#F2F2F2}.ba:focus-within path{fill:#242424}.ks:focus{fill:rgba(8, 8, 8, 1)}.lx:focus svg{color:#000000}.nw:focus{transform:scale(1.01)}.kx:active{border-style:none}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bt{width:64px}.cd{margin:0 64px}.cs{height:48px}.cz{margin-bottom:52px}.dl{margin-bottom:48px}.ec{font-size:14px}.ed{line-height:20px}.ej{font-size:13px}.ek{padding:5px 12px}.fe{display:flex}.fw{margin-bottom:68px}.ga{max-width:680px}.gp{margin-top:40px}.hs{font-size:42px}.ht{margin-bottom:32px}.hu{line-height:52px}.hv{letter-spacing:-0.011em}.ig{align-items:center}.jr{border-top:solid 1px #F2F2F2}.js{border-bottom:solid 1px #F2F2F2}.jt{margin:32px 0 0}.ju{padding:3px 8px}.kd> *{margin-right:24px}.ke> :last-child{margin-right:0}.le{margin-top:0px}.ls{margin:0}.nf{font-size:20px}.ng{margin-top:2.14em}.nh{line-height:32px}.ni{letter-spacing:-0.003em}.nr{margin-top:56px}.or{font-size:24px}.os{margin-top:1.95em}.ot{line-height:30px}.ou{letter-spacing:-0.016em}.pa{margin-top:0.94em}.pg{margin-bottom:88px}.pr{display:inline-block}.px{padding-top:72px}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.ld{margin-top:0px}.pq{display:inline-block}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.lc{margin-top:0px}.pp{display:inline-block}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.la{margin-top:0px}.lb{margin-right:0px}.po{display:inline-block}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bp{width:24px}.bz{margin:0 24px}.co{height:40px}.cv{margin-bottom:44px}.dh{margin-bottom:32px}.du{font-size:13px}.dv{line-height:20px}.ee{padding:0px 8px 1px}.fs{margin-bottom:4px}.gl{margin-top:32px}.hc{font-size:32px}.hd{margin-bottom:24px}.he{line-height:38px}.hf{letter-spacing:-0.014em}.ic{align-items:flex-start}.ja{flex-direction:column}.jf{margin:24px -24px 0}.jg{padding:0}.jv> *{margin-right:8px}.jw> :last-child{margin-right:24px}.kn{margin-left:0px}.ky{margin-top:0px}.kz{margin-right:0px}.lo{margin:0}.ly{border:1px solid #F2F2F2}.lz{border-radius:99em}.ma{padding:0px 16px 0px 12px}.mb{height:38px}.mc{align-items:center}.me svg{margin-right:8px}.mp{font-size:18px}.mq{margin-top:1.56em}.mr{line-height:28px}.ms{letter-spacing:-0.003em}.nn{margin-top:40px}.ob{font-size:20px}.oc{margin-top:1.2em}.od{line-height:24px}.oe{letter-spacing:0}.ow{margin-top:0.67em}.pc{margin-bottom:80px}.pn{display:inline-block}.pt{padding-top:48px}.md:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bs{width:64px}.cc{margin:0 64px}.cr{height:48px}.cy{margin-bottom:52px}.dk{margin-bottom:48px}.ea{font-size:14px}.eb{line-height:20px}.eh{font-size:13px}.ei{padding:5px 12px}.fd{display:flex}.fv{margin-bottom:68px}.fz{max-width:680px}.go{margin-top:40px}.ho{font-size:42px}.hp{margin-bottom:32px}.hq{line-height:52px}.hr{letter-spacing:-0.011em}.if{align-items:center}.jn{border-top:solid 1px #F2F2F2}.jo{border-bottom:solid 1px #F2F2F2}.jp{margin:32px 0 0}.jq{padding:3px 8px}.kb> *{margin-right:24px}.kc> :last-child{margin-right:0}.lr{margin:0}.nb{font-size:20px}.nc{margin-top:2.14em}.nd{line-height:32px}.ne{letter-spacing:-0.003em}.nq{margin-top:56px}.on{font-size:24px}.oo{margin-top:1.95em}.op{line-height:30px}.oq{letter-spacing:-0.016em}.oz{margin-top:0.94em}.pf{margin-bottom:88px}.pw{padding-top:72px}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.br{width:64px}.cb{margin:0 48px}.cq{height:48px}.cx{margin-bottom:52px}.dj{margin-bottom:48px}.dy{font-size:13px}.dz{line-height:20px}.eg{padding:0px 8px 1px}.fu{margin-bottom:68px}.fy{max-width:680px}.gn{margin-top:40px}.hk{font-size:42px}.hl{margin-bottom:32px}.hm{line-height:52px}.hn{letter-spacing:-0.011em}.ie{align-items:center}.jj{border-top:solid 1px #F2F2F2}.jk{border-bottom:solid 1px #F2F2F2}.jl{margin:32px 0 0}.jm{padding:3px 8px}.jz> *{margin-right:24px}.ka> :last-child{margin-right:0}.lq{margin:0}.mx{font-size:20px}.my{margin-top:2.14em}.mz{line-height:32px}.na{letter-spacing:-0.003em}.np{margin-top:56px}.oj{font-size:24px}.ok{margin-top:1.95em}.ol{line-height:30px}.om{letter-spacing:-0.016em}.oy{margin-top:0.94em}.pe{margin-bottom:88px}.pv{padding-top:72px}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bq{width:24px}.ca{margin:0 24px}.cp{height:40px}.cw{margin-bottom:44px}.di{margin-bottom:32px}.dw{font-size:13px}.dx{line-height:20px}.ef{padding:0px 8px 1px}.ft{margin-bottom:4px}.gm{margin-top:32px}.hg{font-size:32px}.hh{margin-bottom:24px}.hi{line-height:38px}.hj{letter-spacing:-0.014em}.id{align-items:flex-start}.jb{flex-direction:column}.jh{margin:24px 0 0}.ji{padding:0}.jx> *{margin-right:8px}.jy> :last-child{margin-right:8px}.ko{margin-left:0px}.lp{margin:0}.mf{border:1px solid #F2F2F2}.mg{border-radius:99em}.mh{padding:0px 16px 0px 12px}.mi{height:38px}.mj{align-items:center}.ml svg{margin-right:8px}.mt{font-size:18px}.mu{margin-top:1.56em}.mv{line-height:28px}.mw{letter-spacing:-0.003em}.no{margin-top:40px}.of{font-size:20px}.og{margin-top:1.2em}.oh{line-height:24px}.oi{letter-spacing:0}.ox{margin-top:0.67em}.pd{margin-bottom:80px}.pu{padding-top:48px}.mk:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE" media="print">.pl{display:none}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.nt{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style><script type="text/javascript" async="" src="https://www.gstatic.com/recaptcha/releases/TqxSU0dsOd2Q9IbI7CpFnJLD/recaptcha__pl.js" crossorigin="anonymous" integrity="sha384-EtuwsrUt4o3rjKbOIgbMlrdETicyC7YJiOMF4S2kRPR2c6EcUDPrB1OFkiSEO3IC"></script><script async="" src="https://cdn.branch.io/branch-latest.min.js"></script><script type="application/ld+json" data-rh="true">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fda:true\u002Fresize:fit:1200\u002F0*HgjbPiuRBfG57HPL"],"url":"https:\u002F\u002Fkarol-mazurek.medium.com\u002Fsnake-apple-i-mach-o-a8eda4b87263","dateCreated":"2023-12-23T09:33:55.033Z","datePublished":"2023-12-23T09:33:55.033Z","dateModified":"2024-01-03T08:02:10.272Z","headline":"Snake&Apple I — Mach-O files on ARM64 | Medium","name":"Snake&Apple I — Mach-O files on ARM64 | Medium","description":"This article is a deep dive into Mach-O files on ARM-based macOS and provides low-level information about the Mach-O file format.","identifier":"a8eda4b87263","author":{"@type":"Person","name":"Karol Mazurek","url":"https:\u002F\u002Fkarol-mazurek.medium.com"},"creator":["Karol Mazurek"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fkarol-mazurek.medium.com\u002F","logo":{"@type":"ImageObject","width":308,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:385\u002F1*OMF3fSqH8t4xBJ9-6oZDZw.png"}},"mainEntityOfPage":"https:\u002F\u002Fkarol-mazurek.medium.com\u002Fsnake-apple-i-mach-o-a8eda4b87263","isAccessibleForFree":"False","hasPart":{"@type":"WebPageElement","isAccessibleForFree":"False","cssSelector":".meteredContent"}}</script><script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-7JY7T788PK" data-rh="true"></script><script data-rh="true">window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'G-7JY7T788PK');</script><script type="text/javascript" data-rh="true">(function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src="https://cdn.branch.io/branch-latest.min.js";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,"script","branch",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},"addListener applyCode autoAppIndex banner closeBanner closeJourney creditHistory credits data deepview deepviewCta first getCode init link logout redeem referrals removeListener sendSMS setBranchViewData setIdentity track validateCode trackCommerceEvent logEvent".split(" "), 0);
branch.init('key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm', {metadata: {}, 'no_journeys': true, 'disable_exit_animation': true, 'disable_entry_animation': true, 'tracking_disabled': null}, function(err, data) {});</script><script src="https://www.google.com/recaptcha/enterprise.js?render=6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp" data-rh="true"></script><script charset="utf-8" data-webpack="lite:chunk-1878" src="https://cdn-client.medium.com/lite/static/js/1878.73a360f3.chunk.js"></script><script charset="utf-8" data-webpack="lite:chunk-7906" src="https://cdn-client.medium.com/lite/static/js/7906.47ff48f1.chunk.js"></script><script charset="utf-8" data-webpack="lite:chunk-1689" src="https://cdn-client.medium.com/lite/static/js/1689.cf9af42c.chunk.js"></script></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div><script>if (window.self !== window.top) window.location = "about:blank"</script></div><div class="l c"><div class="l m n o c" style="transform: translateY(0px);"><div class="p q r s t u v w x i d y z"><a class="dr ag ds bc ak b am an ao ap aq ar as at s u w i d q dt z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa8eda4b87263&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderUser&amp;source=---two_column_layout_nav----------------------------------" rel="noopener follow">Open in app<svg width="10" height="10" viewBox="0 0 10 10" fill="none" class="dq"><path d="M.98 8.48a.37.37 0 1 0 .54.54l-.54-.54zm7.77-7.23h.38c0-.2-.17-.38-.38-.38v.38zM8.37 6.5a.37.37 0 1 0 .76 0h-.76zM3.5.87a.37.37 0 1 0 0 .76V.88zM1.52 9.03l7.5-7.5-.54-.54-7.5 7.5.54.54zm6.86-7.77V6.5h.74V1.25h-.74zm-4.88.38h5.25V.88H3.5v.74z" fill="currentColor"></path></svg></a><div class="ab q"><p class="bc b du dv dw dx dy dz ea eb ec ed dr"><span><button class="bc b du dv ee dw dx ef dy dz eg eh eb ei ej ed ek el em eo ep eq er es et eu ev ew ex ey ez fa bj fb fc" data-testid="headerSignUpButton">Sign up</button></span></p><div class="au l"><p class="bc b du dv dw dx dy dz ea eb ec ed dr"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fsnake-apple-i-mach-o-a8eda4b87263&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=---two_column_layout_nav----------------------------------" rel="noopener follow"><svg width="120" height="27" viewBox="0 0 120 27" fill="none"><mask id="logo-wordmark-pride_svg__a" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="1" y="0" width="119" height="27"><path d="M29.69 2.36h.03v-.29h-7.26L15.7 18.05 8.96 2.07H1.12v.28l.04.01c1.32.3 2 .75 2 2.37v19c0 1.62-.68 2.07-2 2.37h-.04v.29h5.31v-.28H6.4c-1.33-.3-2-.76-2-2.38V5.83l8.67 20.56h.5l8.91-21.13V24.2c-.1 1.28-.78 1.67-1.98 1.95h-.03v.28h9.25v-.27l-.03-.01c-1.2-.28-1.89-.67-2-1.95V4.73c0-1.62.67-2.07 2-2.37zm4.23 12.58c.15-3.41 1.37-5.87 3.4-5.92.64.01 1.17.22 1.58.62.87.86 1.28 2.64 1.22 5.3h-6.2zm-.1.96h10.86v-.04c-.03-2.61-.78-4.64-2.23-6.03a7.3 7.3 0 0 0-5.05-1.87h-.04a7.31 7.31 0 0 0-5.75 2.78 10.4 10.4 0 0 0-2.08 5.72l-.02.2a7.61 7.61 0 0 0-.02.56v.58c.11 5.09 2.84 9.16 7.69 9.16 4.25 0 6.73-3.14 7.35-7.34l-.32-.11c-1.08 2.26-3.03 3.63-5.25 3.46-3.03-.23-5.35-3.32-5.13-7.06m23.12 6.89c-.36.85-1.1 1.32-2.1 1.32s-1.9-.7-2.55-1.94a12.23 12.23 0 0 1-1.06-5.49c0-4.68 1.45-7.7 3.68-7.7.94 0 1.68.47 2.03 1.28V22.8zm7.2 3.33c-1.33-.31-2-.78-2-2.49V.96l-8.07 2.39v.3l.05-.01c1.11-.1 1.87.06 2.3.47.35.32.52.8.52 1.5v3.1a5.18 5.18 0 0 0-2.89-.75c-2.33 0-4.45.98-5.99 2.78-1.6 1.86-2.44 4.42-2.44 7.38 0 5.28 2.58 8.84 6.43 8.84a5.09 5.09 0 0 0 4.89-3.34v2.81h7.23v-.29h-.03zm6.9-22.09c0-1.65-1.23-2.9-2.87-2.9a2.87 2.87 0 0 0-2.9 2.9c0 1.63 1.27 2.9 2.9 2.9a2.82 2.82 0 0 0 2.88-2.9zm1.91 22.1c-1.32-.32-2-.8-2-2.5V8.01l-7.24 2.1v.28h.05c1.56.14 1.99.68 1.99 2.53v13.51H73v-.29h-.04zm18.54 0c-1.33-.32-2-.8-2-2.5V8.01l-6.89 2.02v.29h.04c1.28.14 1.65.71 1.65 2.56v9.88a2.48 2.48 0 0 1-2.2 1.4c-1.57 0-2.43-1.08-2.43-3.02V8.01l-7.24 2.1v.28h.04c1.57.14 2 .68 2 2.53v8.36c0 .58.05 1.16.15 1.74l.13.57c.61 2.21 2.22 3.37 4.73 3.37 2.13 0 4-1.33 4.82-3.4v2.88h7.23v-.3h-.03zm28.1.3v-.3h-.03c-1.44-.34-2-.97-2-2.26V13.25c0-3.31-1.85-5.3-4.95-5.3a5.08 5.08 0 0 0-4.9 3.37c-.58-2.17-2.25-3.36-4.73-3.36a4.7 4.7 0 0 0-4.61 3.1V8.02l-7.23 2v.3h.04c1.55.14 2 .7 2 2.49v13.63h6.74v-.29h-.03c-1.15-.28-1.52-.78-1.52-2.05V11.9c.3-.71.91-1.56 2.13-1.56 1.5 0 2.26 1.05 2.26 3.12v12.97h6.75v-.29h-.03c-1.15-.28-1.52-.78-1.52-2.05V13.25a7 7 0 0 0-.1-1.21c.32-.78.97-1.7 2.23-1.7 1.53 0 2.27 1.02 2.27 3.12v12.97h7.23z" fill="#242424"></path></mask><g filter="url(#logo-wordmark-pride_svg__filter0_f_238_6555)" mask="url(#logo-wordmark-pride_svg__a)"><path d="M42.3-64.7l-15.52-6.74L-24.62 47l15.53 6.74L42.3-64.7z" fill="#000"></path><path d="M53.18-59.98L42.3-64.7-9.1 53.74l10.88 4.72 51.4-118.44z" fill="#603917"></path><path d="M64.96-54.87l-11.78-5.11L1.78 58.46l11.79 5.11 51.4-118.44z" fill="#71E2FD"></path><path d="M75.84-50.15l-10.88-4.72-51.4 118.44 10.89 4.72L75.84-50.15z" fill="#FF9BC9"></path><path d="M86.71-45.43l-10.87-4.72L24.44 68.3l10.88 4.72 51.4-118.44z" fill="#FF472F"></path><path d="M97.6-40.7L86.7-45.44 35.32 73.01l10.88 4.72L97.6-40.7z" fill="#FF8312"></path><path d="M108.47-35.99L97.6-40.7 46.2 77.73l10.88 4.72 51.4-118.44z" fill="#FFCE00"></path><path d="M120.25-30.88l-11.78-5.1-51.4 118.43 11.79 5.11 51.4-118.44z" fill="#48E348"></path><path d="M131.13-26.16l-10.88-4.72L68.86 87.56l10.88 4.72 51.4-118.44z" fill="#008EF0"></path><path d="M148.48-18.63l-17.35-7.53-51.4 118.44 17.35 7.53 51.4-118.44z" fill="#9A50FC"></path></g><defs><filter id="logo-wordmark-pride_svg__filter0_f_238_6555" x="-29.5" y="-76.33" width="182.87" height="181.03" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood><feBlend in="SourceGraphic" in2="BackgroundImageFix" result="shape"></feBlend><feGaussianBlur stdDeviation="2.45" result="effect1_foregroundBlur_238_6555"></feGaussianBlur></filter></defs></svg></a><div class="au h"><div class="ab av aw ax ay q az ba"><div class="bj" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bk bl ab"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.1 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0zm6.94-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .8-.79l-3.74-3.73A8.05 8.05 0 0 0 11.04 3v.01z" fill="currentColor"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="av bb bc bd z be bf bg bh bi" placeholder="Search" value=""></div></div></div><div class="h k w fd fe"><div class="ff ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---two_column_layout_nav-----------------------new_post_topnav-----------" rel="noopener follow"><div class="bc b bd z dr fg fh ab q fi fj"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-label="Write"><path d="M14 4a.5.5 0 0 0 0-1v1zm7 6a.5.5 0 0 0-1 0h1zm-7-7H4v1h10V3zM3 4v16h1V4H3zm1 17h16v-1H4v1zm17-1V10h-1v10h1zm-1 1a1 1 0 0 0 1-1h-1v1zM3 20a1 1 0 0 0 1 1v-1H3zM4 3a1 1 0 0 0-1 1h1V3z" fill="currentColor"></path><path d="M17.5 4.5l-8.46 8.46a.25.25 0 0 0-.06.1l-.82 2.47c-.07.2.12.38.31.31l2.47-.82a.25.25 0 0 0 .1-.06L19.5 6.5m-2-2l2.32-2.32c.1-.1.26-.1.36 0l1.64 1.64c.1.1.1.26 0 .36L19.5 6.5m-2-2l2 2" stroke="currentColor"></path></svg><div class="dq l">Write</div></div></a></span></div></div><div class="k j i d"><div class="ff ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" href="https://medium.com/search?source=---two_column_layout_nav----------------------------------" rel="noopener follow"><div class="bc b bd z dr fg fh ab q fi fj"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-label="Search"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.1 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0zm6.94-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .8-.79l-3.74-3.73A8.05 8.05 0 0 0 11.04 3v.01z" fill="currentColor"></path></svg></div></a></div></div><div class="ff h k j"><div class="ab q"><p class="bc b du dv dw dx dy dz ea eb ec ed dr"><span><button class="bc b du dv ee dw dx ef dy dz eg eh eb ei ej ed ek el em eo ep eq er es et eu ev ew ex ey ez fa bj fb fc" data-testid="headerSignUpButton">Sign up</button></span></p><div class="au l"><p class="bc b du dv dw dx dy dz ea eb ec ed dr"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fsnake-apple-i-mach-o-a8eda4b87263&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="av fk am ab q ao fl fm fn" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fg"><img alt="" class="l fa bv bw bx cu" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"><div class="fo bv l bw bx fp n av fq"></div></div></button></div></div></div><div class="fr"><a rel="me" href="https://infosec.exchange/@karmaz">Mastodon</a></div><div class="l"><div class="pl" role="dialog" aria-modal="true" tabindex="-1"><div class="rl rm be dt rn ro rp ao rq gk rr" aria-hidden="true" role="presentation"></div><div class="rs rn rt ru rv rl dt fa rw rx ry lh rz sa sb sc sd se sf sg sh" aria-hidden="true"></div></div><div class="fs ft fu fv fw l"><div class="ab by"><div class="cf be fx fy fz ga"></div></div><article class="meteredContent"><div class="l"><div class="l"><span class="l"></span><section><div><div class="fp gg gh gi gj gk"></div><div><div class="speechify-ignore l"><div class="tr ts tt tu tv l"></div><div class="ab by"><div class="cn dq tw be tx cf l"><div class="fg ty tz ua sr st ub ql"><p class="bc b bd z bh">You're reading for free via <a class="af ag ah ai aj ak al am an ao ap aq ar te" href="https://medium.com/@monethic?source=post_page-----a8eda4b87263--------------------------------" rel="noopener follow">Monethic.io's</a> Friend Link. <span><a class="af ag ah ai aj ak al am an ao ap aq ar te" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fsnake-apple-i-mach-o-a8eda4b87263&amp;source=-----a8eda4b87263---------------------post_friend_link_meter-----------" rel="noopener follow">Become a member</a></span> to access the best of Medium.</p></div><div class="uj uk ul um un l"><div class="fp uc ud gv ue uf ug uh ui"></div></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><div class="ci l"><div class="gs ab"><div class="bj" aria-hidden="false" aria-describedby="2" aria-labelledby="2"><button class="l av ao am" aria-label="Member-only story"><div class="h k j i d"><div><div class="bj" aria-hidden="false" aria-describedby="1" aria-labelledby="1"><svg width="16" height="16" viewBox="0 0 64 64" fill="none"><path d="M39.64 40.83L33.87 56.7a1.99 1.99 0 0 1-3.74 0l-5.77-15.87a2.02 2.02 0 0 0-1.2-1.2L7.3 33.88a1.99 1.99 0 0 1 0-3.74l15.87-5.77a2.02 2.02 0 0 0 1.2-1.2L30.12 7.3a1.99 1.99 0 0 1 3.74 0l5.77 15.87a2.02 2.02 0 0 0 1.2 1.2l15.86 5.76a1.99 1.99 0 0 1 0 3.74l-15.87 5.77a2.02 2.02 0 0 0-1.2 1.2z" fill="#FFC017"></path></svg></div></div></div><div class="s u w fd fe q"><svg width="16" height="16" viewBox="0 0 64 64" fill="none" class="gq gr"><path d="M39.64 40.83L33.87 56.7a1.99 1.99 0 0 1-3.74 0l-5.77-15.87a2.02 2.02 0 0 0-1.2-1.2L7.3 33.88a1.99 1.99 0 0 1 0-3.74l15.87-5.77a2.02 2.02 0 0 0 1.2-1.2L30.12 7.3a1.99 1.99 0 0 1 3.74 0l5.77 15.87a2.02 2.02 0 0 0 1.2 1.2l15.86 5.76a1.99 1.99 0 0 1 0 3.74l-15.87 5.77a2.02 2.02 0 0 0-1.2 1.2z" fill="#FFC017"></path></svg><p class="bc b bd z dr">Member-only story</p></div></button></div></div></div></div></div></div></div><div class="gt gu gv gw gx"><div class="ab by"><div class="cf be fx fy fz ga"><div><h1 id="5b80" class="pw-post-title gy gz ha bc hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu hv hw bh" data-testid="storyTitle" data-selectable-paragraph="">Snake&amp;Apple I — Mach-O</h1><div class="re rf rg rh ri"><div class="speechify-ignore ab cm"><div class="speechify-ignore be l"><div class="ic id ie if ig ab"><div><div class="ab ih"><a rel="noopener follow" href="/?source=post_page-----a8eda4b87263--------------------------------"><div><div class="bj" aria-hidden="false" aria-describedby="93" aria-labelledby="93"><div class="l ii ij bv ik il"><div class="l fg"><img alt="Karol Mazurek" class="l fa bv da db cu" src="https://miro.medium.com/v2/da:true/resize:fill:55:55/0*BLalJfMaz_JDj6fg" width="44" height="44" loading="lazy" data-testid="authorPhoto"><div class="im bv l da db fp n in fq"></div></div></div></div></div></a></div></div><div class="bk be l"><div class="ab"><div style="flex: 1 1 0%;"><span class="bc b bd z bh"><div class="io ab q"><div class="ab q ip"><div class="ab q"><div><div class="bj" aria-hidden="false" aria-describedby="94" aria-labelledby="94"><p class="bc b iq ir bh"><a class="af ag ah ai aj ak al am an ao ap aq ar is" data-testid="authorName" rel="noopener follow" href="/?source=post_page-----a8eda4b87263--------------------------------">Karol Mazurek</a></p></div></div></div><span class="it iu" aria-hidden="true"><span class="bc b bd z dr">·</span></span><p class="bc b iq ir dr"><span><a class="iv iw ah ai aj ak al am an ao ap aq ar eu ix iy" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3f7ab05f0f68&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fsnake-apple-i-mach-o-a8eda4b87263&amp;user=Karol+Mazurek&amp;userId=3f7ab05f0f68&amp;source=post_page-3f7ab05f0f68----a8eda4b87263---------------------post_header-----------" rel="noopener follow">Follow</a></span></p></div></div></span></div></div><div class="l iz"><span class="bc b bd z dr"><div class="ab ck ja jb jc"><span class="bc b bd z dr"><div class="ab ae"><span data-testid="storyReadTime">20 min read</span><div class="jd je l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bc b bd z dr">·</span></span></div><span data-testid="storyPublishDate">Dec 23, 2023</span></div></span></div></span></div></div></div><div class="ab cm jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju"><div class="h k w fd fe q"><div class="kk l"><div class="ab q kl km"><div class="pw-multi-vote-icon fg gq kn ko kp"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fa8eda4b87263&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fsnake-apple-i-mach-o-a8eda4b87263&amp;user=Karol+Mazurek&amp;userId=3f7ab05f0f68&amp;source=-----a8eda4b87263---------------------clap_footer-----------" rel="noopener follow"><div><div class="bj" aria-hidden="false" aria-describedby="95" aria-labelledby="95"><div class="kq ao kr ks kt ku am kv kw kx kp"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ky kz la lb lc ld le"><p class="bc b ds z dr"><span class="lf">--</span></p></div></div></div><div><div class="bj" aria-hidden="false" aria-describedby="96" aria-labelledby="96"><button class="ao kq lh li ab q fh lj lk" aria-label="responses"><svg width="24" height="24" viewBox="0 0 24 24" class="hw"><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg><p class="bc b ds z dr"><span class="pw-responses-count lg hw">1</span></p></button></div></div></div><div class="ab q jv jw jx jy jz ka kb kc kd ke kf kg kh rj rk"><div class="ll k j i d"></div><div class="h k"><div><div class="bj" aria-hidden="false" aria-describedby="97" aria-labelledby="97"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa8eda4b87263&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fsnake-apple-i-mach-o-a8eda4b87263&amp;source=-----a8eda4b87263---------------------bookmark_footer-----------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dr lm" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div><div class="fa ln ck"><div class="l ae"><div class="ab by"><div class="lo lp lq lr ls lt cf be"><div class="ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2Fplans%3Fdimension%3Dpost_audio_button%26postId%3Da8eda4b87263&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fsnake-apple-i-mach-o-a8eda4b87263&amp;source=-----a8eda4b87263---------------------post_audio_button-----------" rel="noopener follow"><div><div class="bj" aria-hidden="false" aria-describedby="98" aria-labelledby="98"><button aria-label="Listen" data-testid="audioPlayButton" class="af fh ah ai aj ak al lu an ao ap eu lv lw lk lx ly lz ma mb s mc md me mf mg mh mi u mj mk ml"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0zm9-10a10 10 0 1 0 0 20 10 10 0 0 0 0-20zm3.38 10.42l-4.6 3.06a.5.5 0 0 1-.78-.41V8.93c0-.4.45-.63.78-.41l4.6 3.06c.3.2.3.64 0 .84z" fill="currentColor"></path></svg><div class="j i d"><p class="bc b bd z dr">Listen</p></div></button></div></div></a></span></div></div></div></div></div><div class="bj" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bj" aria-hidden="false" aria-describedby="99" aria-labelledby="99"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fh ah ai aj ak al lu an ao ap eu lv lw lk lx ly lz ma mb s mc md me mf mg mh mi u mj mk ml"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.22 4.93a.42.42 0 0 1-.12.13h.01a.45.45 0 0 1-.29.08.52.52 0 0 1-.3-.13L12.5 3v7.07a.5.5 0 0 1-.5.5.5.5 0 0 1-.5-.5V3.02l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.8a.42.42 0 0 1 .07.5zm-.1.14zm.88 2h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11a2 2 0 0 1-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.14c.1.1.15.22.15.35a.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9V8.96c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1z" fill="currentColor"></path></svg><div class="j i d"><p class="bc b bd z dr">Share</p></div></button></div></div></div></div></div></div></div></div></div><p id="520c" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">Deep dive in Mach-O files on ARM64 macOS with Python.</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl nm"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*HgjbPiuRBfG57HPL 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*HgjbPiuRBfG57HPL 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*HgjbPiuRBfG57HPL 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*HgjbPiuRBfG57HPL 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*HgjbPiuRBfG57HPL 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*HgjbPiuRBfG57HPL 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*HgjbPiuRBfG57HPL 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/0*HgjbPiuRBfG57HPL 640w, https://miro.medium.com/v2/resize:fit:720/0*HgjbPiuRBfG57HPL 720w, https://miro.medium.com/v2/resize:fit:750/0*HgjbPiuRBfG57HPL 750w, https://miro.medium.com/v2/resize:fit:786/0*HgjbPiuRBfG57HPL 786w, https://miro.medium.com/v2/resize:fit:828/0*HgjbPiuRBfG57HPL 828w, https://miro.medium.com/v2/resize:fit:1100/0*HgjbPiuRBfG57HPL 1100w, https://miro.medium.com/v2/resize:fit:1400/0*HgjbPiuRBfG57HPL 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="400" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/0*HgjbPiuRBfG57HPL"></picture></div></div></figure></div></div></div><div class="ab by uo up uq ur" role="separator"><span class="su bv bj us ut ps"></span><span class="su bv bj us ut ps"></span><span class="su bv bj us ut"></span></div><div class="gt gu gv gw gx"><div class="ab by"><div class="cf be fx fy fz ga"><h1 id="1bf2" class="ny nz ha bc oa ob uu od oe of uv oh oi oj uw ol om on ux op oq or uy ot ou ov bh" data-selectable-paragraph="">INTRO</h1><p id="3ea1" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">Welcome to the first article in the series on macOS security internals!</p><p id="b743" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">This article provides in-depth information about the Mach-O file format and briefly introduces its loading process to virtual memory. You will learn how to determine if a file is valid Mach-O, its endianness, various Mach-O types, segmentation, the concept of chained fixups, and much more.</p><p id="3f34" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">Additionally, this article will explain how to extract important information from Mach-O files in human-readable form using <em class="uz">Python</em> and other tools.</p><p id="7add" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph=""><em class="uz">Please note that some topics have been intentionally omitted and will be addressed in future articles. However, leave a comment if you have any questions or need clarification about anything written here while reading. I guarantee a response and will use your feedback for future articles.</em></p><blockquote class="va vb vc"><p id="7f67" class="mm mn uz mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">The <a class="af te" href="https://github.com/Karmaz95/Snake_Apple/tree/main" rel="noopener ugc nofollow" target="_blank"><strong class="mo hb">Snake&amp;Apple I. Mach-O</strong></a> repository contains all of the code used below.</p></blockquote></div></div></div><div class="ab by uo up uq ur" role="separator"><span class="su bv bj us ut ps"></span><span class="su bv bj us ut ps"></span><span class="su bv bj us ut"></span></div><div class="gt gu gv gw gx"><div class="ab by"><div class="cf be fx fy fz ga"><h1 id="1d34" class="ny nz ha bc oa ob uu od oe of uv oh oi oj uw ol om on ux op oq or uy ot ou ov bh" data-selectable-paragraph="">Mach-O</h1><p id="396a" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">A file format used on <em class="uz">macOS</em> systems to store:</p><ul class=""><li id="e2e9" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vd ve vf bh" data-selectable-paragraph=""><strong class="mo hb">Executable file</strong> — application in a format that a <em class="uz">macOS</em> can understand and execute. The final form of software that users can run.</li></ul><pre class="nn no np nq nr vg vh vi bm vj ay bh"><span id="1b12" class="vk nz ha vh b bd vl vm l vn vo" data-selectable-paragraph="">clang -o hello hello.c</span></pre><ul class=""><li id="7c37" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vd ve vf bh" data-selectable-paragraph=""><strong class="mo hb">Object code (.o)</strong> — compiled source code that must be linked with other codes and libraries to create an executable file or shared library.</li></ul><pre class="nn no np nq nr vg vh vi bm vj ay bh"><span id="9d17" class="vk nz ha vh b bd vl vm l vn vo" data-selectable-paragraph="">clang -c -o hello.o hello.c</span></pre><ul class=""><li id="e214" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vd ve vf bh" data-selectable-paragraph=""><strong class="mo hb">Dynamic library (.dylib) — </strong>pre-compiled code that can be accessed by multiple programs loaded into memory when a program starts running.</li></ul><pre class="nn no np nq nr vg vh vi bm vj ay bh"><span id="8743" class="vk nz ha vh b bd vl vm l vn vo" data-selectable-paragraph="">clang -shared -o libmylib.dylib mylib.c</span></pre><ul class=""><li id="64b6" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vd ve vf bh" data-selectable-paragraph=""><a class="af te" href="https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/LoadingCode/Concepts/AboutLoadableBundles.html#//apple_ref/doc/uid/20001268-BCIDBAEJ" rel="noopener ugc nofollow" target="_blank"><strong class="mo hb">Loadable Bundle (plugin)</strong></a> — packages of executable code and related resources that can be loaded at runtime via <a class="af te" href="https://developer.apple.com/documentation/foundation/nsbundle" rel="noopener ugc nofollow" target="_blank">NSBundle</a> or <a class="af te" href="https://developer.apple.com/library/archive/documentation/System/Conceptual/ManPages_iPhoneOS/man3/dlopen.3.html" rel="noopener ugc nofollow" target="_blank">dlopen</a>.</li></ul><pre class="nn no np nq nr vg vh vi bm vj ay bh"><span id="42b7" class="vk nz ha vh b bd vl vm l vn vo" data-selectable-paragraph="">clang -bundle MyBundle.c -o MyBundle</span></pre><ul class=""><li id="38bb" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vd ve vf bh" data-selectable-paragraph=""><strong class="mo hb">dSYM </strong>— file generated when <code class="cu vp vq vr vh b">Strip Debug Symbols</code> is enabled in project build settings, containing debug symbols for debugging.</li></ul><pre class="nn no np nq nr vg vh vi bm vj ay bh"><span id="6b71" class="vk nz ha vh b bd vl vm l vn vo" data-selectable-paragraph="">clang -g -o hello_dsym hello.c</span></pre><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl vs"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*l_PXtNDLlpfbTEIt_AdL4A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*l_PXtNDLlpfbTEIt_AdL4A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*l_PXtNDLlpfbTEIt_AdL4A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*l_PXtNDLlpfbTEIt_AdL4A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*l_PXtNDLlpfbTEIt_AdL4A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*l_PXtNDLlpfbTEIt_AdL4A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l_PXtNDLlpfbTEIt_AdL4A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*l_PXtNDLlpfbTEIt_AdL4A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*l_PXtNDLlpfbTEIt_AdL4A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*l_PXtNDLlpfbTEIt_AdL4A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*l_PXtNDLlpfbTEIt_AdL4A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*l_PXtNDLlpfbTEIt_AdL4A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*l_PXtNDLlpfbTEIt_AdL4A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*l_PXtNDLlpfbTEIt_AdL4A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="101" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*l_PXtNDLlpfbTEIt_AdL4A.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph="">Five most common file types.</figcaption></figure><h2 id="e5f0" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">Mach-O structure</h2><p id="ec61" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph=""><em class="uz">Mach-O</em> consists of a <strong class="mo hb"><em class="uz">Header</em></strong> preceded by a sequence of <strong class="mo hb"><em class="uz">Load Commands</em></strong><em class="uz"> </em>and then one or more <strong class="mo hb"><em class="uz">Segments</em></strong><em class="uz"> </em>further<em class="uz"> </em>divided into<em class="uz"> </em><strong class="mo hb"><em class="uz">Sections</em></strong>.</p><p id="58b3" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">The core structure is a compilation of variable-length <strong class="mo hb"><em class="uz">Load Commands</em></strong> pointing to <strong class="mo hb"><em class="uz">data pages</em></strong> in the file. Here is a simplified overview:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl wl"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*OvPMbvKl6oBxgG5BShmgGA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*OvPMbvKl6oBxgG5BShmgGA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*OvPMbvKl6oBxgG5BShmgGA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*OvPMbvKl6oBxgG5BShmgGA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*OvPMbvKl6oBxgG5BShmgGA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*OvPMbvKl6oBxgG5BShmgGA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OvPMbvKl6oBxgG5BShmgGA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*OvPMbvKl6oBxgG5BShmgGA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*OvPMbvKl6oBxgG5BShmgGA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*OvPMbvKl6oBxgG5BShmgGA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*OvPMbvKl6oBxgG5BShmgGA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*OvPMbvKl6oBxgG5BShmgGA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*OvPMbvKl6oBxgG5BShmgGA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*OvPMbvKl6oBxgG5BShmgGA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="610" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*OvPMbvKl6oBxgG5BShmgGA.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph="">Simplified Mach-O structure</figcaption></figure><ul class=""><li id="e4e9" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vd ve vf bh" data-selectable-paragraph=""><strong class="mo hb">Header</strong> — metadata such as <em class="uz">file type</em> and <em class="uz">CPU architecture</em>.</li><li id="4468" class="mm mn ha mo b mp wm mr ms mt wn mv mw mx wo mz na nb wp nd ne nf wq nh ni nj vd ve vf bh" data-selectable-paragraph=""><strong class="mo hb">Load commands</strong> — instruct XNU and dyld on how to load the <em class="uz">Mach-O</em>.</li><li id="bb73" class="mm mn ha mo b mp wm mr ms mt wn mv mw mx wo mz na nb wp nd ne nf wq nh ni nj vd ve vf bh" data-selectable-paragraph=""><strong class="mo hb">Segments</strong> — instruct the kernel<em class="uz"> </em>how to map an area of the <em class="uz">Mach-O</em> into <em class="uz">virtual memory</em> and specify the <em class="uz">memory protections</em>.</li><li id="0e79" class="mm mn ha mo b mp wm mr ms mt wn mv mw mx wo mz na nb wp nd ne nf wq nh ni nj vd ve vf bh" data-selectable-paragraph=""><strong class="mo hb">Sections</strong> — data in <em class="uz">segments</em> that inherit their <em class="uz">memory protections</em>.</li></ul><h2 id="a8ca" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">Universal Binary (Fat Binary) — multiple Mach-O headers</h2><p id="4341" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">A multiple architecture binary is a concept in the<em class="uz"> Mach-O</em> file format used on <em class="uz">macOS</em> to create a single executable file containing compiled code for multiple processor architectures. Below, you can see its structure:</p></div></div><div class="ns"><div class="ab by"><div class="lo wr lp ws lq wt cc wu cd wv cf be"><figure class="nn no np nq nr ns ww wx paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl nm"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*pQB-pfG83FWz9ns1Qvlu4g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*pQB-pfG83FWz9ns1Qvlu4g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*pQB-pfG83FWz9ns1Qvlu4g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*pQB-pfG83FWz9ns1Qvlu4g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*pQB-pfG83FWz9ns1Qvlu4g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*pQB-pfG83FWz9ns1Qvlu4g.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*pQB-pfG83FWz9ns1Qvlu4g.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*pQB-pfG83FWz9ns1Qvlu4g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*pQB-pfG83FWz9ns1Qvlu4g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*pQB-pfG83FWz9ns1Qvlu4g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*pQB-pfG83FWz9ns1Qvlu4g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*pQB-pfG83FWz9ns1Qvlu4g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*pQB-pfG83FWz9ns1Qvlu4g.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*pQB-pfG83FWz9ns1Qvlu4g.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be lt nx c" width="1000" height="344" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*pQB-pfG83FWz9ns1Qvlu4g.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph=""><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/machine.h#L72" rel="noopener ugc nofollow" target="_blank">machine.h</a> &amp; <a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/fat.h#L51" rel="noopener ugc nofollow" target="_blank">fat.h</a></figcaption></figure><figure class="hw ns ww wx paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl wy"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*76jyhas1Ck1NaLOrOKsf0w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*76jyhas1Ck1NaLOrOKsf0w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*76jyhas1Ck1NaLOrOKsf0w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*76jyhas1Ck1NaLOrOKsf0w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*76jyhas1Ck1NaLOrOKsf0w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*76jyhas1Ck1NaLOrOKsf0w.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*76jyhas1Ck1NaLOrOKsf0w.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*76jyhas1Ck1NaLOrOKsf0w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*76jyhas1Ck1NaLOrOKsf0w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*76jyhas1Ck1NaLOrOKsf0w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*76jyhas1Ck1NaLOrOKsf0w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*76jyhas1Ck1NaLOrOKsf0w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*76jyhas1Ck1NaLOrOKsf0w.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*76jyhas1Ck1NaLOrOKsf0w.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be lt nx c" width="1000" height="283" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*76jyhas1Ck1NaLOrOKsf0w.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph="">Example Universal Binary</figcaption></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><p id="8c63" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">The kernel loads <a class="af te" href="https://github.com/apple-oss-distributions/xnu/blob/1031c584a5e37aff177559b9f69dbd3c8c3fd30a/libkern/kxld/kxld_object.c#L525" rel="noopener ugc nofollow" target="_blank">the most compatible binary for the machine architecture</a>. To load different architecture from fat binary, use the <code class="cu vp vq vr vh b">arch</code> command:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl wz"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ZhGJEIhuNqisoSH2UYyXuw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ZhGJEIhuNqisoSH2UYyXuw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ZhGJEIhuNqisoSH2UYyXuw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ZhGJEIhuNqisoSH2UYyXuw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ZhGJEIhuNqisoSH2UYyXuw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ZhGJEIhuNqisoSH2UYyXuw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZhGJEIhuNqisoSH2UYyXuw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*ZhGJEIhuNqisoSH2UYyXuw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ZhGJEIhuNqisoSH2UYyXuw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ZhGJEIhuNqisoSH2UYyXuw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ZhGJEIhuNqisoSH2UYyXuw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ZhGJEIhuNqisoSH2UYyXuw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ZhGJEIhuNqisoSH2UYyXuw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ZhGJEIhuNqisoSH2UYyXuw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="84" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*ZhGJEIhuNqisoSH2UYyXuw.png"></picture></div></div></figure><pre class="nn no np nq nr vg vh vi bm vj ay bh"><span id="7aef" class="vk nz ha vh b bd vl vm l vn vo" data-selectable-paragraph="">arch -x86_64 PATH</span></pre><h2 id="bc34" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">Memory Pages</h2><p id="c9b4" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">All bytes of the above <em class="uz">headers</em>, <em class="uz">segments</em>, <em class="uz">sections</em> and <em class="uz">binary data </em>are stored in the <em class="uz">Memory Pages, </em>the smallest data unit for <a class="af te" href="https://developer.apple.com/library/archive/documentation/General/Conceptual/DevPedia-CocoaCore/MemoryManagement.html" rel="noopener ugc nofollow" target="_blank"><em class="uz">Memory Management</em></a>.</p><p id="1226" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">It is a fixed-length virtual memory block, typically a few kilobytes. For the <em class="uz">macOS</em> on <em class="uz">ARM64</em> <em class="uz">processor,</em> their size is 16kB. However, <em class="uz">macOS</em> can handle both 4kB and 16kB <em class="uz">page sizes</em>. The information is stored in the <a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/vm_param.h#L52C21-L52C21" rel="noopener ugc nofollow" target="_blank"><em class="uz">vm_param.h</em></a><em class="uz">:</em></p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xa"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*I0RndVqfN6bo9Hj-B4VMOQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*I0RndVqfN6bo9Hj-B4VMOQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*I0RndVqfN6bo9Hj-B4VMOQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*I0RndVqfN6bo9Hj-B4VMOQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*I0RndVqfN6bo9Hj-B4VMOQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*I0RndVqfN6bo9Hj-B4VMOQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I0RndVqfN6bo9Hj-B4VMOQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*I0RndVqfN6bo9Hj-B4VMOQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*I0RndVqfN6bo9Hj-B4VMOQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*I0RndVqfN6bo9Hj-B4VMOQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*I0RndVqfN6bo9Hj-B4VMOQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*I0RndVqfN6bo9Hj-B4VMOQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*I0RndVqfN6bo9Hj-B4VMOQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*I0RndVqfN6bo9Hj-B4VMOQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="240" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*I0RndVqfN6bo9Hj-B4VMOQ.png"></picture></div></div></figure><blockquote class="va vb vc"><p id="ec92" class="mm mn uz mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">By default, macOS works on a 16kB memory page size. However, there are some situations, when macOS work on 4kB, like Code Signing hash calculations.</p></blockquote><h2 id="fdef" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">Loading to memory</h2><p id="6616" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">When a user runs an application on <em class="uz">macOS</em>, the <em class="uz">Mach-O</em> file is loaded into memory by the <a class="af te" href="https://github.com/apple-oss-distributions/xnu" rel="noopener ugc nofollow" target="_blank">XNU</a> kernel, so the CPU can execute its instructions.</p><p id="40a1" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">The following steps describe a high-level overview of what XNU does:</p><ul class=""><li id="8042" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vd ve vf bh" data-selectable-paragraph=""><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/mach_loader.c#L551" rel="noopener ugc nofollow" target="_blank">Calculate random slides for the loading addresses (ALSR)</a></li><li id="190e" class="mm mn ha mo b mp wm mr ms mt wn mv mw mx wo mz na nb wp nd ne nf wq nh ni nj vd ve vf bh" data-selectable-paragraph=""><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/mach_loader.c#L1046" rel="noopener ugc nofollow" target="_blank">Parse <em class="uz">Mach-O to</em> read <em class="uz">XNU-specific Load Commands</em></a></li><li id="5a65" class="mm mn ha mo b mp wm mr ms mt wn mv mw mx wo mz na nb wp nd ne nf wq nh ni nj vd ve vf bh" data-selectable-paragraph=""><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/mach_loader.c#L1817C1-L1817C1" rel="noopener ugc nofollow" target="_blank">Map data from the Mach-O file to memory regions</a></li><li id="449d" class="mm mn ha mo b mp wm mr ms mt wn mv mw mx wo mz na nb wp nd ne nf wq nh ni nj vd ve vf bh" data-selectable-paragraph=""><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/mach_loader.c#L1474" rel="noopener ugc nofollow" target="_blank">Map dyld to memory based on the </a><code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/mach_loader.c#L1474" rel="noopener ugc nofollow" target="_blank">LC_LOAD_DYLINKER</a></code></li><li id="bdca" class="mm mn ha mo b mp wm mr ms mt wn mv mw mx wo mz na nb wp nd ne nf wq nh ni nj vd ve vf bh" data-selectable-paragraph=""><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/mach_loader.c#L3245C2-L3245C35" rel="noopener ugc nofollow" target="_blank">Map Dyld Shared Cache</a></li><li id="9915" class="mm mn ha mo b mp wm mr ms mt wn mv mw mx wo mz na nb wp nd ne nf wq nh ni nj vd ve vf bh" data-selectable-paragraph=""><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/mach_loader.c#L2680" rel="noopener ugc nofollow" target="_blank">Map the Thread Stack at</a> <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/vmparam.h#L19" rel="noopener ugc nofollow" target="_blank">0x16FE0000+ASLR</a></code></li></ul><p id="81da" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">Then, the <a class="af te" href="https://github.com/apple-oss-distributions/dyld/tree/main/dyld" rel="noopener ugc nofollow" target="_blank">Dynamic Linker</a> handles libraries loading and symbols resolving:</p><ul class=""><li id="d51e" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vd ve vf bh" data-selectable-paragraph="">Parse Mach-O to read dyld-specific Load Commands</li><li id="13bf" class="mm mn ha mo b mp wm mr ms mt wn mv mw mx wo mz na nb wp nd ne nf wq nh ni nj vd ve vf bh" data-selectable-paragraph="">Realocates any relative references to addresses within the file</li><li id="012f" class="mm mn ha mo b mp wm mr ms mt wn mv mw mx wo mz na nb wp nd ne nf wq nh ni nj vd ve vf bh" data-selectable-paragraph="">Link shared libraries (dylibs)</li><li id="615e" class="mm mn ha mo b mp wm mr ms mt wn mv mw mx wo mz na nb wp nd ne nf wq nh ni nj vd ve vf bh" data-selectable-paragraph="">Resolve symbolic references to functions and variables</li><li id="eca2" class="mm mn ha mo b mp wm mr ms mt wn mv mw mx wo mz na nb wp nd ne nf wq nh ni nj vd ve vf bh" data-selectable-paragraph="">Transfer control to the entry point of the executable</li></ul><p id="91e1" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">You can inspect information loaded by dynamic linker using <code class="cu vp vq vr vh b">dyld_info</code>:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xb"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*33uaipZlmGIkkIlsL5lkew.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*33uaipZlmGIkkIlsL5lkew.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*33uaipZlmGIkkIlsL5lkew.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*33uaipZlmGIkkIlsL5lkew.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*33uaipZlmGIkkIlsL5lkew.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*33uaipZlmGIkkIlsL5lkew.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*33uaipZlmGIkkIlsL5lkew.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*33uaipZlmGIkkIlsL5lkew.png 640w, https://miro.medium.com/v2/resize:fit:720/1*33uaipZlmGIkkIlsL5lkew.png 720w, https://miro.medium.com/v2/resize:fit:750/1*33uaipZlmGIkkIlsL5lkew.png 750w, https://miro.medium.com/v2/resize:fit:786/1*33uaipZlmGIkkIlsL5lkew.png 786w, https://miro.medium.com/v2/resize:fit:828/1*33uaipZlmGIkkIlsL5lkew.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*33uaipZlmGIkkIlsL5lkew.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*33uaipZlmGIkkIlsL5lkew.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="399" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*33uaipZlmGIkkIlsL5lkew.png"></picture></div></div></figure><blockquote class="va vb vc"><p id="4cc7" class="mm mn uz mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">The latest <a class="af te" href="https://github.com/apple-oss-distributions/dyld" rel="noopener ugc nofollow" target="_blank">dyld</a> and <a class="af te" href="https://github.com/apple-oss-distributions/xnu" rel="noopener ugc nofollow" target="_blank">XNU</a> source code can be found in <a class="af te" href="https://github.com/apple-oss-distributions/" rel="noopener ugc nofollow" target="_blank">apple-oss-distributions</a>.</p></blockquote></div></div></div><div class="ab by uo up uq ur" role="separator"><span class="su bv bj us ut ps"></span><span class="su bv bj us ut ps"></span><span class="su bv bj us ut"></span></div><div class="gt gu gv gw gx"><div class="ab by"><div class="cf be fx fy fz ga"><h1 id="2cc5" class="ny nz ha bc oa ob uu od oe of uv oh oi oj uw ol om on ux op oq or uy ot ou ov bh" data-selectable-paragraph="">Header</h1><p id="871a" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">The <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L75" rel="noopener ugc nofollow" target="_blank">mach_header_64</a></code> structure is a <em class="uz">64-bit Mach-O</em> <em class="uz">header</em> that appears at the very beginning of the file or in the offset specified by the fat header.</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl nm"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*B9rcNk0DyMmSoZ5CBiYh6g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*B9rcNk0DyMmSoZ5CBiYh6g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*B9rcNk0DyMmSoZ5CBiYh6g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*B9rcNk0DyMmSoZ5CBiYh6g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*B9rcNk0DyMmSoZ5CBiYh6g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*B9rcNk0DyMmSoZ5CBiYh6g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B9rcNk0DyMmSoZ5CBiYh6g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*B9rcNk0DyMmSoZ5CBiYh6g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*B9rcNk0DyMmSoZ5CBiYh6g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*B9rcNk0DyMmSoZ5CBiYh6g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*B9rcNk0DyMmSoZ5CBiYh6g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*B9rcNk0DyMmSoZ5CBiYh6g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*B9rcNk0DyMmSoZ5CBiYh6g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*B9rcNk0DyMmSoZ5CBiYh6g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="608" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*B9rcNk0DyMmSoZ5CBiYh6g.png"></picture></div></div></figure><p id="9c72" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">It is used to identify the file as a Mach-O and provide information on how it should be loaded to memory. Below are examples of valid Mach headers:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xc"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*N8zXO44r1wz-xuOzkQ-6qA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*N8zXO44r1wz-xuOzkQ-6qA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*N8zXO44r1wz-xuOzkQ-6qA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*N8zXO44r1wz-xuOzkQ-6qA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*N8zXO44r1wz-xuOzkQ-6qA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*N8zXO44r1wz-xuOzkQ-6qA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N8zXO44r1wz-xuOzkQ-6qA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*N8zXO44r1wz-xuOzkQ-6qA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*N8zXO44r1wz-xuOzkQ-6qA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*N8zXO44r1wz-xuOzkQ-6qA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*N8zXO44r1wz-xuOzkQ-6qA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*N8zXO44r1wz-xuOzkQ-6qA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*N8zXO44r1wz-xuOzkQ-6qA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*N8zXO44r1wz-xuOzkQ-6qA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="223" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*N8zXO44r1wz-xuOzkQ-6qA.png"></picture></div></div></figure><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xd"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*BrpoOqAwery8slDLsUv5gg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*BrpoOqAwery8slDLsUv5gg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*BrpoOqAwery8slDLsUv5gg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*BrpoOqAwery8slDLsUv5gg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*BrpoOqAwery8slDLsUv5gg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*BrpoOqAwery8slDLsUv5gg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BrpoOqAwery8slDLsUv5gg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*BrpoOqAwery8slDLsUv5gg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*BrpoOqAwery8slDLsUv5gg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*BrpoOqAwery8slDLsUv5gg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*BrpoOqAwery8slDLsUv5gg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*BrpoOqAwery8slDLsUv5gg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*BrpoOqAwery8slDLsUv5gg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*BrpoOqAwery8slDLsUv5gg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="325" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*BrpoOqAwery8slDLsUv5gg.png"></picture></div></div></figure><p id="50dd" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">You can use <code class="cu vp vq vr vh b">otool</code> with <code class="cu vp vq vr vh b">-hv</code> flags to parse it from the command line:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xe"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*T0B-Tdn9o6RNpTKu2tiNVg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*T0B-Tdn9o6RNpTKu2tiNVg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*T0B-Tdn9o6RNpTKu2tiNVg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*T0B-Tdn9o6RNpTKu2tiNVg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*T0B-Tdn9o6RNpTKu2tiNVg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*T0B-Tdn9o6RNpTKu2tiNVg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T0B-Tdn9o6RNpTKu2tiNVg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*T0B-Tdn9o6RNpTKu2tiNVg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*T0B-Tdn9o6RNpTKu2tiNVg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*T0B-Tdn9o6RNpTKu2tiNVg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*T0B-Tdn9o6RNpTKu2tiNVg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*T0B-Tdn9o6RNpTKu2tiNVg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*T0B-Tdn9o6RNpTKu2tiNVg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*T0B-Tdn9o6RNpTKu2tiNVg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="81" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*T0B-Tdn9o6RNpTKu2tiNVg.png"></picture></div></div></figure><h2 id="d4a5" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">Magic</h2><p id="5516" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">The <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L76C5-L76C5" rel="noopener ugc nofollow" target="_blank">magic</a></code> field is used to identify a file format and byte order.</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div class="nk nl xf"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*kZbc43GZwu_Wy1-0Dxcepg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*kZbc43GZwu_Wy1-0Dxcepg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*kZbc43GZwu_Wy1-0Dxcepg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*kZbc43GZwu_Wy1-0Dxcepg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*kZbc43GZwu_Wy1-0Dxcepg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*kZbc43GZwu_Wy1-0Dxcepg.png 1100w, https://miro.medium.com/v2/resize:fit:1170/format:webp/1*kZbc43GZwu_Wy1-0Dxcepg.png 1170w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 585px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*kZbc43GZwu_Wy1-0Dxcepg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*kZbc43GZwu_Wy1-0Dxcepg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*kZbc43GZwu_Wy1-0Dxcepg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*kZbc43GZwu_Wy1-0Dxcepg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*kZbc43GZwu_Wy1-0Dxcepg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*kZbc43GZwu_Wy1-0Dxcepg.png 1100w, https://miro.medium.com/v2/resize:fit:1170/1*kZbc43GZwu_Wy1-0Dxcepg.png 1170w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 585px"><img alt="" class="be lt nx c" width="585" height="150" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:731/1*kZbc43GZwu_Wy1-0Dxcepg.png"></picture></div></figure><p id="e783" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">If a binary was compiled for a <em class="uz">little-endian</em> <em class="uz">machine</em> and transferred to a <em class="uz">big-endian machine</em>, the magic value would be set to <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L69C11-L69C11" rel="noopener ugc nofollow" target="_blank">MH_CIGAM_64</a></code>. Otherwise, the magic value will be <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L68" rel="noopener ugc nofollow" target="_blank">MH_MAGIC_64</a></code> as shown in the below image:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*niTEYHs2-yqEkNldC5RcjQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*niTEYHs2-yqEkNldC5RcjQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*niTEYHs2-yqEkNldC5RcjQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*niTEYHs2-yqEkNldC5RcjQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*niTEYHs2-yqEkNldC5RcjQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*niTEYHs2-yqEkNldC5RcjQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*niTEYHs2-yqEkNldC5RcjQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*niTEYHs2-yqEkNldC5RcjQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*niTEYHs2-yqEkNldC5RcjQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*niTEYHs2-yqEkNldC5RcjQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*niTEYHs2-yqEkNldC5RcjQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*niTEYHs2-yqEkNldC5RcjQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*niTEYHs2-yqEkNldC5RcjQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*niTEYHs2-yqEkNldC5RcjQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="130" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*niTEYHs2-yqEkNldC5RcjQ.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph="">Compiled for little-endian machine on a little-endian machine.</figcaption></figure><p id="316c" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">The<em class="uz"> XNU</em> reads the <em class="uz">magic value </em>using native host byte order. If the <em class="uz">value</em> matches <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L69C11-L69C11" rel="noopener ugc nofollow" target="_blank">MH_CIGAM_64</a></code>, it switches the byte order of binary using <code class="cu vp vq vr vh b"><a class="af te" href="https://developer.apple.com/documentation/kernel/1517897-nxswapint" rel="noopener ugc nofollow" target="_blank"><em class="uz">NXSwapInt</em></a></code> kernel function that takes an unsigned integer as an argument and returns the byte-swapped value:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xh"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*8m4hFEUyp3fTiZcLiNOitw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*8m4hFEUyp3fTiZcLiNOitw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*8m4hFEUyp3fTiZcLiNOitw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*8m4hFEUyp3fTiZcLiNOitw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*8m4hFEUyp3fTiZcLiNOitw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*8m4hFEUyp3fTiZcLiNOitw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8m4hFEUyp3fTiZcLiNOitw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*8m4hFEUyp3fTiZcLiNOitw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*8m4hFEUyp3fTiZcLiNOitw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*8m4hFEUyp3fTiZcLiNOitw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*8m4hFEUyp3fTiZcLiNOitw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*8m4hFEUyp3fTiZcLiNOitw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*8m4hFEUyp3fTiZcLiNOitw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*8m4hFEUyp3fTiZcLiNOitw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="112" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*8m4hFEUyp3fTiZcLiNOitw.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph=""><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/byte_order.h#L53" rel="noopener ugc nofollow" target="_blank">byte_order.h</a></figcaption></figure><h2 id="e251" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">CPU Type</h2><p id="379c" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">The <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L77C7-L77C7" rel="noopener ugc nofollow" target="_blank">cputype</a></code> field specifies the targeted architecture:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div class="nk nl xi"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*p-1uklvMtro_U_SqPEiFeg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*p-1uklvMtro_U_SqPEiFeg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*p-1uklvMtro_U_SqPEiFeg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*p-1uklvMtro_U_SqPEiFeg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*p-1uklvMtro_U_SqPEiFeg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*p-1uklvMtro_U_SqPEiFeg.png 1100w, https://miro.medium.com/v2/resize:fit:1216/format:webp/1*p-1uklvMtro_U_SqPEiFeg.png 1216w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 608px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*p-1uklvMtro_U_SqPEiFeg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*p-1uklvMtro_U_SqPEiFeg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*p-1uklvMtro_U_SqPEiFeg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*p-1uklvMtro_U_SqPEiFeg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*p-1uklvMtro_U_SqPEiFeg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*p-1uklvMtro_U_SqPEiFeg.png 1100w, https://miro.medium.com/v2/resize:fit:1216/1*p-1uklvMtro_U_SqPEiFeg.png 1216w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 608px"><img alt="" class="be lt nx c" width="608" height="172" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:760/1*p-1uklvMtro_U_SqPEiFeg.png"></picture></div></figure><p id="8253" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">The variable type <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L77C7-L77C7" rel="noopener ugc nofollow" target="_blank">cpu_type_t</a></code> is an alias of an <em class="uz">integer</em> and can be found in <a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/machine.h#L93" rel="noopener ugc nofollow" target="_blank"><em class="uz">machine.h</em></a> in the repository. Below are presented all types and their values:</p></div></div><div class="ns"><div class="ab by"><div class="lo wr lp ws lq wt cc wu cd wv cf be"><figure class="nn no np nq nr ns ww wx paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xj"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Wq962gEZnyLeZav1S_q6vw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Wq962gEZnyLeZav1S_q6vw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Wq962gEZnyLeZav1S_q6vw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Wq962gEZnyLeZav1S_q6vw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Wq962gEZnyLeZav1S_q6vw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Wq962gEZnyLeZav1S_q6vw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*Wq962gEZnyLeZav1S_q6vw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*Wq962gEZnyLeZav1S_q6vw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Wq962gEZnyLeZav1S_q6vw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Wq962gEZnyLeZav1S_q6vw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Wq962gEZnyLeZav1S_q6vw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Wq962gEZnyLeZav1S_q6vw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Wq962gEZnyLeZav1S_q6vw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*Wq962gEZnyLeZav1S_q6vw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be lt nx c" width="1000" height="36" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*Wq962gEZnyLeZav1S_q6vw.png"></picture></div></div></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><blockquote class="va vb vc"><p id="e131" class="mm mn uz mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">On macOS arm64, the size of <code class="cu vp vq vr vh b">integer_t</code> is 4 bytes.</p></blockquote><h2 id="76e2" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">CPU Subtype</h2><p id="ef59" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">The <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L78C2-L78C15" rel="noopener ugc nofollow" target="_blank">cpusubtype</a></code> defines the specific member of the <em class="uz">CPU family</em> and is used in conjunction with the <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L77C7-L77C7" rel="noopener ugc nofollow" target="_blank">cputype</a></code> to check if the <em class="uz">hardware</em> is compatible.</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xk"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*tslKMgwLxtbZhC7gpgYnzg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*tslKMgwLxtbZhC7gpgYnzg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*tslKMgwLxtbZhC7gpgYnzg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*tslKMgwLxtbZhC7gpgYnzg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*tslKMgwLxtbZhC7gpgYnzg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*tslKMgwLxtbZhC7gpgYnzg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tslKMgwLxtbZhC7gpgYnzg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*tslKMgwLxtbZhC7gpgYnzg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*tslKMgwLxtbZhC7gpgYnzg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*tslKMgwLxtbZhC7gpgYnzg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*tslKMgwLxtbZhC7gpgYnzg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*tslKMgwLxtbZhC7gpgYnzg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*tslKMgwLxtbZhC7gpgYnzg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*tslKMgwLxtbZhC7gpgYnzg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="72" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*tslKMgwLxtbZhC7gpgYnzg.png"></picture></div></div></figure><p id="8f61" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">There are many <em class="uz">subtypes</em> described in <a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/machine.h#L142" rel="noopener ugc nofollow" target="_blank"><em class="uz">machine.h</em></a>, but few are available for <em class="uz">ARM64</em> architecture. The available <em class="uz">subtypes</em> are listed below:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xl"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*adI4ytoNzNQxy5WPkz1RGg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*adI4ytoNzNQxy5WPkz1RGg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*adI4ytoNzNQxy5WPkz1RGg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*adI4ytoNzNQxy5WPkz1RGg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*adI4ytoNzNQxy5WPkz1RGg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*adI4ytoNzNQxy5WPkz1RGg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*adI4ytoNzNQxy5WPkz1RGg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*adI4ytoNzNQxy5WPkz1RGg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*adI4ytoNzNQxy5WPkz1RGg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*adI4ytoNzNQxy5WPkz1RGg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*adI4ytoNzNQxy5WPkz1RGg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*adI4ytoNzNQxy5WPkz1RGg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*adI4ytoNzNQxy5WPkz1RGg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*adI4ytoNzNQxy5WPkz1RGg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="138" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*adI4ytoNzNQxy5WPkz1RGg.png"></picture></div></div></figure><p id="0821" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">Additionally, <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L78C2-L78C15" rel="noopener ugc nofollow" target="_blank">cpusubtype</a></code> value is used to extract the <a class="af te" href="https://support.apple.com/en-gb/guide/security/sec8b776536b/1/web/1#sec0167b469d" rel="noopener ugc nofollow" target="_blank"><em class="uz">pointer authentication</em></a> <em class="uz">version</em> using bitwise <em class="uz">ANDing</em> on <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L78C2-L78C15" rel="noopener ugc nofollow" target="_blank">cpusubtype</a></code> with the mask <code class="cu vp vq vr vh b">0x0f000000</code> and then shifting the result <code class="cu vp vq vr vh b">24</code> bits to the right:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xm"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*tW1V_F5R40wferiO2XCAOQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*tW1V_F5R40wferiO2XCAOQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*tW1V_F5R40wferiO2XCAOQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*tW1V_F5R40wferiO2XCAOQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*tW1V_F5R40wferiO2XCAOQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*tW1V_F5R40wferiO2XCAOQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tW1V_F5R40wferiO2XCAOQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*tW1V_F5R40wferiO2XCAOQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*tW1V_F5R40wferiO2XCAOQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*tW1V_F5R40wferiO2XCAOQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*tW1V_F5R40wferiO2XCAOQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*tW1V_F5R40wferiO2XCAOQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*tW1V_F5R40wferiO2XCAOQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*tW1V_F5R40wferiO2XCAOQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="85" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*tW1V_F5R40wferiO2XCAOQ.png"></picture></div></div></figure><h2 id="a016" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">File Types</h2><p id="ec34" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">The <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L79C2-L79C10" rel="noopener ugc nofollow" target="_blank">filetype</a></code> defines the layout of the file.</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xn"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*LgmYCjV5plnL_GGepHDMng.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*LgmYCjV5plnL_GGepHDMng.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*LgmYCjV5plnL_GGepHDMng.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*LgmYCjV5plnL_GGepHDMng.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*LgmYCjV5plnL_GGepHDMng.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*LgmYCjV5plnL_GGepHDMng.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LgmYCjV5plnL_GGepHDMng.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*LgmYCjV5plnL_GGepHDMng.png 640w, https://miro.medium.com/v2/resize:fit:720/1*LgmYCjV5plnL_GGepHDMng.png 720w, https://miro.medium.com/v2/resize:fit:750/1*LgmYCjV5plnL_GGepHDMng.png 750w, https://miro.medium.com/v2/resize:fit:786/1*LgmYCjV5plnL_GGepHDMng.png 786w, https://miro.medium.com/v2/resize:fit:828/1*LgmYCjV5plnL_GGepHDMng.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*LgmYCjV5plnL_GGepHDMng.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*LgmYCjV5plnL_GGepHDMng.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="238" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*LgmYCjV5plnL_GGepHDMng.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph="">Obsolete filetypes were greyed out</figcaption></figure><h2 id="10af" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">Flags</h2><p id="00e2" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">The 32-bit <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L82C9-L82C9" rel="noopener ugc nofollow" target="_blank">flags</a></code> field in the Mach-O header stores constants that define additional options for the linker (<code class="cu vp vq vr vh b">ld</code>) or dynamic linker (<code class="cu vp vq vr vh b">dyld</code>).</p></div></div><div class="ns"><div class="ab by"><div class="lo wr lp ws lq wt cc wu cd wv cf be"><figure class="nn no np nq nr ns ww wx paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xo"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Tl8htzecW3pShRYoDul9MQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Tl8htzecW3pShRYoDul9MQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Tl8htzecW3pShRYoDul9MQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Tl8htzecW3pShRYoDul9MQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Tl8htzecW3pShRYoDul9MQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Tl8htzecW3pShRYoDul9MQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*Tl8htzecW3pShRYoDul9MQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*Tl8htzecW3pShRYoDul9MQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Tl8htzecW3pShRYoDul9MQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Tl8htzecW3pShRYoDul9MQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Tl8htzecW3pShRYoDul9MQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Tl8htzecW3pShRYoDul9MQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Tl8htzecW3pShRYoDul9MQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*Tl8htzecW3pShRYoDul9MQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be lt nx c" width="1000" height="143" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*Tl8htzecW3pShRYoDul9MQ.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph="">Most common flags</figcaption></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><blockquote class="va vb vc"><p id="406a" class="mm mn uz mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">You can find all flags in <a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L128" rel="noopener ugc nofollow" target="_blank">loader.h</a> with additional comments.</p></blockquote></div></div></div><div class="ab by uo up uq ur" role="separator"><span class="su bv bj us ut ps"></span><span class="su bv bj us ut ps"></span><span class="su bv bj us ut"></span></div><div class="gt gu gv gw gx"><div class="ab by"><div class="cf be fx fy fz ga"><h1 id="fcad" class="ny nz ha bc oa ob uu od oe of uv oh oi oj uw ol om on ux op oq or uy ot ou ov bh" data-selectable-paragraph="">Load Commands</h1><p id="b238" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">The <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L250" rel="noopener ugc nofollow" target="_blank">load_command</a></code> structure follows the Mach header directly. Every <em class="uz">Load Command</em> must start from two fields, and they are <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L251" rel="noopener ugc nofollow" target="_blank">cmd</a></code> which is a type of <em class="uz">Load Command,</em> and the <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L252" rel="noopener ugc nofollow" target="_blank">cmdsize</a></code> that stores its <em class="uz">size</em>.</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl nm"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*at_swZwLvAYbS1iS2UlYtg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*at_swZwLvAYbS1iS2UlYtg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*at_swZwLvAYbS1iS2UlYtg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*at_swZwLvAYbS1iS2UlYtg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*at_swZwLvAYbS1iS2UlYtg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*at_swZwLvAYbS1iS2UlYtg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*at_swZwLvAYbS1iS2UlYtg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*at_swZwLvAYbS1iS2UlYtg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*at_swZwLvAYbS1iS2UlYtg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*at_swZwLvAYbS1iS2UlYtg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*at_swZwLvAYbS1iS2UlYtg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*at_swZwLvAYbS1iS2UlYtg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*at_swZwLvAYbS1iS2UlYtg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*at_swZwLvAYbS1iS2UlYtg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="138" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*at_swZwLvAYbS1iS2UlYtg.png"></picture></div></div></figure><p id="2b25" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">For instance <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L378" rel="noopener ugc nofollow" target="_blank">LC_SEGMENT_64</a></code> type command with a size of <code class="cu vp vq vr vh b">72</code> bytes:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xp"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*sAlc_zCUI41MxKA6RzXcCg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*sAlc_zCUI41MxKA6RzXcCg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*sAlc_zCUI41MxKA6RzXcCg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*sAlc_zCUI41MxKA6RzXcCg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*sAlc_zCUI41MxKA6RzXcCg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*sAlc_zCUI41MxKA6RzXcCg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sAlc_zCUI41MxKA6RzXcCg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*sAlc_zCUI41MxKA6RzXcCg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*sAlc_zCUI41MxKA6RzXcCg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*sAlc_zCUI41MxKA6RzXcCg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*sAlc_zCUI41MxKA6RzXcCg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*sAlc_zCUI41MxKA6RzXcCg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*sAlc_zCUI41MxKA6RzXcCg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*sAlc_zCUI41MxKA6RzXcCg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="238" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*sAlc_zCUI41MxKA6RzXcCg.png"></picture></div></div></figure><blockquote class="va vb vc"><p id="2f14" class="mm mn uz mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">All constants for load command types (<code class="cu vp vq vr vh b">cmd</code>) are listed in <a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L264" rel="noopener ugc nofollow" target="_blank">loader.h</a>.</p></blockquote><h2 id="c48c" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">Alignment on ARM64</h2><p id="51c9" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">On a 64-bit architecture, all parts of the <em class="uz">Mach-O</em> <strong class="mo hb">must be a multiple of 8 bytes</strong> and <strong class="mo hb">padded with </strong><code class="cu vp vq vr vh b"><strong class="mo hb">0x00</strong></code><strong class="mo hb"> bytes. </strong>Specifically, I refer to <em class="uz">the Mach-O Header</em>, <em class="uz">Load Commands</em>, <em class="uz">Segments, Sections, </em>and <em class="uz">Tables </em>in<em class="uz"> </em>the<em class="uz"> Data </em>part<em class="uz">.</em></p><p id="9ebd" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">Continuing this line of reasoning, since<em class="uz"> Load Commands</em> are responsible for instructing the <em class="uz">Dynamic Linker </em>(<em class="uz">dyld</em>) how to load the entire <em class="uz">Mach-O</em> file into memory, the <code class="cu vp vq vr vh b">cmdsize</code> field <strong class="mo hb">must always be multiple of 8 bytes</strong>.</p></div></div><div class="ns"><div class="ab by"><div class="lo wr lp ws lq wt cc wu cd wv cf be"><figure class="nn no np nq nr ns ww wx paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xq"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*MRQqyf5cDcRfGi6DxW7GJg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*MRQqyf5cDcRfGi6DxW7GJg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*MRQqyf5cDcRfGi6DxW7GJg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*MRQqyf5cDcRfGi6DxW7GJg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*MRQqyf5cDcRfGi6DxW7GJg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*MRQqyf5cDcRfGi6DxW7GJg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*MRQqyf5cDcRfGi6DxW7GJg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*MRQqyf5cDcRfGi6DxW7GJg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*MRQqyf5cDcRfGi6DxW7GJg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*MRQqyf5cDcRfGi6DxW7GJg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*MRQqyf5cDcRfGi6DxW7GJg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*MRQqyf5cDcRfGi6DxW7GJg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*MRQqyf5cDcRfGi6DxW7GJg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*MRQqyf5cDcRfGi6DxW7GJg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be lt nx c" width="1000" height="381" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*MRQqyf5cDcRfGi6DxW7GJg.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph="">Example size of LC_MAIN load command</figcaption></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><h2 id="9028" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">Memory protections on AMR64</h2><p id="40ea" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph=""><em class="uz">Mach-O</em> file loaded by XNU to <em class="uz">Virtual Memory</em> is divided into <em class="uz">Segments</em> associated with specific <em class="uz">memory protection attributes</em>.</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xr"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*YN_iPoOcEI44FkozBetXJQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*YN_iPoOcEI44FkozBetXJQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*YN_iPoOcEI44FkozBetXJQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*YN_iPoOcEI44FkozBetXJQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*YN_iPoOcEI44FkozBetXJQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*YN_iPoOcEI44FkozBetXJQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YN_iPoOcEI44FkozBetXJQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*YN_iPoOcEI44FkozBetXJQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*YN_iPoOcEI44FkozBetXJQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*YN_iPoOcEI44FkozBetXJQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*YN_iPoOcEI44FkozBetXJQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*YN_iPoOcEI44FkozBetXJQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*YN_iPoOcEI44FkozBetXJQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*YN_iPoOcEI44FkozBetXJQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="288" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*YN_iPoOcEI44FkozBetXJQ.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph=""><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/vm_prot.h#L84" rel="noopener ugc nofollow" target="_blank">Memory protection attributes</a></figcaption></figure><p id="2bfe" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">They are set via <code class="cu vp vq vr vh b"><a class="af te" href="https://developer.apple.com/documentation/endpointsecurity/3228936-es_events_t/3228950-mprotect" rel="noopener ugc nofollow" target="_blank">mprotect()</a></code> during memory mapping via <code class="cu vp vq vr vh b"><a class="af te" href="https://developer.apple.com/documentation/endpointsecurity/3228936-es_events_t/3228948-mmap" rel="noopener ugc nofollow" target="_blank">mmap</a>()</code>:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl vs"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*MxlN9_f781aiwYHSf6LWoA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*MxlN9_f781aiwYHSf6LWoA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*MxlN9_f781aiwYHSf6LWoA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*MxlN9_f781aiwYHSf6LWoA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*MxlN9_f781aiwYHSf6LWoA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*MxlN9_f781aiwYHSf6LWoA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MxlN9_f781aiwYHSf6LWoA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*MxlN9_f781aiwYHSf6LWoA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*MxlN9_f781aiwYHSf6LWoA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*MxlN9_f781aiwYHSf6LWoA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*MxlN9_f781aiwYHSf6LWoA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*MxlN9_f781aiwYHSf6LWoA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*MxlN9_f781aiwYHSf6LWoA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*MxlN9_f781aiwYHSf6LWoA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="439" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*MxlN9_f781aiwYHSf6LWoA.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph=""><a class="af te" href="https://developer.apple.com/videos/play/wwdc2022/110362/" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><blockquote class="va vb vc"><p id="f478" class="mm mn uz mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">ARM feature called <em class="ha">eXecute Never(NX)</em> does not allow to set any memory region protections to both <em class="ha">writeable</em> and <em class="ha">executable</em> (<code class="cu vp vq vr vh b">W^X</code>) same time.</p></blockquote><h2 id="a547" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">Segments</h2><p id="2b0b" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">First <em class="uz">Load Commands</em> in the <em class="uz">Mach-O</em> file are <em class="uz">Segments — </em><code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L378" rel="noopener ugc nofollow" target="_blank">segment_command_64</a></code>:</p></div></div><div class="ns"><div class="ab by"><div class="lo wr lp ws lq wt cc wu cd wv cf be"><figure class="nn no np nq nr ns ww wx paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xs"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*qsmq0eVUSkvW_yaA59Ix0Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*qsmq0eVUSkvW_yaA59Ix0Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*qsmq0eVUSkvW_yaA59Ix0Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*qsmq0eVUSkvW_yaA59Ix0Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*qsmq0eVUSkvW_yaA59Ix0Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*qsmq0eVUSkvW_yaA59Ix0Q.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*qsmq0eVUSkvW_yaA59Ix0Q.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*qsmq0eVUSkvW_yaA59Ix0Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*qsmq0eVUSkvW_yaA59Ix0Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*qsmq0eVUSkvW_yaA59Ix0Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*qsmq0eVUSkvW_yaA59Ix0Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*qsmq0eVUSkvW_yaA59Ix0Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*qsmq0eVUSkvW_yaA59Ix0Q.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*qsmq0eVUSkvW_yaA59Ix0Q.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be lt nx c" width="1000" height="418" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*qsmq0eVUSkvW_yaA59Ix0Q.png"></picture></div></div></figure><figure class="hw ns ww wx paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xt"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*WsJBCsiNekkoQrGzy4T_Fg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*WsJBCsiNekkoQrGzy4T_Fg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*WsJBCsiNekkoQrGzy4T_Fg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*WsJBCsiNekkoQrGzy4T_Fg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*WsJBCsiNekkoQrGzy4T_Fg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*WsJBCsiNekkoQrGzy4T_Fg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*WsJBCsiNekkoQrGzy4T_Fg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*WsJBCsiNekkoQrGzy4T_Fg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*WsJBCsiNekkoQrGzy4T_Fg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*WsJBCsiNekkoQrGzy4T_Fg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*WsJBCsiNekkoQrGzy4T_Fg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*WsJBCsiNekkoQrGzy4T_Fg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*WsJBCsiNekkoQrGzy4T_Fg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*WsJBCsiNekkoQrGzy4T_Fg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be lt nx c" width="1000" height="359" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*WsJBCsiNekkoQrGzy4T_Fg.png"></picture></div></div></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><p id="0909" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">Different segments, with the less common ones marked as grey:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xu"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*qkHLqrtLCTyjDyAAjM-uqg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*qkHLqrtLCTyjDyAAjM-uqg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*qkHLqrtLCTyjDyAAjM-uqg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*qkHLqrtLCTyjDyAAjM-uqg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*qkHLqrtLCTyjDyAAjM-uqg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*qkHLqrtLCTyjDyAAjM-uqg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qkHLqrtLCTyjDyAAjM-uqg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*qkHLqrtLCTyjDyAAjM-uqg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*qkHLqrtLCTyjDyAAjM-uqg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*qkHLqrtLCTyjDyAAjM-uqg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*qkHLqrtLCTyjDyAAjM-uqg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*qkHLqrtLCTyjDyAAjM-uqg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*qkHLqrtLCTyjDyAAjM-uqg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*qkHLqrtLCTyjDyAAjM-uqg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="345" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*qkHLqrtLCTyjDyAAjM-uqg.png"></picture></div></div></figure><h2 id="e388" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">Sections</h2><p id="3bdc" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph=""><em class="uz">Segments</em> are further divided into the <em class="uz">Sections — </em><code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L452" rel="noopener ugc nofollow" target="_blank">section_64</a></code>:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl nm"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Y-dePjZR9DSO3afvsv2xyQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Y-dePjZR9DSO3afvsv2xyQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Y-dePjZR9DSO3afvsv2xyQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Y-dePjZR9DSO3afvsv2xyQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Y-dePjZR9DSO3afvsv2xyQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Y-dePjZR9DSO3afvsv2xyQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y-dePjZR9DSO3afvsv2xyQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*Y-dePjZR9DSO3afvsv2xyQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Y-dePjZR9DSO3afvsv2xyQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Y-dePjZR9DSO3afvsv2xyQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Y-dePjZR9DSO3afvsv2xyQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Y-dePjZR9DSO3afvsv2xyQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Y-dePjZR9DSO3afvsv2xyQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Y-dePjZR9DSO3afvsv2xyQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="282" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*Y-dePjZR9DSO3afvsv2xyQ.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph="">Flags values: <a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L468" rel="noopener ugc nofollow" target="_blank">loader.h</a></figcaption></figure><p id="2e99" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">Each <em class="uz">Section</em> has its own <em class="uz">size</em> and <em class="uz">file content</em> to be loaded, but it <strong class="mo hb">inherits its <em class="uz">memory protection</em> from the <em class="uz">Segment</em> it belongs to</strong>. Sections with <code class="cu vp vq vr vh b">__objc</code> suffixes are related to <em class="uz">Objective-C</em>, while <code class="cu vp vq vr vh b">__swift5</code> are related to <em class="uz">Swift</em>.</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xv"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*fDfC1QaOgL2TOSyMde5WGQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*fDfC1QaOgL2TOSyMde5WGQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*fDfC1QaOgL2TOSyMde5WGQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*fDfC1QaOgL2TOSyMde5WGQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*fDfC1QaOgL2TOSyMde5WGQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*fDfC1QaOgL2TOSyMde5WGQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fDfC1QaOgL2TOSyMde5WGQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*fDfC1QaOgL2TOSyMde5WGQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*fDfC1QaOgL2TOSyMde5WGQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*fDfC1QaOgL2TOSyMde5WGQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*fDfC1QaOgL2TOSyMde5WGQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*fDfC1QaOgL2TOSyMde5WGQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*fDfC1QaOgL2TOSyMde5WGQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*fDfC1QaOgL2TOSyMde5WGQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="249" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*fDfC1QaOgL2TOSyMde5WGQ.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph="">__text Section inside the __TEXT segment.</figcaption></figure><p id="3d0d" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">There are many different <em class="uz">sections</em>, some of the commons are listed below:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xw"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*HYjy128g-W1rZ11F85cjdw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*HYjy128g-W1rZ11F85cjdw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*HYjy128g-W1rZ11F85cjdw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*HYjy128g-W1rZ11F85cjdw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*HYjy128g-W1rZ11F85cjdw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*HYjy128g-W1rZ11F85cjdw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HYjy128g-W1rZ11F85cjdw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*HYjy128g-W1rZ11F85cjdw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*HYjy128g-W1rZ11F85cjdw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*HYjy128g-W1rZ11F85cjdw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*HYjy128g-W1rZ11F85cjdw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*HYjy128g-W1rZ11F85cjdw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*HYjy128g-W1rZ11F85cjdw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*HYjy128g-W1rZ11F85cjdw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="409" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*HYjy128g-W1rZ11F85cjdw.png"></picture></div></div></figure><h2 id="93e5" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">__PAGEZERO</h2><p id="2134" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">Instructs kernel to reserve the first 4GB (<code class="cu vp vq vr vh b">0x100000000</code>) of <em class="uz">Virtual Memory. </em>It can take up more space (<code class="cu vp vq vr vh b">slide</code>) if the <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L193" rel="noopener ugc nofollow" target="_blank">MH_PIE</a></code> flag is used.</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xx"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*i_Qsu7Eksn-JGJZhrca1Gg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*i_Qsu7Eksn-JGJZhrca1Gg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*i_Qsu7Eksn-JGJZhrca1Gg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*i_Qsu7Eksn-JGJZhrca1Gg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*i_Qsu7Eksn-JGJZhrca1Gg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*i_Qsu7Eksn-JGJZhrca1Gg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i_Qsu7Eksn-JGJZhrca1Gg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*i_Qsu7Eksn-JGJZhrca1Gg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*i_Qsu7Eksn-JGJZhrca1Gg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*i_Qsu7Eksn-JGJZhrca1Gg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*i_Qsu7Eksn-JGJZhrca1Gg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*i_Qsu7Eksn-JGJZhrca1Gg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*i_Qsu7Eksn-JGJZhrca1Gg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*i_Qsu7Eksn-JGJZhrca1Gg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="171" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*i_Qsu7Eksn-JGJZhrca1Gg.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph=""><a class="af te" href="https://www.youtube.com/watch?list=LL&amp;t=461&amp;v=MUr7qg7iqKE&amp;feature=youtu.be&amp;ab_channel=xpl0n1c" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><p id="ad44" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">Since no protection rights are assigned to this space (<code class="cu vp vq vr vh b">---</code>), any attempt to access through a <em class="uz">NULL pointer</em> will be caught, resulting in a crash.</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xy"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*K0wFeMAhKurO9lisa7eK8w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*K0wFeMAhKurO9lisa7eK8w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*K0wFeMAhKurO9lisa7eK8w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*K0wFeMAhKurO9lisa7eK8w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*K0wFeMAhKurO9lisa7eK8w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*K0wFeMAhKurO9lisa7eK8w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K0wFeMAhKurO9lisa7eK8w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*K0wFeMAhKurO9lisa7eK8w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*K0wFeMAhKurO9lisa7eK8w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*K0wFeMAhKurO9lisa7eK8w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*K0wFeMAhKurO9lisa7eK8w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*K0wFeMAhKurO9lisa7eK8w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*K0wFeMAhKurO9lisa7eK8w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*K0wFeMAhKurO9lisa7eK8w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="354" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*K0wFeMAhKurO9lisa7eK8w.png"></picture></div></div></figure><blockquote class="va vb vc"><p id="fe2d" class="mm mn uz mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">This segment has 0 space on disk.</p></blockquote><h2 id="d10c" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">__TEXT</h2><p id="1a0e" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">Since the <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L592" rel="noopener ugc nofollow" target="_blank">__PAGEZERO</a></code> segment file size is <code class="cu vp vq vr vh b">0</code>, the <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L597" rel="noopener ugc nofollow" target="_blank">__TEXT</a></code> is the first “real” segment and starts at the beginning of the file.</p><p id="edb8" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">In <em class="uz">Virtual Memory,</em> it starts from <code class="cu vp vq vr vh b">0x100000000</code> (<code class="cu vp vq vr vh b">+slide</code> if <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L193" rel="noopener ugc nofollow" target="_blank">MH_PIE</a></code> is used) and is marked as <strong class="mo hb"><em class="uz">readable</em></strong> and <strong class="mo hb"><em class="uz">executable</em></strong><em class="uz">. </em>It<em class="uz"> </em>stores the <em class="uz">read-only data</em> and <em class="uz">executable code</em>. It also contains the <em class="uz">Mach-O Header</em> and <em class="uz">Load Commands</em>.</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xz"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*LwdNkaAf2MzhF_VBndsARQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*LwdNkaAf2MzhF_VBndsARQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*LwdNkaAf2MzhF_VBndsARQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*LwdNkaAf2MzhF_VBndsARQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*LwdNkaAf2MzhF_VBndsARQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*LwdNkaAf2MzhF_VBndsARQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LwdNkaAf2MzhF_VBndsARQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*LwdNkaAf2MzhF_VBndsARQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*LwdNkaAf2MzhF_VBndsARQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*LwdNkaAf2MzhF_VBndsARQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*LwdNkaAf2MzhF_VBndsARQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*LwdNkaAf2MzhF_VBndsARQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*LwdNkaAf2MzhF_VBndsARQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*LwdNkaAf2MzhF_VBndsARQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="370" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*LwdNkaAf2MzhF_VBndsARQ.png"></picture></div></div></figure><h2 id="d7ca" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">__DATA_CONST</h2><p id="7cea" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">This segment <a class="af te" href="https://developer.apple.com/documentation/xcode-release-notes/xcode-11-release-notes?language=objc" rel="noopener ugc nofollow" target="_blank">stores <em class="uz">globals</em> that are marked as <em class="uz">constant data</em></a>. During <code class="cu vp vq vr vh b">mmap</code>, <code class="cu vp vq vr vh b">__DATA_CONST</code> is <strong class="mo hb"><em class="uz">readable</em></strong> and <strong class="mo hb"><em class="uz">writable</em></strong>. However, after initialization, <em class="uz">dyld</em> is instructed by <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L407" rel="noopener ugc nofollow" target="_blank">SG_READ_ONLY</a></code> <em class="uz">segment flag</em> to make it <em class="uz">read-only</em> via <code class="cu vp vq vr vh b"><a class="af te" href="https://developer.apple.com/documentation/endpointsecurity/3228936-es_events_t/3228950-mprotect" rel="noopener ugc nofollow" target="_blank">mprotect</a></code>.</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl ya"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*QBlN_vOUBSPt7uA0RoOlJg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*QBlN_vOUBSPt7uA0RoOlJg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*QBlN_vOUBSPt7uA0RoOlJg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*QBlN_vOUBSPt7uA0RoOlJg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*QBlN_vOUBSPt7uA0RoOlJg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*QBlN_vOUBSPt7uA0RoOlJg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QBlN_vOUBSPt7uA0RoOlJg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*QBlN_vOUBSPt7uA0RoOlJg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*QBlN_vOUBSPt7uA0RoOlJg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*QBlN_vOUBSPt7uA0RoOlJg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*QBlN_vOUBSPt7uA0RoOlJg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*QBlN_vOUBSPt7uA0RoOlJg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*QBlN_vOUBSPt7uA0RoOlJg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*QBlN_vOUBSPt7uA0RoOlJg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="428" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*QBlN_vOUBSPt7uA0RoOlJg.png"></picture></div></div></figure><blockquote class="va vb vc"><p id="96b2" class="mm mn uz mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">One use case for this is non-lazy binding <code class="cu vp vq vr vh b"><em class="ha">__got</em></code>.</p></blockquote><h2 id="f620" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">__DATA</h2><p id="9dbb" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">It contains <strong class="mo hb"><em class="uz">readable</em></strong> and <strong class="mo hb"><em class="uz">writable</em></strong> data. It is a container for <em class="uz">global</em> and <em class="uz">static variables</em> and other <em class="uz">non-executable data structures</em> during runtime.</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl yb"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*rcX_L4eXegRk5qlWzPmv6g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*rcX_L4eXegRk5qlWzPmv6g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*rcX_L4eXegRk5qlWzPmv6g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*rcX_L4eXegRk5qlWzPmv6g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*rcX_L4eXegRk5qlWzPmv6g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*rcX_L4eXegRk5qlWzPmv6g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rcX_L4eXegRk5qlWzPmv6g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*rcX_L4eXegRk5qlWzPmv6g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*rcX_L4eXegRk5qlWzPmv6g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*rcX_L4eXegRk5qlWzPmv6g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*rcX_L4eXegRk5qlWzPmv6g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*rcX_L4eXegRk5qlWzPmv6g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*rcX_L4eXegRk5qlWzPmv6g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*rcX_L4eXegRk5qlWzPmv6g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="394" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*rcX_L4eXegRk5qlWzPmv6g.png"></picture></div></div></figure><h2 id="9349" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">__RESTRICT</h2><p id="64ba" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">The empty read-only segment with empty <code class="cu vp vq vr vh b">__restrict</code> section. Instructs dyld to validate the code signature of all loaded code to the process.</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl yc"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*30u8nG_FQGMu0tWHRarSkw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*30u8nG_FQGMu0tWHRarSkw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*30u8nG_FQGMu0tWHRarSkw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*30u8nG_FQGMu0tWHRarSkw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*30u8nG_FQGMu0tWHRarSkw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*30u8nG_FQGMu0tWHRarSkw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*30u8nG_FQGMu0tWHRarSkw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*30u8nG_FQGMu0tWHRarSkw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*30u8nG_FQGMu0tWHRarSkw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*30u8nG_FQGMu0tWHRarSkw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*30u8nG_FQGMu0tWHRarSkw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*30u8nG_FQGMu0tWHRarSkw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*30u8nG_FQGMu0tWHRarSkw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*30u8nG_FQGMu0tWHRarSkw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="226" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*30u8nG_FQGMu0tWHRarSkw.png"></picture></div></div></figure><h2 id="6999" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">__LINKEDIT</h2><p id="f914" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">It does not have <em class="uz">sections</em> and is described by the rest of the <em class="uz">Load Commands</em> that are loaded after it, like <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L871" rel="noopener ugc nofollow" target="_blank">LC_SYMTAB</a></code>, <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L1533" rel="noopener ugc nofollow" target="_blank">LC_MAIN</a></code>, <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L681" rel="noopener ugc nofollow" target="_blank">LC_LOAD_DYLIB</a></code>, etc. It contains <strong class="mo hb"><em class="uz">read-only</em></strong> data used by <em class="uz">dyld</em> during <em class="uz">linking</em> and <em class="uz">binding symbols.</em></p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl yd"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*LHvUkUot7gC3GHnEJr2QsA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*LHvUkUot7gC3GHnEJr2QsA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*LHvUkUot7gC3GHnEJr2QsA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*LHvUkUot7gC3GHnEJr2QsA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*LHvUkUot7gC3GHnEJr2QsA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*LHvUkUot7gC3GHnEJr2QsA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LHvUkUot7gC3GHnEJr2QsA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*LHvUkUot7gC3GHnEJr2QsA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*LHvUkUot7gC3GHnEJr2QsA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*LHvUkUot7gC3GHnEJr2QsA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*LHvUkUot7gC3GHnEJr2QsA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*LHvUkUot7gC3GHnEJr2QsA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*LHvUkUot7gC3GHnEJr2QsA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*LHvUkUot7gC3GHnEJr2QsA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="355" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*LHvUkUot7gC3GHnEJr2QsA.png"></picture></div></div></figure><p id="888b" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">For instance, the above <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L1195" rel="noopener ugc nofollow" target="_blank">__LINKEDIT</a></code> segment starts at <code class="cu vp vq vr vh b">0xC000</code> and ends at the <code class="cu vp vq vr vh b">0xC000 + 0x4EC0 == 0x10EC0</code>, which is the last byte of the binary:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl yd"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*c-TjuADOf4m_JsT7tnmYEg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*c-TjuADOf4m_JsT7tnmYEg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*c-TjuADOf4m_JsT7tnmYEg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*c-TjuADOf4m_JsT7tnmYEg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*c-TjuADOf4m_JsT7tnmYEg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*c-TjuADOf4m_JsT7tnmYEg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c-TjuADOf4m_JsT7tnmYEg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*c-TjuADOf4m_JsT7tnmYEg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*c-TjuADOf4m_JsT7tnmYEg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*c-TjuADOf4m_JsT7tnmYEg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*c-TjuADOf4m_JsT7tnmYEg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*c-TjuADOf4m_JsT7tnmYEg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*c-TjuADOf4m_JsT7tnmYEg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*c-TjuADOf4m_JsT7tnmYEg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="399" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*c-TjuADOf4m_JsT7tnmYEg.png"></picture></div></div></figure><blockquote class="va vb vc"><p id="c19c" class="mm mn uz mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">The <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L1195" rel="noopener ugc nofollow" target="_blank">__LINKEDIT</a></code> <strong class="mo hb">must be the last segment</strong>. Dynamic Linker (dyld) will <strong class="mo hb">reject any binary with segment data after</strong> <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L1195" rel="noopener ugc nofollow" target="_blank">__LINKEDIT</a></code>.</p></blockquote><h2 id="8d44" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">Chained Fixups</h2><p id="9c6b" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">After a series of <em class="uz">Load Commands</em> <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L378" rel="noopener ugc nofollow" target="_blank">LC_SEGMENT_64</a></code> responsible for loading <em class="uz">Segments</em> to a <em class="uz">Virtual Memory</em>, there is a time for <em class="uz">binding </em>and <em class="uz">rebasing</em>.</p><ul class=""><li id="38b3" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vd ve vf bh" data-selectable-paragraph=""><strong class="mo hb">Binding</strong> —resolves symbolic references in the binary. It is a process of replacing <em class="uz">symbols</em> that refer to <em class="uz">code</em> or <em class="uz">data</em> with the actual addresses.</li><li id="a9e1" class="mm mn ha mo b mp wm mr ms mt wn mv mw mx wo mz na nb wp nd ne nf wq nh ni nj vd ve vf bh" data-selectable-paragraph=""><strong class="mo hb">Rebasing</strong> — ensures all <em class="uz">pointers</em> point to the correct location by adding a base address of the dynamic library they came from to their offset.</li></ul><blockquote class="ye"><p id="3863" class="yf yg ha bc yh yi yj yk yl ym yn nj dr" data-selectable-paragraph="">Fixups == Binding &amp;&amp; Rebasing</p></blockquote><p id="6bbf" class="pw-post-body-paragraph mm mn ha mo b mp yo mr ms mt yp mv mw mx yq mz na nb yr nd ne nf ys nh ni nj gt bh" data-selectable-paragraph="">Unfortunately, <em class="uz">MachOView</em> does not yet support <em class="uz">Chained Fixups. </em>Till <em class="uz">macOS 12, </em>the information needed for this task was referred to by <code class="cu vp vq vr vh b">LC_DYLD_INFO</code>.</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl yt"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*BI27MsLEeeukisn2tN6uCA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*BI27MsLEeeukisn2tN6uCA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*BI27MsLEeeukisn2tN6uCA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*BI27MsLEeeukisn2tN6uCA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*BI27MsLEeeukisn2tN6uCA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*BI27MsLEeeukisn2tN6uCA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BI27MsLEeeukisn2tN6uCA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*BI27MsLEeeukisn2tN6uCA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*BI27MsLEeeukisn2tN6uCA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*BI27MsLEeeukisn2tN6uCA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*BI27MsLEeeukisn2tN6uCA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*BI27MsLEeeukisn2tN6uCA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*BI27MsLEeeukisn2tN6uCA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*BI27MsLEeeukisn2tN6uCA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="45" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*BI27MsLEeeukisn2tN6uCA.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph=""><em class="yu">Example Chained Fixups</em></figcaption></figure><p id="98ea" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph=""><em class="uz">Chained Fixups </em>are handled by <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L328" rel="noopener ugc nofollow" target="_blank">LC_DYLD_CHAINED_FIXUPS</a></code> referenced by the <code class="cu vp vq vr vh b"><a class="af te" href="https://developer.apple.com/documentation/kernel/linkedit_data_command" rel="noopener ugc nofollow" target="_blank">linkedit_data_command</a></code>. Structure comments are related to above example:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl nm"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*2eBkgKRHRzz96bvXq_S8ZA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*2eBkgKRHRzz96bvXq_S8ZA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*2eBkgKRHRzz96bvXq_S8ZA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*2eBkgKRHRzz96bvXq_S8ZA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*2eBkgKRHRzz96bvXq_S8ZA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*2eBkgKRHRzz96bvXq_S8ZA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2eBkgKRHRzz96bvXq_S8ZA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*2eBkgKRHRzz96bvXq_S8ZA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*2eBkgKRHRzz96bvXq_S8ZA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*2eBkgKRHRzz96bvXq_S8ZA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*2eBkgKRHRzz96bvXq_S8ZA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*2eBkgKRHRzz96bvXq_S8ZA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*2eBkgKRHRzz96bvXq_S8ZA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*2eBkgKRHRzz96bvXq_S8ZA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="145" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*2eBkgKRHRzz96bvXq_S8ZA.png"></picture></div></div></figure><p id="49ad" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">The <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L1203C11-L1203C11" rel="noopener ugc nofollow" target="_blank">dataoff</a></code> value is the offset of the <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/fixup-chains.h#L39" rel="noopener ugc nofollow" target="_blank">dyld_chained_fixups_header</a></code> which defines the fixups chains (binding &amp; rebasing).</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl nm"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*9YMfY8oN0YtS40xyU8l1kg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*9YMfY8oN0YtS40xyU8l1kg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*9YMfY8oN0YtS40xyU8l1kg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*9YMfY8oN0YtS40xyU8l1kg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*9YMfY8oN0YtS40xyU8l1kg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*9YMfY8oN0YtS40xyU8l1kg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9YMfY8oN0YtS40xyU8l1kg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*9YMfY8oN0YtS40xyU8l1kg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*9YMfY8oN0YtS40xyU8l1kg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*9YMfY8oN0YtS40xyU8l1kg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*9YMfY8oN0YtS40xyU8l1kg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*9YMfY8oN0YtS40xyU8l1kg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*9YMfY8oN0YtS40xyU8l1kg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*9YMfY8oN0YtS40xyU8l1kg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="151" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*9YMfY8oN0YtS40xyU8l1kg.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph="">Values in comments are related to the signed_ad_hoc_example below.</figcaption></figure><p id="39e9" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">Here is an example <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/fixup-chains.h#L39" rel="noopener ugc nofollow" target="_blank">dyld_chained_fixups_header</a></code> marked as green embedded in <code class="cu vp vq vr vh b">LC_DYLD_CHAINED_FIXUPS</code> data marked as red:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl yv"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*1-NSA2FU-0KP3LIHnwV7Pw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*1-NSA2FU-0KP3LIHnwV7Pw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*1-NSA2FU-0KP3LIHnwV7Pw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*1-NSA2FU-0KP3LIHnwV7Pw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*1-NSA2FU-0KP3LIHnwV7Pw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*1-NSA2FU-0KP3LIHnwV7Pw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1-NSA2FU-0KP3LIHnwV7Pw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*1-NSA2FU-0KP3LIHnwV7Pw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*1-NSA2FU-0KP3LIHnwV7Pw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*1-NSA2FU-0KP3LIHnwV7Pw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*1-NSA2FU-0KP3LIHnwV7Pw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*1-NSA2FU-0KP3LIHnwV7Pw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*1-NSA2FU-0KP3LIHnwV7Pw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*1-NSA2FU-0KP3LIHnwV7Pw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="225" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*1-NSA2FU-0KP3LIHnwV7Pw.png"></picture></div></div></figure><p id="b0e0" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">Due to alignment, the <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/fixup-chains.h#L51" rel="noopener ugc nofollow" target="_blank">dyld_chained_starts_in_image</a></code> starts at <code class="cu vp vq vr vh b">0xC020</code> after those four <code class="cu vp vq vr vh b">0x00</code> bytes at <code class="cu vp vq vr vh b">0xC016–0xC020</code> as specified in <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/fixup-chains.h#L42" rel="noopener ugc nofollow" target="_blank">starts_offset</a></code>.</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xw"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*-YynTF0CZkNRc3MrlmBlMg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*-YynTF0CZkNRc3MrlmBlMg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*-YynTF0CZkNRc3MrlmBlMg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*-YynTF0CZkNRc3MrlmBlMg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*-YynTF0CZkNRc3MrlmBlMg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*-YynTF0CZkNRc3MrlmBlMg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-YynTF0CZkNRc3MrlmBlMg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*-YynTF0CZkNRc3MrlmBlMg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*-YynTF0CZkNRc3MrlmBlMg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*-YynTF0CZkNRc3MrlmBlMg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*-YynTF0CZkNRc3MrlmBlMg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*-YynTF0CZkNRc3MrlmBlMg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*-YynTF0CZkNRc3MrlmBlMg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*-YynTF0CZkNRc3MrlmBlMg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="157" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*-YynTF0CZkNRc3MrlmBlMg.png"></picture></div></div></figure><p id="b48c" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">The structure specifies the <em class="uz">number of segments</em> in the binary and where are their <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/fixup-chains.h#L60" rel="noopener ugc nofollow" target="_blank">dyld_chained_starts_in_segment</a></code>. The <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/fixup-chains.h#L53" rel="noopener ugc nofollow" target="_blank">seg_count</a></code> field determines the actual number of elements in this array. For our example binary, the structure would look like this:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl yw"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*6B4Pd0mTSOUtO1KBbOzDlA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*6B4Pd0mTSOUtO1KBbOzDlA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*6B4Pd0mTSOUtO1KBbOzDlA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*6B4Pd0mTSOUtO1KBbOzDlA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*6B4Pd0mTSOUtO1KBbOzDlA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*6B4Pd0mTSOUtO1KBbOzDlA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6B4Pd0mTSOUtO1KBbOzDlA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*6B4Pd0mTSOUtO1KBbOzDlA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*6B4Pd0mTSOUtO1KBbOzDlA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*6B4Pd0mTSOUtO1KBbOzDlA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*6B4Pd0mTSOUtO1KBbOzDlA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*6B4Pd0mTSOUtO1KBbOzDlA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*6B4Pd0mTSOUtO1KBbOzDlA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*6B4Pd0mTSOUtO1KBbOzDlA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="289" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*6B4Pd0mTSOUtO1KBbOzDlA.png"></picture></div></div></figure><ul class=""><li id="2a0d" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vd ve vf bh" data-selectable-paragraph=""><code class="cu vp vq vr vh b">dyld_chained_starts_in_image</code> is marked as yellow</li><li id="fa1c" class="mm mn ha mo b mp wm mr ms mt wn mv mw mx wo mz na nb wp nd ne nf wq nh ni nj vd ve vf bh" data-selectable-paragraph=""><code class="cu vp vq vr vh b">dyld_chained_starts_in_segment[2]</code> is marked as blue</li><li id="5a4d" class="mm mn ha mo b mp wm mr ms mt wn mv mw mx wo mz na nb wp nd ne nf wq nh ni nj vd ve vf bh" data-selectable-paragraph=""><code class="cu vp vq vr vh b">dyld_chained_starts_in_segment[3]</code> is marked as grey</li></ul><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl yx"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*1ezlnUKDtX22G6LIkRnW6A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*1ezlnUKDtX22G6LIkRnW6A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*1ezlnUKDtX22G6LIkRnW6A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*1ezlnUKDtX22G6LIkRnW6A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*1ezlnUKDtX22G6LIkRnW6A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*1ezlnUKDtX22G6LIkRnW6A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1ezlnUKDtX22G6LIkRnW6A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*1ezlnUKDtX22G6LIkRnW6A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*1ezlnUKDtX22G6LIkRnW6A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*1ezlnUKDtX22G6LIkRnW6A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*1ezlnUKDtX22G6LIkRnW6A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*1ezlnUKDtX22G6LIkRnW6A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*1ezlnUKDtX22G6LIkRnW6A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*1ezlnUKDtX22G6LIkRnW6A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="342" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*1ezlnUKDtX22G6LIkRnW6A.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph="">Example dyld_chained_starts_in_image</figcaption></figure><p id="a4cf" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">Each <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/fixup-chains.h#L60" rel="noopener ugc nofollow" target="_blank">dyld_chained_starts_in_segment</a></code> is described by the below structure. The numbers in the comments correspond to <code class="cu vp vq vr vh b">segment[2]</code> (the blue ones):</p></div></div><div class="ns"><div class="ab by"><div class="lo wr lp ws lq wt cc wu cd wv cf be"><figure class="nn no np nq nr ns ww wx paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl yy"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*m7Of5bhQjtBGkLaJkGOcgg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*m7Of5bhQjtBGkLaJkGOcgg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*m7Of5bhQjtBGkLaJkGOcgg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*m7Of5bhQjtBGkLaJkGOcgg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*m7Of5bhQjtBGkLaJkGOcgg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*m7Of5bhQjtBGkLaJkGOcgg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*m7Of5bhQjtBGkLaJkGOcgg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*m7Of5bhQjtBGkLaJkGOcgg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*m7Of5bhQjtBGkLaJkGOcgg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*m7Of5bhQjtBGkLaJkGOcgg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*m7Of5bhQjtBGkLaJkGOcgg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*m7Of5bhQjtBGkLaJkGOcgg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*m7Of5bhQjtBGkLaJkGOcgg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*m7Of5bhQjtBGkLaJkGOcgg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be lt nx c" width="1000" height="179" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*m7Of5bhQjtBGkLaJkGOcgg.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph="">Values based on the signed_ad_hoc_example</figcaption></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><p id="2294" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">The below image shows this structure parsed using <code class="cu vp vq vr vh b">dyld_info</code> command:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl yz"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*4aHGzgcglAM8pfc-BRGfNg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*4aHGzgcglAM8pfc-BRGfNg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*4aHGzgcglAM8pfc-BRGfNg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*4aHGzgcglAM8pfc-BRGfNg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*4aHGzgcglAM8pfc-BRGfNg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*4aHGzgcglAM8pfc-BRGfNg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4aHGzgcglAM8pfc-BRGfNg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*4aHGzgcglAM8pfc-BRGfNg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*4aHGzgcglAM8pfc-BRGfNg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*4aHGzgcglAM8pfc-BRGfNg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*4aHGzgcglAM8pfc-BRGfNg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*4aHGzgcglAM8pfc-BRGfNg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*4aHGzgcglAM8pfc-BRGfNg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*4aHGzgcglAM8pfc-BRGfNg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="356" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*4aHGzgcglAM8pfc-BRGfNg.png"></picture></div></div></figure><p id="9974" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph=""><em class="uz">Within each </em><code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/fixup-chains.h#L60" rel="noopener ugc nofollow" target="_blank"><em class="uz">dyld_chained_starts_in_segment</em></a></code><em class="uz">:</em></p><ul class=""><li id="d035" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vd ve vf bh" data-selectable-paragraph=""><code class="cu vp vq vr vh b">page_start[0]</code><em class="uz"> array indicates the first fixup on a page, and the following fixup is located at the current position plus the </em><code class="cu vp vq vr vh b"><em class="uz">next</em></code><em class="uz"> field multiplied by 4.</em></li><li id="e255" class="mm mn ha mo b mp wm mr ms mt wn mv mw mx wo mz na nb wp nd ne nf wq nh ni nj vd ve vf bh" data-selectable-paragraph=""><em class="uz">These fixups are 64-bit and can be either a </em><code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/fixup-chains.h#L109" rel="noopener ugc nofollow" target="_blank"><em class="uz">rebase</em></a></code><em class="uz"> or a </em><code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/fixup-chains.h#L119" rel="noopener ugc nofollow" target="_blank"><em class="uz">bind</em></a></code><em class="uz">, with the type specified by the lowest bit.</em></li></ul><p id="6e79" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">There are many other values for <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/fixup-chains.h#L64" rel="noopener ugc nofollow" target="_blank">pointer_format</a></code>. All of them are described in <a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/fixup-chains.h#L91" rel="noopener ugc nofollow" target="_blank"><em class="uz">fixup-chains.h</em></a>. Below, you can see the structure of the fixup for <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/fixup-chains.h#L156" rel="noopener ugc nofollow" target="_blank">pointer_format == 0x6</a></code>:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl za"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ZBrL2FB9J6PFcJ-h9PmJVQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ZBrL2FB9J6PFcJ-h9PmJVQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ZBrL2FB9J6PFcJ-h9PmJVQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ZBrL2FB9J6PFcJ-h9PmJVQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ZBrL2FB9J6PFcJ-h9PmJVQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ZBrL2FB9J6PFcJ-h9PmJVQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZBrL2FB9J6PFcJ-h9PmJVQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*ZBrL2FB9J6PFcJ-h9PmJVQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ZBrL2FB9J6PFcJ-h9PmJVQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ZBrL2FB9J6PFcJ-h9PmJVQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ZBrL2FB9J6PFcJ-h9PmJVQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ZBrL2FB9J6PFcJ-h9PmJVQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ZBrL2FB9J6PFcJ-h9PmJVQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ZBrL2FB9J6PFcJ-h9PmJVQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="438" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*ZBrL2FB9J6PFcJ-h9PmJVQ.png"></picture></div></div></figure><p id="7665" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">Below, you can see the fixup chain parsed using <code class="cu vp vq vr vh b">dyld_info</code>:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl zb"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*XSn7vqzA3Rgfy_gWerB8oA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*XSn7vqzA3Rgfy_gWerB8oA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*XSn7vqzA3Rgfy_gWerB8oA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*XSn7vqzA3Rgfy_gWerB8oA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*XSn7vqzA3Rgfy_gWerB8oA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*XSn7vqzA3Rgfy_gWerB8oA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XSn7vqzA3Rgfy_gWerB8oA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*XSn7vqzA3Rgfy_gWerB8oA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*XSn7vqzA3Rgfy_gWerB8oA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*XSn7vqzA3Rgfy_gWerB8oA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*XSn7vqzA3Rgfy_gWerB8oA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*XSn7vqzA3Rgfy_gWerB8oA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*XSn7vqzA3Rgfy_gWerB8oA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*XSn7vqzA3Rgfy_gWerB8oA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="210" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*XSn7vqzA3Rgfy_gWerB8oA.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph="">Example fixups</figcaption></figure><blockquote class="va vb vc"><p id="0c90" class="mm mn uz mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">Since the introduction of Chained Fixups, <strong class="mo hb">there are no longer any lazy binds.</strong></p></blockquote><h2 id="91fc" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">Exported symbols</h2><p id="c022" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">The next Load Command <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L327" rel="noopener ugc nofollow" target="_blank">LC_DYLD_EXPORTS_TRIE</a></code> is used to specify a <a class="af te" href="https://en.wikipedia.org/wiki/Trie" rel="noopener ugc nofollow" target="_blank">trie</a> data structure that contains a list of <em class="uz">Exported Symbols.</em></p><p id="df0b" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">Exported Symbols are referenced by a <code class="cu vp vq vr vh b"><a class="af te" href="https://developer.apple.com/documentation/kernel/linkedit_data_command" rel="noopener ugc nofollow" target="_blank">linkedit_data_command</a></code>, which contains the offset of the first node, just like <em class="uz">Chained Fixups</em>:</p></div></div><div class="ns"><div class="ab by"><div class="lo wr lp ws lq wt cc wu cd wv cf be"><figure class="nn no np nq nr ns ww wx paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl zc"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*4C9jZRgvkvVxKabtSpMX2g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*4C9jZRgvkvVxKabtSpMX2g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*4C9jZRgvkvVxKabtSpMX2g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*4C9jZRgvkvVxKabtSpMX2g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*4C9jZRgvkvVxKabtSpMX2g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*4C9jZRgvkvVxKabtSpMX2g.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*4C9jZRgvkvVxKabtSpMX2g.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*4C9jZRgvkvVxKabtSpMX2g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*4C9jZRgvkvVxKabtSpMX2g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*4C9jZRgvkvVxKabtSpMX2g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*4C9jZRgvkvVxKabtSpMX2g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*4C9jZRgvkvVxKabtSpMX2g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*4C9jZRgvkvVxKabtSpMX2g.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*4C9jZRgvkvVxKabtSpMX2g.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be lt nx c" width="1000" height="179" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*4C9jZRgvkvVxKabtSpMX2g.png"></picture></div></div></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xb"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*lYEjZH5K-tJg0S-o1MOAbg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*lYEjZH5K-tJg0S-o1MOAbg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*lYEjZH5K-tJg0S-o1MOAbg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*lYEjZH5K-tJg0S-o1MOAbg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*lYEjZH5K-tJg0S-o1MOAbg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*lYEjZH5K-tJg0S-o1MOAbg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lYEjZH5K-tJg0S-o1MOAbg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*lYEjZH5K-tJg0S-o1MOAbg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*lYEjZH5K-tJg0S-o1MOAbg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*lYEjZH5K-tJg0S-o1MOAbg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*lYEjZH5K-tJg0S-o1MOAbg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*lYEjZH5K-tJg0S-o1MOAbg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*lYEjZH5K-tJg0S-o1MOAbg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*lYEjZH5K-tJg0S-o1MOAbg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="82" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*lYEjZH5K-tJg0S-o1MOAbg.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph="">Example <a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L327" rel="noopener ugc nofollow" target="_blank">LC_DYLD_EXPORTS_TRIE</a></figcaption></figure><p id="fdfc" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">The whole structure is marked as violet, placed after the <em class="uz">Chained Fixups</em>:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl zd"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*0wEIqZqP3YbU7YtK5NIIEA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*0wEIqZqP3YbU7YtK5NIIEA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*0wEIqZqP3YbU7YtK5NIIEA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*0wEIqZqP3YbU7YtK5NIIEA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*0wEIqZqP3YbU7YtK5NIIEA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*0wEIqZqP3YbU7YtK5NIIEA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0wEIqZqP3YbU7YtK5NIIEA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*0wEIqZqP3YbU7YtK5NIIEA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*0wEIqZqP3YbU7YtK5NIIEA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*0wEIqZqP3YbU7YtK5NIIEA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*0wEIqZqP3YbU7YtK5NIIEA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*0wEIqZqP3YbU7YtK5NIIEA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*0wEIqZqP3YbU7YtK5NIIEA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*0wEIqZqP3YbU7YtK5NIIEA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="181" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*0wEIqZqP3YbU7YtK5NIIEA.png"></picture></div></div></figure><p id="5e4c" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">The table below shows how the above trie structure is being parsed:</p></div></div><div class="ns"><div class="ab by"><div class="lo wr lp ws lq wt cc wu cd wv cf be"><figure class="nn no np nq nr ns ww wx paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xc"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*inwrPSdNSVrXnYRjX5BY6Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*inwrPSdNSVrXnYRjX5BY6Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*inwrPSdNSVrXnYRjX5BY6Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*inwrPSdNSVrXnYRjX5BY6Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*inwrPSdNSVrXnYRjX5BY6Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*inwrPSdNSVrXnYRjX5BY6Q.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*inwrPSdNSVrXnYRjX5BY6Q.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*inwrPSdNSVrXnYRjX5BY6Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*inwrPSdNSVrXnYRjX5BY6Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*inwrPSdNSVrXnYRjX5BY6Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*inwrPSdNSVrXnYRjX5BY6Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*inwrPSdNSVrXnYRjX5BY6Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*inwrPSdNSVrXnYRjX5BY6Q.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*inwrPSdNSVrXnYRjX5BY6Q.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be lt nx c" width="1000" height="255" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*inwrPSdNSVrXnYRjX5BY6Q.png"></picture></div></div></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><ul class=""><li id="3bb8" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vd ve vf bh" data-selectable-paragraph="">Trie starts from a <em class="uz">Root,</em> which stores <em class="uz">CHILD NUMBER</em>, <em class="uz">DATA</em> terminated with <code class="cu vp vq vr vh b">0x00</code> byte, and the <em class="uz">CHILD OFFSET</em>.</li><li id="a869" class="mm mn ha mo b mp wm mr ms mt wn mv mw mx wo mz na nb wp nd ne nf wq nh ni nj vd ve vf bh" data-selectable-paragraph=""><em class="uz">DATA</em> is a part of a symbol name if the node <code class="cu vp vq vr vh b">SIZE == 0</code>.</li><li id="5657" class="mm mn ha mo b mp wm mr ms mt wn mv mw mx wo mz na nb wp nd ne nf wq nh ni nj vd ve vf bh" data-selectable-paragraph="">If <code class="cu vp vq vr vh b">SIZE &gt; 0</code>, then the node is a <em class="uz">TERMINAL NODE</em> (<code class="cu vp vq vr vh b">+28, +2C, +57, +5D</code>)</li><li id="b131" class="mm mn ha mo b mp wm mr ms mt wn mv mw mx wo mz na nb wp nd ne nf wq nh ni nj vd ve vf bh" data-selectable-paragraph="">The full symbol name can be retrieved by traversing the trie structure and concatenating nodes.</li><li id="2fe6" class="mm mn ha mo b mp wm mr ms mt wn mv mw mx wo mz na nb wp nd ne nf wq nh ni nj vd ve vf bh" data-selectable-paragraph="">The <em class="uz">TERMINAL NODE</em> is like a null byte for a string, but it can have children (<a class="af te" href="https://lief-project.github.io/doc/stable/tutorials/11_macho_modification.html#export-trie" rel="noopener ugc nofollow" target="_blank">when one symbol name is a part of the name of another</a>).</li></ul><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl ze"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*h4bXmpip6gJUPTkBEcs4zA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*h4bXmpip6gJUPTkBEcs4zA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*h4bXmpip6gJUPTkBEcs4zA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*h4bXmpip6gJUPTkBEcs4zA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*h4bXmpip6gJUPTkBEcs4zA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*h4bXmpip6gJUPTkBEcs4zA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h4bXmpip6gJUPTkBEcs4zA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*h4bXmpip6gJUPTkBEcs4zA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*h4bXmpip6gJUPTkBEcs4zA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*h4bXmpip6gJUPTkBEcs4zA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*h4bXmpip6gJUPTkBEcs4zA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*h4bXmpip6gJUPTkBEcs4zA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*h4bXmpip6gJUPTkBEcs4zA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*h4bXmpip6gJUPTkBEcs4zA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="394" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*h4bXmpip6gJUPTkBEcs4zA.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph="">Trie structure shown on the hierarchical graph</figcaption></figure><p id="9843" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">Use <code class="cu vp vq vr vh b">dydl_info</code> to parse the Exported Symbols structure:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl zf"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*K1rFIBhCpoPaSYtPUVCxzQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*K1rFIBhCpoPaSYtPUVCxzQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*K1rFIBhCpoPaSYtPUVCxzQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*K1rFIBhCpoPaSYtPUVCxzQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*K1rFIBhCpoPaSYtPUVCxzQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*K1rFIBhCpoPaSYtPUVCxzQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K1rFIBhCpoPaSYtPUVCxzQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*K1rFIBhCpoPaSYtPUVCxzQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*K1rFIBhCpoPaSYtPUVCxzQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*K1rFIBhCpoPaSYtPUVCxzQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*K1rFIBhCpoPaSYtPUVCxzQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*K1rFIBhCpoPaSYtPUVCxzQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*K1rFIBhCpoPaSYtPUVCxzQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*K1rFIBhCpoPaSYtPUVCxzQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="272" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*K1rFIBhCpoPaSYtPUVCxzQ.png"></picture></div></div></figure><blockquote class="va vb vc"><p id="d657" class="mm mn uz mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">Exported Symbols are symbols that can be linked against without error and are globally visible. They are symbols you can reference in a C header file.</p></blockquote><h2 id="60ee" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">SYMBOLS</h2><p id="a664" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">The <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L268" rel="noopener ugc nofollow" target="_blank">LC_SYMTAB</a></code> loads the table of symbols and strings used by debuggers static and dynamic linkers. It is described by the <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L871" rel="noopener ugc nofollow" target="_blank">symtab_command</a></code> structure:</p></div></div><div class="ns"><div class="ab by"><div class="lo wr lp ws lq wt cc wu cd wv cf be"><figure class="nn no np nq nr ns ww wx paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl zg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*3A6Fln0p2V0oCBUgkSH7eg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*3A6Fln0p2V0oCBUgkSH7eg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*3A6Fln0p2V0oCBUgkSH7eg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*3A6Fln0p2V0oCBUgkSH7eg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*3A6Fln0p2V0oCBUgkSH7eg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*3A6Fln0p2V0oCBUgkSH7eg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*3A6Fln0p2V0oCBUgkSH7eg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*3A6Fln0p2V0oCBUgkSH7eg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*3A6Fln0p2V0oCBUgkSH7eg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*3A6Fln0p2V0oCBUgkSH7eg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*3A6Fln0p2V0oCBUgkSH7eg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*3A6Fln0p2V0oCBUgkSH7eg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*3A6Fln0p2V0oCBUgkSH7eg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*3A6Fln0p2V0oCBUgkSH7eg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be lt nx c" width="1000" height="241" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*3A6Fln0p2V0oCBUgkSH7eg.png"></picture></div></div></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><p id="a601" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">It provides the location of the <em class="uz">Symbo</em>l and <em class="uz">String Table</em> for dynamic linking:</p></div></div><div class="ns"><div class="ab by"><div class="lo wr lp ws lq wt cc wu cd wv cf be"><figure class="nn no np nq nr ns ww wx paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl zh"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Mzx1bNV_d1hSH77uMNkZoQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Mzx1bNV_d1hSH77uMNkZoQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Mzx1bNV_d1hSH77uMNkZoQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Mzx1bNV_d1hSH77uMNkZoQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Mzx1bNV_d1hSH77uMNkZoQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Mzx1bNV_d1hSH77uMNkZoQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*Mzx1bNV_d1hSH77uMNkZoQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*Mzx1bNV_d1hSH77uMNkZoQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Mzx1bNV_d1hSH77uMNkZoQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Mzx1bNV_d1hSH77uMNkZoQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Mzx1bNV_d1hSH77uMNkZoQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Mzx1bNV_d1hSH77uMNkZoQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Mzx1bNV_d1hSH77uMNkZoQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*Mzx1bNV_d1hSH77uMNkZoQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be lt nx c" width="1000" height="198" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*Mzx1bNV_d1hSH77uMNkZoQ.png"></picture></div></div></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><p id="daa3" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">The <strong class="mo hb"><em class="uz">String Table</em></strong> stores the names of symbols as null-terminated strings. The Symbol Table entries reference these strings.</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xq"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*xMC089GngMvBol8Q2JjkFA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*xMC089GngMvBol8Q2JjkFA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*xMC089GngMvBol8Q2JjkFA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*xMC089GngMvBol8Q2JjkFA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*xMC089GngMvBol8Q2JjkFA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*xMC089GngMvBol8Q2JjkFA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xMC089GngMvBol8Q2JjkFA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*xMC089GngMvBol8Q2JjkFA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*xMC089GngMvBol8Q2JjkFA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*xMC089GngMvBol8Q2JjkFA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*xMC089GngMvBol8Q2JjkFA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*xMC089GngMvBol8Q2JjkFA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*xMC089GngMvBol8Q2JjkFA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*xMC089GngMvBol8Q2JjkFA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="595" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*xMC089GngMvBol8Q2JjkFA.png"></picture></div></div></figure><p id="86bd" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">The <strong class="mo hb"><em class="uz">Symbol Table</em></strong> contains entries that map symbol names to their corresponding memory addresses or offsets within the file.</p><p id="d7e5" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph=""><em class="uz">Symbol Table</em> is a list of <strong class="mo hb">nlist</strong> defined by <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/nlist.h#L94" rel="noopener ugc nofollow" target="_blank">nlist_64</a></code> structure:</p></div></div><div class="ns"><div class="ab by"><div class="lo wr lp ws lq wt cc wu cd wv cf be"><figure class="nn no np nq nr ns ww wx paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl zi"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*EbgNk3zPkXVVmxOHVop4Jw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*EbgNk3zPkXVVmxOHVop4Jw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*EbgNk3zPkXVVmxOHVop4Jw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*EbgNk3zPkXVVmxOHVop4Jw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*EbgNk3zPkXVVmxOHVop4Jw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*EbgNk3zPkXVVmxOHVop4Jw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*EbgNk3zPkXVVmxOHVop4Jw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*EbgNk3zPkXVVmxOHVop4Jw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*EbgNk3zPkXVVmxOHVop4Jw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*EbgNk3zPkXVVmxOHVop4Jw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*EbgNk3zPkXVVmxOHVop4Jw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*EbgNk3zPkXVVmxOHVop4Jw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*EbgNk3zPkXVVmxOHVop4Jw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*EbgNk3zPkXVVmxOHVop4Jw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be lt nx c" width="1000" height="188" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*EbgNk3zPkXVVmxOHVop4Jw.png"></picture></div></div></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><p id="0526" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">The <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/nlist.h#L98" rel="noopener ugc nofollow" target="_blank">ntype</a></code> specifies the symbol type:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl zj"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*78DqEBklKtkOlHucJVTlVQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*78DqEBklKtkOlHucJVTlVQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*78DqEBklKtkOlHucJVTlVQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*78DqEBklKtkOlHucJVTlVQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*78DqEBklKtkOlHucJVTlVQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*78DqEBklKtkOlHucJVTlVQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*78DqEBklKtkOlHucJVTlVQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*78DqEBklKtkOlHucJVTlVQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*78DqEBklKtkOlHucJVTlVQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*78DqEBklKtkOlHucJVTlVQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*78DqEBklKtkOlHucJVTlVQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*78DqEBklKtkOlHucJVTlVQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*78DqEBklKtkOlHucJVTlVQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*78DqEBklKtkOlHucJVTlVQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="295" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*78DqEBklKtkOlHucJVTlVQ.png"></picture></div></div></figure><ul class=""><li id="d33d" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vd ve vf bh" data-selectable-paragraph="">Values for <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/nlist.h#L132" rel="noopener ugc nofollow" target="_blank">N_TYPE</a></code> bits of the <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/nlist.h#L98" rel="noopener ugc nofollow" target="_blank">n_type</a></code> field:</li></ul><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl zk"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*wt_TO8loljrF3-52MlbcAg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*wt_TO8loljrF3-52MlbcAg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*wt_TO8loljrF3-52MlbcAg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*wt_TO8loljrF3-52MlbcAg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*wt_TO8loljrF3-52MlbcAg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*wt_TO8loljrF3-52MlbcAg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wt_TO8loljrF3-52MlbcAg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*wt_TO8loljrF3-52MlbcAg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*wt_TO8loljrF3-52MlbcAg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*wt_TO8loljrF3-52MlbcAg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*wt_TO8loljrF3-52MlbcAg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*wt_TO8loljrF3-52MlbcAg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*wt_TO8loljrF3-52MlbcAg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*wt_TO8loljrF3-52MlbcAg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="192" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*wt_TO8loljrF3-52MlbcAg.png"></picture></div></div></figure><ul class=""><li id="d082" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vd ve vf bh" data-selectable-paragraph="">Based on the above, the <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/nlist.h#L98" rel="noopener ugc nofollow" target="_blank">n_type</a></code> field can have multiple <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/nlist.h#L132" rel="noopener ugc nofollow" target="_blank">N_TYPE</a></code> fields:</li></ul><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl zl"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*2roaMMRMLU1lLWIFH1qfig.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*2roaMMRMLU1lLWIFH1qfig.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*2roaMMRMLU1lLWIFH1qfig.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*2roaMMRMLU1lLWIFH1qfig.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*2roaMMRMLU1lLWIFH1qfig.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*2roaMMRMLU1lLWIFH1qfig.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2roaMMRMLU1lLWIFH1qfig.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*2roaMMRMLU1lLWIFH1qfig.png 640w, https://miro.medium.com/v2/resize:fit:720/1*2roaMMRMLU1lLWIFH1qfig.png 720w, https://miro.medium.com/v2/resize:fit:750/1*2roaMMRMLU1lLWIFH1qfig.png 750w, https://miro.medium.com/v2/resize:fit:786/1*2roaMMRMLU1lLWIFH1qfig.png 786w, https://miro.medium.com/v2/resize:fit:828/1*2roaMMRMLU1lLWIFH1qfig.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*2roaMMRMLU1lLWIFH1qfig.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*2roaMMRMLU1lLWIFH1qfig.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="238" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*2roaMMRMLU1lLWIFH1qfig.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph="">Format of the <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/nlist.h#L98" rel="noopener ugc nofollow" target="_blank">n_type</a></code> and <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/nlist.h#L132" rel="noopener ugc nofollow" target="_blank">N_TYPE</a></code> values</figcaption></figure><p id="f55a" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">The <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/nlist.h#L100" rel="noopener ugc nofollow" target="_blank">n_desc</a></code> is a 2-byte-wide description of the symbol and can take the following values:</p><ul class=""><li id="9487" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vd ve vf bh" data-selectable-paragraph=""><code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/nlist.h#L195" rel="noopener ugc nofollow" target="_blank">REFERENCE_TYPE</a></code> — describe if the undefined symbol is lazy or not:</li></ul><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl zm"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*fa48PB0bXAQRRHDRR3rqiA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*fa48PB0bXAQRRHDRR3rqiA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*fa48PB0bXAQRRHDRR3rqiA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*fa48PB0bXAQRRHDRR3rqiA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*fa48PB0bXAQRRHDRR3rqiA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*fa48PB0bXAQRRHDRR3rqiA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fa48PB0bXAQRRHDRR3rqiA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*fa48PB0bXAQRRHDRR3rqiA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*fa48PB0bXAQRRHDRR3rqiA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*fa48PB0bXAQRRHDRR3rqiA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*fa48PB0bXAQRRHDRR3rqiA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*fa48PB0bXAQRRHDRR3rqiA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*fa48PB0bXAQRRHDRR3rqiA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*fa48PB0bXAQRRHDRR3rqiA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="249" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*fa48PB0bXAQRRHDRR3rqiA.png"></picture></div></div></figure><ul class=""><li id="3a11" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vd ve vf bh" data-selectable-paragraph=""><code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/nlist.h#L210" rel="noopener ugc nofollow" target="_blank">REFERENCED_DYNAMICALLY</a></code> — symbols referenced by dynamic shared libraries or bundles with this marking will not be stripped:</li></ul><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl zn"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*gTaooU0hVu_Or51KAxqAtw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*gTaooU0hVu_Or51KAxqAtw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*gTaooU0hVu_Or51KAxqAtw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*gTaooU0hVu_Or51KAxqAtw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*gTaooU0hVu_Or51KAxqAtw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*gTaooU0hVu_Or51KAxqAtw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gTaooU0hVu_Or51KAxqAtw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*gTaooU0hVu_Or51KAxqAtw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*gTaooU0hVu_Or51KAxqAtw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*gTaooU0hVu_Or51KAxqAtw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*gTaooU0hVu_Or51KAxqAtw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*gTaooU0hVu_Or51KAxqAtw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*gTaooU0hVu_Or51KAxqAtw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*gTaooU0hVu_Or51KAxqAtw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="68" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*gTaooU0hVu_Or51KAxqAtw.png"></picture></div></div></figure><ul class=""><li id="b8e5" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vd ve vf bh" data-selectable-paragraph=""><code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/nlist.h#L257" rel="noopener ugc nofollow" target="_blank">N_NO_DEAD_STRIP</a></code> — only appears in relocatable (<code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L113" rel="noopener ugc nofollow" target="_blank">MH_OBJECT</a></code> filetype <code class="cu vp vq vr vh b">.o</code>) and instruct the static link editor not to strip the symbol:</li><li id="6320" class="mm mn ha mo b mp wm mr ms mt wn mv mw mx wo mz na nb wp nd ne nf wq nh ni nj vd ve vf bh" data-selectable-paragraph=""><code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/nlist.h#L264" rel="noopener ugc nofollow" target="_blank">N_DESC_DISCARDED</a></code> — never appear in a linked image, used in rare cases by the dynamic link editor to mark an in-memory symbol as discarded:</li></ul><figure class="nn no np nq nr ns nk nl paragraph-image"><div class="nk nl zo"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*EBDI-WPF8Eaewq_k310K0Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*EBDI-WPF8Eaewq_k310K0Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*EBDI-WPF8Eaewq_k310K0Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*EBDI-WPF8Eaewq_k310K0Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*EBDI-WPF8Eaewq_k310K0Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*EBDI-WPF8Eaewq_k310K0Q.png 1100w, https://miro.medium.com/v2/resize:fit:1168/format:webp/1*EBDI-WPF8Eaewq_k310K0Q.png 1168w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 584px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*EBDI-WPF8Eaewq_k310K0Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*EBDI-WPF8Eaewq_k310K0Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*EBDI-WPF8Eaewq_k310K0Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*EBDI-WPF8Eaewq_k310K0Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*EBDI-WPF8Eaewq_k310K0Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*EBDI-WPF8Eaewq_k310K0Q.png 1100w, https://miro.medium.com/v2/resize:fit:1168/1*EBDI-WPF8Eaewq_k310K0Q.png 1168w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 584px"><img alt="" class="be lt nx c" width="584" height="164" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:730/1*EBDI-WPF8Eaewq_k310K0Q.png"></picture></div></figure><ul class=""><li id="310a" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vd ve vf bh" data-selectable-paragraph=""><code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/nlist.h#L271C7-L271C7" rel="noopener ugc nofollow" target="_blank">N_WEAK_REF</a></code> undefined symbol is allowed to be missing (address 0):</li></ul><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl zp"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*G2jkDKiwsqZi6IoutGTcOQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*G2jkDKiwsqZi6IoutGTcOQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*G2jkDKiwsqZi6IoutGTcOQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*G2jkDKiwsqZi6IoutGTcOQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*G2jkDKiwsqZi6IoutGTcOQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*G2jkDKiwsqZi6IoutGTcOQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G2jkDKiwsqZi6IoutGTcOQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*G2jkDKiwsqZi6IoutGTcOQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*G2jkDKiwsqZi6IoutGTcOQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*G2jkDKiwsqZi6IoutGTcOQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*G2jkDKiwsqZi6IoutGTcOQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*G2jkDKiwsqZi6IoutGTcOQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*G2jkDKiwsqZi6IoutGTcOQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*G2jkDKiwsqZi6IoutGTcOQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="83" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*G2jkDKiwsqZi6IoutGTcOQ.png"></picture></div></div></figure><ul class=""><li id="3c65" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vd ve vf bh" data-selectable-paragraph=""><code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/nlist.h#L279C1-L279C1" rel="noopener ugc nofollow" target="_blank">N_WEAK_DEF</a></code> — specify a <strong class="mo hb"><em class="uz">weak symbol </em></strong><em class="uz">that</em><strong class="mo hb"><em class="uz"> </em></strong><em class="uz">can be overridden or replaced by a non-weak (strong) symbol if both exist in the program.</em></li></ul><p id="c01e" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph=""><em class="uz">Only supported for symbols in sections of code or data that can be merged or combined into a single section during the linking process — </em><strong class="mo hb"><em class="uz">coalesced sections.</em></strong></p><ul class=""><li id="fe51" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vd ve vf bh" data-selectable-paragraph=""><code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/nlist.h#L285" rel="noopener ugc nofollow" target="_blank">N_REF_TO_WEAK</a></code> — an undefined, weak symbol that should be resolved using <em class="uz">flat namespace searching</em> (without following a strict hierarchy):</li></ul><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl zq"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*F9tQvc8pxXqDtoOWjoM-vw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*F9tQvc8pxXqDtoOWjoM-vw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*F9tQvc8pxXqDtoOWjoM-vw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*F9tQvc8pxXqDtoOWjoM-vw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*F9tQvc8pxXqDtoOWjoM-vw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*F9tQvc8pxXqDtoOWjoM-vw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F9tQvc8pxXqDtoOWjoM-vw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*F9tQvc8pxXqDtoOWjoM-vw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*F9tQvc8pxXqDtoOWjoM-vw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*F9tQvc8pxXqDtoOWjoM-vw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*F9tQvc8pxXqDtoOWjoM-vw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*F9tQvc8pxXqDtoOWjoM-vw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*F9tQvc8pxXqDtoOWjoM-vw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*F9tQvc8pxXqDtoOWjoM-vw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="87" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*F9tQvc8pxXqDtoOWjoM-vw.png"></picture></div></div></figure><p id="8e6c" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph=""><em class="uz">Flat namespace searching suits scenarios where optional, weak symbols are used, and their presence or absence does not cause errors during linking.</em></p><ul class=""><li id="9c32" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vd ve vf bh" data-selectable-paragraph=""><code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/nlist.h#L242" rel="noopener ugc nofollow" target="_blank">LIBRARY_ORDINAL</a></code> — only for binaries with <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L148" rel="noopener ugc nofollow" target="_blank">MH_TWOLEVEL</a></code> flag in the header. It is a library index where the symbol is defined:</li></ul><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl zr"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*BhTZtJXxIdv8oqkNG3tiVg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*BhTZtJXxIdv8oqkNG3tiVg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*BhTZtJXxIdv8oqkNG3tiVg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*BhTZtJXxIdv8oqkNG3tiVg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*BhTZtJXxIdv8oqkNG3tiVg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*BhTZtJXxIdv8oqkNG3tiVg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BhTZtJXxIdv8oqkNG3tiVg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*BhTZtJXxIdv8oqkNG3tiVg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*BhTZtJXxIdv8oqkNG3tiVg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*BhTZtJXxIdv8oqkNG3tiVg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*BhTZtJXxIdv8oqkNG3tiVg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*BhTZtJXxIdv8oqkNG3tiVg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*BhTZtJXxIdv8oqkNG3tiVg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*BhTZtJXxIdv8oqkNG3tiVg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="118" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*BhTZtJXxIdv8oqkNG3tiVg.png"></picture></div></div></figure><p id="de26" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph=""><em class="uz">Two-level Namespace is enabled in the linker by default. The first level is the library’s name, and the second is the name of the symbol it contains.</em></p><ul class=""><li id="88b1" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vd ve vf bh" data-selectable-paragraph="">Based on the above, the <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/nlist.h#L100C7-L100C7" rel="noopener ugc nofollow" target="_blank">n_desc</a></code> field can have the following values:</li></ul><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl nm"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*o_M43im2diozinCAiL_qhA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*o_M43im2diozinCAiL_qhA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*o_M43im2diozinCAiL_qhA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*o_M43im2diozinCAiL_qhA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*o_M43im2diozinCAiL_qhA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*o_M43im2diozinCAiL_qhA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o_M43im2diozinCAiL_qhA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*o_M43im2diozinCAiL_qhA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*o_M43im2diozinCAiL_qhA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*o_M43im2diozinCAiL_qhA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*o_M43im2diozinCAiL_qhA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*o_M43im2diozinCAiL_qhA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*o_M43im2diozinCAiL_qhA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*o_M43im2diozinCAiL_qhA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="139" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*o_M43im2diozinCAiL_qhA.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph=""><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/nlist.h#L100C7-L100C7" rel="noopener ugc nofollow" target="_blank">n_desc</a> format visualization</figcaption></figure><p id="3519" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">You can see the combinations for <em class="uz">Symbol Table</em> and <em class="uz">String Table</em> using the Symbols tab in the MachOView:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xq"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ZgyUOtTGgDWdnsS-8wV6zA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ZgyUOtTGgDWdnsS-8wV6zA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ZgyUOtTGgDWdnsS-8wV6zA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ZgyUOtTGgDWdnsS-8wV6zA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ZgyUOtTGgDWdnsS-8wV6zA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ZgyUOtTGgDWdnsS-8wV6zA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZgyUOtTGgDWdnsS-8wV6zA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*ZgyUOtTGgDWdnsS-8wV6zA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ZgyUOtTGgDWdnsS-8wV6zA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ZgyUOtTGgDWdnsS-8wV6zA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ZgyUOtTGgDWdnsS-8wV6zA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ZgyUOtTGgDWdnsS-8wV6zA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ZgyUOtTGgDWdnsS-8wV6zA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ZgyUOtTGgDWdnsS-8wV6zA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="271" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*ZgyUOtTGgDWdnsS-8wV6zA.png"></picture></div></div></figure><h2 id="9c5b" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">Dynamic Symbol Table</h2><p id="c019" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">The <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L920" rel="noopener ugc nofollow" target="_blank">LC_DYSYMTAB</a></code> enhances the <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L871" rel="noopener ugc nofollow" target="_blank">LC_SYMTAB</a></code> to improve the layout of symbols with greater precision. If <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L920" rel="noopener ugc nofollow" target="_blank">LC_DYSYMTAB</a></code> exist, <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L871" rel="noopener ugc nofollow" target="_blank">LC_SYMTAB</a></code> must exist too.</p><p id="5cb2" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">It is described by the <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L920" rel="noopener ugc nofollow" target="_blank">dysymtab_command</a></code> structure and provides information about the <em class="uz">Dynamic Symbol Table</em>, which the <em class="uz">Dynamic Linker</em> uses:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl zs"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*mj1qW6TrbY-Vz_xxc4_pIw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*mj1qW6TrbY-Vz_xxc4_pIw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*mj1qW6TrbY-Vz_xxc4_pIw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*mj1qW6TrbY-Vz_xxc4_pIw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*mj1qW6TrbY-Vz_xxc4_pIw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*mj1qW6TrbY-Vz_xxc4_pIw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mj1qW6TrbY-Vz_xxc4_pIw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*mj1qW6TrbY-Vz_xxc4_pIw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*mj1qW6TrbY-Vz_xxc4_pIw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*mj1qW6TrbY-Vz_xxc4_pIw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*mj1qW6TrbY-Vz_xxc4_pIw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*mj1qW6TrbY-Vz_xxc4_pIw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*mj1qW6TrbY-Vz_xxc4_pIw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*mj1qW6TrbY-Vz_xxc4_pIw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="773" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*mj1qW6TrbY-Vz_xxc4_pIw.png"></picture></div></div></figure><ul class=""><li id="8a61" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vd ve vf bh" data-selectable-paragraph=""><strong class="mo hb">Local symbols</strong> —for debugging, associated with a specific module.</li><li id="7bc4" class="mm mn ha mo b mp wm mr ms mt wn mv mw mx wo mz na nb wp nd ne nf wq nh ni nj vd ve vf bh" data-selectable-paragraph=""><strong class="mo hb">Externally defined symbols — </strong>defined in other modules or libraries.</li><li id="0a04" class="mm mn ha mo b mp wm mr ms mt wn mv mw mx wo mz na nb wp nd ne nf wq nh ni nj vd ve vf bh" data-selectable-paragraph=""><strong class="mo hb">Undefined symbols — </strong>referenced in the binary but not defined within it. They need to be resolved during dynamic linking.</li><li id="4a6d" class="mm mn ha mo b mp wm mr ms mt wn mv mw mx wo mz na nb wp nd ne nf wq nh ni nj vd ve vf bh" data-selectable-paragraph=""><strong class="mo hb">Indirect symbols</strong> — resolve references to symbols by providing indices into the symbol table.</li></ul><p id="59df" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">After introducing <em class="uz">Chained Fixups</em>, I could not see in <code class="cu vp vq vr vh b">LC_DYSYMTAB</code> data related to:</p><ul class=""><li id="a783" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vd ve vf bh" data-selectable-paragraph=""><strong class="mo hb">Table of Contents (ToC)</strong> — maps defined external symbols to the modules where they are defined.</li><li id="d390" class="mm mn ha mo b mp wm mr ms mt wn mv mw mx wo mz na nb wp nd ne nf wq nh ni nj vd ve vf bh" data-selectable-paragraph=""><strong class="mo hb">Module Table</strong> — associates modules with their respective symbol tables and other information.</li><li id="a5a0" class="mm mn ha mo b mp wm mr ms mt wn mv mw mx wo mz na nb wp nd ne nf wq nh ni nj vd ve vf bh" data-selectable-paragraph=""><strong class="mo hb">Referenced Symbol Table</strong> — specifies external references made by each module.</li><li id="d549" class="mm mn ha mo b mp wm mr ms mt wn mv mw mx wo mz na nb wp nd ne nf wq nh ni nj vd ve vf bh" data-selectable-paragraph=""><strong class="mo hb">External Relocation — </strong>used to adjust addresses when code or data is loaded at different addresses during execution.</li><li id="e369" class="mm mn ha mo b mp wm mr ms mt wn mv mw mx wo mz na nb wp nd ne nf wq nh ni nj vd ve vf bh" data-selectable-paragraph=""><strong class="mo hb">Local Relocation —</strong>used for relocating code and data within the same module.</li></ul><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl zh"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ZLtYGfci4T1pux4xsdV2jw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ZLtYGfci4T1pux4xsdV2jw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ZLtYGfci4T1pux4xsdV2jw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ZLtYGfci4T1pux4xsdV2jw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ZLtYGfci4T1pux4xsdV2jw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ZLtYGfci4T1pux4xsdV2jw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZLtYGfci4T1pux4xsdV2jw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*ZLtYGfci4T1pux4xsdV2jw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ZLtYGfci4T1pux4xsdV2jw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ZLtYGfci4T1pux4xsdV2jw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ZLtYGfci4T1pux4xsdV2jw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ZLtYGfci4T1pux4xsdV2jw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ZLtYGfci4T1pux4xsdV2jw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ZLtYGfci4T1pux4xsdV2jw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="349" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*ZLtYGfci4T1pux4xsdV2jw.png"></picture></div></div></figure><p id="4e65" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">The <em class="uz">Dynamic Symbol Table</em> provides data on where to find a certain type of symbol and how many exist. It also stores info about <em class="uz">Indirect Symbols</em>:</p></div></div><div class="ns"><div class="ab by"><div class="lo wr lp ws lq wt cc wu cd wv cf be"><figure class="nn no np nq nr ns ww wx paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl zt"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*xd0_vK-emAFz97-BV3nUtQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*xd0_vK-emAFz97-BV3nUtQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*xd0_vK-emAFz97-BV3nUtQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*xd0_vK-emAFz97-BV3nUtQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*xd0_vK-emAFz97-BV3nUtQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*xd0_vK-emAFz97-BV3nUtQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*xd0_vK-emAFz97-BV3nUtQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*xd0_vK-emAFz97-BV3nUtQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*xd0_vK-emAFz97-BV3nUtQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*xd0_vK-emAFz97-BV3nUtQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*xd0_vK-emAFz97-BV3nUtQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*xd0_vK-emAFz97-BV3nUtQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*xd0_vK-emAFz97-BV3nUtQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*xd0_vK-emAFz97-BV3nUtQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be lt nx c" width="1000" height="176" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*xd0_vK-emAFz97-BV3nUtQ.png"></picture></div></div></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><p id="53f2" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph=""><em class="uz">Indirect symbol table entry is a 32-bit value that serves as an index in the symbol table. This index points to the symbol pointer or stub in the binary it refers to.</em></p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl zu"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*0tvvdU2JV-3VBE-h-y-DZw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*0tvvdU2JV-3VBE-h-y-DZw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*0tvvdU2JV-3VBE-h-y-DZw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*0tvvdU2JV-3VBE-h-y-DZw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*0tvvdU2JV-3VBE-h-y-DZw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*0tvvdU2JV-3VBE-h-y-DZw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0tvvdU2JV-3VBE-h-y-DZw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*0tvvdU2JV-3VBE-h-y-DZw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*0tvvdU2JV-3VBE-h-y-DZw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*0tvvdU2JV-3VBE-h-y-DZw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*0tvvdU2JV-3VBE-h-y-DZw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*0tvvdU2JV-3VBE-h-y-DZw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*0tvvdU2JV-3VBE-h-y-DZw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*0tvvdU2JV-3VBE-h-y-DZw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="262" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*0tvvdU2JV-3VBE-h-y-DZw.png"></picture></div></div></figure><h2 id="e910" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">DYNAMIC LINKER &amp; ENVIRONMENT VARIABLES</h2><p id="f487" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">The <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L790" rel="noopener ugc nofollow" target="_blank">LC_LOAD_DYLINKER</a></code> indicates the Dynamic Linker path that XNU uses to run the binary. It is described by <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/3ea72890c2df44a3640bdf13e94fad3f3dbadca9/I.%20Mach-O/mac/loader.h#L790" rel="noopener ugc nofollow" target="_blank">dylinker_command</a></code>:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl zv"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*GY8ceQ4PamJ9N-ZojhGuiw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*GY8ceQ4PamJ9N-ZojhGuiw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*GY8ceQ4PamJ9N-ZojhGuiw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*GY8ceQ4PamJ9N-ZojhGuiw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*GY8ceQ4PamJ9N-ZojhGuiw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*GY8ceQ4PamJ9N-ZojhGuiw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GY8ceQ4PamJ9N-ZojhGuiw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*GY8ceQ4PamJ9N-ZojhGuiw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*GY8ceQ4PamJ9N-ZojhGuiw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*GY8ceQ4PamJ9N-ZojhGuiw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*GY8ceQ4PamJ9N-ZojhGuiw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*GY8ceQ4PamJ9N-ZojhGuiw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*GY8ceQ4PamJ9N-ZojhGuiw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*GY8ceQ4PamJ9N-ZojhGuiw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="177" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*GY8ceQ4PamJ9N-ZojhGuiw.png"></picture></div></div></figure><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl zw"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*YZVE-OQbe6qfsmZ6z0vw0g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*YZVE-OQbe6qfsmZ6z0vw0g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*YZVE-OQbe6qfsmZ6z0vw0g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*YZVE-OQbe6qfsmZ6z0vw0g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*YZVE-OQbe6qfsmZ6z0vw0g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*YZVE-OQbe6qfsmZ6z0vw0g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YZVE-OQbe6qfsmZ6z0vw0g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*YZVE-OQbe6qfsmZ6z0vw0g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*YZVE-OQbe6qfsmZ6z0vw0g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*YZVE-OQbe6qfsmZ6z0vw0g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*YZVE-OQbe6qfsmZ6z0vw0g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*YZVE-OQbe6qfsmZ6z0vw0g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*YZVE-OQbe6qfsmZ6z0vw0g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*YZVE-OQbe6qfsmZ6z0vw0g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="96" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*YZVE-OQbe6qfsmZ6z0vw0g.png"></picture></div></div></figure><p id="4d46" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">The same structure is used for <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L281" rel="noopener ugc nofollow" target="_blank">LC_ID_DYLINKER</a></code>, which identifies Mach-O as a dynamic linker and <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L314" rel="noopener ugc nofollow" target="_blank">LC_DYLD_ENVIRONMENT</a></code> used for built-into Mach-O file environment variables:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div class="nk nl xi"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*C5yGDYUT59ceov5F-WGjRg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*C5yGDYUT59ceov5F-WGjRg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*C5yGDYUT59ceov5F-WGjRg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*C5yGDYUT59ceov5F-WGjRg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*C5yGDYUT59ceov5F-WGjRg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*C5yGDYUT59ceov5F-WGjRg.png 1100w, https://miro.medium.com/v2/resize:fit:1216/format:webp/1*C5yGDYUT59ceov5F-WGjRg.png 1216w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 608px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*C5yGDYUT59ceov5F-WGjRg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*C5yGDYUT59ceov5F-WGjRg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*C5yGDYUT59ceov5F-WGjRg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*C5yGDYUT59ceov5F-WGjRg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*C5yGDYUT59ceov5F-WGjRg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*C5yGDYUT59ceov5F-WGjRg.png 1100w, https://miro.medium.com/v2/resize:fit:1216/1*C5yGDYUT59ceov5F-WGjRg.png 1216w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 608px"><img alt="" class="be lt nx c" width="608" height="162" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:760/1*C5yGDYUT59ceov5F-WGjRg.png"></picture></div></figure><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl zx"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*lqPdODhPObndZI5H7kj5JA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*lqPdODhPObndZI5H7kj5JA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*lqPdODhPObndZI5H7kj5JA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*lqPdODhPObndZI5H7kj5JA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*lqPdODhPObndZI5H7kj5JA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*lqPdODhPObndZI5H7kj5JA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lqPdODhPObndZI5H7kj5JA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*lqPdODhPObndZI5H7kj5JA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*lqPdODhPObndZI5H7kj5JA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*lqPdODhPObndZI5H7kj5JA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*lqPdODhPObndZI5H7kj5JA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*lqPdODhPObndZI5H7kj5JA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*lqPdODhPObndZI5H7kj5JA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*lqPdODhPObndZI5H7kj5JA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="145" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*lqPdODhPObndZI5H7kj5JA.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph="">Example <code class="cu vp vq vr vh b">LC_ID_DYLINKER command in dyld</code></figcaption></figure><blockquote class="va vb vc"><p id="564a" class="mm mn uz mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">More about ID and environemnt is described in article about Dylibs.</p></blockquote><h2 id="56e3" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">UUID</h2><p id="bda6" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">The <code class="cu vp vq vr vh b">LC_UUID</code> command specifies file <code class="cu vp vq vr vh b">128-bit</code> <a class="af te" href="https://en.wikipedia.org/wiki/Universally_unique_identifier" rel="noopener ugc nofollow" target="_blank"><em class="uz">Universally unique identifier</em></a> (<a class="af te" href="https://developer.apple.com/documentation/foundation/uuid" rel="noopener ugc nofollow" target="_blank"><em class="uz">UUID</em></a>) and is described by the <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L1175" rel="noopener ugc nofollow" target="_blank">uuid_command</a></code> data structure:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl zy"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Q__dQvIv7ZlH5T56qyd6zg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Q__dQvIv7ZlH5T56qyd6zg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Q__dQvIv7ZlH5T56qyd6zg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Q__dQvIv7ZlH5T56qyd6zg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Q__dQvIv7ZlH5T56qyd6zg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Q__dQvIv7ZlH5T56qyd6zg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q__dQvIv7ZlH5T56qyd6zg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*Q__dQvIv7ZlH5T56qyd6zg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Q__dQvIv7ZlH5T56qyd6zg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Q__dQvIv7ZlH5T56qyd6zg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Q__dQvIv7ZlH5T56qyd6zg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Q__dQvIv7ZlH5T56qyd6zg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Q__dQvIv7ZlH5T56qyd6zg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Q__dQvIv7ZlH5T56qyd6zg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="154" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*Q__dQvIv7ZlH5T56qyd6zg.png"></picture></div></div></figure><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl zh"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*D8AjqVWkCjmWIS5l_8ZGkA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*D8AjqVWkCjmWIS5l_8ZGkA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*D8AjqVWkCjmWIS5l_8ZGkA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*D8AjqVWkCjmWIS5l_8ZGkA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*D8AjqVWkCjmWIS5l_8ZGkA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*D8AjqVWkCjmWIS5l_8ZGkA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D8AjqVWkCjmWIS5l_8ZGkA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*D8AjqVWkCjmWIS5l_8ZGkA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*D8AjqVWkCjmWIS5l_8ZGkA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*D8AjqVWkCjmWIS5l_8ZGkA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*D8AjqVWkCjmWIS5l_8ZGkA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*D8AjqVWkCjmWIS5l_8ZGkA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*D8AjqVWkCjmWIS5l_8ZGkA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*D8AjqVWkCjmWIS5l_8ZGkA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="79" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*D8AjqVWkCjmWIS5l_8ZGkA.png"></picture></div></div></figure><p id="8a29" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">You can create such UUID using <code class="cu vp vq vr vh b">uuidgen</code>:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl zz"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*kgGWWLwkhrxy1WAiSOtSGw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*kgGWWLwkhrxy1WAiSOtSGw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*kgGWWLwkhrxy1WAiSOtSGw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*kgGWWLwkhrxy1WAiSOtSGw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*kgGWWLwkhrxy1WAiSOtSGw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*kgGWWLwkhrxy1WAiSOtSGw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kgGWWLwkhrxy1WAiSOtSGw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*kgGWWLwkhrxy1WAiSOtSGw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*kgGWWLwkhrxy1WAiSOtSGw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*kgGWWLwkhrxy1WAiSOtSGw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*kgGWWLwkhrxy1WAiSOtSGw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*kgGWWLwkhrxy1WAiSOtSGw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*kgGWWLwkhrxy1WAiSOtSGw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*kgGWWLwkhrxy1WAiSOtSGw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="178" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*kgGWWLwkhrxy1WAiSOtSGw.png"></picture></div></div></figure><blockquote class="va vb vc"><p id="19fa" class="mm mn uz mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">They are used in many places by macOS, such as Gatekeeper tracking quarantine apps by their UUID. You can read more about UUIDs <a class="af te" href="https://eclecticlight.co/2017/08/16/whats-a-uuid/" rel="noopener ugc nofollow" target="_blank">here</a>.</p></blockquote><h2 id="3486" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">BUILD VERSION</h2><p id="cdac" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">The <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L326" rel="noopener ugc nofollow" target="_blank">LC_BUILD_VERSION</a></code> specifies the minimum OS version and platform for which the binary was built. It is described by the <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L1263" rel="noopener ugc nofollow" target="_blank">build_version_command</a></code>:</p></div></div><div class="ns"><div class="ab by"><div class="lo wr lp ws lq wt cc wu cd wv cf be"><figure class="nn no np nq nr ns ww wx paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl aba"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*0KNAd2olj5RnYGqMe5rNDw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*0KNAd2olj5RnYGqMe5rNDw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*0KNAd2olj5RnYGqMe5rNDw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*0KNAd2olj5RnYGqMe5rNDw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*0KNAd2olj5RnYGqMe5rNDw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*0KNAd2olj5RnYGqMe5rNDw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*0KNAd2olj5RnYGqMe5rNDw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*0KNAd2olj5RnYGqMe5rNDw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*0KNAd2olj5RnYGqMe5rNDw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*0KNAd2olj5RnYGqMe5rNDw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*0KNAd2olj5RnYGqMe5rNDw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*0KNAd2olj5RnYGqMe5rNDw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*0KNAd2olj5RnYGqMe5rNDw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*0KNAd2olj5RnYGqMe5rNDw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be lt nx c" width="1000" height="317" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*0KNAd2olj5RnYGqMe5rNDw.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph=""><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L1278" rel="noopener ugc nofollow" target="_blank">platform constants</a></figcaption></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><p id="6ab5" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">The list of tools(<code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L1273C8-L1273C8" rel="noopener ugc nofollow" target="_blank">build_tool_version</a></code>) follows <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L1263" rel="noopener ugc nofollow" target="_blank">build_version_command</a></code>.</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl zh"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*tXsOgIcUuWSqobRIkR7H4A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*tXsOgIcUuWSqobRIkR7H4A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*tXsOgIcUuWSqobRIkR7H4A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*tXsOgIcUuWSqobRIkR7H4A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*tXsOgIcUuWSqobRIkR7H4A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*tXsOgIcUuWSqobRIkR7H4A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tXsOgIcUuWSqobRIkR7H4A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*tXsOgIcUuWSqobRIkR7H4A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*tXsOgIcUuWSqobRIkR7H4A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*tXsOgIcUuWSqobRIkR7H4A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*tXsOgIcUuWSqobRIkR7H4A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*tXsOgIcUuWSqobRIkR7H4A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*tXsOgIcUuWSqobRIkR7H4A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*tXsOgIcUuWSqobRIkR7H4A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="159" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*tXsOgIcUuWSqobRIkR7H4A.png"></picture></div></div></figure><h2 id="7345" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">Source Version</h2><p id="0fe8" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">The <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L318" rel="noopener ugc nofollow" target="_blank">LC_SOURCE_VERSION</a></code> command provides the version of the sources used to build the binary. It is described by <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L1545" rel="noopener ugc nofollow" target="_blank">source_version_command</a></code>:</p></div></div><div class="ns"><div class="ab by"><div class="lo wr lp ws lq wt cc wu cd wv cf be"><figure class="nn no np nq nr ns ww wx paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl abb"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*AI0QPuL49S3Y-5mh1HOS0A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*AI0QPuL49S3Y-5mh1HOS0A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*AI0QPuL49S3Y-5mh1HOS0A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*AI0QPuL49S3Y-5mh1HOS0A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*AI0QPuL49S3Y-5mh1HOS0A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*AI0QPuL49S3Y-5mh1HOS0A.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*AI0QPuL49S3Y-5mh1HOS0A.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*AI0QPuL49S3Y-5mh1HOS0A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*AI0QPuL49S3Y-5mh1HOS0A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*AI0QPuL49S3Y-5mh1HOS0A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*AI0QPuL49S3Y-5mh1HOS0A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*AI0QPuL49S3Y-5mh1HOS0A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*AI0QPuL49S3Y-5mh1HOS0A.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*AI0QPuL49S3Y-5mh1HOS0A.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be lt nx c" width="1000" height="200" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*AI0QPuL49S3Y-5mh1HOS0A.png"></picture></div></div></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><p id="452d" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">The version field is a 64-bit integer in a packed format, used to represent version numbers as follows:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl abc"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*zyEmxVlupSi74GPYTxgXyw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*zyEmxVlupSi74GPYTxgXyw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*zyEmxVlupSi74GPYTxgXyw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*zyEmxVlupSi74GPYTxgXyw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*zyEmxVlupSi74GPYTxgXyw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*zyEmxVlupSi74GPYTxgXyw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zyEmxVlupSi74GPYTxgXyw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*zyEmxVlupSi74GPYTxgXyw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*zyEmxVlupSi74GPYTxgXyw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*zyEmxVlupSi74GPYTxgXyw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*zyEmxVlupSi74GPYTxgXyw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*zyEmxVlupSi74GPYTxgXyw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*zyEmxVlupSi74GPYTxgXyw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*zyEmxVlupSi74GPYTxgXyw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="103" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*zyEmxVlupSi74GPYTxgXyw.png"></picture></div></div></figure><p id="dc98" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">It is useful for version tracking and source version identification:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl abd"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*zlavltxQfQkqmOmnjiL9nw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*zlavltxQfQkqmOmnjiL9nw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*zlavltxQfQkqmOmnjiL9nw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*zlavltxQfQkqmOmnjiL9nw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*zlavltxQfQkqmOmnjiL9nw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*zlavltxQfQkqmOmnjiL9nw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zlavltxQfQkqmOmnjiL9nw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*zlavltxQfQkqmOmnjiL9nw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*zlavltxQfQkqmOmnjiL9nw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*zlavltxQfQkqmOmnjiL9nw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*zlavltxQfQkqmOmnjiL9nw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*zlavltxQfQkqmOmnjiL9nw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*zlavltxQfQkqmOmnjiL9nw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*zlavltxQfQkqmOmnjiL9nw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="77" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*zlavltxQfQkqmOmnjiL9nw.png"></picture></div></div></figure><h2 id="1931" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">Entry Point</h2><p id="d5dc" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">The <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L316" rel="noopener ugc nofollow" target="_blank">LC_MAIN</a></code> command specifies the location (file offset) of <code class="cu vp vq vr vh b">main()</code> and is described by <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L1533" rel="noopener ugc nofollow" target="_blank">entry_point_command</a></code>:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl abe"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Uwd1qxntO94ef7wF55Ss0g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Uwd1qxntO94ef7wF55Ss0g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Uwd1qxntO94ef7wF55Ss0g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Uwd1qxntO94ef7wF55Ss0g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Uwd1qxntO94ef7wF55Ss0g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Uwd1qxntO94ef7wF55Ss0g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uwd1qxntO94ef7wF55Ss0g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*Uwd1qxntO94ef7wF55Ss0g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Uwd1qxntO94ef7wF55Ss0g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Uwd1qxntO94ef7wF55Ss0g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Uwd1qxntO94ef7wF55Ss0g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Uwd1qxntO94ef7wF55Ss0g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Uwd1qxntO94ef7wF55Ss0g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Uwd1qxntO94ef7wF55Ss0g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="171" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*Uwd1qxntO94ef7wF55Ss0g.png"></picture></div></div></figure><p id="594e" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">During load time, dyld adds the <em class="uz">Entry Offset</em> value to the binary’s base and executes the binary’s code by jumping to <em class="uz">Entry Point</em>:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xq"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*K9WGa2lxda1Mo1WgXfS43g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*K9WGa2lxda1Mo1WgXfS43g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*K9WGa2lxda1Mo1WgXfS43g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*K9WGa2lxda1Mo1WgXfS43g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*K9WGa2lxda1Mo1WgXfS43g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*K9WGa2lxda1Mo1WgXfS43g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K9WGa2lxda1Mo1WgXfS43g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*K9WGa2lxda1Mo1WgXfS43g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*K9WGa2lxda1Mo1WgXfS43g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*K9WGa2lxda1Mo1WgXfS43g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*K9WGa2lxda1Mo1WgXfS43g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*K9WGa2lxda1Mo1WgXfS43g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*K9WGa2lxda1Mo1WgXfS43g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*K9WGa2lxda1Mo1WgXfS43g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="124" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*K9WGa2lxda1Mo1WgXfS43g.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph="">Example <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L1533" rel="noopener ugc nofollow" target="_blank">entry_point_command</a></code></figcaption></figure><blockquote class="va vb vc"><p id="1a42" class="mm mn uz mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">The entry point is the <code class="cu vp vq vr vh b">main()</code> by default, but it can be changed.</p></blockquote><h2 id="060f" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">Dynamic Libraries</h2><p id="6f27" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">Several Load Commands provide dyld with information on dynamic libraries (dylibs), and all of them use <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L687" rel="noopener ugc nofollow" target="_blank">dylib_command</a></code> structure:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl abf"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*6DzOsfa9s1068V0bx9VbBA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*6DzOsfa9s1068V0bx9VbBA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*6DzOsfa9s1068V0bx9VbBA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*6DzOsfa9s1068V0bx9VbBA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*6DzOsfa9s1068V0bx9VbBA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*6DzOsfa9s1068V0bx9VbBA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6DzOsfa9s1068V0bx9VbBA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*6DzOsfa9s1068V0bx9VbBA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*6DzOsfa9s1068V0bx9VbBA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*6DzOsfa9s1068V0bx9VbBA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*6DzOsfa9s1068V0bx9VbBA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*6DzOsfa9s1068V0bx9VbBA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*6DzOsfa9s1068V0bx9VbBA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*6DzOsfa9s1068V0bx9VbBA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="461" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*6DzOsfa9s1068V0bx9VbBA.png"></picture></div></div></figure><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xq"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*rPJ5hRxguojaH1nSyPxLCg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*rPJ5hRxguojaH1nSyPxLCg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*rPJ5hRxguojaH1nSyPxLCg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*rPJ5hRxguojaH1nSyPxLCg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*rPJ5hRxguojaH1nSyPxLCg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*rPJ5hRxguojaH1nSyPxLCg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rPJ5hRxguojaH1nSyPxLCg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*rPJ5hRxguojaH1nSyPxLCg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*rPJ5hRxguojaH1nSyPxLCg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*rPJ5hRxguojaH1nSyPxLCg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*rPJ5hRxguojaH1nSyPxLCg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*rPJ5hRxguojaH1nSyPxLCg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*rPJ5hRxguojaH1nSyPxLCg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*rPJ5hRxguojaH1nSyPxLCg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="127" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*rPJ5hRxguojaH1nSyPxLCg.png"></picture></div></div></figure><blockquote class="va vb vc"><p id="4e0a" class="mm mn uz mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">Dynamic libraries are loaded and used to resolve symbols during runtime. <br>I will write more about it in Snake&amp;Apple IV — Dylibs.</p></blockquote><h2 id="db28" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">Function Addresses</h2><p id="993b" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">The <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/3ea72890c2df44a3640bdf13e94fad3f3dbadca9/I.%20Mach-O/mac/loader.h#L313" rel="noopener ugc nofollow" target="_blank">LC_FUNCTION_STARTS</a></code> command is a table of function start addresses. The <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L1195" rel="noopener ugc nofollow" target="_blank">linkedit_data_command</a></code> structure describes it:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl abg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*30xB5PUEoijWEzfsTx7fvQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*30xB5PUEoijWEzfsTx7fvQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*30xB5PUEoijWEzfsTx7fvQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*30xB5PUEoijWEzfsTx7fvQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*30xB5PUEoijWEzfsTx7fvQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*30xB5PUEoijWEzfsTx7fvQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*30xB5PUEoijWEzfsTx7fvQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*30xB5PUEoijWEzfsTx7fvQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*30xB5PUEoijWEzfsTx7fvQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*30xB5PUEoijWEzfsTx7fvQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*30xB5PUEoijWEzfsTx7fvQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*30xB5PUEoijWEzfsTx7fvQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*30xB5PUEoijWEzfsTx7fvQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*30xB5PUEoijWEzfsTx7fvQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="267" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*30xB5PUEoijWEzfsTx7fvQ.png"></picture></div></div></figure><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl zh"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*muh-6f1h8PwHyVm07nZSOA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*muh-6f1h8PwHyVm07nZSOA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*muh-6f1h8PwHyVm07nZSOA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*muh-6f1h8PwHyVm07nZSOA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*muh-6f1h8PwHyVm07nZSOA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*muh-6f1h8PwHyVm07nZSOA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*muh-6f1h8PwHyVm07nZSOA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*muh-6f1h8PwHyVm07nZSOA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*muh-6f1h8PwHyVm07nZSOA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*muh-6f1h8PwHyVm07nZSOA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*muh-6f1h8PwHyVm07nZSOA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*muh-6f1h8PwHyVm07nZSOA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*muh-6f1h8PwHyVm07nZSOA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*muh-6f1h8PwHyVm07nZSOA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="133" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*muh-6f1h8PwHyVm07nZSOA.png"></picture></div></div></figure><p id="cb03" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">The function names are debugging information, and they do not appear in release builds to defend against reverse engineering and save app size:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xq"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*WNassXxLeVPD-NWI7uH4_Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*WNassXxLeVPD-NWI7uH4_Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*WNassXxLeVPD-NWI7uH4_Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*WNassXxLeVPD-NWI7uH4_Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*WNassXxLeVPD-NWI7uH4_Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*WNassXxLeVPD-NWI7uH4_Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WNassXxLeVPD-NWI7uH4_Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*WNassXxLeVPD-NWI7uH4_Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*WNassXxLeVPD-NWI7uH4_Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*WNassXxLeVPD-NWI7uH4_Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*WNassXxLeVPD-NWI7uH4_Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*WNassXxLeVPD-NWI7uH4_Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*WNassXxLeVPD-NWI7uH4_Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*WNassXxLeVPD-NWI7uH4_Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="356" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*WNassXxLeVPD-NWI7uH4_Q.png"></picture></div></div></figure><h2 id="f1cb" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">DATA_IN_CODE</h2><p id="4237" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">The <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L317" rel="noopener ugc nofollow" target="_blank">DATA_IN_CODE</a></code> command specifies a segment’s offset and size, which records the locations of certain data inlined in the <code class="cu vp vq vr vh b">__TEXT</code> segment.</p><p id="f527" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">The load command utilises a generic <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L1195" rel="noopener ugc nofollow" target="_blank">linkedit_data_command</a></code> and each data entry is in the format described in the <code class="cu vp vq vr vh b"><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/mac/loader.h#L1557" rel="noopener ugc nofollow" target="_blank">data_in_code_entry</a></code> struct:</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl abh"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*EPHuf4rQMY4NdIL37BJinQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*EPHuf4rQMY4NdIL37BJinQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*EPHuf4rQMY4NdIL37BJinQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*EPHuf4rQMY4NdIL37BJinQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*EPHuf4rQMY4NdIL37BJinQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*EPHuf4rQMY4NdIL37BJinQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EPHuf4rQMY4NdIL37BJinQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*EPHuf4rQMY4NdIL37BJinQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*EPHuf4rQMY4NdIL37BJinQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*EPHuf4rQMY4NdIL37BJinQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*EPHuf4rQMY4NdIL37BJinQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*EPHuf4rQMY4NdIL37BJinQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*EPHuf4rQMY4NdIL37BJinQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*EPHuf4rQMY4NdIL37BJinQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="277" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*EPHuf4rQMY4NdIL37BJinQ.png"></picture></div></div></figure><blockquote class="va vb vc"><p id="478c" class="mm mn uz mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">It is rarely seen and only used to make reverse engineering easier.</p></blockquote><h2 id="b3d8" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">LC_CODE_SIGNATURE</h2><p id="5ea0" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">Indicate offset and size of Code Signature.</p><blockquote class="va vb vc"><p id="9d90" class="mm mn uz mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">Described in Snake&amp;Apple II— Code Signing.</p></blockquote></div></div></div><div class="ab by uo up uq ur" role="separator"><span class="su bv bj us ut ps"></span><span class="su bv bj us ut ps"></span><span class="su bv bj us ut"></span></div><div class="gt gu gv gw gx"><div class="ab by"><div class="cf be fx fy fz ga"><h1 id="0d46" class="ny nz ha bc oa ob uu od oe of uv oh oi oj uw ol om on ux op oq or uy ot ou ov bh" data-selectable-paragraph="">Parsing Mach-O with Python</h1><p id="461f" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">I have chosen not to rewrite the entire code here, as it is available in the repository with detailed comments. I will focus on the fundamentals, complex areas, and <a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/python/CrimsonUroboros.py" rel="noopener ugc nofollow" target="_blank">CrimsonUroboros</a> tool usage.</p><p id="3bf5" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">The <a class="af te" href="https://pypi.org/project/lief/#description" rel="noopener ugc nofollow" target="_blank"><em class="uz">Lief</em></a> library provides classes to work with <em class="uz">Mach-O</em> files.</p><pre class="nn no np nq nr vg vh vi bm vj ay bh"><span id="9c94" class="vk nz ha vh b bd vl vm l vn vo" data-selectable-paragraph="">pip install lief</span></pre><blockquote class="va vb vc"><p id="85d9" class="mm mn uz mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph=""><a class="af te" href="https://lief-project.github.io/doc/stable/api/python/macho.html" rel="noopener ugc nofollow" target="_blank">Lief library official documentation</a></p></blockquote><h2 id="f3d7" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">FILE PARSING</h2><p id="74c0" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">There are three initial steps for parsing <em class="uz">Mach-O</em> with <em class="uz">Python</em> using <em class="uz">Lief</em>:</p><ul class=""><li id="028b" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vd ve vf bh" data-selectable-paragraph="">Import <code class="cu vp vq vr vh b">lief</code></li><li id="2167" class="mm mn ha mo b mp wm mr ms mt wn mv mw mx wo mz na nb wp nd ne nf wq nh ni nj vd ve vf bh" data-selectable-paragraph="">Specify the <em class="uz">Mach-O</em> file to open</li><li id="2ebd" class="mm mn ha mo b mp wm mr ms mt wn mv mw mx wo mz na nb wp nd ne nf wq nh ni nj vd ve vf bh" data-selectable-paragraph="">Parse the <em class="uz">Mach-O</em> file as a <em class="uz">Fat Binary</em></li></ul><pre class="nn no np nq nr vg vh vi bm vj ay bh"><span id="ab3d" class="vk nz ha vh b bd vl vm l vn vo" data-selectable-paragraph="">import lief<br><br>file_path = './binary'<br>binaries = lief.MachO.parse(file_path)</span></pre><blockquote class="va vb vc"><p id="34d0" class="mm mn uz mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">The <code class="cu vp vq vr vh b">lief.MachO.parse</code> instead of the <code class="cu vp vq vr vh b">lief.parse</code> function is used to return <strong class="mo hb">list</strong> of <code class="cu vp vq vr vh b">lief.MachO.binary</code> instead of a single one.</p></blockquote><h2 id="3f49" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">HEADERS</h2><p id="a79b" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">Extract header from <em class="uz">Mach-O</em> object:</p><pre class="nn no np nq nr vg vh vi bm vj ay bh"><span id="c28f" class="vk nz ha vh b bd vl vm l vn vo" data-selectable-paragraph="">header = binaries[0].header</span></pre><ul class=""><li id="bcce" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vd ve vf bh" data-selectable-paragraph="">Dealing with <em class="uz">Universal Binary to get ARM64 object:</em></li></ul><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl abi"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*rin-H5PJvwWfoaHuhu3UqA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*rin-H5PJvwWfoaHuhu3UqA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*rin-H5PJvwWfoaHuhu3UqA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*rin-H5PJvwWfoaHuhu3UqA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*rin-H5PJvwWfoaHuhu3UqA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*rin-H5PJvwWfoaHuhu3UqA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rin-H5PJvwWfoaHuhu3UqA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*rin-H5PJvwWfoaHuhu3UqA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*rin-H5PJvwWfoaHuhu3UqA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*rin-H5PJvwWfoaHuhu3UqA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*rin-H5PJvwWfoaHuhu3UqA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*rin-H5PJvwWfoaHuhu3UqA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*rin-H5PJvwWfoaHuhu3UqA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*rin-H5PJvwWfoaHuhu3UqA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="98" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*rin-H5PJvwWfoaHuhu3UqA.png"></picture></div></div></figure><pre class="nn no np nq nr vg vh vi bm vj ay bh"><span id="94eb" class="vk nz ha vh b bd vl vm l vn vo" data-selectable-paragraph="">for binary in binaries:<br>    if binary.header.cpu_type == lief.MachO.CPU_TYPES.ARM64:<br>        return binary</span></pre></div></div><div class="ns"><div class="ab by"><div class="lo wr lp ws lq wt cc wu cd wv cf be"><figure class="nn no np nq nr ns ww wx paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl abj"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*uzzrLIKFGyrqppX8Hb60ZA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*uzzrLIKFGyrqppX8Hb60ZA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*uzzrLIKFGyrqppX8Hb60ZA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*uzzrLIKFGyrqppX8Hb60ZA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*uzzrLIKFGyrqppX8Hb60ZA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*uzzrLIKFGyrqppX8Hb60ZA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*uzzrLIKFGyrqppX8Hb60ZA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*uzzrLIKFGyrqppX8Hb60ZA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*uzzrLIKFGyrqppX8Hb60ZA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*uzzrLIKFGyrqppX8Hb60ZA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*uzzrLIKFGyrqppX8Hb60ZA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*uzzrLIKFGyrqppX8Hb60ZA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*uzzrLIKFGyrqppX8Hb60ZA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*uzzrLIKFGyrqppX8Hb60ZA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be lt nx c" width="1000" height="93" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*uzzrLIKFGyrqppX8Hb60ZA.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph=""><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/python/CrimsonUroboros.py#L70C9-L70C24" rel="noopener ugc nofollow" target="_blank">getBinaryHeader</a></figcaption></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><h2 id="1fbf" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">FILETYPE</h2><p id="b684" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">Check if the <a class="af te" href="https://lief-project.github.io/doc/stable/api/python/macho.html#lief.MachO.FILE_TYPES" rel="noopener ugc nofollow" target="_blank"><em class="uz">file type</em></a> of the binary is <em class="uz">executable</em>:</p><pre class="nn no np nq nr vg vh vi bm vj ay bh"><span id="2747" class="vk nz ha vh b bd vl vm l vn vo" data-selectable-paragraph="">binary.header.file_type == lief.MachO.FILE_TYPES.EXECUTE</span></pre><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl abk"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Bt32Mep7vG7HCioF8Tay4Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Bt32Mep7vG7HCioF8Tay4Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Bt32Mep7vG7HCioF8Tay4Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Bt32Mep7vG7HCioF8Tay4Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Bt32Mep7vG7HCioF8Tay4Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Bt32Mep7vG7HCioF8Tay4Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bt32Mep7vG7HCioF8Tay4Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*Bt32Mep7vG7HCioF8Tay4Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Bt32Mep7vG7HCioF8Tay4Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Bt32Mep7vG7HCioF8Tay4Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Bt32Mep7vG7HCioF8Tay4Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Bt32Mep7vG7HCioF8Tay4Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Bt32Mep7vG7HCioF8Tay4Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Bt32Mep7vG7HCioF8Tay4Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="98" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*Bt32Mep7vG7HCioF8Tay4Q.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph=""><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/python/CrimsonUroboros.py#L53C11-L53C11" rel="noopener ugc nofollow" target="_blank">getFiletype</a></figcaption></figure><ul class=""><li id="651b" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vd ve vf bh" data-selectable-paragraph="">Use <a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/python/MachOFileFinder.py" rel="noopener ugc nofollow" target="_blank">MachoFileFinder</a> to find valid Mach-O files:</li></ul><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl abl"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*tKYVFn6Z0i1bK588w1tA4g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*tKYVFn6Z0i1bK588w1tA4g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*tKYVFn6Z0i1bK588w1tA4g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*tKYVFn6Z0i1bK588w1tA4g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*tKYVFn6Z0i1bK588w1tA4g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*tKYVFn6Z0i1bK588w1tA4g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tKYVFn6Z0i1bK588w1tA4g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*tKYVFn6Z0i1bK588w1tA4g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*tKYVFn6Z0i1bK588w1tA4g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*tKYVFn6Z0i1bK588w1tA4g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*tKYVFn6Z0i1bK588w1tA4g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*tKYVFn6Z0i1bK588w1tA4g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*tKYVFn6Z0i1bK588w1tA4g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*tKYVFn6Z0i1bK588w1tA4g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="223" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*tKYVFn6Z0i1bK588w1tA4g.png"></picture></div></div></figure><h2 id="8ca9" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">ENDIANESS</h2><p id="4bda" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">Compare system byte order with the binary magic bytes:</p><pre class="nn no np nq nr vg vh vi bm vj ay bh"><span id="1865" class="vk nz ha vh b bd vl vm l vn vo" data-selectable-paragraph="">magic = arm64_bin.header.magic.name<br>endianness = sys.byteorder<br>if endianness == 'little' and magic == 'MAGIC_64':<br>    print 'litte'<br>else:<br>    print 'big'</span></pre><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl abm"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*4TKDS7oee3GX-2apS7DdFA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*4TKDS7oee3GX-2apS7DdFA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*4TKDS7oee3GX-2apS7DdFA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*4TKDS7oee3GX-2apS7DdFA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*4TKDS7oee3GX-2apS7DdFA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*4TKDS7oee3GX-2apS7DdFA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4TKDS7oee3GX-2apS7DdFA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*4TKDS7oee3GX-2apS7DdFA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*4TKDS7oee3GX-2apS7DdFA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*4TKDS7oee3GX-2apS7DdFA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*4TKDS7oee3GX-2apS7DdFA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*4TKDS7oee3GX-2apS7DdFA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*4TKDS7oee3GX-2apS7DdFA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*4TKDS7oee3GX-2apS7DdFA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="108" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*4TKDS7oee3GX-2apS7DdFA.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph=""><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/python/CrimsonUroboros.py#L61C9-L61C21" rel="noopener ugc nofollow" target="_blank">getEndianess</a></figcaption></figure><h2 id="ec42" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">HEADER FLAGS</h2><p id="ddf5" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">Extract <a class="af te" href="https://lief-project.github.io/doc/latest/api/python/macho.html#lief.MachO.HEADER_FLAGS" rel="noopener ugc nofollow" target="_blank">header flags as list</a>:</p><pre class="nn no np nq nr vg vh vi bm vj ay bh"><span id="038c" class="vk nz ha vh b bd vl vm l vn vo" data-selectable-paragraph="">binary.header.flags_list</span></pre><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl abn"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*xGO2P0anJPVRot7T8_rPIg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*xGO2P0anJPVRot7T8_rPIg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*xGO2P0anJPVRot7T8_rPIg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*xGO2P0anJPVRot7T8_rPIg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*xGO2P0anJPVRot7T8_rPIg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*xGO2P0anJPVRot7T8_rPIg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xGO2P0anJPVRot7T8_rPIg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*xGO2P0anJPVRot7T8_rPIg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*xGO2P0anJPVRot7T8_rPIg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*xGO2P0anJPVRot7T8_rPIg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*xGO2P0anJPVRot7T8_rPIg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*xGO2P0anJPVRot7T8_rPIg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*xGO2P0anJPVRot7T8_rPIg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*xGO2P0anJPVRot7T8_rPIg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="89" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*xGO2P0anJPVRot7T8_rPIg.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph=""><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/python/CrimsonUroboros.py#L57" rel="noopener ugc nofollow" target="_blank">getHeaderFlags</a></figcaption></figure><h2 id="3a94" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">LOAD COMMANDS</h2><p id="5c6e" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">Extract <a class="af te" href="https://lief-project.github.io/doc/stable/api/python/macho.html#loadcommand" rel="noopener ugc nofollow" target="_blank"><em class="uz">Load Commands</em></a><em class="uz">:</em></p><pre class="nn no np nq nr vg vh vi bm vj ay bh"><span id="a5d8" class="vk nz ha vh b bd vl vm l vn vo" data-selectable-paragraph="">for cmd in binary.commands:<br>    print(cmd)</span></pre><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl abo"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*DGnG5-aFVMeKPaDVa9Bgnw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*DGnG5-aFVMeKPaDVa9Bgnw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*DGnG5-aFVMeKPaDVa9Bgnw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*DGnG5-aFVMeKPaDVa9Bgnw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*DGnG5-aFVMeKPaDVa9Bgnw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*DGnG5-aFVMeKPaDVa9Bgnw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DGnG5-aFVMeKPaDVa9Bgnw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*DGnG5-aFVMeKPaDVa9Bgnw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*DGnG5-aFVMeKPaDVa9Bgnw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*DGnG5-aFVMeKPaDVa9Bgnw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*DGnG5-aFVMeKPaDVa9Bgnw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*DGnG5-aFVMeKPaDVa9Bgnw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*DGnG5-aFVMeKPaDVa9Bgnw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*DGnG5-aFVMeKPaDVa9Bgnw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="90" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*DGnG5-aFVMeKPaDVa9Bgnw.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph=""><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/python/CrimsonUroboros.py#L74" rel="noopener ugc nofollow" target="_blank">getLoadCommands</a></figcaption></figure><h2 id="8d57" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">SEGMENTS</h2><p id="31b1" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">Extract <a class="af te" href="https://lief-project.github.io/doc/stable/api/python/macho.html#lief.MachO.SegmentCommand" rel="noopener ugc nofollow" target="_blank"><em class="uz">Segments</em></a>:</p><pre class="nn no np nq nr vg vh vi bm vj ay bh"><span id="f6c0" class="vk nz ha vh b bd vl vm l vn vo" data-selectable-paragraph="">for segment in binary.segments:<br>    print(segment)</span></pre></div></div><div class="ns"><div class="ab by"><div class="lo wr lp ws lq wt cc wu cd wv cf be"><figure class="nn no np nq nr ns ww wx paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl abp"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*AuKGO9ADmqBSsukFuZJ-3g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*AuKGO9ADmqBSsukFuZJ-3g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*AuKGO9ADmqBSsukFuZJ-3g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*AuKGO9ADmqBSsukFuZJ-3g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*AuKGO9ADmqBSsukFuZJ-3g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*AuKGO9ADmqBSsukFuZJ-3g.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*AuKGO9ADmqBSsukFuZJ-3g.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*AuKGO9ADmqBSsukFuZJ-3g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*AuKGO9ADmqBSsukFuZJ-3g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*AuKGO9ADmqBSsukFuZJ-3g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*AuKGO9ADmqBSsukFuZJ-3g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*AuKGO9ADmqBSsukFuZJ-3g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*AuKGO9ADmqBSsukFuZJ-3g.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*AuKGO9ADmqBSsukFuZJ-3g.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be lt nx c" width="1000" height="141" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*AuKGO9ADmqBSsukFuZJ-3g.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph=""><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/python/CrimsonUroboros.py#L78C14-L78C14" rel="noopener ugc nofollow" target="_blank">getSegments</a></figcaption></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><h2 id="8ff6" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">SECTIONS</h2><p id="d5eb" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">Extract <a class="af te" href="https://lief-project.github.io/doc/stable/api/python/macho.html#lief.MachO.Section" rel="noopener ugc nofollow" target="_blank"><em class="uz">Sections</em></a><em class="uz">:</em></p><pre class="nn no np nq nr vg vh vi bm vj ay bh"><span id="1804" class="vk nz ha vh b bd vl vm l vn vo" data-selectable-paragraph="">for section in binary.sections:<br>    print(section)</span></pre></div></div><div class="ns"><div class="ab by"><div class="lo wr lp ws lq wt cc wu cd wv cf be"><figure class="nn no np nq nr ns ww wx paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl abq"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*VnyPOFt366V9PYTh25zcJA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*VnyPOFt366V9PYTh25zcJA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*VnyPOFt366V9PYTh25zcJA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*VnyPOFt366V9PYTh25zcJA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*VnyPOFt366V9PYTh25zcJA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*VnyPOFt366V9PYTh25zcJA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*VnyPOFt366V9PYTh25zcJA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*VnyPOFt366V9PYTh25zcJA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*VnyPOFt366V9PYTh25zcJA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*VnyPOFt366V9PYTh25zcJA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*VnyPOFt366V9PYTh25zcJA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*VnyPOFt366V9PYTh25zcJA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*VnyPOFt366V9PYTh25zcJA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*VnyPOFt366V9PYTh25zcJA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be lt nx c" width="1000" height="146" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*VnyPOFt366V9PYTh25zcJA.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph=""><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/python/CrimsonUroboros.py#L96" rel="noopener ugc nofollow" target="_blank">getSections</a></figcaption></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><h2 id="d032" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">CHAINED FIXUPS</h2><p id="d7cb" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">Extract <a class="af te" href="https://lief-project.github.io/doc/latest/api/python/macho.html#chained-binding-info" rel="noopener ugc nofollow" target="_blank"><em class="uz">Chained Binding Info</em></a>:</p><pre class="nn no np nq nr vg vh vi bm vj ay bh"><span id="57c9" class="vk nz ha vh b bd vl vm l vn vo" data-selectable-paragraph="">binary.dyld_chained_fixups</span></pre><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl abr"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*IBkQVGYdgEme0KRhdqHSgg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*IBkQVGYdgEme0KRhdqHSgg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*IBkQVGYdgEme0KRhdqHSgg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*IBkQVGYdgEme0KRhdqHSgg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*IBkQVGYdgEme0KRhdqHSgg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*IBkQVGYdgEme0KRhdqHSgg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IBkQVGYdgEme0KRhdqHSgg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*IBkQVGYdgEme0KRhdqHSgg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*IBkQVGYdgEme0KRhdqHSgg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*IBkQVGYdgEme0KRhdqHSgg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*IBkQVGYdgEme0KRhdqHSgg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*IBkQVGYdgEme0KRhdqHSgg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*IBkQVGYdgEme0KRhdqHSgg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*IBkQVGYdgEme0KRhdqHSgg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="618" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*IBkQVGYdgEme0KRhdqHSgg.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph=""><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/python/CrimsonUroboros.py#L120" rel="noopener ugc nofollow" target="_blank">getChainedFixups</a></figcaption></figure><h2 id="2d6e" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">Exports Trie</h2><p id="7ab3" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">Extract <a class="af te" href="https://lief-project.github.io/doc/latest/api/python/macho.html#dyldexportstrie-command" rel="noopener ugc nofollow" target="_blank">Exports Trie</a>:</p><pre class="nn no np nq nr vg vh vi bm vj ay bh"><span id="a479" class="vk nz ha vh b bd vl vm l vn vo" data-selectable-paragraph="">binary.dyld_exports_trie.show_export_trie()</span></pre><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl abs"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*D7nLpxO5i3dJJhOhuj5Bzw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*D7nLpxO5i3dJJhOhuj5Bzw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*D7nLpxO5i3dJJhOhuj5Bzw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*D7nLpxO5i3dJJhOhuj5Bzw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*D7nLpxO5i3dJJhOhuj5Bzw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*D7nLpxO5i3dJJhOhuj5Bzw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D7nLpxO5i3dJJhOhuj5Bzw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*D7nLpxO5i3dJJhOhuj5Bzw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*D7nLpxO5i3dJJhOhuj5Bzw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*D7nLpxO5i3dJJhOhuj5Bzw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*D7nLpxO5i3dJJhOhuj5Bzw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*D7nLpxO5i3dJJhOhuj5Bzw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*D7nLpxO5i3dJJhOhuj5Bzw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*D7nLpxO5i3dJJhOhuj5Bzw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="204" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*D7nLpxO5i3dJJhOhuj5Bzw.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph=""><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/python/CrimsonUroboros.py#L124C18-L124C18" rel="noopener ugc nofollow" target="_blank">getExportsTrie</a></figcaption></figure><h2 id="314b" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph=""><strong class="al">SYMBOLS</strong></h2><p id="44a7" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">Extract <a class="af te" href="https://lief-project.github.io/doc/stable/api/python/macho.html#symbol" rel="noopener ugc nofollow" target="_blank"><em class="uz">symbols</em></a>:</p><pre class="nn no np nq nr vg vh vi bm vj ay bh"><span id="521a" class="vk nz ha vh b bd vl vm l vn vo" data-selectable-paragraph="">for symbol in binary.symbols:<br>    print(symbol)</span></pre><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl abt"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*utuQZuYgihSQljyUvzXz-g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*utuQZuYgihSQljyUvzXz-g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*utuQZuYgihSQljyUvzXz-g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*utuQZuYgihSQljyUvzXz-g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*utuQZuYgihSQljyUvzXz-g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*utuQZuYgihSQljyUvzXz-g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*utuQZuYgihSQljyUvzXz-g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*utuQZuYgihSQljyUvzXz-g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*utuQZuYgihSQljyUvzXz-g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*utuQZuYgihSQljyUvzXz-g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*utuQZuYgihSQljyUvzXz-g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*utuQZuYgihSQljyUvzXz-g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*utuQZuYgihSQljyUvzXz-g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*utuQZuYgihSQljyUvzXz-g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="215" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*utuQZuYgihSQljyUvzXz-g.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph=""><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/python/CrimsonUroboros.py#L115C9-L115C19" rel="noopener ugc nofollow" target="_blank">getSymbols</a></figcaption></figure><h2 id="51fd" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">STRINGS</h2><p id="07a4" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">Extract <em class="uz">strings</em> from the <em class="uz">string table</em> (<code class="cu vp vq vr vh b"><a class="af te" href="https://lief-project.github.io/doc/stable/api/python/macho.html#section-types" rel="noopener ugc nofollow" target="_blank">CSTRING_LITERALS</a></code>):</p><pre class="nn no np nq nr vg vh vi bm vj ay bh"><span id="6bab" class="vk nz ha vh b bd vl vm l vn vo" data-selectable-paragraph="">for section in binary.sections:<br>    if section.type == lief.MachO.SECTION_TYPES.CSTRING_LITERALS:<br>        extracted_strings.update(section.content.tobytes().split(b'\x00'))</span></pre><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl abu"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*FHpGLWNz63BLnvLojv8E1A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*FHpGLWNz63BLnvLojv8E1A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*FHpGLWNz63BLnvLojv8E1A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*FHpGLWNz63BLnvLojv8E1A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*FHpGLWNz63BLnvLojv8E1A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*FHpGLWNz63BLnvLojv8E1A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FHpGLWNz63BLnvLojv8E1A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*FHpGLWNz63BLnvLojv8E1A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*FHpGLWNz63BLnvLojv8E1A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*FHpGLWNz63BLnvLojv8E1A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*FHpGLWNz63BLnvLojv8E1A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*FHpGLWNz63BLnvLojv8E1A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*FHpGLWNz63BLnvLojv8E1A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*FHpGLWNz63BLnvLojv8E1A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="207" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*FHpGLWNz63BLnvLojv8E1A.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph=""><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/python/CrimsonUroboros.py#L144C12-L144C12" rel="noopener ugc nofollow" target="_blank">getStringSection</a></figcaption></figure><ul class=""><li id="0597" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vd ve vf bh" data-selectable-paragraph="">For extracting <a class="af te" href="https://lief-project.github.io/doc/stable/api/python/macho.html#section-types" rel="noopener ugc nofollow" target="_blank">strings from all sections</a>:</li></ul><pre class="nn no np nq nr vg vh vi bm vj ay bh"><span id="7364" class="vk nz ha vh b bd vl vm l vn vo" data-selectable-paragraph="">byte_set = set()<br>for section in binary.sections:<br>    byte_set.update(section.content.tobytes().split(b'\x00'))<br><br>for byte_item in byte_set:<br>    try:<br>        ascii_string = byte_item.decode('utf-8')<br>        print(ascii_string)<br>    except UnicodeDecodeError:<br>        pass</span></pre><h2 id="696d" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">UUID</h2><pre class="nn no np nq nr vg vh vi bm vj ay bh"><span id="83d7" class="vk nz ha vh b bd vl vm l vn vo" data-selectable-paragraph="">for cmd in binary.commands:<br>    if isinstance(cmd, lief.MachO.UUIDCommand):<br>        uuid_bytes = cmd.uuid<br>        break<br><br>uuid_string = str(uuid.UUID(bytes=bytes(uuid_bytes)))<br>print(uuid_string)</span></pre><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl abv"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ZQ8SIHfU3gRw2AEb1LpXUA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ZQ8SIHfU3gRw2AEb1LpXUA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ZQ8SIHfU3gRw2AEb1LpXUA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ZQ8SIHfU3gRw2AEb1LpXUA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ZQ8SIHfU3gRw2AEb1LpXUA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ZQ8SIHfU3gRw2AEb1LpXUA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZQ8SIHfU3gRw2AEb1LpXUA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*ZQ8SIHfU3gRw2AEb1LpXUA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ZQ8SIHfU3gRw2AEb1LpXUA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ZQ8SIHfU3gRw2AEb1LpXUA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ZQ8SIHfU3gRw2AEb1LpXUA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ZQ8SIHfU3gRw2AEb1LpXUA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ZQ8SIHfU3gRw2AEb1LpXUA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ZQ8SIHfU3gRw2AEb1LpXUA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="110" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*ZQ8SIHfU3gRw2AEb1LpXUA.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph=""><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/python/CrimsonUroboros.py#L131" rel="noopener ugc nofollow" target="_blank">getUUID</a></figcaption></figure><h2 id="175e" class="vw nz ha bc oa vx vy dv oe vz wa dx oi mx wb wc wd nb we wf wg nf wh wi wj wk bh" data-selectable-paragraph="">MAIN</h2><p id="8c4d" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">Determine the entry point of an executable:</p><pre class="nn no np nq nr vg vh vi bm vj ay bh"><span id="0af4" class="vk nz ha vh b bd vl vm l vn vo" data-selectable-paragraph="">binary.main_command</span></pre><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl abw"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*u1ver2cf5VZJBvU79zE9qw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*u1ver2cf5VZJBvU79zE9qw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*u1ver2cf5VZJBvU79zE9qw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*u1ver2cf5VZJBvU79zE9qw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*u1ver2cf5VZJBvU79zE9qw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*u1ver2cf5VZJBvU79zE9qw.png 1100w, https://miro.medium.com/v2/resize:fit:1286/format:webp/1*u1ver2cf5VZJBvU79zE9qw.png 1286w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 643px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*u1ver2cf5VZJBvU79zE9qw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*u1ver2cf5VZJBvU79zE9qw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*u1ver2cf5VZJBvU79zE9qw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*u1ver2cf5VZJBvU79zE9qw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*u1ver2cf5VZJBvU79zE9qw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*u1ver2cf5VZJBvU79zE9qw.png 1100w, https://miro.medium.com/v2/resize:fit:1286/1*u1ver2cf5VZJBvU79zE9qw.png 1286w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 643px"><img alt="" class="be lt nx c" width="643" height="162" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:804/1*u1ver2cf5VZJBvU79zE9qw.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph=""><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/python/CrimsonUroboros.py#L140" rel="noopener ugc nofollow" target="_blank">getMain</a></figcaption></figure><h1 id="1b2f" class="ny nz ha bc oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov bh" data-selectable-paragraph="">FINAL WORDS</h1><p id="c812" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">The programs resulting from this article (<a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/python/CrimsonUroboros.py#L140" rel="noopener ugc nofollow" target="_blank"><strong class="mo hb">CrimsonUroboros.py</strong></a><strong class="mo hb"> </strong>and<strong class="mo hb"> </strong><a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/python/MachOFileFinder.py" rel="noopener ugc nofollow" target="_blank"><strong class="mo hb">MachOFileFinder.py</strong></a>) can be found in the <a class="af te" href="https://github.com/Karmaz95/Snake_Apple/tree/main" rel="noopener ugc nofollow" target="_blank"><strong class="mo hb">Snake-Apple I. Mach-O</strong></a> repository. I plan to add additional features to it as I continue to develop it.</p></div></div><div class="ns"><div class="ab by"><div class="lo wr lp ws lq wt cc wu cd wv cf be"><figure class="nn no np nq nr ns ww wx paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl abx"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Vc5eQPObkDKcH9lTx74w_Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Vc5eQPObkDKcH9lTx74w_Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Vc5eQPObkDKcH9lTx74w_Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Vc5eQPObkDKcH9lTx74w_Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Vc5eQPObkDKcH9lTx74w_Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Vc5eQPObkDKcH9lTx74w_Q.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*Vc5eQPObkDKcH9lTx74w_Q.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*Vc5eQPObkDKcH9lTx74w_Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Vc5eQPObkDKcH9lTx74w_Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Vc5eQPObkDKcH9lTx74w_Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Vc5eQPObkDKcH9lTx74w_Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Vc5eQPObkDKcH9lTx74w_Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Vc5eQPObkDKcH9lTx74w_Q.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*Vc5eQPObkDKcH9lTx74w_Q.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be lt nx c" width="1000" height="515" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*Vc5eQPObkDKcH9lTx74w_Q.png"></picture></div></div><figcaption class="vt fc tx nk nl vu vv bc b bd z dr" data-selectable-paragraph="">Current version of the <a class="af te" href="https://github.com/Karmaz95/Snake_Apple/blob/main/I.%20Mach-O/python/CrimsonUroboros.py" rel="noopener ugc nofollow" target="_blank"><strong class="bc oa">CrimsonUroboros</strong></a></figcaption></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><p id="4b23" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">It is just the beginning; a few simple things to familiarise yourself with the <a class="af te" href="https://lief-project.github.io/doc/stable/api/python/macho.html#api-python-macho--page-root" rel="noopener ugc nofollow" target="_blank">Lief</a> library and <a class="af te" href="https://developer.apple.com/library/archive/documentation/Performance/Conceptual/CodeFootprint/Articles/MachOOverview.html" rel="noopener ugc nofollow" target="_blank">Mach-O</a> format.</p><p id="6315" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph=""><em class="uz">If you enjoyed the article, please share it. If you have any suggestions, let me know in the comments.</em></p><p id="ac39" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">The following article will explore the <a class="af te" href="https://developer.apple.com/support/code-signing/" rel="noopener ugc nofollow" target="_blank"><strong class="mo hb">Code Signing</strong></a><strong class="mo hb"> </strong>mechanisms that prevent <a class="af te" href="https://cwe.mitre.org/data/definitions/829.html" rel="noopener ugc nofollow" target="_blank">unauthorized code execution from trustworthy software</a>.</p><blockquote class="ye"><p id="b7f9" class="yf yg ha bc yh yi aby abz aca acb acc nj dr" data-selectable-paragraph="">Sssssssssstay tuned.</p></blockquote></div></div></div></div></section></div></div></article><div class="ab by"><div class="cf be fx fy fz ga"></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><div class="acd ace ab jc"><div class="qw ab"><a class="tw av am ao" href="https://medium.com/tag/cybersecurity?source=post_page-----a8eda4b87263---------------cybersecurity-----------------" rel="noopener follow"><div class="qe fg cu acf gc acg ach bc b bd z bh aci">Cybersecurity</div></a></div><div class="qw ab"><a class="tw av am ao" href="https://medium.com/tag/apple?source=post_page-----a8eda4b87263---------------apple-----------------" rel="noopener follow"><div class="qe fg cu acf gc acg ach bc b bd z bh aci">Apple</div></a></div><div class="qw ab"><a class="tw av am ao" href="https://medium.com/tag/programming?source=post_page-----a8eda4b87263---------------programming-----------------" rel="noopener follow"><div class="qe fg cu acf gc acg ach bc b bd z bh aci">Programming</div></a></div><div class="qw ab"><a class="tw av am ao" href="https://medium.com/tag/python?source=post_page-----a8eda4b87263---------------python-----------------" rel="noopener follow"><div class="qe fg cu acf gc acg ach bc b bd z bh aci">Python</div></a></div><div class="qw ab"><a class="tw av am ao" href="https://medium.com/tag/information-technology?source=post_page-----a8eda4b87263---------------information_technology-----------------" rel="noopener follow"><div class="qe fg cu acf gc acg ach bc b bd z bh aci">Information Technology</div></a></div></div></div></div><div class="l"></div><footer class="pb pc pd pe pf pg ph pi gs ab q pj pk c"><div class="l ae"><div class="ab by"><div class="cf be fx fy fz ga"><div class="ab cm pl"><div class="ab q kl"><div class="pm l"><span class="l pn po pp e d"><div class="ab q kl km"><div class="pw-multi-vote-icon fg gq kn ko kp"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fa8eda4b87263&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fsnake-apple-i-mach-o-a8eda4b87263&amp;user=Karol+Mazurek&amp;userId=3f7ab05f0f68&amp;source=-----a8eda4b87263---------------------clap_footer-----------" rel="noopener follow"><div><div class="bj" aria-hidden="false" aria-describedby="9" aria-labelledby="9"><div class="kq ao kr ks kt ku am kv kw kx kp"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ky kz la lb lc ld le"><div><div class="bj" aria-hidden="false" aria-describedby="83" aria-labelledby="83"><p class="bc b ds z dr"><button class="af ag ah ai aj ak al am an ao ap aq ar as at tq lm">27<span class="l h g f pq pr"></span></button></p></div></div></div></div></span><span class="l h g f pq pr"><div class="ab q kl km"><div class="pw-multi-vote-icon fg gq kn ko kp"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fa8eda4b87263&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fsnake-apple-i-mach-o-a8eda4b87263&amp;user=Karol+Mazurek&amp;userId=3f7ab05f0f68&amp;source=-----a8eda4b87263---------------------clap_footer-----------" rel="noopener follow"><div><div class="bj" aria-hidden="false" aria-describedby="10" aria-labelledby="10"><div class="kq ao kr ks kt ku am kv kw kx kp"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ky kz la lb lc ld le"><div><div class="bj" aria-hidden="false" aria-describedby="85" aria-labelledby="85"><p class="bc b ds z dr"><button class="af ag ah ai aj ak al am an ao ap aq ar as at tq lm">27</button></p></div></div></div></div></span></div><div class="bn ab"><div><div class="bj" aria-hidden="false" aria-describedby="11" aria-labelledby="11"><button class="ao kq lh li ab q fh lj lk" aria-label="responses"><svg width="24" height="24" viewBox="0 0 24 24" class="hw"><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg><p class="bc b bd z dr"><span class="pw-responses-count lg hw">1</span></p></button></div></div></div></div><div class="ab q"><div class="ps l iz"><div><div class="bj" aria-hidden="false" aria-describedby="12" aria-labelledby="12"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa8eda4b87263&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fsnake-apple-i-mach-o-a8eda4b87263&amp;source=--------------------------bookmark_footer-----------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dr lm" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div><div class="ps l iz"><div class="bj" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bj" aria-hidden="false" aria-describedby="13" aria-labelledby="13"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fh ah ai aj ak al lu an ao ap eu lv lw lk lx"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.22 4.93a.42.42 0 0 1-.12.13h.01a.45.45 0 0 1-.29.08.52.52 0 0 1-.3-.13L12.5 3v7.07a.5.5 0 0 1-.5.5.5.5 0 0 1-.5-.5V3.02l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.8a.42.42 0 0 1 .07.5zm-.1.14zm.88 2h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11a2 2 0 0 1-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.14c.1.1.15.22.15.35a.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9V8.96c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1z" fill="currentColor"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="pt pu pv pw px l bu"><div class="ab by"><div class="cf be fx fy fz ga"><div class="ci ab py cm"><div class="ab ih"><a rel="noopener follow" href="/?source=post_page-----a8eda4b87263--------------------------------"><div class="l pz qa bv qb il"><div class="l fg"><img alt="Karol Mazurek" class="l fa bv qc qd cu" src="https://miro.medium.com/v2/da:true/resize:fill:144:144/0*BLalJfMaz_JDj6fg" width="72" height="72" loading="lazy"><div class="im bv l qc qd fp n in fq"></div></div></div></a></div><div class="j i d"><div class="ab"><span><button class="bc b bd z el qe em eo ep eq er es et eu ev ew ex qf ey ez fa bj fb fc">Follow</button></span><div class="dq l"><div><div><div class="bj" aria-hidden="false" aria-describedby="107" aria-labelledby="107"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe71c64288bc8&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fsnake-apple-i-mach-o-a8eda4b87263&amp;newsletterV3=3f7ab05f0f68&amp;newsletterV3Id=e71c64288bc8&amp;user=Karol+Mazurek&amp;userId=3f7ab05f0f68&amp;source=-----a8eda4b87263---------------------subscribe_user-----------" rel="noopener follow"><button class="bc b bd z qj am qk ql qm qn qo qp qq qr et eu ev ew ex ey ez fa bj fb fc" aria-label="Subscribe"><svg width="38" height="38" viewBox="0 0 38 38" fill="none" class="qg qh qi"><rect x="26.25" y="9.25" width="0.5" height="6.5" rx="0.25"></rect><rect x="29.75" y="12.25" width="0.5" height="6.5" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5L19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="ab ck cm"><div class="l"><div class="ab q"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/?source=post_page-----a8eda4b87263--------------------------------"><h2 class="pw-author-name bc qs qt qu qv bh"><span class="gt je">Written by <!-- -->Karol Mazurek</span></h2></a></div><div class="qw ab"><div class="l iz"><span class="pw-follower-count bc b bd z bh"><a class="af ag ah ai aj ak al am an ao ap aq ar is" rel="noopener follow" href="/followers?source=post_page-----a8eda4b87263--------------------------------">1.1K Followers</a></span></div></div><div class="qx l"><p class="bc b bd z bh"><span class="gt">Offensive Security Engineer</span></p></div></div><div class="h k"><div class="ab"><span><button class="bc b bd z el qe em eo ep eq er es et eu ev ew ex qf ey ez fa bj fb fc">Follow</button></span><div class="dq l"><div><div><div class="bj" aria-hidden="false" aria-describedby="108" aria-labelledby="108"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe71c64288bc8&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fsnake-apple-i-mach-o-a8eda4b87263&amp;newsletterV3=3f7ab05f0f68&amp;newsletterV3Id=e71c64288bc8&amp;user=Karol+Mazurek&amp;userId=3f7ab05f0f68&amp;source=-----a8eda4b87263---------------------subscribe_user-----------" rel="noopener follow"><button class="bc b bd z qj am qk ql qm qn qo qp qq qr et eu ev ew ex ey ez fa bj fb fc" aria-label="Subscribe"><svg width="38" height="38" viewBox="0 0 38 38" fill="none" class="qg qh qi"><rect x="26.25" y="9.25" width="0.5" height="6.5" rx="0.25"></rect><rect x="29.75" y="12.25" width="0.5" height="6.5" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5L19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="qy be qz gl gm gn go gp"></div></div></div><div class="h k j"><div class="qy be qz ra"></div><div class="ab by"><div class="cf be fx fy fz ga"><div class="rb ab kl jc"><div class="rc rd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----a8eda4b87263--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Help</p></a></div><div class="rc rd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----a8eda4b87263--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Status</p></a></div><div class="rc rd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/about?autoplay=1&amp;source=post_page-----a8eda4b87263--------------------------------" rel="noopener follow"><p class="bc b ds z dr">About</p></a></div><div class="rc rd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----a8eda4b87263--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Careers</p></a></div><div class="rc rd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="mailto:pressinquiries@medium.com?source=post_page-----a8eda4b87263--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Press</p></a></div><div class="rc rd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----a8eda4b87263--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Blog</p></a></div><div class="rc rd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a8eda4b87263--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Privacy</p></a></div><div class="rc rd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a8eda4b87263--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Terms</p></a></div><div class="rc rd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----a8eda4b87263--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Text to speech</p></a></div><div class="rc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/business?source=post_page-----a8eda4b87263--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20240614-221838-3ba87a70fa"</script><script>window.__GRAPHQL_URI__ = "https://karol-mazurek.medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-a8eda4b87263","user-3f7ab05f0f68"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"updatedPostPreviewsEnabled":true,"lohpExperimentEnabled":"group_2","prideLogoEnabled":true},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":true,"routingEntity":{"type":"USER","id":"3f7ab05f0f68","explicit":true},"viewerIsBot":false},"debug":{"requestId":"6b2aa151-2290-4843-92d3-fe92e9f1a46c","hybridDevServices":[],"originalSpanCarrier":{"ot-tracer-spanid":"0e2632af07c9a963","ot-tracer-traceid":"1f0ebb8546964275","ot-tracer-sampled":"true"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fkarol-mazurek.medium.com\u002Fsnake-apple-i-mach-o-a8eda4b87263","host":"karol-mazurek.medium.com","hostname":"karol-mazurek.medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20240614-221838-3ba87a70fa","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20240614-221838-3ba87a70fa","commit":"3ba87a70fa89456c9162015acb3c1797c92f4b41"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"1*OMF3fSqH8t4xBJ9-6oZDZw.png","height":106,"width":545},"postLogo":{"imageId":"1*kFrc4tBFM_tCis-2Ic87WA.png","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"isLoggedIn":false,"collectionByDomainOrSlug({\"domainOrSlug\":\"karol-mazurek.medium.com\"})":null,"postResult({\"id\":\"a8eda4b87263\"})":{"__ref":"Post:a8eda4b87263"}},"MastodonAccount:karmaz@infosec.exchange":{"__typename":"MastodonAccount","domain":"infosec.exchange","username":"karmaz","id":"karmaz@infosec.exchange"},"LinkedAccounts:3f7ab05f0f68":{"__typename":"LinkedAccounts","mastodon":{"__ref":"MastodonAccount:karmaz@infosec.exchange"},"id":"3f7ab05f0f68"},"UserViewerEdge:userId:3f7ab05f0f68-viewerId:lo_9b8a45aa89d5":{"__typename":"UserViewerEdge","id":"userId:3f7ab05f0f68-viewerId:lo_9b8a45aa89d5","isFollowing":false,"isUser":false,"isMuting":false},"NewsletterV3:e71c64288bc8":{"__typename":"NewsletterV3","id":"e71c64288bc8","type":"NEWSLETTER_TYPE_AUTHOR","slug":"3f7ab05f0f68","name":"3f7ab05f0f68","collection":null,"user":{"__ref":"User:3f7ab05f0f68"}},"User:3f7ab05f0f68":{"__typename":"User","id":"3f7ab05f0f68","name":"Karol Mazurek","username":"karol-mazurek","newsletterV3":{"__ref":"NewsletterV3:e71c64288bc8"},"linkedAccounts":{"__ref":"LinkedAccounts:3f7ab05f0f68"},"isSuspended":false,"imageId":"0*BLalJfMaz_JDj6fg","mediumMemberAt":0,"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":1142},"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"karol-mazurek.medium.com"}},"hasSubdomain":true,"bio":"Offensive Security Engineer","isPartnerProgramEnrolled":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:3f7ab05f0f68-viewerId:lo_9b8a45aa89d5"},"viewerIsUser":false,"postSubscribeMembershipUpsellShownAt":0,"allowNotes":true,"membership":null,"twitterScreenName":""},"Paragraph:411f1d5013f9_0":{"__typename":"Paragraph","id":"411f1d5013f9_0","name":"5b80","type":"H3","href":null,"layout":null,"metadata":null,"text":"Snake&Apple I — Mach-O","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:411f1d5013f9_1":{"__typename":"Paragraph","id":"411f1d5013f9_1","name":"520c","type":"P","href":null,"layout":null,"metadata":null,"text":"Deep dive in Mach-O files on ARM64 macOS with Python.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*HgjbPiuRBfG57HPL":{"__typename":"ImageMetadata","id":"0*HgjbPiuRBfG57HPL","originalHeight":914,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:411f1d5013f9_2":{"__typename":"Paragraph","id":"411f1d5013f9_2","name":"a1fb","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*HgjbPiuRBfG57HPL"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:411f1d5013f9_3":{"__typename":"Paragraph","id":"411f1d5013f9_3","name":"1bf2","type":"H3","href":null,"layout":null,"metadata":null,"text":"INTRO","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:411f1d5013f9_4":{"__typename":"Paragraph","id":"411f1d5013f9_4","name":"3ea1","type":"P","href":null,"layout":null,"metadata":null,"text":"Welcome to the first article in the series on macOS security internals!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:411f1d5013f9_5":{"__typename":"Paragraph","id":"411f1d5013f9_5","name":"b743","type":"P","href":null,"layout":null,"metadata":null,"text":"This article provides in-depth information about the Mach-O file format and briefly introduces its loading process to virtual memory. You will learn how to determine if a file is valid Mach-O, its endianness, various Mach-O types…","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Tag:cybersecurity":{"__typename":"Tag","id":"cybersecurity","displayTitle":"Cybersecurity","normalizedTagSlug":"cybersecurity"},"Tag:apple":{"__typename":"Tag","id":"apple","displayTitle":"Apple","normalizedTagSlug":"apple"},"Tag:programming":{"__typename":"Tag","id":"programming","displayTitle":"Programming","normalizedTagSlug":"programming"},"Tag:python":{"__typename":"Tag","id":"python","displayTitle":"Python","normalizedTagSlug":"python"},"Tag:information-technology":{"__typename":"Tag","id":"information-technology","displayTitle":"Information Technology","normalizedTagSlug":"information-technology"},"Post:a8eda4b87263":{"__typename":"Post","id":"a8eda4b87263","collection":null,"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":true,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":null,"startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:411f1d5013f9_0"},{"__ref":"Paragraph:411f1d5013f9_1"},{"__ref":"Paragraph:411f1d5013f9_2"},{"__ref":"Paragraph:411f1d5013f9_3"},{"__ref":"Paragraph:411f1d5013f9_4"},{"__ref":"Paragraph:411f1d5013f9_5"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:3f7ab05f0f68"},"inResponseToEntityType":null,"isLocked":true,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_UGC","mediumUrl":"https:\u002F\u002Fkarol-mazurek.medium.com\u002Fsnake-apple-i-mach-o-a8eda4b87263","primaryTopic":null,"topics":[],"isPublished":true,"latestPublishedVersion":"411f1d5013f9","visibility":"LOCKED","postResponses":{"__typename":"PostResponses","count":1},"createdAt":1691490122343,"firstPublishedAt":1703324035033,"latestPublishedAt":1703414674009,"clapCount":27,"allowResponses":true,"isLimitedState":false,"title":"Snake&Apple I —  Mach-O","isSeries":false,"sequence":null,"uniqueSlug":"snake-apple-i-mach-o-a8eda4b87263","socialTitle":"","socialDek":"","noIndex":null,"canonicalUrl":"","metaDescription":"","readingTime":19.99622641509434,"previewContent":{"__typename":"PreviewContent","subtitle":"Deep dive in Mach-O files on ARM64 macOS with Python."},"previewImage":{"__ref":"ImageMetadata:0*HgjbPiuRBfG57HPL"},"isShortform":false,"seoTitle":"Snake&Apple I — Mach-O files on ARM64","updatedAt":1704268930272,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"This article is a deep dive into Mach-O files on ARM-based macOS and provides low-level information about the Mach-O file format.","isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:cybersecurity"},{"__ref":"Tag:apple"},{"__ref":"Tag:programming"},{"__ref":"Tag:python"},{"__ref":"Tag:information-technology"}],"isNewsletter":false,"statusForCollection":null,"pendingCollection":null,"detectedLanguage":"en","wordCount":3603,"layerCake":0}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"MISS"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.3cc5e3b6.js"></script><script src="https://cdn-client.medium.com/lite/static/js/2640.3217006c.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.7db0aaff.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.4ddbf12e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.2021fe63.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4398.db4d4378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7883.0e445e04.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9281.e9be8bce.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7111.b294e9da.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6481.362dec70.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8695.6f58679b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8978.4b110123.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3418.eb013b5a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3894.e3d01e2c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5514.32e692f6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5203.e7f058c5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7098.93054372.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8051.0a9d3f4b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8558.abbaadfd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1711.7605eb3e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8597.762eae49.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9174.b1b0f607.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8883.2f95bbf4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/705.e5898c57.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2911.d072adec.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8580.feeb2549.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6046.f9be485b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/500.d5389c14.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9408.22b56993.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6605.84e81b15.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6637.661bd7cf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7421.3f94f5ea.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/51.d8fb2684.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2133.c8ba56b1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.81dff084.chunk.js"></script><script>window.main();</script><script defer="" src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon="{&quot;rayId&quot;:&quot;89427b152ef0b347&quot;,&quot;version&quot;:&quot;2024.4.1&quot;,&quot;token&quot;:&quot;0b5f665943484354a59c39c6833f7078&quot;}" crossorigin="anonymous"></script>
<div><div class="rn n si sj qx sk sl sm sn so sp sq sr ss st ce bm su sv sw lh sx sy"><div class="bc b ds z sz"><div class="ab cm ta tb"><div class="l" role="alert">To make Medium work, we log user data. By using Medium, you agree to our <a class="af ag ah ai aj ak al am an ao ap tc td te" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9" rel="noopener follow" target="_blank">Privacy Policy</a>, including cookie policy.</div><div class="tf tg th ti tj tk l tl iz tm"><div class="l fg n tn"><button class="af ag ah ai aj ak al am an ao ap tc td to tp ab" data-testid="close-button" aria-label="close"><svg width="19" height="19" viewBox="0 0 19 19" class="em el"><path d="M13.8 4.6L9.5 8.89 5.21 4.6l-.61.61 4.29 4.3-4.29 4.28.61.62 4.3-4.3 4.28 4.3.62-.62-4.3-4.29 4.3-4.29" fill-rule="evenodd"></path></svg></button></div></div></div></div></div></div><div><div class="grecaptcha-badge" data-style="bottomright" style="width: 256px; height: 60px; display: block; transition: right 0.3s; position: fixed; bottom: 14px; right: -186px; box-shadow: gray 0px 0px 5px; border-radius: 2px; overflow: hidden;"><div class="grecaptcha-logo"><iframe title="reCAPTCHA" width="256" height="60" role="presentation" name="a-jqnpw5kwbe15" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox allow-storage-access-by-user-activation" src="https://www.google.com/recaptcha/enterprise/anchor?ar=1&amp;k=6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp&amp;co=aHR0cHM6Ly9rYXJvbC1tYXp1cmVrLm1lZGl1bS5jb206NDQz&amp;hl=pl&amp;v=TqxSU0dsOd2Q9IbI7CpFnJLD&amp;size=invisible&amp;cb=h037rpe527d3"></iframe></div><div class="grecaptcha-error"></div><textarea id="g-recaptcha-response-100000" name="g-recaptcha-response" class="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea></div></div></body></html>