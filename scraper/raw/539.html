<html lang="en" data-rh="lang"><head><title>Why are nonces important on CTR mode ciphers | by Conviso | Code Fighters | Medium</title><meta data-rh="true" charset="utf-8"><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"><meta data-rh="true" name="theme-color" content="#000000"><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"><meta data-rh="true" property="al:ios:app_name" content="Medium"><meta data-rh="true" property="al:ios:app_store_id" content="828256236"><meta data-rh="true" property="al:android:package" content="com.medium.reader"><meta data-rh="true" property="fb:app_id" content="542599432471018"><meta data-rh="true" property="og:site_name" content="Medium"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2018-05-03T14:50:39.433Z"><meta data-rh="true" name="title" content="Why are nonces important on CTR mode ciphers | by Conviso | Code Fighters | Medium"><meta data-rh="true" property="og:title" content="Why are nonces important on CTR mode ciphers"><meta data-rh="true" property="al:android:url" content="medium://p/6aba7503bd3c"><meta data-rh="true" property="al:ios:url" content="medium://p/6aba7503bd3c"><meta data-rh="true" property="al:android:app_name" content="Medium"><meta data-rh="true" name="description" content="So I was recently testing some crypto libraries for a project I’m developing and i came across an interesting “problem”: By encrypting a message twice I actually decrypted the message. Wait, wait…"><meta data-rh="true" property="og:description" content="So I was recently testing some crypto libraries for a project I’m developing and i came across an interesting “problem”: By encrypting a…"><meta data-rh="true" property="og:url" content="https://medium.com/code-fighters/why-are-nonces-important-on-ctr-mode-ciphers-6aba7503bd3c"><meta data-rh="true" property="al:web:url" content="https://medium.com/code-fighters/why-are-nonces-important-on-ctr-mode-ciphers-6aba7503bd3c"><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:1200/1*NOvxkyohjVaVBxDm-wxCRQ.png"><meta data-rh="true" property="article:author" content="https://codefighters.medium.com"><meta data-rh="true" name="author" content="Conviso"><meta data-rh="true" name="robots" content="index,follow,max-image-preview:large"><meta data-rh="true" name="referrer" content="unsafe-url"><meta data-rh="true" property="twitter:title" content="Why are nonces important on CTR mode ciphers"><meta data-rh="true" name="twitter:site" content="@conviso"><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/6aba7503bd3c"><meta data-rh="true" property="twitter:description" content="So I was recently testing some crypto libraries for a project I’m developing and i came across an interesting “problem”: By encrypting a…"><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:1200/1*NOvxkyohjVaVBxDm-wxCRQ.png"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="twitter:label1" content="Reading time"><meta data-rh="true" name="twitter:data1" content="6 min read"><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/1*m-R_BkNf1Qjr1YbyOIJY2w.png"><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:152:152/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:120:120/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:76:76/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:60:60/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/Medium-Avatar-500x500.svg" color="#171717"><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossorigin=""><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"><link data-rh="true" rel="author" href="https://codefighters.medium.com"><link data-rh="true" rel="canonical" href="https://medium.com/code-fighters/why-are-nonces-important-on-ctr-mode-ciphers-6aba7503bd3c"><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/6aba7503bd3c"><style type="text/css" data-fela-rehydration="480" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="480" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-webkit-keyframes k1{0%{transform:translate(-50%, -100px)}100%{transform:translate(-50%, 0)}}@-moz-keyframes k1{0%{transform:translate(-50%, -100px)}100%{transform:translate(-50%, 0)}}@keyframes k1{0%{transform:translate(-50%, -100px)}100%{transform:translate(-50%, 0)}}</style><style type="text/css" data-fela-rehydration="480" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{margin-left:16px}.av{border:none}.aw{border-radius:20px}.ax{width:240px}.ay{background:#F9F9F9}.az path{fill:#6B6B6B}.bb{outline:none}.bc{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bd{font-size:14px}.be{width:100%}.bf{padding:10px 20px 10px 0}.bg{background-color:transparent}.bh{color:#242424}.bi::placeholder{color:#6B6B6B}.bj{display:inline-block}.bk{margin-left:12px}.bl{margin-right:12px}.bm{border-radius:4px}.bn{margin-left:24px}.bo{height:24px}.bu{background-color:#F9F9F9}.bv{border-radius:50%}.bw{height:32px}.bx{width:32px}.by{justify-content:center}.ce{max-width:680px}.cf{min-width:0}.cg{animation:k1 1.2s ease-in-out infinite}.ch{height:100vh}.ci{margin-bottom:16px}.cj{margin-top:48px}.ck{align-items:flex-start}.cl{flex-direction:column}.cm{justify-content:space-between}.cn{margin-bottom:24px}.ct{width:80%}.cu{background-color:#F2F2F2}.da{height:44px}.db{width:44px}.dc{margin:auto 0}.dd{margin-bottom:4px}.de{height:16px}.df{width:120px}.dg{width:80px}.dm{margin-bottom:8px}.dn{width:96%}.do{width:98%}.dp{width:81%}.dq{margin-left:8px}.dr{color:#6B6B6B}.ds{font-size:13px}.dt{height:100%}.el{color:#FFFFFF}.em{fill:#FFFFFF}.eo{background:rgba(109, 137, 163, 1)}.ep{border-color:rgba(109, 137, 163, 1)}.et:disabled{cursor:inherit !important}.eu:disabled{opacity:0.3}.ev:disabled:hover{background:rgba(109, 137, 163, 1)}.ew:disabled:hover{border-color:rgba(109, 137, 163, 1)}.ex{border-radius:99em}.ey{border-width:1px}.ez{border-style:solid}.fa{box-sizing:border-box}.fb{text-decoration:none}.fc{text-align:center}.ff{margin-right:32px}.fg{position:relative}.fh{fill:#6B6B6B}.fk{background:transparent}.fl svg{margin-left:4px}.fm svg{fill:#6B6B6B}.fo{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fp{position:absolute}.fw{margin:0 24px}.ga{background:rgba(255, 255, 255, 1)}.gb{border:1px solid #F2F2F2}.gc{box-shadow:0 1px 4px #F2F2F2}.gd{max-height:100vh}.ge{overflow-y:auto}.gf{left:0}.gg{top:calc(100vh + 100px)}.gh{bottom:calc(100vh + 100px)}.gi{width:10px}.gj{pointer-events:none}.gk{word-break:break-word}.gl{word-wrap:break-word}.gm:after{display:block}.gn:after{content:""}.go:after{clear:both}.gp{line-height:1.23}.gq{letter-spacing:0}.gr{font-style:normal}.gs{font-weight:700}.hs{@media all and (max-width: 551.98px):8px}.ht{@media all and (min-width: 552px) and (max-width: 727.98px):8px}.hu{@media all and (min-width: 728px) and (max-width: 903.98px):16px}.hv{@media all and (min-width: 904px) and (max-width: 1079.98px):16px}.hw{@media all and (min-width: 1080px):16px}.ic{align-items:baseline}.id{width:48px}.ie{height:48px}.if{border:2px solid rgba(255, 255, 255, 1)}.ig{z-index:0}.ih{box-shadow:none}.ii{border:1px solid rgba(0, 0, 0, 0.05)}.ij{margin-left:-12px}.ik{width:28px}.il{height:28px}.im{z-index:1}.in{width:24px}.io{margin-bottom:2px}.ip{flex-wrap:nowrap}.iq{font-size:16px}.ir{line-height:24px}.it{margin:0 8px}.iu{display:inline}.iv{color:rgba(109, 137, 163, 1)}.iw{fill:rgba(109, 137, 163, 1)}.iz{flex:0 0 auto}.jc{flex-wrap:wrap}.jf{white-space:pre-wrap}.jg{margin-right:4px}.jh{overflow:hidden}.ji{max-height:20px}.jj{text-overflow:ellipsis}.jk{display:-webkit-box}.jl{-webkit-line-clamp:1}.jm{-webkit-box-orient:vertical}.jn{word-break:break-all}.jp{padding-left:8px}.jq{padding-right:8px}.kr> *{flex-shrink:0}.ks{overflow-x:scroll}.kt::-webkit-scrollbar{display:none}.ku{scrollbar-width:none}.kv{-ms-overflow-style:none}.kw{width:74px}.kx{flex-direction:row}.ky{z-index:2}.lb{-webkit-user-select:none}.lc{border:0}.ld{fill:rgba(117, 117, 117, 1)}.lg{outline:0}.lh{user-select:none}.li> svg{pointer-events:none}.lr{cursor:progress}.ls{opacity:1}.lt{padding:4px 0}.lw{margin-top:0px}.lx{width:16px}.lz{display:inline-flex}.mf{max-width:100%}.mg{padding:8px 2px}.mh svg{color:#6B6B6B}.my{margin-left:auto}.mz{margin-right:auto}.na{max-width:1920px}.ng{clear:both}.ni{cursor:zoom-in}.nj{z-index:auto}.nl{height:auto}.nm{line-height:1.58}.nn{letter-spacing:-0.004em}.no{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.oj{margin-bottom:-0.46em}.ok{max-width:526px}.oq{max-width:385px}.or{text-decoration:underline}.os{max-width:601px}.ot{max-width:542px}.ou{list-style-type:disc}.ov{margin-left:30px}.ow{padding-left:0px}.pc{margin-bottom:26px}.pd{margin-top:6px}.pe{margin-top:8px}.pf{margin-right:8px}.pg{padding:8px 16px}.ph{border-radius:100px}.pi{transition:background 300ms ease}.pk{white-space:nowrap}.pl{border-top:none}.pr{height:52px}.ps{max-height:52px}.pt{box-sizing:content-box}.pu{position:static}.pw{max-width:155px}.qc{margin-right:20px}.qi{align-items:flex-end}.qj{width:76px}.qk{height:76px}.ql{border:2px solid #F9F9F9}.qm{height:72px}.qn{width:72px}.qo{margin-left:-16px}.qp{width:36px}.qq{height:36px}.qr{width:auto}.qs{stroke:#F2F2F2}.qt{color:#F2F2F2}.qu{fill:#F2F2F2}.qv{background:#F2F2F2}.qw{border-color:#F2F2F2}.rc{font-weight:500}.rd{font-size:24px}.re{line-height:30px}.rf{letter-spacing:-0.016em}.rg{margin-top:16px}.rh{height:0px}.ri{border-bottom:solid 1px #E5E5E5}.rj{margin-top:72px}.rk{padding:24px 0}.rl{margin-bottom:0px}.rm{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.eq:hover{background:rgba(95, 117, 138, 1)}.er:hover{border-color:rgba(95, 117, 138, 1)}.es:hover{cursor:pointer}.fi:hover{color:#242424}.fj:hover{fill:#242424}.fn:hover svg{fill:#242424}.fq:hover{background-color:rgba(0, 0, 0, 0.1)}.is:hover{text-decoration:underline}.ix:hover:not(:disabled){color:rgba(95, 117, 138, 1)}.iy:hover:not(:disabled){fill:rgba(95, 117, 138, 1)}.lf:hover{fill:rgba(8, 8, 8, 1)}.lu:hover{fill:#000000}.lv:hover p{color:#000000}.ly:hover{color:#000000}.mi:hover svg{color:#000000}.pj:hover{background-color:#F2F2F2}.qx:hover{background:#F2F2F2}.qy:hover{border-color:#F2F2F2}.qz:hover{cursor:wait}.ra:hover{color:#F2F2F2}.rb:hover{fill:#F2F2F2}.ba:focus-within path{fill:#242424}.le:focus{fill:rgba(8, 8, 8, 1)}.mj:focus svg{color:#000000}.nk:focus{transform:scale(1.01)}.lj:active{border-style:none}</style><style type="text/css" data-fela-rehydration="480" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bt{width:64px}.cd{margin:0 64px}.cs{height:48px}.cz{margin-bottom:52px}.dl{margin-bottom:48px}.ec{font-size:14px}.ed{line-height:20px}.ej{font-size:13px}.ek{padding:5px 12px}.fe{display:flex}.fv{margin-bottom:68px}.fz{max-width:680px}.hn{font-size:42px}.ho{margin-top:1.19em}.hp{margin-bottom:32px}.hq{line-height:52px}.hr{letter-spacing:-0.011em}.ib{align-items:center}.kd{border-top:solid 1px #F2F2F2}.ke{border-bottom:solid 1px #F2F2F2}.kf{margin:32px 0 0}.kg{padding:3px 8px}.kp> *{margin-right:24px}.kq> :last-child{margin-right:0}.lq{margin-top:0px}.me{margin:0}.nf{margin-top:40px}.of{font-size:20px}.og{margin-top:2.14em}.oh{line-height:32px}.oi{letter-spacing:-0.003em}.op{margin-top:56px}.pb{margin-top:1.14em}.pq{margin-bottom:88px}.qb{display:inline-block}.qh{padding-top:72px}</style><style type="text/css" data-fela-rehydration="480" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.lp{margin-top:0px}.qa{display:inline-block}</style><style type="text/css" data-fela-rehydration="480" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.lo{margin-top:0px}.pz{display:inline-block}</style><style type="text/css" data-fela-rehydration="480" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.lm{margin-top:0px}.ln{margin-right:0px}.py{display:inline-block}</style><style type="text/css" data-fela-rehydration="480" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bp{width:24px}.bz{margin:0 24px}.co{height:40px}.cv{margin-bottom:44px}.dh{margin-bottom:32px}.du{font-size:13px}.dv{line-height:20px}.ee{padding:0px 8px 1px}.fr{margin-bottom:4px}.gt{font-size:32px}.gu{margin-top:1.01em}.gv{margin-bottom:24px}.gw{line-height:38px}.gx{letter-spacing:-0.014em}.hx{align-items:flex-start}.ja{flex-direction:column}.jd{margin-bottom:2px}.jr{margin:24px -24px 0}.js{padding:0}.kh> *{margin-right:8px}.ki> :last-child{margin-right:24px}.kz{margin-left:0px}.lk{margin-top:0px}.ll{margin-right:0px}.ma{margin:0}.mk{border:1px solid #F2F2F2}.ml{border-radius:99em}.mm{padding:0px 16px 0px 12px}.mn{height:38px}.mo{align-items:center}.mq svg{margin-right:8px}.nb{margin-top:32px}.np{font-size:18px}.nq{margin-top:1.56em}.nr{line-height:28px}.ns{letter-spacing:-0.003em}.ol{margin-top:40px}.ox{margin-top:1.34em}.pm{margin-bottom:80px}.px{display:inline-block}.qd{padding-top:48px}.mp:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="480" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bs{width:64px}.cc{margin:0 64px}.cr{height:48px}.cy{margin-bottom:52px}.dk{margin-bottom:48px}.ea{font-size:14px}.eb{line-height:20px}.eh{font-size:13px}.ei{padding:5px 12px}.fd{display:flex}.fu{margin-bottom:68px}.fy{max-width:680px}.hi{font-size:42px}.hj{margin-top:1.19em}.hk{margin-bottom:32px}.hl{line-height:52px}.hm{letter-spacing:-0.011em}.ia{align-items:center}.jz{border-top:solid 1px #F2F2F2}.ka{border-bottom:solid 1px #F2F2F2}.kb{margin:32px 0 0}.kc{padding:3px 8px}.kn> *{margin-right:24px}.ko> :last-child{margin-right:0}.md{margin:0}.ne{margin-top:40px}.ob{font-size:20px}.oc{margin-top:2.14em}.od{line-height:32px}.oe{letter-spacing:-0.003em}.oo{margin-top:56px}.pa{margin-top:1.14em}.pp{margin-bottom:88px}.qg{padding-top:72px}</style><style type="text/css" data-fela-rehydration="480" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.br{width:64px}.cb{margin:0 48px}.cq{height:48px}.cx{margin-bottom:52px}.dj{margin-bottom:48px}.dy{font-size:13px}.dz{line-height:20px}.eg{padding:0px 8px 1px}.ft{margin-bottom:68px}.fx{max-width:680px}.hd{font-size:42px}.he{margin-top:1.19em}.hf{margin-bottom:32px}.hg{line-height:52px}.hh{letter-spacing:-0.011em}.hz{align-items:center}.jv{border-top:solid 1px #F2F2F2}.jw{border-bottom:solid 1px #F2F2F2}.jx{margin:32px 0 0}.jy{padding:3px 8px}.kl> *{margin-right:24px}.km> :last-child{margin-right:0}.mc{margin:0}.nd{margin-top:40px}.nx{font-size:20px}.ny{margin-top:2.14em}.nz{line-height:32px}.oa{letter-spacing:-0.003em}.on{margin-top:56px}.oz{margin-top:1.14em}.po{margin-bottom:88px}.qf{padding-top:72px}</style><style type="text/css" data-fela-rehydration="480" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bq{width:24px}.ca{margin:0 24px}.cp{height:40px}.cw{margin-bottom:44px}.di{margin-bottom:32px}.dw{font-size:13px}.dx{line-height:20px}.ef{padding:0px 8px 1px}.fs{margin-bottom:4px}.gy{font-size:32px}.gz{margin-top:1.01em}.ha{margin-bottom:24px}.hb{line-height:38px}.hc{letter-spacing:-0.014em}.hy{align-items:flex-start}.jb{flex-direction:column}.je{margin-bottom:2px}.jt{margin:24px 0 0}.ju{padding:0}.kj> *{margin-right:8px}.kk> :last-child{margin-right:8px}.la{margin-left:0px}.mb{margin:0}.mr{border:1px solid #F2F2F2}.ms{border-radius:99em}.mt{padding:0px 16px 0px 12px}.mu{height:38px}.mv{align-items:center}.mx svg{margin-right:8px}.nc{margin-top:32px}.nt{font-size:18px}.nu{margin-top:1.56em}.nv{line-height:28px}.nw{letter-spacing:-0.003em}.om{margin-top:40px}.oy{margin-top:1.34em}.pn{margin-bottom:80px}.qe{padding-top:48px}.mw:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="480" data-fela-type="RULE" media="print">.pv{display:none}</style><style type="text/css" data-fela-rehydration="480" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.jo{max-height:none}</style><style type="text/css" data-fela-rehydration="480" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.nh{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style><script async="" src="https://cdn.branch.io/branch-latest.min.js"></script><script type="application/ld+json" data-rh="true">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*NOvxkyohjVaVBxDm-wxCRQ.png"],"url":"https:\u002F\u002Fmedium.com\u002Fcode-fighters\u002Fwhy-are-nonces-important-on-ctr-mode-ciphers-6aba7503bd3c","dateCreated":"2018-04-27T12:44:55.786Z","datePublished":"2018-04-27T12:44:55.786Z","dateModified":"2018-05-11T13:43:39.676Z","headline":"Why are nonces important on CTR mode ciphers - Code Fighters - Medium","name":"Why are nonces important on CTR mode ciphers - Code Fighters - Medium","description":"So I was recently testing some crypto libraries for a project I’m developing and i came across an interesting “problem”: By encrypting a message twice I actually decrypted the message. Wait, wait…","identifier":"6aba7503bd3c","author":{"@type":"Person","name":"Conviso","url":"https:\u002F\u002Fcodefighters.medium.com"},"creator":["Conviso"],"publisher":{"@type":"Organization","name":"Code Fighters","url":"https:\u002F\u002Fmedium.com\u002Fcode-fighters","logo":{"@type":"ImageObject","width":500,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:625\u002F1*-vLfcunIzAJFHOa7rymAVg.png"}},"mainEntityOfPage":"https:\u002F\u002Fmedium.com\u002Fcode-fighters\u002Fwhy-are-nonces-important-on-ctr-mode-ciphers-6aba7503bd3c"}</script><style id="googleidentityservice_button_styles">.qJTHM{-moz-user-select:none;color:#202124;direction:ltr;font-family:"Roboto-Regular",arial,sans-serif;font-weight:400;margin:0;overflow:hidden}.ynRLnc{left:-9999px;position:absolute;top:-9999px}.L6cTce{display:none}.bltWBb{word-break:break-all}.hSRGPd{color:#1a73e8;cursor:pointer;font-weight:500;text-decoration:none}.Bz112c-W3lGp{height:16px;width:16px}.Bz112c-E3DyYd{height:20px;width:20px}.Bz112c-r9oPif{height:24px;width:24px}.Bz112c-uaxL4e{-moz-border-radius:10px;border-radius:10px}.LgbsSe-Bz112c{display:block}.S9gUrf-YoZ4jf,.S9gUrf-YoZ4jf *{border:none;margin:0;padding:0}.fFW7wc-ibnC6b>.aZ2wEe>div{border-color:#4285f4}.P1ekSe-ZMv3u>div:nth-child(1){background-color:#1a73e8!important}.P1ekSe-ZMv3u>div:nth-child(2),.P1ekSe-ZMv3u>div:nth-child(3){background-image:linear-gradient(to right,rgba(255,255,255,.7),rgba(255,255,255,.7)),linear-gradient(to right,#1a73e8,#1a73e8)!important}.haAclf{display:inline-block}.nsm7Bb-HzV7m-LgbsSe{border-radius:4px;box-sizing:border-box;transition:background-color .218s,border-color .218s;-moz-user-select:none;background-color:#fff;background-image:none;border:1px solid #dadce0;color:#3c4043;cursor:pointer;font-family:"Google Sans",arial,sans-serif;font-size:14px;height:40px;letter-spacing:0.25px;outline:none;overflow:hidden;padding:0 12px;position:relative;text-align:center;vertical-align:middle;white-space:nowrap;width:auto}@media screen and (-ms-high-contrast:active){.nsm7Bb-HzV7m-LgbsSe{border:2px solid windowText;color:windowText}}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe{font-size:14px;height:32px;letter-spacing:0.25px;padding:0 10px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe{font-size:11px;height:20px;letter-spacing:0.3px;padding:0 8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe{padding:0;width:40px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe{width:32px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe{width:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK{border-radius:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.pSzOP-SxQuSe{border-radius:16px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.purZT-SxQuSe{border-radius:10px}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc{border:none;color:#fff}.nsm7Bb-HzV7m-LgbsSe.MFS4be-v3pZbf-Ia7Qfc{background-color:#1a73e8}.nsm7Bb-HzV7m-LgbsSe.MFS4be-JaPV2b-Ia7Qfc{background-color:#202124;color:#e8eaed}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:18px;margin-right:8px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:14px;min-width:14px;width:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:10px;min-width:10px;width:10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin-left:8px;margin-right:-4px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:10px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:4px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-top-left-radius:3px;border-bottom-left-radius:3px;display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;justify-content:center;align-items:center;background-color:#fff;height:36px;margin-left:-10px;margin-right:12px;min-width:36px;width:36px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c,.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:28px;margin-left:-8px;margin-right:10px;min-width:28px;width:28px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:16px;margin-left:-6px;margin-right:8px;min-width:16px;width:16px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:3px;margin-left:2px;margin-right:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:8px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-bN97Pc-sM5MNb{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;align-items:center;flex-direction:row;justify-content:space-between;flex-wrap:nowrap;height:100%;position:relative;width:100%}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX{justify-content:center}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{flex-grow:1;font-family:"Google Sans",arial,sans-serif;font-weight:500;overflow:hidden;text-overflow:ellipsis;vertical-align:top}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-weight:300}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX .nsm7Bb-HzV7m-LgbsSe-BPrWId{flex-grow:0}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-MJoBVe{transition:background-color .218s;bottom:0;left:0;position:absolute;right:0;top:0}.nsm7Bb-HzV7m-LgbsSe:hover,.nsm7Bb-HzV7m-LgbsSe:focus{box-shadow:none;border-color:#d2e3fc;outline:none}.nsm7Bb-HzV7m-LgbsSe:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.04)}.nsm7Bb-HzV7m-LgbsSe:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.1)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.24)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.32)}.nsm7Bb-HzV7m-LgbsSe .n1UuX-DkfjY{border-radius:50%;display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;height:20px;margin-left:-4px;margin-right:8px;min-width:20px;width:20px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-family:"Roboto";font-size:12px;text-align:left}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .ssJRIf,.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .fmcmS{overflow:hidden;text-overflow:ellipsis}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;align-items:center;color:#5f6368;fill:#5f6368;font-size:11px;font-weight:400}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.MFS4be-Ia7Qfc .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{color:#e8eaed;fill:#e8eaed}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .Bz112c{height:18px;margin:-3px -3px -3px 2px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-top-left-radius:0;border-bottom-left-radius:0;border-top-right-radius:3px;border-bottom-right-radius:3px;margin-left:12px;margin-right:-10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:18px}.L5Fo6c-sM5MNb{border:0;display:block;left:0;position:relative;top:0}.L5Fo6c-bF1uUb{-moz-border-radius:4px;border-radius:4px;bottom:0;cursor:pointer;left:0;position:absolute;right:0;top:0}.L5Fo6c-bF1uUb:focus{border:none;outline:none}sentinel{}</style><script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-7JY7T788PK" data-rh="true"></script><script data-rh="true">window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'G-7JY7T788PK');</script><script type="text/javascript" data-rh="true">(function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src="https://cdn.branch.io/branch-latest.min.js";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,"script","branch",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},"addListener applyCode autoAppIndex banner closeBanner closeJourney creditHistory credits data deepview deepviewCta first getCode init link logout redeem referrals removeListener sendSMS setBranchViewData setIdentity track validateCode trackCommerceEvent logEvent".split(" "), 0);
branch.init('key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm', {metadata: {}, 'no_journeys': true, 'disable_exit_animation': true, 'disable_entry_animation': true, 'tracking_disabled': null}, function(err, data) {});</script><script src="https://www.google.com/recaptcha/enterprise.js?render=6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp" data-rh="true"></script></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div><script>if (window.self !== window.top) window.location = "about:blank"</script></div><div class="l c"><div class="l m n o c" style="transform: translateY(0px);"><div class="p q r s t u v w x i d y z"><a class="dr ag ds bc ak b am an ao ap aq ar as at s u w i d q dt z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6aba7503bd3c&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderCollection&amp;source=---two_column_layout_nav----------------------------------" rel="noopener follow">Open in app<svg width="10" height="10" viewBox="0 0 10 10" fill="none" class="dq"><path d="M.98 8.48a.37.37 0 1 0 .54.54l-.54-.54zm7.77-7.23h.38c0-.2-.17-.38-.38-.38v.38zM8.37 6.5a.37.37 0 1 0 .76 0h-.76zM3.5.87a.37.37 0 1 0 0 .76V.88zM1.52 9.03l7.5-7.5-.54-.54-7.5 7.5.54.54zm6.86-7.77V6.5h.74V1.25h-.74zm-4.88.38h5.25V.88H3.5v.74z" fill="currentColor"></path></svg></a><div class="ab q"><p class="bc b du dv dw dx dy dz ea eb ec ed dr"><span><button class="bc b du dv ee dw dx ef dy dz eg eh eb ei ej ed ek el em eo ep eq er es et eu ev ew ex ey ez fa bj fb fc" data-testid="headerSignUpButton">Sign up</button></span></p><div class="au l"><p class="bc b du dv dw dx dy dz ea eb ec ed dr"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2Fcode-fighters%2Fwhy-are-nonces-important-on-ctr-mode-ciphers-6aba7503bd3c&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" rel="noopener follow" href="/?source=---two_column_layout_nav----------------------------------"><svg width="120" height="27" viewBox="0 0 120 27" fill="none"><mask id="logo-wordmark-pride_svg__a" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="1" y="0" width="119" height="27"><path d="M29.69 2.36h.03v-.29h-7.26L15.7 18.05 8.96 2.07H1.12v.28l.04.01c1.32.3 2 .75 2 2.37v19c0 1.62-.68 2.07-2 2.37h-.04v.29h5.31v-.28H6.4c-1.33-.3-2-.76-2-2.38V5.83l8.67 20.56h.5l8.91-21.13V24.2c-.1 1.28-.78 1.67-1.98 1.95h-.03v.28h9.25v-.27l-.03-.01c-1.2-.28-1.89-.67-2-1.95V4.73c0-1.62.67-2.07 2-2.37zm4.23 12.58c.15-3.41 1.37-5.87 3.4-5.92.64.01 1.17.22 1.58.62.87.86 1.28 2.64 1.22 5.3h-6.2zm-.1.96h10.86v-.04c-.03-2.61-.78-4.64-2.23-6.03a7.3 7.3 0 0 0-5.05-1.87h-.04a7.31 7.31 0 0 0-5.75 2.78 10.4 10.4 0 0 0-2.08 5.72l-.02.2a7.61 7.61 0 0 0-.02.56v.58c.11 5.09 2.84 9.16 7.69 9.16 4.25 0 6.73-3.14 7.35-7.34l-.32-.11c-1.08 2.26-3.03 3.63-5.25 3.46-3.03-.23-5.35-3.32-5.13-7.06m23.12 6.89c-.36.85-1.1 1.32-2.1 1.32s-1.9-.7-2.55-1.94a12.23 12.23 0 0 1-1.06-5.49c0-4.68 1.45-7.7 3.68-7.7.94 0 1.68.47 2.03 1.28V22.8zm7.2 3.33c-1.33-.31-2-.78-2-2.49V.96l-8.07 2.39v.3l.05-.01c1.11-.1 1.87.06 2.3.47.35.32.52.8.52 1.5v3.1a5.18 5.18 0 0 0-2.89-.75c-2.33 0-4.45.98-5.99 2.78-1.6 1.86-2.44 4.42-2.44 7.38 0 5.28 2.58 8.84 6.43 8.84a5.09 5.09 0 0 0 4.89-3.34v2.81h7.23v-.29h-.03zm6.9-22.09c0-1.65-1.23-2.9-2.87-2.9a2.87 2.87 0 0 0-2.9 2.9c0 1.63 1.27 2.9 2.9 2.9a2.82 2.82 0 0 0 2.88-2.9zm1.91 22.1c-1.32-.32-2-.8-2-2.5V8.01l-7.24 2.1v.28h.05c1.56.14 1.99.68 1.99 2.53v13.51H73v-.29h-.04zm18.54 0c-1.33-.32-2-.8-2-2.5V8.01l-6.89 2.02v.29h.04c1.28.14 1.65.71 1.65 2.56v9.88a2.48 2.48 0 0 1-2.2 1.4c-1.57 0-2.43-1.08-2.43-3.02V8.01l-7.24 2.1v.28h.04c1.57.14 2 .68 2 2.53v8.36c0 .58.05 1.16.15 1.74l.13.57c.61 2.21 2.22 3.37 4.73 3.37 2.13 0 4-1.33 4.82-3.4v2.88h7.23v-.3h-.03zm28.1.3v-.3h-.03c-1.44-.34-2-.97-2-2.26V13.25c0-3.31-1.85-5.3-4.95-5.3a5.08 5.08 0 0 0-4.9 3.37c-.58-2.17-2.25-3.36-4.73-3.36a4.7 4.7 0 0 0-4.61 3.1V8.02l-7.23 2v.3h.04c1.55.14 2 .7 2 2.49v13.63h6.74v-.29h-.03c-1.15-.28-1.52-.78-1.52-2.05V11.9c.3-.71.91-1.56 2.13-1.56 1.5 0 2.26 1.05 2.26 3.12v12.97h6.75v-.29h-.03c-1.15-.28-1.52-.78-1.52-2.05V13.25a7 7 0 0 0-.1-1.21c.32-.78.97-1.7 2.23-1.7 1.53 0 2.27 1.02 2.27 3.12v12.97h7.23z" fill="#242424"></path></mask><g filter="url(#logo-wordmark-pride_svg__filter0_f_238_6555)" mask="url(#logo-wordmark-pride_svg__a)"><path d="M42.3-64.7l-15.52-6.74L-24.62 47l15.53 6.74L42.3-64.7z" fill="#000"></path><path d="M53.18-59.98L42.3-64.7-9.1 53.74l10.88 4.72 51.4-118.44z" fill="#603917"></path><path d="M64.96-54.87l-11.78-5.11L1.78 58.46l11.79 5.11 51.4-118.44z" fill="#71E2FD"></path><path d="M75.84-50.15l-10.88-4.72-51.4 118.44 10.89 4.72L75.84-50.15z" fill="#FF9BC9"></path><path d="M86.71-45.43l-10.87-4.72L24.44 68.3l10.88 4.72 51.4-118.44z" fill="#FF472F"></path><path d="M97.6-40.7L86.7-45.44 35.32 73.01l10.88 4.72L97.6-40.7z" fill="#FF8312"></path><path d="M108.47-35.99L97.6-40.7 46.2 77.73l10.88 4.72 51.4-118.44z" fill="#FFCE00"></path><path d="M120.25-30.88l-11.78-5.1-51.4 118.43 11.79 5.11 51.4-118.44z" fill="#48E348"></path><path d="M131.13-26.16l-10.88-4.72L68.86 87.56l10.88 4.72 51.4-118.44z" fill="#008EF0"></path><path d="M148.48-18.63l-17.35-7.53-51.4 118.44 17.35 7.53 51.4-118.44z" fill="#9A50FC"></path></g><defs><filter id="logo-wordmark-pride_svg__filter0_f_238_6555" x="-29.5" y="-76.33" width="182.87" height="181.03" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood><feBlend in="SourceGraphic" in2="BackgroundImageFix" result="shape"></feBlend><feGaussianBlur stdDeviation="2.45" result="effect1_foregroundBlur_238_6555"></feGaussianBlur></filter></defs></svg></a><div class="au h"><div class="ab av aw ax ay q az ba"><div class="bj" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bk bl ab"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.1 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0zm6.94-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .8-.79l-3.74-3.73A8.05 8.05 0 0 0 11.04 3v.01z" fill="currentColor"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="av bb bc bd z be bf bg bh bi" placeholder="Search" value=""></div></div></div><div class="h k w fd fe"><div class="ff ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" rel="noopener follow" href="/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---two_column_layout_nav-----------------------new_post_topnav-----------"><div class="bc b bd z dr fg fh ab q fi fj"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-label="Write"><path d="M14 4a.5.5 0 0 0 0-1v1zm7 6a.5.5 0 0 0-1 0h1zm-7-7H4v1h10V3zM3 4v16h1V4H3zm1 17h16v-1H4v1zm17-1V10h-1v10h1zm-1 1a1 1 0 0 0 1-1h-1v1zM3 20a1 1 0 0 0 1 1v-1H3zM4 3a1 1 0 0 0-1 1h1V3z" fill="currentColor"></path><path d="M17.5 4.5l-8.46 8.46a.25.25 0 0 0-.06.1l-.82 2.47c-.07.2.12.38.31.31l2.47-.82a.25.25 0 0 0 .1-.06L19.5 6.5m-2-2l2.32-2.32c.1-.1.26-.1.36 0l1.64 1.64c.1.1.1.26 0 .36L19.5 6.5m-2-2l2 2" stroke="currentColor"></path></svg><div class="dq l">Write</div></div></a></span></div></div><div class="k j i d"><div class="ff ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" rel="noopener follow" href="/search?source=---two_column_layout_nav----------------------------------"><div class="bc b bd z dr fg fh ab q fi fj"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-label="Search"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.1 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0zm6.94-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .8-.79l-3.74-3.73A8.05 8.05 0 0 0 11.04 3v.01z" fill="currentColor"></path></svg></div></a></div></div><div class="ff h k j"><div class="ab q"><p class="bc b du dv dw dx dy dz ea eb ec ed dr"><span><button class="bc b du dv ee dw dx ef dy dz eg eh eb ei ej ed ek el em eo ep eq er es et eu ev ew ex ey ez fa bj fb fc" data-testid="headerSignUpButton">Sign up</button></span></p><div class="au l"><p class="bc b du dv dw dx dy dz ea eb ec ed dr"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2Fcode-fighters%2Fwhy-are-nonces-important-on-ctr-mode-ciphers-6aba7503bd3c&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="av fk am ab q ao fl fm fn" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fg"><img alt="" class="l fa bv bw bx cu" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"><div class="fo bv l bw bx fp n av fq"></div></div></button></div></div></div><div class="l"><div class="pv" role="dialog" aria-modal="true" tabindex="-1"><div class="uv uw be dt ry ux ru ao uy gj uz" aria-hidden="true" role="presentation"></div><div class="va ry vb vc vd uv dt fa ve vf vg ls vh vi rz vj vk vl vm vn vo" aria-hidden="true"></div></div><div class="fr fs ft fu fv l"><div class="ab by"><div class="cf be fw fx fy fz"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fp gf gg gh gi gj"></div><div class="gk gl gm gn go"><div class="ab by"><div class="cf be fw fx fy fz"><div><h1 id="cd72" class="pw-post-title gp gq gr bc gs gt gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr bh" data-testid="storyTitle" data-selectable-paragraph="">Why are nonces important on CTR mode ciphers</h1><div class="hs ht hu hv hw"><div class="speechify-ignore ab cm"><div class="speechify-ignore be l"><div class="hx hy hz ia ib ab"><div><div class="ab ic"><a rel="noopener follow" href="/@codefighters?source=post_page-----6aba7503bd3c--------------------------------"><div><div class="bj" aria-hidden="false" aria-describedby="1" aria-labelledby="1"><div class="l id ie bv if ig"><div class="l fg"><img alt="Conviso" class="l fa bv da db cu" src="https://miro.medium.com/v2/resize:fill:88:88/1*1bw5RDL9UPM-mYZJBuED-A.png" width="44" height="44" loading="lazy" data-testid="authorPhoto"><div class="ih bv l da db fp n ii fq"></div></div></div></div></div></a><a href="https://medium.com/code-fighters?source=post_page-----6aba7503bd3c--------------------------------" rel="noopener follow"><div class="ij ab fg"><div><div class="bj" aria-hidden="false" aria-describedby="2" aria-labelledby="2"><div class="l ik il bv if im"><div class="l fg"><img alt="Code Fighters" class="l fa bv bo in cu" src="https://miro.medium.com/v2/resize:fill:48:48/1*_QBbFRIssyArHSfwVWAonA.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto"><div class="ih bv l bo in fp n ii fq"></div></div></div></div></div></div></a></div></div><div class="bk be l"><div class="ab"><div style="flex:1"><span class="bc b bd z bh"><div class="io ab q"><div class="ab q ip"><div class="ab q"><div><div class="bj" aria-hidden="false" aria-describedby="3" aria-labelledby="3"><p class="bc b iq ir bh"><a class="af ag ah ai aj ak al am an ao ap aq ar is" data-testid="authorName" rel="noopener follow" href="/@codefighters?source=post_page-----6aba7503bd3c--------------------------------">Conviso</a></p></div></div></div><span class="it iu" aria-hidden="true"><span class="bc b bd z dr">·</span></span><p class="bc b iq ir dr"><span><a class="iv iw ah ai aj ak al am an ao ap aq ar eu ix iy" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F5da1791c5ec3&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fcode-fighters%2Fwhy-are-nonces-important-on-ctr-mode-ciphers-6aba7503bd3c&amp;user=Conviso&amp;userId=5da1791c5ec3&amp;source=post_page-5da1791c5ec3----6aba7503bd3c---------------------post_header-----------">Follow</a></span></p></div></div></span></div></div><div class="l iz"><span class="bc b bd z dr"><div class="ab ck ja jb jc"><div class="jd je ab"><div class="bc b bd z dr ab jf"><span class="jg l iz">Published in</span><div><div class="l" aria-hidden="false" aria-describedby="4" aria-labelledby="4"><a class="af ag ah ai aj ak al am an ao ap aq ar is ab q" data-testid="publicationName" href="https://medium.com/code-fighters?source=post_page-----6aba7503bd3c--------------------------------" rel="noopener follow"><p class="bc b bd z jh ji jj jk jl jm jn jo bh">Code Fighters</p></a></div></div></div><div class="h k"><span class="it iu" aria-hidden="true"><span class="bc b bd z dr">·</span></span></div></div><span class="bc b bd z dr"><div class="ab ae"><span data-testid="storyReadTime">6 min read</span><div class="jp jq l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bc b bd z dr">·</span></span></div><span data-testid="storyPublishDate">Apr 27, 2018</span></div></span></div></span></div></div></div><div class="ab cm jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg"><div class="h k w fd fe q"><div class="kw l"><div class="ab q kx ky"><div class="pw-multi-vote-icon fg jg kz la lb"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fcode-fighters%2F6aba7503bd3c&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fcode-fighters%2Fwhy-are-nonces-important-on-ctr-mode-ciphers-6aba7503bd3c&amp;user=Conviso&amp;userId=5da1791c5ec3&amp;source=-----6aba7503bd3c---------------------clap_footer-----------"><div><div class="bj" aria-hidden="false" aria-describedby="5" aria-labelledby="5"><div class="lc ao ld le lf lg am lh li lj lb"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lk ll lm ln lo lp lq"><div><div class="bj" aria-hidden="false" aria-describedby="96" aria-labelledby="96"><p class="bc b ds z dr"><button class="af ag ah ai aj ak al am an ao ap aq ar as at wx ly">62<span class="l h g f qa qb"></span></button></p></div></div></div></div></div><div><div class="bj" aria-hidden="false" aria-describedby="6" aria-labelledby="6"><button class="ao lc ls lt ab q fh lu lv" aria-label="responses"><svg width="24" height="24" viewBox="0 0 24 24" class="lw"><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></button></div></div></div><div class="ab q kh ki kj kk kl km kn ko kp kq kr ks kt ku kv"><div class="lx k j i d"></div><div class="h k"><div><div class="bj" aria-hidden="false" aria-describedby="7" aria-labelledby="7"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6aba7503bd3c&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fcode-fighters%2Fwhy-are-nonces-important-on-ctr-mode-ciphers-6aba7503bd3c&amp;source=-----6aba7503bd3c---------------------bookmark_footer-----------"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dr ly" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div><div class="fa lz ck"><div class="l ae"><div class="ab by"><div class="ma mb mc md me mf cf be"><div class="ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2Fplans%3Fdimension%3Dpost_audio_button%26postId%3D6aba7503bd3c&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fcode-fighters%2Fwhy-are-nonces-important-on-ctr-mode-ciphers-6aba7503bd3c&amp;source=-----6aba7503bd3c---------------------post_audio_button-----------"><div><div class="bj" aria-hidden="false" aria-describedby="80" aria-labelledby="80"><button aria-label="Listen" data-testid="audioPlayButton" class="af fh ah ai aj ak al mg an ao ap eu mh mi lv mj mk ml mm mn s mo mp mq mr ms mt mu u mv mw mx"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0zm9-10a10 10 0 1 0 0 20 10 10 0 0 0 0-20zm3.38 10.42l-4.6 3.06a.5.5 0 0 1-.78-.41V8.93c0-.4.45-.63.78-.41l4.6 3.06c.3.2.3.64 0 .84z" fill="currentColor"></path></svg><div class="j i d"><p class="bc b bd z dr">Listen</p></div></button></div></div></a></span></div></div></div></div></div><div class="bj" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bj" aria-hidden="false" aria-describedby="9" aria-labelledby="9"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fh ah ai aj ak al mg an ao ap eu mh mi lv mj mk ml mm mn s mo mp mq mr ms mt mu u mv mw mx"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.22 4.93a.42.42 0 0 1-.12.13h.01a.45.45 0 0 1-.29.08.52.52 0 0 1-.3-.13L12.5 3v7.07a.5.5 0 0 1-.5.5.5.5 0 0 1-.5-.5V3.02l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.8a.42.42 0 0 1 .07.5zm-.1.14zm.88 2h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11a2 2 0 0 1-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.14c.1.1.15.22.15.35a.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9V8.96c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1z" fill="currentColor"></path></svg><div class="j i d"><p class="bc b bd z dr">Share</p></div></button></div></div></div></div></div></div></div></div></div><figure class="nb nc nd ne nf ng my mz paragraph-image"><div role="button" tabindex="0" class="nh ni fg nj be nk"><div class="my mz na"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*NOvxkyohjVaVBxDm-wxCRQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*NOvxkyohjVaVBxDm-wxCRQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*NOvxkyohjVaVBxDm-wxCRQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*NOvxkyohjVaVBxDm-wxCRQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*NOvxkyohjVaVBxDm-wxCRQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*NOvxkyohjVaVBxDm-wxCRQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NOvxkyohjVaVBxDm-wxCRQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*NOvxkyohjVaVBxDm-wxCRQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*NOvxkyohjVaVBxDm-wxCRQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*NOvxkyohjVaVBxDm-wxCRQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*NOvxkyohjVaVBxDm-wxCRQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*NOvxkyohjVaVBxDm-wxCRQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*NOvxkyohjVaVBxDm-wxCRQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*NOvxkyohjVaVBxDm-wxCRQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be mf nl c" width="700" height="394" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*NOvxkyohjVaVBxDm-wxCRQ.png"></picture></div></div></figure><p id="ae14" class="pw-post-body-paragraph nm nn gr no b np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj gk bh" data-selectable-paragraph="">So I was recently testing some crypto libraries for a project I’m developing and i came across an interesting “problem”: By encrypting a message twice I actually decrypted the message. Wait, wait, i’ll explain and show you that the problem was how i was using the cipher rather than the cipher itself!</p><p id="eaa9" class="pw-post-body-paragraph nm nn gr no b np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj gk bh" data-selectable-paragraph="">So, the code i ran is something like this:</p><figure class="ol om on oo op ng my mz paragraph-image"><div class="my mz ok"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*gfs9E65jUYJ6RktvWsKgJw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*gfs9E65jUYJ6RktvWsKgJw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*gfs9E65jUYJ6RktvWsKgJw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*gfs9E65jUYJ6RktvWsKgJw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*gfs9E65jUYJ6RktvWsKgJw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*gfs9E65jUYJ6RktvWsKgJw.png 1100w, https://miro.medium.com/v2/resize:fit:1052/format:webp/1*gfs9E65jUYJ6RktvWsKgJw.png 1052w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 526px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*gfs9E65jUYJ6RktvWsKgJw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*gfs9E65jUYJ6RktvWsKgJw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*gfs9E65jUYJ6RktvWsKgJw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*gfs9E65jUYJ6RktvWsKgJw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*gfs9E65jUYJ6RktvWsKgJw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*gfs9E65jUYJ6RktvWsKgJw.png 1100w, https://miro.medium.com/v2/resize:fit:1052/1*gfs9E65jUYJ6RktvWsKgJw.png 1052w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 526px"><img alt="" class="be mf nl c" width="526" height="472" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:658/1*gfs9E65jUYJ6RktvWsKgJw.png"></picture></div></figure><p id="bf6b" class="pw-post-body-paragraph nm nn gr no b np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj gk bh" data-selectable-paragraph="">And got this output:</p><figure class="ol om on oo op ng my mz paragraph-image"><div class="my mz oq"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*uJ6rpsCDpNJHZTcScmh1AA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*uJ6rpsCDpNJHZTcScmh1AA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*uJ6rpsCDpNJHZTcScmh1AA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*uJ6rpsCDpNJHZTcScmh1AA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*uJ6rpsCDpNJHZTcScmh1AA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*uJ6rpsCDpNJHZTcScmh1AA.png 1100w, https://miro.medium.com/v2/resize:fit:770/format:webp/1*uJ6rpsCDpNJHZTcScmh1AA.png 770w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 385px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*uJ6rpsCDpNJHZTcScmh1AA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*uJ6rpsCDpNJHZTcScmh1AA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*uJ6rpsCDpNJHZTcScmh1AA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*uJ6rpsCDpNJHZTcScmh1AA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*uJ6rpsCDpNJHZTcScmh1AA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*uJ6rpsCDpNJHZTcScmh1AA.png 1100w, https://miro.medium.com/v2/resize:fit:770/1*uJ6rpsCDpNJHZTcScmh1AA.png 770w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 385px"><img alt="" class="be mf nl c" width="385" height="251" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:481/1*uJ6rpsCDpNJHZTcScmh1AA.png"></picture></div></figure><p id="a351" class="pw-post-body-paragraph nm nn gr no b np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj gk bh" data-selectable-paragraph="">Weird right? If you like me, didn’t knew what i will be explaining shortly, you are probably thinking something like: “Wait what? That’s not right! That cannot be secure!” And well, in a sense you are right, but as I said the problem is HOW i used the cipher, not the cipher itself.</p><p id="e573" class="pw-post-body-paragraph nm nn gr no b np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj gk bh" data-selectable-paragraph="">Let me explain: There exists a type of cipher known as Stream ciphers. Basically, in an grossly simplified way, Stream Ciphers are clever and fancy ways of using bitwise XOR operations to create a safe cipher. Stream ciphers in practice are somewhat controversial because there are some famous ones with pretty huge attacks (<a class="af or" href="http://www.dummies.com/programming/networking/understanding-wep-weaknesses/" rel="noopener ugc nofollow" target="_blank">See RC4 WEP weakness</a>), but they can be implemented safely in many ways, and one way is using a block cipher in counter mode. Now, Block Ciphers are deterministic functions that operate in a block of plaintext using a symmetric key, they are alone not particularly useful but that’s when the modes of operations come in, they are algorithms that use those block ciphers to create stronger, safer ciphers!</p><p id="29ab" class="pw-post-body-paragraph nm nn gr no b np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj gk bh" data-selectable-paragraph="">To understand what happened we must now speak of a particular mode of operation, the Counter mode. The main problem with a block cipher is that by definition they work on a block, a finite amount of data and unless you are coding for twitter, you don’t want a small amount of space for your messages. That’s where the modes of operation, like counter mode, come in. Counter mode ciphers take a block cipher and use it to generate the string that is going to be XORed with the message you want to cipher and doing so for every block of your message it can cipher many many blocks! It works like this:</p><figure class="ol om on oo op ng my mz paragraph-image"><div class="my mz os"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*a5xulHZkfJlkItZ6FVV7zg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*a5xulHZkfJlkItZ6FVV7zg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*a5xulHZkfJlkItZ6FVV7zg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*a5xulHZkfJlkItZ6FVV7zg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*a5xulHZkfJlkItZ6FVV7zg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*a5xulHZkfJlkItZ6FVV7zg.png 1100w, https://miro.medium.com/v2/resize:fit:1202/format:webp/1*a5xulHZkfJlkItZ6FVV7zg.png 1202w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 601px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*a5xulHZkfJlkItZ6FVV7zg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*a5xulHZkfJlkItZ6FVV7zg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*a5xulHZkfJlkItZ6FVV7zg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*a5xulHZkfJlkItZ6FVV7zg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*a5xulHZkfJlkItZ6FVV7zg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*a5xulHZkfJlkItZ6FVV7zg.png 1100w, https://miro.medium.com/v2/resize:fit:1202/1*a5xulHZkfJlkItZ6FVV7zg.png 1202w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 601px"><img alt="" class="be mf nl c" width="601" height="242" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:751/1*a5xulHZkfJlkItZ6FVV7zg.png"></picture></div></figure><p id="53ae" class="pw-post-body-paragraph nm nn gr no b np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj gk bh" data-selectable-paragraph="">Cool right! What a smart way to use block ciphers to cipher an arbitrary length string! The “problem” comes in now, since this is the decryption function:</p><figure class="ol om on oo op ng my mz paragraph-image"><div class="my mz os"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*v8pXy1na6ULhv2srjV1XQw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*v8pXy1na6ULhv2srjV1XQw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*v8pXy1na6ULhv2srjV1XQw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*v8pXy1na6ULhv2srjV1XQw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*v8pXy1na6ULhv2srjV1XQw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*v8pXy1na6ULhv2srjV1XQw.png 1100w, https://miro.medium.com/v2/resize:fit:1202/format:webp/1*v8pXy1na6ULhv2srjV1XQw.png 1202w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 601px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*v8pXy1na6ULhv2srjV1XQw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*v8pXy1na6ULhv2srjV1XQw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*v8pXy1na6ULhv2srjV1XQw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*v8pXy1na6ULhv2srjV1XQw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*v8pXy1na6ULhv2srjV1XQw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*v8pXy1na6ULhv2srjV1XQw.png 1100w, https://miro.medium.com/v2/resize:fit:1202/1*v8pXy1na6ULhv2srjV1XQw.png 1202w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 601px"><img alt="" class="be mf nl c" width="601" height="242" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:751/1*v8pXy1na6ULhv2srjV1XQw.png"></picture></div></figure><p id="cc83" class="pw-post-body-paragraph nm nn gr no b np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj gk bh" data-selectable-paragraph="">Now, do you see something similar between those two?</p><p id="2201" class="pw-post-body-paragraph nm nn gr no b np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj gk bh" data-selectable-paragraph="">Well, if you see congratulations because they are exactly the same operation!</p><p id="f5a4" class="pw-post-body-paragraph nm nn gr no b np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj gk bh" data-selectable-paragraph="">Interesting right? Now you might ask: “Hmm this looks rather unsafe, how can it be IND-CPA secure if the encryption operation is the same as the decryption?” and well, the answer is on the nonce and counter! Basically, if you don’t reuse nonce and counter values you should be fine! A formal proof can be seen <a class="af or" href="https://www.cs.umd.edu/~jkatz/imc.html" rel="noopener ugc nofollow" target="_blank">here</a> and <a class="af or" href="http://drona.csa.iisc.ernet.in/~arpita/Cryptography15/CT2.pdf" rel="noopener ugc nofollow" target="_blank">here</a>, look into these if you really want to understand the maths.</p><p id="e20d" class="pw-post-body-paragraph nm nn gr no b np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj gk bh" data-selectable-paragraph="">Now that we know all this, we can find out what i did wrong! If you check my code snippet, you will see that i encrypted it twice using the same Nonce! Since the encryption and decryption schemes are exactly the same, i essentially attacked my own message! Cool right?</p><p id="7de5" class="pw-post-body-paragraph nm nn gr no b np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj gk bh" data-selectable-paragraph="">The correct thing to do would be something like this:</p><figure class="ol om on oo op ng my mz paragraph-image"><div class="my mz ot"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*EiCi8HOFkW4JmWjJ3Yu7jQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*EiCi8HOFkW4JmWjJ3Yu7jQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*EiCi8HOFkW4JmWjJ3Yu7jQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*EiCi8HOFkW4JmWjJ3Yu7jQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*EiCi8HOFkW4JmWjJ3Yu7jQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*EiCi8HOFkW4JmWjJ3Yu7jQ.png 1100w, https://miro.medium.com/v2/resize:fit:1084/format:webp/1*EiCi8HOFkW4JmWjJ3Yu7jQ.png 1084w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 542px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*EiCi8HOFkW4JmWjJ3Yu7jQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*EiCi8HOFkW4JmWjJ3Yu7jQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*EiCi8HOFkW4JmWjJ3Yu7jQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*EiCi8HOFkW4JmWjJ3Yu7jQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*EiCi8HOFkW4JmWjJ3Yu7jQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*EiCi8HOFkW4JmWjJ3Yu7jQ.png 1100w, https://miro.medium.com/v2/resize:fit:1084/1*EiCi8HOFkW4JmWjJ3Yu7jQ.png 1084w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 542px"><img alt="" class="be mf nl c" width="542" height="236" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:678/1*EiCi8HOFkW4JmWjJ3Yu7jQ.png"></picture></div></figure><p id="64f7" class="pw-post-body-paragraph nm nn gr no b np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj gk bh" data-selectable-paragraph="">This way you will generate new nonces every iteration! Now even if you do this, you might actually be still vulnerable if you do something like I describe later!</p><p id="5bf1" class="pw-post-body-paragraph nm nn gr no b np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj gk bh" data-selectable-paragraph="">The problem with this is that what i wrote here is not very common knowledge! I mean i’ve been studying crypto for a while now and it took me a couple of searches and asking my professors to figure it out. And that can be dangerous, let me show you how:</p><ul class=""><li id="3c5d" class="nm nn gr no b np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ou ov ow bh" data-selectable-paragraph="">Suppose im a layman in crypto and i want to create a site that does an encrypted message exchange.</li><li id="a876" class="nm nn gr no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj ou ov ow bh" data-selectable-paragraph="">I go online and find out that CTR mode ciphers are secure and fast and all things good! But i don’t read the part saying i should be careful with my keys/nonces. So i decide to use the easiest thing i can think of to generate my key/nonces: php str_shuffle function.</li><li id="570d" class="nm nn gr no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj ou ov ow bh" data-selectable-paragraph="">I code my server, put it online and everything is right in the world!</li><li id="b676" class="nm nn gr no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj ou ov ow bh" data-selectable-paragraph="">Except John the hacker exists as well. John decides to test the security of my server and see if he can decode one of my encrypted messages.</li><li id="4c76" class="nm nn gr no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj ou ov ow bh" data-selectable-paragraph="">Now John realizes that I used str_shuffle to generate randomness in my App and he knows that str_shuffle uses a non secure PRNG called Linear Congruential Generator (LCG), he also knows how to easily break LCG. And make no mistake, breaking LCG is incredibly easy! Take <a class="af or" href="https://github.com/EnrisNVT/LCG-breaking-example" rel="noopener ugc nofollow" target="_blank">this small code</a> i wrote based on this <a class="af or" href="http://sandeepmore.com/blog/2012/03/23/breaking-linear-congruential-generator/" rel="noopener ugc nofollow" target="_blank">sandeepmore</a> article, its so simple and fast anyone can do it!</li><li id="6460" class="nm nn gr no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj ou ov ow bh" data-selectable-paragraph="">John then starts to bruteforce my encryption function with the numbers he got from breaking my LCG and a random cipher he intercepted.</li><li id="5630" class="nm nn gr no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj ou ov ow bh" data-selectable-paragraph="">And eventually, Voilà! John successfully exploited my CTR mode cipher and managed to decrypt a secret message!</li><li id="4106" class="nm nn gr no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj ou ov ow bh" data-selectable-paragraph="">John now has a clients credit card number and info and that client is about to make my life a living hell.</li></ul><p id="b9d2" class="pw-post-body-paragraph nm nn gr no b np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj gk bh" data-selectable-paragraph="">Sure, this is a pretty hypothetical scenario, i would have to make many mistakes on my application for this to happen BUT it is possible AND we at Conviso found vulnerabilities like this one already! And knowing crypto is very often disregarded by developers i wouldn’t doubt there are a least a couple of sites out there susceptible to an attack similar to this one!</p><p id="3eb8" class="pw-post-body-paragraph nm nn gr no b np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj gk bh" data-selectable-paragraph="">And well, what can you do to prevent this from happening to you?</p><ul class=""><li id="3ea0" class="nm nn gr no b np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ou ov ow bh" data-selectable-paragraph="">First of all, manage your cryptokeys better! Use state-of-the-art security primitives that will make an attacker writhe in anger whenever he tries to attack your App!</li><li id="7da7" class="nm nn gr no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj ou ov ow bh" data-selectable-paragraph="">If you have time and want to do it, you reeeeally should learn more about System Security! It will possibly prevent you from having a lot of hacker related headaches in the future and it really will boost the market trust on your application! OWASP has some amazing best practices on secure code development for example!</li><li id="b399" class="nm nn gr no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj ou ov ow bh" data-selectable-paragraph="">Or if you want your application to be state-of-the-art secure, contact us! Here at Conviso Application Security we will review your code and make double sure it is safe and secure and everything nice! We can even teach your people if you want with our courses in Secure Development!</li></ul><p id="db95" class="pw-post-body-paragraph nm nn gr no b np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj gk bh" data-selectable-paragraph="">So to sum everything up, ALWAYS remember to manage and create your cryptokeys safely AND always read up on how to properly use any crypto function! And don’t overdo it, but be a little paranoid when coding, especially when you are dealing with high risk transactions like money stuff. No client is going to like having their information leaked!</p><p id="401c" class="pw-post-body-paragraph nm nn gr no b np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj gk bh" data-selectable-paragraph="">Author: Enris N. von Tein<br><a class="af or" href="https://conviso.com.br/" rel="noopener ugc nofollow" target="_blank">Conviso Application Security</a></p></div></div></div></div></section></div></div></article><div class="ab by"><div class="cf be fw fx fy fz"></div></div></div><div></div><div class="m ru rv rw"><div class="bu rx ry be vp" style="bottom: 0px;"><div class="sa t sb v sc sd se sf sg sh ab q cl fg"><div class="si sj sk sl sm l"><div class="am l fp sn so"><div class="h k"><div class="l fg n sp"><button class="af ag ah ai aj ak al am an ao ap aq ar as at ab" data-testid="close-button" aria-label="close"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" class="fh dr fj fi"><path d="M5 5l7 7m7 7l-7-7m0 0l7-7m-7 7l-7 7" stroke="currentColor" stroke-linecap="round"></path></svg></button></div></div><div class="j i d"><div class="l fg n sp"><button class="af ag ah ai aj ak al am an ao ap aq ar as at ab fg sq gn sr ss st su" data-testid="close-button" aria-label="close"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" class="fh dr fj fi"><path d="M5 5l7 7m7 7l-7-7m0 0l7-7m-7 7l-7 7" stroke="currentColor" stroke-linecap="round"></path></svg></button></div></div></div><div class="ab q ja jb tc td"><img class="fp rv gf te" src="https://miro.medium.com/v2/da:true/resize:fit:0/5c50caa54067fd622d2f0fac18392213bf92f6e2fae89b691e62bceb40885e74" loading="lazy" role="presentation"><div class="gv tf ha tg dj th dk ti tj l"><svg viewBox="0 0 3940 610" class="sv sw sx sy sz hf ta hk tb hp"><path d="M594.79 308.2c0 163.76-131.85 296.52-294.5 296.52S5.8 472 5.8 308.2 137.65 11.69 300.29 11.69s294.5 132.75 294.5 296.51M917.86 308.2c0 154.16-65.93 279.12-147.25 279.12s-147.25-125-147.25-279.12S689.29 29.08 770.61 29.08s147.25 125 147.25 279.12M1050 308.2c0 138.12-23.19 250.08-51.79 250.08s-51.79-112-51.79-250.08 23.19-250.08 51.8-250.08S1050 170.09 1050 308.2M1862.77 37.4l.82-.18v-6.35h-167.48l-155.51 365.5-155.51-365.5h-180.48v6.35l.81.18c30.57 6.9 46.09 17.19 46.09 54.3v434.45c0 37.11-15.58 47.4-46.15 54.3l-.81.18V587H1327v-6.35l-.81-.18c-30.57-6.9-46.09-17.19-46.09-54.3V116.9L1479.87 587h11.33l205.59-483.21V536.9c-2.62 29.31-18 38.36-45.68 44.61l-.82.19v6.3h213.3v-6.3l-.82-.19c-27.71-6.25-43.46-15.3-46.08-44.61l-.14-445.2h.14c0-37.11 15.52-47.4 46.08-54.3m97.43 287.8c3.49-78.06 31.52-134.4 78.56-135.37 14.51.24 26.68 5 36.14 14.16 20.1 19.51 29.55 60.28 28.09 121.21zm-2.11 22h250v-1.05c-.71-59.69-18-106.12-51.34-138-28.82-27.55-71.49-42.71-116.31-42.71h-1c-23.26 0-51.79 5.64-72.09 15.86-23.11 10.7-43.49 26.7-60.45 47.7-27.3 33.83-43.84 79.55-47.86 130.93-.13 1.54-.24 3.08-.35 4.62s-.18 2.92-.25 4.39a332.64 332.64 0 0 0-.36 21.69C1860.79 507 1923.65 600 2035.3 600c98 0 155.07-71.64 169.3-167.8l-7.19-2.53c-25 51.68-69.9 83-121 79.18-69.76-5.22-123.2-75.95-118.35-161.63m532.69 157.68c-8.2 19.45-25.31 30.15-48.24 30.15s-43.89-15.74-58.78-44.34c-16-30.7-24.42-74.1-24.42-125.51 0-107 33.28-176.21 84.79-176.21 21.57 0 38.55 10.7 46.65 29.37zm165.84 76.28c-30.57-7.23-46.09-18-46.09-57V5.28L2424.77 60v6.7l1.14-.09c25.62-2.07 43 1.47 53.09 10.79 7.9 7.3 11.75 18.5 11.75 34.26v71.14c-18.31-11.69-40.09-17.38-66.52-17.38-53.6 0-102.59 22.57-137.92 63.56-36.83 42.72-56.3 101.1-56.3 168.81C2230 518.72 2289.53 600 2378.13 600c51.83 0 93.53-28.4 112.62-76.3V588h166.65v-6.66zm159.29-505.33c0-37.76-28.47-66.24-66.24-66.24-37.59 0-67 29.1-67 66.24s29.44 66.24 67 66.24c37.77 0 66.24-28.48 66.24-66.24m43.84 505.33c-30.57-7.23-46.09-18-46.09-57h-.13V166.65l-166.66 47.85v6.5l1 .09c36.06 3.21 45.93 15.63 45.93 57.77V588h166.8v-6.66zm427.05 0c-30.57-7.23-46.09-18-46.09-57V166.65L3082 212.92v6.52l.94.1c29.48 3.1 38 16.23 38 58.56v226c-9.83 19.45-28.27 31-50.61 31.78-36.23 0-56.18-24.47-56.18-68.9V166.66l-166.66 47.85V221l1 .09c36.06 3.2 45.94 15.62 45.94 57.77v191.27a214.48 214.48 0 0 0 3.47 39.82l3 13.05c14.11 50.56 51.08 77 109 77 49.06 0 92.06-30.37 111-77.89v66h166.66v-6.66zM3934.2 588v-6.67l-.81-.19c-33.17-7.65-46.09-22.07-46.09-51.43v-243.2c0-75.83-42.59-121.09-113.93-121.09-52 0-95.85 30.05-112.73 76.86-13.41-49.6-52-76.86-109.06-76.86-50.12 0-89.4 26.45-106.25 71.13v-69.87l-166.66 45.89v6.54l1 .09c35.63 3.16 45.93 15.94 45.93 57V588h155.5v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66V255.72c7-16.35 21.11-35.72 49-35.72 34.64 0 52.2 24 52.2 71.28V588h155.54v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66v-248a160.45 160.45 0 0 0-2.2-27.68c7.42-17.77 22.34-38.8 51.37-38.8 35.13 0 52.2 23.31 52.2 71.28V588z"></path></svg><h2 class="tk b np tl tm nt tn to tp tq tr ts tt tu tv tw tx ty tz">Sign up to discover human stories that deepen your understanding of the world.</h2></div><div class="ab q ja jb"><div class="ua gb bm gv ub ha uc ud ue uf ug uh ui l c"><div class="ab q"><h2 class="bc rc iq z gq bh">Free</h2></div><div class="rg uj l cu"></div><div class="rg ab"><div class="bl l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="bc b bd z bh">Distraction-free reading. No ads.</p></div><div class="rg ab"><div class="bl l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="bc b bd z bh">Organize your knowledge with lists and highlights.</p></div><div class="rg ab"><div class="bl l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="bc b bd z bh">Tell your story. Find your audience.</p></div><div class="ci uk uj l cu"></div><span><button class="bc b bd z ul pg um un uo up uq es et ur us ut ex be ey ez fa bj fb fc">Sign up for free</button></span></div><div class="ua gb bm ub uc ue ug ui l c"><div class="ab q"><svg width="64" height="64" viewBox="0 0 64 64" fill="none" class="uu pf de lx"><path d="M39.64 40.83L33.87 56.7a1.99 1.99 0 0 1-3.74 0l-5.77-15.87a2.02 2.02 0 0 0-1.2-1.2L7.3 33.88a1.99 1.99 0 0 1 0-3.74l15.87-5.77a2.02 2.02 0 0 0 1.2-1.2L30.12 7.3a1.99 1.99 0 0 1 3.74 0l5.77 15.87a2.02 2.02 0 0 0 1.2 1.2l15.86 5.76a1.99 1.99 0 0 1 0 3.74l-15.87 5.77a2.02 2.02 0 0 0-1.2 1.2z" fill="#FFC017"></path></svg><h2 class="bc rc iq z gq bh">Membership</h2></div><div class="rg uj l cu"></div><div class="rg ab"><div class="bl l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="bc b bd z bh">Access the best member-only stories.</p></div><div class="rg ab"><div class="bl l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="bc b bd z bh">Support independent authors.</p></div><div class="rg ab"><div class="bl l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="bc b bd z bh">Listen to audio narrations.</p></div><div class="rg ab"><div class="bl l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="bc b bd z bh">Read offline.</p></div><div class="rg ab"><div class="bl l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="bc b bd z bh">Join the Partner Program and earn for your writing.</p></div><div class="ci uk uj l cu"></div><span><button class="bc b bd z ul pg um un uo up uq es et ur us ut ex be ey ez fa bj fb fc">Try for 5&nbsp;$/month</button></span></div></div></div></div></div></div></div><div class="ab by"><div class="cf be fw fx fy fz"><div class="pc pd ab jc"><div class="pe ab"><a class="pf av am ao" rel="noopener follow" href="/tag/security?source=post_page-----6aba7503bd3c---------------security-----------------"><div class="pg fg cu ph gb pi pj bc b bd z bh pk">Security</div></a></div><div class="pe ab"><a class="pf av am ao" rel="noopener follow" href="/tag/encryption?source=post_page-----6aba7503bd3c---------------encryption-----------------"><div class="pg fg cu ph gb pi pj bc b bd z bh pk">Encryption</div></a></div><div class="pe ab"><a class="pf av am ao" rel="noopener follow" href="/tag/crypto?source=post_page-----6aba7503bd3c---------------crypto-----------------"><div class="pg fg cu ph gb pi pj bc b bd z bh pk">Crypto</div></a></div><div class="pe ab"><a class="pf av am ao" rel="noopener follow" href="/tag/hacker?source=post_page-----6aba7503bd3c---------------hacker-----------------"><div class="pg fg cu ph gb pi pj bc b bd z bh pk">Hacker</div></a></div></div></div></div><div class="l"></div><footer class="pl pm pn po pp pq pr ps pt ab q pu im c"><div class="l ae"><div class="ab by"><div class="cf be fw fx fy fz"><div class="ab cm pv"><div class="ab q kx"><div class="pw l"><span class="l px py pz e d"><div class="ab q kx ky"><div class="pw-multi-vote-icon fg jg kz la lb"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fcode-fighters%2F6aba7503bd3c&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fcode-fighters%2Fwhy-are-nonces-important-on-ctr-mode-ciphers-6aba7503bd3c&amp;user=Conviso&amp;userId=5da1791c5ec3&amp;source=-----6aba7503bd3c---------------------clap_footer-----------"><div><div class="bj" aria-hidden="false" aria-describedby="10" aria-labelledby="10"><div class="lc ao ld le lf lg am lh li lj lb"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lk ll lm ln lo lp lq"><div><div class="bj" aria-hidden="false" aria-describedby="102" aria-labelledby="102"><p class="bc b ds z dr"><button class="af ag ah ai aj ak al am an ao ap aq ar as at wx ly">62<span class="l h g f qa qb"></span></button></p></div></div></div></div></span><span class="l h g f qa qb"><div class="ab q kx ky"><div class="pw-multi-vote-icon fg jg kz la lb"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fcode-fighters%2F6aba7503bd3c&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fcode-fighters%2Fwhy-are-nonces-important-on-ctr-mode-ciphers-6aba7503bd3c&amp;user=Conviso&amp;userId=5da1791c5ec3&amp;source=-----6aba7503bd3c---------------------clap_footer-----------"><div><div class="bj" aria-hidden="false" aria-describedby="11" aria-labelledby="11"><div class="lc ao ld le lf lg am lh li lj lb"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lk ll lm ln lo lp lq"><div><div class="bj" aria-hidden="false" aria-describedby="104" aria-labelledby="104"><p class="bc b ds z dr"><button class="af ag ah ai aj ak al am an ao ap aq ar as at wx ly">62</button></p></div></div></div></div></span></div><div class="bn ab"><div><div class="bj" aria-hidden="false" aria-describedby="12" aria-labelledby="12"><button class="ao lc ls lt ab q fh lu lv" aria-label="responses"><svg width="24" height="24" viewBox="0 0 24 24" class="lw"><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></button></div></div></div></div><div class="ab q"><div class="qc l iz"><div><div class="bj" aria-hidden="false" aria-describedby="13" aria-labelledby="13"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6aba7503bd3c&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fcode-fighters%2Fwhy-are-nonces-important-on-ctr-mode-ciphers-6aba7503bd3c&amp;source=--------------------------bookmark_footer-----------"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dr ly" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div><div class="qc l iz"><div class="bj" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bj" aria-hidden="false" aria-describedby="14" aria-labelledby="14"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fh ah ai aj ak al mg an ao ap eu mh mi lv mj"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.22 4.93a.42.42 0 0 1-.12.13h.01a.45.45 0 0 1-.29.08.52.52 0 0 1-.3-.13L12.5 3v7.07a.5.5 0 0 1-.5.5.5.5 0 0 1-.5-.5V3.02l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.8a.42.42 0 0 1 .07.5zm-.1.14zm.88 2h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11a2 2 0 0 1-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.14c.1.1.15.22.15.35a.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9V8.96c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1z" fill="currentColor"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="qd qe qf qg qh l bu"><div class="ab by"><div class="cf be fw fx fy fz"><div class="ci ab qi cm"><div class="ab ic"><a rel="noopener follow" href="/@codefighters?source=post_page-----6aba7503bd3c--------------------------------"><div class="l qj qk bv ql ig"><div class="l fg"><img alt="Conviso" class="l fa bv qm qn cu" src="https://miro.medium.com/v2/resize:fill:144:144/1*1bw5RDL9UPM-mYZJBuED-A.png" width="72" height="72" loading="lazy"><div class="ih bv l qm qn fp n ii fq"></div></div></div></a><a href="https://medium.com/code-fighters?source=post_page-----6aba7503bd3c--------------------------------" rel="noopener follow"><div class="qo ab fg"><div><div class="bj" aria-hidden="false" aria-describedby="15" aria-labelledby="15"><div class="l qp qq bv ql im"><div class="l fg"><img alt="Code Fighters" class="l fa bv bw bx cu" src="https://miro.medium.com/v2/resize:fill:64:64/1*_QBbFRIssyArHSfwVWAonA.png" width="32" height="32" loading="lazy"><div class="ih bv l bw bx fp n ii fq"></div></div></div></div></div></div></a></div><div class="j i d"><div class="ab"><span><button class="bc b bd z el pg em eo ep eq er es et eu ev ew ex qr ey ez fa bj fb fc">Follow</button></span><div class="dq l"><div><div><div class="bj" aria-hidden="false" aria-describedby="109" aria-labelledby="109"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F5da1791c5ec3%2Flazily-enable-writer-subscription&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fcode-fighters%2Fwhy-are-nonces-important-on-ctr-mode-ciphers-6aba7503bd3c&amp;user=Conviso&amp;userId=5da1791c5ec3&amp;source=-----6aba7503bd3c---------------------subscribe_user-----------"><button class="bc b bd z el am em eo ep eq er es et eu ev ew ex ey ez fa bj fb fc" aria-label="Subscribe"><svg width="38" height="38" viewBox="0 0 38 38" fill="none" class="ww qq qp"><rect x="26.25" y="9.25" width="0.5" height="6.5" rx="0.25"></rect><rect x="29.75" y="12.25" width="0.5" height="6.5" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5L19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="ab ck cm"><div class="l"><div class="ab q"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/@codefighters?source=post_page-----6aba7503bd3c--------------------------------"><h2 class="pw-author-name bc rc rd re rf bh"><span class="gk jq">Written by <!-- -->Conviso</span></h2></a></div><div class="pe ab"><div class="l iz"><span class="pw-follower-count bc b bd z bh"><a class="af ag ah ai aj ak al am an ao ap aq ar is" rel="noopener follow" href="/@codefighters/followers?source=post_page-----6aba7503bd3c--------------------------------">87 Followers</a></span></div><div class="bc b bd z jh ji jj ab jl jm jn jo dr jf"><span class="it l" aria-hidden="true"><span class="bc b bd z dr">·</span></span><span class="l iz">Editor for </span><div><div class="l" aria-hidden="false" aria-describedby="17" aria-labelledby="17"><a class="af ag ah ai aj ak al am an ao ap aq ar is ab q" href="https://medium.com/code-fighters?source=post_page-----6aba7503bd3c--------------------------------" rel="noopener follow"><p class="bc b bd z jh ji jj jk jl jm jn jo bh">Code Fighters</p></a></div></div></div></div><div class="rg l"><p class="bc b bd z bh"><span class="gk">Reference in advanced security analysis, we offer support for the entire vulnerability management and safe software development process</span></p></div></div><div class="h k"><div class="ab"><span><button class="bc b bd z el pg em eo ep eq er es et eu ev ew ex qr ey ez fa bj fb fc">Follow</button></span><div class="dq l"><div><div><div class="bj" aria-hidden="false" aria-describedby="111" aria-labelledby="111"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F5da1791c5ec3%2Flazily-enable-writer-subscription&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fcode-fighters%2Fwhy-are-nonces-important-on-ctr-mode-ciphers-6aba7503bd3c&amp;user=Conviso&amp;userId=5da1791c5ec3&amp;source=-----6aba7503bd3c---------------------subscribe_user-----------"><button class="bc b bd z el am em eo ep eq er es et eu ev ew ex ey ez fa bj fb fc" aria-label="Subscribe"><svg width="38" height="38" viewBox="0 0 38 38" fill="none" class="ww qq qp"><rect x="26.25" y="9.25" width="0.5" height="6.5" rx="0.25"></rect><rect x="29.75" y="12.25" width="0.5" height="6.5" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5L19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="rh be ri nb nc nd ne nf"></div></div></div><div class="h k j"><div class="rh be ri rj"></div><div class="ab by"><div class="cf be fw fx fy fz"><div class="rk ab kx jc"><div class="rl rm l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----6aba7503bd3c--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Help</p></a></div><div class="rl rm l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----6aba7503bd3c--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Status</p></a></div><div class="rl rm l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/about?autoplay=1&amp;source=post_page-----6aba7503bd3c--------------------------------"><p class="bc b ds z dr">About</p></a></div><div class="rl rm l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----6aba7503bd3c--------------------------------"><p class="bc b ds z dr">Careers</p></a></div><div class="rl rm l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="mailto:pressinquiries@medium.com?source=post_page-----6aba7503bd3c--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Press</p></a></div><div class="rl rm l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----6aba7503bd3c--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Blog</p></a></div><div class="rl rm l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6aba7503bd3c--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Privacy</p></a></div><div class="rl rm l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6aba7503bd3c--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Terms</p></a></div><div class="rl rm l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----6aba7503bd3c--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Text to speech</p></a></div><div class="rl l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/business?source=post_page-----6aba7503bd3c--------------------------------"><p class="bc b ds z dr">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20240614-221838-3ba87a70fa"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-6aba7503bd3c","user-5da1791c5ec3","collection-48bb481d0427"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"updatedPostPreviewsEnabled":true,"lohpExperimentEnabled":"control","prideLogoEnabled":true},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":true,"routingEntity":{"type":"DEFAULT","explicit":false},"viewerIsBot":false},"debug":{"requestId":"1d2fa0ce-6fe3-48ca-8bae-18544e120134","hybridDevServices":[],"originalSpanCarrier":{"ot-tracer-spanid":"6aed544261ae3649","ot-tracer-traceid":"643bca522f59c919","ot-tracer-sampled":"true"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fmedium.com\u002Fcode-fighters\u002Fwhy-are-nonces-important-on-ctr-mode-ciphers-6aba7503bd3c","host":"medium.com","hostname":"medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20240614-221838-3ba87a70fa","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20240614-221838-3ba87a70fa","commit":"3ba87a70fa89456c9162015acb3c1797c92f4b41"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"1*OMF3fSqH8t4xBJ9-6oZDZw.png","height":106,"width":545},"postLogo":{"imageId":"1*kFrc4tBFM_tCis-2Ic87WA.png","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"isLoggedIn":false,"collectionByDomainOrSlug({\"domainOrSlug\":\"code-fighters\"})":{"__ref":"Collection:48bb481d0427"},"postResult({\"id\":\"6aba7503bd3c\"})":{"__ref":"Post:6aba7503bd3c"}},"ImageMetadata:":{"__typename":"ImageMetadata","id":""},"Collection:48bb481d0427":{"__typename":"Collection","id":"48bb481d0427","favicon":{"__ref":"ImageMetadata:"},"customStyleSheet":null,"colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFEEF3FA","point":0},{"__typename":"ColorPoint","color":"#FFEBF2FA","point":0.1},{"__typename":"ColorPoint","color":"#FFE8F0FA","point":0.2},{"__typename":"ColorPoint","color":"#FFE5EFFA","point":0.3},{"__typename":"ColorPoint","color":"#FFE1EDFA","point":0.4},{"__typename":"ColorPoint","color":"#FFDEEBFA","point":0.5},{"__typename":"ColorPoint","color":"#FFDBEAFA","point":0.6},{"__typename":"ColorPoint","color":"#FFD7E8FA","point":0.7},{"__typename":"ColorPoint","color":"#FFD4E7FA","point":0.8},{"__typename":"ColorPoint","color":"#FFD1E5FA","point":0.9},{"__typename":"ColorPoint","color":"#FFCDE3FA","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF6D89A3","point":0},{"__typename":"ColorPoint","color":"#FF667F97","point":0.1},{"__typename":"ColorPoint","color":"#FF5F758A","point":0.2},{"__typename":"ColorPoint","color":"#FF586B7E","point":0.3},{"__typename":"ColorPoint","color":"#FF506171","point":0.4},{"__typename":"ColorPoint","color":"#FF485764","point":0.5},{"__typename":"ColorPoint","color":"#FF404C57","point":0.6},{"__typename":"ColorPoint","color":"#FF37404A","point":0.7},{"__typename":"ColorPoint","color":"#FF2D353C","point":0.8},{"__typename":"ColorPoint","color":"#FF22282E","point":0.9},{"__typename":"ColorPoint","color":"#FF171B1E","point":1}]},"tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FF001E34","colorPoints":[{"__typename":"ColorPoint","color":"#FF001E34","point":0},{"__typename":"ColorPoint","color":"#FF243D51","point":0.1},{"__typename":"ColorPoint","color":"#FF41576B","point":0.2},{"__typename":"ColorPoint","color":"#FF5B6F81","point":0.3},{"__typename":"ColorPoint","color":"#FF748696","point":0.4},{"__typename":"ColorPoint","color":"#FF8C9BAA","point":0.5},{"__typename":"ColorPoint","color":"#FFA3B0BD","point":0.6},{"__typename":"ColorPoint","color":"#FFB9C4CF","point":0.7},{"__typename":"ColorPoint","color":"#FFCED7E0","point":0.8},{"__typename":"ColorPoint","color":"#FFE4EAF1","point":0.9},{"__typename":"ColorPoint","color":"#FFF8FCFF","point":1}]}},"googleAnalyticsId":null,"editors":[{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:5da1791c5ec3"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:c9aa7753b4e1"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:1749f79ec78d"}}],"name":"Code Fighters","avatar":{"__ref":"ImageMetadata:1*_QBbFRIssyArHSfwVWAonA.png"},"domain":null,"slug":"code-fighters","description":"Promoting relevant information for the appsec community","subscriberCount":94,"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:48bb481d0427-viewerId:lo_feab786b6e83"},"twitterUsername":"conviso","facebookPageId":null,"logo":{"__ref":"ImageMetadata:1*-vLfcunIzAJFHOa7rymAVg.png"}},"User:5da1791c5ec3":{"__typename":"User","id":"5da1791c5ec3","linkedAccounts":{"__ref":"LinkedAccounts:5da1791c5ec3"},"isSuspended":false,"imageId":"1*1bw5RDL9UPM-mYZJBuED-A.png","mediumMemberAt":0,"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"name":"Conviso","socialStats":{"__typename":"SocialStats","followerCount":87},"username":"codefighters","customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"codefighters.medium.com"}},"hasSubdomain":true,"bio":"Reference in advanced security analysis, we offer support for the entire vulnerability management and safe software development process","isPartnerProgramEnrolled":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:5da1791c5ec3-viewerId:lo_feab786b6e83"},"viewerIsUser":false,"newsletterV3":null,"postSubscribeMembershipUpsellShownAt":0,"allowNotes":true,"membership":null,"twitterScreenName":""},"User:c9aa7753b4e1":{"__typename":"User","id":"c9aa7753b4e1"},"User:1749f79ec78d":{"__typename":"User","id":"1749f79ec78d"},"ImageMetadata:1*_QBbFRIssyArHSfwVWAonA.png":{"__typename":"ImageMetadata","id":"1*_QBbFRIssyArHSfwVWAonA.png"},"LinkedAccounts:5da1791c5ec3":{"__typename":"LinkedAccounts","mastodon":null,"id":"5da1791c5ec3"},"UserViewerEdge:userId:5da1791c5ec3-viewerId:lo_feab786b6e83":{"__typename":"UserViewerEdge","id":"userId:5da1791c5ec3-viewerId:lo_feab786b6e83","isFollowing":false,"isUser":false,"isMuting":false},"Paragraph:9565861e3e83_0":{"__typename":"Paragraph","id":"9565861e3e83_0","name":"cd72","type":"H3","href":null,"layout":null,"metadata":null,"text":"Why are nonces important on CTR mode ciphers","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*NOvxkyohjVaVBxDm-wxCRQ.png":{"__typename":"ImageMetadata","id":"1*NOvxkyohjVaVBxDm-wxCRQ.png","originalHeight":1080,"originalWidth":1920,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9565861e3e83_1":{"__typename":"Paragraph","id":"9565861e3e83_1","name":"234a","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*NOvxkyohjVaVBxDm-wxCRQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9565861e3e83_2":{"__typename":"Paragraph","id":"9565861e3e83_2","name":"ae14","type":"P","href":null,"layout":null,"metadata":null,"text":"So I was recently testing some crypto libraries for a project I’m developing and i came across an interesting “problem”: By encrypting a message twice I actually decrypted the message. Wait, wait, i’ll explain and show you that the problem was how i was using the cipher rather than the cipher itself!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9565861e3e83_3":{"__typename":"Paragraph","id":"9565861e3e83_3","name":"eaa9","type":"P","href":null,"layout":null,"metadata":null,"text":"So, the code i ran is something like this:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*gfs9E65jUYJ6RktvWsKgJw.png":{"__typename":"ImageMetadata","id":"1*gfs9E65jUYJ6RktvWsKgJw.png","originalHeight":472,"originalWidth":526,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9565861e3e83_4":{"__typename":"Paragraph","id":"9565861e3e83_4","name":"20a7","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*gfs9E65jUYJ6RktvWsKgJw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9565861e3e83_5":{"__typename":"Paragraph","id":"9565861e3e83_5","name":"bf6b","type":"P","href":null,"layout":null,"metadata":null,"text":"And got this output:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*uJ6rpsCDpNJHZTcScmh1AA.png":{"__typename":"ImageMetadata","id":"1*uJ6rpsCDpNJHZTcScmh1AA.png","originalHeight":251,"originalWidth":385,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9565861e3e83_6":{"__typename":"Paragraph","id":"9565861e3e83_6","name":"0d35","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*uJ6rpsCDpNJHZTcScmh1AA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9565861e3e83_7":{"__typename":"Paragraph","id":"9565861e3e83_7","name":"a351","type":"P","href":null,"layout":null,"metadata":null,"text":"Weird right? If you like me, didn’t knew what i will be explaining shortly, you are probably thinking something like: “Wait what? That’s not right! That cannot be secure!” And well, in a sense you are right, but as I said the problem is HOW i used the cipher, not the cipher itself.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9565861e3e83_8":{"__typename":"Paragraph","id":"9565861e3e83_8","name":"e573","type":"P","href":null,"layout":null,"metadata":null,"text":"Let me explain: There exists a type of cipher known as Stream ciphers. Basically, in an grossly simplified way, Stream Ciphers are clever and fancy ways of using bitwise XOR operations to create a safe cipher. Stream ciphers in practice are somewhat controversial because there are some famous ones with pretty huge attacks (See RC4 WEP weakness), but they can be implemented safely in many ways, and one way is using a block cipher in counter mode. Now, Block Ciphers are deterministic functions that operate in a block of plaintext using a symmetric key, they are alone not particularly useful but that’s when the modes of operations come in, they are algorithms that use those block ciphers to create stronger, safer ciphers!","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":325,"end":345,"href":"http:\u002F\u002Fwww.dummies.com\u002Fprogramming\u002Fnetworking\u002Funderstanding-wep-weaknesses\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9565861e3e83_9":{"__typename":"Paragraph","id":"9565861e3e83_9","name":"29ab","type":"P","href":null,"layout":null,"metadata":null,"text":"To understand what happened we must now speak of a particular mode of operation, the Counter mode. The main problem with a block cipher is that by definition they work on a block, a finite amount of data and unless you are coding for twitter, you don’t want a small amount of space for your messages. That’s where the modes of operation, like counter mode, come in. Counter mode ciphers take a block cipher and use it to generate the string that is going to be XORed with the message you want to cipher and doing so for every block of your message it can cipher many many blocks! It works like this:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*a5xulHZkfJlkItZ6FVV7zg.png":{"__typename":"ImageMetadata","id":"1*a5xulHZkfJlkItZ6FVV7zg.png","originalHeight":242,"originalWidth":601,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9565861e3e83_10":{"__typename":"Paragraph","id":"9565861e3e83_10","name":"5b1b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*a5xulHZkfJlkItZ6FVV7zg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9565861e3e83_11":{"__typename":"Paragraph","id":"9565861e3e83_11","name":"53ae","type":"P","href":null,"layout":null,"metadata":null,"text":"Cool right! What a smart way to use block ciphers to cipher an arbitrary length string! The “problem” comes in now, since this is the decryption function:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*v8pXy1na6ULhv2srjV1XQw.png":{"__typename":"ImageMetadata","id":"1*v8pXy1na6ULhv2srjV1XQw.png","originalHeight":242,"originalWidth":601,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9565861e3e83_12":{"__typename":"Paragraph","id":"9565861e3e83_12","name":"c797","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*v8pXy1na6ULhv2srjV1XQw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9565861e3e83_13":{"__typename":"Paragraph","id":"9565861e3e83_13","name":"cc83","type":"P","href":null,"layout":null,"metadata":null,"text":"Now, do you see something similar between those two?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9565861e3e83_14":{"__typename":"Paragraph","id":"9565861e3e83_14","name":"2201","type":"P","href":null,"layout":null,"metadata":null,"text":"Well, if you see congratulations because they are exactly the same operation!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9565861e3e83_15":{"__typename":"Paragraph","id":"9565861e3e83_15","name":"f5a4","type":"P","href":null,"layout":null,"metadata":null,"text":"Interesting right? Now you might ask: “Hmm this looks rather unsafe, how can it be IND-CPA secure if the encryption operation is the same as the decryption?” and well, the answer is on the nonce and counter! Basically, if you don’t reuse nonce and counter values you should be fine! A formal proof can be seen here and here, look into these if you really want to understand the maths.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":310,"end":314,"href":"https:\u002F\u002Fwww.cs.umd.edu\u002F~jkatz\u002Fimc.html","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":319,"end":323,"href":"http:\u002F\u002Fdrona.csa.iisc.ernet.in\u002F~arpita\u002FCryptography15\u002FCT2.pdf","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9565861e3e83_16":{"__typename":"Paragraph","id":"9565861e3e83_16","name":"e20d","type":"P","href":null,"layout":null,"metadata":null,"text":"Now that we know all this, we can find out what i did wrong! If you check my code snippet, you will see that i encrypted it twice using the same Nonce! Since the encryption and decryption schemes are exactly the same, i essentially attacked my own message! Cool right?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9565861e3e83_17":{"__typename":"Paragraph","id":"9565861e3e83_17","name":"7de5","type":"P","href":null,"layout":null,"metadata":null,"text":"The correct thing to do would be something like this:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*EiCi8HOFkW4JmWjJ3Yu7jQ.png":{"__typename":"ImageMetadata","id":"1*EiCi8HOFkW4JmWjJ3Yu7jQ.png","originalHeight":236,"originalWidth":542,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9565861e3e83_18":{"__typename":"Paragraph","id":"9565861e3e83_18","name":"cd78","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*EiCi8HOFkW4JmWjJ3Yu7jQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9565861e3e83_19":{"__typename":"Paragraph","id":"9565861e3e83_19","name":"64f7","type":"P","href":null,"layout":null,"metadata":null,"text":"This way you will generate new nonces every iteration! Now even if you do this, you might actually be still vulnerable if you do something like I describe later!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9565861e3e83_20":{"__typename":"Paragraph","id":"9565861e3e83_20","name":"5bf1","type":"P","href":null,"layout":null,"metadata":null,"text":"The problem with this is that what i wrote here is not very common knowledge! I mean i’ve been studying crypto for a while now and it took me a couple of searches and asking my professors to figure it out. And that can be dangerous, let me show you how:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9565861e3e83_21":{"__typename":"Paragraph","id":"9565861e3e83_21","name":"3c5d","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Suppose im a layman in crypto and i want to create a site that does an encrypted message exchange.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9565861e3e83_22":{"__typename":"Paragraph","id":"9565861e3e83_22","name":"a876","type":"ULI","href":null,"layout":null,"metadata":null,"text":"I go online and find out that CTR mode ciphers are secure and fast and all things good! But i don’t read the part saying i should be careful with my keys\u002Fnonces. So i decide to use the easiest thing i can think of to generate my key\u002Fnonces: php str_shuffle function.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9565861e3e83_23":{"__typename":"Paragraph","id":"9565861e3e83_23","name":"570d","type":"ULI","href":null,"layout":null,"metadata":null,"text":"I code my server, put it online and everything is right in the world!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9565861e3e83_24":{"__typename":"Paragraph","id":"9565861e3e83_24","name":"b676","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Except John the hacker exists as well. John decides to test the security of my server and see if he can decode one of my encrypted messages.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9565861e3e83_25":{"__typename":"Paragraph","id":"9565861e3e83_25","name":"4c76","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Now John realizes that I used str_shuffle to generate randomness in my App and he knows that str_shuffle uses a non secure PRNG called Linear Congruential Generator (LCG), he also knows how to easily break LCG. And make no mistake, breaking LCG is incredibly easy! Take this small code i wrote based on this sandeepmore article, its so simple and fast anyone can do it!","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":270,"end":285,"href":"https:\u002F\u002Fgithub.com\u002FEnrisNVT\u002FLCG-breaking-example","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":308,"end":319,"href":"http:\u002F\u002Fsandeepmore.com\u002Fblog\u002F2012\u002F03\u002F23\u002Fbreaking-linear-congruential-generator\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9565861e3e83_26":{"__typename":"Paragraph","id":"9565861e3e83_26","name":"6460","type":"ULI","href":null,"layout":null,"metadata":null,"text":"John then starts to bruteforce my encryption function with the numbers he got from breaking my LCG and a random cipher he intercepted.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9565861e3e83_27":{"__typename":"Paragraph","id":"9565861e3e83_27","name":"5630","type":"ULI","href":null,"layout":null,"metadata":null,"text":"And eventually, Voilà! John successfully exploited my CTR mode cipher and managed to decrypt a secret message!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9565861e3e83_28":{"__typename":"Paragraph","id":"9565861e3e83_28","name":"4106","type":"ULI","href":null,"layout":null,"metadata":null,"text":"John now has a clients credit card number and info and that client is about to make my life a living hell.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9565861e3e83_29":{"__typename":"Paragraph","id":"9565861e3e83_29","name":"b9d2","type":"P","href":null,"layout":null,"metadata":null,"text":"Sure, this is a pretty hypothetical scenario, i would have to make many mistakes on my application for this to happen BUT it is possible AND we at Conviso found vulnerabilities like this one already! And knowing crypto is very often disregarded by developers i wouldn’t doubt there are a least a couple of sites out there susceptible to an attack similar to this one!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9565861e3e83_30":{"__typename":"Paragraph","id":"9565861e3e83_30","name":"3eb8","type":"P","href":null,"layout":null,"metadata":null,"text":"And well, what can you do to prevent this from happening to you?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9565861e3e83_31":{"__typename":"Paragraph","id":"9565861e3e83_31","name":"3ea0","type":"ULI","href":null,"layout":null,"metadata":null,"text":"First of all, manage your cryptokeys better! Use state-of-the-art security primitives that will make an attacker writhe in anger whenever he tries to attack your App!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9565861e3e83_32":{"__typename":"Paragraph","id":"9565861e3e83_32","name":"7da7","type":"ULI","href":null,"layout":null,"metadata":null,"text":"If you have time and want to do it, you reeeeally should learn more about System Security! It will possibly prevent you from having a lot of hacker related headaches in the future and it really will boost the market trust on your application! OWASP has some amazing best practices on secure code development for example!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9565861e3e83_33":{"__typename":"Paragraph","id":"9565861e3e83_33","name":"b399","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Or if you want your application to be state-of-the-art secure, contact us! Here at Conviso Application Security we will review your code and make double sure it is safe and secure and everything nice! We can even teach your people if you want with our courses in Secure Development!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9565861e3e83_34":{"__typename":"Paragraph","id":"9565861e3e83_34","name":"db95","type":"P","href":null,"layout":null,"metadata":null,"text":"So to sum everything up, ALWAYS remember to manage and create your cryptokeys safely AND always read up on how to properly use any crypto function! And don’t overdo it, but be a little paranoid when coding, especially when you are dealing with high risk transactions like money stuff. No client is going to like having their information leaked!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9565861e3e83_35":{"__typename":"Paragraph","id":"9565861e3e83_35","name":"401c","type":"P","href":null,"layout":null,"metadata":null,"text":"Author: Enris N. von Tein\nConviso Application Security","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":26,"end":54,"href":"https:\u002F\u002Fconviso.com.br\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"CollectionViewerEdge:collectionId:48bb481d0427-viewerId:lo_feab786b6e83":{"__typename":"CollectionViewerEdge","id":"collectionId:48bb481d0427-viewerId:lo_feab786b6e83","isEditor":false,"isMuting":false},"ImageMetadata:1*-vLfcunIzAJFHOa7rymAVg.png":{"__typename":"ImageMetadata","id":"1*-vLfcunIzAJFHOa7rymAVg.png","originalWidth":600,"originalHeight":72},"Tag:security":{"__typename":"Tag","id":"security","displayTitle":"Security","normalizedTagSlug":"security"},"Tag:encryption":{"__typename":"Tag","id":"encryption","displayTitle":"Encryption","normalizedTagSlug":"encryption"},"Tag:crypto":{"__typename":"Tag","id":"crypto","displayTitle":"Crypto","normalizedTagSlug":"crypto"},"Tag:hacker":{"__typename":"Tag","id":"hacker","displayTitle":"Hacker","normalizedTagSlug":"hacker"},"Post:6aba7503bd3c":{"__typename":"Post","id":"6aba7503bd3c","collection":{"__ref":"Collection:48bb481d0427"},"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"011f","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:9565861e3e83_0"},{"__ref":"Paragraph:9565861e3e83_1"},{"__ref":"Paragraph:9565861e3e83_2"},{"__ref":"Paragraph:9565861e3e83_3"},{"__ref":"Paragraph:9565861e3e83_4"},{"__ref":"Paragraph:9565861e3e83_5"},{"__ref":"Paragraph:9565861e3e83_6"},{"__ref":"Paragraph:9565861e3e83_7"},{"__ref":"Paragraph:9565861e3e83_8"},{"__ref":"Paragraph:9565861e3e83_9"},{"__ref":"Paragraph:9565861e3e83_10"},{"__ref":"Paragraph:9565861e3e83_11"},{"__ref":"Paragraph:9565861e3e83_12"},{"__ref":"Paragraph:9565861e3e83_13"},{"__ref":"Paragraph:9565861e3e83_14"},{"__ref":"Paragraph:9565861e3e83_15"},{"__ref":"Paragraph:9565861e3e83_16"},{"__ref":"Paragraph:9565861e3e83_17"},{"__ref":"Paragraph:9565861e3e83_18"},{"__ref":"Paragraph:9565861e3e83_19"},{"__ref":"Paragraph:9565861e3e83_20"},{"__ref":"Paragraph:9565861e3e83_21"},{"__ref":"Paragraph:9565861e3e83_22"},{"__ref":"Paragraph:9565861e3e83_23"},{"__ref":"Paragraph:9565861e3e83_24"},{"__ref":"Paragraph:9565861e3e83_25"},{"__ref":"Paragraph:9565861e3e83_26"},{"__ref":"Paragraph:9565861e3e83_27"},{"__ref":"Paragraph:9565861e3e83_28"},{"__ref":"Paragraph:9565861e3e83_29"},{"__ref":"Paragraph:9565861e3e83_30"},{"__ref":"Paragraph:9565861e3e83_31"},{"__ref":"Paragraph:9565861e3e83_32"},{"__ref":"Paragraph:9565861e3e83_33"},{"__ref":"Paragraph:9565861e3e83_34"},{"__ref":"Paragraph:9565861e3e83_35"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:5da1791c5ec3"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fcode-fighters\u002Fwhy-are-nonces-important-on-ctr-mode-ciphers-6aba7503bd3c","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"cybersecurity"}],"isPublished":true,"latestPublishedVersion":"9565861e3e83","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"createdAt":1524766917826,"firstPublishedAt":1524833095786,"latestPublishedAt":1525359039433,"clapCount":62,"allowResponses":true,"isLimitedState":false,"title":"Why are nonces important on CTR mode ciphers","isSeries":false,"sequence":null,"uniqueSlug":"why-are-nonces-important-on-ctr-mode-ciphers-6aba7503bd3c","socialTitle":"","socialDek":"","noIndex":null,"canonicalUrl":"","metaDescription":"","readingTime":5.25188679245283,"previewContent":{"__typename":"PreviewContent","subtitle":"So I was recently testing some crypto libraries for a project I’m developing and i came across an interesting “problem”: By encrypting a…"},"previewImage":{"__ref":"ImageMetadata:1*NOvxkyohjVaVBxDm-wxCRQ.png"},"isShortform":false,"seoTitle":"","updatedAt":1526046219676,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:security"},{"__ref":"Tag:encryption"},{"__ref":"Tag:crypto"},{"__ref":"Tag:hacker"}],"isNewsletter":false,"statusForCollection":"APPROVED","pendingCollection":null,"detectedLanguage":"en","wordCount":1140,"layerCake":0}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"MISS"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.3cc5e3b6.js"></script><script src="https://cdn-client.medium.com/lite/static/js/2640.3217006c.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.7db0aaff.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.4ddbf12e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.2021fe63.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6068.e9093f2e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4398.db4d4378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7883.0e445e04.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9281.e9be8bce.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7111.b294e9da.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6481.362dec70.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8695.6f58679b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8978.4b110123.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3418.eb013b5a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3894.e3d01e2c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5514.32e692f6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5203.e7f058c5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7098.93054372.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8051.0a9d3f4b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8558.abbaadfd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1711.7605eb3e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8597.762eae49.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9174.b1b0f607.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8883.2f95bbf4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/705.e5898c57.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2911.d072adec.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8580.feeb2549.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6046.f9be485b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/500.d5389c14.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9408.22b56993.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6605.84e81b15.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6637.661bd7cf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7421.3f94f5ea.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/51.d8fb2684.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2133.c8ba56b1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.81dff084.chunk.js"></script><script>window.main();</script><script defer="" src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon="{&quot;rayId&quot;:&quot;894255652e7c4126&quot;,&quot;version&quot;:&quot;2024.4.1&quot;,&quot;token&quot;:&quot;0b5f665943484354a59c39c6833f7078&quot;}" crossorigin="anonymous"></script>
<div><div class="ry n vq vr rg vs vt vu vv vw vx vy vz wa wb ce bm wc wd we ls wf wg"><div class="bc b ds z ul"><div class="ab cm wh wi"><div class="l" role="alert">To make Medium work, we log user data. By using Medium, you agree to our <a class="af ag ah ai aj ak al am an ao ap wj wk or" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9" rel="noopener follow" target="_blank">Privacy Policy</a>, including cookie policy.</div><div class="wl wm wn wo wp wq l wr iz ws"><div class="l fg n sp"><button class="af ag ah ai aj ak al am an ao ap wj wk wt wu ab" data-testid="close-button" aria-label="close"><svg width="19" height="19" viewBox="0 0 19 19" class="em el"><path d="M13.8 4.6L9.5 8.89 5.21 4.6l-.61.61 4.29 4.3-4.29 4.28.61.62 4.3-4.3 4.28 4.3.62-.62-4.3-4.29 4.3-4.29" fill-rule="evenodd"></path></svg></button></div></div></div></div></div></div><script src="https://accounts.google.com/gsi/client" async=""></script></body></html>