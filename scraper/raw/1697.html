<html lang="en"><head><link href="https://fonts.googleapis.com/css?family=Archivo:400,500|Arimo:400,500|Bitter:400,500|EB+Garamond:400,500|Lato|Libre+Baskervill|Libre+Franklin:400,500|Lora:400,500|Google+Sans:regular,medium:400,500|Material+Icons|Google+Symbols|Merriweather|Montserrat:400,500|Mukta:400,500|Muli:400,500|Nunito:400,500|Open+Sans:400,500,600|Open+Sans+Condensed:400,600|Oswald:500|Playfair+Display:400,500|Poppins:400,500|Raleway:400,500|Roboto:400,500|Roboto+Condensed:400,500|Roboto+Slab:400,500|Slabo+27px|Source+Sans+Pro|Ubuntu:400,500|Volkhov&amp;display=swap" rel="stylesheet">

	

	
	<link rel="preconnect" href="https://apps.developermedia.com">
	<link rel="preconnect" href="https://cdn1.developermedia.com">
	<link rel="preconnect" href="https://cdn.ampproject.org">
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://ajax.googleapis.com">
	<link rel="preconnect" href="https://adservice.google.com">
	<link rel="preconnect" href="https://www.googletagservices.com">
	<link rel="preconnect" href="https://www.googletagmanager.com">
	<link rel="preconnect" href="https://www.google.com">
	<link rel="preconnect" href="https://www.google-analytics.com">
	<link rel="preconnect" href="https://pagead2.googlesyndication.com">

	<link rel="preconnect" href="https://codeproject.freetls.fastly.net">


	<link rel="preload" href="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/logo250x135.gif" as="image">


	<link rel="preload" href="/App_Themes/CodeProject/Img/logo135-bg.gif" as="image">
	<link rel="preload" href="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js" as="script" type="text/javascript">


	<title>Creating Shellcode from any Code Using Visual Studio and C++ - CodeProject</title> 
    
	<!-- inlined file /App_Themes/CodeProject/Css/article.critical.min.css. -->
<style type="text/css">
.blank-background {
  background-color: white;
}
html,
div,
span,
applet,
object,
iframe,
a,
abbr,
acronym,
big,
cite,
code,
del,
dfn,
em,
font,
img,
ins,
kbd,
q,
s,
samp,
small,
strike,
strong,
sub,
sup,
tt,
var,
fieldset,
form,
label,
table,
tbody,
tfoot,
thead,
tr,
th,
td,
li,
ol,
ul {
  margin: 0;
  padding: 0;
  border: 0;
}
html {
  font-size: 16px;
  -webkit-font-smoothing: antialiased;
  font-smooth: always;
}
body,
p,
h1,
h2,
h3,
h4,
h5,
h6,
li,
tr,
td,
th,
dd,
dt {
  font-family: "Segoe UI", Arial, Sans-Serif;
  font-size: 16px;
  line-height: 1.4;
  color: #111111;
}
body {
  margin: 0;
}
h1,
h3,
h4,
h5,
th {
  font-weight: bold;
}
h1 {
  color: #333333;
  padding: 0px;
  margin: 0 0 7px;
  text-align: left;
}
h2 {
  margin: 20px 0 11px;
  padding: 0;
  padding-bottom: 10px;
  color: #333333;
}
h3 {
  color: #ff9900;
}
h1 {
  font-size: 38px;
  font-weight: 400;
}
h2 {
  font-size: 29px;
  font-weight: 400;
}
h3 {
  font-size: 19px;
  font-weight: normal;
}
h4 {
  font-size: 17px;
}
pre {
  color: black;
  background-color: #FBEDBB;
  padding: 6px;
  font: 14px Consolas, monospace, mono;
  white-space: pre;
  overflow: auto;
  border: solid 1px #FBEDBB;
  -moz-tab-size: 4;
  -o-tab-size: 4;
  -webkit-tab-size: 4;
  tab-size: 4;
}
code {
  color: #990000;
  font: 15px Consolas, monospace, mono;
}
table {
  background-color: Transparent;
}
img {
  -ms-interpolation-mode: bicubic;
}
a {
  text-decoration: none;
  color: #005782;
}
a:visited {
  color: #800080;
}
a:hover {
  text-decoration: underline;
}
a:not([href]) {
  color: inherit;
  text-decoration: none;
}
input[type="text"],
input[type="url"],
input[type="search"],
input[type="email"],
input[type="number"],
input[type="password"],
select,
textarea {
  border: 1px solid #D7D7D7;
  font-size: 16px;
  padding: 5px;
}
a.button,
a.button-large,
.button,
.button-large {
  color: white;
  background-color: #E08900;
  border: 1px solid #cccccc;
  text-decoration: none;
  white-space: nowrap;
  font-size: 100%;
  padding: 4px;
  cursor: pointer;
  border-radius: 3px;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
}
table.small-text td,
ul.small-text li,
ol.small-text li,
.small-text {
  font-size: 14px;
}
.invisible {
  display: none;
}
.subdue,
.subdue li,
tr.subdue td {
  color: #808080;
}
.bold {
  font-weight: bold;
}
.align-left {
  text-align: left;
}
.align-right {
  text-align: right;
}
.align-center {
  text-align: center;
}
.float-right {
  float: right;
}
.float-left {
  float: left;
}
.sticky {
  position: sticky;
  top: 0;
}
.extended {
  width: 100%;
  box-sizing: border-box;
}
.padded-top {
  padding-top: 20px;
}
.tight {
  margin: 0px;
  padding: 0px;
}
.nowrap {
  white-space: nowrap;
}
.fixed-layout {
  table-layout: fixed;
}
.clip-text {
  text-overflow: ellipsis;
  overflow: hidden;
  white-space: nowrap;
}
.raised {
  background-color: #FFF8DF;
  border: 1px solid #cccccc;
  -moz-box-shadow: 4px 4px 16px 1px rgba(0, 0, 0, 0.25);
  -webkit-box-shadow: 4px 4px 16px 1px rgba(0, 0, 0, 0.25);
  box-shadow: 4px 4px 16px 1px rgba(0, 0, 0, 0.25);
}
ol,
ul {
  padding-left: 40px;
  margin: 10px 0;
}
ol.compact li,
ul.compact li,
ol li.compact,
ul li.compact {
  font-size: 14px;
}
ul.download {
  margin-top: 25px;
}
ul.download li,
ul li.download,
ul.Download li,
ul li.Download {
  background: url("/images/download24.png") no-repeat scroll left center transparent;
  font-weight: bold;
  list-style-type: none;
  margin: 0px 0 6px -40px;
  padding: 0 0 1px 30px;
  vertical-align: middle;
}
.callout {
  margin: 20px 0;
  background-color: #FFFFe1;
  color: #333333;
  border: 1px solid #cccccc;
  padding: 15px;
  border-radius: 3px;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
}
.trace {
  padding: 20px;
  background-color: #eeeeee;
  color: #333333;
  border: 1px solid red;
  font-size: 13px;
}
textarea,
input[type="text"],
input[type="button"],
input[type="submit"] {
  -webkit-appearance: none;
  border-radius: 0;
}
.container-content {
  background-color: white;
  position: relative;
  zoom: 1;
  padding: 0 9px;
  cursor: default;
}
.container-content-wrap {
  margin: auto;
  max-width: 1270px;
}
.container-content pre,
.container-code pre,
.answer pre {
  white-space: pre-wrap;
  /* css-3 */
  white-space: -moz-pre-wrap;
  /* Mozilla, since 1999 */
  white-space: -pre-wrap;
  /* Opera 4-6 */
  white-space: -o-pre-wrap;
  /* Opera 7 */
  word-wrap: break-word;
  /* Internet Explorer 5.5+ */
  _white-space: pre;
  /* IE only hack to re-specify in addition to word-wrap  */
  word-break: break-word;
  -ms-word-break: break-word;
}
.flex-container {
  display: -webkit-box;
  /* OLD - iOS 6-, Safari 3.1-6 */
  display: -moz-box;
  /* OLD - Firefox 19- (buggy but mostly works) */
  display: -ms-flexbox;
  /* TWEENER - IE 10 */
  display: -webkit-flex;
  /* NEW - Chrome */
  display: flex;
  /* NEW, Spec - Opera 12.1, Firefox 20+ */
}
.flex-extend {
  justify-content: space-between;
}
.flex-wrap {
  flex-wrap: wrap;
}
.flex-item {
  -webkit-box-flex: 1;
  /* OLD - iOS 6-, Safari 3.1-6 */
  -moz-box-flex: 1;
  /* OLD - Firefox 19- */
  -webkit-flex: 1;
  /* Chrome */
  -ms-flex: 1;
  /* IE 10 */
  flex: 1;
}

.justify-content-start		{ justify-content: start; }
.justify-content-end		{ justify-content: end; }
.justify-content-center		{ justify-content: center; }
.justify-content-between	{ justify-content: space-between; }
.justify-content-around     { justify-content: space-around}
.flex-wrap          { flex-wrap: wrap; }
.flex-nowrap		{ flex-wrap: nowrap; }

.flex-item-tight {
  flex: 0 1 auto;
}
.hover-container {
  display: block;
  position: relative;
}
.clearfix:after,
.container:after {
  display: block;
  content: '.';
  visibility: hidden;
  height: 0px;
  clear: both;
}
.clearfix,
.container {
  display: inline-block;
  /* Mac IE5 sees this */
  /* Mac IE5 comment hack \*/
  display: block;
  /* Mac IE5 doesn't see this, but everyone else does */
}
.access-link,
.access-link img {
  position: absolute;
  top: 0px;
  left: 0px;
  width: 1px;
  height: 1px;
  z-index: 101;
  border-style: none;
  margin-top: -1px;
  overflow: hidden;
}
.site-top-menu {
  white-space: nowrap;
  position: absolute;
  z-index: 101;
  width: 100%;
}
.site-top-menu .main-content {
  width: 100%;
}
.site-top-menu .main-content .memberbar {
  margin-left: 90px;
  margin-right: 10px;
}
.site-top-menu.fixed .main-content {
  margin: auto;
  max-width: 1270px;
}
.site-header {
  background-image: url('/App_Themes/CodeProject/Img/logo135-bg.gif');
  white-space: nowrap;
  overflow: hidden;
}
.site-header .main-content {
  position: relative;
  overflow: hidden;
  white-space: nowrap;
}
.site-header .logo {
  display: inline-block;
}
.site-header .promo {
  display: inline-block;
  position: absolute;
  top: 33px;
  right: 0;
}
.site-header.fixed .main-content {
  margin: auto;
  max-width: 1270px;
}
.sub-headerbar {
  padding-right: 9px;
  position: relative;
  margin: auto;
  max-width: 1270px;
}
.sub-headerbar-divider {
  margin-left: 10px;
  height: 1px;
  border-bottom: 1px solid #cccccc;
  position: absolute;
  bottom: 2px;
  left: 0px;
  right: 9px;
}
.memberbar {
  height: 25px;
  padding-top: 5px;
  color: #666;
  font-size: 14px;
  font-weight: 500;
}
.memberbar a {
  color: #808080;
  font-size: 14px;
}
div.navbar {
  white-space: nowrap;
}
.navmenu {
  background: white;
  color: #4d4d4d;
  padding: 0px;
  margin: 0px;
  list-style: none;
  height: 25px;
}
.navmenu ul,
.navmenu li {
  margin: 0;
  padding: 0;
}
.navmenu .has-submenu {
  position: absolute;
  right: 5px;
  padding-left: 10px;
}
.navmenu > li:hover > a,
.navmenu > li > a:active {
  border: 1px solid #cccccc;
}
.navmenu ul,
.navmenu > li.open:hover > a,
.navmenu > li.open > a:active {
  border: 1px solid #cccccc;
  border-bottom-color: white;
}
.navmenu > li {
  margin: 0 11px 2px 2px;
}
.navmenu > li:active,
.navmenu > li:active > a,
.navmenu > li:hover,
.navmenu > li > a:active {
  background: white;
  color: #4d4d4d;
}
.navmenu > li.openable > a:active,
.navmenu > li.openable:hover > a {
  /*border-bottom: 1px solid @ColourBack-Menu; */
}
.navmenu > li > a {
  padding: 2px 7px 6px 7px;
  border: 1px solid transparent;
  font-weight: bold;
}
.navmenu a {
  display: block;
  float: left;
  color: #666666;
  background: white;
  font-size: 17px;
  padding: 0px 9px;
  text-decoration: none;
  white-space: nowrap;
}
.navmenu a.fly {
  white-space: nowrap;
}
.navmenu ul {
  background: white;
  position: absolute;
  left: -9999px;
  top: -9999px;
  list-style: none;
}
.navmenu li {
  float: left;
  color: #4d4d4d;
}
.navmenu li.last {
  height: 9px;
}
.navmenu li a:active,
.navmenu li a:hover {
  color: white;
  background-color: #ff9900;
}
.navmenu li > a:active,
.navmenu li:hover,
.navmenu li:hover > a,
.navmenu li:hover.heading,
.navmenu li a.selected {
  position: relative;
  color: white;
  background-color: #ff9900;
}
.navmenu li.openable:hover ul {
  left: 0px;
  top: 30px;
  z-index: 500;
}
.navmenu li.openable:hover > ul ul {
  position: absolute;
  left: -9999px;
  top: -9999px;
  width: auto;
}
.navmenu li ul {
  border-bottom: 5px solid #ff9900;
}
.navmenu li li {
  float: none;
}
.navmenu li li a {
  float: none;
  font-size: 16px;
  font-weight: normal;
}
.navmenu li li a.fly {
  color: #4d4d4d;
  background-color: white;
  padding: 2px 20px;
}
.navmenu li li a.break {
  margin-bottom: 15px;
}
.navmenu li li a.highlight1,
.navmenu li li a.highlight1:active,
.navmenu li li a.highlight1:hover {
  background-color: #009900;
}
.navmenu li li a.highlight2,
.navmenu li li a.highlight2:active,
.navmenu li li a.highlight2:hover {
  background-color: #ff9900;
}
.navmenu li li a.highlight3,
.navmenu li li a.highlight3:active,
.navmenu li li a.highlight3:hover {
  background-color: #000000;
}
.navmenu li li a.highlight1,
.navmenu li li a.highlight2,
.navmenu li li a.highlight3 {
  color: white;
  font-size: 16px;
  margin: 5px 0;
  padding: 9px 20px;
}
.site-footer {
  display: -webkit-box;
  /* OLD - iOS 6-, Safari 3.1-6 */
  display: -moz-box;
  /* OLD - Firefox 19- (buggy but mostly works) */
  display: -ms-flexbox;
  /* TWEENER - IE 10 */
  display: -webkit-flex;
  /* NEW - Chrome */
  display: flex;
  /* NEW, Spec - Opera 12.1, Firefox 20+ */
  padding-top: 5px;
  width: 100%;
  font-size: 13px;
  color: #999999;
}
.site-footer .align-left,
.site-footer .align-center,
.site-footer .align-right {
  -webkit-box-flex: 1;
  /* OLD - iOS 6-, Safari 3.1-6 */
  -moz-box-flex: 1;
  /* OLD - Firefox 19- */
  -webkit-flex: 1;
  /* Chrome */
  -ms-flex: 1;
  /* IE 10 */
  flex: 1;
}
.site-footer .align-left {
  flex: 1 0 100px;
}
.site-footer .align-center {
  flex: 0 1 0%;
  white-space: nowrap;
}
.site-footer .align-right {
  flex: 1 0 100px;
}
.site-footer .page-width .active {
  border-bottom: 2px solid #ff9900;
}
.searchbar {
  padding: 0;
}
.searchbar .search {
  margin-bottom: 4px;
  padding: 2px 5px 0px;
  border: 1px solid #cccccc;
}
.searchbar .search.subdue {
  color: #cccccc;
}
.searchbar input.search {
  width: 190px;
  border: none;
  font-size: 13px;
  padding: 4px 2px;
}
.searchbar .search-advanced {
  padding: 8px;
  width: 203px;
  z-index: 1000;
  background-color: white;
  border: solid 1px #cccccc;
  position: absolute;
  top: -4px;
  right: 0px;
}
.searchbar .popup {
  display: none;
}
.sub-headerbar .searchbar {
  /*
	.search-advanced
	{
        .transition(width, .1s, linear);

        &.open
        {
    		width: 320px;
        }
    }
    */
}
.sub-headerbar .searchbar input.search {
  /*
        &:focus,&:active
        {
            position     : absolute;
            top          : 3px;
            right        : 36px;
            height       : 19px;
            border       : 1px solid #ccc;
            border-right : none;
            width:         300px;

            .transition(width, .1s, linear);
        }
        */
}
.search td {
  background-color: white;
}
.article-container-parts {
  display: -webkit-box;
  /* OLD - iOS 6-, Safari 3.1-6 */
  display: -moz-box;
  /* OLD - Firefox 19- (buggy but mostly works) */
  display: -ms-flexbox;
  /* TWEENER - IE 10 */
  display: -webkit-flex;
  /* NEW - Chrome */
  display: flex;
  /* NEW, Spec - Opera 12.1, Firefox 20+ */
}
.article-container {
  -webkit-box-flex: 1;
  /* OLD - iOS 6-, Safari 3.1-6 */
  -moz-box-flex: 1;
  /* OLD - Firefox 19- */
  -webkit-flex: 1;
  /* Chrome */
  -ms-flex: 1;
  /* IE 10 */
  flex: 1;
  background-color: white;
  color: #111111;
  zoom: 1;
  position: relative;
  max-width: 100%;
  min-height: 675px;
}
.article-container .article {
  margin: 0 20px 0 10px;
  line-height: 143%;
}
.article-container span.stats {
  margin-left: 30px;
}
.article-left-sidebar {
  width: 120px;
  min-width: 120px;
  min-height: 400px;
  font-size: 14px;
  border-right: 1px solid #f2f2f2;
  padding: 0;
  /* Old school style */
  /*
    .license {
        font-weight: bold;
        display: inline-block;
        margin-top: 10px;
    }
    */
}
.article-left-sidebar .article-left-sidebar-inner {
  width: 120px;
  min-width: 120px;
}
.article-left-sidebar .tabs > div {
  padding: 5px 0 5px 10px;
}
.article-left-sidebar .selected {
  font-weight: bold;
  background: transparent url("/images/right-selected.gif") no-repeat scroll right 9px;
}
.article-left-sidebar h4 {
  color: #ff9900;
  font-size: 14px;
  font-weight: bold;
}
.article-left-sidebar .stats div div div {
  padding: 0px 0 10px 10px;
  color: #666666;
}
.article-right-sidebar {
  width: 300px;
  margin-left: 10px;
  font-size: 14px;
}
.article-right-sidebar .header {
  font-size: 22px;
  color: white;
  background-color: #ff9900;
  padding: 8px;
  font-weight: 400;
  margin: 0;
}
.article-right-sidebar .reading-list-toc {
  max-height: 250px;
  overflow-y: auto;
  padding-right: 6px;
  margin-top: 5px;
}
.article-right-sidebar .reading-list-toc .count {
  font-weight: normal;
  font-size: 13px;
}
.article-right-sidebar .reading-list-toc .title {
  font-size: 16px;
}
.article-right-sidebar .content-list-item {
  display: -webkit-box;
  /* OLD - iOS 6-, Safari 3.1-6 */
  display: -moz-box;
  /* OLD - Firefox 19- (buggy but mostly works) */
  display: -ms-flexbox;
  /* TWEENER - IE 10 */
  display: -webkit-flex;
  /* NEW - Chrome */
  display: flex;
  /* NEW, Spec - Opera 12.1, Firefox 20+ */
  justify-content: space-between;
  font-size: 14px;
  margin: 4px 0;
}
.article-right-sidebar .content-list-item .count {
  width: 15%;
  padding: 0px;
}
.article-right-sidebar .content-list-item .title {
  width: 85%;
  font-weight: normal;
}
.article-right-sidebar .gototop {
  text-align: center;
  padding: 10px 0;
  opacity: 0;
  -webkit-transition: opacity 0.3s linear 0ms;
  -moz-transition: opacity 0.3s linear 0ms;
  -o-transition: opacity 0.3s linear 0ms;
  transition: opacity 0.3s linear 0ms;
}
.container-content .edit-links {
  margin: 21px 0 0 10px;
}
.article-summary {
  padding: 0px 10px 0px 10px;
  overflow: hidden;
}
.article h1 {
  margin: 0 0 15px 0;
}
.article h2 {
  color: #ff9900;
}
.article pre {
  overflow: auto;
}
.article .header .title {
  color: #808080;
}
.article .header .author {
  font-weight: bold;
  min-width: 100px;
}
.article .header .author a {
  color: #808080;
}
.article .header .avatar {
  max-width: 48px;
  max-height: 48px;
  overflow: unset;
}
.article .header .avatar-wrap {
  width: 48px;
  height: 48px;
  margin-right: 10px;
  text-align: center;
}
.article .header .date {
  white-space: nowrap;
}
.article .header .license {
  margin-left: 15px;
}
.article .header .stats {
  margin-left: 30px;
}
.article img.lazyload,
.article img.lazyloading {
  opacity: 0;
}
.article img.lazyloaded {
  opacity: 1;
  transition: opacity 300ms;
}
.article .summary {
  color: #808080;
  padding: 40px 0 15px 0;
}
.article .text {
  padding-top: 10px;
}
.article .reading-list-nav {
  border-top: 1px #dedede solid;
  border-bottom: 1px #dedede solid;
  padding: 10px 0;
}
.article .reading-list-nav .prev {
  padding-left: 20px;
}
.article .reading-list-nav .next {
  margin-left: 5px;
  padding-right: 20px;
  text-align: right;
}
.article-nav {
  text-align: right;
  margin-top: 21px;
  vertical-align: middle;
  line-height: 15px;
}
.msg-728x90 {
  width: 728px;
  height: 90px;
  overflow: hidden;
}
.msg-300x250 {
  width: 300px;
  height: 250px;
  overflow: hidden;
}
.content-list {
  margin-bottom: 17px;
}
.content-list .count {
  font-weight: bold;
  font-size: 16px;
  color: #ff9900;
  padding: 3px;
  text-align: center;
}
.content-list-item {
  margin: 10px 0;
}
.content-list-item .title {
  font-size: 14px;
  font-weight: bold;
  padding: 0px 0;
}
.content-list-item .title a {
  color: #005782;
}
.tags {
  line-height: 190%;
}
.tags .t {
  background: none repeat scroll 0 0 transparent;
  border: 1px solid #FBEDBB;
  border-radius: 12px 0 0 12px;
  line-height: 1.4;
  padding: 0 2px 2px 3px;
  position: relative;
  text-decoration: none;
  margin: 2px 5px 4px 0;
  white-space: nowrap;
}
.tags .t a {
  color: #666666;
  display: inline-block;
  margin-right: 3px;
  padding-left: 5px;
  text-overflow: ellipsis;
}
.container-breadcrumb {
  font-size: 14px;
  margin-top: 7px;
  color: #808080;
  margin: 12px 0 35px;
}
.container-breadcrumb a {
  color: #808080;
}
.pre-lang {
  display: -webkit-box;
  /* OLD - iOS 6-, Safari 3.1-6 */
  display: -moz-box;
  /* OLD - Firefox 19- (buggy but mostly works) */
  display: -ms-flexbox;
  /* TWEENER - IE 10 */
  display: -webkit-flex;
  /* NEW - Chrome */
  display: flex;
  /* NEW, Spec - Opera 12.1, Firefox 20+ */
  background-color: #FBEDBB;
  justify-content: space-between;
  padding: 4px 8px;
  margin-top: 5px;
  color: #999999;
  border-bottom: solid 1px #ffd044;
}
.code-comment {
  color: #008000;
  font-style: italic;
}
.code-keyword {
  color: Blue;
}
.code-sdkkeyword {
  color: #339999;
}
.code-string {
  color: Purple;
}
.code-attribute {
  color: red;
}
.code-leadattribute {
  color: #800000;
}
.pre-action-link {
  font-size: 13px;
  color: #999999;
}
.pre-action-link span {
  cursor: pointer;
  margin: 0;
  -webkit-transition: color 0.1s linear;
  -moz-transition: color 0.1s linear;
  -o-transition: color 0.1s linear;
  transition: color 0.1s linear;
}
.speech-bubble-container-down,
.speech-bubble-container-up,
.speech-bubble-container-up-right,
.speech-bubble-container-left,
.speech-bubble-container-right {
  position: relative;
}
.speech-bubble-up,
.speech-bubble-down,
.speech-bubble-left,
.speech-bubble-right,
.speech-bubble-up-right {
  padding: 0.6em;
  border: 1px solid #cccccc;
  background-color: white;
  margin: 15px;
  text-decoration: none;
  font-weight: normal;
  text-align: left;
  white-space: normal;
  color: #333333;
  font-size: 14px;
  line-height: 1.3;
}
.speech-bubble-down {
  margin-bottom: 0px;
}
.tooltip .speech-bubble-up,
.tooltip .speech-bubble-up-right,
.tooltip .speech-bubble-down,
.tooltip .speech-bubble-left,
.tooltip .speech-bubble-right {
  -moz-box-shadow: 4px 4px 16px 1px rgba(0, 0, 0, 0.25);
  -webkit-box-shadow: 4px 4px 16px 1px rgba(0, 0, 0, 0.25);
  box-shadow: 4px 4px 16px 1px rgba(0, 0, 0, 0.25);
  border-radius: 5px;
  -webkit-border-radius: 5px;
  -moz-border-radius: 5px;
  min-width: 75px;
}
.speech-bubble-pointer-down,
.speech-bubble-pointer-down-inner {
  width: 0;
  height: 0;
  border-bottom-width: 0;
  background: none;
}
.speech-bubble-pointer-down {
  border-left: 7px solid transparent;
  border-right: 7px solid transparent;
  border-top: 1px solid #cccccc;
  border-top-width: 14px;
  margin-left: 35px;
  margin-bottom: 15px;
  _display: none;
}
.speech-bubble-pointer-up,
.speech-bubble-pointer-up-right,
.speech-bubble-pointer-up-inner,
.speech-bubble-pointer-up-right-inner {
  width: 0;
  height: 0;
  border-top-width: 0;
  background: none;
}
.speech-bubble-pointer-up,
.speech-bubble-pointer-up-right {
  border-left: 5px solid transparent;
  border-right: 5px solid transparent;
  border-bottom: 1px solid #cccccc;
  border-bottom-width: 14px;
  margin-left: 35px;
  position: absolute;
  top: -12px;
  _display: none;
}
.speech-bubble-container-up-right .speech-bubble-pointer-up-right {
  margin-left: 0;
  margin-right: 0px;
  right: 35px;
}
.tooltip {
  position: relative;
  text-decoration: none;
}
.tooltip .speech-bubble-container-up,
.tooltip .speech-bubble-container-down,
.tooltip .speech-bubble-container-left,
.tooltip .speech-bubble-container-right,
.tooltip .speech-bubble-container-up-right,
.tooltip .tooltip-flyout {
  display: none;
  opacity: 0;
  -webkit-transition: opacity 0.5s linear 0ms;
  -moz-transition: opacity 0.5s linear 0ms;
  -o-transition: opacity 0.5s linear 0ms;
  transition: opacity 0.5s linear 0ms;
}
.micromodal {
  display: none;
}
.micromodal .modal__overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  background: rgba(0, 0, 0, 0.65);
  z-index: 1000;
}
.micromodal .modal__container {
  box-sizing: border-box;
  overflow-y: auto;
  max-width: 500px;
  max-height: 100vh;
  padding: 30px;
  background-color: #fff;
  border-radius: 4px;
}
.micromodal .modal__container,
.micromodal .modal__overlay {
  will-change: transform;
}
.micromodal .modal_header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
}
.micromodal .modal_title {
  margin-top: 0;
  margin-bottom: 0;
  color: #ff9900;
  box-sizing: border-box;
}
.bottom-promo {
  height: 90px;
  margin-top: 10px;
  overflow: hidden;
}
.bottom-promo .msg-728x90 {
  width: 728px;
  margin: 0 auto;
}
.msg-728x90 {
  overflow: hidden;
  position: relative;
  height: 90px;
  min-width: 728px;
}
body .msg-728x90 {
  *float: right;
}
body .bottom-promo .msg-728x90 {
  *float: none;
}
table.forum {
  table-layout: fixed;
  margin: 0 0 20px 0;
  padding: 0px;
  width: 100%;
}
.forum {
  /*
    .indent
    {
        padding-left:5px; padding-right: 5px;
    }
    */
}
.forum table {
  border-collapse: separate;
}
.forum .header1,
.forum .header1 TD {
  color: #333333;
  font-size: 14px;
  vertical-align: middle;
}
.forum .header2,
.forum .header2 TD {
  color: white;
  background-color: #ff9900;
  font-size: 14px;
  vertical-align: middle;
}
.forum .header2 input,
.forum .header2 TD input,
.forum .header2 select,
.forum .header2 TD select {
  padding: 2px;
}
.forum .button {
  border: 1px solid #FFCC66;
  margin: 1px;
}
.forum .searchbar {
  border: 1px solid #cccccc;
  padding: 4px 0 0 0;
  margin: 3px 0;
}
.forum .searchbar .search {
  width: 200px;
}
.forum .searchbar input[type=image] {
  vertical-align: middle;
}
.forum .dropdown {
  background-color: #fffdfa;
  font-size: 95%;
  margin-left: 5px;
}
.forum .footer,
.forum .footer td,
.forum .navbar,
.forum .navbar td {
  font-size: 14px;
  padding: 8px 0;
  border: 0;
  border-top: 1px solid #808080;
}
.author-wrapper {
  position: relative;
}
.author-wrapper .profile-pic {
  border: 1px solid #333;
  margin: 0 13px 0 0;
  padding: 10px;
  -moz-box-shadow: 3px 3px 5px 1px rgba(0, 0, 0, 0.2);
  -webkit-box-shadow: 3px 3px 5px 1px rgba(0, 0, 0, 0.2);
  box-shadow: 3px 3px 5px 1px rgba(0, 0, 0, 0.2);
  max-height: 100px;
}
.author-wrapper .container-member .author {
  font-size: 29px;
  color: #333333;
  font-weight: 600;
}
.member-signin .forgot {
  padding: 0;
}
.member-signin a.forgot {
  color: #808080;
}
.rating-container {
  /*
	.rating-close
	{
		font-size       : @FontSize-MediumSmall;
		font-weight     : bold;
		// display         : inline-block;
		// height          : 19px;
		padding         : 0px 7px 3px 5px;
		text-decoration : none;
		border          : 1px solid transparent;
		position        : absolute;
		right           : 1px;
		top             : -1px;
		
		&:hover { border : 1px solid @Colour-Theme1; }
	}*/
}
.rating-container .rating-prompt {
  padding-right: 5px;
  white-space: nowrap;
  line-height: 25px;
  margin-right: 2px;
  font-weight: bold;
  color: #808080;
}
.rating-container .rating-votes {
  margin-left: 5px;
}
.rating-container.large-stars,
.rating-container.medium-stars,
.rating-container.small-stars {
  margin-left: 7px;
}
.rating-container.large-stars .rating-votes,
.rating-container.large-stars .rating-prompt,
.rating-container.large-stars .rating-poor,
.rating-container.large-stars .rating-good {
  line-height: 25px;
}
.tags.horizontal .t {
    display: inline-block;
}
@media (min-width: 1024px) {
    .desktop-only {
        display: inherit;
    }

    .tablet-only,
    .tablet-block-only {
        display: none;
    }

    .mobile-only,
    .mobile-block-only {
        display: none;
    }

    .desktop-only.tablet-only {
        display: inherit;
    }

    @media (min-width: 821px) {
        .tablet-only,
        .mobile-only {
            display: none;
        }

            .tablet-only.desktop-only {
                display: inherit;
            }

        .rrssb-buttons,
        .rrssb-buttons li,
        .rrssb-buttons li a {
            -moz-box-sizing: border-box;
            box-sizing: border-box;
        }

        .clearfix {
            *zoom: 1;
        }

            .clearfix:after {
                clear: both;
            }

            .clearfix:before,
            .clearfix:after {
                content: " ";
                display: table;
            }

        .rrssb-buttons {
            font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
            height: 40px;
            margin: 0;
            padding: 0;
            width: 100%;
        }

            .rrssb-buttons li {
                float: left;
                height: 100%;
                list-style: none;
                margin: 0;
                padding: 0 2.5px;
                line-height: 13px;
            }

                .rrssb-buttons li.email a {
                    background-color: #0a88ff;
                }

                .rrssb-buttons li.facebook a {
                    background-color: #306199;
                }

                .rrssb-buttons li.linkedin a {
                    background-color: #007bb6;
                }

                .rrssb-buttons li.twitter a {
                    background-color: #26c4f1;
                }

                .rrssb-buttons li.reddit a {
                    background-color: #8bbbe3;
                }

                .rrssb-buttons li.pinterest a {
                    background-color: #b81621;
                }

                .rrssb-buttons li.compact {
                    padding: 0 4.5px;
                }

                    .rrssb-buttons li.compact a {
                        border-radius: 50%;
                        padding: 0px 7px 0 32px;
                    }

                        .rrssb-buttons li.compact a .icon {
                            left: 7px;
                            top: -3px;
                            width: 5%;
                            transform: scale(0.85);
                        }

                            .rrssb-buttons li.compact a .icon svg {
                                height: auto;
                                width: auto;
                            }

                .rrssb-buttons li a {
                    background-color: #ccc;
                    border-radius: 3px;
                    display: block;
                    font-size: 11px;
                    font-weight: bold;
                    height: 100%;
                    padding: 11px 7px 12px 27px;
                    position: relative;
                    text-align: center;
                    text-decoration: none;
                    text-transform: uppercase;
                    -webkit-font-smoothing: antialiased;
                    -moz-osx-font-smoothing: grayscale;
                    width: 100%;
                    -webkit-transition: background-color 0.2s ease-in-out;
                    -moz-transition: background-color 0.2s ease-in-out;
                    -o-transition: background-color 0.2s ease-in-out;
                    transition: background-color 0.2s ease-in-out;
                }

                    .rrssb-buttons li a .icon {
                        display: block;
                        height: 100%;
                        left: 10px;
                        padding-top: 9px;
                        position: absolute;
                        top: 0;
                        width: 10%;
                    }

                        .rrssb-buttons li a .icon svg {
                            height: 17px;
                            width: 17px;
                        }

                            .rrssb-buttons li a .icon svg path,
                            .rrssb-buttons li a .icon svg polygon {
                                fill: #fff;
                            }

        .cc-window {
            opacity: 1;
            background-color: #ff9900;
            /*
  -webkit-transition: opacity .25s ease;
  -moz-transition: opacity .25s ease;
  -ms-transition: opacity .25s ease;
  -o-transition: opacity .25s ease;
  transition: opacity .25s ease;
  */
        }

            .cc-window.cc-invisible {
                opacity: 0;
            }

        .cc-animate.cc-revoke {
            /*
  -webkit-transition: transform .25s ease;
  -moz-transition: transform .25s ease;
  -ms-transition: transform .25s ease;
  -o-transition: transform .25s ease;
  transition: transform .25s ease;
  */
        }

            .cc-animate.cc-revoke.cc-bottom {
                transform: translateY(2em);
            }

        .cc-window,
        .cc-revoke {
            position: fixed;
            overflow: hidden;
            box-sizing: border-box;
            /* exclude padding when dealing with width */
            font-family: "Segoe UI", Arial, Sans-Serif;
            font-size: 13px;
            /* by setting the base font here, we can size the rest of the popup using CSS `em` */
            line-height: 1.5em;
            display: flex;
            flex-wrap: nowrap;
            /* the following are random unjustified styles - just because - should probably be removed */
            z-index: 9999;
        }

            .cc-window.cc-banner {
                padding: 0.7em 1.8em;
                width: 100%;
                flex-direction: row;
            }

        .cc-revoke {
            padding: 0.5em;
        }

        .cc-btn,
        .cc-link,
        .cc-close,
        .cc-revoke {
            cursor: pointer;
        }

        .cc-link {
            opacity: 0.8;
            display: inline-block;
            padding: 0.2em;
            text-decoration: underline;
        }

            .cc-link:active,
            .cc-link:visited {
                color: initial;
            }

        .cc-btn {
            display: block;
            padding: 0.4em 0.8em;
            font-size: 0.9em;
            font-weight: bold;
            border-width: 2px;
            border-style: solid;
            text-align: center;
            white-space: nowrap;
        }

        .cc-banner .cc-btn:last-child {
            min-width: 110px;
            margin-left: 10px;
        }

        .cc-highlight .cc-btn:first-child {
            background-color: transparent;
            border-color: transparent;
        }

        .cc-revoke.cc-bottom {
            bottom: 0;
            left: 3em;
            border-top-left-radius: 0.5em;
            border-top-right-radius: 0.5em;
        }

        .cc-bottom {
            bottom: 1em;
        }

        .cc-window.cc-banner {
            align-items: center;
        }

        .cc-banner.cc-bottom {
            left: 0;
            right: 0;
            bottom: 0;
        }

        .cc-banner .cc-message {
            flex: 1;
        }

        .cc-compliance {
            display: flex;
            align-items: center;
            align-content: space-between;
        }

            .cc-compliance > .cc-btn {
                flex: 1;
            }

        .cc-btn + .cc-btn {
            margin-left: 0.5em;
        }

</style>
<link rel="stylesheet" type="text/css" href="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Css/Article.min.css?dt=2.8:2024-06-13:1" media="all" onload="if(media!=&quot;all&quot;)media=&quot;all&quot;">
<noscript><link rel='stylesheet' type='text/css' href='https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Css/Article.min.css?dt=2.8:2024-06-13:1'></noscript>



    <script type="text/javascript" src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js" defer=""></script>
<script type="text/javascript" src="https://codeproject.freetls.fastly.net/script/Articles/JS/article.min.js?dt=2.8:2024-06-13:1" defer=""></script>
<script type="text/javascript" src="https://accounts.google.com/gsi/client" defer="" async=""></script>
<script type="text/javascript" src="/script/JS/advertisement.min.js" defer=""></script>
<script type="text/javascript" src="/script/Membership/JS/MemberProfilePopup.min.js?v=1.4" defer=""></script>
<script type="text/javascript" src="/a.min.js?v=1.3" defer=""></script>

	
<meta http-equiv="content-language" content="en-US">
<meta charset="UTF-8">
<meta name="Description" content="Learn how to convert any code to a stable shellcode using Visual Studio 2019 and VC++ in easy steps!">
<meta name="Keywords" content="C, Advanced, security, VC++, C++17, VS2019">
<meta name="Author" content="The Ænema">
<meta name="Rating" content="General">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">

<link rel="dns-prefetch" href="//ajax.googleapis.com"> 
<link rel="canonical" href="https://www.codeproject.com/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@CodeProject">
<meta name="og:site_name" content="CodeProject">
<meta name="twitter:creator" content="@CodeProject">
<meta property="og:type" content="article">
<meta property="article:published_time" content="6/7/2021 12:28:00 AM">
<meta property="article:modified_time" content="6/7/2021 6:14:00 AM">
<meta name="twitter:label1" content="Written by">
<meta name="twitter:data1" content="The Ænema">
<meta name="twitter:label2" content="Reading time">
<meta name="twitter:data2" content="9 min read">
<meta property="og:url" content="https://www.codeproject.com/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud">
<meta property="og:title" content="Creating Shellcode from any Code Using Visual Studio and C++">
<meta property="og:description" content="Learn how to convert any code to a stable shellcode using Visual Studio 2019 and VC++ in easy steps!">
<meta property="og:image" content="https://www.codeproject.com/KB/Articles/5304605/Thumbnail.png">
<meta name="twitter:image" content="https://www.codeproject.com/KB/Articles/5304605/Thumbnail.png">

<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - All Topics" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=1">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - Python" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=34">
<link rel="alternate" type="application/rss+xml" title="CodeProject Lounge Postings" href="https://www.codeproject.com/webservices/LoungeRSS.aspx">
<meta name="robots" content="index, follow">

<link rel="search" type="application/opensearchdescription+xml" title="CodeProject" href="https://www.codeproject.com/info/OpenSearch.xml">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="apple-touch-icon" sizes="144x144" href="/favicon/apple-touch-icon.png"> 
<link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"> 
<link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"> 
<link rel="manifest" href="/favicon/manifest.json"> 
<link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#ff9900">
	<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.codeproject.com/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud"
   },
  "name": "Creating Shellcode from any Code Using Visual Studio and C++",
  "headline": "Creating Shellcode from any Code Using Visual Studio and C++",
  "url": "https://www.codeproject.com/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud",
  "discussionUrl": "https://www.codeproject.com/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud#_comments",
  "isFamilyFriendly": "true",
  "image": "https://www.codeproject.com/KB/Articles/5304605/Thumbnail.png",
  "keywords": "C,Advanced,security,VC++,C++17,VS2019",
  "commentCount": "36",
  "editor" : {
    "@type" : "Person",
    "name" : "Deeksha Shenoy",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=3866010"
  },
  "license": "http://www.codeproject.com/info/cpol10.aspx",
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  },
  "description": "In this tutorial, we use Visual Studio 2019 and C++ to generate independent x64 machine code that can be used as shellcode, This operation needs extreme skills, but with this tutorial, you can generate your shellcode very easily...",
  "author" : [{
      "@type" : "Person",
      "name" : "The Ænema",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=13742737"
    }],
  "datePublished": "2021-06-07",
  "dateCreated": "2021-06-07",
  "dateModified": "2021-06-07"
,
  "contentRating" : {
    "@type" : "Rating",
    "ratingValue" : 4.91,
    "bestRating" : 5,
    "worstRating" : 1
  }
}</script>

<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item" : {
      "@id" : "/script/Content/Tag.aspx?tags=security",
      "name" : "Security"
    }
  }]
}</script>


	<base target="_top">
	
    


<script type="text/javascript">
function defrm () { /* thanks twitter */
    document.write = '';
    window.top.location = window.self.location;
    setTimeout(function() { document.body.innerHTML = ''; }, 0);
    window.self.onload = function(evt) { document.body.innerHTML = ''; };
}

if (window.top !== window.self) {
    try {
        if (window.top.location.host) { /* will throw for all except chrome */ }
        else { defrm(); /* chrome */ }
    } catch (ex) { defrm(); /* everyone else */ }
}

// Specific case where a site is screwing with us.
if (typeof(DemoUrl) !== 'undefined') {
    document.write(unescape('%3Cme') + 'ta http' + '-equiv="re' + 'fresh con' +
                           'tent="1;url=' + DemoUrl + unescape('"%3CE'));
}
</script>
	





    <script async="" type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-YZNPNQ0F2S"></script>
    <script type="text/javascript">
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-YZNPNQ0F2S' );
    </script>

<link id="googleidentityservice" type="text/css" media="all" rel="stylesheet" href="https://accounts.google.com/gsi/style"><style id="googleidentityservice_button_styles">.qJTHM{-moz-user-select:none;color:#202124;direction:ltr;font-family:"Roboto-Regular",arial,sans-serif;font-weight:400;margin:0;overflow:hidden}.ynRLnc{left:-9999px;position:absolute;top:-9999px}.L6cTce{display:none}.bltWBb{word-break:break-all}.hSRGPd{color:#1a73e8;cursor:pointer;font-weight:500;text-decoration:none}.Bz112c-W3lGp{height:16px;width:16px}.Bz112c-E3DyYd{height:20px;width:20px}.Bz112c-r9oPif{height:24px;width:24px}.Bz112c-uaxL4e{-moz-border-radius:10px;border-radius:10px}.LgbsSe-Bz112c{display:block}.S9gUrf-YoZ4jf,.S9gUrf-YoZ4jf *{border:none;margin:0;padding:0}.fFW7wc-ibnC6b>.aZ2wEe>div{border-color:#4285f4}.P1ekSe-ZMv3u>div:nth-child(1){background-color:#1a73e8!important}.P1ekSe-ZMv3u>div:nth-child(2),.P1ekSe-ZMv3u>div:nth-child(3){background-image:linear-gradient(to right,rgba(255,255,255,.7),rgba(255,255,255,.7)),linear-gradient(to right,#1a73e8,#1a73e8)!important}.haAclf{display:inline-block}.nsm7Bb-HzV7m-LgbsSe{border-radius:4px;box-sizing:border-box;transition:background-color .218s,border-color .218s;-moz-user-select:none;background-color:#fff;background-image:none;border:1px solid #dadce0;color:#3c4043;cursor:pointer;font-family:"Google Sans",arial,sans-serif;font-size:14px;height:40px;letter-spacing:0.25px;outline:none;overflow:hidden;padding:0 12px;position:relative;text-align:center;vertical-align:middle;white-space:nowrap;width:auto}@media screen and (-ms-high-contrast:active){.nsm7Bb-HzV7m-LgbsSe{border:2px solid windowText;color:windowText}}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe{font-size:14px;height:32px;letter-spacing:0.25px;padding:0 10px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe{font-size:11px;height:20px;letter-spacing:0.3px;padding:0 8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe{padding:0;width:40px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe{width:32px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe{width:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK{border-radius:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.pSzOP-SxQuSe{border-radius:16px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.purZT-SxQuSe{border-radius:10px}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc{border:none;color:#fff}.nsm7Bb-HzV7m-LgbsSe.MFS4be-v3pZbf-Ia7Qfc{background-color:#1a73e8}.nsm7Bb-HzV7m-LgbsSe.MFS4be-JaPV2b-Ia7Qfc{background-color:#202124;color:#e8eaed}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:18px;margin-right:8px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:14px;min-width:14px;width:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:10px;min-width:10px;width:10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin-left:8px;margin-right:-4px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:10px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:4px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-top-left-radius:3px;border-bottom-left-radius:3px;display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;justify-content:center;align-items:center;background-color:#fff;height:36px;margin-left:-10px;margin-right:12px;min-width:36px;width:36px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c,.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:28px;margin-left:-8px;margin-right:10px;min-width:28px;width:28px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:16px;margin-left:-6px;margin-right:8px;min-width:16px;width:16px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:3px;margin-left:2px;margin-right:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:8px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-bN97Pc-sM5MNb{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;align-items:center;flex-direction:row;justify-content:space-between;flex-wrap:nowrap;height:100%;position:relative;width:100%}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX{justify-content:center}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{flex-grow:1;font-family:"Google Sans",arial,sans-serif;font-weight:500;overflow:hidden;text-overflow:ellipsis;vertical-align:top}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-weight:300}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX .nsm7Bb-HzV7m-LgbsSe-BPrWId{flex-grow:0}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-MJoBVe{transition:background-color .218s;bottom:0;left:0;position:absolute;right:0;top:0}.nsm7Bb-HzV7m-LgbsSe:hover,.nsm7Bb-HzV7m-LgbsSe:focus{box-shadow:none;border-color:#d2e3fc;outline:none}.nsm7Bb-HzV7m-LgbsSe:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.04)}.nsm7Bb-HzV7m-LgbsSe:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.1)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.24)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.32)}.nsm7Bb-HzV7m-LgbsSe .n1UuX-DkfjY{border-radius:50%;display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;height:20px;margin-left:-4px;margin-right:8px;min-width:20px;width:20px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-family:"Roboto";font-size:12px;text-align:left}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .ssJRIf,.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .fmcmS{overflow:hidden;text-overflow:ellipsis}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;align-items:center;color:#5f6368;fill:#5f6368;font-size:11px;font-weight:400}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.MFS4be-Ia7Qfc .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{color:#e8eaed;fill:#e8eaed}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .Bz112c{height:18px;margin:-3px -3px -3px 2px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-top-left-radius:0;border-bottom-left-radius:0;border-top-right-radius:3px;border-bottom-right-radius:3px;margin-left:12px;margin-right:-10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:18px}.L5Fo6c-sM5MNb{border:0;display:block;left:0;position:relative;top:0}.L5Fo6c-bF1uUb{-moz-border-radius:4px;border-radius:4px;bottom:0;cursor:pointer;left:0;position:absolute;right:0;top:0}.L5Fo6c-bF1uUb:focus{border:none;outline:none}sentinel{}</style><style type="text/css"></style><style></style><meta http-equiv="origin-trial" content="AlK2UR5SkAlj8jjdEc9p3F3xuFYlF6LYjAML3EOqw1g26eCwWPjdmecULvBH5MVPoqKYrOfPhYVL71xAXI1IBQoAAAB8eyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3NTgwNjcxOTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="Amm8/NmvvQfhwCib6I7ZsmUxiSCfOxWxHayJwyU1r3gRIItzr7bNQid6O8ZYaE1GSQTa69WwhPC9flq/oYkRBwsAAACCeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3NTgwNjcxOTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="A/ERL66fN363FkXxgDc6F1+ucRUkAhjEca9W3la6xaLnD2Y1lABsqmdaJmPNaUKPKVBRpyMKEhXYl7rSvrQw+AkAAACNeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiRmxlZGdlQmlkZGluZ0FuZEF1Y3Rpb25TZXJ2ZXIiLCJleHBpcnkiOjE3MTkzNTk5OTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="A6OdGH3fVf4eKRDbXb4thXA4InNqDJDRhZ8U533U/roYjp4Yau0T3YSuc63vmAs/8ga1cD0E3A7LEq6AXk1uXgsAAACTeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiRmxlZGdlQmlkZGluZ0FuZEF1Y3Rpb25TZXJ2ZXIiLCJleHBpcnkiOjE3MTkzNTk5OTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><script src="https://securepubads.g.doubleclick.net/pagead/managed/js/gpt/m202406110101/pubads_impl.js" async=""></script><script async="" src="https://fundingchoicesmessages.google.com/i/6839?ers=3"></script><script async="" src="https://fundingchoicesmessages.google.com/f/AGSKWxWzNc89BmhK4T_DOfdSikQU4fKF8SzZCQX28156gJ5br85PxVtkvlAcf1HM-nMX_Q-_3HbdTiEfqK3M1TmN71QAttuSeWI0oboqQdQo3yAh29jgspu12d5nwxkZIQ0FDzM80Nagsg==?fccs=W251bGwsbnVsbCxudWxsLG51bGwsbnVsbCxudWxsLFsxNzE4NDUzNTQ0LDMyMTAwMDAwMF0sbnVsbCxudWxsLG51bGwsW251bGwsWzddXSwiaHR0cHM6Ly93d3cuY29kZXByb2plY3QuY29tL0FydGljbGVzLzUzMDQ2MDUvQ3JlYXRpbmctU2hlbGxjb2RlLWZyb20tYW55LUNvZGUtVXNpbmctVmlzdWFsLVN0dWQiLG51bGwsW1s4LCJrYnZLZUljcUx5VSJdLFs5LCJwbCJdLFsxOSwiMSJdLFsxNywiWzBdIl1dXQ"></script><style>@font-face {
  font-family: 'Material Icons';
  font-style: normal;
  font-weight: 400;
  font-display: block;
  src: url(//fonts.gstatic.com/s/materialicons/v142/flUhRq6tzZclQEJ-Vdg-IuiaDsNc.woff2) format('woff2');
}

.material-icons {
  font-family: 'Material Icons';
  font-weight: normal;
  font-style: normal;
  font-size: 24px;
  line-height: 1;
  letter-spacing: normal;
  text-transform: none;
  display: inline-block;
  white-space: nowrap;
  word-wrap: normal;
  direction: ltr;
  -moz-font-feature-settings: 'liga';
  -moz-osx-font-smoothing: grayscale;
}
@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:block;src:url(//fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSKmu1aB.woff2)format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:block;src:url(//fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSumu1aB.woff2)format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:block;src:url(//fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSOmu1aB.woff2)format('woff2');unicode-range:U+1F00-1FFF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:block;src:url(//fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSymu1aB.woff2)format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:block;src:url(//fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTS2mu1aB.woff2)format('woff2');unicode-range:U+0590-05FF,U+200C-2010,U+20AA,U+25CC,U+FB1D-FB4F;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:block;src:url(//fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTVOmu1aB.woff2)format('woff2');unicode-range:U+0302-0303,U+0305,U+0307-0308,U+0330,U+0391-03A1,U+03A3-03A9,U+03B1-03C9,U+03D1,U+03D5-03D6,U+03F0-03F1,U+03F4-03F5,U+2034-2037,U+2057,U+20D0-20DC,U+20E1,U+20E5-20EF,U+2102,U+210A-210E,U+2110-2112,U+2115,U+2119-211D,U+2124,U+2128,U+212C-212D,U+212F-2131,U+2133-2138,U+213C-2140,U+2145-2149,U+2190,U+2192,U+2194-21AE,U+21B0-21E5,U+21F1-21F2,U+21F4-2211,U+2213-2214,U+2216-22FF,U+2308-230B,U+2310,U+2319,U+231C-2321,U+2336-237A,U+237C,U+2395,U+239B-23B6,U+23D0,U+23DC-23E1,U+2474-2475,U+25AF,U+25B3,U+25B7,U+25BD,U+25C1,U+25CA,U+25CC,U+25FB,U+266D-266F,U+27C0-27FF,U+2900-2AFF,U+2B0E-2B11,U+2B30-2B4C,U+2BFE,U+FF5B,U+FF5D,U+1D400-1D7FF,U+1EE00-1EEFF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:block;src:url(//fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTUGmu1aB.woff2)format('woff2');unicode-range:U+0001-000C,U+000E-001F,U+007F-009F,U+20DD-20E0,U+20E2-20E4,U+2150-218F,U+2190,U+2192,U+2194-2199,U+21AF,U+21E6-21F0,U+21F3,U+2218-2219,U+2299,U+22C4-22C6,U+2300-243F,U+2440-244A,U+2460-24FF,U+25A0-27BF,U+2800-28FF,U+2921-2922,U+2981,U+29BF,U+29EB,U+2B00-2BFF,U+4DC0-4DFF,U+FFF9-FFFB,U+10140-1018E,U+10190-1019C,U+101A0,U+101D0-101FD,U+102E0-102FB,U+10E60-10E7E,U+1D2C0-1D2D3,U+1D2E0-1D37F,U+1F000-1F0FF,U+1F100-1F1AD,U+1F1E6-1F1FF,U+1F30D-1F30F,U+1F315,U+1F31C,U+1F31E,U+1F320-1F32C,U+1F336,U+1F378,U+1F37D,U+1F382,U+1F393-1F39F,U+1F3A7-1F3A8,U+1F3AC-1F3AF,U+1F3C2,U+1F3C4-1F3C6,U+1F3CA-1F3CE,U+1F3D4-1F3E0,U+1F3ED,U+1F3F1-1F3F3,U+1F3F5-1F3F7,U+1F408,U+1F415,U+1F41F,U+1F426,U+1F43F,U+1F441-1F442,U+1F444,U+1F446-1F449,U+1F44C-1F44E,U+1F453,U+1F46A,U+1F47D,U+1F4A3,U+1F4B0,U+1F4B3,U+1F4B9,U+1F4BB,U+1F4BF,U+1F4C8-1F4CB,U+1F4D6,U+1F4DA,U+1F4DF,U+1F4E3-1F4E6,U+1F4EA-1F4ED,U+1F4F7,U+1F4F9-1F4FB,U+1F4FD-1F4FE,U+1F503,U+1F507-1F50B,U+1F50D,U+1F512-1F513,U+1F53E-1F54A,U+1F54F-1F5FA,U+1F610,U+1F650-1F67F,U+1F687,U+1F68D,U+1F691,U+1F694,U+1F698,U+1F6AD,U+1F6B2,U+1F6B9-1F6BA,U+1F6BC,U+1F6C6-1F6CF,U+1F6D3-1F6D7,U+1F6E0-1F6EA,U+1F6F0-1F6F3,U+1F6F7-1F6FC,U+1F700-1F7FF,U+1F800-1F80B,U+1F810-1F847,U+1F850-1F859,U+1F860-1F887,U+1F890-1F8AD,U+1F8B0-1F8B1,U+1F900-1F90B,U+1F93B,U+1F946,U+1F984,U+1F996,U+1F9E9,U+1FA00-1FA6F,U+1FA70-1FA7C,U+1FA80-1FA88,U+1FA90-1FABD,U+1FABF-1FAC5,U+1FACE-1FADB,U+1FAE0-1FAE8,U+1FAF0-1FAF8,U+1FB00-1FBFF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:block;src:url(//fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSCmu1aB.woff2)format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:block;src:url(//fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSGmu1aB.woff2)format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:block;src:url(//fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTS-muw.woff2)format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:500;font-stretch:100%;font-display:block;src:url(//fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSKmu1aB.woff2)format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:500;font-stretch:100%;font-display:block;src:url(//fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSumu1aB.woff2)format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:500;font-stretch:100%;font-display:block;src:url(//fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSOmu1aB.woff2)format('woff2');unicode-range:U+1F00-1FFF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:500;font-stretch:100%;font-display:block;src:url(//fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSymu1aB.woff2)format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:500;font-stretch:100%;font-display:block;src:url(//fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTS2mu1aB.woff2)format('woff2');unicode-range:U+0590-05FF,U+200C-2010,U+20AA,U+25CC,U+FB1D-FB4F;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:500;font-stretch:100%;font-display:block;src:url(//fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTVOmu1aB.woff2)format('woff2');unicode-range:U+0302-0303,U+0305,U+0307-0308,U+0330,U+0391-03A1,U+03A3-03A9,U+03B1-03C9,U+03D1,U+03D5-03D6,U+03F0-03F1,U+03F4-03F5,U+2034-2037,U+2057,U+20D0-20DC,U+20E1,U+20E5-20EF,U+2102,U+210A-210E,U+2110-2112,U+2115,U+2119-211D,U+2124,U+2128,U+212C-212D,U+212F-2131,U+2133-2138,U+213C-2140,U+2145-2149,U+2190,U+2192,U+2194-21AE,U+21B0-21E5,U+21F1-21F2,U+21F4-2211,U+2213-2214,U+2216-22FF,U+2308-230B,U+2310,U+2319,U+231C-2321,U+2336-237A,U+237C,U+2395,U+239B-23B6,U+23D0,U+23DC-23E1,U+2474-2475,U+25AF,U+25B3,U+25B7,U+25BD,U+25C1,U+25CA,U+25CC,U+25FB,U+266D-266F,U+27C0-27FF,U+2900-2AFF,U+2B0E-2B11,U+2B30-2B4C,U+2BFE,U+FF5B,U+FF5D,U+1D400-1D7FF,U+1EE00-1EEFF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:500;font-stretch:100%;font-display:block;src:url(//fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTUGmu1aB.woff2)format('woff2');unicode-range:U+0001-000C,U+000E-001F,U+007F-009F,U+20DD-20E0,U+20E2-20E4,U+2150-218F,U+2190,U+2192,U+2194-2199,U+21AF,U+21E6-21F0,U+21F3,U+2218-2219,U+2299,U+22C4-22C6,U+2300-243F,U+2440-244A,U+2460-24FF,U+25A0-27BF,U+2800-28FF,U+2921-2922,U+2981,U+29BF,U+29EB,U+2B00-2BFF,U+4DC0-4DFF,U+FFF9-FFFB,U+10140-1018E,U+10190-1019C,U+101A0,U+101D0-101FD,U+102E0-102FB,U+10E60-10E7E,U+1D2C0-1D2D3,U+1D2E0-1D37F,U+1F000-1F0FF,U+1F100-1F1AD,U+1F1E6-1F1FF,U+1F30D-1F30F,U+1F315,U+1F31C,U+1F31E,U+1F320-1F32C,U+1F336,U+1F378,U+1F37D,U+1F382,U+1F393-1F39F,U+1F3A7-1F3A8,U+1F3AC-1F3AF,U+1F3C2,U+1F3C4-1F3C6,U+1F3CA-1F3CE,U+1F3D4-1F3E0,U+1F3ED,U+1F3F1-1F3F3,U+1F3F5-1F3F7,U+1F408,U+1F415,U+1F41F,U+1F426,U+1F43F,U+1F441-1F442,U+1F444,U+1F446-1F449,U+1F44C-1F44E,U+1F453,U+1F46A,U+1F47D,U+1F4A3,U+1F4B0,U+1F4B3,U+1F4B9,U+1F4BB,U+1F4BF,U+1F4C8-1F4CB,U+1F4D6,U+1F4DA,U+1F4DF,U+1F4E3-1F4E6,U+1F4EA-1F4ED,U+1F4F7,U+1F4F9-1F4FB,U+1F4FD-1F4FE,U+1F503,U+1F507-1F50B,U+1F50D,U+1F512-1F513,U+1F53E-1F54A,U+1F54F-1F5FA,U+1F610,U+1F650-1F67F,U+1F687,U+1F68D,U+1F691,U+1F694,U+1F698,U+1F6AD,U+1F6B2,U+1F6B9-1F6BA,U+1F6BC,U+1F6C6-1F6CF,U+1F6D3-1F6D7,U+1F6E0-1F6EA,U+1F6F0-1F6F3,U+1F6F7-1F6FC,U+1F700-1F7FF,U+1F800-1F80B,U+1F810-1F847,U+1F850-1F859,U+1F860-1F887,U+1F890-1F8AD,U+1F8B0-1F8B1,U+1F900-1F90B,U+1F93B,U+1F946,U+1F984,U+1F996,U+1F9E9,U+1FA00-1FA6F,U+1FA70-1FA7C,U+1FA80-1FA88,U+1FA90-1FABD,U+1FABF-1FAC5,U+1FACE-1FADB,U+1FAE0-1FAE8,U+1FAF0-1FAF8,U+1FB00-1FBFF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:500;font-stretch:100%;font-display:block;src:url(//fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSCmu1aB.woff2)format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:500;font-stretch:100%;font-display:block;src:url(//fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSGmu1aB.woff2)format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:500;font-stretch:100%;font-display:block;src:url(//fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTS-muw.woff2)format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:600;font-stretch:100%;font-display:block;src:url(//fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSKmu1aB.woff2)format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:600;font-stretch:100%;font-display:block;src:url(//fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSumu1aB.woff2)format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:600;font-stretch:100%;font-display:block;src:url(//fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSOmu1aB.woff2)format('woff2');unicode-range:U+1F00-1FFF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:600;font-stretch:100%;font-display:block;src:url(//fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSymu1aB.woff2)format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:600;font-stretch:100%;font-display:block;src:url(//fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTS2mu1aB.woff2)format('woff2');unicode-range:U+0590-05FF,U+200C-2010,U+20AA,U+25CC,U+FB1D-FB4F;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:600;font-stretch:100%;font-display:block;src:url(//fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTVOmu1aB.woff2)format('woff2');unicode-range:U+0302-0303,U+0305,U+0307-0308,U+0330,U+0391-03A1,U+03A3-03A9,U+03B1-03C9,U+03D1,U+03D5-03D6,U+03F0-03F1,U+03F4-03F5,U+2034-2037,U+2057,U+20D0-20DC,U+20E1,U+20E5-20EF,U+2102,U+210A-210E,U+2110-2112,U+2115,U+2119-211D,U+2124,U+2128,U+212C-212D,U+212F-2131,U+2133-2138,U+213C-2140,U+2145-2149,U+2190,U+2192,U+2194-21AE,U+21B0-21E5,U+21F1-21F2,U+21F4-2211,U+2213-2214,U+2216-22FF,U+2308-230B,U+2310,U+2319,U+231C-2321,U+2336-237A,U+237C,U+2395,U+239B-23B6,U+23D0,U+23DC-23E1,U+2474-2475,U+25AF,U+25B3,U+25B7,U+25BD,U+25C1,U+25CA,U+25CC,U+25FB,U+266D-266F,U+27C0-27FF,U+2900-2AFF,U+2B0E-2B11,U+2B30-2B4C,U+2BFE,U+FF5B,U+FF5D,U+1D400-1D7FF,U+1EE00-1EEFF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:600;font-stretch:100%;font-display:block;src:url(//fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTUGmu1aB.woff2)format('woff2');unicode-range:U+0001-000C,U+000E-001F,U+007F-009F,U+20DD-20E0,U+20E2-20E4,U+2150-218F,U+2190,U+2192,U+2194-2199,U+21AF,U+21E6-21F0,U+21F3,U+2218-2219,U+2299,U+22C4-22C6,U+2300-243F,U+2440-244A,U+2460-24FF,U+25A0-27BF,U+2800-28FF,U+2921-2922,U+2981,U+29BF,U+29EB,U+2B00-2BFF,U+4DC0-4DFF,U+FFF9-FFFB,U+10140-1018E,U+10190-1019C,U+101A0,U+101D0-101FD,U+102E0-102FB,U+10E60-10E7E,U+1D2C0-1D2D3,U+1D2E0-1D37F,U+1F000-1F0FF,U+1F100-1F1AD,U+1F1E6-1F1FF,U+1F30D-1F30F,U+1F315,U+1F31C,U+1F31E,U+1F320-1F32C,U+1F336,U+1F378,U+1F37D,U+1F382,U+1F393-1F39F,U+1F3A7-1F3A8,U+1F3AC-1F3AF,U+1F3C2,U+1F3C4-1F3C6,U+1F3CA-1F3CE,U+1F3D4-1F3E0,U+1F3ED,U+1F3F1-1F3F3,U+1F3F5-1F3F7,U+1F408,U+1F415,U+1F41F,U+1F426,U+1F43F,U+1F441-1F442,U+1F444,U+1F446-1F449,U+1F44C-1F44E,U+1F453,U+1F46A,U+1F47D,U+1F4A3,U+1F4B0,U+1F4B3,U+1F4B9,U+1F4BB,U+1F4BF,U+1F4C8-1F4CB,U+1F4D6,U+1F4DA,U+1F4DF,U+1F4E3-1F4E6,U+1F4EA-1F4ED,U+1F4F7,U+1F4F9-1F4FB,U+1F4FD-1F4FE,U+1F503,U+1F507-1F50B,U+1F50D,U+1F512-1F513,U+1F53E-1F54A,U+1F54F-1F5FA,U+1F610,U+1F650-1F67F,U+1F687,U+1F68D,U+1F691,U+1F694,U+1F698,U+1F6AD,U+1F6B2,U+1F6B9-1F6BA,U+1F6BC,U+1F6C6-1F6CF,U+1F6D3-1F6D7,U+1F6E0-1F6EA,U+1F6F0-1F6F3,U+1F6F7-1F6FC,U+1F700-1F7FF,U+1F800-1F80B,U+1F810-1F847,U+1F850-1F859,U+1F860-1F887,U+1F890-1F8AD,U+1F8B0-1F8B1,U+1F900-1F90B,U+1F93B,U+1F946,U+1F984,U+1F996,U+1F9E9,U+1FA00-1FA6F,U+1FA70-1FA7C,U+1FA80-1FA88,U+1FA90-1FABD,U+1FABF-1FAC5,U+1FACE-1FADB,U+1FAE0-1FAE8,U+1FAF0-1FAF8,U+1FB00-1FBFF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:600;font-stretch:100%;font-display:block;src:url(//fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSCmu1aB.woff2)format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:600;font-stretch:100%;font-display:block;src:url(//fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSGmu1aB.woff2)format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:600;font-stretch:100%;font-display:block;src:url(//fonts.gstatic.com/s/opensans/v40/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTS-muw.woff2)format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:block;src:url(//fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu72xKOzY.woff2)format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:block;src:url(//fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu5mxKOzY.woff2)format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:block;src:url(//fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu7mxKOzY.woff2)format('woff2');unicode-range:U+1F00-1FFF;}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:block;src:url(//fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu4WxKOzY.woff2)format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF;}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:block;src:url(//fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu7WxKOzY.woff2)format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:block;src:url(//fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu7GxKOzY.woff2)format('woff2');unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF;}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:block;src:url(//fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu4mxK.woff2)format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;}</style><style>div.fc-consent-root, .fc-consent-root a:link, .fc-consent-root div,.fc-consent-root h1,.fc-consent-root h2,.fc-consent-root a,.fc-consent-root p,.fc-consent-root button,.fc-consent-root i,.fc-consent-root input,.fc-consent-root label,.fc-consent-root span,.fc-consent-root ul,.fc-consent-root li,.fc-consent-root hr,.fc-consent-root img,.fc-consent-root br,.fc-consent-root footer{-webkit-app-region: none; -webkit-appearance: none; -webkit-border-horizontal-spacing: 0; -webkit-border-image: none; -webkit-border-vertical-spacing: 0; -webkit-box-align: stretch; -webkit-box-decoration-break: slice; -webkit-box-direction: normal; -webkit-box-flex: 0; -webkit-box-ordinal-group: 1; -webkit-box-orient: horizontal; -webkit-box-pack: start; -webkit-box-reflect: none; -webkit-font-smoothing: auto; -webkit-highlight: none; -webkit-hyphenate-character: auto; -webkit-line-break: auto; -webkit-line-clamp: none; -webkit-locale: auto; -webkit-margin-after-collapse: collapse; -webkit-margin-before-collapse: collapse; -webkit-mask-box-image-outset: 0; -webkit-mask-box-image-repeat: stretch; -webkit-mask-box-image-slice: 0 fill; -webkit-mask-box-image-source: none; -webkit-mask-box-image-width: auto; -webkit-mask-box-image: none; -webkit-mask-clip: border-box; -webkit-mask-composite: source-over; -webkit-mask-image: none; -webkit-mask-origin: border-box; -webkit-mask-position: 0% 0%; -webkit-mask-repeat: repeat; -webkit-mask-size: auto; -webkit-print-color-adjust: economy; -webkit-rtl-ordering: logical; -webkit-tap-highlight-color: rgba(0, 0, 0, 0.4); -webkit-text-combine: none; -webkit-text-decorations-in-effect: none; -webkit-text-emphasis-color: rgb(0, 0, 0); -webkit-text-emphasis-position: over right; -webkit-text-emphasis-style: none; -webkit-text-orientation: vertical-right; -webkit-text-security: none; -webkit-text-stroke-color: rgb(0, 0, 0); -webkit-text-stroke-width: 0; -webkit-user-drag: auto; -webkit-writing-mode: horizontal-tb; align-content: normal; align-items: normal; align-self: auto; alignment-baseline: auto; animation-delay: 0s; animation-direction: normal; animation-duration: 0s; animation-fill-mode: none; animation-iteration-count: 1; animation-name: none; animation-play-state: running; animation-timing-function: ease; backdrop-filter: none; backface-visibility: visible; background-attachment: scroll; background-blend-mode: normal; background-clip: border-box; background-color: rgba(0, 0, 0, 0); background-image: none; background-origin: padding-box; background-position: 0% 0%; background-repeat: repeat; background-size: auto; baseline-shift: 0; border-bottom-color: rgb(0, 0, 0); border-bottom-left-radius: 0; border-bottom-right-radius: 0; border-bottom-style: none; border-bottom-width: 0; border-collapse: separate; border-image-outset: 0; border-image-repeat: stretch; border-image-slice: 100%; border-image-source: none; border-image-width: 1; border-left-color: rgb(0, 0, 0); border-left-style: none; border-left-width: 0; border-right-color: rgb(0, 0, 0); border-right-style: none; border-right-width: 0; border-top-color: rgb(0, 0, 0); border-top-left-radius: 0; border-top-right-radius: 0; border-top-style: none; border-top-width: 0; bottom: auto; box-shadow: none; box-sizing: content-box; break-after: auto; break-before: auto; break-inside: auto; buffered-rendering: auto; caption-side: top; caret-color: rgb(0, 0, 0); clear: none; clip-path: none; clip-rule: nonzero; clip: auto; color-interpolation-filters: linearrgb; color-interpolation: srgb; color-rendering: auto; color: rgb(0, 0, 0); column-count: auto; column-gap: normal; column-rule-color: rgb(0, 0, 0); column-rule-style: none; column-rule-width: 0; column-span: none; column-width: auto; content: normal; cursor: auto; cx: 0; cy: 0; d: none; display: inline; dominant-baseline: auto; empty-cells: show; fill-opacity: 1; fill-rule: nonzero; fill: rgb(0; 0; 0); filter: none; flex-basis: auto; flex-direction: row; flex-grow: 0; flex-shrink: 1; flex-wrap: nowrap; float: none; flood-color: rgb(0, 0, 0); flood-opacity: 1; font-kerning: auto; font-optical-sizing: auto; font-size: 16px; font-stretch: 100%; font-style: normal; font-variant-caps: normal; font-variant-east-asian: normal; font-variant-ligatures: normal; font-variant-numeric: normal; font-variant: normal; font-weight: 400; grid-auto-columns: auto; grid-auto-flow: row; grid-auto-rows: auto; grid-column-end: auto; grid-column-start: auto; grid-row-end: auto; grid-row-start: auto; grid-template-areas: none; grid-template-columns: none; grid-template-rows: none; height: auto; hyphens: manual; image-rendering: auto; isolation: auto; justify-content: normal; justify-items: normal; justify-self: auto; left: auto; letter-spacing: normal; lighting-color: rgb(255, 255, 255); line-break: auto; line-height: normal; list-style-image: none; list-style-position: outside; list-style-type: disc; margin-bottom: 0; margin-left: 0; margin-right: 0; margin-top: 0; marker-end: none; marker-mid: none; marker-start: none; mask-type: luminance; mask: none; max-height: none; max-width: none; min-height: 0; min-width: 0; mix-blend-mode: normal; object-fit: fill; object-position: 50% 50%; offset-distance: 0; offset-path: none; offset-rotate: auto 0deg; opacity: 1; order: 0; orphans: 2; outline-color: rgb(0, 0, 0); outline-offset: 0; outline-style: none; outline-width: 0; overflow-anchor: auto; overflow-wrap: normal; overflow-x: visible; overflow-y: visible; padding-bottom: 0; padding-left: 0; padding-right: 0; padding-top: 0; paint-order: normal; perspective-origin: 0 0; perspective: none; pointer-events: auto; position: static; r: 0; resize: none; right: auto; row-gap: normal; rx: auto; ry: auto; scroll-behavior: auto; shape-image-threshold: 0; shape-margin: 0; shape-outside: none; shape-rendering: auto; speak: normal; stop-color: rgb(0, 0, 0); stop-opacity: 1; stroke-dasharray: none; stroke-dashoffset: 0; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 4; stroke-opacity: 1; stroke-width: 1px; stroke: none; tab-size: 8; table-layout: auto; text-align-last: auto; text-align: start; text-anchor: start; text-decoration-color: rgb(0, 0, 0); text-decoration-line: none; text-decoration-skip-ink: auto; text-decoration-style: solid; text-decoration: none solid rgb(0, 0, 0); text-indent: 0; text-overflow: clip; text-rendering: auto; text-shadow: none; text-size-adjust: auto; text-transform: none; text-underline-position: auto; top: auto; touch-action: auto; transform-origin: 0 0; transform-style: flat; transform: none; transition-delay: 0s; transition-duration: 0s; transition-property: all; transition-timing-function: ease; unicode-bidi: normal; user-select: auto; vector-effect: none; vertical-align: baseline; visibility: visible; white-space: normal; widows: 2; width: auto; will-change: auto; word-break: normal; word-spacing: 0; writing-mode: horizontal-tb; x: 0; y: 0; z-index: auto; zoom: 1;}.fc-consent-root div, .fc-consent-root h1, .fc-consent-root h2, .fc-consent-root p, .fc-consent-root button, .fc-consent-root ul, .fc-consent-root li {display: block;}.fc-consent-root a, .fc-consent-root a p {cursor: pointer;}.fc-consent-root button, .fc-consent-root button div, .fc-consent-root button p, .fc-consent-root .fc-button, .fc-consent-root .fc-button div, .fc-consent-root .fc-button p {cursor: pointer;}.fc-consent-root a:hover {filter: brightness(80%);}.fc-consent-root button:focus p:not(.fc-button-text), .fc-consent-root button:focus, .fc-consent-root .fc-button:focus {box-shadow: 0 0 0 3px #fff; outline: 2px #174ea6 solid;}@supports selector(:focus-visible) {.fc-consent-root button:focus p:not(.fc-button-text), .fc-consent-root button:focus, .fc-consent-root .fc-button:focus {box-shadow: none; outline: none;}.fc-consent-root button:focus-visible::before {border: 2px solid #174ea6; border-radius: 6px; content: ''; inset: -4px; position: absolute;}.fc-consent-root button:focus-visible::after {border: 2px solid #e8f0fe; border-radius: 8px; content: ''; inset: -6px; position: absolute;}.fc-consent-root button.fc-icon-button:focus-visible::before {inset: -2px;}.fc-consent-root button.fc-icon-button:focus-visible::after {inset: -4px;}.fc-consent-root button.fc-list-item-button:focus-visible::before {left: 2px; width: calc(100% - 8px)}.fc-consent-root button.fc-list-item-button:focus-visible::after {left: 0; width: calc(100% - 4px)}}.fc-consent-root .fc-button, .fc-consent-root .fc-choice-dialog, .fc-consent-root .fc-faq-item, .fc-consent-root .fc-data-preferences-dialog, .fc-consent-root .fc-dialog-header-back-button, .fc-consent-root .fc-navigation-button, .fc-consent-root .fc-vendor-preferences-dialog, .fc-consent-root .fc-preference-slider, .fc-consent-root .fc-preference-consent, .fc-consent-root .fc-preference-legitimate-interest, .fc-consent-root .fc-slider-el, .fc-consent-root .fc-help-dialog-container, .fc-consent-root .fc-help-dialog-close-button {outline: 1px solid transparent;}div.fc-consent-root {position: fixed; z-index: 2147483644;align-items: center; float: top; height: 100%; left: 0; overflow-x: auto; top: 0;align-items: center; display: flex; justify-content: center; width: 100%;}div.fc-consent-root {font-family: Open Sans;direction: ltr;}.fc-consent-root, .fc-consent-root h1, .fc-consent-root h2, .fc-consent-root p, .fc-consent-root span, .fc-consent-root li {-moz-font-feature-settings: "kern" 1; -moz-osx-font-smoothing: grayscale; -webkit-font-feature-settings: "kern" 1; -webkit-font-smoothing: antialiased; font-feature-settings: "kern" 1; font-kerning: normal; text-rendering: optimizelegibility;}.fc-consent-root .fc-dialog-overlay, .fc-consent-root .fc-help-dialog-overlay {background-color: black; height: 100%; left: 0; opacity: 0.6; position: fixed; top: 0; width: 100%; z-index: -1;}.fc-consent-root .fc-dialog-container {display: flex;}.fc-consent-root .fc-dialog-container {max-width: 512px; width: 90%;}.fc-consent-root .fc-dialog {max-height: 80vh;background-color: #FFFFFF;border: 1px solid rgba(0, 0, 0, 0.2); border-radius: 8px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.16);display: flex; flex-direction: column; width: 100%;}.fc-consent-root .fc-dialog-content {flex: 1 1 auto; overflow-y: auto;}@supports (scrollbar-gutter: stable both-edges) {.fc-consent-root .fc-dialog-content {scrollbar-gutter: stable both-edges;}}.fc-consent-root .fc-dialog-scrollable-content {display: flex; flex-direction: column; justify-content: center; width: 100%;}.fc-consent-root .fc-dialog-restricted-content {align-self: center; flex: 1 1 auto;max-width: 416px;width: calc(100% - 48px);}.fc-consent-root .fc-dialog-header {background-color: #FFFFFFe6; border-radius: 8px 8px 0 0; flex: 0 0 auto; position: relative; width: 100%; z-index: 1;}.fc-consent-root .fc-choice-dialog-header {background-color: #FFFFFFe6; border-radius: 8px 8px 0 0; flex: 0 0 auto; height: 24px; position: relative; width: 100%; z-index: 1;}.fc-consent-root .fc-dialog-header .fc-dialog-header-back-button {border: 0; left: 0; margin: 7px 0 0 4px; padding: 1px 6px; position: absolute; top: 0;}.fc-consent-root .fc-dialog-header .fc-dialog-header-back-button i {color: #5f6368; font-size: 24px;}.fc-consent-root .fc-data-preferences-header, .fc-consent-root .fc-vendor-preferences-header {margin: auto; max-width: calc(100% - 80px);}.fc-consent-root .fc-dialog-header p {color: #5f6368; font-size: 12px; font-weight: bold; margin: 12px 0; text-align: center;}.fc-consent-root .fc-site-macro-placeholder-image {border: 1px solid #dadce0; border-radius: 4px; box-sizing: border-box; padding: 12px 100px;}.fc-consent-root .fc-ump-sdk-app-icon-placeholder-image {border: 1px solid #dadce0; border-radius: 4px; box-sizing: border-box; padding: 8px;}.fc-consent-root .fc-iris-logo-image {height: 64px; width: 64px;}.fc-consent-root .fc-header-image-container {padding-bottom: 4px; max-height: 60px; max-width: 100%; min-height: 40px;display: flex; flex-direction: row;justify-content: center;}.fc-consent-root .fc-dialog .fc-header h1.fc-dialog-headline {overflow-wrap: break-word;font-weight: 700;font-style: normal;text-decoration: initial;text-align: center;font-family: 'Open Sans';color: #000000;font-size: 1.25em;}.fc-consent-root .fc-dialog .fc-header h1 {overflow-wrap: break-word;font-weight: 700;font-style: normal;text-decoration: initial;text-align: center;font-family: 'Open Sans';color: #000000;}.fc-consent-root .fc-choice-dialog .fc-header h2:focus, .fc-consent-root .fc-data-preferences-dialog .fc-dialog-header p:focus, .fc-consent-root .fc-vendor-preferences-dialog .fc-dialog-header p:focus {outline: none;}@media screen and (max-width: 479px) {.fc-consent-root .fc-dialog .fc-header h1 {font-size: 16px;}.fc-consent-root .fc-choice-dialog .fc-header-image {max-height: 40px;}}@media screen and (min-width: 480px) {.fc-consent-root .fc-dialog .fc-header h1 {font-size: 18px;}}.fc-consent-root .fc-dialog .fc-header h1, .fc-consent-root .fc-dialog .fc-header h2 {margin: 12px 0;}.fc-consent-root .fc-dialog div.fc-header {font-size: 14px;}.fc-consent-root .fc-dialog .fc-header h2.fc-dialog-title {overflow-wrap: break-word;font-weight: 700;font-style: normal;text-decoration: initial;text-align: center;font-family: 'Open Sans';color: #5F6368;font-size: 1em;}.fc-consent-root .fc-dialog .fc-header h2 {overflow-wrap: break-word;font-weight: 700;font-style: normal;text-decoration: initial;text-align: center;font-family: 'Open Sans';color: #5F6368;font-size: 14px;margin-top: 24px;}.fc-consent-root .fc-dialog .fc-footer p {color: #5f6368; font-size: 12px; line-height: 16px; margin: 12px 0; text-align: left;}.fc-consent-root .fc-dialog .fc-footer a, .fc-consent-root .fc-dialog .fc-footer a:visited {color: #1967d2; cursor: pointer; font: inherit; text-decoration: none;}@media screen and (max-width: 479px) {.fc-consent-root .fc-data-preferences-dialog .fc-body, .fc-consent-root .fc-vendor-preferences-dialog .fc-body {font-size: 14px;}.fc-consent-root .fc-data-preferences-dialog .fc-body p, .fc-consent-root .fc-data-preferences-dialog .fc-noneditable-body p, .fc-consent-root .fc-vendor-preferences-dialog .fc-body p {font-size: 14px; line-height: 20px; margin-bottom: 24px;}}@media screen and (min-width: 480px) {.fc-consent-root .fc-data-preferences-dialog .fc-body, .fc-consent-root .fc-vendor-preferences-dialog .fc-body {font-size: 16px;}.fc-consent-root .fc-data-preferences-dialog .fc-body p, .fc-consent-root .fc-data-preferences-dialog .fc-noneditable-body p, .fc-consent-root .fc-vendor-preferences-dialog .fc-body p {font-size: 16px; line-height: 24px; margin-bottom: 24px;}}.fc-consent-root .fc-data-preferences-dialog .fc-body p, .fc-consent-root .fc-data-preferences-dialog .fc-noneditable-body p, .fc-consent-root .fc-vendor-preferences-dialog .fc-body p {overflow-wrap: break-word;font-weight: normal;font-style: normal;text-decoration: initial;text-align: left;font-family: 'Open Sans';color: #5F6368;font-size: 1em;}.fc-consent-root .fc-footer-buttons-container {align-items: center; border-radius: 0 0 8px 8px; bottom: 0; display: flex; flex: 0 0 auto; flex-direction: column; justify-content: center; left: 0; padding: 0 16px 8px 16px; width: calc(100% - 32px); z-index: 1;}.fc-consent-root .fc-footer-buttons-divider {background-color: #dadce0; height: 1px; margin-bottom: 8px; z-index: 1;}.fc-consent-root .fc-choice-dialog .fc-footer-buttons-divider {max-width: 416px;width: calc(100% - 48px);}.fc-consent-root .fc-data-preferences-dialog .fc-footer-buttons-divider, .fc-consent-root .fc-vendor-preferences-dialog .fc-footer-buttons-divider {width: calc(100% + 32px);}.fc-consent-root .fc-data-preferences-dialog a, .fc-consent-root .fc-vendor-preferences-dialog a {cursor: pointer;}.fc-consent-root .fc-footer-buttons {display: flex; flex: 1 1 0; justify-content: center;max-width: 416px;width: 100%; z-index: 1;}.fc-consent-root .fc-button {background: rgba(0,0,0,0); border: 0; cursor: pointer; flex: 1; height: 38px; margin: 8px 0; position: relative;}.fc-consent-root .fc-button .fc-button-background {border-radius: 20px; height: 100%; left: 0; position: absolute; top: 0; width: 100%; z-index: -1;}.fc-consent-root .fc-primary-button .fc-button-background {background-color: #1967D2;}.fc-consent-root .fc-secondary-button .fc-button-background {background-color: #1967D2; border: none;}.fc-consent-root .fc-button-label {overflow-wrap: break-word;font-weight: 700;font-style: normal;text-decoration: initial;text-align: center;font-family: 'Open Sans';color: #FFFFFF;font-size: 1em;letter-spacing: normal; line-height: 20px; margin: 9px 0;}.fc-consent-root .fc-primary-button .fc-button-label {color: #FFFFFF;}.fc-consent-root .fc-secondary-button .fc-button-label {color: #FFFFFF;}.fc-consent-root .fc-manage-options-third-button-label {color: #1967D2; font-size: 14px; font-weight: 600; letter-spacing: normal; line-height: 20px; margin: 9px 0;}.fc-consent-root .fc-button:hover .fc-button-background {filter: brightness(90%);}@media screen and (max-width: 480px) {.fc-consent-root .fc-footer-buttons {align-items: stretch; flex: 1 1 auto; flex-direction: column;}.fc-consent-root .fc-footer-buttons .fc-button {font-size: 14px;}.fc-consent-root .fc-choice-dialog .fc-footer-buttons-container {height: 130px;}.fc-consent-root .fc-footer-buttons-container {height: 130px;}.fc-consent-root .fc-button {flex: 1 1 auto; flex-shrink: 0; height: auto;}.fc-consent-root .fc-primary-button {order: 1;}.fc-consent-root .fc-secondary-button {order: 2;}}@media screen and (min-width: 481px) {.fc-consent-root .fc-footer-buttons {align-items: center; flex-direction: row;}.fc-consent-root .fc-footer-buttons .fc-button {font-size: 14px;}.fc-consent-root .fc-primary-button {margin-left: 12px; order: 2;}.fc-consent-root .fc-choice-dialog .fc-footer-buttons-container {height: 76px;}.fc-consent-root .fc-footer-buttons-container {height: 76px;}.fc-consent-root .fc-secondary-button {margin-right: 12px; order: 1;}}.fc-consent-root .fc-stacks {margin-top: 8px;}.fc-consent-root .fc-stacks ul {list-style-type: none;}.fc-consent-root .fc-stacks ul li {align-items: center; display: flex; flex-direction: row; padding-bottom: 16px;}.fc-consent-root .fc-stacks .fc-stack-name {color: #3c4043; font-size: 12px; font-weight: 600; line-height: 16px; margin-top: 5px; width: calc(100% - 44px);}.fc-consent-root .fc-stacks .fc-stack-icon {background-color: #1967D23D; border-radius: 14px; display: flex; flex-direction: row; height: 28px; justify-content: center; margin-right: 16px; width: 28px;}.fc-consent-root .fc-stacks .fc-stack-icon i {color: #1967D2; font-size: 18px; font-weight: normal; margin-top: 5px;}.fc-consent-root .fc-launch-icon {color: rgb(25, 103, 210); font-size: 16px; left: 4px; position: relative; top: 2px;}.fc-consent-root .fc-faq-header {display: flex; flex-direction: row; position: relative; text-decoration: none;}.fc-consent-root .fc-faq-header:hover {filter: brightness(100%);}.fc-consent-root .fc-faq-header .fc-faq-label {color: #3c4043; cursor: pointer; font-family: Open Sans; font-size: 12px; font-weight: 600; margin-top: 5px;}.fc-consent-root .fc-faq-header .fc-faq-icon {background-color: #FFFFFF; border: 1px solid #dadce0; border-radius: 14px; display: flex; flex-direction: row; height: 26px; justify-content: center; margin-right: 16px; width: 26px;}.fc-consent-root .fc-faq-header .fc-faq-icon i {color: #5f6368; cursor: pointer; font-size: 18px; font-weight: normal; margin-top: 4px;}.fc-consent-root .fc-faq-contents {background-color: #f8f9fa; display: flex; flex-direction: column; justify-content: center; margin-top: 16px;}.fc-consent-root .fc-faq-contents ul {margin: 14px 0; padding: 0;}.fc-consent-root .fc-faq-contents ul li {display: flex; flex-direction: row; list-style-type: none; padding-bottom: 24px;}.fc-consent-root .fc-faq-contents ul li:last-child {padding-bottom: 0;}.fc-consent-root .fc-faq-contents .fc-faq-item-dot {background-color: #5f6368; border-radius: 4px; height: 8px; margin: 7px 10px 0; width: 8px;}.fc-consent-root .fc-faq-contents .fc-faq-item {color: #5f6368; cursor: pointer; display: flex; flex-direction: row; text-decoration: none; width: calc(100% - 44px);}.fc-consent-root .fc-faq-contents .fc-faq-item-title {color: #5f6368; cursor: pointer; font-size: 14px; margin-left: 16px;}.fc-consent-root .fc-data-preferences-dialog .fc-navigation {display: flex; flex-direction: row; justify-content: center; margin: 0 0 24px;}.fc-consent-root .fc-data-preferences-dialog .fc-navigation-button {background-color: #FFFFFF; border: 0; cursor: pointer; padding: 10px 0; position: relative; text-align: center; width: 100%;}.fc-consent-root .fc-navigation-button .fc-navigation-button-label {color: #1967D2; cursor: pointer; font-size: 14px; font-weight: bold; margin: 0; padding: 0; text-align: center;}.fc-consent-root .fc-navigation-button:hover .fc-navigation-button-label {filter: brightness(80%);}.fc-consent-root .fc-preference-divider {align-items: flex-start; background-color: #f1f3f4; box-sizing: border-box; display: flex; flex-direction: row; margin-bottom: 8px;max-width: 416px;width: calc(100% - 16px); -moz-box-sizing: border-box; -webkit-box-sizing: border-box;}.fc-consent-root .fc-lower-preference-divider {margin-top: 16px;}.fc-consent-root .fc-preference-divider p {color: #5f6368; font-size: 12px; font-weight: bold; margin-bottom: 8px; margin-right: 0; margin-top: 8px; width: fit-content;}.fc-consent-root .fc-preference-divider .fc-help-tip {margin: 8px 16px 0 8px;}@media screen and (max-width: 479px) {.fc-consent-root .fc-preference-divider p {margin-left: 16px;}}@media screen and (min-width: 480px) {.fc-consent-root .fc-preference-divider p {margin-left: 24px;}}.fc-consent-root .fc-preferences-container {align-items: center; align-self: center; display: flex; flex: 1 1 auto; flex-direction: column; margin: 0 0 24px; width: 100%;}.fc-consent-root .fc-preference-container {background-color: #FFFFFF; border: 1px solid #dadce0; border-radius: 8px; box-sizing: border-box; margin: 0 0 8px;max-width: 416px;width: calc(100% - 16px); -moz-box-sizing: border-box; -webkit-box-sizing: border-box;}.fc-consent-root .fc-preference-container .fc-preference-title {display: flex; flex-direction: row; justify-content: space-between;}.fc-consent-root .fc-preference-container .fc-preference-title h2 {overflow-wrap: break-word;font-weight: 700;font-style: normal;text-decoration: initial;font-family: 'Open Sans';color: #000000;color: #3c4043; font-size: 14px; line-height: 20px; margin: 0 0 8px; padding: 0; text-align: left;}.fc-consent-root .fc-preference-container .fc-preference-title .fc-help-tip {margin-left: 4px; position: relative; top: -4px;}.fc-consent-root .fc-preference-container .fc-preference-description {overflow-wrap: break-word;font-weight: normal;font-style: normal;text-decoration: initial;text-align: left;font-family: 'Open Sans';color: #5F6368;line-height: 20px; margin: 0; padding: 0;}.fc-consent-root .fc-preference-container .fc-preference-description a, .fc-consent-root .fc-preference-container .fc-preference-description a:visited {color: #1967d2; font: inherit; text-decoration: none;}.fc-consent-root .fc-preference-container .fc-preference-slider-container {display: flex; flex-direction: row; justify-content: space-between;}.fc-consent-root .fc-preference-container .fc-preference-slider-label {align-items: center; color: #5f6368; font-weight: bold; flex: 1; flex-direction: row;}.fc-consent-root .fc-preference-container .fc-preference-slider-label .fc-help-tip {color: inherit; display: inline; font: inherit; vertical-align: middle;}.fc-consent-root .fc-preference-container .fc-purpose-feature-description {color: inherit; font: inherit; margin-bottom: 8px;}.fc-consent-root .fc-preference-container .fc-truncated-3-line {display: -webkit-box; overflow: hidden; text-overflow: ellipsis; -webkit-line-clamp: 3; -webkit-box-orient: vertical;}.fc-consent-root .fc-preference-container .fc-iab-vendor-storage-info-container, .fc-consent-root .fc-preference-container .fc-iab-vendor-storage-info-container div, .fc-consent-root .fc-preference-container .fc-iab-vendor-storage-info-container p {color: inherit; display: block; font: inherit; text-decoration: none;}.fc-consent-root .fc-preference-container .fc-iab-vendor-storage-info-container .fc-vendor-data-categories {display: flex;}.fc-consent-root .fc-preference-container .fc-iab-vendor-storage-info-container .fc-truncated-single-line {flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;}.fc-consent-root .fc-preference-container .fc-preference-container-divider {background-color: #dadce0; height: 1px; margin-bottom: 16px; margin-top: 12px;}.fc-consent-root .fc-preference-container .fc-consent-preference-container {margin: 16px 0 0;}.fc-consent-root .fc-preference-container .fc-legitimate-interest-preference-container {margin: 24px 0 0;}.fc-consent-root .fc-legitimate-interest-preference-container .fc-help-tip {margin-left: 4px;}@media screen and (max-width: 479px) {.fc-consent-root .fc-preference-container {padding: 16px;}.fc-consent-root .fc-preference-container .fc-preference-description {font-size: 12px; line-height: 16px;}.fc-consent-root .fc-preference-container .fc-preference-slider-label {font-size: 12px; line-height: 16px;}.fc-consent-root .fc-preference-container .fc-preference-container-divider {margin-left: -16px; width: calc(100% + 32px);}}@media screen and (min-width: 480px) {.fc-consent-root .fc-preference-container {padding: 24px;}.fc-consent-root .fc-preference-container .fc-preference-description {font-size: 14px;}.fc-consent-root .fc-preference-container .fc-preference-slider-label {font-size: 14px; line-height: 20px;}.fc-consent-root .fc-preference-container .fc-preference-container-divider {margin-left: -24px; width: calc(100% + 48px);}}.fc-consent-root .fc-preference-container .fc-preference-slider {display: inline-block; height: 20px; position: relative; width: 39px;}.fc-consent-root .fc-preference-container .fc-preference-slider input {height: 0; opacity: 0; width: 0;}.fc-consent-root .fc-preference-container .fc-preference-slider .fc-slider-el {background-color: #80868b; border-radius: 20px; cursor: pointer; position: absolute; bottom: 0; left: 0; top: 0; right: 0; transition: .4s; -webkit-transition: .4s;}.fc-consent-root .fc-preference-container .fc-preference-slider .fc-slider-el:before {background-color: #fff; border-radius: 50%; bottom: 1px; content: ""; height: 18px; left: 1px; position: absolute; width: 18px; transition: .4s; -webkit-transition: .4s;}.fc-consent-root .fc-preference-container .fc-preference-slider input:checked + .fc-slider-el {background-color: #1967D2;}.fc-consent-root .fc-preference-container .fc-preference-slider input:focus + .fc-slider-el {box-shadow: 0 -2px 8px rgba(128, 134, 139, 0.09), 0 4px 8px rgba(128, 134, 139, 0.06), 0 1px 2px rgba(60, 64, 67, 0.3), 0 2px 6px rgba(60, 64, 67, 0.15);}.fc-consent-root .fc-preference-container .fc-preference-slider input:checked + .fc-slider-el:before {transform: translateX(19px); -ms-transform: translateX(19px); -webkit-transform: translateX(19px);}.fc-consent-root a:hover {filter: brightness(80%);}.fc-consent-root .fc-help-tip {background: rgba(255, 255, 255, 0); border: 0; cursor: pointer; outline: none;}.fc-consent-root .fc-help-tip:focus i {cursor: pointer; outline: auto;}.fc-consent-root .fc-help-tip i {color: #5f6368; cursor: pointer; font-size: 16px;}.fc-consent-root .fc-help-dialog-container {align-items: center; display: flex; justify-content: center; float: top; height: 100%; left: 0; overflow-x: auto; position: absolute; top: 0; width: 100%; z-index: 1;}@media screen and (max-width: 479px) {.fc-consent-root .fc-help-dialog {margin: 32px;}}.fc-consent-root .fc-help-dialog {background-color: #FFFFFF; border-radius: 8px; display: flex; flex-direction: column; justify-content: center; max-height: calc(80vh - 32px);max-width: 416px;position: relative; width: 90%;}.fc-consent-root .fc-help-dialog h1 {color: #000; font-size: 14px; font-weight: bold; line-height: 20px; margin: 24px 24px 0; min-height: max-content;}.fc-consent-root .fc-help-dialog h1:focus {outline: none;}.fc-consent-root .fc-help-dialog .fc-help-dialog-contents {margin: 8px 24px; overflow-y: auto; padding-bottom: 62px;}.fc-consent-root .fc-help-dialog .fc-help-dialog-contents div, .fc-consent-root .fc-help-dialog .fc-help-dialog-contents li, .fc-consent-root .fc-help-dialog .fc-help-dialog-contents p {color: #5f6368; font-size: 14px; line-height: 20px; margin-bottom: 8px;}.fc-consent-root .fc-help-dialog .fc-help-dialog-contents .fc-illustrations ul {margin-left: 20px;}.fc-consent-root .fc-help-dialog .fc-help-dialog-contents .fc-illustrations li {list-style-position: outside; list-style-type: decimal;}.fc-consent-root .fc-help-dialog .fc-help-dialog-contents .fc-vendor-purpose-feature-details > * {padding-top: 16px;}.fc-consent-root .fc-help-dialog .fc-help-dialog-contents .fc-vendor-purpose-feature-section-title {font-weight: bold;}.fc-consent-root .fc-help-dialog .fc-help-dialog-contents .fc-vendor-legitimate-interest-claim-link {margin-left: 20px;}.fc-consent-root .fc-help-dialog .fc-help-dialog-contents .fc-device-storage-disclosures p {margin-bottom: 0;}.fc-consent-root .fc-help-dialog .fc-help-dialog-contents .fc-vendor-device-storage-disclosures {margin-bottom: 24px;}.fc-consent-root .fc-help-dialog .fc-help-dialog-contents .fc-vendor-device-storage-disclosures p, .fc-consent-root .fc-help-dialog .fc-help-dialog-contents .fc-vendor-device-storage-disclosures li {margin-bottom: 8px;}.fc-consent-root .fc-help-dialog .fc-help-dialog-contents .fc-vendor-device-storage-disclosures li {list-style-position: outside; margin-left: 20px;}.fc-consent-root .fc-help-dialog .fc-help-dialog-contents a {color: #1967d2; cursor: pointer; font-size: 14px; line-height: 20px; margin-bottom: 8px;}.fc-consent-root .fc-help-dialog .fc-help-dialog-contents li {display: list-item; list-style-position: inside; list-style-type: disc;}.fc-consent-root .fc-help-dialog .fc-help-dialog-button-container {background-color: #FFFFFFe6; bottom: 0; border-radius: 0 0 8px 8px; display: flex; flex: 1 1 auto; justify-content: center; left: 0; position: absolute; width: 100%;}.fc-consent-root .fc-help-dialog .fc-help-dialog-close-button {background-color: #FFFFFF00; border: 0; border-radius: 20px; cursor: pointer; flex: 1 1 auto; margin: 8px 12px; opacity: 1; outline: none;}.fc-consent-root .fc-help-dialog-close-button .fc-help-dialog-close-button-label {color: #1967D2; font-size: 14px; font-style: normal; font-weight: bold; line-height: 20px; padding: 6px 0; text-align: center;}.fc-consent-root .fc-help-dialog-close-button:focus .fc-help-dialog-close-button-label {cursor: pointer; outline: auto;}.fc-consent-root i.material-icons {font-family: 'Material Icons';}</style></head>	

<body class="firefox firefox126"><div class="cc-revoke cc-bottom cc-animate cc-color-override--316233370" style="display: none;">Cookie Policy</div><div role="dialog" aria-live="polite" aria-label="cookieconsent" aria-describedby="cookieconsent:desc" class="cc-window cc-banner cc-type-opt-in-out cc-theme-edgeless cc-bottom cc-color-override--316233370 " style=""><!--googleoff: all--><span id="cookieconsent:desc" class="cc-message">Like every other website we use cookies. By using our site you acknowledge that you have read and understand our <a href="/info/cookie.aspx">Cookie Policy</a>, <a href="/info/privacy.aspx">Privacy Policy</a>, and our <a href="/info/TermsOfUse.aspx">Terms of Service</a>. <a aria-label="learn more about cookies" role="button" tabindex="0" class="cc-link" href="https://www.codeproject.com/info/privacy.aspx" rel="noopener noreferrer nofollow" target="_blank">Learn more</a></span><div class="cc-compliance cc-highlight"><a aria-label="dismiss cookie message" role="button" tabindex="0" class="cc-btn cc-dismiss">Ask me later</a><a aria-label="deny cookies" role="button" tabindex="0" class="cc-btn cc-deny">Decline</a><a aria-label="allow cookies" role="button" tabindex="0" class="cc-btn cc-allow">Allow cookies</a></div><!--googleon: all--></div>

	<div id="ctl00_OneTap_OneTap">
    <div id="g_id_onload" data-client_id="857795997829.apps.googleusercontent.com" data-login_uri="/script/Membership/OAuthLogOn.aspx?auth=Google">
    </div>
</div>



	<a class="access-link" href="#Main"><img alt="Click here to Skip to main content" src="https://codeproject.freetls.fastly.net/images/t.gif"></a>




<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed">
        <div class="main-content">
            

<div class="container memberbar clearfix flex-container flex-extend">

	<div id="ctl00_MemberBar_GenInfo" class="flex-item align-left">15,917,808 members</div>

	<div class="flex-item">
		
	</div>

	<div class="flex-item align-right">

		

		

		

			<script type="text/javascript">//<!--
			function doSubmit(secure)
			{
				if (secure)
					document.signinForm.action = "https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f5304605%2fCreating-Shellcode-from-any-Code-Using-Visual-Stud"
				else
					document.signinForm.action = "https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f5304605%2fCreating-Shellcode-from-any-Code-Using-Visual-Stud"
				document.signinForm.submit();
				return true;
			}//-->
			</script>

			<a name="SignUp"></a>
			<span class="member-signin">
				<a data-micromodal-trigger="modal-1" href="javascript:;">Sign in</a>
				<!--<a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f5304605%2fCreating-Shellcode-from-any-Code-Using-Visual-Stud">Sign in</a>-->

				<div class="micromodal" id="modal-1" aria-hidden="true">

					<div class="modal__overlay" tabindex="-1" data-micromodal-close="">
					  <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="modal-1-title">

						<header class="modal_header">
							<h4 class="modal_title" id="modal-1-title">
								Sign in
							</h4>
							<button class="modal_close" aria-label="Close modal" data-micromodal-close=""></button>
						</header>

						<form name="signinForm" id="signinForm" action="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f5304605%2fCreating-Shellcode-from-any-Code-Using-Visual-Stud" method="post" class="tight align-left">

							
							<input id="FormName" name="FormName" value="MenuBarForm" type="hidden">

							<div>Email</div>
							<div><input type="email" name="Email" id="Email" autocomplete="email"></div>
							<div>Password</div>
							<div><input type="password" name="Password" id="Password" autocomplete="current-password"></div>
							<div class="action">
								<input type="hidden" name="fld_quicksign" value="true">
								<input type="submit" value="Sign in" class="signin" onclick="return doSubmit(false);">
								<input id="joinBtn" type="button" class="create hidden" onclick="return Join();" value="Join" style="visibility: visible;">
							</div>

							<div class="container">						
								<a id="ctl00_MemberBar_SendPassword" class="forgot" href="/script/Membership/SendPassword.aspx?rp=/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud">Forgot your password?</a>
							</div>
						</form>

						<hr class="divider-dark">

						Sign in with &nbsp;<a class="oauth" alt="Sign in using Github" title="Sign in using Github" href="/script/Membership/OAuthLogOn.aspx?auth=GitHub"><img src="/script/Membership/Images/octicons_github-lg.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>
<a class="oauth" alt="Sign in using Facebook" title="Sign in using Facebook" href="/script/Membership/OAuthLogOn.aspx?auth=Facebook"><img src="/script/Membership/Images/facebook-lg.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>
<a class="oauth" alt="Sign in using Google" title="Sign in using Google" href="/script/Membership/OAuthLogOn.aspx?auth=Google"><img src="/script/Membership/Images/google-plus-lg.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>
<a class="oauth" alt="Sign in using Microsoft" title="Sign in using Microsoft" href="/script/Membership/OAuthLogOn.aspx?auth=Microsoft"><img src="/script/Membership/Images/microsoft-lg.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>



					  </div>
					</div>
				  </div>

            </span>
		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed">
        <div class="main-content">
            <div class="logo"><a href="/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/logo250x135.gif" alt="Home" style="height:135px;width:250px;border-width:0px;"></a></div>
            <div class="promo"><div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Security" data-country="US" data-tags="C, Advanced, security, VC++, C++17, VS2019,rating4.5,article-5304605"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Security&sz=728x90&c=987587"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Security&sz=728x90&c=987587"  width="728px" height="90px" target="_blank"/></a></noscript></div></div>
        </div>
    </div>

	
	<div id="ctl00_TPR" class="sub-headerbar flex-container flex-extend flex-wrap fixed">
		<div class="flex-item" style="min-width:20rem">
			

<div class="navbar clearfix">
<ul class="navmenu openable">

<li class="desktop-only"><a id="ctl00_TopNavBar_Home" href="https://www.codeproject.com">home</a>


</li><li class="openable"><a id="ctl00_TopNavBar_Art" class="down selected" href="/script/Articles/Latest.aspx">articles</a>

	<ul>
		<li class="openable"><a id="ctl00_TopNavBar_ArtTopicList" class="fly" onmouseover="navBarMenu.ShowMap(this, 'ctl00_TopNavBar_MapFlyout');" href="/script/Content/SiteMap.aspx">Browse Topics<span class="has-submenu">&gt;</span></a><ul id="ctl00_TopNavBar_MapFlyout" class="taxonomy">
			<li>
				<div id="siteMap"></div>
			</li>
			</ul>
		</li>
		<li><a id="ctl00_TopNavBar_ArtLatestArts" class="fly" href="/script/Articles/Latest.aspx">Latest Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtTop" class="fly" href="/script/Articles/TopArticles.aspx?ta_so=5">Top Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtGuide" class="fly" href="/info/Submit.aspx">Posting/Update Guidelines</a></li>
		<li><a id="ctl00_TopNavBar_ArtHelpForum" class="fly" href="/Forums/1641/Article-Writing">Article Help Forum</a></li>
		<li><a id="ctl00_TopNavBar_ArtPostArticle" class="fly highlight1" href="/script/Articles/Submit.aspx">
			<img src="https://codeproject.freetls.fastly.net/images/write13.png" width="13" height="13"> Submit an article or tip
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtImportGitHub" class="fly highlight3" href="/script/Articles/ImportArticle.aspx">
			<img src="https://codeproject.freetls.fastly.net/images/write13.png" width="13" height="13"> Import GitHub Project
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtPostBlog" class="fly highlight2" href="/script/Articles/BlogFeed.aspx">
			<img src="https://codeproject.freetls.fastly.net/images/write13.png" width="13" height="13"> Import your Blog
			</a></li>		
        
        <li class="last"></li>
	</ul>

</li>



<li class="openable">
<a id="ctl00_TopNavBar_Answers" href="/script/Answers/List.aspx?tab=active">
    <span class="desktop-only tablet-only">quick answers</span><span class="mobile-only">Q&amp;A</span>
</a>
	<ul>
		<li id="ctl00_TopNavBar_AQL"><a id="ctl00_TopNavBar_ArticleQuestion" class="fly highlight1" href="#_comments">
			<img src="https://codeproject.freetls.fastly.net/images/write13.png" width="13" height="13"> Ask a Question about this 
			article</a>
		</li>

		<li><a id="ctl00_TopNavBar_QAAsk" class="fly highlight2" href="/Questions/ask.aspx"><img src="https://codeproject.freetls.fastly.net/images/write13.png" width="13" height="13"> Ask a Question</a></li>

		<li><a id="ctl00_TopNavBar_QAUnanswered" class="fly" href="/script/Answers/List.aspx?tab=unanswered">View Unanswered Questions</a></li>
		<li><a id="ctl00_TopNavBar_QALatest" class="fly" href="/script/Answers/List.aspx?tab=active">View All Questions</a></li>
        
				<li><a id="ctl00_TopNavBar_QATR_ctl00_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=81" style="padding-left:30px">View C# questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl01_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=78" style="padding-left:30px">View C++ questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl02_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=87" style="padding-left:30px">View Javascript questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl03_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=83" style="padding-left:30px">View Visual&nbsp;Basic questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl04_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=268" style="padding-left:30px">View Python questions</a></li>
			
    
		<li class="last"></li>
	</ul>

</li>



<li class="openable"><a id="ctl00_TopNavBar_Forums" href="/script/Forums/List.aspx">
        <span class="desktop-only tablet-only">discussions</span><span class="mobile-only">forums</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_CodeProjectAI" class="fly" href="/Feature/CodeProjectAI-Discussions.aspx">CodeProject.AI Server</a></li>
		<li><a id="ctl00_TopNavBar_MessageBoardsAll" class="fly" href="/script/Forums/List.aspx">All Message Boards...</a></li>
		<li class="openable"><a class="fly" style="padding-left:30px" href="/Forums/1580997/Application-Lifecycle">Application Lifecycle<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="/Forums/1533717/Running-a-Business">Running a Business</a></li>
<li><a class="fly" href="/Forums/1533716/Sales-Marketing">Sales / Marketing</a></li>
<li><a class="fly" href="/Forums/1651/Collaboration-Beta-Testing">Collaboration / Beta Testing</a></li>
<li><a class="fly" href="/Forums/3304/Work-Issues">Work  Issues</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="/Forums/369270/Design-and-Architecture">Design and Architecture</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1969389/Artificial-Intelligence">Artificial Intelligence</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/12076/ASP-NET">ASP.NET</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1580226/JavaScript">JavaScript</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1969388/Internet-of-Things">Internet of Things</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="/Forums/1647/C-Cplusplus-MFC">C / C++ / MFC<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="/Forums/4486/ATL-WTL-STL">ATL /  WTL / STL</a></li>
<li><a class="fly" href="/Forums/3785/Managed-Cplusplus-CLI">Managed C++/CLI</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1649/Csharp">C#</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1627782/Free-Tools">Free Tools</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1827460/Objective-C-and-Swift">Objective-C and Swift</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1725/Database">Database</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="/Forums/186301/Hardware-Devices">Hardware &amp; Devices<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="/Forums/1644/System-Admin">System Admin</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1606152/Hosting-and-Servers">Hosting and Servers</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1643/Java">Java</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1942421/Linux-Programming">Linux Programming</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1988311/Python">Python</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1650/NET-Core-and-Framework">.NET (Core and Framework)</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1848626/Android">Android</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1876716/iOS">iOS</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/13695/Mobile">Mobile</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1004257/WPF">WPF</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1646/Visual-Basic">Visual Basic</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1640/Web-Development">Web Development</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/suggestions.aspx">Site Bugs / Suggestions</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1652005/Spam-and-Abuse-Watch">Spam and Abuse Watch</a>
</li>

		<li class="last"></li>
	</ul>

</li>

<li class="openable"><a id="ctl00_TopNavBar_Features" href="/Feature/">
      <span class="desktop-only tablet-only">features</span><span class="mobile-only">features</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_Comps" class="fly" href="/script/Contests/CurrentCompetitions.aspx?cmpTpId=3&amp;amp;awsac=true">Competitions</a></li>
        
		<li><a id="ctl00_TopNavBar_News" class="fly" href="/script/News/List.aspx">News</a></li>
		<li><a id="ctl00_TopNavBar_Insider" class="fly" href="/Feature/Insider/">The Insider Newsletter</a></li>
    	<li><a id="ctl00_TopNavBar_DailyBuild" class="fly" href="/Feature/DailyBuild">The Daily Build Newsletter</a></li>
		<li><a id="ctl00_TopNavBar_Newsletters" class="fly" href="/script/Mailouts/Archive.aspx?mtpid=1">Newsletter archive</a></li>
		<li><a id="ctl00_TopNavBar_Surveys" class="fly" href="/script/Surveys/List.aspx">Surveys</a></li>
		
        
		<li><a id="ctl00_TopNavBar_Stuff" class="fly" href="/Info/Stuff.aspx">CodeProject Stuff</a></li>
		<li class="last"></li>
	</ul>

</li>


<li class="openable"><a id="ctl00_TopNavBar_Lounge" href="/Lounge.aspx">
            <span class="desktop-only tablet-only">community</span><span class="mobile-only">lounge</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_WhosWho" class="fly" href="/script/Membership/Profiles.aspx">Who's Who</a></li>
		<li><a id="ctl00_TopNavBar_MVPs" class="fly break" href="/script/Contests/Winners.aspx?obtid=1&amp;amp;cmpTpId=2&amp;amp;cid=0">Most Valuable Professionals</a></li>

		<li><a id="ctl00_TopNavBar_LoungeLnk" class="fly highlight2" href="/Lounge.aspx">The Lounge &nbsp;</a></li>
		<li><a id="ctl00_TopNavBar_SiteBlog" class="fly break" href="/Members/CodeProject#_comments">The CodeProject Blog</a></li>

		<li><a id="ctl00_TopNavBar_WhereAmILink" class="fly" href="/Forums/1939564/Where-I-am-Member-Photos">Where I Am: Member Photos</a></li>
		<li><a id="ctl00_TopNavBar_InsiderLnk" class="fly" href="/Insider.aspx">The Insider News</a></li>
		<li><a id="ctl00_TopNavBar_WeirdWonderful" class="fly" href="/Feature/WeirdAndWonderful.aspx">The Weird &amp; The Wonderful</a></li>

		<li class="last"></li>
	</ul>

</li>


<li class="openable" style="margin-left:20px"><a id="ctl00_TopNavBar_Help" href="/KB/FAQs/">
    <span class="desktop-only tablet-only">help</span><span class="mobile-only">?</span>
</a>


	<ul>
		<li><a id="ctl00_TopNavBar_HelpWhatIs" class="fly" href="/info/guide.aspx">What is 'CodeProject'?</a></li>
		<li><a id="ctl00_TopNavBar_HelpGeneral" class="fly break" href="/KB/FAQs/">General FAQ</a></li>
		<li><a id="ctl00_TopNavBar_HelpPostQuestion" class="fly break highlight2" href="/Questions/ask.aspx">Ask a Question</a></li>
		<li><a id="ctl00_TopNavBar_HelpBugs" class="fly" href="/suggestions.aspx">Bugs and Suggestions</a></li>
		<li><a id="ctl00_TopNavBar_HelpArticles" class="fly" href="/Forums/1641/Article-Writing">Article Help Forum</a></li>
		
		
		
		
		<li><a id="ctl00_TopNavBar_HelpAboutUs" class="fly" href="/info/about.aspx">About Us</a></li>
		<li class="last"></li>
	</ul>

</li>

</ul>

</div>
		</div>
		<div class="flex-item-tight align-right">
			

<div class="searchbar">

<form method="get" action="/search.aspx?sbo=kw" name="Search" class="tight">


<table border="0" cellspacing="0" cellpadding="0" class="search"><tbody><tr><td><input tabindex="2" class="search subdue" id="sb_tb" autocomplete="off" value="" name="q"></td><td><input type="image" src="https://codeproject.freetls.fastly.net/images/search.gif"></td></tr></tbody></table>

<div class="hover-container">
	<div id="SearchFilter" class="search-advanced small-text align-left" style="display: none;">
	<b>Search within:<br></b>
		
		<input type="radio" id="sb_kw" name="sbo" value="kw" checked="checked"><label for="sb_kw">Articles</label><br>
<input type="radio" id="sb_qa" name="sbo" value="qa"><label for="sb_qa">Quick Answers</label><br>
<input type="radio" id="sb_fm" name="sbo" value="fm"><label for="sb_fm">Messages</label><br>


		
		

		
		
	</div>
</div>
</form>

</div>
		</div>
		<div class="sub-headerbar-divider"></div>
	</div>		
	

	<div id="A" class="container-content-wrap fixed"> 

	<div class="container-content">

        
		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div><a rel="nofollow" href="/script/Content/SiteMap.aspx">Articles</a> / <a rel="nofollow" href="/script/Content/Tag.aspx?tags=security">Security</a></div>
			</div>

            <div class="float-left">
				
			</div>

			<div class="edit-links float-right">
				



 
&nbsp;










			</div>

			<div class="article-nav float-right">
				


<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    
</div>



 

<a id="ctl00_ActionLinks_PrintMd" data-tooltip="Print" data-enabletooltip="true" data-width="auto" href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?display=Print">
   <img src="/App_Themes/CodeProject/Img/print48.png" width="24" height="24" style="border:0">
</a>



<span id="ctl00_ActionLinks_R">
    
    
</span>
			</div>
		</div>

        
		<div class="extended article-container-parts">

			
		    <div id="ctl00_LeftSideBar" class="article-left-sidebar">

                <div id="ctl00_StickyBlock" class="article-left-sidebar-inner sticky">

                    
    		        

<div class="tabs">
	<div class=" selected">Article</div>
<div class="browse-code"><a href="/script/Articles/ViewDownloads.aspx?aid=5304605">View Code</a></div>
<div><a href="/script/Articles/Statistics.aspx?aid=5304605">Stats</a></div>
<div><a href="/script/Articles/ListVersions.aspx?aid=5304605">Revisions</a></div>


    
</div>



			        

			        <div>
                        
			            
			        </div>

                    

                    
                </div>
		    </div>
            

			
			<div id="AT" class="article-container  fixed"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="./View.aspx" id="aspnetForm" style="margin:0;padding:0">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="OGMLG2wTDahm1mjteV5xVMVbPX59cISFRxdWeax7tYEe6dNZpCLO8Ax+CfCxVL8UWTDvIS95BGg1obOaseQ/fjK76aOBBevj9mOqg6Kl5NI0PTM3zsrCvExwesl/UvcTjWa/DaxmWiShZ74xYMYrG2udoxSz5j5+ZpjLTkpV0Ighf99aZyB9gaDvacbOsuQkd7iJ4J1PliR14eYtHASwD1E1L4AOtdKc2lBpQJkYDL37724MXoxbJJEp0xvB491VgSc4Y8B4Fwhd9XHhdyo96GDSp9iqeqjv9Uo4WyL+cyAEl/HAvBArBQzkeOR3PrQQ/Gxp9lW0GCSZ3hsnyPNRkmgWA6Vl/QbwMu7hpHZXcMsWtEcoBSOUBQUnlaQEM6snWOniqtarKDz/IbpKHjondFiy44ajYJRXhf+Foq0justzcGBtLnr/kRkkKZf0bHf17sSwWw1tXBLLeBu6fTfUVzGTIPzg4iwvEsjLkTlpB/7hcCWiSSwx7xMxUn8G5hDOxb/pMplrOk7POPUzlRHRgYj+uIt6D4saHwXmRzavILyhAHnkvgVvTo8FXLPkBTLEWEQcEz8kzkXWAwdBqxYZOIo7X9SauFW6TX1qyq18cxMJjeYCAsPtOEe74Vy7EvuXmOggFP+xut4Z3YAhX6nBQ8+oFU93Fn1T0GVRREKcaToJLo0CavoYK05Lukz47GC6wEzlHUbJqko7SOq9M0I7gpJXxk6QAQmLixgCvmVq4b+4LxOKoD43folbrdDJ8qxzZrU3b6I1e8YuFVlJIyc6i5AOx8gKle8JV2elsUH20wdi6gGxIFrqecbRb5u8TocHx59uLoSi3dvIAr1xY2FnDUPW4kqbkEzRSdoN/pHiazuumvdrY43mHNHzZLatWeL10OMRuAvDqDz1AHitTCGG+ix6hrCnSsxPiE6WfrxnZJ9T8U3dAqdb11RQrJFmJ9EUZ25gBPe5ihC9AYuGI8bS/FFL9H7wqAAO95LpODgN9b6HNJqBOQOLoshT38y5r6tcaJSdHHeH+M/PDRusRWhNWATRq1mxW+4Ov/asf1EbiLdL0ypX3bZOdgAm4Ur9p3pGIwxOnLb+jpgyAuNfTY1CzMRb9eZ8EePK2ITqL3+vYpE+qxHMGIR0bvzgwOsjElkKsUcUmARvqZsmK3DrWyyU2DTQgvlOU2R08+9GBD/r1muCqeuwanje1NcMxM7b6/dgp3iq+0KX87zlP9efao46ZoCo2s37LsFnnZkgqUuNeX9a01KCPjJXQkTUY/sRBm2oPHHdMOst5qHsB8YqhV3YqaTHmix+4P+g+sbw2JHiRw21gvSGk3JQkOvBSXdJpE8mECR8mIAKkrbdWvOcFNSGxeybmhriNYxP2VZetruOmng3df1DbL+99ColptOs0iyNVLfssqaNXL3Ja4zSr/8NUeDhdmVHPU4TlshpX1d4bQHJ8IXtMmJniHh8Z7vGoxdlnLQ3tfnqyBtVc3OZ7lSuvozoK7N+FJQ1SBHQvcXm516CVZmrkTkrg5fOBNLfJbUvVZHS1YhMos0++swSi26izMVpVw5QbBz5Ru6wyKgrzu0Zin75cnyjhBzieLLZ7M5xTCcmurfbFb14nOCm0F9SMWXtOM8g+/wYio2xdwiw/ImSpGlMuG2K7CAFpQCabdPnpiReuZbx5lNZQ4KZGsH4/Q4ZyzuNGQDlGgZCF70qs49pfVfbXmd+9F/9wsItOzsT35epZICBr96fjXmGHw+NH2XI3yI3prM4O6/0KmNJ66AufZ0fhwyu0VkblNtEUDzKOakAQ4skIpWSerWa7HPUOtTqITFGqeDYTuO4sHQrhE/17W9djVJRo5M6EPr1wGmOZvp7/rPeltdk5XyYtwc3wBfYN3IZe+MxBryS5HEutG3FEO7f/Nse5EfRaGtWiSunjcoQYYunN5G3PMXxdbsif7TZ7mqByCPviaAhOZ8Le3/hzVuHh63ejxfEAMEa0jtsb6KTxnEambGJ0g30FMFOSp+cA01bGv5VyNGaZ0spextn/kSzjSwivmNccv/pQzlG1hpsFkZnrBnTcP7hgIRA63fqDoJmUYnxtrGp9O9egUP3MPf1odLrbtruU7Nv58dezverM2XTkU4FWDSe2qyNOSu1882alfJkAk4bQKxKPNTV7G+8aFuYJlucDr6z5lnfaQZhRcq1krBRAOoJrVrBcPX739KGsohIuaUol8avcqeAXH1joOz6VOg4o0Ec+lDJ94fLaum+zEpJkHkOihT4L1mItJi9KknZQ4p7irV+CvEJrgBOu5GbM1Pxbw/Rv/6A2YhZpVaipuDAwC87CAF1bRCEbAjoAIxmNHyVR8qU77Fw10grXzhEw1o4lmxx2xVQX7YH4kMpBeeH6ObQIiAeCgefhSiGlMWxzvvZZdMHJnISiVrDtY+HELhsFEfS9f5f7x2qUT0tr/q6IgdZ6oxnVxiT0kgQgCM81nC8mPQjR00w3qfnYByB39OMbBLgaBrAh2bj34GZPtDas6l8JG9tRheHT8s=">
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69">
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>
					    <a name="_articleTop" id="_articleTop"></a>

					    
						<div>
							<span id="ctl00_TagListHorz_TagWrp" class="tags horizontal">

	
	

	
	<span id="ctl00_TagListHorz_VisibleTags"><div class="t"><a rel="tag" href="/Tags/C" data-id="80">C</a></div><div class="t"><a rel="tag" href="/Tags/security" data-id="810">security</a></div><div class="t"><a rel="tag" href="/Tags/VCplusplus" data-id="4123">VC++</a></div><div class="t"><a rel="tag" href="/Tags/Cplusplus17" data-id="4506">C++17</a></div><div class="t"><a rel="tag" href="/Tags/VS2019" data-id="4808">VS2019</a></div></span> 

	
	
</span>


						</div>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">Creating Shellcode from any Code Using Visual Studio and C++</h1>
					    </div>

                        <div>
					        
					        <div class="entry flex-container">

								<div id="ctl00_avatarWrap" class="avatar-wrap align-center">
									<img src="https://www.codeproject.com/script/Membership/ProfileImages/{68de1770-73ee-4cb9-b0b7-c7d1af3ea882}.jpg" id="ctl00_avatar" class="avatar">
								</div>

                                <div class="flex-item" style="flex:1 1 auto">
                                    <div class="flex-container" style="justify-content:space-between;flex-wrap:wrap-reverse">
                                       <span id="ctl00_Authors" class="author flex-item"><a href="/script/Membership/View.aspx?mid=13742737" rel="author">The Ænema</a></span> 

                                        <div class="flex-item" style="margin-top:-4px;">
                                            <div id="ctl00_RateArticle_RatingTable" class="small-text" data-objectref="2_5304605">

	<meta itemprop="upvoteCount" content="27">


	<div id="ctl00_RateArticle_RatingRow" class="flex-container rating-container large-stars">

					
		<div id="ctl00_RateArticle_Prompt" class="rating-prompt nowrap">Rate me:</div>

		
		<div class="nowrap tooltip">

			
			
			

			
			<div id="ctl00_RateArticle_RatingHistWrap" class="tooltip">

				
				<div id="ctl00_RateArticle_ResultWithHist" class="rating-result"><div class="flex-container rating-stars large-stars"><div><img src="https://www.codeproject.com/script/Ratings/Images/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="https://www.codeproject.com/script/Ratings/Images/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="https://www.codeproject.com/script/Ratings/Images/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="https://www.codeproject.com/script/Ratings/Images/star-fill-lg.png" style="width:24px;height:24px"></div><div style="width:21px;" class="clipped"><img src="https://www.codeproject.com/script/Ratings/Images/star-fill-lg.png" style="width:24px;height:24px"></div><div style="width:3px;position:relative" class="clipped"><img src="https://www.codeproject.com/script/Ratings/Images/star-empty-lg.png" style="width:24px;height:24px;position:absolute;top:0px;right:0"></div></div></div>
				

				<div class="speech-bubble-container-up-right" style="width:170px">
					<div class="speech-bubble-up-right">
						<div class="histogram"></div>
					</div>
					<div class="speech-bubble-pointer-up-right">
						<div class="speech-bubble-pointer-up-right-inner"></div>
					</div>
				</div>
			</div>

			
            

			
            <span id="ctl00_RateArticle_RatingSignin" class="speech-bubble-container-down">
		        <div class="speech-bubble-down">
                    Please <a id="ctl00_RateArticle_SignUp" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f5304605%2fCreating-Shellcode-from-any-Code-Using-Visual-Stud">Sign up or sign in</a> 
                    to vote.
		        </div>
		        <div class="speech-bubble-pointer-down">
			        <div class="speech-bubble-pointer-down-inner"></div>
		        </div>
	        </span>    

		</div>
		
	
		
		<div id="ctl00_RateArticle_VoteCountNoHist" class="rating-votes nowrap">4.91/5  (31 votes)</div>	

		

		
		<div class="rating-undo" title="Undo vote" style="margin-left:5px;display:none"></div>

		
		
	</div>

	
	

</div>

                                        </div>
                                    </div>

                                    <div class="flex-container" style="color:#666;font-size:smaller">
                                        <span id="ctl00_LastUpdated" class="date flex-item-tight" title="Date last updated">7 Jun 2021</span><a id="ctl00_LicenseLink" title="The Code Project Open License (CPOL)" class="license flex-item-tight" href="http://www.codeproject.com/info/cpol10.aspx">CPOL</a><span id="ctl00_ReadingTime" class="stats flex-item-tight">9 min read</span><span id="ctl00_HorizontalStats" class="stats flex-item-tight"><span class="stats"><span title="Views"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/views32.png" style="width:16px"> 48.8K</span> &nbsp; <span title="Downloads"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/download32.png" style="width:16px"> 1.2K</span> &nbsp; <span title="Bookmarks"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/bookmarks32.png" style="width:16px"> 40</span> &nbsp; <span title="Comments"><a href="#_comments"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/message32.png" style="width:16px;border:0"> 36</a></span></span></span>
                                    </div>
                                </div>
					        </div>

                            

                        </div>

                        <div id="ctl00_DescriptionSpot" class="summary">Learn how to convert any code to a stable shellcode using Visual Studio 2019 and VC++ in easy steps!</div><span id="ctl00_ThumbnailUrl" class="date" content="https://www.codeproject.com/KB/Articles/5304605/Thumbnail.png"></span>			

                    </div>
                    
					
					

					

					
					<div id="ctl00_Abstract" class="abstract">In this tutorial, we use Visual Studio 2019 and C++ to generate independent x64 machine code that can be used as shellcode, This operation needs extreme skills, but with this tutorial, you can generate your shellcode very easily...</div>

					
					

						
					

					

						
						<div id="contentdiv" class="text">
						



<h2>Introduction</h2>

<p>Shellcode is one of the most popular things in attacking and hacking, it's described in many different ways, but let's see what Wikipedia says:</p>

<blockquote class="quote">
<div class="op">Wikipedia:</div>

<p>In <a class="mw-redirect" href="https://en.wikipedia.org/wiki/Hacker_(computer_security)" title="Vulnerability (computing)">hacking</a>, a <b>shellcode</b> is a small piece of code used as the <a href="https://en.wikipedia.org/wiki/Payload_(computing)" title="Payload (computing)">payload</a> in the <a href="https://en.wikipedia.org/wiki/Exploit_(computer_security)" title="Hacker (computer security)">exploitation</a> of a software <a href="https://en.wikipedia.org/wiki/Vulnerability_(computing)" title="">vulnerability</a>.<br>
It is called "shellcode" because it typically starts a <a href="https://en.wikipedia.org/wiki/Shell_(computing)" title="Shell (computing)">command shell</a> from which the attacker can control the compromised machine, but any piece of code that performs a similar task can be called shellcode.</p>
</blockquote>

<p>Yep. It's very correct but I describe shellcode as a piece of code that can be allocated and executed <strong>dynamically at runtime</strong> and it has no dependency on any static API of operating system or programming runtimes.</p>

<p>It may be wrong but this is the best name I could find for what we are going to do in this article, so...</p>

<p>Let's start!</p>

<h2>Background</h2>

<p>The reasons I ended up doing this kind of stuff are:</p>

<ol>
	<li>Improving my programming skills and my understanding of how a computer works</li>	<li>Improving security of my applications and games</li>	<li>It's damn fun!</li></ol>

<p>Yes of course! it can be used for bad and malicious purposes but you know... It's a sword! <strong>Protect or harm... it's up to you!</strong></p>

<p>By using this technique, you can convert critical parts of your code like license checking to shellcode and encrypt it in your application. When you need to approve a license, you just decrypt the code to a heap-based space and execute it, after you finished, you dispose and release the code from memory... this makes the code harder to debug and prevent static program analysis.</p>

<h2>Preparing Project and Environment</h2>

<h3>1. Required Tools &amp; Software</h3>

<ul>
	<li>Visual Studio 2019</li>	<li>VC++ Build Tools</li>	<li><a href="https://ntcore.com/files/CFF_Explorer.zip">CFF Explorer</a> ( PE Viewer/Editor )</li>	<li><a href="https://mh-nexus.de/en/hxd/">HxD</a> (Hex Editor)</li></ul>

<h3>2. Creating Empty Projects</h3>

<ol>
	<li>Open Visual Studio 2019</li>	<li>Create two&nbsp;empty C++ projects.</li>	<li>Name one <code>code_gen </code>and other one <code>code_tester</code></li>	<li>Set <code>code_gen</code> <strong>Configuration Type</strong> to <strong>"Dynamic Library (<em>.dll</em>)"</strong></li>	<li>Set <code>code_tester</code> <strong>Configuration Type</strong> to <strong>"Application (<em>.exe</em>)"</strong></li>	<li>Set projects to <strong>x64 and Release</strong> mode.</li></ol>

<h3>3. Configuring Dynamic-Library to API Independent PE File</h3>

<p>Currently, our <code>code_gen </code>is depended on CRT (C Runtime) and Windows Kernel. Follow the steps to make it fully independent.</p>

<ol>
	<li>Add a <strong><em>.cpp</em> (not <em>.c</em>)</strong> file to <code>code_gen </code>and write this basic code in it:

	<div class="pre-lang" id="premain372086"><div>C++</div><div class="pre-action-link"><span id="copycode372086" class="copy-code" data-index="372086" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre372086" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="C++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-comment">// code.cpp
</span><span class="code-keyword">extern</span> <span class="code-string">"</span><span class="code-string">C"</span> <span class="code-keyword">bool</span> _code()
{
    <span class="code-keyword">return</span> <span class="code-keyword">true</span>;
}</pre>
	</li>	<li>Go to <code>code_gen </code>project settings and configure the following options:
	<ul class="property">
		<li>Advanced &gt; Use Debug Libraries: <strong>No</strong></li>		<li>Advanced &gt; Whole Program Optimization: <strong>No Whole Program Optimization</strong></li>		<li>C/C++ &gt; General &gt; Debug Information Format: <strong>None</strong></li>		<li>C/C++ &gt; General &gt; SDL checks: <strong>No (/sdl-)</strong></li>		<li>C/C++ &gt; Code Generation &gt; Enable C++ Exceptions: <strong>No</strong></li>		<li>C/C++ &gt; Code Generation &gt; Runtime Library: <strong>Multi-threaded (/MT)</strong></li>		<li>C/C++ &gt; Code Generation &gt; Security Check: <strong>Disable Security Check (/GS-)</strong></li>		<li>C/C++ &gt; Language &gt; Conformance mode: <strong>No</strong></li>		<li>C/C++ &gt; Language &gt; C++ Language Standard: <strong>ISO C++17 Standard (/std:c++17)</strong></li>		<li>Linker &gt; Input &gt; Additional Dependencies: <strong>Empty</strong></li>		<li>Linker &gt; Input &gt; Additional Dependencies &gt; <strong>Uncheck Inherit parent or project defaults</strong></li>		<li>Linker &gt; Input &gt; Ignore All Default Libraries: <strong>Yes (/NODEFAULTLIB)</strong></li>		<li>Linker &gt; Debugging &gt; Generate Debug Info: <strong>No</strong></li>		<li>Linker &gt; Debugging &gt; Generate Map File: <strong>Yes (/MAP)</strong></li>		<li>Linker &gt; Debugging &gt; SubSystem:<strong> </strong><strong>Native (/SUBSYSTEM:NATIVE)</strong></li>		<li>Linker &gt; Optimization &gt; References: <strong>No (/OPT:NOREF)</strong></li>		<li>Linker &gt; Advanced &gt; Entry Point: <strong>_code</strong></li>		<li>Linker &gt; Advanced &gt; No Entry Point: <strong>Yes (/NOENTRY)</strong></li>	</ul>

	<blockquote class="quote">
	<div class="op">NOTE:</div>

	<p>By changing entry point property to _code, we prevent resource only DLL generation, also we tell the compiler not to use CRT entrypoint.</p>
	</blockquote>
	</li></ol>

<h3>4. Configuring Tester Application</h3>

<p>Tester doesn't need any special configs, currently, we will focus only on code generation, manipulation and execution.</p>

<p>Add a <em>main.cpp</em> file to <code>code_tester </code>and write this basic code in it:</p>

<div class="pre-lang" id="premain53821"><div>C++</div><div class="pre-action-link"><span id="copycode53821" class="copy-code" data-index="53821" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre53821" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="C++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-comment">// main.cpp
</span>
<span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">windows.h</span><span class="code-keyword">&gt;</span>
</span><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">iostream</span><span class="code-keyword">&gt;</span>
</span>
<span class="code-keyword">using</span> <span class="code-keyword">namespace</span> std;

<span class="code-keyword">int</span> main()
{
    <span class="code-keyword">return</span> EXIT_SUCCESS;
}</pre>

<h6>In the next part of this article, I will teach you how to create applications with your own custom structure.</h6>

<p><strong>Alright, now we're all set and ready! </strong>Also, you can download the basic setup source here if you're a lazy genius kind of person. ;)</p>

<ul class="download">
	<li><a href="/KB/Articles/5304605/01_shellcode_tutorial_starter_kit_vs16_x64.zip">Download StarterKit source - 3.1 KB</a></li></ul>

<h2>Basic Approach</h2>

<p>Let's start from something small and basic using only math, change the <code>_code </code>function to this:</p>

<div class="pre-lang" id="premain75402"><div>C++</div><div class="pre-action-link"><span id="copycode75402" class="copy-code" data-index="75402" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre75402" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="C++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">extern</span> <span class="code-string">"</span><span class="code-string">C"</span> <span class="code-keyword">int</span> _code(<span class="code-keyword">int</span> x, <span class="code-keyword">int</span> y)
{
    <span class="code-keyword">return</span> x * y + (x + y);
}</pre>

<p>Now compile and you should get the DLL, if not... check all the steps again and make sure your configuration is all correct.</p>

<p><img src="/KB/Articles/5304605/img01-r-700.png" style="width: 700px; height: auto; cursor: pointer; border: 0" alt="Image 1" onclick="imageCleanup.showFullImage('/KB/Articles/5304605/img01.png')" class="lazyload" data-sizes="auto" data-srcset="/KB/Articles/5304605/img01-r-400.png 400w, /KB/Articles/5304605/img01-r-700.png 700w, /KB/Articles/5304605/img01.png 946w"></p>

<p>We only need <em>.dll</em> and <em>.map</em> file, our DLL file contains the assembled x64 machine code and our map file contains information about the addresses used by the linker, but the most important thing inside the map file is the address and offset of our code inside the virtual memory space that our code gets mapped.</p>

<ol>
	<li>Open <em>code_gen.dll</em> with CFF Explorer.

	<p><img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" style="width: 640px; height: 203px" alt="Image 2" data-src="/KB/Articles/5304605/img02.png" class="lazyload" data-sizes="auto" data-srcset="/KB/Articles/5304605/img02-r-400.png 400w, /KB/Articles/5304605/img02.png 640w"></p>

	<p>As you can see, our DLL has no import/export address table (IAT/EAT) and we have only three sections, we don't need the last two of them, one contains debug directory data and one contains default resources like file version. The code we are looking for is inside<strong> .text section which contains machine codes</strong>.</p>

	<p>The only information we need from section area (PE Viewer) is <em>.text</em> section <strong>Virtual Address </strong>and <strong>Raw Address</strong>.</p>
	</li>	<li>Open <em>code_gen.dll</em><strong> </strong>inside HxD or any other hex editor, Press <strong>Ctrl+G</strong><em> </em>or select <strong>Search-&gt;Goto...</strong><em> </em>and enter the raw address... That's the code we're looking for! Pretty easy, right?
	<p><img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" style="width: 617px; height: 411px" alt="Image 3" data-src="/KB/Articles/5304605/img03.png" class="lazyload" data-sizes="auto" data-srcset="/KB/Articles/5304605/img03-r-400.png 400w, /KB/Articles/5304605/img03.png 617w"></p>

	<p><strong>C3</strong> opcode means <strong>RETURN </strong>which shows it's the end of our function, we don't need the zero bytes at all.</p>
	</li>	<li>Select the bytes and select <strong>Edit -&gt; Copy as -&gt; C</strong> from menu bar and then paste it inside <em>main.cpp</em>.
	<p>The code should look like this:</p>

	<div class="pre-lang" id="premain461700"><div>C++</div><div class="pre-action-link"><span id="copycode461700" class="copy-code" data-index="461700" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre461700" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="C++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">windows.h</span><span class="code-keyword">&gt;</span>
</span><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">iostream</span><span class="code-keyword">&gt;</span>
</span>
<span class="code-keyword">using</span> <span class="code-keyword">namespace</span> std;

<span class="code-keyword">unsigned</span> <span class="code-keyword">char</span> _code_raw[<span class="code-digit">9</span>] = { <span class="code-digit">0x8D</span>, <span class="code-digit">0x42</span>, <span class="code-digit">0x01</span>, <span class="code-digit">0x0F</span>, <span class="code-digit">0xAF</span>, <span class="code-digit">0xC1</span>, <span class="code-digit">0x03</span>, <span class="code-digit">0xC2</span>, <span class="code-digit">0xC3</span> };

<span class="code-keyword">int</span> main()
{
    <span class="code-keyword">return</span> EXIT_SUCCESS;
}</pre>
	</li>	<li>Now we should create our function type definition, add this code in global scope:
	<div class="pre-lang" id="premain561649"><div>C++</div><div class="pre-action-link"><span id="copycode561649" class="copy-code" data-index="561649" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre561649" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="C++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">typedef</span> <span class="code-keyword">int</span>(*_code_t)(<span class="code-keyword">int</span>, <span class="code-keyword">int</span>);</pre>
	</li>	<li>It's time to set our raw code access flag to executable so CPU can execute it, add this code in main:
	<div class="pre-lang" id="premain135857"><div>C++</div><div class="pre-action-link"><span id="copycode135857" class="copy-code" data-index="135857" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre135857" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="C++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true">DWORD old_flag;
VirtualProtect(_code_raw, <span class="code-keyword">sizeof</span> _code_raw, PAGE_EXECUTE_READWRITE, &amp;old_flag);</pre>
	</li>	<li>And the last step is execution which is pretty simple, add this code before return:
	<div class="pre-lang" id="premain442698"><div>C++</div><div class="pre-action-link"><span id="copycode442698" class="copy-code" data-index="442698" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre442698" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="C++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true">_code_t fn_code = (_code_t)(<span class="code-keyword">void</span>*)_code_raw;
<span class="code-keyword">int</span> x = <span class="code-digit">500</span>; <span class="code-keyword">int</span> y = <span class="code-digit">1200</span>;
printf(<span class="code-string">"</span><span class="code-string">Result of function : %d\n"</span>, fn_code(x, y));</pre>
	</li>	<li>Build <code>code_tester </code>and run it, Bam! It's working! Result should look like:
	<blockquote class="quote">
	<div class="op">Result of code_tester.exe:</div>

	<p>Result of function : 601700</p>
	</blockquote>
	</li></ol>

<p>Well, this was a very basic approach without any allocation, encryption/decryption, compression/decompression, etc., but good enough to give you an understanding of what's happening here.</p>

<ul class="download">
	<li><a href="/KB/Articles/5304605/02_shellcode_tutorial_basic_approach_vs16_x64.zip">Download Basic Approach source - 9.4 KB</a></li></ul>

<p><strong>Now... let's go to the next level!</strong></p>

<h2>Advanced Approach</h2>

<p>In the basic approach, we had the actual code because it was very basic but when it comes to more complex codes like compression, encryption, license checking, etc., it's not easy like this anymore, code can get its offset at any address in the binary and that's why we need <em>.map</em> file.</p>

<p>Also in basic approach, we didn't use any c runtime or Windows API but in the real world, we need them a lot... so we have to solve this issue as well. <sup>(Explained in Part 2)</sup></p>

<p>Alright, in this part of the article, we create two shellcodes, one for encrypting buffer and one for decrypting buffer.</p>

<ol>
	<li>Clone<strong> <a href="https://github.com/kokke/tiny-AES-c">tiny-aes-c</a> </strong>repo to your computer, copy only <em>aes.c</em> and <em>aes.h</em> in <code>code_gen </code>project.</li>	<li>Change the<strong> </strong><em>code.cpp</em> to this:
	<div class="pre-lang" id="premain89815"><div>C++</div><div class="pre-action-link"><span id="copycode89815" class="copy-code" data-index="89815" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre89815" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="C++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-comment">// code.cpp
</span><span class="code-keyword">extern</span> <span class="code-string">"</span><span class="code-string">C"</span>
{
    <span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-string">"</span><span class="code-string">aes.h"</span>
</span>
    <span class="code-keyword">bool</span> _encrypt(<span class="code-keyword">void</span>* data, <span class="code-sdkkeyword">size_t</span> size)
    {
        <span class="code-comment">// Encryption Code Area //
</span>        <span class="code-keyword">return</span> <span class="code-keyword">true</span>;
    }
}</pre>

	<blockquote class="quote">
	<div class="op">NOTE:</div>

	<p>You can avoid using extern "C" if you change <em>code.cpp</em> to <em>code.c</em> but you can't use any C++ feature in future, anyway most of the C++ libraries are based on C and they are all compatible with this method.</p>
	</blockquote>

	<p><strong>tiny-aes-c</strong> is based on C language and there's only some C runtime functions that the compiler will optimize to pure machine codes, this means our shellcode is already heavily optimized by compiler and this is a good thing!</p>
	</li>	<li>Write the encryption code like this and don't use any data on stack, <strong>you must not have a .data section in your DLL file after compile</strong>, If you do check all the codes and put stack-based data inside the functions.
	<p>Here's the code for encryption:</p>

	<div class="pre-lang" id="premain235747"><div>C++</div><div class="pre-action-link"><span class="code-collapse" data-index="235747" id="preShrink235747">Shrink ▲</span> &nbsp; <span id="copycode235747" class="copy-code" data-index="235747" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre235747" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="C++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-comment">// code.cpp
</span><span class="code-keyword">extern</span> <span class="code-string">"</span><span class="code-string">C"</span>
{
    <span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-string">"</span><span class="code-string">aes.h"</span>
</span>
    <span class="code-keyword">bool</span> _encrypt(<span class="code-keyword">void</span>* data, <span class="code-sdkkeyword">size_t</span> size)
    {
        <span class="code-comment">// Allocate data on heap
</span>        <span class="code-keyword">struct</span> AES_ctx ctx;
        <span class="code-keyword">unsigned</span> <span class="code-keyword">char</span> key[<span class="code-digit">32</span>] = {
        <span class="code-digit">0xBB</span>, <span class="code-digit">0x17</span>, <span class="code-digit">0xCA</span>, <span class="code-digit">0x8C</span>, <span class="code-digit">0x69</span>, <span class="code-digit">0x7F</span>, <span class="code-digit">0xA1</span>, <span class="code-digit">0x89</span>,
        <span class="code-digit">0x3B</span>, <span class="code-digit">0xCF</span>, <span class="code-digit">0xA8</span>, <span class="code-digit">0x12</span>, <span class="code-digit">0x34</span>, <span class="code-digit">0x6F</span>, <span class="code-digit">0xB6</span>, <span class="code-digit">0xE8</span>,
        <span class="code-digit">0x79</span>, <span class="code-digit">0x89</span>, <span class="code-digit">0xDA</span>, <span class="code-digit">0xD0</span>, <span class="code-digit">0x0B</span>, <span class="code-digit">0xA9</span>, <span class="code-digit">0xA1</span>, <span class="code-digit">0x1B</span>,
        <span class="code-digit">0x5B</span>, <span class="code-digit">0x38</span>, <span class="code-digit">0xD0</span>, <span class="code-digit">0x4A</span>, <span class="code-digit">0x20</span>, <span class="code-digit">0x4D</span>, <span class="code-digit">0xB8</span>, <span class="code-digit">0x0E</span>};
        <span class="code-keyword">unsigned</span> <span class="code-keyword">char</span> iv[<span class="code-digit">16</span>] = {
        <span class="code-digit">0xA3</span>, <span class="code-digit">0xF3</span>, <span class="code-digit">0xD4</span>, <span class="code-digit">0xC5</span>, <span class="code-digit">0x5E</span>, <span class="code-digit">0xCD</span>, <span class="code-digit">0x41</span>, <span class="code-digit">0xA6</span>,
        <span class="code-digit">0x22</span>, <span class="code-digit">0xC9</span>, <span class="code-digit">0x8D</span>, <span class="code-digit">0xE5</span>, <span class="code-digit">0xA3</span>, <span class="code-digit">0xBB</span>, <span class="code-digit">0x29</span>, <span class="code-digit">0xF1</span>};

        <span class="code-comment">// Initialize encrypt context
</span>        AES_init_ctx_iv(&amp;ctx, key, iv);

        <span class="code-comment">// Encrypt buffer
</span>        AES_CBC_encrypt_buffer(&amp;ctx, (uint8_t*)data, size);
        <span class="code-keyword">return</span> <span class="code-keyword">true</span>;
    }
}</pre>
	</li>	<li>Compile and open <em>code_gen.dll</em> with CFF Explorer:
	<p><img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" style="width: 600px; height: 193px" alt="Image 4" data-src="/KB/Articles/5304605/img04.png" class="lazyload" data-sizes="auto" data-srcset="/KB/Articles/5304605/img04-r-400.png 400w, /KB/Articles/5304605/img04.png 600w"></p>

	<p>As you see, there's a<strong> <em>.rdata</em> section</strong> added to the DLL, this section is generated by <code>tiny-aes-c</code> for <code>sbox </code>and <code>rsbox</code> lookup tables and it's not possible to make the machine code work without these data.</p>

	<p>Manually merging two sections data and re-addressing every value in the machine code is pretty much hard and needs a lots of time but...</p>

	<p>There's a one-line of magical compiler <span>directive </span> that helps us here! Add the following code at the top of <em>code.cpp</em>:</p>

	<div class="pre-lang" id="premain391872"><div>C++</div><div class="pre-action-link"><span id="copycode391872" class="copy-code" data-index="391872" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre391872" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="C++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-preprocessor">#pragma comment(linker, "/merge:.rdata=.text")</span></pre>
	</li>	<li>Compile again and open <em>code_gen.dll</em> with CFF Explorer:
	<p><img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" style="width: 600px; height: 132px" alt="Image 5" data-src="/KB/Articles/5304605/img05.png" class="lazyload" data-sizes="auto" data-srcset="/KB/Articles/5304605/img05-r-400.png 400w, /KB/Articles/5304605/img05.png 600w"></p>

	<p><strong>Boom!</strong> It's fixed, now our code directly gets feed from allocated data in lower addresses above itself.</p>

	<p><img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" style="width: 600px; height: 351px" alt="Image 6" data-src="/KB/Articles/5304605/img06.png" class="lazyload" data-sizes="auto" data-srcset="/KB/Articles/5304605/img06-r-400.png 400w, /KB/Articles/5304605/img06.png 600w"></p>
	</li>	<li>Open <em>code_gen.dll</em><strong> </strong>inside HxD or any other hex editor, Press <strong>Ctrl+G</strong><em> </em>or select <strong>Search-&gt;Goto...</strong><em> </em>and enter the <em>.text</em> section raw address. Press <strong>Ctrl+E</strong><em> </em>or select <strong>Edit-&gt;Select Block...</strong><em> and enter the .text section raw size, then copy the buffer as c array and paste it inside a header file and add it to </em><code>code_tester </code>project like<strong> <em>shellcode_encrypter_raw.h</em></strong> and name the array same as file.
	<blockquote class="quote">
	<div class="op">NOTE:</div>

	<p>For ease of code extraction you can directly right click on the section in CFF Explorer and click on dump section, sometimes it produce extra size so I stick to the manual way.</p>
	</blockquote>
	</li>	<li>Change <code>code_tester</code> <em>main.cpp</em> file to this:
	<div class="pre-lang" id="premain116552"><div>C++</div><div class="pre-action-link"><span class="code-collapse" data-index="116552" id="preShrink116552">Shrink ▲</span> &nbsp; <span id="copycode116552" class="copy-code" data-index="116552" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre116552" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="C++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-comment">// main.cpp
</span><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">windows.h</span><span class="code-keyword">&gt;</span>
</span><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">stdio.h</span><span class="code-keyword">&gt;</span>
</span><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">fstream</span><span class="code-keyword">&gt;</span>
</span><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">vector</span><span class="code-keyword">&gt;</span>
</span><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-string">"</span><span class="code-string">shellcode_encrypter_raw.h"</span>
</span>
<span class="code-keyword">using</span> <span class="code-keyword">namespace</span> std;
<span class="code-keyword">typedef</span> <span class="code-keyword">bool</span>(*_encrypt)(<span class="code-keyword">void</span>*, <span class="code-sdkkeyword">size_t</span>);

<span class="code-preprocessor">#define ENC_SC_RAW shellcode_encrypter_raw
</span><span class="code-preprocessor">#define FUNCTION_OFFSET 0
</span>
<span class="code-keyword">int</span> main(<span class="code-keyword">int</span> argc, <span class="code-keyword">char</span>* argv[])
{
    <span class="code-comment">// Check for commands count
</span>    <span class="code-keyword">if</span> (argc != <span class="code-digit">4</span>) <span class="code-keyword">return</span> EXIT_FAILURE;

    <span class="code-comment">// Get commands values
</span>    <span class="code-keyword">char</span>* input_file   = argv[<span class="code-digit">1</span>];
    <span class="code-keyword">char</span>* process_mode = argv[<span class="code-digit">2</span>];
    <span class="code-keyword">char</span>* output_file  = argv[<span class="code-digit">3</span>];

    <span class="code-comment">// Change code protection
</span>    DWORD old_flag;
    VirtualProtect(ENC_SC_RAW, <span class="code-keyword">sizeof</span> ENC_SC_RAW, PAGE_EXECUTE_READWRITE, &amp;old_flag);

    <span class="code-comment">// Declaring encrypt function
</span>    _encrypt encrypt = (_encrypt)(<span class="code-keyword">void</span>*)&amp;ENC_SC_RAW[FUNCTION_OFFSET];

    <span class="code-comment">// Read input file to vector buffer
</span>    ifstream input_file_reader(argv[<span class="code-digit">1</span>], ios::binary);
    vector<span class="code-keyword">&lt;</span>uint8_t<span class="code-keyword">&gt;</span> input_file_buffer(istreambuf_iterator<span class="code-keyword">&lt;</span><span class="code-keyword">char</span><span class="code-keyword">&gt;</span>(input_file_reader), {});

    <span class="code-comment">// Add padding to input file data
</span>    <span class="code-keyword">for</span> (<span class="code-sdkkeyword">size_t</span> i = <span class="code-digit">0</span>; i <span class="code-keyword">&lt;</span> <span class="code-digit">16</span>; i++) 
&nbsp;        input_file_buffer.insert(input_file_buffer.begin(), <span class="code-digit">0x0</span>);
    <span class="code-keyword">for</span> (<span class="code-sdkkeyword">size_t</span> i = <span class="code-digit">0</span>; i <span class="code-keyword">&lt;</span> <span class="code-digit">16</span>; i++) input_file_buffer.push_back(<span class="code-digit">0x0</span>);

    <span class="code-comment">// Encrypting file buffer
</span>    <span class="code-keyword">if</span> (strcmp(process_mode, <span class="code-string">"</span><span class="code-string">-e"</span>) == <span class="code-digit">0</span>) encrypt(input_file_buffer.data(), 
                                         input_file_buffer.size());

    <span class="code-comment">// Save encrypted buffer to output file
</span>    fstream file_writter;
    file_writter.open(output_file, ios::binary | ios::out);
    file_writter.write((<span class="code-keyword">char</span>*)input_file_buffer.data(), input_file_buffer.size());
    file_writter.close();

    <span class="code-comment">// Code successfully executed
</span>    printf(<span class="code-string">"</span><span class="code-string">OK"</span>); <span class="code-keyword">return</span> EXIT_SUCCESS;
}</pre>
	</li>	<li>Ok, the next step is finding the address offset of <code>_encrypt </code>function in the shellcode, open <strong><em>code_gen.map</em> with a text editor</strong>.<strong> </strong><em>(I use Notepad++</em>.<em>)</em></li>	<li>Search for <code>_encrypt </code>and you must find this line:
	<div class="pre-lang" id="premain65135"><div>C++</div><div class="pre-action-link"><span id="copycode65135" class="copy-code" data-index="65135" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre65135" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="C++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true">0001:000012c0       _encrypt                   <span class="code-digit">000000018000</span><strong>22C0</strong> f   code.obj
</pre>

	<p>Now we know our function offset in virtual offset but we need its actual offset, our virtual offset is <strong>0x22C0</strong>.</p>
	</li>	<li>Head back to the CFF Explorer and check for <em>.text</em> section <strong>virtual address </strong>which is<strong> 0x1000</strong><strong>, </strong>Now the only thing we need to do is subtract them which gives us <strong>0x12C0 </strong>and this is our offset, replace the value inside the code:
	<div class="pre-lang" id="premain904355"><div>C++</div><div class="pre-action-link"><span id="copycode904355" class="copy-code" data-index="904355" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre904355" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="C++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-preprocessor">#define FUNCTION_OFFSET 0x12C0 </span></pre>
	</li>	<li>Compile and test it using command line:
	<div class="pre-lang" id="premain801292"><div>C++</div><div class="pre-action-link"><span id="copycode801292" class="copy-code" data-index="801292" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre801292" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="C++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true">code_tester.exe some_image.jpg -e some_image_encrypted.jpg</pre>

	<p><strong>[ NUCLEAR EXPLOSION ! ]</strong></p>

	<p>The result of EXE is <strong>OK</strong> and the generated file is completely encrypted using AES-256!</p>

	<ul class="download">
		<li><a href="/KB/Articles/5304605/03_shellcode_tutorial_advanced_approach_chapter1_vs16_x64.zip">Download Advanced Approach (Encrypter Only) source - 32.7 KB</a></li>	</ul>
	</li>	<li>Alright, to generate decrypter shellcode, follow the exact steps except:
	<ol>
		<li>Use <code>AES_CBC_decrypt_buffer</code> instead of <code>AES_CBC_encrypt_buffer</code></li>		<li>Change type definition to this:</li>	</ol>

	<div class="pre-lang" id="premain950399"><div>C++</div><div class="pre-action-link"><span id="copycode950399" class="copy-code" data-index="950399" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre950399" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="C++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">typedef</span> <span class="code-keyword">bool</span>(*_crypt)(<span class="code-keyword">void</span>*, <span class="code-sdkkeyword">size_t</span>);</pre>

	<p>Here's how the <em>main.cpp</em> code should look:</p>

	<div class="pre-lang" id="premain397102"><div>C++</div><div class="pre-action-link"><span class="code-collapse" data-index="397102" id="preShrink397102">Shrink ▲</span> &nbsp; <span id="copycode397102" class="copy-code" data-index="397102" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre397102" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="C++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-comment">// main.cpp
</span><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">windows.h</span><span class="code-keyword">&gt;</span>
</span><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">stdio.h</span><span class="code-keyword">&gt;</span>
</span><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">fstream</span><span class="code-keyword">&gt;</span>
</span><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">vector</span><span class="code-keyword">&gt;</span>
</span><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-string">"</span><span class="code-string">shellcode_encrypter_raw.h"</span>
</span><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-string">"</span><span class="code-string">shellcode_decrypter_raw.h"</span>
</span>
<span class="code-keyword">using</span> <span class="code-keyword">namespace</span> std;
<span class="code-keyword">typedef</span> <span class="code-keyword">bool</span>(*_crypt)(<span class="code-keyword">void</span>*, <span class="code-sdkkeyword">size_t</span>);

<span class="code-preprocessor">#define ENC_SC_RAW shellcode_encrypter_raw
</span><span class="code-preprocessor">#define DEC_SC_RAW shellcode_decrypter_raw
</span><span class="code-preprocessor">#define FUNCTION_OFFSET 0x12C0
</span>
<span class="code-keyword">int</span> main(<span class="code-keyword">int</span> argc, <span class="code-keyword">char</span>* argv[])
{
    <span class="code-comment">// Check for commands count
</span>    <span class="code-keyword">if</span> (argc != <span class="code-digit">4</span>) <span class="code-keyword">return</span> EXIT_FAILURE;

    <span class="code-comment">// Get commands values
</span>    <span class="code-keyword">char</span>* input_file   = argv[<span class="code-digit">1</span>];
    <span class="code-keyword">char</span>* process_mode = argv[<span class="code-digit">2</span>];
    <span class="code-keyword">char</span>* output_file  = argv[<span class="code-digit">3</span>];

    <span class="code-comment">// Validate process mode
</span>    <span class="code-keyword">if</span> (strcmp(process_mode, <span class="code-string">"</span><span class="code-string">-e"</span>) != <span class="code-digit">0</span> &amp;&amp; 
        strcmp(process_mode, <span class="code-string">"</span><span class="code-string">-d"</span>) != <span class="code-digit">0</span>) <span class="code-keyword">return</span> EXIT_FAILURE;

    <span class="code-comment">// Change code protection
</span>    DWORD old_flag;
    VirtualProtect(ENC_SC_RAW, <span class="code-keyword">sizeof</span> ENC_SC_RAW, PAGE_EXECUTE_READWRITE, &amp;old_flag);
    VirtualProtect(DEC_SC_RAW, <span class="code-keyword">sizeof</span> DEC_SC_RAW, PAGE_EXECUTE_READWRITE, &amp;old_flag);

    <span class="code-comment">// Declaring encrypt function
</span>    _crypt encrypt = (_crypt)(<span class="code-keyword">void</span>*)&amp;ENC_SC_RAW[FUNCTION_OFFSET];
    _crypt decrypt = (_crypt)(<span class="code-keyword">void</span>*)&amp;DEC_SC_RAW[FUNCTION_OFFSET];

    <span class="code-comment">// Read input file to vector buffer
</span>    ifstream input_file_reader(argv[<span class="code-digit">1</span>], ios::binary);
    vector<span class="code-keyword">&lt;</span>uint8_t<span class="code-keyword">&gt;</span> input_file_buffer(istreambuf_iterator<span class="code-keyword">&lt;</span><span class="code-keyword">char</span><span class="code-keyword">&gt;</span>(input_file_reader), {});

    <span class="code-comment">// Add padding to input file data
</span>    <span class="code-keyword">if</span>(strcmp(process_mode, <span class="code-string">"</span><span class="code-string">-d"</span>) == <span class="code-digit">0</span>) <span class="code-keyword">goto</span> SKIP_PADDING;
    <span class="code-keyword">for</span> (<span class="code-sdkkeyword">size_t</span> i = <span class="code-digit">0</span>; i <span class="code-keyword">&lt;</span> <span class="code-digit">16</span>; i++) 
&nbsp;        input_file_buffer.insert(input_file_buffer.begin(), <span class="code-digit">0x0</span>);
    <span class="code-keyword">for</span> (<span class="code-sdkkeyword">size_t</span> i = <span class="code-digit">0</span>; i <span class="code-keyword">&lt;</span> <span class="code-digit">16</span>; i++) input_file_buffer.push_back(<span class="code-digit">0x0</span>);

    <span class="code-comment">// Encrypting/Decrypting file buffer
</span>    SKIP_PADDING:
    <span class="code-keyword">if</span> (strcmp(process_mode, <span class="code-string">"</span><span class="code-string">-e"</span>) == <span class="code-digit">0</span>) encrypt(input_file_buffer.data(), 
                                                 input_file_buffer.size());
    <span class="code-keyword">if</span> (strcmp(process_mode, <span class="code-string">"</span><span class="code-string">-d"</span>) == <span class="code-digit">0</span>) decrypt(input_file_buffer.data(), 
                                                 input_file_buffer.size());

    <span class="code-comment">// Save encrypted buffer to output file
</span>    fstream file_writter;
    file_writter.open(output_file, ios::binary | ios::out);
    <span class="code-keyword">if</span> (strcmp(process_mode, <span class="code-string">"</span><span class="code-string">-e"</span>) == <span class="code-digit">0</span>)
        file_writter.write((<span class="code-keyword">char</span>*)input_file_buffer.data(), input_file_buffer.size());
    <span class="code-keyword">if</span> (strcmp(process_mode, <span class="code-string">"</span><span class="code-string">-d"</span>) == <span class="code-digit">0</span>)
        file_writter.write((<span class="code-keyword">char</span>*)&amp;input_file_buffer[<span class="code-digit">16</span>], 
&nbsp;                           input_file_buffer.size() - <span class="code-digit">32</span>);
    file_writter.close();

    <span class="code-comment">// Code successfully executed
</span>    printf(<span class="code-string">"</span><span class="code-string">OK"</span>); <span class="code-keyword">return</span> EXIT_SUCCESS;
}</pre>
	</li>	<li>Compile and test it using command line:
	<div class="pre-lang" id="premain840768"><div>C++</div><div class="pre-action-link"><span id="copycode840768" class="copy-code" data-index="840768" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre840768" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="C++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true">code_tester.exe some_image_encrypted.jpg -d some_image_decrypted.jpg</pre>
	</li></ol>

<p>And that's it! Now you have two small shellcodes that do the encryption/decryption for you!</p>

<p>You can dispose the code after you used them. Also, you can compress and encrypt them using different keys and decrypt them just on the fly when you need them.</p>

<ul class="download">
	<li><a href="/KB/Articles/5304605/04_shellcode_tutorial_advanced_approach_chapter2_vs16_x64_version_2.zip">Download Finished Advanced Approach source - 39.2 KB</a></li></ul>

<h2>Conclusion</h2>

<p>This is the end of Part 1. In Part 2, we will create an EXE/DLL packer/protector from scratch using only C++ by the same technique but we get involved in much much complex stuff like resolving, obfuscation, call redirections and etc.</p>

<p>I hope you enjoyed the article. Feel free to ask your questions in the comments.</p>

<p><strong>Stay tuned!</strong></p>

<h2>History</h2>

<ul>
	<li>7<sup>th</sup> June, 2021: Initial version</li></ul>


						</div>
						

						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" rel="license">The Code Project Open License (CPOL)</a></p></div>
						

						
						<br>
						
						    

<div class="author-wrapper">

    <div class="desktop-only tablet-only" style="position:absolute; top:-30px;right:20px">
        <img id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto" class="profile-pic" src="https://www.codeproject.com/script/Membership/ProfileImages/{68de1770-73ee-4cb9-b0b7-c7d1af3ea882}.jpg" style="border-width:0px;transform:rotate(-1deg);">
    </div>

    <div style="padding-right:100px">
        <div class="subdue" style="margin-bottom:7px">Written By</div>

        <div class="container-member">
             <b><a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink" class="author" href="/Members/HamidMemar">The Ænema</a></b>
        </div>

        <div class="company text-nowrap">
            <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle">Engineer</span>
	        <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberCompany">MemarDesign™ LLC.</span>
        </div>

        <div class="text-nowrap">
            <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation"><img src="/script/Geo/Images/FR.gif" alt="France" width="16" height="11">&nbsp;France</span>
        </div>
    </div>

</div>

<div class="description" style="padding-top:1rem">
    This is your last chance. After this, there is no turning back. You take the blue pill - the story ends, you wake up in your bed and believe whatever you want to believe. You take the red pill - you stay in Wonderland and I show you how deep the rabbit-hole goes. - Matrix<br>
<br>
<br>
Hamid.Memar
</div>

<div id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_SocialRow" class="follow flex-container flex-extend" style="margin-top:20px">
    <div class="flex-item">
        
    </div>
    <div class="flex-item-tight" style="margin-right:25px">
        
    </div>
</div>

<br>
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    <div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Security" data-country="US" data-loadonview="true" data-tags="C, Advanced, security, VC++, C++17, VS2019,rating4.5,article-5304605,pos_bottom"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Security&sz=728x90&c=143977"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Security&sz=728x90&c=143977"  width="728px" height="90px" target="_blank"/></a></noscript></div>
				</div>
				
                
                

				
				

					<h2 class="padded-top">Comments and Discussions</h2>

                    
			        <div id="ctl00_SharePH" class="share-list float-right desktop-only tablet-only" style="margin-top:-3.5rem">
				        

    <ul class="rrssb-buttons clearfix">

        <li id="ctl00_SocialLike_Twitter" class="twitter compact">
            <a href="http://twitter.com/home?status=Creating+Shellcode+from+any+Code+Using+Visual+Studio+and+C%2b%2b+-+CodeProject+-+https%3a%2f%2fwww.codeproject.com%2fArticles%2f5304605%2fCreating-Shellcode-from-any-Code-Using-Visual-Stud" class="popup">
                <span class="icon">
                    <svg x="0px" y="0px" width="28px" height="28px" viewBox="0 0 1200 1227" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z" fill="white"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_LinkedIn" class="linkedin compact">
            <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f5304605%2fCreating-Shellcode-from-any-Code-Using-Visual-Stud&amp;title=Creating+Shellcode+from+any+Code+Using+Visual+Studio+and+C%2b%2b+-+CodeProject&amp;summary=Learn+how+to+convert+any+code+to+a+stable+shellcode+using+Visual+Studio+2019+and+VC%2b%2b+in+easy+steps!&amp;source=codeproject.com" class="popup">
                <span class="icon">
                    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M25.424,15.887v8.447h-4.896v-7.882c0-1.979-0.709-3.331-2.48-3.331c-1.354,0-2.158,0.911-2.514,1.803
                            c-0.129,0.315-0.162,0.753-0.162,1.194v8.216h-4.899c0,0,0.066-13.349,0-14.731h4.899v2.088c-0.01,0.016-0.023,0.032-0.033,0.048
                            h0.033V11.69c0.65-1.002,1.812-2.435,4.414-2.435C23.008,9.254,25.424,11.361,25.424,15.887z M5.348,2.501
                            c-1.676,0-2.772,1.092-2.772,2.539c0,1.421,1.066,2.538,2.717,2.546h0.032c1.709,0,2.771-1.132,2.771-2.546
                            C8.054,3.593,7.019,2.501,5.343,2.501H5.348z M2.867,24.334h4.897V9.603H2.867V24.334z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Reddit" class="reddit compact">
            <a href="http://www.reddit.com/submit?url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f5304605%2fCreating-Shellcode-from-any-Code-Using-Visual-Stud&amp;title=Creating+Shellcode+from+any+Code+Using+Visual+Studio+and+C%2b%2b+-+CodeProject">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve"><g>
                    <path d="M11.794 15.316c0-1.029-0.835-1.895-1.866-1.895c-1.03 0-1.893 0.865-1.893 1.895s0.863 1.9 1.9 1.9 C10.958 17.2 11.8 16.3 11.8 15.316z"></path>
                    <path d="M18.1 13.422c-1.029 0-1.895 0.864-1.895 1.895c0 1 0.9 1.9 1.9 1.865c1.031 0 1.869-0.836 1.869-1.865 C19.969 14.3 19.1 13.4 18.1 13.422z"></path>
                    <path d="M17.527 19.791c-0.678 0.678-1.826 1.006-3.514 1.006c-0.004 0-0.009 0-0.014 0c-0.004 0-0.01 0-0.015 0 
                    c-1.686 0-2.834-0.328-3.51-1.005c-0.264-0.265-0.693-0.265-0.958 0c-0.264 0.265-0.264 0.7 0 1 c0.943 0.9 2.4 1.4 
                    4.5 1.402c0.005 0 0 0 0 0c0.005 0 0 0 0 0c2.066 0 3.527-0.459 4.47-1.402 c0.265-0.264 0.265-0.693 0.002-0.958C18.221 
                    19.5 17.8 19.5 17.5 19.791z"></path><path d="M27.707 13.267c0-1.785-1.453-3.237-3.236-3.237c-0.793 0-1.518 0.287-2.082 
                    0.761c-2.039-1.295-4.646-2.069-7.438-2.219 l1.483-4.691l4.062 0.956c0.071 1.4 1.3 2.6 2.7 2.555c1.488 0 2.695-1.208 
                    2.695-2.695C25.881 3.2 24.7 2 23.2 2 c-1.059 0-1.979 0.616-2.42 1.508l-4.633-1.091c-0.344-0.081-0.693 0.118-0.803 
                    0.455l-1.793 5.7 C10.548 8.6 7.7 9.4 5.6 10.75C5.006 10.3 4.3 10 3.5 10.029c-1.785 0-3.237 1.452-3.237 3.2 c0 1.1 0.6 
                    2.1 1.4 2.69c-0.04 0.272-0.061 0.551-0.061 0.831c0 2.3 1.3 4.4 3.7 5.9 c2.299 1.5 5.3 2.3 8.6 2.325c3.228 0 6.271-0.825 
                    8.571-2.325c2.387-1.56 3.7-3.66 3.7-5.917 c0-0.26-0.016-0.514-0.051-0.768C27.088 15.5 27.7 14.4 27.7 13.267z M23.186 
                    3.355c0.74 0 1.3 0.6 1.3 1.3 c0 0.738-0.6 1.34-1.34 1.34s-1.342-0.602-1.342-1.34C21.844 4 22.4 3.4 23.2 3.355z M1.648 
                    13.3 c0-1.038 0.844-1.882 1.882-1.882c0.31 0 0.6 0.1 0.9 0.209c-1.049 0.868-1.813 1.861-2.26 2.9 C1.832 14.2 1.6 13.8 1.6 
                    13.267z M21.773 21.57c-2.082 1.357-4.863 2.105-7.831 2.105c-2.967 0-5.747-0.748-7.828-2.105 
                    c-1.991-1.301-3.088-3-3.088-4.782c0-1.784 1.097-3.484 3.088-4.784c2.081-1.358 4.861-2.106 7.828-2.106 c2.967 0 5.7 
                    0.7 7.8 2.106c1.99 1.3 3.1 3 3.1 4.784C24.859 18.6 23.8 20.3 21.8 21.57z M25.787 14.6 
                    c-0.432-1.084-1.191-2.095-2.244-2.977c0.273-0.156 0.59-0.245 0.928-0.245c1.035 0 1.9 0.8 1.9 1.9 
                    C26.354 13.8 26.1 14.3 25.8 14.605z"></path></g></svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Facebook" class="facebook compact">
            
            <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.codeproject.com%2fArticles%2f5304605%2fCreating-Shellcode-from-any-Code-Using-Visual-Stud" class="popup">
                <span class="icon">
                    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M27.825,4.783c0-2.427-2.182-4.608-4.608-4.608H4.783c-2.422,0-4.608,2.182-4.608,4.608v18.434
                            c0,2.427,2.181,4.608,4.608,4.608H14V17.379h-3.379v-4.608H14v-1.795c0-3.089,2.335-5.885,5.192-5.885h3.718v4.608h-3.726
                            c-0.408,0-0.884,0.492-0.884,1.236v1.836h4.609v4.608h-4.609v10.446h4.916c2.422,0,4.608-2.188,4.608-4.608V4.783z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Pinterest" class="pinterest compact">
            <a href="http://pinterest.com/pin/create/bookmarklet/?is_video=false&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f5304605%2fCreating-Shellcode-from-any-Code-Using-Visual-Stud&amp;description=Creating+Shellcode+from+any+Code+Using+Visual+Studio+and+C%2b%2b+-+CodeProject">
                <span class="icon">
                    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M14.021,1.57C6.96,1.57,1.236,7.293,1.236,14.355c0,7.062,5.724,12.785,12.785,12.785c7.061,0,12.785-5.725,12.785-12.785
                        C26.807,7.294,21.082,1.57,14.021,1.57z M15.261,18.655c-1.161-0.09-1.649-0.666-2.559-1.219c-0.501,2.626-1.113,5.145-2.925,6.458
                        c-0.559-3.971,0.822-6.951,1.462-10.116c-1.093-1.84,0.132-5.545,2.438-4.632c2.837,1.123-2.458,6.842,1.099,7.557
                        c3.711,0.744,5.227-6.439,2.925-8.775c-3.325-3.374-9.678-0.077-8.897,4.754c0.19,1.178,1.408,1.538,0.489,3.168
                        C7.165,15.378,6.53,13.7,6.611,11.462c0.131-3.662,3.291-6.227,6.46-6.582c4.007-0.448,7.771,1.474,8.29,5.239
                        c0.579,4.255-1.816,8.865-6.102,8.533L15.261,18.655z"></path>
                    </svg>
                </span>
                
            </a>
        </li>
        <!--
        
        -->
        <li id="ctl00_SocialLike_Email" class="email compact">
            <a href="mailto:?subject=Creating%20Shellcode%20from%20any%20Code%20Using%20Visual%20Studio%20and%20C%2b%2b%20-%20CodeProject&amp;body=Here%27s%20an%20interesting%20article%20on%20for%20you%20on%20codeproject.com%0a%0aLearn%20how%20to%20convert%20any%20code%20to%20a%20stable%20shellcode%20using%20Visual%20Studio%202019%20and%20VC%2b%2b%20in%20easy%20steps!%0a%0ahttps%3a%2f%2fwww.codeproject.com%2fArticles%2f5304605%2fCreating-Shellcode-from-any-Code-Using-Visual-Stud%0a">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <g>
                            <path d="M20.111 26.147c-2.336 1.051-4.361 1.401-7.125 1.401c-6.462 0-12.146-4.633-12.146-12.265 
                                c0-7.94 5.762-14.833 14.561-14.833c6.853 0 11.8 4.7 11.8 11.252c0 5.684-3.194 9.265-7.399 
                                9.3 c-1.829 0-3.153-0.934-3.347-2.997h-0.077c-1.208 1.986-2.96 2.997-5.023 2.997c-2.532 
                                0-4.361-1.868-4.361-5.062 c0-4.749 3.504-9.071 9.111-9.071c1.713 0 3.7 0.4 4.6 0.973l-1.169 
                                7.203c-0.388 2.298-0.116 3.3 1 3.4 c1.673 0 3.773-2.102 3.773-6.58c0-5.061-3.27-8.994-9.303-8.994c-5.957 
                                0-11.175 4.673-11.175 12.1 c0 6.5 4.2 10.2 10 10.201c1.986 0 4.089-0.43 5.646-1.245L20.111 
                                26.147z M16.646 10.1 c-0.311-0.078-0.701-0.155-1.207-0.155c-2.571 0-4.595 2.53-4.595 5.529c0 
                                1.5 0.7 2.4 1.9 2.4 c1.441 0 2.959-1.828 3.311-4.087L16.646 10.068z"></path>
                        </g>
                    </svg>
                </span>
                
            </a>
        </li>
    </ul>



			        </div><a class="float-left" name="_comments" id="_comments">&nbsp;</a><div id="_MessageBoardctl00_MessageBoard" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(event, null)">
<table id="ForumTable" class="forum relaxed" cellpadding="0" cellspacing="0">
<tbody><tr>
<td class="header1"><div class="callout">
	<b>You must <a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f5304605%2fCreating-Shellcode-from-any-Code-Using-Visual-Stud%3ffid%3d1970944%26df%3d90%26mpp%3d25%26sort%3dPosition%26view%3dNormal%26spc%3dRelaxed%26prof%3dTrue">Sign in</a> to use this message board.</b>
</div></td>
</tr><tr>
<td><table width="100%" border="0" cellpadding="3px" cellspacing="0">
<tbody><tr class="header1">
<td colspan="2" style="white-space:nowrap;"><div class="container">
<div class="float-right">
<form action="/Search.aspx?sbo=fm" method="get" class="searchbar">
<input type="hidden" name="fid" value="1970944"><input type="hidden" name="sbo" value="fm"><input id="search_forumCtrl_ctl00_MessageBoard" type="search" class="search subdue" autocomplete="off" name="q"><input type="image" src="https://codeproject.freetls.fastly.net/images/search.gif">
</form>
</div>
</div></td>
</tr><tr class="header2">
<td></td><td style="width:100%;"><div style="text-align:right;">
<form action="/script/Forums/SetOptions.aspx?fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;floc=%2fArticles%2f5304605%2fCreating-Shellcode-from-any-Code-Using-Visual-Stud" method="get" style="margin:0;padding:0;">
<input type="hidden" name="fid" value="1970944"><input type="hidden" name="currentQS" value="fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;floc=%2fArticles%2f5304605%2fCreating-Shellcode-from-any-Code-Using-Visual-Stud"><input type="hidden" name="floc" value="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud">Spacing<select size="1" class="dropdown" name="spc">
<option selected="" value="Relaxed">Relaxed</option><option value="Compact">Compact</option><option value="Tight">Tight</option>
</select>&nbsp;&nbsp;Layout<select size="1" class="dropdown" name="view">
<option selected="" value="Normal">Normal</option><option value="Topic">Open Topics</option><option value="Expanded">Open All</option><option value="Thread">Thread View</option>
</select>&nbsp;&nbsp;Per page<select size="1" class="dropdown" name="mpp">
<option value="10">10</option><option selected="" value="25">25</option><option value="50">50</option>
</select>&nbsp;&nbsp;&nbsp;<input type="submit" value="Update" name="SetOpt" class="button">
</form>
</div></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><a name="xx0xx"></a><table border="0" cellpadding="2px" cellspacing="0" width="100%">
<tbody><tr class="navbar">
<td></td><td style="text-align:right;width:50%;"></td><td style="text-align:right;white-space:nowrap;"><span class="nav-link disabled">First</span> <span class="nav-link disabled">Prev</span><a class="nav-link" name="Frm_HoverNL" href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;fr=26#xx0xx">Next</a></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%" class="fixed-layout blank-background msg-list">
<tbody><tr id="F5932479_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5932479xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="5932479" parent="0" thread="5932479" href="/Messages/5932479/Sir-Is-there-a-book-to-learn-these-knowledge">Sir,Is there a book to learn these knowledge?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">1065040801@qq.com</span><span class="date">16-Mar-23  23:10</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=15804971">1065040801@qq.com</a></span></td><td class="date"><span>16-Mar-23  23:10&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5932479_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="pre-lang" id="premain905072"><div></div><div class="pre-action-link"><span class="code-collapse" data-index="905072" id="preShrink905072">Shrink ▲</span> &nbsp; <span id="copycode905072" class="copy-code" data-index="905072" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre905072" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">Sir,Is there a book to learn these knowledge?</pre><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud" rel="nofollow noopener">Sign in</a>·<wbr><a href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5932479" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5932479" name="react-item_5932479" id="MRF5932479" class="reaction-result"></span><span data-objectref="3_5932479" data-votingtype="GoodOrBad" name="RateItem_5932479" id="MVF5932479" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5932479" href="/Messages/5932479/Sir-Is-there-a-book-to-learn-these-knowledge" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/images/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5949701_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx5949701xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="5949701" parent="5932479" thread="5932479" href="/Messages/5949701/Re-Sir-Is-there-a-book-to-learn-these-knowledge">Re: Sir,Is there a book to learn these knowledge?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">The Ænema</span><span class="date">26-Jun-23  22:55</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=13742737">The Ænema</a></span></td><td class="date"><span>26-Jun-23  22:55&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5949701_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5932479);" href="/Messages/5932479/Sir-Is-there-a-book-to-learn-these-knowledge"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>I don't think so, It's mostly error and trial.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud" rel="nofollow noopener">Sign in</a>·<wbr><a href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5932479" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5949701" name="react-item_5949701" id="MRF5949701" class="reaction-result"></span><span data-objectref="3_5949701" data-votingtype="GoodOrBad" name="RateItem_5949701" id="MVF5949701" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5949701" href="/Messages/5949701/Re-Sir-Is-there-a-book-to-learn-these-knowledge" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/images/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5892886_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5892886xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="5892886" parent="0" thread="5892886" href="/Messages/5892886/Null-free-shell-code">Null-free shell code</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Member 15735388</span><span class="date">12-Aug-22  4:20</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=15735388">Member 15735388</a></span></td><td class="date"><span>12-Aug-22  4:20&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5892886_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="pre-lang" id="premain808434"><div></div><div class="pre-action-link"><span class="code-collapse" data-index="808434" id="preShrink808434">Shrink ▲</span> &nbsp; <span id="copycode808434" class="copy-code" data-index="808434" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre808434" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">Are there any easy ways to generate shellcode without nulls?</pre><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud" rel="nofollow noopener">Sign in</a>·<wbr><a href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5892886" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5892886" name="react-item_5892886" id="MRF5892886" class="reaction-result"></span><span data-objectref="3_5892886" data-votingtype="GoodOrBad" name="RateItem_5892886" id="MVF5892886" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5892886" href="/Messages/5892886/Null-free-shell-code" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/images/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5927025_h0" class="header hover-row">
<td class="subject-line normal vote-hi" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx5927025xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="5927025" parent="5892886" thread="5892886" href="/Messages/5927025/Re-Null-free-shell-code">Re: Null-free shell code</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Rosseta Stoned</span><span class="date">15-Feb-23  10:54</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=14574087">Rosseta Stoned</a></span></td><td class="date"><span>15-Feb-23  10:54&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5927025_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5892886);" href="/Messages/5892886/Null-free-shell-code"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>What do you mean from null free?<br>
1. If you mean the nulls between parts of hex binary, it's for alignment you shouldn't remove them.<br>
2. If you mean the null at the end of shell code you can simply remove them.<br>
<br>
Simply use a compressor to get rid of the nulls<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud" rel="nofollow noopener">Sign in</a>·<wbr><a href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5892886" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5927025" name="react-item_5927025" id="MRF5927025" class="reaction-result"></span><span data-objectref="3_5927025" data-votingtype="GoodOrBad" name="RateItem_5927025" id="MVF5927025" class="rating-result"><span>5.00/5 (1 vote)</span></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5927025" href="/Messages/5927025/Re-Null-free-shell-code" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/images/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5889203_h0" class="header hover-row root">
<td class="subject-line normal vote-hi" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5889203xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="5889203" parent="0" thread="5889203" href="/Messages/5889203/My-vote-of-5">My vote of 5</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Farzin Sotoodi</span><span class="date">23-Jul-22  18:01</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=512705">Farzin Sotoodi</a></span></td><td class="date"><span>23-Jul-22  18:01&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5889203_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">as The �nema said:<br>
We should know how hackers work and then we can stop them. This article introduces a new way of protection to me.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud" rel="nofollow noopener">Sign in</a>·<wbr><a href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5889203" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5889203" name="react-item_5889203" id="MRF5889203" class="reaction-result"></span><span data-objectref="3_5889203" data-votingtype="GoodOrBad" name="RateItem_5889203" id="MVF5889203" class="rating-result"><span>5.00/5 (2 votes)</span></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5889203" href="/Messages/5889203/My-vote-of-5" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/images/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5879612_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5879612xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="5879612" parent="0" thread="5879612" href="/Messages/5879612/unresolved-external-symbol">unresolved external symbol</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Magloire BOKO</span><span class="date">28-May-22  5:58</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=15612300">Magloire BOKO</a></span></td><td class="date"><span>28-May-22  5:58&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5879612_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Hello everybody<br>
When i try to compile this<br>
<div class="pre-lang" id="premain827888"><div></div><div class="pre-action-link"><span class="code-collapse" data-index="827888" id="preShrink827888">Shrink ▲</span> &nbsp; <span id="copycode827888" class="copy-code" data-index="827888" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div>
<pre id="pre827888" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-keyword">extern</span> <span class="code-string">"</span><span class="code-string">C"</span>
{
    #include <span class="code-string">"</span><span class="code-string">aes.h"</span>

    <span class="code-keyword">bool</span> _encrypt(void* data, size_t size)
    {
        <span class="code-comment">//</span><span class="code-comment"> Allocate data on heap</span>
        <span class="code-keyword">struct</span> AES_ctx ctx;
        unsigned <span class="code-keyword">char</span> key[32] = {
        <span class="code-digit">0xBB</span>, <span class="code-digit">0x17</span>, <span class="code-digit">0xCA</span>, <span class="code-digit">0x8C</span>, <span class="code-digit">0x69</span>, <span class="code-digit">0x7F</span>, <span class="code-digit">0xA1</span>, <span class="code-digit">0x89</span>,
        <span class="code-digit">0x3B</span>, <span class="code-digit">0xCF</span>, <span class="code-digit">0xA8</span>, <span class="code-digit">0x12</span>, <span class="code-digit">0x34</span>, <span class="code-digit">0x6F</span>, <span class="code-digit">0xB6</span>, <span class="code-digit">0xE8</span>,
        <span class="code-digit">0x79</span>, <span class="code-digit">0x89</span>, <span class="code-digit">0xDA</span>, <span class="code-digit">0xD0</span>, <span class="code-digit">0x0B</span>, <span class="code-digit">0xA9</span>, <span class="code-digit">0xA1</span>, <span class="code-digit">0x1B</span>,
        <span class="code-digit">0x5B</span>, <span class="code-digit">0x38</span>, <span class="code-digit">0xD0</span>, <span class="code-digit">0x4A</span>, <span class="code-digit">0x20</span>, <span class="code-digit">0x4D</span>, <span class="code-digit">0xB8</span>, <span class="code-digit">0x0E</span>};
        unsigned <span class="code-keyword">char</span> iv[16] = {
        <span class="code-digit">0xA3</span>, <span class="code-digit">0xF3</span>, <span class="code-digit">0xD4</span>, <span class="code-digit">0xC5</span>, <span class="code-digit">0x5E</span>, <span class="code-digit">0xCD</span>, <span class="code-digit">0x41</span>, <span class="code-digit">0xA6</span>,
        <span class="code-digit">0x22</span>, <span class="code-digit">0xC9</span>, <span class="code-digit">0x8D</span>, <span class="code-digit">0xE5</span>, <span class="code-digit">0xA3</span>, <span class="code-digit">0xBB</span>, <span class="code-digit">0x29</span>, <span class="code-digit">0xF1</span>};

        <span class="code-comment">//</span><span class="code-comment"> Initialize encrypt context</span>
        AES_init_ctx_iv(&amp;ctx, key, iv);

        <span class="code-comment">//</span><span class="code-comment"> Encrypt buffer</span>
        AES_CBC_encrypt_buffer(&amp;ctx, (uint8_t*)data, size);
        <span class="code-keyword">return</span> <span class="code-keyword">true</span>;
    }
}</pre><br>
I got an unresolved external symbol in visual studio 2022.<br>
<div class="pre-lang" id="premain597504"><div></div><div class="pre-action-link"><span class="code-collapse" data-index="597504" id="preShrink597504">Shrink ▲</span> &nbsp; <span id="copycode597504" class="copy-code" data-index="597504" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div>
<pre id="pre597504" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">2&gt;code.obj : error LNK2019: unresolved external symbol AES_init_ctx_iv referenced <span class="code-keyword">in</span> function _encrypt
2&gt;code.obj : error LNK2019: unresolved external symbol AES_CBC_encrypt_buffer referenced <span class="code-keyword">in</span> function _encrypt
2&gt;C:\Users\Odin\source\repos\code\x64\Release\code_gen.dll : fatal error LNK1120: <span class="code-digit">2</span> unresolved externals
2&gt;Done building project <span class="code-string">"</span><span class="code-string">code_gen.vcxproj"</span> -- FAILED.</pre><br>
Can someone please help me? Thanks very much<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud" rel="nofollow noopener">Sign in</a>·<wbr><a href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5879612" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5879612" name="react-item_5879612" id="MRF5879612" class="reaction-result"></span><span data-objectref="3_5879612" data-votingtype="GoodOrBad" name="RateItem_5879612" id="MVF5879612" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5879612" href="/Messages/5879612/unresolved-external-symbol" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/images/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5862792_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5862792xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="5862792" parent="0" thread="5862792" href="/Messages/5862792/I-have-a-variable-outside-a-function-it-crashes-th">I have a variable outside a function, it crashes the target process.</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">0x597575746F</span><span class="date">23-Feb-22  5:53</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=15292890">0x597575746F</a></span></td><td class="date"><span>23-Feb-22  5:53&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5862792_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">What should I do to make this work if I have a variable outside of functions? <br>
<br>
I noticed that there was an extra section named .data which apparently contains data, probably the ones from the global scope.<br>
<br>
And so I added<br>
<div class="pre-lang" id="premain186693"><div></div><div class="pre-action-link"><span class="code-collapse" data-index="186693" id="preShrink186693">Shrink ▲</span> &nbsp; <span id="copycode186693" class="copy-code" data-index="186693" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div>
<pre id="pre186693" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-preprocessor">#pragma comment(linker, "/merge:.data=.text")</span></pre><br>
<br>
I got a warning that they have different characteristics but it shouldn't be a problem since I'm allocating the page as executable, read, and write right?<br>
<br>
But it crashed, so I checked the memory with cheat engine and I found out that the references were wrong. <br>
<br>
It was mov [process.exe + 0x00000], 0000000 instead of being mov [0000000], 0000000. When I viewed the address it was 0x1000040C, I guess it used the preferred load address being 0x10000000.<br>
<br>
How do I fix the references to use the base address of allocation instead of using the preferred load address?<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud" rel="nofollow noopener">Sign in</a>·<wbr><a href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5862792" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5862792" name="react-item_5862792" id="MRF5862792" class="reaction-result"></span><span data-objectref="3_5862792" data-votingtype="GoodOrBad" name="RateItem_5862792" id="MVF5862792" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5862792" href="/Messages/5862792/I-have-a-variable-outside-a-function-it-crashes-th" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/images/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5875938_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx5875938xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="5875938" parent="5862792" thread="5862792" href="/Messages/5875938/Re-I-have-a-variable-outside-a-function-it-crashes">Re: I have a variable outside a function, it crashes the target process.</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">The Ænema</span><span class="date">8-May-22  13:01</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=13742737">The Ænema</a></span></td><td class="date"><span>8-May-22  13:01&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5875938_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5862792);" href="/Messages/5862792/I-have-a-variable-outside-a-function-it-crashes-th"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>It's covered here : <a href="https://www.codeproject.com/Articles/5317556/Creating-Your-Very-Own-x64-PE-Packer-Protector-fro" rel="nofollow noopener">Creating Your Very Own x64 PE Packer/Protector from Scratch using C++</a>[<a href="https://www.codeproject.com/Articles/5317556/Creating-Your-Very-Own-x64-PE-Packer-Protector-fro" target="_blank" title="New Window" rel="nofollow noopener">^</a>]<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud" rel="nofollow noopener">Sign in</a>·<wbr><a href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5862792" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5875938" name="react-item_5875938" id="MRF5875938" class="reaction-result"></span><span data-objectref="3_5875938" data-votingtype="GoodOrBad" name="RateItem_5875938" id="MVF5875938" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5875938" href="/Messages/5875938/Re-I-have-a-variable-outside-a-function-it-crashes" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/images/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5856134_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5856134xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="5856134" parent="0" thread="5856134" href="/Messages/5856134/Generic-import-in-code-gen">Generic import in "code_gen"</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Member 15188363</span><span class="date">21-Jan-22  2:10</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=15188363">Member 15188363</a></span></td><td class="date"><span>21-Jan-22  2:10&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5856134_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="pre-lang" id="premain186693"><div></div><div class="pre-action-link"><span class="code-collapse" data-index="186693" id="preShrink186693">Shrink ▲</span> &nbsp; <span id="copycode186693" class="copy-code" data-index="186693" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div>
<pre id="pre186693" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">Hi, I have a question, <span class="code-keyword">is</span> it possible to import windows functions <span class="code-keyword">in</span> <span class="code-keyword">this</span> way?</pre><br>
<br>
<div class="pre-lang" id="premain292202"><div></div><div class="pre-action-link"><span class="code-collapse" data-index="292202" id="preShrink292202">Shrink ▲</span> &nbsp; <span id="copycode292202" class="copy-code" data-index="292202" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div>
<pre id="pre292202" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-preprocessor">#pragma comment(linker, "/merge:.rdata=.text")
</span><span class="code-keyword">extern</span> <span class="code-string">"</span><span class="code-string">C"</span>
{
	#include &lt;winuser.h&gt;
    #include &lt;windows.h&gt;

	<span class="code-keyword">bool</span> _msgbox()
	{

	
		<span class="code-keyword">int</span> msgboxID = MessageBox(
			NULL,
			(LPCTSTR)<span class="code-string">"</span><span class="code-string">Resource not available\nDo you want to try again?"</span>,
			(LPCTSTR)<span class="code-string">"</span><span class="code-string">Account Details"</span>,
			MB_ICONWARNING | MB_CANCELTRYCONTINUE | MB_DEFBUTTON2
		);
		<span class="code-comment">//</span><span class="code-comment"> Allocate data on heap</span>
	
		<span class="code-keyword">return</span> <span class="code-keyword">true</span>;
	}
}</pre><br>
<br>
Cause the compiler return me errors, so i suppose this is not the correct way for do it.<br>
Can you explain me how i can do ?<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud" rel="nofollow noopener">Sign in</a>·<wbr><a href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5856134" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5856134" name="react-item_5856134" id="MRF5856134" class="reaction-result"></span><span data-objectref="3_5856134" data-votingtype="GoodOrBad" name="RateItem_5856134" id="MVF5856134" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5856134" href="/Messages/5856134/Generic-import-in-code-gen" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/images/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5858489_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx5858489xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="5858489" parent="5856134" thread="5856134" href="/Messages/5858489/Re-Generic-import-in-code-gen">Re: Generic import in "code_gen"</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">The Ænema</span><span class="date">2-Feb-22  0:40</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=13742737">The Ænema</a></span></td><td class="date"><span>2-Feb-22  0:40&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5858489_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5856134);" href="/Messages/5856134/Generic-import-in-code-gen"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Yes it's possible you need to use lazy importer which is covered in this article :<br>
<a href="https://www.codeproject.com/Articles/5317556/Creating-Your-Very-Own-x64-PE-Packer-Protector-fro?msg=5858488#xx5858488xx" rel="nofollow noopener">Creating Your Very Own x64 PE Packer/Protector from Scratch using C++</a>[<a href="https://www.codeproject.com/Articles/5317556/Creating-Your-Very-Own-x64-PE-Packer-Protector-fro?msg=5858488#xx5858488xx" target="_blank" title="New Window" rel="nofollow noopener">^</a>]<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud" rel="nofollow noopener">Sign in</a>·<wbr><a href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5856134" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5858489" name="react-item_5858489" id="MRF5858489" class="reaction-result"></span><span data-objectref="3_5858489" data-votingtype="GoodOrBad" name="RateItem_5858489" id="MVF5858489" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5858489" href="/Messages/5858489/Re-Generic-import-in-code-gen" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/images/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5858841_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="56px" class="indent"><a name="xx5858841xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="5858841" parent="5858489" thread="5856134" href="/Messages/5858841/Re-Generic-import-in-code-gen">Re: Generic import in "code_gen"</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Member 15188363</span><span class="date">3-Feb-22  14:11</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=15188363">Member 15188363</a></span></td><td class="date"><span>3-Feb-22  14:11&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5858841_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5858489);" href="/Messages/5858489/Re-Generic-import-in-code-gen"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Thanks last 2 questions.<br>
<br>
I checked the article and i see this code:<br>
<br>
<br>
<div class="pre-lang" id="premain186693"><div>C++</div><div class="pre-action-link"><span class="code-collapse" data-index="186693" id="preShrink186693">Shrink ▲</span> &nbsp; <span id="copycode186693" class="copy-code" data-index="186693" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div>
<pre id="pre186693" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="C++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true">uintptr_t msvcrtLib = <span class="code-keyword">reinterpret_cast</span><span class="code-keyword">&lt;</span>uintptr_t<span class="code-keyword">&gt;</span>(LI_FN(LoadLibraryA)(_S(<span class="code-string">"</span><span class="code-string">msvcrt.dll"</span>)));
LI_GE(msvcrtLib, printf)(<span class="code-string">"</span><span class="code-string">This is a message from dynamically loaded printf.\n"</span>);</pre><br>
<br>
But in  Justas Masiulis. repository, in the header file i no see any LI_FIND or LI_GET.<br>
<br>
Where i'm checking wrong ?<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud" rel="nofollow noopener">Sign in</a>·<wbr><a href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5856134" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5858841" name="react-item_5858841" id="MRF5858841" class="reaction-result"></span><span data-objectref="3_5858841" data-votingtype="GoodOrBad" name="RateItem_5858841" id="MVF5858841" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5858841" href="/Messages/5858841/Re-Generic-import-in-code-gen" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/images/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5861891_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="74px" class="indent"><a name="xx5861891xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="5861891" parent="5858841" thread="5856134" href="/Messages/5861891/Re-Generic-import-in-code-gen">Re: Generic import in "code_gen"</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">The Ænema</span><span class="date">18-Feb-22  6:35</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=13742737">The Ænema</a></span></td><td class="date"><span>18-Feb-22  6:35&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5861891_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:74px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5858841);" href="/Messages/5858841/Re-Generic-import-in-code-gen"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Yes, It seems Justas updated the API and code, You can grab old one here on <a href="https://gist.github.com/TheAenema/0e6a7537f481ffe0327bb36a976061b9" rel="nofollow noopener">GitHub</a>[<a href="https://gist.github.com/TheAenema/0e6a7537f481ffe0327bb36a976061b9" target="_blank" title="New Window" rel="nofollow noopener">^</a>]<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud" rel="nofollow noopener">Sign in</a>·<wbr><a href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5856134" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5861891" name="react-item_5861891" id="MRF5861891" class="reaction-result"></span><span data-objectref="3_5861891" data-votingtype="GoodOrBad" name="RateItem_5861891" id="MVF5861891" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5861891" href="/Messages/5861891/Re-Generic-import-in-code-gen" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/images/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5843297_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5843297xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="5843297" parent="0" thread="5843297" href="/Messages/5843297/Decrypt-not-working-for-me">Decrypt not working for me...</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Christophe Kowarski</span><span class="date">17-Nov-21  0:45</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=3759598">Christophe Kowarski</a></span></td><td class="date"><span>17-Nov-21  0:45&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5843297_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Encrypt part works a treat, but no matter what I do, the decrypt part doesn't... I triple checked the code I typed, with your code from the zip file, and apart from your name at beginning of files, they are identical, except for code.cpp where bool encrypt is commented out... <br>
<br>
The only difference I notice is that code_gen.dll codemap gives me an offset of 1230, not 12C0<br>
<br>
*** from code_gen.map<br>
0001:00001230       _decrypt                   0000000180002230 f   code.obj<br>
<br>
Also, when I compiled the very first part, with the math function, I had an extra 3 bytes of code, and the end result was 601601... when I removed those extra 3 bytes appearing just before C3, and replicated your 9 bytes, I had indeed the proper result of 601700... <br>
<br>
I am a bit stumped...<br><br><div class="modified">modified  18-Nov-21 3:43am.</div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud" rel="nofollow noopener">Sign in</a>·<wbr><a href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5843297" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5843297" name="react-item_5843297" id="MRF5843297" class="reaction-result"></span><span data-objectref="3_5843297" data-votingtype="GoodOrBad" name="RateItem_5843297" id="MVF5843297" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5843297" href="/Messages/5843297/Decrypt-not-working-for-me" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/images/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5843905_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx5843905xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="5843905" parent="5843297" thread="5843297" href="/Messages/5843905/Re-Decrypt-not-working-for-me">Re: Decrypt not working for me...</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">The Ænema</span><span class="date">20-Nov-21  0:09</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=13742737">The Ænema</a></span></td><td class="date"><span>20-Nov-21  0:09&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5843905_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5843297);" href="/Messages/5843297/Decrypt-not-working-for-me"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>You should use all the offsets in map file not in the article, compilers produce different offsets.<br>
Did you try sample files, Do you face same issue with them?<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud" rel="nofollow noopener">Sign in</a>·<wbr><a href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5843297" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5843905" name="react-item_5843905" id="MRF5843905" class="reaction-result"></span><span data-objectref="3_5843905" data-votingtype="GoodOrBad" name="RateItem_5843905" id="MVF5843905" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5843905" href="/Messages/5843905/Re-Decrypt-not-working-for-me" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/images/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5843933_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="56px" class="indent"><a name="xx5843933xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="5843933" parent="5843905" thread="5843297" href="/Messages/5843933/Re-Decrypt-not-working-for-me-UPDATED">Re: Decrypt not working for me...  **UPDATED**</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Christophe Kowarski</span><span class="date">20-Nov-21  12:07</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=3759598">Christophe Kowarski</a></span></td><td class="date"><span>20-Nov-21  12:07&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5843933_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5843905);" href="/Messages/5843905/Re-Decrypt-not-working-for-me"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>that's the thing, I did try your sample files, they work perfectly fine... <br>
<br>
Now, I did of course use the offset given by the generated code_gen.map, the encrypt function works perfectly fine, it's the decrypt one I have issues with... When I run 'code_tester encrypt.jpg -d decrypt.jpg', it returns 'OK' and the size is the same as the original file again, but it's not viewable... it's not a jpg... <br>
<br>
I have a feeling that it's one of those stupid bug probably staring tin my face the whole time, but I have troubles finding what's wrong... <br>
<br>
I played around with things too, including using for the sake of trying, the OFFSET from the article, which simply crashed code_tester straight away... I also try not commenting out the encrypt part of code_gen, but effectively compiling both decrypt and encrypt, and updating the code in main.cpp too reflect both different offsets, but that didn't work either...<br>
<br>
**UPDATE**<br>
<br>
My bad, it was indeed staring at me the whole time... never occurred to me to recompile, recheck, re-copy(!!) the function given by code_gen for BOTH encrypt and decrypt, I thought I did that already but was mistaken.<br>
<br>
I redone, slowly, the whole process as you explained, and it works perfectly fine now...<br><br><div class="modified">modified  23-Nov-21 19:31pm.</div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud" rel="nofollow noopener">Sign in</a>·<wbr><a href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5843297" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5843933" name="react-item_5843933" id="MRF5843933" class="reaction-result"></span><span data-objectref="3_5843933" data-votingtype="GoodOrBad" name="RateItem_5843933" id="MVF5843933" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5843933" href="/Messages/5843933/Re-Decrypt-not-working-for-me-UPDATED" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/images/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5856210_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx5856210xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="5856210" parent="5843297" thread="5843297" href="/Messages/5856210/Re-Decrypt-not-working-for-me">Re: Decrypt not working for me...</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Member 15188363</span><span class="date">21-Jan-22  7:19</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=15188363">Member 15188363</a></span></td><td class="date"><span>21-Jan-22  7:19&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5856210_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5843297);" href="/Messages/5843297/Decrypt-not-working-for-me"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>I have same issue, can u help me ?<br>
I compile the "code_gen" with the encryption function.<br>
<br>
put in CFF explorer.<br>
put in HxD -&gt; CTRL+G -&gt; go To  <div class="pre-lang" id="premain23073"><div></div><div class="pre-action-link"><span class="code-collapse" data-index="23073" id="preShrink23073">Shrink ▲</span> &nbsp; <span id="copycode23073" class="copy-code" data-index="23073" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div>
<pre id="pre23073" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-digit">00000400</span></pre> (Raw address)<br>
CTRL + E -&gt; END <div class="pre-lang" id="premain693481"><div></div><div class="pre-action-link"><span class="code-collapse" data-index="693481" id="preShrink693481">Shrink ▲</span> &nbsp; <span id="copycode693481" class="copy-code" data-index="693481" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div>
<pre id="pre693481" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-digit">00001600</span></pre> (Raw size)<br>
<br>
i have a shellcode with len: <div class="pre-lang" id="premain165690"><div></div><div class="pre-action-link"><span class="code-collapse" data-index="165690" id="preShrink165690">Shrink ▲</span> &nbsp; <span id="copycode165690" class="copy-code" data-index="165690" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div>
<pre id="pre165690" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-digit">4609</span></pre><br>
<br>
Then i open map file and i have:<br>
<div class="pre-lang" id="premain976552"><div></div><div class="pre-action-link"><span class="code-collapse" data-index="976552" id="preShrink976552">Shrink ▲</span> &nbsp; <span id="copycode976552" class="copy-code" data-index="976552" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div>
<pre id="pre976552" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-digit">0001</span>:<span class="code-digit">00001230</span>       _encrypt                   <span class="code-digit">0000000180002230</span> f   code.obj
</pre><br>
<br>
so 2230 - <div class="pre-lang" id="premain329215"><div></div><div class="pre-action-link"><span class="code-collapse" data-index="329215" id="preShrink329215">Shrink ▲</span> &nbsp; <span id="copycode329215" class="copy-code" data-index="329215" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div>
<pre id="pre329215" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-digit">00001000</span></pre> (virtual address) = 0x1230.<br>
<br>
But when i launch the program it not work...<br>
Can i know where i wrong?<br>
<br>
FIXED-&gt; CTRL+G and CTRL +E not handle all the text data. for me i need to select more lines manually<br><br><div class="modified">modified  21-Jan-22 18:03pm.</div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud" rel="nofollow noopener">Sign in</a>·<wbr><a href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5843297" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5856210" name="react-item_5856210" id="MRF5856210" class="reaction-result"></span><span data-objectref="3_5856210" data-votingtype="GoodOrBad" name="RateItem_5856210" id="MVF5856210" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5856210" href="/Messages/5856210/Re-Decrypt-not-working-for-me" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/images/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5962903_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx5962903xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="5962903" parent="5843297" thread="5843297" href="/Messages/5962903/Re-Decrypt-not-working-for-me">Re: Decrypt not working for me...</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Member 16059259</span><span class="date">18-Sep-23  6:47</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=16059259">Member 16059259</a></span></td><td class="date"><span>18-Sep-23  6:47&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5962903_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5843297);" href="/Messages/5843297/Decrypt-not-working-for-me"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Check the return type of the math function if it is an int, it returns 601700 when the return type is bool in my case<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud" rel="nofollow noopener">Sign in</a>·<wbr><a href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5843297" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5962903" name="react-item_5962903" id="MRF5962903" class="reaction-result"></span><span data-objectref="3_5962903" data-votingtype="GoodOrBad" name="RateItem_5962903" id="MVF5962903" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5962903" href="/Messages/5962903/Re-Decrypt-not-working-for-me" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/images/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5819720_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5819720xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="5819720" parent="0" thread="5819720" href="/Messages/5819720/My-vote-of-1">My vote of 1</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Rick York</span><span class="date">8-Jul-21  14:14</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-MVE-16.gif" title="Most Valuable Expert" alt="mve" height="16px" width="16px"></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=196">Rick York</a></span></td><td class="date"><span>8-Jul-21  14:14&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5819720_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">"Yes of course! it can be used for bad and malicious purposes but you know... It's a sword! Protect or harm... it's up to you!"<br>
<br>
Most things qualify but I see absolutely no constructive reason to show people how to write malicious code.  It might be useful to show people how to prevent such things and how to detect use of this technique.  As it is the limited use of this technique is not nearly enough to justify the potential damage from publicizing this.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud" rel="nofollow noopener">Sign in</a>·<wbr><a href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5819720" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5819720" name="react-item_5819720" id="MRF5819720" class="reaction-result"></span><span data-objectref="3_5819720" data-votingtype="GoodOrBad" name="RateItem_5819720" id="MVF5819720" class="rating-result"><span>1.00/5 (2 votes)</span></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5819720" href="/Messages/5819720/My-vote-of-1" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/images/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5819833_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx5819833xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="5819833" parent="5819720" thread="5819720" href="/Messages/5819833/Re-My-vote-of-1">Re: My vote of 1</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Artem N</span><span class="date">9-Jul-21  3:38</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=1450439">Artem N</a></span></td><td class="date"><span>9-Jul-21  3:38&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5819833_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5819720);" href="/Messages/5819720/My-vote-of-1"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>"By using this technique, you can convert critical parts of your code <u>like license checking</u> to shellcode and encrypt it in your application."<br>
<br>
Why do you deny people the knowledge that would help them protect their programs from hacking?<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud" rel="nofollow noopener">Sign in</a>·<wbr><a href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5819720" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5819833" name="react-item_5819833" id="MRF5819833" class="reaction-result"></span><span data-objectref="3_5819833" data-votingtype="GoodOrBad" name="RateItem_5819833" id="MVF5819833" class="rating-result"><span>1.80/5 (2 votes)</span></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5819833" href="/Messages/5819833/Re-My-vote-of-1" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/images/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5819922_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="56px" class="indent"><a name="xx5819922xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="5819922" parent="5819833" thread="5819720" href="/Messages/5819922/Re-My-vote-of-1">Re: My vote of 1</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Rick York</span><span class="date">9-Jul-21  13:43</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-MVE-16.gif" title="Most Valuable Expert" alt="mve" height="16px" width="16px"></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=196">Rick York</a></span></td><td class="date"><span>9-Jul-21  13:43&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5819922_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5819833);" href="/Messages/5819833/Re-My-vote-of-1"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Because, as I wrote : "As it is the limited use of this technique is not nearly enough to justify the potential damage from publicizing this."<br>
<br>
Showing people how to write malicious code is very, <b>VERY</b> dangerous and that's exactly what this does.  If I were in charge of this site articles of this nature would be prohibited.<br>
<div class="signature">"They have a consciousness, they have a life, they have a soul! Damn you! Let the rabbits wear glasses! Save our brothers!  Can I get an amen?"</div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud" rel="nofollow noopener">Sign in</a>·<wbr><a href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5819720" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5819922" name="react-item_5819922" id="MRF5819922" class="reaction-result"></span><span data-objectref="3_5819922" data-votingtype="GoodOrBad" name="RateItem_5819922" id="MVF5819922" class="rating-result"><span>1.00/5 (1 vote)</span></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5819922" href="/Messages/5819922/Re-My-vote-of-1" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/images/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5821076_h0" class="header hover-row">
<td class="subject-line normal vote-hi" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="74px" class="indent"><a name="xx5821076xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="5821076" parent="5819922" thread="5819720" href="/Messages/5821076/Re-My-vote-of-1">Re: My vote of 1</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">The Ænema</span><span class="date">15-Jul-21  18:46</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=13742737">The Ænema</a></span></td><td class="date"><span>15-Jul-21  18:46&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5821076_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:74px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5819922);" href="/Messages/5819922/Re-My-vote-of-1"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div><small>I didn't get the reason why you used the lyric of tool :p</small><br>
<br>
Anyway to defeat a malicious you must know how it works, knowledge never can be judged and it depends on who is using it and if someone uses my article to harm people <b>it's the person not the knowledge itself.</b><br>
<br>
Also there's next articles about targeting windows and bypass admin access at the highest protection level, here's the result :<br>
<a href="https://youtu.be/nXkYEWHsKFA" rel="nofollow noopener">[ Hunter Exploit ] Windows 7 to 11 Fully Undetectable UAC Bypass - YouTube</a>[<a href="https://youtu.be/nXkYEWHsKFA" target="_blank" title="New Window" rel="nofollow noopener">^</a>]<br>
<b>YOU GONNA LOVE IT</b> <img src="https://www.codeproject.com/script/Forums/Images/smiley_smile.gif" align="top" alt="Smile | :)"><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud" rel="nofollow noopener">Sign in</a>·<wbr><a href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5819720" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5821076" name="react-item_5821076" id="MRF5821076" class="reaction-result"></span><span data-objectref="3_5821076" data-votingtype="GoodOrBad" name="RateItem_5821076" id="MVF5821076" class="rating-result"><span>5.00/5 (1 vote)</span></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5821076" href="/Messages/5821076/Re-My-vote-of-1" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/images/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5842836_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="92px" class="indent"><a name="xx5842836xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="5842836" parent="5821076" thread="5819720" href="/Messages/5842836/Re-My-vote-of-1">Re: My vote of 1</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Southmountain</span><span class="date">14-Nov-21  12:26</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=1652848">Southmountain</a></span></td><td class="date"><span>14-Nov-21  12:26&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5842836_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:92px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5821076);" href="/Messages/5821076/Re-My-vote-of-1"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>look forward to your article!<br>
<div class="signature">diligent hands rule....</div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud" rel="nofollow noopener">Sign in</a>·<wbr><a href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5819720" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5842836" name="react-item_5842836" id="MRF5842836" class="reaction-result"></span><span data-objectref="3_5842836" data-votingtype="GoodOrBad" name="RateItem_5842836" id="MVF5842836" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5842836" href="/Messages/5842836/Re-My-vote-of-1" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/images/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5812718_h0" class="header hover-row root">
<td class="subject-line normal vote-hi" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5812718xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="5812718" parent="0" thread="5812718" href="/Messages/5812718/My-vote-of-5">My vote of 5</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">FenderBaba</span><span class="date">14-Jun-21  20:49</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=13380585">FenderBaba</a></span></td><td class="date"><span>14-Jun-21  20:49&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5812718_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">That's a very interesting article. I am curious about the continuation  <img src="https://www.codeproject.com/script/Forums/Images/smiley_smile.gif" align="top" alt="Smile | :)">  <br>
<br>
Thank You for sharing <img src="https://www.codeproject.com/script/Forums/Images/thumbs_up.gif" align="top" alt="Thumbs Up | :thumbsup:"><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud" rel="nofollow noopener">Sign in</a>·<wbr><a href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5812718" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5812718" name="react-item_5812718" id="MRF5812718" class="reaction-result"></span><span data-objectref="3_5812718" data-votingtype="GoodOrBad" name="RateItem_5812718" id="MVF5812718" class="rating-result"><span>5.00/5 (1 vote)</span></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5812718" href="/Messages/5812718/My-vote-of-5" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/images/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5813040_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx5813040xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="5813040" parent="5812718" thread="5812718" href="/Messages/5813040/Re-My-vote-of-5">Re: My vote of 5</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">The Ænema</span><span class="date">15-Jun-21  21:28</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=13742737">The Ænema</a></span></td><td class="date"><span>15-Jun-21  21:28&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5813040_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5812718);" href="/Messages/5812718/My-vote-of-5"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>No worries &lt;3<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud" rel="nofollow noopener">Sign in</a>·<wbr><a href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5812718" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5813040" name="react-item_5813040" id="MRF5813040" class="reaction-result"></span><span data-objectref="3_5813040" data-votingtype="GoodOrBad" name="RateItem_5813040" id="MVF5813040" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5813040" href="/Messages/5813040/Re-My-vote-of-5" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/images/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5812036_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5812036xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="5812036" parent="0" thread="5812036" href="/Messages/5812036/My-vote-of-2">My vote of 2</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Vincent Radio</span><span class="date">10-Jun-21  20:50</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-pro-16.png" title="Professional" alt="professional" height="16px" width="16px"></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=13052788">Vincent Radio</a></span></td><td class="date"><span>10-Jun-21  20:50&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5812036_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">very good<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud" rel="nofollow noopener">Sign in</a>·<wbr><a href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5812036" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5812036" name="react-item_5812036" id="MRF5812036" class="reaction-result"></span><span data-objectref="3_5812036" data-votingtype="GoodOrBad" name="RateItem_5812036" id="MVF5812036" class="rating-result"><span>1.00/5 (8 votes)</span></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5812036" href="/Messages/5812036/My-vote-of-2" rel="nofollow noopener"><img src="https://codeproject.freetls.fastly.net/images/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table width="100%" cellpadding="2px" cellspacing="0">
<tbody><tr class="footer">
<td><span class="last-visit desktop-only tablet-only">Last Visit: 31-Dec-99  18:00 &nbsp; &nbsp; Last Update: 15-Jun-24  2:12</span></td><td><a rel="nofollow" href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal">Refresh</a></td><td style="text-align:right;white-space:nowrap;"><input id="_mbnUrl" type="hidden" value="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=26"><span class="nav-link selected">1</span><a class="nav-link" name="Frm_HoverNL" href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=26#xx0xx">2</a> <a class="nav-link" name="Frm_HoverNL" href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?fid=1970944&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=26#xx0xx">Next ᐅ</a></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table>
</div><p class="small-text"><img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" width="16px" height="16px" alt="General"> General &nbsp;&nbsp; <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_news.gif" width="16px" height="16px" alt="News"> News &nbsp;&nbsp; <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_idea.gif" width="16px" height="16px" alt="Suggestion"> Suggestion &nbsp;&nbsp; <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" width="16px" height="16px" alt="Question"> Question &nbsp;&nbsp; <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_bug.gif" width="16px" height="16px" alt="Bug"> Bug &nbsp;&nbsp; <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_answer.gif" width="16px" height="16px" alt="Answer"> Answer &nbsp;&nbsp; <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_joke.gif" width="16px" height="16px" alt="Joke"> Joke &nbsp;&nbsp; <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_kudos.gif" width="16px" height="16px" alt="Praise"> Praise &nbsp;&nbsp; <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_rant.gif" width="16px" height="16px" alt="Rant"> Rant &nbsp;&nbsp; <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_admin.gif" width="16px" height="16px" alt="Admin"> Admin &nbsp;&nbsp; </p><p class="small-text">Use Ctrl+Left/Right to switch messages, Ctrl+Up/Down to switch threads, Ctrl+Shift+Left/Right to switch pages.</p>
				

			</div>
			

            
            <div id="ctl00_RightSideBar" class="article-right-sidebar">

				
				

				

                <div id="ctl00_RHSticky" class="container-article-info-sticky sticky">

        		    

<div class="article-summary">

    <ul class="prize-list">
<li>Best Article of June 2021 : Second Prize</li>
</ul>
    

</div>

					<div class="padded-top" style="height:250px;width:300px">
						
						<div class="msg-300x250" data-format="300x250" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Security" data-country="US" data-loadonview="true" data-tags="C, Advanced, security, VC++, C++17, VS2019,rating4.5,article-5304605"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Security&sz=300x250&c=143977"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Security&sz=300x250&c=143977"  width="300px" height="250px" target="_blank"/></a></noscript></div>

					</div>

					<div style="margin:auto;width:160px;margin-top:10px;border: 1px solid #eee">
						<div class="msg-160x600" data-format="160x600" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Security" data-country="US" data-tags="C, Advanced, security, VC++, C++17, VS2019,rating4.5,article-5304605"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Security&sz=160x600&c=143977"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Security&sz=160x600&c=143977"  width="160px" height="600px" target="_blank"/></a></noscript></div>
					</div>

				    

                    

				    

				    

					
                    <div class="anchorLink gototop" id="gototop">
                        <a id="ctl00_GoToTop" href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud#_articleTop">Go to top</a>
                    </div>

			    </div>
            </div>
            

        </div>
        

		
		<div class="site-footer">
			<div class="align-left">
				<a id="ctl00_PermaLink" href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud">Permalink</a><br>
				<a id="ctl00_AdvertiseLink" href="http://developermedia.com/">Advertise </a><br>
				<a id="ctl00_PrivacyLink" href="/info/privacy.aspx">Privacy</a><br>
    			<a id="ctl00_CookiePolicyLink" href="/info/cookie.aspx">Cookies</a><br>
                <a id="ctl00_TermsOfUseLink" href="/info/TermsOfUse.aspx">Terms of Use</a><br>
			</div>

            <div class="align-center">
				


<div class="page-width">
    Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?PageFlow=FixedWidth">fixed</a>
    |
    <a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="/Articles/5304605/Creating-Shellcode-from-any-Code-Using-Visual-Stud?PageFlow=Fluid">fluid</a>
</div>


				

				

	            

<div class="tabs">
	<br><div>Posted 6 Jun 2021</div>


    
</div>



                <br>
			</div>
                
			<div class="align-right">
				Article Copyright 2021 by The Ænema<br>Everything else
				Copyright © <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2024 <br>
                <br>
				Web03 
				2.8:2024-06-13:1<br>
			</div>
		</div>
		

		<br clear="all">
		
			

	</div> 
	</div> 
</div>







<script type="text/javascript"> // IMMEDIATE script

function Join() {
    document.location.href = 'https://www.codeproject.com/script/Membership/Modify.aspx';
    return false;
}

var bhawiqwytz = function(n){var t=!1;n=n||{};var r=n.RetrievalServiceUrl||"/script/content/webservices/RetrieveContent.aspx/GetContent",u=n.RetrievalServiceRetries||3,f=n.RetrievalServiceTimeout||5e3,e=function(){t||(t=!0,$(window).on("resize scroll",i),i())},i=function(){if(typeof DMAds=="undefined"){var n=$('[data-type="ad"]');n.each(function(){var n=$(this),u=n.attr("data-format")||"",f=n.attr("data-publisher")||"",e=n.attr("data-zone")||"",t=n.attr("data-loadonview"),i=n.attr("data-noadx"),h=n.attr("data-tags")||"",c=n.find("iframe").length!==0||n.find("img").length!==0,r=n.attr("data-processed");t=typeof t=="string"&&t.toLowerCase()==="true";i=typeof i=="string"&&i.toLowerCase()==="true";r=typeof r=="string"&&r.toLowerCase()==="true";r||c||t&&!s(this)||(o(n,u,f,e,i,h),n.attr("data-processed","true"))})}},o=function(n,t,i,e,o,s){var h=new $.Deferred,c=JSON.stringify({format:t,publisherCode:i,zone:e,noAdX:o,keywords:s});$.ajax({url:r,cache:!1,type:"POST",data:c,contentType:"application/json; charset=utf-8",dataType:"json",tryCount:0,retryLimit:u,timeout:f}).done(function(t){var i=t?t.d:null;h.resolve(i); i && i.html && n.html(i.html)}).fail(function(n,t){h.reject(t)})},s=function(n){var t,f,e,o;if(!h(n))return!1;var u=!1,i=0,r=0;try{t=n.getBoundingClientRect();typeof innerWidth=="number"?(i=window.innerWidth,r=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(i=document.documentElement.clientWidth,r=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(i=document.body.clientWidth,r=document.body.clientHeight);f=-200;t.top===t.bottom&&(f+=n.height*-1);e=t.top>=0&&t.top-200<=r||t.top<=0&&t.top>=f;o=i>t.left&&t.right>=0;u=e&&o}catch(s){u=!0}return u},h=function(n){var t=!1,i;return n&&n.style.position!=="fixed"&&n.offsetParent?t=!0:n&&n.style.position==="fixed"&&(i=window.getComputedStyle(n),t=i&&i.display!=="none"),t&&c()},c=function(){var t=!0,n="";return typeof document.hidden!="undefined"?n="hidden":typeof document.mozHidden!="undefined"?n="mozHidden":typeof document.msHidden!="undefined"?n="msHidden":typeof document.webkitHidden!="undefined"&&(n="webkitHidden"),n!==null&&document[n]&&(t=!1),t};return{init:e}};
document.addEventListener('DOMContentLoaded', function() {
var n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP"),t;n.onreadystatechange=function(){try{if(n.readyState==4)if(n.status==200){var t=document.createElement("script");t.type="text/javascript";t.innerHTML=n.responseText;document.getElementsByTagName("body")[0].appendChild(t)}else(new bhawiqwytz).init()}catch(i){(new bhawiqwytz).init()}};try{t='/a.min.js?v=1.3';n.open("GET",t,!0);n.send()}catch(i){(new bhawiqwytz).init()}

  $('div[data-type="ad"][data-showindicator="true"]').before('<div class="small-text muted hidden">Advertisement</div>');
  setTimeout(function(){ 
    $('div[data-type="ad"][data-showindicator="true"]').each(function( index ) {
      if ($(this).height() > 0) {
       $(this).prev().removeClass('hidden');
      }
    });
  }, 2000);

});

var ratingCtrl_ctl00_RateArticle;

var forumConfig_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard_forumMsgFlag;
var forumCtrl_ctl00_MessageBoard_rating;
var forumCtrl_ctl00_MessageBoard_ratingConfig;
var forumCtrl_ctl00_MessageBoard_reaction;
var forumCtrl_ctl00_MessageBoard__reactionConfig;

var subscriptionConfig_ctl00_MessageBoard = {
 ParentId      : 'ctl00_MessageBoard_SubscribeDiv',
 NewId         : 'ctl00_MessageBoard_SubscribeNew',
 ReplyId       : 'ctl00_MessageBoard_SubscribeReplies',
 InstantId     : 'ctl00_MessageBoard_SubscribeInstant',
 DailyId       : 'ctl00_MessageBoard_SubscribeDaily',
 MessageTypeId : 'ctl00_MessageBoard_MessageType',
 GetInfoUrl    : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/GetSubscriptions',
 UpdateInfoUrl : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/UpdateSubscription',
 ForumId       : 1970944,
};
var subscriptions_ctl00_MessageBoard;

var hcqmatg = false;
var DMReportsOK = null;
function showDMAlert() { 
  var $div = $('div.msg-728x90');
  $div.append($('<img src="/images/alert-top-block.gif" style="right:0;position:absolute;z-index:0">'));
}
function onDMcallBack(event)
{
   if (event.originalEvent) event = event.originalEvent;
   jQuery.support.cors = true;
   if (event.data === 'DM-disabled') DMReportsOK = false;
   else if (event.data=='DM-enabled') DMReportsOK = true;
   else if (typeof event.data == 'object' && event.data.sender &&             event.data.sender == 'DeveloperMedia' && event.data.application=='apps' &&
            event.data.action == 'reportEnabled') {
            DMReportsOK = event.data.data.enabled;
   }
   sxopaalszp = !DMReportsOK;
}
function checkLoaded() { 
 var showBlockMsg = false;
 var block        = 'None';
 if (block === 'None' && typeof DMAds === 'undefined')
     block = 'ResourceBlocked';
 if (block === 'None' && !document.getElementById('adbp-tester'))     block = 'ResourceBlocked';
 if (block === 'None' && DMReportsOK === false)     block = 'DomModified';
 sxopaalszp = block != 'None';
 if (hcqmatg) {
  $.ajax({ url:'/script/Content/Ajax/VS.aspx',    data:{'cadm':block},     cache:false, async:true });
};
 if (showBlockMsg && block != 'None')
    showDMAlert();
}
</script>

<script type="text/javascript"> // DEFERRED script

document.addEventListener('DOMContentLoaded', function() {

	new CodeBlocks().initialise('#contentdiv');
	
	$('.author-wrapper .description').shorten({showChars: 400});
	
	anchorAnimate();
	
	$('#__EVENTVALIDATION').attr('autocomplete', 'off');
	
	$('#joinBtn').css('visibility', 'visible');
	
	MicroModal.init();
	
	$('.oauth').click(function () {
	    $this = $(this);
	    href = $this.attr('href');
	    var myWindow = window.open(href, 'popup',
	                              'width=800,height=600,location=0,menubar=0,resizeable=0,scrollbars=0,toolbar=0');
	    myWindow.focus();
	    var timer = setInterval(function () {
	        if (myWindow.closed) {
	            clearInterval(timer);
	            // window.location.reload(); // May do a POST reload, shows a warning
	            window.location = window.location; // force a GET reload
	        }
	    }, 200);
	    return false;
	});
	
	var oSrchFlt = false, oSrchBox=false, srchBoxFoc=false;
	var sbar     = $('#sb_tb');
	var sfilter  = $('#SearchFilter');
	
	if (typeof(InitWatermark) !== 'undefined')
	  InitWatermark('sb_tb', 'Search for articles, questions, tips');
	if (sbar && sfilter) {
	  sfilter.removeClass('popup'); sfilter.hide(); sfilter.removeClass('open');
	  sbar.blur(function() {
	    if (!oSrchFlt) { sfilter.hide(); sfilter.removeClass('open'); }
	    srchBoxFoc = false;
	  });
	  sbar.focus(function() {
	    oSrchFlt   = false;
	    srchBoxFoc = true;
	    sfilter.show();
	    sfilter.addClass('open');
	  });
	  sbar.mouseleave(function()    { oSrchBox = false; });
	  sbar.mouseover(function()     { oSrchBox = true; });
	  sfilter.mouseleave(function() {
	    oSrchFlt=false;
	    if (!srchBoxFoc && !oSrchBox) { sfilter.hide(); sfilter.removeClass('open'); }
	  });
	  sfilter.mouseover(function()  { oSrchFlt = true; });
	}
	
	var ratingConfig_ctl00_RateArticle = {
	  objectRef:          '2_5304605',
	  objectSubtypeId:    1,
	  objectTypeName:     'article',
	  ownerId:            13742737,
	  votingType:         'None',
	  ratingDisplayMode:  'LargeStars',
	  resultDisplayMode:  'LargeStars',
	  ratingCallback:     null,
	  staticServer:       'https://codeproject.freetls.fastly.net',
	  baseDir:            '/script/Ratings/',
	  ratingUrl:          'ajax/RateItem.aspx',
	  histogramUrl:       'ajax/Histogram.aspx',
	  getRatingUrl:       'ajax/GetRatings.aspx',
	  width:              130,
	  forceComment:       false,
	  lowVoteThreshold:   0,
	  minRating:          1,
	  maxRating:          5
	};
	ratingCtrl_ctl00_RateArticle = new RatingControl('#ctl00_RateArticle_RatingTable',ratingConfig_ctl00_RateArticle);
	
	forumConfig_ctl00_MessageBoard_ratingConfig = {
	  objectTypeId:       3,
	  objectTypeName:     'message',
	  bulkResultSelector: '#_MessageBoardctl00_MessageBoard',
	  votingType:         'GoodOrBad',
	  staticServer:       'https://codeproject.freetls.fastly.net',
	  forceComment:       false,
	  ratingDisplayMode:  'TextOnly',
	  resultDisplayMode:  'TextOnly'
	};
	forumCtrl_ctl00_MessageBoard_rating = new RatingControl('#_MessageBoardctl00_MessageBoard .content', forumConfig_ctl00_MessageBoard_ratingConfig);
	forumConfig_ctl00_MessageBoard = {
	    objectName          : 'forumCtrl_ctl00_MessageBoard',
	    messageTypeId       : 3,
	    searchPrompt        : 'Search Comments',
	    smoothScroll        : true,
	    allowReporting      : false,
	    allowRating         : false,
	    allowRatingDisplay  : true,
	    allowReactions      : false,
	    forumDir            : '/script/Forums/',
	    staticServer        : 'https://codeproject.freetls.fastly.net',
	    switchMsgCallback   : null,
	    ratingControl       : forumCtrl_ctl00_MessageBoard_rating,
	    reactionControl     : null,
	    codeblockProcessor  : new CodeBlocks(),
	    getReportFormMethod : getReportFormHtml,
	    voteHiThreshold     : 5 - 0.5,
	    reportOptions       : [
	       { reportTypeId : 19, name : 'Abusive / Trolling'},
	       { reportTypeId : 20, name : 'Inappropriate'},
	       { reportTypeId : 5, name : 'Spam'},
	    ],
	};
	forumCtrl_ctl00_MessageBoard = new ForumControl('#ForumTable',forumConfig_ctl00_MessageBoard, -1);
	forumCtrl_ctl00_MessageBoard_rating.setConfig('ratingCallback', forumCtrl_ctl00_MessageBoard.showMessageRating);
	forumCtrl_ctl00_MessageBoard.Initialise();
	
	subscriptions_ctl00_MessageBoard = new Subscriptions(subscriptionConfig_ctl00_MessageBoard);
	subscriptions_ctl00_MessageBoard.initialise();
	
	cookieconsent.initialise({
	                                    enabled : true,
	                                    cookie  : { domain: 'codeproject.com' },
	                                    palette : {
	                                        popup: { background: '#ff9900' },
	                                        button: { background: '#f5d948' }
	                                    },
	                                    law :  {
	                                        showForAllRegions : true, 
	                                        countryCode : 'US' 
	                                    },
	                                    theme: 'edgeless',
	                                    type : 'opt-in-out',
	                                    content: {
	                                        message: 'Like every other website we use cookies. By using our site you acknowledge that you have read and understand our <a href=\'/info/cookie.aspx\'>Cookie Policy</a>, <a href=\'/info/privacy.aspx\'>Privacy Policy</a>, and our <a href=\'/info/TermsOfUse.aspx\'>Terms of Service</a>.',
	                                        href:    'https://www.codeproject.com/info/privacy.aspx',
	                                        dismiss: 'Ask me later'
	                                    },
	                                    revokable:true,
	                                    onStatusChange: function(status) {
	                                        $.ajax({
	                                		    dataType  : 'json',
	                                            data: JSON.stringify({ allowCookies : this.hasConsented() }),
	                                            url: '/script/membership/webservices/LoggedOnMemberservices.aspx/SetCookieConsent',
	                                            cache: false,
	                                            type: 'POST',
	                                            contentType: 'application/json'
	                                        })
	                                        console.log(this.hasConsented() ? 'enable cookies' : 'disable cookies');
	                                        console.log(this.hasAnswered() ? 'has answered' : 'did not answer');
	                                    },
	                                });
	
	$(window).on('message', onDMcallBack);
	setTimeout(checkLoaded, 4000);

})
</script>










<div id="adbp-tester">an advertisement</div><style type="text/css">.copied::after {  position: absolute;  right: 0;  display: inline-block; white-space: nowrap; content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 8px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; } 70% { opacity: 1; } 100% { opacity: 0; } } </style><style type="text/css">.copied::after {  position: absolute;  right: 0;  display: inline-block; white-space: nowrap; content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 8px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; } 70% { opacity: 1; } 100% { opacity: 0; } } </style><script type="text/javascript">if(typeof DMAds=="undefined"){var SendDmAdUid=!1,SendSearchTermsToServer=!0,CodeProjectPublisherId="lqm.codeproject.site",EnableMutableAds=!0,EnableViewOnScroll=!0,adServer=adServer||window.location.protocol+"//ads.DeveloperMedia.com/",SearchTermUrl="https://apps.developermedia.com/Ads/PageTerms/GetTerms",AdClickUrl="https://apps.developermedia.com/Ads/PageTerms/LogClick",DownvoteUrl="https://apps.developermedia.com/Ads/AdVote/DownvoteByFingerprint",UndoDownvoteUrl="https://apps.developermedia.com/Ads/AdVote/UndoDownvote",ReportAdUrl="https://apps.developermedia.com/Ads/AdVote/ReportAd",GlobalIdUrl="https://apps.developermedia.com/Ads/GlobalUserIdentification/",CloseAdImageUrl="https://cdn1.developermedia.com/Content/images/undo.png",UndoCloseAdImageUrl="https://cdn1.developermedia.com/Content/images/redo.png",DmLogoImageUrl="https://cdn1.developermedia.com/Content/images/dm-logo-150x23.png";String.prototype.includes||(String.prototype.includes=function(n,t){"use strict";return(typeof t!="number"&&(t=0),t+n.length>this.length)?!1:this.indexOf(n,t)!==-1});var DMAdXHelper=function(){var n=[],t={},s=!1,r=!1,v=0,f=null,y=function(n){try{var i=p(n),t=w(n),r=b(n);t.insertBefore(r,t.children[0]);n.closeAdButton=i;n.reportAdDiv=t;n.adContainer.appendChild(i);n.adContainer.parentNode.appendChild(t);n.reportButton=t.getElementsByClassName("reportButton")[0];n.reportButton.disabled=!0;n.reportButton.onclick=function(){return l(n),!1}}catch(u){console.log(u)}},p=function(n){var i=document.createElement("input");return i.type="image",i.src=t.CloseAdImageUrl,i.title="Report Ad",i.align="left",i.style.cssText="z-index:1000; position:relative; left:0px; top:-"+n.height+"px; margin-top: 0px; margin-left: 0px; display:block; font-size:0px; border: 0px; padding: 0px; height:14px; width:14px",i.onclick=n.width===125&&n.height===125?function(){return c(n),l(n),!1}:function(){return c(n),!1},i},w=function(n){var t=n.width,i=n.height,r=document.createElement("div"),u="<select class='reportReason' style='max-width:150px !important; padding: 0px !important'><option>Offensive<\/option><option>Abusive<\/option><option>Off topic<\/option><option>Don't like the Ad<\/option > <option>Wrong language<\/option><\/select > ",f="<input type='button' disabled class='reportButton' style='padding: 0px !important' value='Report'><\/input>";return t===728&&i===90?k(r,u,f):t===300&&i===250?d(r,u,f):t===160&&i===600?g(r,u,f):t===125&&i===125&&nt(r),(t===728&&i===90||t===300&&i===250||t===160&&i===600)&&tt(n,r),r},b=function(n){var i=document.createElement("input");return i.type="image",i.src=t.UndoCloseAdImageUrl,i.title="Show Ad",i.style.cssText="z-index:1000; position:relative; left:0px; top:0px; width:14px; height:14px;margin-top: 0px; margin-left: 0px; font-size:0px; display:block; padding: 0px; border: 0px",i.onclick=function(){return h(n),!1},i},k=function(n,i,r){n.innerHTML="<div class='sendReportContainer' style='padding-left: 2px; display:block; line-height:initial !important'><div style='display:inline-block; font:14px/18px \"Segoe UI\", Arial'><b>Don't like this Ad?<\/b><\/div><div class='dropzone' contenteditable='true' style='margin-left:10px; height:60px; width: 250px; background-color:lightgray; border-style:dotted; border-color:black; border-radius: 5px; border-width: 2px; text-align: center; display:inline-block; white-space:normal'>1. Hit the refresh icon to show the ad again and take a screenshot. 2. Drag and Drop or paste the screenshot here<\/div><div style='margin-left:10px; display:inline-block; font:14px/18px \"Segoe UI\", Arial;'> "+i+"&nbsp;"+r+"<\/div><\/div><div class='reportSentContainer' style='display:none; padding: 15px 20px; font:14px/18px \"Segoe UI\", Arial;'><span style='color:#999'>Thank you for the report!<\/span><\/div><a href='http://www.developermedia.com/' target='_blank'><img src='"+t.DmLogoImageUrl+"' style='max-width:100%;position:absolute; right:10px; top:10px;'><\/a>";n.style.cssText="display:none; width:728px; height:90px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},d=function(n,i,r){n.innerHTML="<div class='sendReportContainer' style='padding: 5px 5px; display:block; line-height:initial !important'><div style='padding-bottom:5px; font:14px/18px \"Segoe UI\", Arial;'><b>Don't like this Ad?<\/b><\/div><div class='dropzone' contenteditable='true' style='height:100px; width: 290px; margin-top:20px; margin-bottom: 20px; background-color:lightgray; border-style:dotted; border-color:black; border-radius: 5px; border-width: 2px; text-align: center; box-sizing:border-box; white-space:normal'>1. Hit the refresh icon to show the ad again so you can take a screenshot <br/>2. Drag and Drop or paste the screenshot here<\/div><div style='margin-top:5px; font:14px/18px \"Segoe UI\", Arial; '> "+i+"<\/div><div style='margin-top:5px; display:block; font:14px/18px \"Segoe UI\", Arial;'>"+r+"<\/div><\/div><div class='reportSentContainer' style='display:none; padding: 15px 20px; font:14px/18px \"Segoe UI\", Arial; '><span style='color:#999;'>Thank you for the report!<\/span><\/div><a href='http://www.developermedia.com/' target='_blank'><img src='"+t.DmLogoImageUrl+"' style='max-width:100%;position:absolute; right:20px; bottom:10px;'><\/a>";n.style.cssText="display:none; width:300px; height:250px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},g=function(n,i,r){n.innerHTML="<div class='sendReportContainer' style='padding: 20px 15px; display:block; line-height:initial !important'><div style='padding-bottom:20px; display:block; font:14px/18px \"Segoe UI\", Arial;'><b>Don't like this Ad?<\/b><\/div><div class='dropzone' contenteditable='true' style='height:180px; width: 130px; margin-top:20px; margin-bottom: 20px; background-color:lightgray; border-style:dotted; border-color:black; border-radius: 5px; border-width: 2px; text-align: center; box-sizing:border-box; white-space:normal'>1. Hit the refresh icon to show the ad again so you can take a screenshot <br/><br/>2. Drag and Drop or paste the screenshot here<\/div><div style='padding-bottom:10px; padding-top: 10px display:block; font:14px/18px \"Segoe UI\", Arial;'> "+i+"<\/div><div style='font:14px/18px \"Segoe UI\", Arial;'>"+r+"<\/div><\/div><div class='reportSentContainer' style='display:none; padding: 15px 20px; font:14px/18px \"Segoe UI\", Arial;'><span style='color:#999;'>Thank you for the report!<\/span><\/div><a href='http://www.developermedia.com/' target='_blank'><img src='"+t.DmLogoImageUrl+"' style='max-width:120px;position:absolute; right:20px; bottom:20px;'><\/a>";n.style.cssText="display:none; width:160px; height:600px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},nt=function(n){n.innerHTML="<div class='reportSentContainer' style='padding: 5px 5px;font:14px/18px \"Segoe UI\", Arial; width: 100px; height: 100px'><span style='color:#999;'>Thank you for the report!<\/span><\/div>";n.style.cssText="display:none; width:125px; height:125px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},tt=function(n,t){if(n&&n.adContainer){var i=t.getElementsByClassName("dropzone")[0];i.dropzoneFor=n.adContainer.id;n.dropzone=i;s&&(i.ondragenter=function(n){n.currentTarget.style.backgroundColor="yellow";n.currentTarget.innerHTML="<br/><br/>Drag and Drop the ad here"},i.ondragleave=function(n){n.currentTarget.style.backgroundColor="lightgray";u(n.currentTarget.dropzoneFor)},i.ondragover=function(n){n.stopPropagation();n.preventDefault();n.currentTarget.style.backgroundColor="yellow"},i.ondrop=function(n){n.currentTarget.style.backgroundColor="lightgreen";rt(n)});r?f?f.observe(i,{childList:!0}):i.addEventListener("DOMSubtreeModified",function(){a(i)}):i.addEventListener("paste",it,!1)}},h=function(n){n.reportAdDiv.style.display==="none"?(n.reportAdDiv.style.display="table",n.closeAdButton.style.display="none",n.adContainer.style.display="none",n.dropzone.focus()):(n.reportAdDiv.style.display="none",n.closeAdButton.style.display="block",n.adContainer.style.display="block")},e=function(n){var t=i(n),r=t.dropzone;r.style.backgroundColor="lightgreen";r.innerHTML=t.width===160&&t.height===600?"<br/> Your screenshot has been received – thanks! <br/><br/> Next step: What’s wrong with the ad":t.width===300&&t.height===250?"<br/> Your screenshot has been received – thanks! <br/><br/> Next step: What’s wrong with the ad":t.width===728&&t.height===90?"Your screenshot has been received – thanks! Next step: What’s wrong with the ad":"Ad info received. Press Report to submit"},o=function(n){var t=i(n);t&&(t.reportButton.disabled=!1)},u=function(n){var t=i(n);t&&(t.reportButton.disabled=!0)},c=function(n){h(n)},l=function(n){var r=n.reportAdDiv.getElementsByClassName("reportReason")[0],s=r&&r.options[r.selectedIndex].value||"Unspecified",u=n.reportAdDiv.getElementsByClassName("sendReportContainer")[0],f=n.reportAdDiv.getElementsByClassName("reportSentContainer")[0];u&&(u.style.display="none");f&&(f.style.display="block");try{var e=new XMLHttpRequest,i=new FormData,h=DMUserIdentityHelper&&DMUserIdentityHelper.getGlobalUserId()||0,o=null;n.fileList&&n.fileList.length>0&&(o=n.fileList[0]);e.open("POST",t.DownvoteUrl,!0);i.append("adScreenshot",o);i.append("reason",s);i.append("DmGlobalUserId",h);e.send(i)}catch(c){console.log(c)}},it=function(n){var t,h,l,s,c,a,f,v;if(!r){if(n.preventDefault(),t=[],h=!1,window.clipboardData)t=window.clipboardData.files,h=!0;else if((n.clipboardData||n.originalEvent.clipboardData)&&(l=n.clipboardData||n.originalEvent.clipboardData,s=l&&l.items||[],t=[],s&&s.length>0))for(h=!0,c=0;c<s.length;c++)a=s[c],a.kind==="file"&&(t[t.length]=a.getAsFile());f=n.currentTarget.dropzoneFor;t&&t.length>0?(v=i(f),v&&(v.fileList=t),o(f),e(f)):h?(n.currentTarget.innerHTML="<br/><br/> No files found on clipboard <br/>",u(f)):(n.currentTarget.innerHTML="<br/><br/> Paste not supported on your browser <br/>",u(f))}},rt=function(n){var f,r,t;if(n.stopPropagation(),n.preventDefault(),f=i(n.currentTarget.dropzoneFor),r=[],n.dataTransfer.files&&n.dataTransfer.files.length>0)for(t=0;t<n.dataTransfer.files.length;t++)n.dataTransfer.files[t].type&&n.dataTransfer.files[t].type.indexOf("image")>=0&&(r[r.length]=n.dataTransfer.files[t]);r.length>0?(f&&(f.fileList=r),e(n.currentTarget.dropzoneFor),o(n.currentTarget.dropzoneFor)):(n.currentTarget.style.backgroundColor="yellow",n.currentTarget.innerHTML="<br/><br/>The dropped item was not an image",u(n.currentTarget.dropzoneFor))},a=function(n){for(var t,i=0;i<n.children.length;i++)t=n.children[i],t.nodeName.toLowerCase()==="img"&&t.style.display!=="none"&&t.src&&(t.style.display="none",ut(t.src,n))},ut=function(n,t){if(n){var f=n.indexOf(","),r=n.substring(0,f),h=r.indexOf(":"),c=r.indexOf(";"),l=r.substring(h+1,c),a=n.substring(f+1),v=ot(a,l,512),u=t.dropzoneFor,s=i(u);s&&(s.fileList=[v]);e(u);o(u)}},ft=function(){var n=document.createElement("div");return"draggable"in n||"ondragstart"in n&&"ondrop"in n},et=function(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1},i=function(t){for(var i=0,r=n.length;i<r;i++)if(n[i]&&n[i].adContainer&&n[i].adContainer.id===t)return n[i];return null},ot=function(n,t,i){var e,o,r,f,s,u,h;for(t=t||"",i=i||512,e=atob(n),o=[],r=0;r<e.length;r+=i){for(f=e.slice(r,r+i),s=new Array(f.length),u=0;u<f.length;u++)s[u]=f.charCodeAt(u);h=new Uint8Array(s);o.push(h)}return new Blob(o,{type:t})};return{appendAd:function(t){n.push(t)},init:function(i,u){n=i;t=u;s=ft();r=et();r&&window.MutationObserver&&(f=new MutationObserver(function(n){n.forEach(function(n){a(n.target)})}))},showAdReportingInterface:function(n){var t=i(n);t&&y(t)},setGlobalUserId:function(n){v=n}}}(),DMUserIdentityHelper=function(){var r,t,u="dmaduid",f="dmaduid_confirm",e,o,i=[],n=0,l=function(){return SendDmAdUid?navigator.cookieEnabled!==void 0?navigator.cookieEnabled:(document.cookie="testcookie=test; max-age=10000",document.cookie.indexOf("testcookie=test")>=0):!1},a=function(){var t=document.location.hostname,n=/([^.]+\.[^.]{3,})$/i.exec(t);return n?n[1]:(n=/([^.]+\.[^.]+\.[^.]{2})$/i.exec(t),n!==null?n[1]:t)},s=function(n,t,i,r,u,f){var e="",o;e=n+"="+t;i>0&&(o=new Date,o.setTime(o.getTime()+i*864e5))&&(e+="; expires="+o.toGMTString());r&&(e+="; path="+r);u&&u.indexOf(".")!==-1&&(e+="; domain="+u);f&&(e+="; secure");document.cookie=e},h=function(n){var r=document.cookie,u=null,t,i;if(r!=="")for(t=r.split(";"),index=0;index<t.length;index++)if(i=t[index].replace(/^\s+/,""),i.substring(0,n.length+1)===n+"="){u=i.substring(n.length+1);break}return u},v=function(n){var t=document.createElement("IFRAME");return t.width=1,t.height=1,t.src=e,t.id="DMGlobalUserIdetifierIFRAME",t.name="DMGlobalUserIdetifierIFRAME",t.style.display="none",document.body.appendChild(t),t.onload=n,t},y=function(){var i,l,n,a,e;if(r)if(i=h(u),l=h(f),!l&&JSON){if(n={},n.sender=location.href,n.Id=Math.random(),a=function(){o.contentWindow.postMessage(JSON.stringify(n),GlobalIdUrl)},e=function(i){var r=null,e;try{r=JSON.parse(i.data)}catch(o){}r&&r.Id&&r.Id===n.Id&&(e=r.DmGlobalUserId,s(u,e,365,"/",t,!1),s(f,r.DmGlobalUserConfirmResponse,365,"/",t,!1),c(e))},window.addEventListener)window.addEventListener("message",e,!1);else try{window.attachEvent("message",e)}catch(y){}o=v(a)}else i&&c(i)},c=function(t){for(n=t;i.length>0;){var r=i.pop();typeof r=="function"&&r()}};return{init:function(n){e=n;r=l();t=a();y()},getGlobalUserId:function(t){return n!==0?n:t?(i.push(t),n):void 0}}}(),DMAds={PageQueryTerms:"",PageTags:null,Tile:1,CurrentDocument:null,PublisherCode:"",PublisherPageViewID:0,PublisherPageViewGuid:null,CreateAdsCalled:!1,GetTermsCalled:!1,Ads:[],GPTRenderingMode:"loading",PIIViolatingUrls:["http://www.aspsnippets.com/handlers/comments.ashx","codeproject.com/script/membership/sendpassword.aspx","http://www.dailyfreecode.com/userlogin.aspx","codeproject.com/script/membership/modify.aspx","dotnetspider.com/account/login.aspx","codeproject.com/script/membership/logon.aspx"],SetQueryTerms:function(){function u(n){for(var i,u="",t=0;t<r.length;t++)if(i=r[t],n.indexOf(i.d)>=0){u=i.q;break}return u}function f(n,t){var r=t.toLowerCase().indexOf(n),u,i;return r<0||r+n.length>=t.length?"":(u=t.indexOf("&",r),u<0&&(u=t.length),i=t.substring(r+n.length,u),i=i.replace(/\+/gi," "),i=decodeURIComponent(i),i.replace(/\"/gi,""))}function e(n){if(n===undefined)return"";var t=n.replace(/^\s+|\s+$/gi,"");return t?(t=t.replace(/\bAND\b|\bNOT\b|^NOT\b|\bOR\b|[^A-Z0-9\+\-\#\._\s]+|\b[A-Z0-9]+:/gi," "),t.replace(/\s+/g," ")):""}var r=[{d:"www.google.",q:"q="},{d:"www.bing.com",q:"q="},{d:"search.live.com",q:"q="},{d:"search.yahoo.com",q:"p="},{d:"codeproject.com",q:"q="},{d:"msdn.microsoft.com",q:"query="},{d:"www.ask.com",q:"q="},{d:"yandex.com",q:"text="},{d:"yandex.ru",q:"text="},{d:"www.baidu.com",q:"wd="},{d:"localhost",q:"q="},{d:"mkyong.com",q:"q="},{d:"codeplex.com",q:"query="},{d:"aspsnippets.com",q:"q="},{d:"trirand.com",q:"s="}],i="",n=document.URL,t=u(n);if(t!==""&&(i=e(f(t,n))),i===""){if(n=document.referrer.toLocaleLowerCase(),!n)return"";t=u(n);t!==""&&(i=e(f(t,n)))}DMAds.PageQueryTerms=i},SetPageTagsAndPixels:function(n){var t,i,r,u;if(JSON){if(DMAds.GetTermsCalled){n&&n();return}DMAds.GetTermsCalled=!0;t=document.URL;t.indexOf("?")>0&&(t=t.substring(0,t.indexOf("?")));try{i=top.document.title}catch(f){i="FAILED TO GET DOCUMENT TITLE"}r={terms:DMAds.PageQueryTerms,title:i,url:t,publisher:DMAds.PublisherCode,DmGlobalUserId:DMUserIdentityHelper&&DMUserIdentityHelper.getGlobalUserId()||0,numberOfAdsOnPage:DMAds.Ads.length};u=function(t){if(t){var i;try{i=JSON.parse(t)}catch(r){}i&&(i.SearchTerms&&(DMAds.PageTags=i.SearchTerms),i.PublisherPageViewGuid&&(DMAds.PublisherPageViewGuid=i.PublisherPageViewGuid),i.aid&&i.aid.length&&i.aid.length>0&&DMAds.InsertAudiencePixels(i.aid))}DMAds.PublisherPageViewGuid||(DMAds.PublisherPageViewGuid=1);n&&n()};DMAds.POSTJson(SearchTermUrl,r,u,!0,500)}},InsertAudiencePixels:function(n){var t,i;try{for(t=0,i=n.length;t<i;t++){var r=Math.random()+"",u=r*1e13,f=new Image;f.src="https://pubads.g.doubleclick.net/activity;dc_iu=/6839/DFPAudiencePixel;ord="+u+";dc_seg="+n[t]+"?"}}catch(e){}},GetRandom:function(n,t){for(var u,i="",r=0;r<n;r++)u=Math.floor(Math.random()*t).toString(t).toUpperCase(),i=i+u;return i},POSTJson:function(n,t,i,r,u){var f;if(JSON&&(f=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP"),f)){var s=!1,o=function(n){s||(s=!0,i&&i(n))},e=null;r&&(e=setTimeout(function(){try{f.abort()}catch(n){}o(null)},u));f.onreadystatechange=function(){try{f.readyState===4&&(e&&clearTimeout(e),f.status===200?o(f.responseText):o(null))}catch(n){e&&clearTimeout(e);o(null)}};try{f.open("POST",n,!0);f.setRequestHeader("Content-Type","application/json");f.send(JSON.stringify(t))}catch(h){e&&clearTimeout(e);o(null)}}},SignalSuccess:function(n){window.top&&window.top.postMessage&&setTimeout(function(){window.top.postMessage(n?"DM-enabled":"DM-disabled","*")},1e3)},CreateAds:function(n){this.PageRandomNumber=DMAds.GetRandom(32,16);var e=function(n){var t=DMAds.Ads[n];t.rendered=!0;DMAds.GPTRenderingMode==="weLoadedGPT"?DMAds.BuildGPTTag(t):DMAds.BuildInlineGPTTag(t)},l=function(n){var e=DMAds.Ads[n],h=e.theAdDiv,u=!1,i=0,r=0,t,f,o,s;try{t=h.getBoundingClientRect();typeof innerWidth=="number"?(i=window.innerWidth,r=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(i=document.documentElement.clientWidth,r=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(i=document.body.clientWidth,r=document.body.clientHeight);f=-200;t.top===t.bottom&&(f+=e.height*-1);o=t.top>=0&&t.top-200<=r||t.top<=0&&t.top>=f;s=i>t.left&&t.right>=0;u=o&&s}catch(c){u=!0}return u},t=function(){for(var t,i=0,n=0;n<DMAds.Ads.length;n++)t=DMAds.Ads[n],!t.rendered&&l(n)&&u(n)&&e(n),t.rendered&&(i++,t.sticky&&!t.stickySettings&&(t.stickySettings=s(t)),c(n));i===DMAds.Ads.length&&clearInterval(f)},o=function(){var n=function(){for(var c,i,r,o,s=EnableViewOnScroll,n=0;n<DMAds.Ads.length;n++)c=DMAds.Ads[n],c.rendered=!1,i=c.displayOverride,i==="onscroll"||i==="true"?s=!0:(i==="always"||i==="false")&&(s=!1),!s&&u(n)&&e(n);if(t(),window.addEventListener)window.addEventListener("resize",function(){t();h()},!1),window.addEventListener("scroll",t,!1);else try{window.attachEvent("onresize",function(){t();h()});window.attachEvent("onscroll",t)}catch(l){}for(a(),r=!1,o=0;o<DMAds.Ads.length&&!r;o++)if(r=!u(o),r)break;r&&(f=setInterval(t,100))};DMAds.GPTRenderingMode==="loading"?googletag.cmd.push(function(){n()}):n()},a=function(){var n=null;typeof document.hidden!="undefined"?n="visibilitychange":typeof document.mozHidden!="undefined"?n="mozvisibilitychange":typeof document.msHidden!="undefined"?n="msvisibilitychange":typeof document.webkitHidden!="undefined"&&(n="webkitvisibilitychange");n&&document.addEventListener&&document.addEventListener(n,t,!1)},s=function(n){var u=null,i,t;return n.adContainer&&(i=r(n.adContainer),t={},t.isStickyRequired=n.sticky&&n.sticky==="top",t.absoluteTop=i.y,t.absoluteLeft=i.x,t.absoluteTop!==-1&&(t.originalPosition=n.theAdDiv.style.position,u=t)),u},h=function(){for(i=0;i<DMAds.Ads.length;i++){var n=DMAds.Ads[i];n.stickySettings&&n.adContainer&&(n.adContainer.style.position=n.stickySettings.originalPosition,n.stickySettings=s(n),c(i))}},c=function(n){var t=DMAds.Ads[n].adContainer,i=DMAds.Ads[n].stickySettings,f=DMAds.Ads[n].theAdDiv,u,h,s;if(i&&i.isStickyRequired&&t.getBoundingClientRect&&document.getElementsByClassName){u=document.getElementsByClassName("sticky-stop")[0];u&&(h=r(u),s=u.getBoundingClientRect());var c=r(t),e=t.getBoundingClientRect(),o,l=c.y+e.height+Math.abs(e.top)>h.y;u&&l&&s.top<e.height?o=s.top-e.height+"px":window.pageYOffset+10>=i.absoluteTop&&(o="10px");o?(t.style.position="fixed",t.style.top=o,t.style.left=i.absoluteLeft-window.pageXOffset+"px",f.clientHeight===0&&(f.style.height=t.clientHeight+"px"),f.clientWidth===0&&(f.style.width=t.clientWidth+"px")):t.style.position=i.originalPosition}},r=function(n){var t={};if(t.x=-1,t.y=-1,n.getBoundingClientRect){var r=n.getBoundingClientRect(),i=document.documentElement,u=window.pageYOffset||i.scrollTop||document.body.scrollTop||0,f=window.pageXOffset||i.scrollLeft||document.body.scrollLeft||0,e=i.clientTop||document.body.clientTop||0,o=i.clientLeft||document.body.clientLeft||0;t.y=r.top+u-e;t.x=r.left+f-o}return t},u=function(n){var t=DMAds.Ads[n].theAdDiv,i=!1,r;return t&&t.style.position!=="fixed"&&t.offsetParent?i=!0:t&&t.style.position==="fixed"&&(r=window.getComputedStyle(t),i=r&&r.display!=="none"),i&&v()},v=function(){var t=!0,n="";return typeof document.hidden!="undefined"?n="hidden":typeof document.mozHidden!="undefined"?n="mozHidden":typeof document.msHidden!="undefined"?n="msHidden":typeof document.webkitHidden!="undefined"&&(n="webkitHidden"),n!==null&&document[n]&&(t=!1),t},f=f||null;n||DMAds.CreateAdsCalled?n&&(DMAds.Ads[DMAds.Ads.length]=DMAds.GetDivRequestData(n,DMAds.Ads.length-1),DMAds.PublisherCode=DMAds.Ads[0].publisher,DMAds.SetPageTagsAndPixels(o)):(DMAds.CreateAdsCalled=!0,DMAds.SetAdRequestData(),DMAds.Ads.length>0&&(DMAds.PublisherCode=DMAds.Ads[0].publisher,DMAds.SetPageTagsAndPixels(o)))},ShowAd:function(n){var t=DMAds.Ads,i;if(n&&(DMAds.GPTRenderingMode!=="weLoadedGPT"||!DMAds.PublisherPageViewGuid))t.push(n),DMAds.GetTermsCalled||(DMAds.PublisherCode=n.sitename,DMAds.SetPageTagsAndPixels(DMAds.ShowAd));else if(DMAds.GPTRenderingMode==="weLoadedGPT"&&DMAds.PublisherPageViewGuid){while(t&&t.length>0)i=t.pop(),DMAds.RequestQueuedAd(i);n&&DMAds.RequestQueuedAd(n)}},InitGPTLibrary:function(){if(googletag){var n=function(){if(googletag.pubadsReady)DMAds.GPTRenderingMode!=="weLoadedGPT"&&(DMAds.GPTRenderingMode="gptAlreadyLoaded");else{if(googletag.pubads().enableSingleRequest(),googletag.pubads().disableInitialLoad(),DMAds.Ads&&DMAds.Ads[0]&&typeof DMAds.Ads[0].cookieConsent!="undefined"){var n=DMAds.Ads[0].cookieConsent?1:0;googletag.pubads().setRequestNonPersonalizedAds(n?0:1)}googletag.pubads().enableAsyncRendering();googletag.enableServices();DMAds.GPTRenderingMode="weLoadedGPT";googletag.pubads().addEventListener("slotRenderEnded",function(n){DMAds.OnSlotRendered(n)})}};googletag.apiReady?n():googletag.cmd.push(function(){n()})}},BuildIFrameTag:function(n){var t=document.createElement("IFRAME"),i;return t.allowtransparency=!1,t.id="dm-gpt-iframe-"+n.tile,t.width=n.width,t.height=n.height,t.marginWidth=0,t.marginHeight=0,t.frameBorder=0,t.scrolling="no",i=encodeURIComponent(location.href),i.length<2048&&(t.dc_ref=i),t},BuildInlineGPTTagScript:function(n){var t="div-gpt-ad-"+n.publisher+"-"+n.zone+"-"+n.tile,i="/6839/"+n.publisher+"/"+n.zone,r="["+n.width+", "+n.height+"]",u=(n.tags||"")+","+(DMAds.PageSearchTerms||"")+","+(DMAds.PageQueryTerms||""),f=n.cookieConsent!==undefined,e=n.cookieConsent?1:0,o="<div id='"+t+"'>     <script type='text/javascript'>         googletag.cmd.push(function() {             if ( "+f+" && typeof googletag.pubads == 'function') {               googletag.pubads().setRequestNonPersonalizedAds("+e+" ? 0 : 1);            }            googletag.defineSlot('"+i+"', "+r+",'"+t+"')                 .addService(googletag.pubads())                 .setTargeting('kw', '"+u+"');             googletag.enableServices();             googletag.display('"+t+"');         });     <\/script> <\/div>";return"<script type='text/javascript'> var googletag = googletag || {}; googletag.cmd = googletag.cmd || []; (function() {     var gads = document.createElement('script');     gads.async = true;     gads.type = 'text/javascript';     var useSSL = 'https:' == document.location.protocol;     gads.src = (useSSL ? 'https:' : 'http:') + '//www.googletagservices.com/tag/js/gpt.js';     var node =document.getElementsByTagName('script')[0];     node.parentNode.insertBefore(gads, node); })(); <\/script>"+o},BuildGPTTag:function(n){var t=document.createElement("DIV"),i;t.style.height=n.height+"px";t.style.width=n.width+"px";t.style.boxSizing="border-box";t.style.border="0px";t.style.fontSize="0px";i="div-gpt-ad-"+n.publisher+"/"+n.zone+"-"+n.tile;t.id=i;t.adIndex=n.index;n.theAdDiv.appendChild(t);n.adContainer=t;googletag.cmd.push(function(){var u="/6839/"+n.publisher+"/"+n.zone,r=(n.tags||"")+","+(DMAds.PageSearchTerms||"")+","+(DMAds.PageQueryTerms||""),t;r=DMAds.EscapeSpecialCharacters({tags:r});t=googletag.defineSlot(u,[n.width,n.height],i).setTargeting("kw",r);n.articleid&&n.articleid>0&&t.setTargeting("articleid",n.articleid);t.addService(googletag.pubads());n.collapse_empty&&t.setCollapseEmptyDiv(!0,!0);googletag.display(i);googletag.pubads().refresh([t],{changeCorrelator:!1})})},RequestQueuedAd:function(n){googletag.cmd.push(function(){var r="/6839/"+n.sitename+"/"+n.zonename,i=(n.tags||"")+","+(DMAds.PageSearchTerms||""),t;i=DMAds.EscapeSpecialCharacters({tags:i});t=googletag.defineSlot(r,[n.width,n.height],n.targetDivId).setTargeting("kw",i);n.articleid&&n.articleid>0&&t.setTargeting("articleid",n.articleid);t.addService(googletag.pubads());n.collapse_empty&&t.setCollapseEmptyDiv(!0,!0);googletag.display(n.targetDivId);googletag.pubads().refresh([t],{changeCorrelator:!1})})},BuildInlineGPTTag:function(n){var t=DMAds.BuildIFrameTag(n),i;n.theAdDiv.appendChild(t);i=t.contentDocument||t.contentWindow.document||t.contentWindow.window.document;i.write(DMAds.BuildInlineGPTTagScript(n))},EscapeSpecialCharacters:function(n){var t=n.tags,i;t=t.replace(/\+/gi,"{plus}");t=t.replace(/\#/gi,"{sharp}");t=t.replace(/\./gi,"{dot}");t=t.replace(/[\#\*\.\(\)\+\<\>\[\]]/gi,"");for(var r=t.split(","),u=[];r.length>0;)i=r.shift(),/[^\u0020-\u007f]/.test(i)||u.push(i);return u.join(",")},GetArticleId:function(n){var t=0,i,r;if(n&&n===CodeProjectPublisherId)try{i="Articles";r=window.location.href.indexOf(i);r>=0&&(t=window.location.href.substring(r+i.length+1),t=t.substring(0,t.indexOf("/")),t=parseInt(t),isNaN(t)&&(t=0))}catch(u){t=0}return t},IsPagePIICompliant:function(){var t=!0,i,n,r;try{for(i=window.location.href.toLowerCase(),n=0,r=DMAds.PIIViolatingUrls.length;n<r&&t;n++)t=!(i.indexOf(DMAds.PIIViolatingUrls[n])>=0)}catch(u){console.log("Error in IsPagePIICompliant: "+u)}return t},OnSlotRendered:function(n){if(window.location.href&&window.location.href.includes("show_creative_id=1")&&n&&n.creativeId&&console.log(n.creativeId),EnableMutableAds&&n&&!n.isEmpty&&(!n.lineItemId||n.lineItemId&&n.lineItemId===0))DMAdXHelper.showAdReportingInterface(n.slot.getSlotElementId());else if(n&&n.isEmpty){var t=document.getElementById(n.slot.getSlotElementId());t.style.width="0px";t.style.height="0px";t.style.display="none"}DMAds.SignalSuccess(!0)},DetermineTagSize:function(n){if(n.format){var t=n.format.split("x");t.length===2&&(n.width=parseInt(t[0]),n.height=parseInt(t[1]))}},GetElementsByAttr:function(n,t,i,r){var o=[],u,e;i||(i=document);r||(r="*");var f=i.getElementsByTagName(r),s=f.length,h=new RegExp("(^|\\s)"+t+"(\\s|$)");for(u=0,e=0;u<s;u++)h.test(f[u].getAttribute(n))&&(o[e]=f[u],e++);return o},GetElementsByClass:function(n,t,i){var e=[],r,f;t||(t=document);i||(i="*");var u=t.getElementsByTagName(i),o=u.length,s=new RegExp("(^|\\s)"+n+"(\\s|$)");for(r=0,f=0;r<o;r++)s.test(u[r].className)&&(e[f]=u[r],f++);return e},SetAdRequestData:function(){var n=DMAds.GetElementsByAttr("data-type","ad",document,"div"),t;for((n===null||n.length<=0)&&(n=DMAds.GetElementsByClass("lqm_ad",document,"div")),t=0;t<n.length;t++)DMAds.Ads[DMAds.Ads.length]=DMAds.GetDivRequestData(n[t],t)},GetDivRequestData:function(n,t){for(var u,f,r,o=n.attributes,s=o.length,i={},e=0;e<s;e++)u=o.item(e),u.nodeName.indexOf("lqm_")===0&&(f=u.nodeName.slice(4),i[f]=u.value||u.nodeValue),u.nodeName.indexOf("data-")===0&&(f=u.nodeName.slice(5),i[f]=u.value||u.nodeValue);return r={height:0,width:0,publisher:i.publisher,zone:i.zone||"ros",site:i.site,tags:i.tags,sitename:undefined,zonename:undefined,target:"_blank",format:i.format,index:t,tile:t+1,type:i.type,noadx:i.noadx,collapse_empty:i.collapse_empty,displayOverride:i.display||i.loadOnView,sticky:i.sticky,charity:i.charity,cookieConsent:i.cookieconsent,theAdDiv:n},r.tags&&(r.tags=decodeURIComponent(r.tags)),DMAds.DetermineTagSize(r),r.publisher&&r.publisher===CodeProjectPublisherId&&(r.articleid=DMAds.GetArticleId(r.publisher)),r},SetupAds:function(){DMAds.IsPagePIICompliant()&&(DMAds.InitGPTLibrary(),DMAds.SetQueryTerms(),DMAdXHelper.init(DMAds.Ads,{DownvoteUrl:DownvoteUrl,UndoDownvoteUrl:UndoDownvoteUrl,ReportAdUrl:ReportAdUrl,CloseAdImageUrl:CloseAdImageUrl,UndoCloseAdImageUrl:UndoCloseAdImageUrl,DmLogoImageUrl:DmLogoImageUrl}),DMUserIdentityHelper.init(GlobalIdUrl),DMAds.CreateAds())},Initialise:function(){if(DMAds.IsPagePIICompliant())if(window.googletag)DMAds.SetupAds();else{var t="https:"===document.location.protocol,n=document.createElement("script");n.async=!0;n.type="text/javascript";n.src=(t?"https:":"http:")+"//www.googletagservices.com/tag/js/gpt.js";n.onload=this.SetupAds;document.body.appendChild(n)}}};window.DMAds=DMAds}if(DMAds.IsPagePIICompliant())if(window.addEventListener)window.addEventListener("load",function(){DMAds.Initialise()},!1);else try{window.attachEvent("onload",function(){DMAds.Initialise()})}catch(e){DMAds.Initialise()}</script><script async="" type="text/javascript" src="https://www.googletagservices.com/tag/js/gpt.js"></script><script async="" type="text/javascript" src="https://www.googletagservices.com/tag/js/gpt.js"></script><div style="position: fixed; z-index: 9999; height: 360px;" id="credential_picker_container"><iframe src="https://accounts.google.com/gsi/iframe/select?client_id=857795997829.apps.googleusercontent.com&amp;ux_mode=popup&amp;ui_mode=card&amp;as=68Th0pLS8HdOXGotHrIlxQ&amp;is_itp=true&amp;channel_id=6e20504b9f87ac053eff31381646d99d95ab9a8e07ed629c7c3eb7bbf5a0fb82&amp;origin=https%3A%2F%2Fwww.codeproject.com" title="Okno Zaloguj się przez Google" style="height: 360px; width: 391px; overflow: hidden;"></iframe></div><iframe style="display: none; width: 0px; height: 0px; border: medium; z-index: -1000; left: -1000px; top: -1000px;" name="googlefcPresent"></iframe><iframe name="__tcfapiLocator" src="about:blank" style="display: none; width: 0px; height: 0px; border: medium; z-index: -1000; left: -1000px; top: -1000px;"></iframe><iframe name="googlefcInactive" src="about:blank" style="display: none; width: 0px; height: 0px; border: medium; z-index: -1000; left: -1000px; top: -1000px;"></iframe><iframe name="googlefcLoaded" src="about:blank" style="display: none; width: 0px; height: 0px; border: medium; z-index: -1000; left: -1000px; top: -1000px;"></iframe></body></html>