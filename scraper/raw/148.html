<html lang="en" data-rh="lang"><head><title>Windows Process Internals: A few Concepts to know before jumping on Memory Forensics [Part 5] — A Journey in to the Undocumented Process Handle Structures | by imp hash | Medium</title><meta data-rh="true" charset="utf-8"><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"><meta data-rh="true" name="theme-color" content="#000000"><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"><meta data-rh="true" property="al:ios:app_name" content="Medium"><meta data-rh="true" property="al:ios:app_store_id" content="828256236"><meta data-rh="true" property="al:android:package" content="com.medium.reader"><meta data-rh="true" property="fb:app_id" content="542599432471018"><meta data-rh="true" property="og:site_name" content="Medium"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2020-09-13T03:05:04.915Z"><meta data-rh="true" name="title" content="Windows Process Internals: A few Concepts to know before jumping on Memory Forensics [Part 5] — A Journey in to the Undocumented Process Handle Structures | by imp hash | Medium"><meta data-rh="true" property="og:title" content="Windows Process Internals: A few Concepts to know before jumping on Memory Forensics [Part 5] — A…"><meta data-rh="true" property="al:android:url" content="medium://p/2368187685e"><meta data-rh="true" property="al:ios:url" content="medium://p/2368187685e"><meta data-rh="true" property="al:android:app_name" content="Medium"><meta data-rh="true" name="description" content="In this series of articles of “Must know Process Internals for Memory Forensics” — we have traversed through ActiveProcessLinks (doubly-linked list) of EPROCESS in Part-1 to understand how memory…"><meta data-rh="true" property="og:description" content="In this series of articles of “Must know Process Internals for Memory Forensics” — we have traversed through ActiveProcessLinks…"><meta data-rh="true" property="og:url" content="https://imphash.medium.com/windows-process-internals-a-few-concepts-to-know-before-jumping-on-memory-forensics-part-5-a-2368187685e"><meta data-rh="true" property="al:web:url" content="https://imphash.medium.com/windows-process-internals-a-few-concepts-to-know-before-jumping-on-memory-forensics-part-5-a-2368187685e"><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:1200/1*B6zCphcdYAGGUKEulQe0uQ.png"><meta data-rh="true" property="article:author" content="https://imphash.medium.com"><meta data-rh="true" name="author" content="imp hash"><meta data-rh="true" name="robots" content="index,follow,max-image-preview:large"><meta data-rh="true" name="referrer" content="unsafe-url"><meta data-rh="true" property="twitter:title" content="Windows Process Internals: A few Concepts to know before jumping on Memory Forensics [Part 5] — A…"><meta data-rh="true" name="twitter:site" content="@Medium"><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/2368187685e"><meta data-rh="true" property="twitter:description" content="In this series of articles of “Must know Process Internals for Memory Forensics” — we have traversed through ActiveProcessLinks…"><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:1200/1*B6zCphcdYAGGUKEulQe0uQ.png"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="twitter:label1" content="Reading time"><meta data-rh="true" name="twitter:data1" content="7 min read"><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/1*m-R_BkNf1Qjr1YbyOIJY2w.png"><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:152:152/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:120:120/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:76:76/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:60:60/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/Medium-Avatar-500x500.svg" color="#171717"><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossorigin=""><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"><link data-rh="true" rel="author" href="https://imphash.medium.com"><link data-rh="true" rel="canonical" href="https://imphash.medium.com/windows-process-internals-a-few-concepts-to-know-before-jumping-on-memory-forensics-part-5-a-2368187685e"><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/2368187685e"><style type="text/css" data-fela-rehydration="502" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="502" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-webkit-keyframes k1{0%{transform:translate(-50%, -100px)}100%{transform:translate(-50%, 0)}}@-moz-keyframes k1{0%{transform:translate(-50%, -100px)}100%{transform:translate(-50%, 0)}}@keyframes k1{0%{transform:translate(-50%, -100px)}100%{transform:translate(-50%, 0)}}</style><style type="text/css" data-fela-rehydration="502" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{margin-left:16px}.av{border:none}.aw{border-radius:20px}.ax{width:240px}.ay{background:#F9F9F9}.az path{fill:#6B6B6B}.bb{outline:none}.bc{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bd{font-size:14px}.be{width:100%}.bf{padding:10px 20px 10px 0}.bg{background-color:transparent}.bh{color:#242424}.bi::placeholder{color:#6B6B6B}.bj{display:inline-block}.bk{margin-left:12px}.bl{margin-right:12px}.bm{border-radius:4px}.bn{margin-left:24px}.bo{height:24px}.bu{background-color:#F9F9F9}.bv{border-radius:50%}.bw{height:32px}.bx{width:32px}.by{justify-content:center}.ce{max-width:680px}.cf{min-width:0}.cg{animation:k1 1.2s ease-in-out infinite}.ch{height:100vh}.ci{margin-bottom:16px}.cj{margin-top:48px}.ck{align-items:flex-start}.cl{flex-direction:column}.cm{justify-content:space-between}.cn{margin-bottom:24px}.ct{width:80%}.cu{background-color:#F2F2F2}.da{height:44px}.db{width:44px}.dc{margin:auto 0}.dd{margin-bottom:4px}.de{height:16px}.df{width:120px}.dg{width:80px}.dm{margin-bottom:8px}.dn{width:96%}.do{width:98%}.dp{width:81%}.dq{margin-left:8px}.dr{color:#6B6B6B}.ds{font-size:13px}.dt{height:100%}.el{color:#FFFFFF}.em{fill:#FFFFFF}.eo{background:#1A8917}.ep{border-color:#1A8917}.et:disabled{cursor:inherit !important}.eu:disabled{opacity:0.3}.ev:disabled:hover{background:#1A8917}.ew:disabled:hover{border-color:#1A8917}.ex{border-radius:99em}.ey{border-width:1px}.ez{border-style:solid}.fa{box-sizing:border-box}.fb{text-decoration:none}.fc{text-align:center}.ff{margin-right:32px}.fg{position:relative}.fh{fill:#6B6B6B}.fk{background:transparent}.fl svg{margin-left:4px}.fm svg{fill:#6B6B6B}.fo{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fp{position:absolute}.fw{margin:0 24px}.ga{background:rgba(255, 255, 255, 1)}.gb{border:1px solid #F2F2F2}.gc{box-shadow:0 1px 4px #F2F2F2}.gd{max-height:100vh}.ge{overflow-y:auto}.gf{left:0}.gg{top:calc(100vh + 100px)}.gh{bottom:calc(100vh + 100px)}.gi{width:10px}.gj{pointer-events:none}.gk{word-break:break-word}.gl{word-wrap:break-word}.gm:after{display:block}.gn:after{content:""}.go:after{clear:both}.gp{line-height:1.23}.gq{letter-spacing:0}.gr{font-style:normal}.gs{font-weight:700}.hs{@media all and (max-width: 551.98px):8px}.ht{@media all and (min-width: 552px) and (max-width: 727.98px):8px}.hu{@media all and (min-width: 728px) and (max-width: 903.98px):16px}.hv{@media all and (min-width: 904px) and (max-width: 1079.98px):16px}.hw{@media all and (min-width: 1080px):16px}.ic{align-items:baseline}.id{width:48px}.ie{height:48px}.if{border:2px solid rgba(255, 255, 255, 1)}.ig{z-index:0}.ih{box-shadow:none}.ii{border:1px solid rgba(0, 0, 0, 0.05)}.ij{margin-bottom:2px}.ik{flex-wrap:nowrap}.il{font-size:16px}.im{line-height:24px}.io{margin:0 8px}.ip{display:inline}.iq{color:#1A8917}.ir{fill:#1A8917}.iu{flex:0 0 auto}.ix{flex-wrap:wrap}.iy{padding-left:8px}.iz{padding-right:8px}.ka> *{flex-shrink:0}.kb{overflow-x:scroll}.kc::-webkit-scrollbar{display:none}.kd{scrollbar-width:none}.ke{-ms-overflow-style:none}.kf{width:74px}.kg{flex-direction:row}.kh{z-index:2}.ki{margin-right:4px}.kl{-webkit-user-select:none}.km{border:0}.kn{fill:rgba(117, 117, 117, 1)}.kq{outline:0}.kr{user-select:none}.ks> svg{pointer-events:none}.lb{cursor:progress}.lc{opacity:1}.ld{padding:4px 0}.lg{margin-top:0px}.lh{width:16px}.lj{display:inline-flex}.lp{max-width:100%}.lq{padding:8px 2px}.lr svg{color:#6B6B6B}.mi{line-height:1.58}.mj{letter-spacing:-0.004em}.mk{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.nf{margin-bottom:-0.46em}.ng{clear:left}.nh{float:left}.ni{font-size:66px}.nj{line-height:.83}.np{text-decoration:underline}.nq{line-height:1.18}.nr{letter-spacing:-0.022em}.ns{font-weight:600}.oi{margin-bottom:-0.31em}.oo{margin-left:auto}.op{margin-right:auto}.oq{max-width:1920px}.ow{clear:both}.oy{cursor:zoom-in}.oz{z-index:auto}.pb{height:auto}.pc{margin-top:10px}.pd{max-width:728px}.pg{max-width:601px}.ph{max-width:550px}.pi{max-width:480px}.pj{max-width:600px}.pk{max-width:558px}.pl{max-width:514px}.pm{max-width:297px}.pn{max-width:432px}.po{max-width:602px}.pp{box-shadow:inset 3px 0 0 0 #242424}.pq{padding-left:23px}.pr{margin-left:-20px}.ps{font-style:italic}.pt{margin-bottom:26px}.pu{margin-top:6px}.pv{margin-top:8px}.pw{margin-right:8px}.px{padding:8px 16px}.py{border-radius:100px}.pz{transition:background 300ms ease}.qb{white-space:nowrap}.qc{border-top:none}.qi{height:52px}.qj{max-height:52px}.qk{box-sizing:content-box}.ql{position:static}.qm{z-index:1}.qo{max-width:155px}.qu{margin-right:20px}.ra{align-items:flex-end}.rb{width:76px}.rc{height:76px}.rd{border:2px solid #F9F9F9}.re{height:72px}.rf{width:72px}.rg{width:auto}.rh{stroke:#F2F2F2}.ri{height:36px}.rj{width:36px}.rk{color:#F2F2F2}.rl{fill:#F2F2F2}.rm{background:#F2F2F2}.rn{border-color:#F2F2F2}.rt{font-weight:500}.ru{font-size:24px}.rv{line-height:30px}.rw{letter-spacing:-0.016em}.rx{margin-top:16px}.ry{height:0px}.rz{border-bottom:solid 1px #E5E5E5}.sf{margin-top:72px}.sg{padding:24px 0}.sh{margin-bottom:0px}.si{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.eq:hover{background:#156D12}.er:hover{border-color:#156D12}.es:hover{cursor:pointer}.fi:hover{color:#242424}.fj:hover{fill:#242424}.fn:hover svg{fill:#242424}.fq:hover{background-color:rgba(0, 0, 0, 0.1)}.in:hover{text-decoration:underline}.is:hover:not(:disabled){color:#156D12}.it:hover:not(:disabled){fill:#156D12}.kp:hover{fill:rgba(8, 8, 8, 1)}.le:hover{fill:#000000}.lf:hover p{color:#000000}.li:hover{color:#000000}.ls:hover svg{color:#000000}.qa:hover{background-color:#F2F2F2}.ro:hover{background:#F2F2F2}.rp:hover{border-color:#F2F2F2}.rq:hover{cursor:wait}.rr:hover{color:#F2F2F2}.rs:hover{fill:#F2F2F2}.ba:focus-within path{fill:#242424}.ko:focus{fill:rgba(8, 8, 8, 1)}.lt:focus svg{color:#000000}.pa:focus{transform:scale(1.01)}.kt:active{border-style:none}</style><style type="text/css" data-fela-rehydration="502" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bt{width:64px}.cd{margin:0 64px}.cs{height:48px}.cz{margin-bottom:52px}.dl{margin-bottom:48px}.ec{font-size:14px}.ed{line-height:20px}.ej{font-size:13px}.ek{padding:5px 12px}.fe{display:flex}.fv{margin-bottom:68px}.fz{max-width:680px}.hn{font-size:42px}.ho{margin-top:1.19em}.hp{margin-bottom:32px}.hq{line-height:52px}.hr{letter-spacing:-0.011em}.ib{align-items:center}.jm{border-top:solid 1px #F2F2F2}.jn{border-bottom:solid 1px #F2F2F2}.jo{margin:32px 0 0}.jp{padding:3px 8px}.jy> *{margin-right:24px}.jz> :last-child{margin-right:0}.la{margin-top:0px}.lo{margin:0}.nb{font-size:20px}.nc{margin-top:2.14em}.nd{line-height:32px}.ne{letter-spacing:-0.003em}.no{padding-top:7px}.of{margin-top:1.72em}.og{line-height:24px}.oh{letter-spacing:0}.on{margin-top:0.94em}.ov{margin-top:56px}.qh{margin-bottom:88px}.qt{display:inline-block}.qz{padding-top:72px}.se{margin-top:40px}</style><style type="text/css" data-fela-rehydration="502" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.kz{margin-top:0px}.pe{margin-left:auto}.pf{text-align:center}.qs{display:inline-block}</style><style type="text/css" data-fela-rehydration="502" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.ky{margin-top:0px}.qr{display:inline-block}</style><style type="text/css" data-fela-rehydration="502" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.kw{margin-top:0px}.kx{margin-right:0px}.qq{display:inline-block}</style><style type="text/css" data-fela-rehydration="502" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bp{width:24px}.bz{margin:0 24px}.co{height:40px}.cv{margin-bottom:44px}.dh{margin-bottom:32px}.du{font-size:13px}.dv{line-height:20px}.ee{padding:0px 8px 1px}.fr{margin-bottom:4px}.gt{font-size:32px}.gu{margin-top:1.01em}.gv{margin-bottom:24px}.gw{line-height:38px}.gx{letter-spacing:-0.014em}.hx{align-items:flex-start}.iv{flex-direction:column}.ja{margin:24px -24px 0}.jb{padding:0}.jq> *{margin-right:8px}.jr> :last-child{margin-right:24px}.kj{margin-left:0px}.ku{margin-top:0px}.kv{margin-right:0px}.lk{margin:0}.lu{border:1px solid #F2F2F2}.lv{border-radius:99em}.lw{padding:0px 16px 0px 12px}.lx{height:38px}.ly{align-items:center}.ma svg{margin-right:8px}.ml{font-size:18px}.mm{margin-top:1.56em}.mn{line-height:28px}.mo{letter-spacing:-0.003em}.nk{padding-top:0}.nt{font-size:16px}.nu{margin-top:1.23em}.nv{letter-spacing:0}.oj{margin-top:0.67em}.or{margin-top:40px}.qd{margin-bottom:80px}.qp{display:inline-block}.qv{padding-top:48px}.sa{margin-top:32px}.lz:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="502" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bs{width:64px}.cc{margin:0 64px}.cr{height:48px}.cy{margin-bottom:52px}.dk{margin-bottom:48px}.ea{font-size:14px}.eb{line-height:20px}.eh{font-size:13px}.ei{padding:5px 12px}.fd{display:flex}.fu{margin-bottom:68px}.fy{max-width:680px}.hi{font-size:42px}.hj{margin-top:1.19em}.hk{margin-bottom:32px}.hl{line-height:52px}.hm{letter-spacing:-0.011em}.ia{align-items:center}.ji{border-top:solid 1px #F2F2F2}.jj{border-bottom:solid 1px #F2F2F2}.jk{margin:32px 0 0}.jl{padding:3px 8px}.jw> *{margin-right:24px}.jx> :last-child{margin-right:0}.ln{margin:0}.mx{font-size:20px}.my{margin-top:2.14em}.mz{line-height:32px}.na{letter-spacing:-0.003em}.nn{padding-top:7px}.oc{margin-top:1.72em}.od{line-height:24px}.oe{letter-spacing:0}.om{margin-top:0.94em}.ou{margin-top:56px}.qg{margin-bottom:88px}.qy{padding-top:72px}.sd{margin-top:40px}</style><style type="text/css" data-fela-rehydration="502" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.br{width:64px}.cb{margin:0 48px}.cq{height:48px}.cx{margin-bottom:52px}.dj{margin-bottom:48px}.dy{font-size:13px}.dz{line-height:20px}.eg{padding:0px 8px 1px}.ft{margin-bottom:68px}.fx{max-width:680px}.hd{font-size:42px}.he{margin-top:1.19em}.hf{margin-bottom:32px}.hg{line-height:52px}.hh{letter-spacing:-0.011em}.hz{align-items:center}.je{border-top:solid 1px #F2F2F2}.jf{border-bottom:solid 1px #F2F2F2}.jg{margin:32px 0 0}.jh{padding:3px 8px}.ju> *{margin-right:24px}.jv> :last-child{margin-right:0}.lm{margin:0}.mt{font-size:20px}.mu{margin-top:2.14em}.mv{line-height:32px}.mw{letter-spacing:-0.003em}.nm{padding-top:7px}.nz{margin-top:1.72em}.oa{line-height:24px}.ob{letter-spacing:0}.ol{margin-top:0.94em}.ot{margin-top:56px}.qf{margin-bottom:88px}.qx{padding-top:72px}.sc{margin-top:40px}</style><style type="text/css" data-fela-rehydration="502" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bq{width:24px}.ca{margin:0 24px}.cp{height:40px}.cw{margin-bottom:44px}.di{margin-bottom:32px}.dw{font-size:13px}.dx{line-height:20px}.ef{padding:0px 8px 1px}.fs{margin-bottom:4px}.gy{font-size:32px}.gz{margin-top:1.01em}.ha{margin-bottom:24px}.hb{line-height:38px}.hc{letter-spacing:-0.014em}.hy{align-items:flex-start}.iw{flex-direction:column}.jc{margin:24px 0 0}.jd{padding:0}.js> *{margin-right:8px}.jt> :last-child{margin-right:8px}.kk{margin-left:0px}.ll{margin:0}.mb{border:1px solid #F2F2F2}.mc{border-radius:99em}.md{padding:0px 16px 0px 12px}.me{height:38px}.mf{align-items:center}.mh svg{margin-right:8px}.mp{font-size:18px}.mq{margin-top:1.56em}.mr{line-height:28px}.ms{letter-spacing:-0.003em}.nl{padding-top:0}.nw{font-size:16px}.nx{margin-top:1.23em}.ny{letter-spacing:0}.ok{margin-top:0.67em}.os{margin-top:40px}.qe{margin-bottom:80px}.qw{padding-top:48px}.sb{margin-top:32px}.mg:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="502" data-fela-type="RULE" media="print">.qn{display:none}</style><style type="text/css" data-fela-rehydration="502" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.ox{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style><script type="text/javascript" async="" src="https://www.gstatic.com/recaptcha/releases/TqxSU0dsOd2Q9IbI7CpFnJLD/recaptcha__pl.js" crossorigin="anonymous" integrity="sha384-EtuwsrUt4o3rjKbOIgbMlrdETicyC7YJiOMF4S2kRPR2c6EcUDPrB1OFkiSEO3IC"></script><script async="" src="https://cdn.branch.io/branch-latest.min.js"></script><script type="application/ld+json" data-rh="true">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*B6zCphcdYAGGUKEulQe0uQ.png"],"url":"https:\u002F\u002Fimphash.medium.com\u002Fwindows-process-internals-a-few-concepts-to-know-before-jumping-on-memory-forensics-part-5-a-2368187685e","dateCreated":"2020-09-13T02:02:53.444Z","datePublished":"2020-09-13T02:02:53.444Z","dateModified":"2021-12-15T23:01:24.884Z","headline":"Windows Process Internals: A few Concepts to know before jumping on Memory Forensics [Part 5] — A Journey in to the Undocumented Process Handle Structures","name":"Windows Process Internals: A few Concepts to know before jumping on Memory Forensics [Part 5] — A Journey in to the Undocumented Process Handle Structures","description":"In this series of articles of “Must know Process Internals for Memory Forensics” — we have traversed through ActiveProcessLinks (doubly-linked list) of EPROCESS in Part-1 to understand how memory…","identifier":"2368187685e","author":{"@type":"Person","name":"imp hash","url":"https:\u002F\u002Fimphash.medium.com"},"creator":["imp hash"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fimphash.medium.com\u002F","logo":{"@type":"ImageObject","width":308,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:385\u002F1*OMF3fSqH8t4xBJ9-6oZDZw.png"}},"mainEntityOfPage":"https:\u002F\u002Fimphash.medium.com\u002Fwindows-process-internals-a-few-concepts-to-know-before-jumping-on-memory-forensics-part-5-a-2368187685e"}</script><script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-7JY7T788PK" data-rh="true"></script><script data-rh="true">window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'G-7JY7T788PK');</script><script type="text/javascript" data-rh="true">(function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src="https://cdn.branch.io/branch-latest.min.js";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,"script","branch",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},"addListener applyCode autoAppIndex banner closeBanner closeJourney creditHistory credits data deepview deepviewCta first getCode init link logout redeem referrals removeListener sendSMS setBranchViewData setIdentity track validateCode trackCommerceEvent logEvent".split(" "), 0);
branch.init('key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm', {metadata: {}, 'no_journeys': true, 'disable_exit_animation': true, 'disable_entry_animation': true, 'tracking_disabled': null}, function(err, data) {});</script><script src="https://www.google.com/recaptcha/enterprise.js?render=6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp" data-rh="true"></script></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div><script>if (window.self !== window.top) window.location = "about:blank"</script></div><div class="l c"><div class="l m n o c" style="transform: translateY(0px);"><div class="p q r s t u v w x i d y z"><a class="dr ag ds bc ak b am an ao ap aq ar as at s u w i d q dt z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2368187685e&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderUser&amp;source=---two_column_layout_nav----------------------------------" rel="noopener follow">Open in app<svg width="10" height="10" viewBox="0 0 10 10" fill="none" class="dq"><path d="M.98 8.48a.37.37 0 1 0 .54.54l-.54-.54zm7.77-7.23h.38c0-.2-.17-.38-.38-.38v.38zM8.37 6.5a.37.37 0 1 0 .76 0h-.76zM3.5.87a.37.37 0 1 0 0 .76V.88zM1.52 9.03l7.5-7.5-.54-.54-7.5 7.5.54.54zm6.86-7.77V6.5h.74V1.25h-.74zm-4.88.38h5.25V.88H3.5v.74z" fill="currentColor"></path></svg></a><div class="ab q"><p class="bc b du dv dw dx dy dz ea eb ec ed dr"><span><button class="bc b du dv ee dw dx ef dy dz eg eh eb ei ej ed ek el em eo ep eq er es et eu ev ew ex ey ez fa bj fb fc" data-testid="headerSignUpButton">Sign up</button></span></p><div class="au l"><p class="bc b du dv dw dx dy dz ea eb ec ed dr"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fimphash.medium.com%2Fwindows-process-internals-a-few-concepts-to-know-before-jumping-on-memory-forensics-part-5-a-2368187685e&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=---two_column_layout_nav----------------------------------" rel="noopener follow"><svg width="120" height="27" viewBox="0 0 120 27" fill="none"><mask id="logo-wordmark-pride_svg__a" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="1" y="0" width="119" height="27"><path d="M29.69 2.36h.03v-.29h-7.26L15.7 18.05 8.96 2.07H1.12v.28l.04.01c1.32.3 2 .75 2 2.37v19c0 1.62-.68 2.07-2 2.37h-.04v.29h5.31v-.28H6.4c-1.33-.3-2-.76-2-2.38V5.83l8.67 20.56h.5l8.91-21.13V24.2c-.1 1.28-.78 1.67-1.98 1.95h-.03v.28h9.25v-.27l-.03-.01c-1.2-.28-1.89-.67-2-1.95V4.73c0-1.62.67-2.07 2-2.37zm4.23 12.58c.15-3.41 1.37-5.87 3.4-5.92.64.01 1.17.22 1.58.62.87.86 1.28 2.64 1.22 5.3h-6.2zm-.1.96h10.86v-.04c-.03-2.61-.78-4.64-2.23-6.03a7.3 7.3 0 0 0-5.05-1.87h-.04a7.31 7.31 0 0 0-5.75 2.78 10.4 10.4 0 0 0-2.08 5.72l-.02.2a7.61 7.61 0 0 0-.02.56v.58c.11 5.09 2.84 9.16 7.69 9.16 4.25 0 6.73-3.14 7.35-7.34l-.32-.11c-1.08 2.26-3.03 3.63-5.25 3.46-3.03-.23-5.35-3.32-5.13-7.06m23.12 6.89c-.36.85-1.1 1.32-2.1 1.32s-1.9-.7-2.55-1.94a12.23 12.23 0 0 1-1.06-5.49c0-4.68 1.45-7.7 3.68-7.7.94 0 1.68.47 2.03 1.28V22.8zm7.2 3.33c-1.33-.31-2-.78-2-2.49V.96l-8.07 2.39v.3l.05-.01c1.11-.1 1.87.06 2.3.47.35.32.52.8.52 1.5v3.1a5.18 5.18 0 0 0-2.89-.75c-2.33 0-4.45.98-5.99 2.78-1.6 1.86-2.44 4.42-2.44 7.38 0 5.28 2.58 8.84 6.43 8.84a5.09 5.09 0 0 0 4.89-3.34v2.81h7.23v-.29h-.03zm6.9-22.09c0-1.65-1.23-2.9-2.87-2.9a2.87 2.87 0 0 0-2.9 2.9c0 1.63 1.27 2.9 2.9 2.9a2.82 2.82 0 0 0 2.88-2.9zm1.91 22.1c-1.32-.32-2-.8-2-2.5V8.01l-7.24 2.1v.28h.05c1.56.14 1.99.68 1.99 2.53v13.51H73v-.29h-.04zm18.54 0c-1.33-.32-2-.8-2-2.5V8.01l-6.89 2.02v.29h.04c1.28.14 1.65.71 1.65 2.56v9.88a2.48 2.48 0 0 1-2.2 1.4c-1.57 0-2.43-1.08-2.43-3.02V8.01l-7.24 2.1v.28h.04c1.57.14 2 .68 2 2.53v8.36c0 .58.05 1.16.15 1.74l.13.57c.61 2.21 2.22 3.37 4.73 3.37 2.13 0 4-1.33 4.82-3.4v2.88h7.23v-.3h-.03zm28.1.3v-.3h-.03c-1.44-.34-2-.97-2-2.26V13.25c0-3.31-1.85-5.3-4.95-5.3a5.08 5.08 0 0 0-4.9 3.37c-.58-2.17-2.25-3.36-4.73-3.36a4.7 4.7 0 0 0-4.61 3.1V8.02l-7.23 2v.3h.04c1.55.14 2 .7 2 2.49v13.63h6.74v-.29h-.03c-1.15-.28-1.52-.78-1.52-2.05V11.9c.3-.71.91-1.56 2.13-1.56 1.5 0 2.26 1.05 2.26 3.12v12.97h6.75v-.29h-.03c-1.15-.28-1.52-.78-1.52-2.05V13.25a7 7 0 0 0-.1-1.21c.32-.78.97-1.7 2.23-1.7 1.53 0 2.27 1.02 2.27 3.12v12.97h7.23z" fill="#242424"></path></mask><g filter="url(#logo-wordmark-pride_svg__filter0_f_238_6555)" mask="url(#logo-wordmark-pride_svg__a)"><path d="M42.3-64.7l-15.52-6.74L-24.62 47l15.53 6.74L42.3-64.7z" fill="#000"></path><path d="M53.18-59.98L42.3-64.7-9.1 53.74l10.88 4.72 51.4-118.44z" fill="#603917"></path><path d="M64.96-54.87l-11.78-5.11L1.78 58.46l11.79 5.11 51.4-118.44z" fill="#71E2FD"></path><path d="M75.84-50.15l-10.88-4.72-51.4 118.44 10.89 4.72L75.84-50.15z" fill="#FF9BC9"></path><path d="M86.71-45.43l-10.87-4.72L24.44 68.3l10.88 4.72 51.4-118.44z" fill="#FF472F"></path><path d="M97.6-40.7L86.7-45.44 35.32 73.01l10.88 4.72L97.6-40.7z" fill="#FF8312"></path><path d="M108.47-35.99L97.6-40.7 46.2 77.73l10.88 4.72 51.4-118.44z" fill="#FFCE00"></path><path d="M120.25-30.88l-11.78-5.1-51.4 118.43 11.79 5.11 51.4-118.44z" fill="#48E348"></path><path d="M131.13-26.16l-10.88-4.72L68.86 87.56l10.88 4.72 51.4-118.44z" fill="#008EF0"></path><path d="M148.48-18.63l-17.35-7.53-51.4 118.44 17.35 7.53 51.4-118.44z" fill="#9A50FC"></path></g><defs><filter id="logo-wordmark-pride_svg__filter0_f_238_6555" x="-29.5" y="-76.33" width="182.87" height="181.03" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood><feBlend in="SourceGraphic" in2="BackgroundImageFix" result="shape"></feBlend><feGaussianBlur stdDeviation="2.45" result="effect1_foregroundBlur_238_6555"></feGaussianBlur></filter></defs></svg></a><div class="au h"><div class="ab av aw ax ay q az ba"><div class="bj" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bk bl ab"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.1 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0zm6.94-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .8-.79l-3.74-3.73A8.05 8.05 0 0 0 11.04 3v.01z" fill="currentColor"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="av bb bc bd z be bf bg bh bi" placeholder="Search" value=""></div></div></div><div class="h k w fd fe"><div class="ff ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---two_column_layout_nav-----------------------new_post_topnav-----------" rel="noopener follow"><div class="bc b bd z dr fg fh ab q fi fj"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-label="Write"><path d="M14 4a.5.5 0 0 0 0-1v1zm7 6a.5.5 0 0 0-1 0h1zm-7-7H4v1h10V3zM3 4v16h1V4H3zm1 17h16v-1H4v1zm17-1V10h-1v10h1zm-1 1a1 1 0 0 0 1-1h-1v1zM3 20a1 1 0 0 0 1 1v-1H3zM4 3a1 1 0 0 0-1 1h1V3z" fill="currentColor"></path><path d="M17.5 4.5l-8.46 8.46a.25.25 0 0 0-.06.1l-.82 2.47c-.07.2.12.38.31.31l2.47-.82a.25.25 0 0 0 .1-.06L19.5 6.5m-2-2l2.32-2.32c.1-.1.26-.1.36 0l1.64 1.64c.1.1.1.26 0 .36L19.5 6.5m-2-2l2 2" stroke="currentColor"></path></svg><div class="dq l">Write</div></div></a></span></div></div><div class="k j i d"><div class="ff ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" href="https://medium.com/search?source=---two_column_layout_nav----------------------------------" rel="noopener follow"><div class="bc b bd z dr fg fh ab q fi fj"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-label="Search"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.1 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0zm6.94-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .8-.79l-3.74-3.73A8.05 8.05 0 0 0 11.04 3v.01z" fill="currentColor"></path></svg></div></a></div></div><div class="ff h k j"><div class="ab q"><p class="bc b du dv dw dx dy dz ea eb ec ed dr"><span><button class="bc b du dv ee dw dx ef dy dz eg eh eb ei ej ed ek el em eo ep eq er es et eu ev ew ex ey ez fa bj fb fc" data-testid="headerSignUpButton">Sign up</button></span></p><div class="au l"><p class="bc b du dv dw dx dy dz ea eb ec ed dr"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fimphash.medium.com%2Fwindows-process-internals-a-few-concepts-to-know-before-jumping-on-memory-forensics-part-5-a-2368187685e&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="av fk am ab q ao fl fm fn" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fg"><img alt="" class="l fa bv bw bx cu" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"><div class="fo bv l bw bx fp n av fq"></div></div></button></div></div></div><div class="l"><div class="qn" role="dialog" aria-modal="true" tabindex="-1"><div class="vr vs be dt su vt sq ao vu gj vv" aria-hidden="true" role="presentation"></div><div class="vw su vx vy vz vr dt fa wa wb wc lc wd we sv wf wg wh wi wj wk" aria-hidden="true"></div></div><div class="fr fs ft fu fv l"><div class="ab by"><div class="cf be fw fx fy fz"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fp gf gg gh gi gj"></div><div class="gk gl gm gn go"><div class="ab by"><div class="cf be fw fx fy fz"><div><h1 id="42d3" class="pw-post-title gp gq gr bc gs gt gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr bh" data-testid="storyTitle" data-selectable-paragraph=""><strong class="al">Windows Process Internals: A few Concepts to know before jumping on Memory Forensics [Part 5] — A Journey in to the Undocumented Process Handle Structures</strong></h1><div class="hs ht hu hv hw"><div class="speechify-ignore ab cm"><div class="speechify-ignore be l"><div class="hx hy hz ia ib ab"><div><div class="ab ic"><a rel="noopener follow" href="/?source=post_page-----2368187685e--------------------------------"><div><div class="bj" aria-hidden="false" aria-describedby="1" aria-labelledby="1"><div class="l id ie bv if ig"><div class="l fg"><img alt="imp hash" class="l fa bv da db cu" src="https://miro.medium.com/v2/resize:fill:88:88/0*PFkpquOFwCFuo6RL.jpg" width="44" height="44" loading="lazy" data-testid="authorPhoto"><div class="ih bv l da db fp n ii fq"></div></div></div></div></div></a></div></div><div class="bk be l"><div class="ab"><div style="flex:1"><span class="bc b bd z bh"><div class="ij ab q"><div class="ab q ik"><div class="ab q"><div><div class="bj" aria-hidden="false" aria-describedby="2" aria-labelledby="2"><p class="bc b il im bh"><a class="af ag ah ai aj ak al am an ao ap aq ar in" data-testid="authorName" rel="noopener follow" href="/?source=post_page-----2368187685e--------------------------------">imp hash</a></p></div></div></div><span class="io ip" aria-hidden="true"><span class="bc b bd z dr">·</span></span><p class="bc b il im dr"><span><a class="iq ir ah ai aj ak al am an ao ap aq ar eu is it" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc23376f92e3f&amp;operation=register&amp;redirect=https%3A%2F%2Fimphash.medium.com%2Fwindows-process-internals-a-few-concepts-to-know-before-jumping-on-memory-forensics-part-5-a-2368187685e&amp;user=imp+hash&amp;userId=c23376f92e3f&amp;source=post_page-c23376f92e3f----2368187685e---------------------post_header-----------" rel="noopener follow">Follow</a></span></p></div></div></span></div></div><div class="l iu"><span class="bc b bd z dr"><div class="ab ck iv iw ix"><span class="bc b bd z dr"><div class="ab ae"><span data-testid="storyReadTime">7 min read</span><div class="iy iz l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bc b bd z dr">·</span></span></div><span data-testid="storyPublishDate">Sep 13, 2020</span></div></span></div></span></div></div></div><div class="ab cm ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp"><div class="h k w fd fe q"><div class="kf l"><div class="ab q kg kh"><div class="pw-multi-vote-icon fg ki kj kk kl"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F2368187685e&amp;operation=register&amp;redirect=https%3A%2F%2Fimphash.medium.com%2Fwindows-process-internals-a-few-concepts-to-know-before-jumping-on-memory-forensics-part-5-a-2368187685e&amp;user=imp+hash&amp;userId=c23376f92e3f&amp;source=-----2368187685e---------------------clap_footer-----------" rel="noopener follow"><div><div class="bj" aria-hidden="false" aria-describedby="3" aria-labelledby="3"><div class="km ao kn ko kp kq am kr ks kt kl"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ku kv kw kx ky kz la"><div><div class="bj" aria-hidden="false" aria-describedby="74" aria-labelledby="74"><p class="bc b ds z dr"><button class="af ag ah ai aj ak al am an ao ap aq ar as at xq li">2<span class="l h g f qs qt"></span></button></p></div></div></div></div></div><div><div class="bj" aria-hidden="false" aria-describedby="4" aria-labelledby="4"><button class="ao km lc ld ab q fh le lf" aria-label="responses"><svg width="24" height="24" viewBox="0 0 24 24" class="lg"><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></button></div></div></div><div class="ab q jq jr js jt ju jv jw jx jy jz ka kb kc kd ke"><div class="lh k j i d"></div><div class="h k"><div><div class="bj" aria-hidden="false" aria-describedby="5" aria-labelledby="5"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2368187685e&amp;operation=register&amp;redirect=https%3A%2F%2Fimphash.medium.com%2Fwindows-process-internals-a-few-concepts-to-know-before-jumping-on-memory-forensics-part-5-a-2368187685e&amp;source=-----2368187685e---------------------bookmark_footer-----------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dr li" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div><div class="fa lj ck"><div class="l ae"><div class="ab by"><div class="lk ll lm ln lo lp cf be"><div class="ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2Fplans%3Fdimension%3Dpost_audio_button%26postId%3D2368187685e&amp;operation=register&amp;redirect=https%3A%2F%2Fimphash.medium.com%2Fwindows-process-internals-a-few-concepts-to-know-before-jumping-on-memory-forensics-part-5-a-2368187685e&amp;source=-----2368187685e---------------------post_audio_button-----------" rel="noopener follow"><div><div class="bj" aria-hidden="false" aria-describedby="62" aria-labelledby="62"><button aria-label="Listen" data-testid="audioPlayButton" class="af fh ah ai aj ak al lq an ao ap eu lr ls lf lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0zm9-10a10 10 0 1 0 0 20 10 10 0 0 0 0-20zm3.38 10.42l-4.6 3.06a.5.5 0 0 1-.78-.41V8.93c0-.4.45-.63.78-.41l4.6 3.06c.3.2.3.64 0 .84z" fill="currentColor"></path></svg><div class="j i d"><p class="bc b bd z dr">Listen</p></div></button></div></div></a></span></div></div></div></div></div><div class="bj" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bj" aria-hidden="false" aria-describedby="7" aria-labelledby="7"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fh ah ai aj ak al lq an ao ap eu lr ls lf lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.22 4.93a.42.42 0 0 1-.12.13h.01a.45.45 0 0 1-.29.08.52.52 0 0 1-.3-.13L12.5 3v7.07a.5.5 0 0 1-.5.5.5.5 0 0 1-.5-.5V3.02l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.8a.42.42 0 0 1 .07.5zm-.1.14zm.88 2h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11a2 2 0 0 1-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.14c.1.1.15.22.15.35a.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9V8.96c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1z" fill="currentColor"></path></svg><div class="j i d"><p class="bc b bd z dr">Share</p></div></button></div></div></div></div></div></div></div></div></div><p id="9de5" class="pw-post-body-paragraph mi mj gr mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh ng" data-selectable-paragraph=""><span class="l nh ni nj bl nk nl nm nn no fg">In</span> this series of articles of “Must know Process Internals for Memory Forensics” — we have traversed through ActiveProcessLinks (doubly-linked list) of EPROCESS in <a class="af np" href="https://eforensicsmag.com/windows-process-internals-a-few-concepts-to-know-before-jumping-on-memory-forensics-by-kirtar-oza/" rel="noopener ugc nofollow" target="_blank">Part-1</a> to understand how memory manager keeps track of active processes on the system.</p><p id="bfbd" class="pw-post-body-paragraph mi mj gr mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh" data-selectable-paragraph=""><a class="af np" href="https://eforensicsmag.com/windows-process-internals-a-few-concepts-to-know-before-jumping-on-memory-forensics-part-2-ldrmodules-by-kirtar-oza/" rel="noopener ugc nofollow" target="_blank">In Part-2</a>, we have explored and traversed through Ldrmodules of _PEB structure that gave us insights how memory manager keeps track of all the loaded Dynamic Link Libraries (dlls) by a specific process.</p><p id="d1f3" class="pw-post-body-paragraph mi mj gr mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh" data-selectable-paragraph=""><a class="af np" href="https://eforensicsmag.com/windows-process-internals-a-few-concepts-to-know-before-jumping-on-memory-forensics-part-3-journey-in-to-the-psloadedmodulelist-loaded-kernel-modules-by-kirtar-oza/" rel="noopener ugc nofollow" target="_blank">In Part-3</a>, we discussed about how system tracks loaded kernel modules by traversing and exploring nt!PsLoadedModuleList.</p><p id="a94f" class="pw-post-body-paragraph mi mj gr mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh" data-selectable-paragraph="">In the latest part, <a class="af np" href="https://eforensicsmag.com/85384-2/" rel="noopener ugc nofollow" target="_blank">Part-4</a>, we saw the details of Virtual Address Descriptors (VADs) and identified the details buried in to the VAD nodes.</p><p id="99bb" class="pw-post-body-paragraph mi mj gr mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh" data-selectable-paragraph="">This article would be <strong class="mk gs">Part-5</strong> of the series and this would, most probably, be the last article (for now) of the series. In this Part-5, we will explore the kernel structures associated with Process Handles and how OS stores handle information for each process in the memory. The kernel structures related to handles have gone through a frequent change during each major version upgrade of the operating system. Windows 7, Windows 8, Windows 8.1 and now latest Windows 10 — all of these have different handle structures and a unique way to reference or to keep track of the handles in to the memory. I would say, Microsoft is introducing more and more complexity as they evolve hence from the forensics perspective, it has become harder to reverse these undocumented complex structures.</p><p id="4922" class="pw-post-body-paragraph mi mj gr mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh" data-selectable-paragraph="">In this article, we will explore the kernel handle structures of Windows 10 (build 18362) via live kernel debugging. We will start with EPROCESS structure of one process and will follow through the cues provided by the handle kernel structures to reach to the actual Object and Object type that has been referred by a specific handle. Let us start the journey in to the kernel handle structures!!</p><h2 id="8e6a" class="nq nr gr bc ns nt nu dv nv nw nx dx ny mt nz oa ob mx oc od oe nb of og oh oi bh" data-selectable-paragraph=""><strong class="al">What is a Handle, anyway?</strong></h2><p id="52f4" class="pw-post-body-paragraph mi mj gr mk b ml oj mn mo mp ok mr ms mt ol mv mw mx om mz na nb on nd ne nf gk bh" data-selectable-paragraph="">If a process needs an access to any object such as a file, registry key, mutex, process, thread etc., it needs to get a hold of its handle first. Then the process can use this handle to get an access to the object referenced by this handle. The handle is a reference to a kernel structure that holds an information about the object that the handle refers to.</p><p id="6fc1" class="pw-post-body-paragraph mi mj gr mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh" data-selectable-paragraph="">We will decode this jargon in the following sections. You may like to re-read this information after reading the entire article.</p><h2 id="4612" class="nq nr gr bc ns nt nu dv nv nw nx dx ny mt nz oa ob mx oc od oe nb of og oh oi bh" data-selectable-paragraph=""><strong class="al">How Memory Manager keeps track of Process Objects &amp; Handles?</strong></h2><p id="b10c" class="pw-post-body-paragraph mi mj gr mk b ml oj mn mo mp ok mr ms mt ol mv mw mx om mz na nb on nd ne nf gk bh" data-selectable-paragraph="">Each process has a executive object structure called EPROCESS in the kernel memory. This EPROCESS structure has a field named “ObjectTable”. This ObjectTable is a _handle_table structure.</p><p id="977e" class="pw-post-body-paragraph mi mj gr mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh" data-selectable-paragraph="">This structure has a field named “TableCode”. TableCode provides the reference to the base of the handle table entries (_handle_table_entries). You can see in the diagram below that there are indexes (0x04,0x08,0x0c and so on) are written to the adjacent to each handle_table_entry. When we say that process has got an access to the handle of an object — that essentially means that the process knows which index (represented by a handle) to go to in the handle_table_entries retrieve the pointer to the object that it needs an access to. Therefore, handle is nothing but the index in to this handle_table_entry. A process uses this index/handle to retrieve the information about the object that entry points to.</p><p id="f4ba" class="pw-post-body-paragraph mi mj gr mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh" data-selectable-paragraph="">These entries are of _handle_table_entry structure. This structure contains the field named “ObjectPointerBits” that points to the object_header and we can get the address of the object from object_header.</p><p id="0d75" class="pw-post-body-paragraph mi mj gr mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh" data-selectable-paragraph="">The object_header contains a field named “IndexType” that points to the structure _object_type that gives us an information about the type of the object this header referring to OR in other words, what type of object (like file,mutex, directory, process etc.) structure to expect after the object_header. This is important because handle table entries are mix of all objects that process has open handle to and TypeIndex lets us know about the type of object refereed by a specific handle.</p><p id="d115" class="pw-post-body-paragraph mi mj gr mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh" data-selectable-paragraph="">Please refer to the following diagram that helps us to understand how OS stores information related to process objects and its handles.</p><figure class="or os ot ou ov ow oo op paragraph-image"><div role="button" tabindex="0" class="ox oy fg oz be pa"><div class="oo op oq"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*B6zCphcdYAGGUKEulQe0uQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*B6zCphcdYAGGUKEulQe0uQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*B6zCphcdYAGGUKEulQe0uQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*B6zCphcdYAGGUKEulQe0uQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*B6zCphcdYAGGUKEulQe0uQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*B6zCphcdYAGGUKEulQe0uQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B6zCphcdYAGGUKEulQe0uQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*B6zCphcdYAGGUKEulQe0uQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*B6zCphcdYAGGUKEulQe0uQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*B6zCphcdYAGGUKEulQe0uQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*B6zCphcdYAGGUKEulQe0uQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*B6zCphcdYAGGUKEulQe0uQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*B6zCphcdYAGGUKEulQe0uQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*B6zCphcdYAGGUKEulQe0uQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lp pb c" width="700" height="394" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*B6zCphcdYAGGUKEulQe0uQ.png"></picture></div></div><figcaption class="pc fc pd oo op pe pf bc b bd z dr" data-selectable-paragraph="">Figure 1. Logical view of pointers between various handle structures in memory</figcaption></figure><h2 id="b72e" class="nq nr gr bc ns nt nu dv nv nw nx dx ny mt nz oa ob mx oc od oe nb of og oh oi bh" data-selectable-paragraph=""><strong class="al">Exploring the handle structures through kernel debugging</strong></h2><p id="4c52" class="pw-post-body-paragraph mi mj gr mk b ml oj mn mo mp ok mr ms mt ol mv mw mx om mz na nb on nd ne nf gk bh" data-selectable-paragraph="">Let us review all of these structures discussed above through live kernel debugging.</p><p id="0446" class="pw-post-body-paragraph mi mj gr mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh" data-selectable-paragraph="">First of all, enumerate the active processes &amp; pick any random process for our exploration. I have picked up a process that has its EPROCESS structure at 0xffffa703b3ebc080 address. Now, let us examine its ObjectTable by enumerating EPROECESS. Once, we get the ObjectTable, we can enumerate it and the get the address of the “TableCode” as “TableCode” is one of the fields in the ObjectTable. Please see following snippet for the same.</p><figure class="or os ot ou ov ow oo op paragraph-image"><div class="oo op pg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*sX86GYBEaP8zEZ2yckNHsg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*sX86GYBEaP8zEZ2yckNHsg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*sX86GYBEaP8zEZ2yckNHsg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*sX86GYBEaP8zEZ2yckNHsg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*sX86GYBEaP8zEZ2yckNHsg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*sX86GYBEaP8zEZ2yckNHsg.png 1100w, https://miro.medium.com/v2/resize:fit:1202/format:webp/1*sX86GYBEaP8zEZ2yckNHsg.png 1202w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 601px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*sX86GYBEaP8zEZ2yckNHsg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*sX86GYBEaP8zEZ2yckNHsg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*sX86GYBEaP8zEZ2yckNHsg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*sX86GYBEaP8zEZ2yckNHsg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*sX86GYBEaP8zEZ2yckNHsg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*sX86GYBEaP8zEZ2yckNHsg.png 1100w, https://miro.medium.com/v2/resize:fit:1202/1*sX86GYBEaP8zEZ2yckNHsg.png 1202w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 601px"><img alt="" class="be lp pb c" width="601" height="309" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:751/1*sX86GYBEaP8zEZ2yckNHsg.png"></picture></div><figcaption class="pc fc pd oo op pe pf bc b bd z dr" data-selectable-paragraph="">Figure 2. ObjectTable and TableCode</figcaption></figure><figure class="or os ot ou ov ow oo op paragraph-image"><div class="oo op pg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*thT2833JI_sE0EnYHi8_5w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*thT2833JI_sE0EnYHi8_5w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*thT2833JI_sE0EnYHi8_5w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*thT2833JI_sE0EnYHi8_5w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*thT2833JI_sE0EnYHi8_5w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*thT2833JI_sE0EnYHi8_5w.png 1100w, https://miro.medium.com/v2/resize:fit:1202/format:webp/1*thT2833JI_sE0EnYHi8_5w.png 1202w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 601px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*thT2833JI_sE0EnYHi8_5w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*thT2833JI_sE0EnYHi8_5w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*thT2833JI_sE0EnYHi8_5w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*thT2833JI_sE0EnYHi8_5w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*thT2833JI_sE0EnYHi8_5w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*thT2833JI_sE0EnYHi8_5w.png 1100w, https://miro.medium.com/v2/resize:fit:1202/1*thT2833JI_sE0EnYHi8_5w.png 1202w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 601px"><img alt="" class="be lp pb c" width="601" height="388" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:751/1*thT2833JI_sE0EnYHi8_5w.png"></picture></div><figcaption class="pc fc pd oo op pe pf bc b bd z dr" data-selectable-paragraph="">Figure 3. Mapping of the diagram with a debugger output — ObjectTable &amp; TableCode</figcaption></figure><p id="b0e8" class="pw-post-body-paragraph mi mj gr mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh" data-selectable-paragraph="">Now, let us enumerate what we have got at the TableCode. We expect to get the handle table entries at the address provided by the “TableCode”. We can derive base address of the handle table entries by ANDing the TableCode address with ~0x07.</p><figure class="or os ot ou ov ow oo op paragraph-image"><div class="oo op ph"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*mvyUImgCU5TZpkO82Pifog.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*mvyUImgCU5TZpkO82Pifog.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*mvyUImgCU5TZpkO82Pifog.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*mvyUImgCU5TZpkO82Pifog.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*mvyUImgCU5TZpkO82Pifog.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*mvyUImgCU5TZpkO82Pifog.png 1100w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*mvyUImgCU5TZpkO82Pifog.png 1100w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 550px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*mvyUImgCU5TZpkO82Pifog.png 640w, https://miro.medium.com/v2/resize:fit:720/1*mvyUImgCU5TZpkO82Pifog.png 720w, https://miro.medium.com/v2/resize:fit:750/1*mvyUImgCU5TZpkO82Pifog.png 750w, https://miro.medium.com/v2/resize:fit:786/1*mvyUImgCU5TZpkO82Pifog.png 786w, https://miro.medium.com/v2/resize:fit:828/1*mvyUImgCU5TZpkO82Pifog.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*mvyUImgCU5TZpkO82Pifog.png 1100w, https://miro.medium.com/v2/resize:fit:1100/1*mvyUImgCU5TZpkO82Pifog.png 1100w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 550px"><img alt="" class="be lp pb c" width="550" height="66" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:688/1*mvyUImgCU5TZpkO82Pifog.png"></picture></div><figcaption class="pc fc pd oo op pe pf bc b bd z dr" data-selectable-paragraph="">Figure 4. deriving base address of handle table entries from TableCode</figcaption></figure><p id="400a" class="pw-post-body-paragraph mi mj gr mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh" data-selectable-paragraph="">Please refer following snippets for the same. As expected, we have got the base address followed by handle table entries.</p><figure class="or os ot ou ov ow oo op paragraph-image"><div class="oo op pg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Mc3IGAuwMMTKPKwCaK-_gQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Mc3IGAuwMMTKPKwCaK-_gQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Mc3IGAuwMMTKPKwCaK-_gQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Mc3IGAuwMMTKPKwCaK-_gQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Mc3IGAuwMMTKPKwCaK-_gQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Mc3IGAuwMMTKPKwCaK-_gQ.png 1100w, https://miro.medium.com/v2/resize:fit:1202/format:webp/1*Mc3IGAuwMMTKPKwCaK-_gQ.png 1202w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 601px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*Mc3IGAuwMMTKPKwCaK-_gQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Mc3IGAuwMMTKPKwCaK-_gQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Mc3IGAuwMMTKPKwCaK-_gQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Mc3IGAuwMMTKPKwCaK-_gQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Mc3IGAuwMMTKPKwCaK-_gQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Mc3IGAuwMMTKPKwCaK-_gQ.png 1100w, https://miro.medium.com/v2/resize:fit:1202/1*Mc3IGAuwMMTKPKwCaK-_gQ.png 1202w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 601px"><img alt="" class="be lp pb c" width="601" height="149" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:751/1*Mc3IGAuwMMTKPKwCaK-_gQ.png"></picture></div><figcaption class="pc fc pd oo op pe pf bc b bd z dr" data-selectable-paragraph="">Figure 5. handle table entries starting with the base address derived earlier</figcaption></figure><figure class="or os ot ou ov ow oo op paragraph-image"><div class="oo op pi"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*8AqRQCeuSZ6G0oa1B0AdjQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*8AqRQCeuSZ6G0oa1B0AdjQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*8AqRQCeuSZ6G0oa1B0AdjQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*8AqRQCeuSZ6G0oa1B0AdjQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*8AqRQCeuSZ6G0oa1B0AdjQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*8AqRQCeuSZ6G0oa1B0AdjQ.png 1100w, https://miro.medium.com/v2/resize:fit:960/format:webp/1*8AqRQCeuSZ6G0oa1B0AdjQ.png 960w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 480px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*8AqRQCeuSZ6G0oa1B0AdjQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*8AqRQCeuSZ6G0oa1B0AdjQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*8AqRQCeuSZ6G0oa1B0AdjQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*8AqRQCeuSZ6G0oa1B0AdjQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*8AqRQCeuSZ6G0oa1B0AdjQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*8AqRQCeuSZ6G0oa1B0AdjQ.png 1100w, https://miro.medium.com/v2/resize:fit:960/1*8AqRQCeuSZ6G0oa1B0AdjQ.png 960w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 480px"><img alt="" class="be lp pb c" width="480" height="480" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:600/1*8AqRQCeuSZ6G0oa1B0AdjQ.png"></picture></div><figcaption class="pc fc pd oo op pe pf bc b bd z dr" data-selectable-paragraph="">Figure 6. Mapping of the diagram and a debugger output — handle table entries and indexes</figcaption></figure><p id="78d5" class="pw-post-body-paragraph mi mj gr mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh" data-selectable-paragraph="">We have got the handle table entries now. These are nothing but the handles to the actual object. As mentioned earlier, each handle table entry is of structure type _handle_table_entry. _handle_table_entry has got a field named “ObjectPointerBits” that points to the header of the object that is referred by that handle entry.</p><p id="c0fe" class="pw-post-body-paragraph mi mj gr mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh" data-selectable-paragraph="">Let us take handle table entry at 0x14 index. The address at 0x14 index is 0xffffba8a1e3f1050. Let’s us enumerate this entry to get the pointer to the object.</p><figure class="or os ot ou ov ow oo op paragraph-image"><div class="oo op pg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ySIjDBkze93dW9wKf8uI9g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ySIjDBkze93dW9wKf8uI9g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ySIjDBkze93dW9wKf8uI9g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ySIjDBkze93dW9wKf8uI9g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ySIjDBkze93dW9wKf8uI9g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ySIjDBkze93dW9wKf8uI9g.png 1100w, https://miro.medium.com/v2/resize:fit:1202/format:webp/1*ySIjDBkze93dW9wKf8uI9g.png 1202w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 601px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*ySIjDBkze93dW9wKf8uI9g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ySIjDBkze93dW9wKf8uI9g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ySIjDBkze93dW9wKf8uI9g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ySIjDBkze93dW9wKf8uI9g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ySIjDBkze93dW9wKf8uI9g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ySIjDBkze93dW9wKf8uI9g.png 1100w, https://miro.medium.com/v2/resize:fit:1202/1*ySIjDBkze93dW9wKf8uI9g.png 1202w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 601px"><img alt="" class="be lp pb c" width="601" height="234" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:751/1*ySIjDBkze93dW9wKf8uI9g.png"></picture></div><figcaption class="pc fc pd oo op pe pf bc b bd z dr" data-selectable-paragraph="">Figure 7. Enumerating a handle table entry</figcaption></figure><figure class="or os ot ou ov ow oo op paragraph-image"><div class="oo op pj"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*-9d-keUyz3qRXd_gLlbt9w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*-9d-keUyz3qRXd_gLlbt9w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*-9d-keUyz3qRXd_gLlbt9w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*-9d-keUyz3qRXd_gLlbt9w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*-9d-keUyz3qRXd_gLlbt9w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*-9d-keUyz3qRXd_gLlbt9w.png 1100w, https://miro.medium.com/v2/resize:fit:1200/format:webp/1*-9d-keUyz3qRXd_gLlbt9w.png 1200w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 600px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*-9d-keUyz3qRXd_gLlbt9w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*-9d-keUyz3qRXd_gLlbt9w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*-9d-keUyz3qRXd_gLlbt9w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*-9d-keUyz3qRXd_gLlbt9w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*-9d-keUyz3qRXd_gLlbt9w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*-9d-keUyz3qRXd_gLlbt9w.png 1100w, https://miro.medium.com/v2/resize:fit:1200/1*-9d-keUyz3qRXd_gLlbt9w.png 1200w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 600px"><img alt="" class="be lp pb c" width="600" height="424" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:750/1*-9d-keUyz3qRXd_gLlbt9w.png"></picture></div><figcaption class="pc fc pd oo op pe pf bc b bd z dr" data-selectable-paragraph="">Figure 8. Mapping of the diagram and a debugger output — ObjectPointerBits</figcaption></figure><p id="0c9c" class="pw-post-body-paragraph mi mj gr mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh" data-selectable-paragraph="">We need to get object_header from “ObjectPointerBits”. The simple way of doing it add 0 at the end of the and ffff at the beginning of the “ObjectPointerBits” to complete 64bit pointer address.</p><figure class="or os ot ou ov ow oo op paragraph-image"><div class="oo op pk"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*un95oAlI1_x7Ces9X3pbiw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*un95oAlI1_x7Ces9X3pbiw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*un95oAlI1_x7Ces9X3pbiw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*un95oAlI1_x7Ces9X3pbiw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*un95oAlI1_x7Ces9X3pbiw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*un95oAlI1_x7Ces9X3pbiw.png 1100w, https://miro.medium.com/v2/resize:fit:1116/format:webp/1*un95oAlI1_x7Ces9X3pbiw.png 1116w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 558px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*un95oAlI1_x7Ces9X3pbiw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*un95oAlI1_x7Ces9X3pbiw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*un95oAlI1_x7Ces9X3pbiw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*un95oAlI1_x7Ces9X3pbiw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*un95oAlI1_x7Ces9X3pbiw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*un95oAlI1_x7Ces9X3pbiw.png 1100w, https://miro.medium.com/v2/resize:fit:1116/1*un95oAlI1_x7Ces9X3pbiw.png 1116w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 558px"><img alt="" class="be lp pb c" width="558" height="78" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:698/1*un95oAlI1_x7Ces9X3pbiw.png"></picture></div><figcaption class="pc fc pd oo op pe pf bc b bd z dr" data-selectable-paragraph="">Figure 9. Deriving a object_header address from ObjectPointerBits</figcaption></figure><p id="4dba" class="pw-post-body-paragraph mi mj gr mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh" data-selectable-paragraph="">I don’t know how it works but I could get the pointer to the object header by leftshift (&lt;&lt;4) and ORing the result with 0xffff000000000000. The derived hex number is a pointer to the object header. This is represented by _object_header structure.</p><p id="9e05" class="pw-post-body-paragraph mi mj gr mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh" data-selectable-paragraph="">Now, let us enumerate the _object_header and get the to the _object_type to identify the type of object followed by this object_header.</p><figure class="or os ot ou ov ow oo op paragraph-image"><div class="oo op pg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*CrbN4X6jwZDf649v-6hq8g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*CrbN4X6jwZDf649v-6hq8g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*CrbN4X6jwZDf649v-6hq8g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*CrbN4X6jwZDf649v-6hq8g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*CrbN4X6jwZDf649v-6hq8g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*CrbN4X6jwZDf649v-6hq8g.png 1100w, https://miro.medium.com/v2/resize:fit:1202/format:webp/1*CrbN4X6jwZDf649v-6hq8g.png 1202w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 601px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*CrbN4X6jwZDf649v-6hq8g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*CrbN4X6jwZDf649v-6hq8g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*CrbN4X6jwZDf649v-6hq8g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*CrbN4X6jwZDf649v-6hq8g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*CrbN4X6jwZDf649v-6hq8g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*CrbN4X6jwZDf649v-6hq8g.png 1100w, https://miro.medium.com/v2/resize:fit:1202/1*CrbN4X6jwZDf649v-6hq8g.png 1202w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 601px"><img alt="" class="be lp pb c" width="601" height="399" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:751/1*CrbN4X6jwZDf649v-6hq8g.png"></picture></div><figcaption class="pc fc pd oo op pe pf bc b bd z dr" data-selectable-paragraph="">Figure 10. Enumerating a object_header</figcaption></figure><figure class="or os ot ou ov ow oo op paragraph-image"><div class="oo op pg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*02cjaYNxUM8-Ni0uyJkb4Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*02cjaYNxUM8-Ni0uyJkb4Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*02cjaYNxUM8-Ni0uyJkb4Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*02cjaYNxUM8-Ni0uyJkb4Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*02cjaYNxUM8-Ni0uyJkb4Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*02cjaYNxUM8-Ni0uyJkb4Q.png 1100w, https://miro.medium.com/v2/resize:fit:1202/format:webp/1*02cjaYNxUM8-Ni0uyJkb4Q.png 1202w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 601px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*02cjaYNxUM8-Ni0uyJkb4Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*02cjaYNxUM8-Ni0uyJkb4Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*02cjaYNxUM8-Ni0uyJkb4Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*02cjaYNxUM8-Ni0uyJkb4Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*02cjaYNxUM8-Ni0uyJkb4Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*02cjaYNxUM8-Ni0uyJkb4Q.png 1100w, https://miro.medium.com/v2/resize:fit:1202/1*02cjaYNxUM8-Ni0uyJkb4Q.png 1202w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 601px"><img alt="" class="be lp pb c" width="601" height="344" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:751/1*02cjaYNxUM8-Ni0uyJkb4Q.png"></picture></div><figcaption class="pc fc pd oo op pe pf bc b bd z dr" data-selectable-paragraph="">Figure 11. Mapping of the diagram and a debugger output — TypeIndex</figcaption></figure><p id="87fa" class="pw-post-body-paragraph mi mj gr mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh" data-selectable-paragraph="">As I said in the introduction of the article, Microsoft has made it more complex as they evolve with the operating systems. In earlier version of the Microsoft (like Windows 7) this TypeIndex is an index to the nt!ObTypeIndexTable,however, now this field does not refer to the direct index in to the ObType table. We need to derive the lookup index from the “TypeIndex” field and then use that index to lookup the type of the object in the nt!ObTypeIndexTable. To derive the lookup index from the: TypeIndex”, please perform following operations on the “TypeIndex”. We need to take the second least significant byte from the header. In our case,</p><p id="4a35" class="pw-post-body-paragraph mi mj gr mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh" data-selectable-paragraph="">object header is 0xffffa703`b2c47ae0 hence second least significant byte would be “7a”.</p><p id="8de6" class="pw-post-body-paragraph mi mj gr mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh" data-selectable-paragraph="">TypeIndex value is 0x68</p><figure class="or os ot ou ov ow oo op paragraph-image"><div class="oo op pl"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*bu3AlGQ-zzMGmRV-ItGlIQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*bu3AlGQ-zzMGmRV-ItGlIQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*bu3AlGQ-zzMGmRV-ItGlIQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*bu3AlGQ-zzMGmRV-ItGlIQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*bu3AlGQ-zzMGmRV-ItGlIQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*bu3AlGQ-zzMGmRV-ItGlIQ.png 1100w, https://miro.medium.com/v2/resize:fit:1028/format:webp/1*bu3AlGQ-zzMGmRV-ItGlIQ.png 1028w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 514px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*bu3AlGQ-zzMGmRV-ItGlIQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*bu3AlGQ-zzMGmRV-ItGlIQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*bu3AlGQ-zzMGmRV-ItGlIQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*bu3AlGQ-zzMGmRV-ItGlIQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*bu3AlGQ-zzMGmRV-ItGlIQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*bu3AlGQ-zzMGmRV-ItGlIQ.png 1100w, https://miro.medium.com/v2/resize:fit:1028/1*bu3AlGQ-zzMGmRV-ItGlIQ.png 1028w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 514px"><img alt="" class="be lp pb c" width="514" height="269" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:643/1*bu3AlGQ-zzMGmRV-ItGlIQ.png"></picture></div><figcaption class="pc fc pd oo op pe pf bc b bd z dr" data-selectable-paragraph="">Figure 12. Object_header &amp; TypeIndex Values</figcaption></figure><p id="1a17" class="pw-post-body-paragraph mi mj gr mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh" data-selectable-paragraph="">Nt!ObHeaderCookie value is 0c</p><figure class="or os ot ou ov ow oo op paragraph-image"><div class="oo op pm"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*wLUR6K6EqM91paF1QDiECA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*wLUR6K6EqM91paF1QDiECA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*wLUR6K6EqM91paF1QDiECA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*wLUR6K6EqM91paF1QDiECA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*wLUR6K6EqM91paF1QDiECA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*wLUR6K6EqM91paF1QDiECA.png 1100w, https://miro.medium.com/v2/resize:fit:594/format:webp/1*wLUR6K6EqM91paF1QDiECA.png 594w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 297px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*wLUR6K6EqM91paF1QDiECA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*wLUR6K6EqM91paF1QDiECA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*wLUR6K6EqM91paF1QDiECA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*wLUR6K6EqM91paF1QDiECA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*wLUR6K6EqM91paF1QDiECA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*wLUR6K6EqM91paF1QDiECA.png 1100w, https://miro.medium.com/v2/resize:fit:594/1*wLUR6K6EqM91paF1QDiECA.png 594w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 297px"><img alt="" class="be lp pb c" width="297" height="45" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:371/1*wLUR6K6EqM91paF1QDiECA.png"></picture></div><figcaption class="pc fc pd oo op pe pf bc b bd z dr" data-selectable-paragraph="">Figure 12. nt!ObHeaderCookie value</figcaption></figure><p id="2fbf" class="pw-post-body-paragraph mi mj gr mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh" data-selectable-paragraph="">To derive lookup index, we need to XOR all these 3 values.</p><figure class="or os ot ou ov ow oo op paragraph-image"><div class="oo op pn"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*05zQ9S9ELSG1YzYkuxaNig.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*05zQ9S9ELSG1YzYkuxaNig.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*05zQ9S9ELSG1YzYkuxaNig.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*05zQ9S9ELSG1YzYkuxaNig.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*05zQ9S9ELSG1YzYkuxaNig.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*05zQ9S9ELSG1YzYkuxaNig.png 1100w, https://miro.medium.com/v2/resize:fit:864/format:webp/1*05zQ9S9ELSG1YzYkuxaNig.png 864w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 432px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*05zQ9S9ELSG1YzYkuxaNig.png 640w, https://miro.medium.com/v2/resize:fit:720/1*05zQ9S9ELSG1YzYkuxaNig.png 720w, https://miro.medium.com/v2/resize:fit:750/1*05zQ9S9ELSG1YzYkuxaNig.png 750w, https://miro.medium.com/v2/resize:fit:786/1*05zQ9S9ELSG1YzYkuxaNig.png 786w, https://miro.medium.com/v2/resize:fit:828/1*05zQ9S9ELSG1YzYkuxaNig.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*05zQ9S9ELSG1YzYkuxaNig.png 1100w, https://miro.medium.com/v2/resize:fit:864/1*05zQ9S9ELSG1YzYkuxaNig.png 864w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 432px"><img alt="" class="be lp pb c" width="432" height="42" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:540/1*05zQ9S9ELSG1YzYkuxaNig.png"></picture></div><figcaption class="pc fc pd oo op pe pf bc b bd z dr" data-selectable-paragraph="">Figure 13. Deriving lookup index from TypeIndex value</figcaption></figure><p id="fd8f" class="pw-post-body-paragraph mi mj gr mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh" data-selectable-paragraph="">Please refer to this amazing article at the link <a class="af np" href="https://medium.com/@ashabdalhalim/a-light-on-windows-10s-object-header-typeindex-value-e8f907e7073a" rel="noopener">https://medium.com/@ashabdalhalim/a-light-on-windows-10s-object-header-typeindex-value-e8f907e7073a</a> by <a class="af np" href="https://www.linkedin.com/in/ashabdalhalim/" rel="noopener ugc nofollow" target="_blank">Ashraf</a> <a class="af np" href="https://twitter.com/AshAbdalhalim" rel="noopener ugc nofollow" target="_blank">Abdalhalim</a> to get more details about why we are doing this XOR to calculate the lookup index.</p><p id="09ed" class="pw-post-body-paragraph mi mj gr mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh" data-selectable-paragraph="">So, our lookup index is 1e. We can now enumerate object type by looking up in to the nt!ObTypeIndexTable.</p><figure class="or os ot ou ov ow oo op paragraph-image"><div class="oo op pg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*fvsyH_rV3ujlLw4_ZdUz3g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*fvsyH_rV3ujlLw4_ZdUz3g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*fvsyH_rV3ujlLw4_ZdUz3g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*fvsyH_rV3ujlLw4_ZdUz3g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*fvsyH_rV3ujlLw4_ZdUz3g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*fvsyH_rV3ujlLw4_ZdUz3g.png 1100w, https://miro.medium.com/v2/resize:fit:1202/format:webp/1*fvsyH_rV3ujlLw4_ZdUz3g.png 1202w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 601px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*fvsyH_rV3ujlLw4_ZdUz3g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*fvsyH_rV3ujlLw4_ZdUz3g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*fvsyH_rV3ujlLw4_ZdUz3g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*fvsyH_rV3ujlLw4_ZdUz3g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*fvsyH_rV3ujlLw4_ZdUz3g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*fvsyH_rV3ujlLw4_ZdUz3g.png 1100w, https://miro.medium.com/v2/resize:fit:1202/1*fvsyH_rV3ujlLw4_ZdUz3g.png 1202w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 601px"><img alt="" class="be lp pb c" width="601" height="190" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:751/1*fvsyH_rV3ujlLw4_ZdUz3g.png"></picture></div><figcaption class="pc fc pd oo op pe pf bc b bd z dr" data-selectable-paragraph="">Figure 14. Enumerating _object_type to get the object name/type</figcaption></figure><p id="c743" class="pw-post-body-paragraph mi mj gr mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh" data-selectable-paragraph="">As we can see the object type is TpWorkerFactory.</p><figure class="or os ot ou ov ow oo op paragraph-image"><div role="button" tabindex="0" class="ox oy fg oz be pa"><div class="oo op po"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*kXwu1IZabdRWh1-L2uCUAA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*kXwu1IZabdRWh1-L2uCUAA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*kXwu1IZabdRWh1-L2uCUAA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*kXwu1IZabdRWh1-L2uCUAA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*kXwu1IZabdRWh1-L2uCUAA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*kXwu1IZabdRWh1-L2uCUAA.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*kXwu1IZabdRWh1-L2uCUAA.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*kXwu1IZabdRWh1-L2uCUAA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*kXwu1IZabdRWh1-L2uCUAA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*kXwu1IZabdRWh1-L2uCUAA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*kXwu1IZabdRWh1-L2uCUAA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*kXwu1IZabdRWh1-L2uCUAA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*kXwu1IZabdRWh1-L2uCUAA.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*kXwu1IZabdRWh1-L2uCUAA.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"><img alt="" class="be lp pb c" width="602" height="373" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:753/1*kXwu1IZabdRWh1-L2uCUAA.png"></picture></div></div><figcaption class="pc fc pd oo op pe pf bc b bd z dr" data-selectable-paragraph="">Figure 15. Mapping of the diagram with a debugger output — Name in _object_type</figcaption></figure><p id="ac15" class="pw-post-body-paragraph mi mj gr mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh" data-selectable-paragraph="">We can verify the same by enumerating the same handle through <strong class="mk gs">!handle</strong> in the windbg.</p><figure class="or os ot ou ov ow oo op paragraph-image"><div class="oo op pg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*KRI8cgt3hPOUawIweiMB5w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*KRI8cgt3hPOUawIweiMB5w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*KRI8cgt3hPOUawIweiMB5w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*KRI8cgt3hPOUawIweiMB5w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*KRI8cgt3hPOUawIweiMB5w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*KRI8cgt3hPOUawIweiMB5w.png 1100w, https://miro.medium.com/v2/resize:fit:1202/format:webp/1*KRI8cgt3hPOUawIweiMB5w.png 1202w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 601px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*KRI8cgt3hPOUawIweiMB5w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*KRI8cgt3hPOUawIweiMB5w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*KRI8cgt3hPOUawIweiMB5w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*KRI8cgt3hPOUawIweiMB5w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*KRI8cgt3hPOUawIweiMB5w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*KRI8cgt3hPOUawIweiMB5w.png 1100w, https://miro.medium.com/v2/resize:fit:1202/1*KRI8cgt3hPOUawIweiMB5w.png 1202w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 601px"><img alt="" class="be lp pb c" width="601" height="83" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:751/1*KRI8cgt3hPOUawIweiMB5w.png"></picture></div><figcaption class="pc fc pd oo op pe pf bc b bd z dr" data-selectable-paragraph="">Figure 16. !handle output from debugger</figcaption></figure><p id="3ac4" class="pw-post-body-paragraph mi mj gr mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh" data-selectable-paragraph="">As expected, the all values are matching.</p><p id="b949" class="pw-post-body-paragraph mi mj gr mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh" data-selectable-paragraph="">So, folks, we started with EPROCESS and reached to object_type by following cues provided by the various kernel structures. I hope you enjoy this reading.</p><p id="8cb3" class="pw-post-body-paragraph mi mj gr mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh" data-selectable-paragraph="">That’s it for now, folks!! Happy hunting, fellas!!</p><blockquote class="pp pq pr"><p id="4b4c" class="mi mj ps mk b ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf gk bh" data-selectable-paragraph=""><strong class="mk gs">by :</strong><br><strong class="mk gs">Kirtar Oza</strong><br><strong class="mk gs">Twitter</strong> : <a class="af np" href="https://twitter.com/kirtar_oza" rel="noopener ugc nofollow" target="_blank">K</a>rishna (@<a class="af np" href="https://twitter.com/kirtar_oza" rel="noopener ugc nofollow" target="_blank">kirtar_oza</a>)<br><strong class="mk gs">LinkedIn</strong>: <a class="af np" href="https://www.linkedin.com/in/kirtaroza/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/kirtaroza/<br></a><strong class="mk gs">email</strong>: <a class="af np" href="mailto:kirtar.oza@gmail.com" rel="noopener ugc nofollow" target="_blank">kirtar.oza@gmail.com</a></p></blockquote></div></div></div></div></section></div></div></article><div class="ab by"><div class="cf be fw fx fy fz"></div></div></div><div></div><div class="m sq sr ss"><div class="bu st su be wl" style="bottom: 0px;"><div class="sw t sx v sy sz ta tb tc td ab q cl fg"><div class="te tf tg th ti l"><div class="am l fp tj tk"><div class="h k"><div class="l fg n tl"><button class="af ag ah ai aj ak al am an ao ap aq ar as at ab" data-testid="close-button" aria-label="close"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" class="fh dr fj fi"><path d="M5 5l7 7m7 7l-7-7m0 0l7-7m-7 7l-7 7" stroke="currentColor" stroke-linecap="round"></path></svg></button></div></div><div class="j i d"><div class="l fg n tl"><button class="af ag ah ai aj ak al am an ao ap aq ar as at ab fg tm gn tn to tp tq" data-testid="close-button" aria-label="close"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" class="fh dr fj fi"><path d="M5 5l7 7m7 7l-7-7m0 0l7-7m-7 7l-7 7" stroke="currentColor" stroke-linecap="round"></path></svg></button></div></div></div><div class="ab q iv iw ty tz"><img class="fp sr gf ua" src="https://miro.medium.com/v2/da:true/resize:fit:0/5c50caa54067fd622d2f0fac18392213bf92f6e2fae89b691e62bceb40885e74" loading="lazy" role="presentation"><div class="gv ub ha uc dj ud dk ue uf l"><svg viewBox="0 0 3940 610" class="tr ts tt tu tv hf tw hk tx hp"><path d="M594.79 308.2c0 163.76-131.85 296.52-294.5 296.52S5.8 472 5.8 308.2 137.65 11.69 300.29 11.69s294.5 132.75 294.5 296.51M917.86 308.2c0 154.16-65.93 279.12-147.25 279.12s-147.25-125-147.25-279.12S689.29 29.08 770.61 29.08s147.25 125 147.25 279.12M1050 308.2c0 138.12-23.19 250.08-51.79 250.08s-51.79-112-51.79-250.08 23.19-250.08 51.8-250.08S1050 170.09 1050 308.2M1862.77 37.4l.82-.18v-6.35h-167.48l-155.51 365.5-155.51-365.5h-180.48v6.35l.81.18c30.57 6.9 46.09 17.19 46.09 54.3v434.45c0 37.11-15.58 47.4-46.15 54.3l-.81.18V587H1327v-6.35l-.81-.18c-30.57-6.9-46.09-17.19-46.09-54.3V116.9L1479.87 587h11.33l205.59-483.21V536.9c-2.62 29.31-18 38.36-45.68 44.61l-.82.19v6.3h213.3v-6.3l-.82-.19c-27.71-6.25-43.46-15.3-46.08-44.61l-.14-445.2h.14c0-37.11 15.52-47.4 46.08-54.3m97.43 287.8c3.49-78.06 31.52-134.4 78.56-135.37 14.51.24 26.68 5 36.14 14.16 20.1 19.51 29.55 60.28 28.09 121.21zm-2.11 22h250v-1.05c-.71-59.69-18-106.12-51.34-138-28.82-27.55-71.49-42.71-116.31-42.71h-1c-23.26 0-51.79 5.64-72.09 15.86-23.11 10.7-43.49 26.7-60.45 47.7-27.3 33.83-43.84 79.55-47.86 130.93-.13 1.54-.24 3.08-.35 4.62s-.18 2.92-.25 4.39a332.64 332.64 0 0 0-.36 21.69C1860.79 507 1923.65 600 2035.3 600c98 0 155.07-71.64 169.3-167.8l-7.19-2.53c-25 51.68-69.9 83-121 79.18-69.76-5.22-123.2-75.95-118.35-161.63m532.69 157.68c-8.2 19.45-25.31 30.15-48.24 30.15s-43.89-15.74-58.78-44.34c-16-30.7-24.42-74.1-24.42-125.51 0-107 33.28-176.21 84.79-176.21 21.57 0 38.55 10.7 46.65 29.37zm165.84 76.28c-30.57-7.23-46.09-18-46.09-57V5.28L2424.77 60v6.7l1.14-.09c25.62-2.07 43 1.47 53.09 10.79 7.9 7.3 11.75 18.5 11.75 34.26v71.14c-18.31-11.69-40.09-17.38-66.52-17.38-53.6 0-102.59 22.57-137.92 63.56-36.83 42.72-56.3 101.1-56.3 168.81C2230 518.72 2289.53 600 2378.13 600c51.83 0 93.53-28.4 112.62-76.3V588h166.65v-6.66zm159.29-505.33c0-37.76-28.47-66.24-66.24-66.24-37.59 0-67 29.1-67 66.24s29.44 66.24 67 66.24c37.77 0 66.24-28.48 66.24-66.24m43.84 505.33c-30.57-7.23-46.09-18-46.09-57h-.13V166.65l-166.66 47.85v6.5l1 .09c36.06 3.21 45.93 15.63 45.93 57.77V588h166.8v-6.66zm427.05 0c-30.57-7.23-46.09-18-46.09-57V166.65L3082 212.92v6.52l.94.1c29.48 3.1 38 16.23 38 58.56v226c-9.83 19.45-28.27 31-50.61 31.78-36.23 0-56.18-24.47-56.18-68.9V166.66l-166.66 47.85V221l1 .09c36.06 3.2 45.94 15.62 45.94 57.77v191.27a214.48 214.48 0 0 0 3.47 39.82l3 13.05c14.11 50.56 51.08 77 109 77 49.06 0 92.06-30.37 111-77.89v66h166.66v-6.66zM3934.2 588v-6.67l-.81-.19c-33.17-7.65-46.09-22.07-46.09-51.43v-243.2c0-75.83-42.59-121.09-113.93-121.09-52 0-95.85 30.05-112.73 76.86-13.41-49.6-52-76.86-109.06-76.86-50.12 0-89.4 26.45-106.25 71.13v-69.87l-166.66 45.89v6.54l1 .09c35.63 3.16 45.93 15.94 45.93 57V588h155.5v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66V255.72c7-16.35 21.11-35.72 49-35.72 34.64 0 52.2 24 52.2 71.28V588h155.54v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66v-248a160.45 160.45 0 0 0-2.2-27.68c7.42-17.77 22.34-38.8 51.37-38.8 35.13 0 52.2 23.31 52.2 71.28V588z"></path></svg><h2 class="ug b ml uh ui mp uj uk ul um un uo up uq ur us ut uu uv">Sign up to discover human stories that deepen your understanding of the world.</h2></div><div class="ab q iv iw"><div class="uw gb bm gv ux ha uy uz va vb vc vd ve l c"><div class="ab q"><h2 class="bc rt il z gq bh">Free</h2></div><div class="rx vf l cu"></div><div class="rx ab"><div class="bl l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="bc b bd z bh">Distraction-free reading. No ads.</p></div><div class="rx ab"><div class="bl l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="bc b bd z bh">Organize your knowledge with lists and highlights.</p></div><div class="rx ab"><div class="bl l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="bc b bd z bh">Tell your story. Find your audience.</p></div><div class="ci vg vf l cu"></div><span><button class="bc b bd z vh px vi vj vk vl vm es et vn vo vp ex be ey ez fa bj fb fc">Sign up for free</button></span></div><div class="uw gb bm ux uy va vc ve l c"><div class="ab q"><svg width="64" height="64" viewBox="0 0 64 64" fill="none" class="vq pw de lh"><path d="M39.64 40.83L33.87 56.7a1.99 1.99 0 0 1-3.74 0l-5.77-15.87a2.02 2.02 0 0 0-1.2-1.2L7.3 33.88a1.99 1.99 0 0 1 0-3.74l15.87-5.77a2.02 2.02 0 0 0 1.2-1.2L30.12 7.3a1.99 1.99 0 0 1 3.74 0l5.77 15.87a2.02 2.02 0 0 0 1.2 1.2l15.86 5.76a1.99 1.99 0 0 1 0 3.74l-15.87 5.77a2.02 2.02 0 0 0-1.2 1.2z" fill="#FFC017"></path></svg><h2 class="bc rt il z gq bh">Membership</h2></div><div class="rx vf l cu"></div><div class="rx ab"><div class="bl l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="bc b bd z bh">Access the best member-only stories.</p></div><div class="rx ab"><div class="bl l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="bc b bd z bh">Support independent authors.</p></div><div class="rx ab"><div class="bl l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="bc b bd z bh">Listen to audio narrations.</p></div><div class="rx ab"><div class="bl l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="bc b bd z bh">Read offline.</p></div><div class="rx ab"><div class="bl l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="bc b bd z bh">Join the Partner Program and earn for your writing.</p></div><div class="ci vg vf l cu"></div><span><button class="bc b bd z vh px vi vj vk vl vm es et vn vo vp ex be ey ez fa bj fb fc">Try for 5&nbsp;$/month</button></span></div></div></div></div></div></div></div><div class="ab by"><div class="cf be fw fx fy fz"><div class="pt pu ab ix"><div class="pv ab"><a class="pw av am ao" href="https://medium.com/tag/dfir?source=post_page-----2368187685e---------------dfir-----------------" rel="noopener follow"><div class="px fg cu py gb pz qa bc b bd z bh qb">Dfir</div></a></div><div class="pv ab"><a class="pw av am ao" href="https://medium.com/tag/forensics?source=post_page-----2368187685e---------------forensics-----------------" rel="noopener follow"><div class="px fg cu py gb pz qa bc b bd z bh qb">Forensics</div></a></div><div class="pv ab"><a class="pw av am ao" href="https://medium.com/tag/cybersecurity?source=post_page-----2368187685e---------------cybersecurity-----------------" rel="noopener follow"><div class="px fg cu py gb pz qa bc b bd z bh qb">Cybersecurity</div></a></div><div class="pv ab"><a class="pw av am ao" href="https://medium.com/tag/threat-hunting?source=post_page-----2368187685e---------------threat_hunting-----------------" rel="noopener follow"><div class="px fg cu py gb pz qa bc b bd z bh qb">Threat Hunting</div></a></div><div class="pv ab"><a class="pw av am ao" href="https://medium.com/tag/memory-forensics?source=post_page-----2368187685e---------------memory_forensics-----------------" rel="noopener follow"><div class="px fg cu py gb pz qa bc b bd z bh qb">Memory Forensics</div></a></div></div></div></div><div class="l"></div><footer class="qc qd qe qf qg qh qi qj qk ab q ql qm c"><div class="l ae"><div class="ab by"><div class="cf be fw fx fy fz"><div class="ab cm qn"><div class="ab q kg"><div class="qo l"><span class="l qp qq qr e d"><div class="ab q kg kh"><div class="pw-multi-vote-icon fg ki kj kk kl"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F2368187685e&amp;operation=register&amp;redirect=https%3A%2F%2Fimphash.medium.com%2Fwindows-process-internals-a-few-concepts-to-know-before-jumping-on-memory-forensics-part-5-a-2368187685e&amp;user=imp+hash&amp;userId=c23376f92e3f&amp;source=-----2368187685e---------------------clap_footer-----------" rel="noopener follow"><div><div class="bj" aria-hidden="false" aria-describedby="8" aria-labelledby="8"><div class="km ao kn ko kp kq am kr ks kt kl"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ku kv kw kx ky kz la"><div><div class="bj" aria-hidden="false" aria-describedby="80" aria-labelledby="80"><p class="bc b ds z dr"><button class="af ag ah ai aj ak al am an ao ap aq ar as at xq li">2<span class="l h g f qs qt"></span></button></p></div></div></div></div></span><span class="l h g f qs qt"><div class="ab q kg kh"><div class="pw-multi-vote-icon fg ki kj kk kl"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F2368187685e&amp;operation=register&amp;redirect=https%3A%2F%2Fimphash.medium.com%2Fwindows-process-internals-a-few-concepts-to-know-before-jumping-on-memory-forensics-part-5-a-2368187685e&amp;user=imp+hash&amp;userId=c23376f92e3f&amp;source=-----2368187685e---------------------clap_footer-----------" rel="noopener follow"><div><div class="bj" aria-hidden="false" aria-describedby="9" aria-labelledby="9"><div class="km ao kn ko kp kq am kr ks kt kl"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ku kv kw kx ky kz la"><div><div class="bj" aria-hidden="false" aria-describedby="82" aria-labelledby="82"><p class="bc b ds z dr"><button class="af ag ah ai aj ak al am an ao ap aq ar as at xq li">2</button></p></div></div></div></div></span></div><div class="bn ab"><div><div class="bj" aria-hidden="false" aria-describedby="10" aria-labelledby="10"><button class="ao km lc ld ab q fh le lf" aria-label="responses"><svg width="24" height="24" viewBox="0 0 24 24" class="lg"><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></button></div></div></div></div><div class="ab q"><div class="qu l iu"><div><div class="bj" aria-hidden="false" aria-describedby="11" aria-labelledby="11"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2368187685e&amp;operation=register&amp;redirect=https%3A%2F%2Fimphash.medium.com%2Fwindows-process-internals-a-few-concepts-to-know-before-jumping-on-memory-forensics-part-5-a-2368187685e&amp;source=--------------------------bookmark_footer-----------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dr li" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div><div class="qu l iu"><div class="bj" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bj" aria-hidden="false" aria-describedby="12" aria-labelledby="12"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fh ah ai aj ak al lq an ao ap eu lr ls lf lt"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.22 4.93a.42.42 0 0 1-.12.13h.01a.45.45 0 0 1-.29.08.52.52 0 0 1-.3-.13L12.5 3v7.07a.5.5 0 0 1-.5.5.5.5 0 0 1-.5-.5V3.02l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.8a.42.42 0 0 1 .07.5zm-.1.14zm.88 2h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11a2 2 0 0 1-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.14c.1.1.15.22.15.35a.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9V8.96c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1z" fill="currentColor"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="qv qw qx qy qz l bu"><div class="ab by"><div class="cf be fw fx fy fz"><div class="ci ab ra cm"><div class="ab ic"><a rel="noopener follow" href="/?source=post_page-----2368187685e--------------------------------"><div class="l rb rc bv rd ig"><div class="l fg"><img alt="imp hash" class="l fa bv re rf cu" src="https://miro.medium.com/v2/resize:fill:144:144/0*PFkpquOFwCFuo6RL.jpg" width="72" height="72" loading="lazy"><div class="ih bv l re rf fp n ii fq"></div></div></div></a></div><div class="j i d"><div class="ab"><span><button class="bc b bd z el px em eo ep eq er es et eu ev ew ex rg ey ez fa bj fb fc">Follow</button></span><div class="dq l"><div><div><div class="bj" aria-hidden="false" aria-describedby="88" aria-labelledby="88"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fea113879a6c3&amp;operation=register&amp;redirect=https%3A%2F%2Fimphash.medium.com%2Fwindows-process-internals-a-few-concepts-to-know-before-jumping-on-memory-forensics-part-5-a-2368187685e&amp;newsletterV3=c23376f92e3f&amp;newsletterV3Id=ea113879a6c3&amp;user=imp+hash&amp;userId=c23376f92e3f&amp;source=-----2368187685e---------------------subscribe_user-----------" rel="noopener follow"><button class="bc b bd z el am em eo ep eq er es et eu ev ew ex ey ez fa bj fb fc" aria-label="Subscribe"><svg width="38" height="38" viewBox="0 0 38 38" fill="none" class="xs ri rj"><rect x="26.25" y="9.25" width="0.5" height="6.5" rx="0.25"></rect><rect x="29.75" y="12.25" width="0.5" height="6.5" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5L19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="ab ck cm"><div class="l"><div class="ab q"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/?source=post_page-----2368187685e--------------------------------"><h2 class="pw-author-name bc rt ru rv rw bh"><span class="gk iz">Written by <!-- -->imp hash</span></h2></a></div><div class="pv ab"><div class="l iu"><span class="pw-follower-count bc b bd z bh"><a class="af ag ah ai aj ak al am an ao ap aq ar in" rel="noopener follow" href="/followers?source=post_page-----2368187685e--------------------------------">145 Followers</a></span></div></div><div class="rx l"><p class="bc b bd z bh"><span class="gk">Threat Researcher</span></p></div></div><div class="h k"><div class="ab"><span><button class="bc b bd z el px em eo ep eq er es et eu ev ew ex rg ey ez fa bj fb fc">Follow</button></span><div class="dq l"><div><div><div class="bj" aria-hidden="false" aria-describedby="89" aria-labelledby="89"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fea113879a6c3&amp;operation=register&amp;redirect=https%3A%2F%2Fimphash.medium.com%2Fwindows-process-internals-a-few-concepts-to-know-before-jumping-on-memory-forensics-part-5-a-2368187685e&amp;newsletterV3=c23376f92e3f&amp;newsletterV3Id=ea113879a6c3&amp;user=imp+hash&amp;userId=c23376f92e3f&amp;source=-----2368187685e---------------------subscribe_user-----------" rel="noopener follow"><button class="bc b bd z el am em eo ep eq er es et eu ev ew ex ey ez fa bj fb fc" aria-label="Subscribe"><svg width="38" height="38" viewBox="0 0 38 38" fill="none" class="xs ri rj"><rect x="26.25" y="9.25" width="0.5" height="6.5" rx="0.25"></rect><rect x="29.75" y="12.25" width="0.5" height="6.5" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5L19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="ry be rz sa sb sc sd se"></div></div></div><div class="h k j"><div class="ry be rz sf"></div><div class="ab by"><div class="cf be fw fx fy fz"><div class="sg ab kg ix"><div class="sh si l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----2368187685e--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Help</p></a></div><div class="sh si l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----2368187685e--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Status</p></a></div><div class="sh si l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/about?autoplay=1&amp;source=post_page-----2368187685e--------------------------------" rel="noopener follow"><p class="bc b ds z dr">About</p></a></div><div class="sh si l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----2368187685e--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Careers</p></a></div><div class="sh si l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="mailto:pressinquiries@medium.com?source=post_page-----2368187685e--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Press</p></a></div><div class="sh si l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----2368187685e--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Blog</p></a></div><div class="sh si l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2368187685e--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Privacy</p></a></div><div class="sh si l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2368187685e--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Terms</p></a></div><div class="sh si l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----2368187685e--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Text to speech</p></a></div><div class="sh l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/business?source=post_page-----2368187685e--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20240614-221838-3ba87a70fa"</script><script>window.__GRAPHQL_URI__ = "https://imphash.medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-2368187685e","user-c23376f92e3f"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"updatedPostPreviewsEnabled":true,"lohpExperimentEnabled":"control","prideLogoEnabled":true},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":true,"routingEntity":{"type":"USER","id":"c23376f92e3f","explicit":true},"viewerIsBot":false},"debug":{"requestId":"946bb40f-490a-4e79-b286-6cef52af26f9","hybridDevServices":[],"originalSpanCarrier":{"ot-tracer-spanid":"357b23567d90d91e","ot-tracer-traceid":"597822a4388d9ba6","ot-tracer-sampled":"true"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fimphash.medium.com\u002Fwindows-process-internals-a-few-concepts-to-know-before-jumping-on-memory-forensics-part-5-a-2368187685e","host":"imphash.medium.com","hostname":"imphash.medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20240614-221838-3ba87a70fa","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20240614-221838-3ba87a70fa","commit":"3ba87a70fa89456c9162015acb3c1797c92f4b41"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"1*OMF3fSqH8t4xBJ9-6oZDZw.png","height":106,"width":545},"postLogo":{"imageId":"1*kFrc4tBFM_tCis-2Ic87WA.png","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"isLoggedIn":false,"collectionByDomainOrSlug({\"domainOrSlug\":\"imphash.medium.com\"})":null,"postResult({\"id\":\"2368187685e\"})":{"__ref":"Post:2368187685e"}},"LinkedAccounts:c23376f92e3f":{"__typename":"LinkedAccounts","mastodon":null,"id":"c23376f92e3f"},"UserViewerEdge:userId:c23376f92e3f-viewerId:lo_feab786b6e83":{"__typename":"UserViewerEdge","id":"userId:c23376f92e3f-viewerId:lo_feab786b6e83","isFollowing":false,"isUser":false,"isMuting":false},"NewsletterV3:ea113879a6c3":{"__typename":"NewsletterV3","id":"ea113879a6c3","type":"NEWSLETTER_TYPE_AUTHOR","slug":"c23376f92e3f","name":"c23376f92e3f","collection":null,"user":{"__ref":"User:c23376f92e3f"}},"User:c23376f92e3f":{"__typename":"User","id":"c23376f92e3f","name":"imp hash","username":"imphash","newsletterV3":{"__ref":"NewsletterV3:ea113879a6c3"},"linkedAccounts":{"__ref":"LinkedAccounts:c23376f92e3f"},"isSuspended":false,"imageId":"0*PFkpquOFwCFuo6RL.jpg","mediumMemberAt":0,"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":145},"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"imphash.medium.com"}},"hasSubdomain":true,"bio":"Threat Researcher","isPartnerProgramEnrolled":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:c23376f92e3f-viewerId:lo_feab786b6e83"},"viewerIsUser":false,"postSubscribeMembershipUpsellShownAt":0,"allowNotes":true,"membership":null,"twitterScreenName":""},"Paragraph:342e9c948677_0":{"__typename":"Paragraph","id":"342e9c948677_0","name":"42d3","type":"H3","href":null,"layout":null,"metadata":null,"text":"Windows Process Internals: A few Concepts to know before jumping on Memory Forensics [Part 5] — A Journey in to the Undocumented Process Handle Structures","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":154,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_1":{"__typename":"Paragraph","id":"342e9c948677_1","name":"9de5","type":"P","href":null,"layout":null,"metadata":null,"text":"In this series of articles of “Must know Process Internals for Memory Forensics” — we have traversed through ActiveProcessLinks (doubly-linked list) of EPROCESS in Part-1 to understand how memory manager keeps track of active processes on the system.","hasDropCap":true,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":164,"end":170,"href":"https:\u002F\u002Feforensicsmag.com\u002Fwindows-process-internals-a-few-concepts-to-know-before-jumping-on-memory-forensics-by-kirtar-oza\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_2":{"__typename":"Paragraph","id":"342e9c948677_2","name":"bfbd","type":"P","href":null,"layout":null,"metadata":null,"text":"In Part-2, we have explored and traversed through Ldrmodules of _PEB structure that gave us insights how memory manager keeps track of all the loaded Dynamic Link Libraries (dlls) by a specific process.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":9,"href":"https:\u002F\u002Feforensicsmag.com\u002Fwindows-process-internals-a-few-concepts-to-know-before-jumping-on-memory-forensics-part-2-ldrmodules-by-kirtar-oza\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_3":{"__typename":"Paragraph","id":"342e9c948677_3","name":"d1f3","type":"P","href":null,"layout":null,"metadata":null,"text":"In Part-3, we discussed about how system tracks loaded kernel modules by traversing and exploring nt!PsLoadedModuleList.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":9,"href":"https:\u002F\u002Feforensicsmag.com\u002Fwindows-process-internals-a-few-concepts-to-know-before-jumping-on-memory-forensics-part-3-journey-in-to-the-psloadedmodulelist-loaded-kernel-modules-by-kirtar-oza\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_4":{"__typename":"Paragraph","id":"342e9c948677_4","name":"a94f","type":"P","href":null,"layout":null,"metadata":null,"text":"In the latest part, Part-4, we saw the details of Virtual Address Descriptors (VADs) and identified the details buried in to the VAD nodes.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":20,"end":26,"href":"https:\u002F\u002Feforensicsmag.com\u002F85384-2\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_5":{"__typename":"Paragraph","id":"342e9c948677_5","name":"99bb","type":"P","href":null,"layout":null,"metadata":null,"text":"This article would be Part-5 of the series and this would, most probably, be the last article (for now) of the series. In this Part-5, we will explore the kernel structures associated with Process Handles and how OS stores handle information for each process in the memory. The kernel structures related to handles have gone through a frequent change during each major version upgrade of the operating system. Windows 7, Windows 8, Windows 8.1 and now latest Windows 10 — all of these have different handle structures and a unique way to reference or to keep track of the handles in to the memory. I would say, Microsoft is introducing more and more complexity as they evolve hence from the forensics perspective, it has become harder to reverse these undocumented complex structures.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":22,"end":28,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_6":{"__typename":"Paragraph","id":"342e9c948677_6","name":"4922","type":"P","href":null,"layout":null,"metadata":null,"text":"In this article, we will explore the kernel handle structures of Windows 10 (build 18362) via live kernel debugging. We will start with EPROCESS structure of one process and will follow through the cues provided by the handle kernel structures to reach to the actual Object and Object type that has been referred by a specific handle. Let us start the journey in to the kernel handle structures!!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_7":{"__typename":"Paragraph","id":"342e9c948677_7","name":"8e6a","type":"H4","href":null,"layout":null,"metadata":null,"text":"What is a Handle, anyway?","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":25,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_8":{"__typename":"Paragraph","id":"342e9c948677_8","name":"52f4","type":"P","href":null,"layout":null,"metadata":null,"text":"If a process needs an access to any object such as a file, registry key, mutex, process, thread etc., it needs to get a hold of its handle first. Then the process can use this handle to get an access to the object referenced by this handle. The handle is a reference to a kernel structure that holds an information about the object that the handle refers to.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_9":{"__typename":"Paragraph","id":"342e9c948677_9","name":"6fc1","type":"P","href":null,"layout":null,"metadata":null,"text":"We will decode this jargon in the following sections. You may like to re-read this information after reading the entire article.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_10":{"__typename":"Paragraph","id":"342e9c948677_10","name":"4612","type":"H4","href":null,"layout":null,"metadata":null,"text":"How Memory Manager keeps track of Process Objects & Handles?","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":60,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_11":{"__typename":"Paragraph","id":"342e9c948677_11","name":"b10c","type":"P","href":null,"layout":null,"metadata":null,"text":"Each process has a executive object structure called EPROCESS in the kernel memory. This EPROCESS structure has a field named “ObjectTable”. This ObjectTable is a _handle_table structure.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_12":{"__typename":"Paragraph","id":"342e9c948677_12","name":"977e","type":"P","href":null,"layout":null,"metadata":null,"text":"This structure has a field named “TableCode”. TableCode provides the reference to the base of the handle table entries (_handle_table_entries). You can see in the diagram below that there are indexes (0x04,0x08,0x0c and so on) are written to the adjacent to each handle_table_entry. When we say that process has got an access to the handle of an object — that essentially means that the process knows which index (represented by a handle) to go to in the handle_table_entries retrieve the pointer to the object that it needs an access to. Therefore, handle is nothing but the index in to this handle_table_entry. A process uses this index\u002Fhandle to retrieve the information about the object that entry points to.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_13":{"__typename":"Paragraph","id":"342e9c948677_13","name":"f4ba","type":"P","href":null,"layout":null,"metadata":null,"text":"These entries are of _handle_table_entry structure. This structure contains the field named “ObjectPointerBits” that points to the object_header and we can get the address of the object from object_header.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_14":{"__typename":"Paragraph","id":"342e9c948677_14","name":"0d75","type":"P","href":null,"layout":null,"metadata":null,"text":"The object_header contains a field named “IndexType” that points to the structure _object_type that gives us an information about the type of the object this header referring to OR in other words, what type of object (like file,mutex, directory, process etc.) structure to expect after the object_header. This is important because handle table entries are mix of all objects that process has open handle to and TypeIndex lets us know about the type of object refereed by a specific handle.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_15":{"__typename":"Paragraph","id":"342e9c948677_15","name":"d115","type":"P","href":null,"layout":null,"metadata":null,"text":"Please refer to the following diagram that helps us to understand how OS stores information related to process objects and its handles.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*B6zCphcdYAGGUKEulQe0uQ.png":{"__typename":"ImageMetadata","id":"1*B6zCphcdYAGGUKEulQe0uQ.png","originalHeight":1080,"originalWidth":1920,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:342e9c948677_16":{"__typename":"Paragraph","id":"342e9c948677_16","name":"635f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*B6zCphcdYAGGUKEulQe0uQ.png"},"text":"Figure 1. Logical view of pointers between various handle structures in memory","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_17":{"__typename":"Paragraph","id":"342e9c948677_17","name":"b72e","type":"H4","href":null,"layout":null,"metadata":null,"text":"Exploring the handle structures through kernel debugging","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":56,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_18":{"__typename":"Paragraph","id":"342e9c948677_18","name":"4c52","type":"P","href":null,"layout":null,"metadata":null,"text":"Let us review all of these structures discussed above through live kernel debugging.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_19":{"__typename":"Paragraph","id":"342e9c948677_19","name":"0446","type":"P","href":null,"layout":null,"metadata":null,"text":"First of all, enumerate the active processes & pick any random process for our exploration. I have picked up a process that has its EPROCESS structure at 0xffffa703b3ebc080 address. Now, let us examine its ObjectTable by enumerating EPROECESS. Once, we get the ObjectTable, we can enumerate it and the get the address of the “TableCode” as “TableCode” is one of the fields in the ObjectTable. Please see following snippet for the same.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*sX86GYBEaP8zEZ2yckNHsg.png":{"__typename":"ImageMetadata","id":"1*sX86GYBEaP8zEZ2yckNHsg.png","originalHeight":309,"originalWidth":601,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:342e9c948677_20":{"__typename":"Paragraph","id":"342e9c948677_20","name":"44f4","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*sX86GYBEaP8zEZ2yckNHsg.png"},"text":"Figure 2. ObjectTable and TableCode","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*thT2833JI_sE0EnYHi8_5w.png":{"__typename":"ImageMetadata","id":"1*thT2833JI_sE0EnYHi8_5w.png","originalHeight":388,"originalWidth":601,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:342e9c948677_21":{"__typename":"Paragraph","id":"342e9c948677_21","name":"51f9","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*thT2833JI_sE0EnYHi8_5w.png"},"text":"Figure 3. Mapping of the diagram with a debugger output — ObjectTable & TableCode","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_22":{"__typename":"Paragraph","id":"342e9c948677_22","name":"b0e8","type":"P","href":null,"layout":null,"metadata":null,"text":"Now, let us enumerate what we have got at the TableCode. We expect to get the handle table entries at the address provided by the “TableCode”. We can derive base address of the handle table entries by ANDing the TableCode address with ~0x07.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*mvyUImgCU5TZpkO82Pifog.png":{"__typename":"ImageMetadata","id":"1*mvyUImgCU5TZpkO82Pifog.png","originalHeight":66,"originalWidth":550,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:342e9c948677_23":{"__typename":"Paragraph","id":"342e9c948677_23","name":"71f1","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*mvyUImgCU5TZpkO82Pifog.png"},"text":"Figure 4. deriving base address of handle table entries from TableCode","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_24":{"__typename":"Paragraph","id":"342e9c948677_24","name":"400a","type":"P","href":null,"layout":null,"metadata":null,"text":"Please refer following snippets for the same. As expected, we have got the base address followed by handle table entries.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Mc3IGAuwMMTKPKwCaK-_gQ.png":{"__typename":"ImageMetadata","id":"1*Mc3IGAuwMMTKPKwCaK-_gQ.png","originalHeight":149,"originalWidth":601,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:342e9c948677_25":{"__typename":"Paragraph","id":"342e9c948677_25","name":"4fc3","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Mc3IGAuwMMTKPKwCaK-_gQ.png"},"text":"Figure 5. handle table entries starting with the base address derived earlier","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*8AqRQCeuSZ6G0oa1B0AdjQ.png":{"__typename":"ImageMetadata","id":"1*8AqRQCeuSZ6G0oa1B0AdjQ.png","originalHeight":480,"originalWidth":480,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:342e9c948677_26":{"__typename":"Paragraph","id":"342e9c948677_26","name":"c9d8","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*8AqRQCeuSZ6G0oa1B0AdjQ.png"},"text":"Figure 6. Mapping of the diagram and a debugger output — handle table entries and indexes","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_27":{"__typename":"Paragraph","id":"342e9c948677_27","name":"78d5","type":"P","href":null,"layout":null,"metadata":null,"text":"We have got the handle table entries now. These are nothing but the handles to the actual object. As mentioned earlier, each handle table entry is of structure type _handle_table_entry. _handle_table_entry has got a field named “ObjectPointerBits” that points to the header of the object that is referred by that handle entry.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_28":{"__typename":"Paragraph","id":"342e9c948677_28","name":"c0fe","type":"P","href":null,"layout":null,"metadata":null,"text":"Let us take handle table entry at 0x14 index. The address at 0x14 index is 0xffffba8a1e3f1050. Let’s us enumerate this entry to get the pointer to the object.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ySIjDBkze93dW9wKf8uI9g.png":{"__typename":"ImageMetadata","id":"1*ySIjDBkze93dW9wKf8uI9g.png","originalHeight":234,"originalWidth":601,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:342e9c948677_29":{"__typename":"Paragraph","id":"342e9c948677_29","name":"6f0a","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ySIjDBkze93dW9wKf8uI9g.png"},"text":"Figure 7. Enumerating a handle table entry","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*-9d-keUyz3qRXd_gLlbt9w.png":{"__typename":"ImageMetadata","id":"1*-9d-keUyz3qRXd_gLlbt9w.png","originalHeight":424,"originalWidth":600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:342e9c948677_30":{"__typename":"Paragraph","id":"342e9c948677_30","name":"c97b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*-9d-keUyz3qRXd_gLlbt9w.png"},"text":"Figure 8. Mapping of the diagram and a debugger output — ObjectPointerBits","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_31":{"__typename":"Paragraph","id":"342e9c948677_31","name":"0c9c","type":"P","href":null,"layout":null,"metadata":null,"text":"We need to get object_header from “ObjectPointerBits”. The simple way of doing it add 0 at the end of the and ffff at the beginning of the “ObjectPointerBits” to complete 64bit pointer address.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*un95oAlI1_x7Ces9X3pbiw.png":{"__typename":"ImageMetadata","id":"1*un95oAlI1_x7Ces9X3pbiw.png","originalHeight":78,"originalWidth":558,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:342e9c948677_32":{"__typename":"Paragraph","id":"342e9c948677_32","name":"b87f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*un95oAlI1_x7Ces9X3pbiw.png"},"text":"Figure 9. Deriving a object_header address from ObjectPointerBits","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_33":{"__typename":"Paragraph","id":"342e9c948677_33","name":"4dba","type":"P","href":null,"layout":null,"metadata":null,"text":"I don’t know how it works but I could get the pointer to the object header by leftshift (\u003C\u003C4) and ORing the result with 0xffff000000000000. The derived hex number is a pointer to the object header. This is represented by _object_header structure.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_34":{"__typename":"Paragraph","id":"342e9c948677_34","name":"9e05","type":"P","href":null,"layout":null,"metadata":null,"text":"Now, let us enumerate the _object_header and get the to the _object_type to identify the type of object followed by this object_header.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*CrbN4X6jwZDf649v-6hq8g.png":{"__typename":"ImageMetadata","id":"1*CrbN4X6jwZDf649v-6hq8g.png","originalHeight":399,"originalWidth":601,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:342e9c948677_35":{"__typename":"Paragraph","id":"342e9c948677_35","name":"394d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*CrbN4X6jwZDf649v-6hq8g.png"},"text":"Figure 10. Enumerating a object_header","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*02cjaYNxUM8-Ni0uyJkb4Q.png":{"__typename":"ImageMetadata","id":"1*02cjaYNxUM8-Ni0uyJkb4Q.png","originalHeight":344,"originalWidth":601,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:342e9c948677_36":{"__typename":"Paragraph","id":"342e9c948677_36","name":"5041","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*02cjaYNxUM8-Ni0uyJkb4Q.png"},"text":"Figure 11. Mapping of the diagram and a debugger output — TypeIndex","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_37":{"__typename":"Paragraph","id":"342e9c948677_37","name":"87fa","type":"P","href":null,"layout":null,"metadata":null,"text":"As I said in the introduction of the article, Microsoft has made it more complex as they evolve with the operating systems. In earlier version of the Microsoft (like Windows 7) this TypeIndex is an index to the nt!ObTypeIndexTable,however, now this field does not refer to the direct index in to the ObType table. We need to derive the lookup index from the “TypeIndex” field and then use that index to lookup the type of the object in the nt!ObTypeIndexTable. To derive the lookup index from the: TypeIndex”, please perform following operations on the “TypeIndex”. We need to take the second least significant byte from the header. In our case,","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_38":{"__typename":"Paragraph","id":"342e9c948677_38","name":"4a35","type":"P","href":null,"layout":null,"metadata":null,"text":"object header is 0xffffa703`b2c47ae0 hence second least significant byte would be “7a”.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_39":{"__typename":"Paragraph","id":"342e9c948677_39","name":"8de6","type":"P","href":null,"layout":null,"metadata":null,"text":"TypeIndex value is 0x68","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*bu3AlGQ-zzMGmRV-ItGlIQ.png":{"__typename":"ImageMetadata","id":"1*bu3AlGQ-zzMGmRV-ItGlIQ.png","originalHeight":269,"originalWidth":514,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:342e9c948677_40":{"__typename":"Paragraph","id":"342e9c948677_40","name":"d410","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*bu3AlGQ-zzMGmRV-ItGlIQ.png"},"text":"Figure 12. Object_header & TypeIndex Values","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_41":{"__typename":"Paragraph","id":"342e9c948677_41","name":"1a17","type":"P","href":null,"layout":null,"metadata":null,"text":"Nt!ObHeaderCookie value is 0c","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*wLUR6K6EqM91paF1QDiECA.png":{"__typename":"ImageMetadata","id":"1*wLUR6K6EqM91paF1QDiECA.png","originalHeight":45,"originalWidth":297,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:342e9c948677_42":{"__typename":"Paragraph","id":"342e9c948677_42","name":"0540","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*wLUR6K6EqM91paF1QDiECA.png"},"text":"Figure 12. nt!ObHeaderCookie value","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_43":{"__typename":"Paragraph","id":"342e9c948677_43","name":"2fbf","type":"P","href":null,"layout":null,"metadata":null,"text":"To derive lookup index, we need to XOR all these 3 values.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*05zQ9S9ELSG1YzYkuxaNig.png":{"__typename":"ImageMetadata","id":"1*05zQ9S9ELSG1YzYkuxaNig.png","originalHeight":42,"originalWidth":432,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:342e9c948677_44":{"__typename":"Paragraph","id":"342e9c948677_44","name":"f747","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*05zQ9S9ELSG1YzYkuxaNig.png"},"text":"Figure 13. Deriving lookup index from TypeIndex value","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_45":{"__typename":"Paragraph","id":"342e9c948677_45","name":"fd8f","type":"P","href":null,"layout":null,"metadata":null,"text":"Please refer to this amazing article at the link https:\u002F\u002Fmedium.com\u002F@ashabdalhalim\u002Fa-light-on-windows-10s-object-header-typeindex-value-e8f907e7073a by Ashraf Abdalhalim to get more details about why we are doing this XOR to calculate the lookup index.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":49,"end":148,"href":"https:\u002F\u002Fmedium.com\u002F@ashabdalhalim\u002Fa-light-on-windows-10s-object-header-typeindex-value-e8f907e7073a","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":152,"end":158,"href":"https:\u002F\u002Fwww.linkedin.com\u002Fin\u002Fashabdalhalim\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":159,"end":169,"href":"https:\u002F\u002Ftwitter.com\u002FAshAbdalhalim","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_46":{"__typename":"Paragraph","id":"342e9c948677_46","name":"09ed","type":"P","href":null,"layout":null,"metadata":null,"text":"So, our lookup index is 1e. We can now enumerate object type by looking up in to the nt!ObTypeIndexTable.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*fvsyH_rV3ujlLw4_ZdUz3g.png":{"__typename":"ImageMetadata","id":"1*fvsyH_rV3ujlLw4_ZdUz3g.png","originalHeight":190,"originalWidth":601,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:342e9c948677_47":{"__typename":"Paragraph","id":"342e9c948677_47","name":"44c3","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*fvsyH_rV3ujlLw4_ZdUz3g.png"},"text":"Figure 14. Enumerating _object_type to get the object name\u002Ftype","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_48":{"__typename":"Paragraph","id":"342e9c948677_48","name":"c743","type":"P","href":null,"layout":null,"metadata":null,"text":"As we can see the object type is TpWorkerFactory.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*kXwu1IZabdRWh1-L2uCUAA.png":{"__typename":"ImageMetadata","id":"1*kXwu1IZabdRWh1-L2uCUAA.png","originalHeight":372,"originalWidth":602,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:342e9c948677_49":{"__typename":"Paragraph","id":"342e9c948677_49","name":"b8c1","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*kXwu1IZabdRWh1-L2uCUAA.png"},"text":"Figure 15. Mapping of the diagram with a debugger output — Name in _object_type","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_50":{"__typename":"Paragraph","id":"342e9c948677_50","name":"ac15","type":"P","href":null,"layout":null,"metadata":null,"text":"We can verify the same by enumerating the same handle through !handle in the windbg.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":62,"end":69,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*KRI8cgt3hPOUawIweiMB5w.png":{"__typename":"ImageMetadata","id":"1*KRI8cgt3hPOUawIweiMB5w.png","originalHeight":83,"originalWidth":601,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:342e9c948677_51":{"__typename":"Paragraph","id":"342e9c948677_51","name":"ef78","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*KRI8cgt3hPOUawIweiMB5w.png"},"text":"Figure 16. !handle output from debugger","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_52":{"__typename":"Paragraph","id":"342e9c948677_52","name":"3ac4","type":"P","href":null,"layout":null,"metadata":null,"text":"As expected, the all values are matching.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_53":{"__typename":"Paragraph","id":"342e9c948677_53","name":"b949","type":"P","href":null,"layout":null,"metadata":null,"text":"So, folks, we started with EPROCESS and reached to object_type by following cues provided by the various kernel structures. I hope you enjoy this reading.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_54":{"__typename":"Paragraph","id":"342e9c948677_54","name":"8cb3","type":"P","href":null,"layout":null,"metadata":null,"text":"That’s it for now, folks!! Happy hunting, fellas!!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:342e9c948677_55":{"__typename":"Paragraph","id":"342e9c948677_55","name":"4b4c","type":"BQ","href":null,"layout":null,"metadata":null,"text":"by :\nKirtar Oza\nTwitter : Krishna (@kirtar_oza)\nLinkedIn: https:\u002F\u002Fwww.linkedin.com\u002Fin\u002Fkirtaroza\u002F\nemail: kirtar.oza@gmail.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":26,"end":27,"href":"https:\u002F\u002Ftwitter.com\u002Fkirtar_oza","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":36,"end":46,"href":"https:\u002F\u002Ftwitter.com\u002Fkirtar_oza","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":58,"end":97,"href":"https:\u002F\u002Fwww.linkedin.com\u002Fin\u002Fkirtaroza\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":104,"end":124,"href":"mailto:kirtar.oza@gmail.com","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":5,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":16,"end":23,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":48,"end":56,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":97,"end":102,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Tag:dfir":{"__typename":"Tag","id":"dfir","displayTitle":"Dfir","normalizedTagSlug":"dfir"},"Tag:forensics":{"__typename":"Tag","id":"forensics","displayTitle":"Forensics","normalizedTagSlug":"forensics"},"Tag:cybersecurity":{"__typename":"Tag","id":"cybersecurity","displayTitle":"Cybersecurity","normalizedTagSlug":"cybersecurity"},"Tag:threat-hunting":{"__typename":"Tag","id":"threat-hunting","displayTitle":"Threat Hunting","normalizedTagSlug":"threat-hunting"},"Tag:memory-forensics":{"__typename":"Tag","id":"memory-forensics","displayTitle":"Memory Forensics","normalizedTagSlug":"memory-forensics"},"Post:2368187685e":{"__typename":"Post","id":"2368187685e","collection":null,"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"4267","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:342e9c948677_0"},{"__ref":"Paragraph:342e9c948677_1"},{"__ref":"Paragraph:342e9c948677_2"},{"__ref":"Paragraph:342e9c948677_3"},{"__ref":"Paragraph:342e9c948677_4"},{"__ref":"Paragraph:342e9c948677_5"},{"__ref":"Paragraph:342e9c948677_6"},{"__ref":"Paragraph:342e9c948677_7"},{"__ref":"Paragraph:342e9c948677_8"},{"__ref":"Paragraph:342e9c948677_9"},{"__ref":"Paragraph:342e9c948677_10"},{"__ref":"Paragraph:342e9c948677_11"},{"__ref":"Paragraph:342e9c948677_12"},{"__ref":"Paragraph:342e9c948677_13"},{"__ref":"Paragraph:342e9c948677_14"},{"__ref":"Paragraph:342e9c948677_15"},{"__ref":"Paragraph:342e9c948677_16"},{"__ref":"Paragraph:342e9c948677_17"},{"__ref":"Paragraph:342e9c948677_18"},{"__ref":"Paragraph:342e9c948677_19"},{"__ref":"Paragraph:342e9c948677_20"},{"__ref":"Paragraph:342e9c948677_21"},{"__ref":"Paragraph:342e9c948677_22"},{"__ref":"Paragraph:342e9c948677_23"},{"__ref":"Paragraph:342e9c948677_24"},{"__ref":"Paragraph:342e9c948677_25"},{"__ref":"Paragraph:342e9c948677_26"},{"__ref":"Paragraph:342e9c948677_27"},{"__ref":"Paragraph:342e9c948677_28"},{"__ref":"Paragraph:342e9c948677_29"},{"__ref":"Paragraph:342e9c948677_30"},{"__ref":"Paragraph:342e9c948677_31"},{"__ref":"Paragraph:342e9c948677_32"},{"__ref":"Paragraph:342e9c948677_33"},{"__ref":"Paragraph:342e9c948677_34"},{"__ref":"Paragraph:342e9c948677_35"},{"__ref":"Paragraph:342e9c948677_36"},{"__ref":"Paragraph:342e9c948677_37"},{"__ref":"Paragraph:342e9c948677_38"},{"__ref":"Paragraph:342e9c948677_39"},{"__ref":"Paragraph:342e9c948677_40"},{"__ref":"Paragraph:342e9c948677_41"},{"__ref":"Paragraph:342e9c948677_42"},{"__ref":"Paragraph:342e9c948677_43"},{"__ref":"Paragraph:342e9c948677_44"},{"__ref":"Paragraph:342e9c948677_45"},{"__ref":"Paragraph:342e9c948677_46"},{"__ref":"Paragraph:342e9c948677_47"},{"__ref":"Paragraph:342e9c948677_48"},{"__ref":"Paragraph:342e9c948677_49"},{"__ref":"Paragraph:342e9c948677_50"},{"__ref":"Paragraph:342e9c948677_51"},{"__ref":"Paragraph:342e9c948677_52"},{"__ref":"Paragraph:342e9c948677_53"},{"__ref":"Paragraph:342e9c948677_54"},{"__ref":"Paragraph:342e9c948677_55"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:c23376f92e3f"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fimphash.medium.com\u002Fwindows-process-internals-a-few-concepts-to-know-before-jumping-on-memory-forensics-part-5-a-2368187685e","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"programming"}],"isPublished":true,"latestPublishedVersion":"342e9c948677","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"createdAt":1599960770922,"firstPublishedAt":1599962573444,"latestPublishedAt":1599966304915,"clapCount":2,"allowResponses":true,"isLimitedState":false,"title":"Windows Process Internals: A few Concepts to know before jumping on Memory Forensics [Part 5] — A…","isSeries":false,"sequence":null,"uniqueSlug":"windows-process-internals-a-few-concepts-to-know-before-jumping-on-memory-forensics-part-5-a-2368187685e","socialTitle":"","socialDek":"","noIndex":null,"canonicalUrl":"","metaDescription":"","readingTime":6.618867924528303,"previewContent":{"__typename":"PreviewContent","subtitle":"In this series of articles of “Must know Process Internals for Memory Forensics” — we have traversed through ActiveProcessLinks…"},"previewImage":{"__ref":"ImageMetadata:1*B6zCphcdYAGGUKEulQe0uQ.png"},"isShortform":false,"seoTitle":"","updatedAt":1639609284884,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:dfir"},{"__ref":"Tag:forensics"},{"__ref":"Tag:cybersecurity"},{"__ref":"Tag:threat-hunting"},{"__ref":"Tag:memory-forensics"}],"isNewsletter":false,"statusForCollection":null,"pendingCollection":null,"detectedLanguage":"en","wordCount":1330,"layerCake":0}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"MISS"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.3cc5e3b6.js"></script><script src="https://cdn-client.medium.com/lite/static/js/2640.3217006c.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.7db0aaff.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.4ddbf12e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.2021fe63.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4398.db4d4378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7883.0e445e04.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9281.e9be8bce.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7111.b294e9da.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6481.362dec70.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8695.6f58679b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8978.4b110123.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3418.eb013b5a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3894.e3d01e2c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5514.32e692f6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5203.e7f058c5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7098.93054372.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8051.0a9d3f4b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8558.abbaadfd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1711.7605eb3e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8597.762eae49.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9174.b1b0f607.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8883.2f95bbf4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/705.e5898c57.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2911.d072adec.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8580.feeb2549.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6046.f9be485b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/500.d5389c14.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9408.22b56993.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6605.84e81b15.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6637.661bd7cf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7421.3f94f5ea.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/51.d8fb2684.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2133.c8ba56b1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.81dff084.chunk.js"></script><script>window.main();</script><script defer="" src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon="{&quot;rayId&quot;:&quot;89424b23dad7b329&quot;,&quot;version&quot;:&quot;2024.4.1&quot;,&quot;token&quot;:&quot;0b5f665943484354a59c39c6833f7078&quot;}" crossorigin="anonymous"></script>
<div><div class="su n wm wn rx wo wp wq wr ws wt wu wv ww wx ce bm wy wz xa lc xb xc"><div class="bc b ds z vh"><div class="ab cm xd xe"><div class="l" role="alert">To make Medium work, we log user data. By using Medium, you agree to our <a class="af ag ah ai aj ak al am an ao ap xf xg np" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9" rel="noopener follow" target="_blank">Privacy Policy</a>, including cookie policy.</div><div class="xh nk xi xj xk xl l xm iu xn"><div class="l fg n tl"><button class="af ag ah ai aj ak al am an ao ap xf xg xo xp ab" data-testid="close-button" aria-label="close"><svg width="19" height="19" viewBox="0 0 19 19" class="em el"><path d="M13.8 4.6L9.5 8.89 5.21 4.6l-.61.61 4.29 4.3-4.29 4.28.61.62 4.3-4.3 4.28 4.3.62-.62-4.3-4.29 4.3-4.29" fill-rule="evenodd"></path></svg></button></div></div></div></div></div></div></body></html>