<html lang="en"><head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#111111">


<title>Getting Started with Exploit Development</title>


<meta property="og:locale" content="en_US">
<meta name="description" content="tl;dr The rest of this goes into detail about what topics matter and why from each resource, but if you want to cut to the chase and ignore that...


 * Prerequisites
   
   * C programming language
   * x86 Assembly (32bit and 64bit)
   * Linux terminal usage
   
 * Exploit Education - Nebula - Start thinking like an attacker and learning to do research
 * Open Security Training - Introduction to Software Exploitation - Fundamentals of memory corruption
 * Pwn College - (Added July 2022) An alt">
<meta name="og:description" content="tl;dr The rest of this goes into detail about what topics matter and why from each resource, but if you want to cut to the chase and ignore that...


 * Prerequisites
   
   * C programming language
   * x86 Assembly (32bit and 64bit)
   * Linux terminal usage
   
 * Exploit Education - Nebula - Start thinking like an attacker and learning to do research
 * Open Security Training - Introduction to Software Exploitation - Fundamentals of memory corruption
 * Pwn College - (Added July 2022) An alt">
<meta name="title" content="Getting Started with Exploit Development">
<meta property="og:title" content="Getting Started with Exploit Development">
<meta name="og:type" content="article">

<meta name="og:article:published_time" content="2021-02-02">
<meta name="og:article:tag" content="blog">
<meta name="og:image" content="https://dayzerosec.com/images/zero_square.png">
<meta property="og:site_name" content="DAY[0]">

<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/images/favicon.96.png">
<link rel="icon" type="image/png" sizes="76x76" href="/images/favicon.76.png">
<link rel="icon" type="image/png" sizes="152x152" href="/images/favicon.152.png">
<link rel="icon" type="image/png" sizes="120x120" href="/images/favicon.120.png">
<link rel="icon" type="image/png" sizes="167x167" href="/images/favicon.167.png">
<link rel="icon" type="image/png" sizes="180x180" href="/images/favicon.180.png">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@latest/normalize.css">
<link rel="stylesheet" href="/css/main.css">
<link href="https://fonts.googleapis.com/css?family=Source Code Pro" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
<link rel="stylesheet" href="/css/nord.css">
</head>
<body>
<div class="flex-container full-width center">
  <div class="side-nav" id="top">
  <div class="logo">
  <video autoplay="" muted="" loop="">
    <source src="/images/GlitchedZero.tiny.webm" type="video/webm">
    <source src="/images/GlitchedZero.tiny.mp4" type="video/mp4">
  </video>
  </div>
  <nav class="item-list">
    <div class="main-menu">
      <a href="/"><div class="item">Home</div></a>
      <a href="/blog/"><div class="item">Blog</div></a>
      <a href="/podcast/"><div class="item">Podcast</div></a>
      <a href="/vulns/"><div class="item">Vulns</div></a>
      <a href="/about.html"><div class="item">About Us</div></a>
      <a href="/contact.html"><div class="item">Contact</div></a>
    </div>

    <div class="social-menu">
      <a href="https://twitch.tv/dayzerosec"><div class="item twitch"><img src="/images/social/twitch.png"><span>Twitch</span></div></a>
      <a href="https://youtube.com/c/dayzerosec"><div class="item youtube"><img src="/images/social/youtube.png"><span>Youtube</span></div></a>
      <a href="https://twitter.com/dayzerosec"><div class="item twitter"><img src="/images/social/twitter.png"><span>Twitter</span></div></a>
      <a href="https://discord.gg/daTxTK9"><div class="item discord"><img src="/images/social/discord.png"><span>Discord</span></div></a>
      <a href="https://github.com/dayzerosec"><div class="item github"><img src="/images/social/github.png"><span>Github</span></div></a>
      <a href="https://anchor.fm/dayzerosec"><div class="item anchor"><img src="/images/social/listen.png"><span>Listen</span></div></a>
      <a href="/feed.xml"><div class="item rss"><img src="/images/social/rss.png"><span>RSS Feed</span></div></a>
    </div>
  </nav>
</div>
  <main class="main-content">
  	<article class="post-content">
  		
  			<div class="meta">
					<time datetime="">02 February 2021</time>
					<div>10 minute read.</div>
				</div>
				<header>
	        <h2 class="title">Getting Started with Exploit Development</h2>
	        <div class="tags">
	          
	            
	            <a href="/tags/low-level">low-level</a>
	            
	          
	        </div>
	      </header>
				<div class="flex-container row space-between">
					<div class="authors">zi</div>
				</div>
		
		<div class="content">
			
			
			
			
<h3></h3><p><strong>tl;dr</strong> The rest of this goes into detail about what topics matter and why from each resource, but if you want to cut to the chase and ignore that...</p>
<ul>
<li>Prerequisites
<ul>
<li>C programming language</li>
<li>x86 Assembly (32bit and 64bit)</li>
<li>Linux terminal usage</li>
</ul>
</li>
<li><a href="https://exploit.education/nebula/?ref=dayzerosec.com">Exploit Education - Nebula</a> - Start thinking like an attacker and learning to do research</li>
<li><s><a href="https://opensecuritytraining.info/Exploits1.html?ref=dayzerosec.com">Open Security Training - Introduction to Software Exploitation</a> - Fundamentals of memory corruption</s></li>
<li><a href="https://pwn.college/?ref=dayzerosec.com">Pwn College</a> - (Added July 2022) An alternative place to learn the fundamentals of software exploitation.</li>
<li><a href="https://exploit.education/phoenix/?ref=dayzerosec.com">Exploit Education - Phoenix</a> - Practice the fundamentals in 32bit and 64bit</li>
<li><a href="https://pwn.college/modules/memory?ref=dayzerosec.com">Pwn College - Module: Memory Errors</a> - Explore more classes of vulnerabilities and learn about more recent mitigations</li>
<li><a href="https://exploit.education/fusion/?ref=dayzerosec.com">Exploit Education - Fusion</a> - Practice the above and a bit of reverse engineering/testing</li>
<li><a href="https://ropemporium.com/index.html?ref=dayzerosec.com">ROP Emporium</a> - One of the most common exploitation techniques used today</li>
<li>Weird Machines - This is to get the metal shift and understand how to reason about modern exploits
<ul>
<li><a href="https://www.youtube.com/watch?v=8Dcj19KGKWM&amp;ref=dayzerosec.com">LiveOverflow - Introducing Weird Machines: ROP Differently Explaining part 1</a></li>
<li><a href="https://www.youtube.com/watch?v=zaQVNM3or7k&amp;ref=dayzerosec.com">LiveOverflow - Weird Return-Oriented Programming Tutorial</a></li>
<li><a href="https://ieeexplore.ieee.org/document/8226852?ref=dayzerosec.com">Weird Machines, Exploitability, and Provable Unexploitability</a></li>
</ul>
</li>
<li><a href="https://github.com/guyinatuxedo/nightmare?ref=dayzerosec.com">Nightmare</a> - Final practice.</li>
</ul>
<hr>
<h1 id="what-is-exploit-development">What is Exploit Development?</h1><p>As usual within the security industry, the terms are made up and no one uses them consistently. Exploit development as it is used here is about the development of scripts or programs that can take advantage of (exploit) memory corruption vulnerabilities in software.</p><p>This is opposed to exploits that might take advantage of higher-level vulnerabilities such as those seen in general application security such as web-applications or mobile applications.</p><h1 id="prerequisites">Prerequisites</h1><p>There are three things you need to know before getting started.</p><p><strong>The C programming language</strong>. The thing about learning C is not that you're going to have to do a lot of programming in it, but rather in learning C you also gain a mental model of how software works. C doesn't attempt to hide most of the memory management from you, neither does it do magic like garbage collection in the background. It's important if you're going to learn about exploiting memory corruption vulnerabilities that you understand how software uses memory.</p><p>There is a really good blog post by Evan Millar <a href="https://www.evanmiller.org/you-cant-dig-upwards.html?ref=dayzerosec.com">You Can't Dig Upwards</a> which is a defense of learning C as your first language. While I don't necessarily agree, he does an excellent job of describing why learning C matters, and how it enables you to understand the layers of abstraction in most software.</p><p>As a general rule of thumb, when you want to attack anything, the first step is to understand how it works.</p><p><strong>An assembly language.</strong> This is a tricky one that newcomers sometimes take the wrong path on. You don't need to be able to program in assembly, and you shouldn't follow tutorials for programmers about writing assembly. Programmers can make use of compilers and assemblers to turn their hand-written assembly code into machine language (the code understood by the CPU). This gives access to things like named variables and labels, fake instructions, and other high-level concepts that are not reflected in the machine code.</p><p>What's more important is the ability to read what I'd call "raw" assembly. That is, take some compiled instructions, run them through a disassembler and read those instructions. This may be strange at first as you won't have the high-level type information and constructs you're used to, but it's important to understand what the CPU executes under the hood.</p><p>The most important concepts to understand for exploiting memory corruption issues are:</p><ul><li>Registers and how they are used</li><li>Calling conventions for functions and syscalls</li><li>Memory segmentation</li><li>How high-level types translate to raw bytes. In assembly, there are no special "types", as it's all just bytes in memory or registers</li></ul><p><strong>Basic Linux Usage.</strong> Just get comfortable using a Linux terminal, a lot of the resources recommended here will involve Linux. </p><h1 id="environment">Environment</h1><p>The classic question is what operating system to use. The truth is that it doesn't matter, use what you are comfortable with. You should learn to be comfortable with a Linux terminal, but for your host system don't worry about it.</p><p>This is a bit of a pet peeve of mine, but you don't gain much by starting on your target platform. A lot of the generic concepts apply no matter what operating system you're targeting. You start by learning your fundamentals and then you learn specific applications that are operating system specific. The idea of a write-primitive isn't unique to just Linux or Android exploitation, but what you actually write to turn your write-primitive into say a local privileges escalation will be OS-dependent. You can learn about various code-reuse attacks like return-oriented programming, the basic idea of which doesn't change, but you'll utilize it differently depending on the OS.</p><p>With that in mind, many of the resources that will be recommended are Linux-focused. There are a handful of reasons for that, from the ease of sharing a consistent Linux environment for training to the lack of smaller mitigations that exist on other platforms. Trust me, you'll have no problem transferring knowledge from one operating system to another.</p><h1 id="getting-started">Getting Started</h1><h3 id="exploit-education-nebula"><a href="https://exploit.education/nebula/?ref=dayzerosec.com">Exploit Education - Nebula</a></h3><p>In Nebula you are <strong>learning to think like an attacker and do research.</strong> This box isn't actually about exploit development, but more general application security. I like recommending it though because it forces you to start doing some research on topics you might not be familiar with to determine what the vulnerability being showcased is. It gives you enough information to get started. While this might feel annoying, this ability to research and digest information about a new topic is a huge part of exploit development. I spend more time reading documentation and other write-ups than I do writing exploit code. The ability to do research and persevere is immensely important.</p><p>You will find yourself going down dead-ends, doing research that doesn't pan out, thinking you're wasting hours of time, and that's okay. You need to learn to embrace that frustration as it's a key part of exploitation. Every dead end you go down doesn't help you immediately, but as you keep doing it you're building up a huge personal knowledge base that you'll eventually start drawing on as time goes on. Learn to enjoy the rabbit holes and don't worry about the wasted time.</p><h3 id="open-security-training-introduction-to-software-exploitation"><a href="https://opensecuritytraining.info/Exploits1.html?ref=dayzerosec.com">Open Security Training - Introduction to Software Exploitation</a></h3><p><strong>Update (July 2022)</strong>: Over the last year, as I've recommended resources, I've come to realize that a lot of bit-rot has occured with the OST course above. While I believe the content top-notch and it strikes a really good balance for beginners. Its quite a hassle to run the VM and work along with the course. So I've started recommending more segments from <a href="https://pwn.college/?ref=dayzerosec.com">Pwn.College</a>. While I don't entirely like the flow of pwn.college it has two huge benefits going for it. It has a <em>ton</em> of labs to practice on for every topic, and all the labs can be completed from within your browser inside its provided workspace. Making it far more accessible and usable than the OST course. </p><p><strong>Introduction to Software Exploitation</strong> is a lab-driven course by Corey Kallenberg. As such, the labs are useful for learning fundamental concepts when it comes to exploitation, so when the labs come up in the videos, don't skip them, pause and do them yourself.</p><p>There are a few basic concepts that this course covers:</p><ul><li>Shellcoding and Calling conventions</li><li>Buffer Overflows (stack and heap)</li><li>Arbitrary Write (format string attack)</li></ul><p>Don't worry about the fact it uses a pretty old Linux distro, you're not going to be pulling off most of these attacks as they are in the course today. But the basic idea of a write-primitive, or overflowing a buffer and overwriting nearby data is still relevant.</p><h2 id="pwn-college"><a href="https://pwn.college/?ref=dayzerosec.com">Pwn College</a></h2><p>This is a lab driven course from Arizona State University. It is a proper undergraduate course and taught by Zardus (Yan Shoshitaishvili) and kanak (Connor Nelson). You've got lectures on their Youtube channel, while the class is running, the classes are streamed live on Twitch, and the discord server is active. They've also been updating the course every year, so by the time you read it, it might be slightly different. As a course it is not quite a drop-in for the topics covered by the OST course it "replaces" here. The core topics to learn here would be:</p><ul><li>Assembly and Shellcoding</li><li>Interacting with Software</li><li>Debugging</li><li>Memory Errors</li></ul><p>While the entire course is valuable, you can consider stopping once the course gets into the topic of "Return Oriented Programming" (ROP) and doing the next couple of resources. Then returning to this course afterwards to learn ROP and some of the more advanced topics. The OST course assumes some basic knowledge of heap exploitation which isn't covered up to this point in Pwn College (its covered after ROP) but may be useful to know for some of the next resources.</p><p>Also, at least in 2020 and 2021 the course had a ton of repetitive feeling labs. There is some benefit to the repetition which I think is what they are going for, framing it kinda like a martial art and practicing the concepts, but don't feel too pressured to keep going on one topic if its getting really tedious and boring.</p><h3 id="exploit-education-phoenix"><a href="https://exploit.education/phoenix/?ref=dayzerosec.com">Exploit Education - Phoenix</a></h3><p>Now you're going to take the concepts you learned in the previous course and put them into practice a bit. You should start with the 32bit x86 version of Phoenix. Then <strong>move onto 64bit exploits</strong> on the AMD64 version of Phoenix.</p><p>Many of the challenges will be largely the same, but you'll start getting exposed to the differences between 32bit and 64bit x86 exploitation. There are some fundamental problems you'll run into. Again this will involve some of your own research as you learn about those differences.</p><h1 id="bypassing-exploit-mitigations">Bypassing Exploit Mitigations</h1><p>So the type of exploitation covered so far is essentially the stuff we did in the early 2000s. Since that time, several exploit mitigations have been introduced. <s>Three</s> Four of which have attained significant popularity:</p><ul><li>Stack Canaries/Cookies - This blocks you from overwriting the stored return address on the stack by placing a canary value on the stack before the saved return address. This canary is checked before returning and if it's modified then the program dies.</li><li>Data Execution Prevention (No-eXecute Bit) - In the previous sections, you wrote shellcode into memory and then jumped to it to get code execution. This is no longer possible on modern systems due to Data Execution Prevention, also known as DEP or NX. This mitigation ensures that a page can be Writable but not eXecutable, or eXecutable and not Writable.</li><li>Address Space Layout Randomization (ASLR) - Previously when you wrote your shellcode into memory you could do so in a roughly consistent location. Now the address space gets randomized, so even if you can control the program control flow, you don't know where direct it to.</li><li>Position Independent Executables/Code (PIE/PIC) - ASLR can easily randomize the location of some memory segments like the stack and heap. Moving segments containing code around requires that code be compiled as position independent. For awhile this left significant room for attackers to bypass ASLR simply by reusing code in shared libraries or within the main executable which wouldn't be randomized. Now almost all shared libraries will be compiled as PIC which severely reduces that attack surface, and sensitive executables such as those exposed on the network will be compiled with PIE.</li></ul><h3 id="pwn-college-module-memory-errors"><a href="https://pwn.college/modules/memory?ref=dayzerosec.com">Pwn College - Module: Memory Errors</a></h3><p><strong>Update (July 2022)</strong> - If you did Pwn College instead of OST then you should have already done this section and can go right on to the next resource :D</p><p>Pwn College is an awesome resource for more modern exploitation. In particular, I'm linking just a few of the lectures that cover <strong>dealing with some common mitigations.</strong> This module in particular you can probably skip the first three lectures. But the following lectures linked on the page are worth checking out:</p><ul><li>Causes of Corruption 1 and 2</li><li>Stack Canary Mitigations</li><li>ASLR Mitigations</li><li>Causes of Disclosure</li><li>Shellcoding: Data Execution Prevention</li></ul><p>If you're motivated there is a ton more content in pwn college to check out too.</p><h3 id="exploit-education-fusion"><a href="https://exploit.education/fusion/?ref=dayzerosec.com">Exploit Education - Fusion</a></h3><p>Now that you've got a bit more knowledge about mitigations, it's time to put that into practice <s>also</s>. The Fusion box is also going to get you doing a bit more reverse engineering and testing for vulnerabilities than you had to do for Nebula or Phoenix. Its also going to introduce all of the above mitigations for you to play around with.</p><h3 id="rop-emporium"><a href="https://ropemporium.com/index.html?ref=dayzerosec.com">ROP Emporium</a></h3><p>This is what I would consider the last of the beginner concepts, <strong>return-oriented programming (ROP).</strong> ROP is a very common exploitation technique, most exploits today tend to utilize ROP at some stage in the chain.</p><p>You'll probably find it easier to work through ROP Emporium on 32bit but do go back and do it on 64bit because things do change substantially with the different calling conventions.</p><h3 id="weird-machines">Weird machines</h3><p>Weird machines also touches on ROP, but it focuses more on how to think about ROP. It is more of a meta-topic I guess. A lot of recent exploit write-ups tend to talk about exploitation in terms of gadgets and primitives being obtained, but these terms won't be familiar to you if you're new to ROP. It's a bit of a mental shift away from talking about the specific exploit technique, so you need to familiarize yourself with it. You might just naturally get it, but I wanted to should out a couple of videos from LiveOverflow where he explains the concept:</p><ul><li><a href="https://www.youtube.com/watch?v=8Dcj19KGKWM&amp;ref=dayzerosec.com">https://www.youtube.com/watch?v=8Dcj19KGKWM</a></li><li><a href="https://www.youtube.com/watch?v=zaQVNM3or7k&amp;ref=dayzerosec.com">https://www.youtube.com/watch?v=zaQVNM3or7k</a></li></ul><p>This is a tricky concept to explain, but you'll start to understand it intuitively with experience. There is a solid paper on the topic of weird machines and exploitability which is also an interesting read.</p><ul><li><a href="https://ieeexplore.ieee.org/document/8226852?ref=dayzerosec.com">Weird Machines, Exploitability, and Provable Unexploitability</a></li></ul><h3 id="nightmare"><a href="https://github.com/guyinatuxedo/nightmare?ref=dayzerosec.com">Nightmare</a></h3><p>So Nightmare has a ton of challenges for you to practice on. In particular, I want to call out the Heap Exploitation section. While heap exploitation is one of those areas that is particular to each operating system (and each heap implementation). I think there is significant value in learning about the ptmalloc2 allocator and its attacks. You might not find yourself using them, but at least for me, <a href="http://phrack.org/issues/66/10.html?ref=dayzerosec.com">Malloc des-Maleficarum</a> was a huge eye-opener for the creativity and art of exploitation.</p><p>What you gain by running through the heap exploitation is less about memorizing all the different techniques that have been found to attack ptmalloc but more just a sense of how you can creatively apply control of certain pieces of data. So I'd highly recommend running through the heap challenges on nightmare.</p><h1 id="final-notes">Final Notes</h1><p>At this point, you have a lot of the basic concepts that you'll need to start looking at modern exploits, and hopefully the research skill to start discovering what you don't yet know you don't know. </p><p>We do plan to put out another part to this post covering how to bridge the gap from these CTFs and toy binaries to real-world exploitation soon.</p><p>For now, I'll just say that one of the biggest mistakes I see people make is they wait until they feel ready. <strong>Don't wait, just dive in and learn as you go. </strong>This is especially important when it comes to the process of discovering vulnerabilities (which I haven't touched on at all here) as a big part of that is building an intuition which just takes time.</p>
			
  		
		</div>
	</article>
  </main>
</div>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/components/prism-core.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js"></script>

</body></html>