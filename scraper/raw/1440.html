<html lang="en-gb" class="js"><head>
<meta charset="UTF-8">
<meta http-equiv="cache-control" content="no-cache"> 
<meta http-equiv="expires" content="0"> 
<meta http-equiv="pragma" content="no-cache">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AADInternals.com</title>
<meta name="description" content="The toolkit for Azure AD hackers, bounty hunters, red/blue teamers">
<meta name="generator" content="Hugo 0.39">
<meta property="og:title" content="AADInternals.com">
<meta property="og:description" content="The toolkit for Azure AD hackers, bounty hunters, red/blue teamers">
<meta property="og:type" content="website">
<meta property="og:url" content="https://aadinternals.com/">



<meta property="og:updated_time" content="2024-01-13T00:00:00+00:00">










<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link rel="dns-prefetch" href="//fonts.gstatic.com">
<link rel="alternate" type="application/rss+xml" title="AADInternals.com Feed" href="https://aadinternals.com/index.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,700" type="text/css" media="all">
<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">
<link rel="stylesheet" href="/css/style.css" type="text/css" media="all">
<script type="text/javascript" src="/js/scripts.js"></script>
<script type="text/javascript" src="/js/tools.js"></script>

<link rel="icon" type="image/png" href="/images/favicon-196x196.png" sizes="196x196">
<link rel="icon" type="image/png" href="/images/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/images/favicon-128.png" sizes="128x128">
<meta name="application-name" content="&nbsp;">
<meta name="msapplication-TileColor" content="#FFFFFF">
<meta name="msapplication-TileImage" content="/images/mstile-144x144.png">
<meta name="msapplication-square70x70logo" content="/images/mstile-70x70.png">
<meta name="msapplication-square150x150logo" content="/images/mstile-150x150.png">
<meta name="msapplication-wide310x150logo" content="/images/mstile-310x150.png">
<meta name="msapplication-square310x310logo" content="/images/mstile-310x310.png">




<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-3XCVLYZKDW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-3XCVLYZKDW');
</script>

</head>
<body class="body body-right-sidebar mobile" itemscope="itemscope" itemtype="http://schema.org/WebPage">
	<div class="container container-outer">
		<header class="header" itemscope="itemscope" itemtype="http://schema.org/WPHeader">
		
			<div class="container container-inner clearfix">
			
				<div class="logo" role="banner" itemscope="itemscope" itemtype="http://schema.org/Brand">
				
					<a class="logo__link" href="/" title="AADInternals.com" rel="home">
						<img src="/images/favicon-128.png" alt="Homepage"><h1 class="logo__title">AADInternals.com</h1>
						<h2 class="logo__tagline">The ultimate Entra ID (Azure AD) / Microsoft 365 hacking and admin toolkit</h2>
					</a>
				</div>
			</div>
			
<a href="#" class="menu__toggle" aria-hidden="true">Menu</a><nav class="menu menu--collapse menu--collapse-0 closed" itemscope="itemscope" itemtype="http://schema.org/SiteNavigationElement" style="transition: max-height 284ms; position: relative;" aria-hidden="false">
	<ul class="menu__list">
		<li class="menu__item "><a class="menu__link" href="/aadkillchain/">AAD KILL CHAIN</a></li>
		<li class="menu__item "><a class="menu__link" href="/aadinternals/">DOCUMENTATION</a></li>
		<li class="menu__item "><a class="menu__link" href="/links/">LINKS</a></li>
		<li class="menu__item "><a class="menu__link" href="/osint/">OSINT</a></li>
		<li class="menu__item "><a class="menu__link" href="/talks/">TALKS</a></li>
		<li class="menu__item "><a class="menu__link" href="/tools/">TOOLS</a></li>
	</ul>
</nav>

		</header>
		<div class="wrapper clearfix">

	<main class="main-content list content" role="main"><article class="list__item post clearfix">
	<figure class="list__thumbnail">
		<a href="https://aadinternals.com/post/dcaas/">
			<img src="/images/posts/dcaas.png" alt="Exfiltrating NTHashes by abusing Microsoft Entra Domain Services">
		</a>
	</figure>
	<div class="list__content clearfix">
		<header class="list__header">
			<h3 class="list__title post__title ">
				<a href="/post/dcaas/" rel="bookmark">Exfiltrating NTHashes by abusing Microsoft Entra Domain Services</a>
			</h3>
			<div class="list__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"></path></svg>
				<time class="list__meta-date" datetime="2024-01-13T00:00:00">January 13, 2024</time>
					<time class="list__meta-lastmod" datetime="2024-01-14T00:00:00"> (Last Modified: January 14, 2024)</time>
			</div>
		</header>
		<div class="list__excerpt">
			<p>Last year I gave a presentation titled <a href="https://troopers.de/troopers23/talks/ywstkv/" target="_blank">Dumping NTHashes from Azure AD</a> at TROOPERS conference.
The talk was about how the <a href="https://azure.microsoft.com/en-gb/products/microsoft-entra-ds" target="_blank">Microsoft Entra Domain Services</a> (formerly Azure AD Domain Services) works and how it enabled dumping NTHashes from Entra ID (formerly Azure AD).<br><br></p>

<p>In this blog, I’ll show how Microsoft Entra Domain Services (MEDS) can be (ab)used to exfiltrate NTHashes from on-prem Active Directory.</p>

<p></p>
		</div>
	</div>
</article>
<article class="list__item post clearfix">
	<figure class="list__thumbnail">
		<a href="https://aadinternals.com/post/dosingaad/">
			<img src="/images/posts/dosing_aad.png" alt="DoSing Azure AD">
		</a>
	</figure>
	<div class="list__content clearfix">
		<header class="list__header">
			<h3 class="list__title post__title ">
				<a href="/post/dosingaad/" rel="bookmark">DoSing Azure AD</a>
			</h3>
			<div class="list__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"></path></svg>
				<time class="list__meta-date" datetime="2023-07-02T00:00:00">July 02, 2023</time>
			</div>
		</header>
		<div class="list__excerpt">
			<p>My recent talk at the great <a href="https://t2.fi/schedule/2023/#speech9" target="_blank">T2</a> conference on DoSing Azure AD gained a lot of attention.
Unfortunately, the talk was not recorded, so I decided to write a blog for those who couldn’t attend. So here we go!</p>

<p></p>
		</div>
	</div>
</article>
<article class="list__item post clearfix">
	<figure class="list__thumbnail">
		<a href="https://aadinternals.com/post/demousers/">
			<img src="/images/posts/demousers.png" alt="Deploying users with pre-registered MFA">
		</a>
	</figure>
	<div class="list__content clearfix">
		<header class="list__header">
			<h3 class="list__title post__title ">
				<a href="/post/demousers/" rel="bookmark">Deploying users with pre-registered MFA</a>
			</h3>
			<div class="list__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"></path></svg>
				<time class="list__meta-date" datetime="2023-05-23T00:00:00">May 23, 2023</time>
					<time class="list__meta-lastmod" datetime="2023-05-24T00:00:00"> (Last Modified: May 24, 2023)</time>
			</div>
		</header>
		<div class="list__excerpt">
			<p>A couple of weeks ago a friend of mine asked would it be possible to pre-register MFA for users in Azure AD. For short, yes it is!</p>

<p>In this blog, I’ll show how to pre-register <a href="https://learn.microsoft.com/en-us/azure/active-directory/authentication/concept-authentication-oath-tokens" target="_blank">OTP</a> and SMS MFA methods using <strong>AADInternals</strong>’ <a href="/aadinternals/#register-aadintmfaapp-my" target="_blank">Register‑AADIntMFAApp</a> and <a href="/aadinternals/#set-aadintusermfa-a" target="_blank">Set‑AADIntUserMFA</a>.</p>

<p></p>
		</div>
	</div>
</article>
<article class="list__item post clearfix">
	<figure class="list__thumbnail">
		<a href="https://aadinternals.com/post/local_admin_to_gmsa/">
			<img src="/images/posts/gmsa_poc.png" alt="Elevation of Privilege from Local Admin to gMSA">
		</a>
	</figure>
	<div class="list__content clearfix">
		<header class="list__header">
			<h3 class="list__title post__title ">
				<a href="/post/local_admin_to_gmsa/" rel="bookmark">Elevation of Privilege from Local Admin to gMSA</a>
			</h3>
			<div class="list__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"></path></svg>
				<time class="list__meta-date" datetime="2023-01-23T00:00:00">January 23, 2023</time>
			</div>
		</header>
		<div class="list__excerpt">
			<p>In my previous <a href="/post/gmsa" target="_blank">blog post</a> I explained how Group Managed Service Accounts (gMSA) passwords are stored locally on the servers.
In this blog, I’ll share how you can easily elevate yourself from the local administrator to gMSA without a need to know the account password.</p>

<p>I’m already using this technique in <a href="https://github.com/Gerenios/AADInternals/blob/master/ADFS.ps1#L1473" target="_blank">AADInternals</a> to execute code as AD FS service account.</p>

<p></p>
		</div>
	</div>
</article>
<article class="list__item post clearfix">
	<figure class="list__thumbnail">
		<a href="https://aadinternals.com/post/ests/">
			<img src="/images/posts/bypasshometenant.png" alt="Bypassing Azure AD home tenant MFA and CA">
		</a>
	</figure>
	<div class="list__content clearfix">
		<header class="list__header">
			<h3 class="list__title post__title ">
				<a href="/post/ests/" rel="bookmark">Bypassing Azure AD home tenant MFA and CA</a>
			</h3>
			<div class="list__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"></path></svg>
				<time class="list__meta-date" datetime="2022-11-08T00:00:00">November 08, 2022</time>
					<time class="list__meta-lastmod" datetime="2022-11-13T00:00:00"> (Last Modified: November 13, 2022)</time>
			</div>
		</header>
		<div class="list__excerpt">
			<p><a href="https://learn.microsoft.com/en-us/azure/active-directory/authentication/concept-mfa-howitworks" target="_blank">Multi-factor Authentication</a> (MFA) and <a href="https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/overview" target="_blank">Conditional Access</a> (CA) policies are powerful tools to protect Azure AD users’ identities.
For instance, one may allow access only from compliant devices and require MFA from all users.<br><br></p>

<p>However, because of Azure AD authentication platform architecture, <strong>users can bypass home tenant MFA and CA policies</strong> when logging in directly to resource tenants.<br><br></p>

<p>This blog post tries to shed some light on how Azure AD authentication works under-the-hood.
We’ll introduce the issue, describe how to exploit it, show how to detect exploitation, and finally, how to prevent the exploitation.</p>

<p>The blog is co-authored with <a href="https://twitter.com/SravanAkkaram" target="_blank">@SravanAkkaram</a> and is based on his findings.
</p>
		</div>
	</div>
</article>
<article class="list__item post clearfix">
	<figure class="list__thumbnail">
		<a href="https://aadinternals.com/post/pta/">
			<img src="/images/posts/pta_00.png" alt="Exploiting Azure AD PTA vulnerabilities: Creating backdoor and harvesting credentials">
		</a>
	</figure>
	<div class="list__content clearfix">
		<header class="list__header">
			<h3 class="list__title post__title ">
				<a href="/post/pta/" rel="bookmark">Exploiting Azure AD PTA vulnerabilities: Creating backdoor and harvesting credentials</a>
			</h3>
			<div class="list__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"></path></svg>
				<time class="list__meta-date" datetime="2022-09-20T00:00:00">September 20, 2022</time>
					<time class="list__meta-lastmod" datetime="2022-11-05T00:00:00"> (Last Modified: November 05, 2022)</time>
			</div>
		</header>
		<div class="list__excerpt">
			<p>In 13 September 2022, <a href="https://www.secureworks.com/">Secureworks</a> published a Threat Analysis: <a href="https://www.secureworks.com/research/azure-active-directory-pass-through-authentication-flaws" target="_blank">Azure Active Directory Pass-Through Authentication Flaws</a>.
The vulnerabilities discovered by our team allows threat actors to gain persistent and undetected access to the target Azure AD tenant.<br><br>
In this blog post, I’ll show how the attack can be conducted using <a href="/aadinternals" target="_blank">AADInternals</a> and standalone Windows server.
</p>
		</div>
	</div>
</article>
<article class="list__item post clearfix">
	<figure class="list__thumbnail">
		<a href="https://aadinternals.com/post/gmsa/">
			<img src="/images/posts/gmsa.png" alt="Hunt for the gMSA secrets">
		</a>
	</figure>
	<div class="list__content clearfix">
		<header class="list__header">
			<h3 class="list__title post__title ">
				<a href="/post/gmsa/" rel="bookmark">Hunt for the gMSA secrets</a>
			</h3>
			<div class="list__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"></path></svg>
				<time class="list__meta-date" datetime="2022-08-29T00:00:00">August 29, 2022</time>
			</div>
		</header>
		<div class="list__excerpt">
			<p>Group Managed Service Accounts (gMSA’s) can be used to run Windows services over multiple servers within the Windows domain.
<br>
<br>
Since the launch of Windows Server 2012 R2, gMSA has been the recommended service account option for AD FS.
As abusing AD FS is one of my favourite hobbies, I wanted to learn how gMSAs work.</p>

<p></p>
		</div>
	</div>
</article>
<article class="list__item post clearfix">
	<figure class="list__thumbnail">
		<a href="https://aadinternals.com/post/august_2022/">
			<img src="/images/posts/august2022.png" alt="AADInternals World Tour August 2022: USA">
		</a>
	</figure>
	<div class="list__content clearfix">
		<header class="list__header">
			<h3 class="list__title post__title ">
				<a href="/post/august_2022/" rel="bookmark">AADInternals World Tour August 2022: USA</a>
			</h3>
			<div class="list__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"></path></svg>
				<time class="list__meta-date" datetime="2022-08-01T00:00:00">August 01, 2022</time>
					<time class="list__meta-lastmod" datetime="2022-08-16T00:00:00"> (Last Modified: August 16, 2022)</time>
			</div>
		</header>
		<div class="list__excerpt">
			<p>In August 2022, I’ll have several presentations regarding Azure AD security, open-source tools, and bug bounties.</p>

<p>I’ll be presenting at <a href="https://techmentorevents.com/events/redmond-2022/home.aspx" target="_blank">TECHMENTOR</a>, Black Hat <a href="https://www.blackhat.com/us-22/arsenal-overview.html" target="_blank">Arsenal</a>, DEF CON <a href="https://forum.defcon.org/node/239774" target="_blank">demo labs</a>, and <a href="https://cloud-village.org/" target="_blank">Cloud Village</a>.
<br><br>
If you like to have a chat on anything Azure AD related, want to say hi or get AADInternals sticker, check my schedule!</p>

<p></p>
		</div>
	</div>
</article>
<article class="list__item post clearfix">
	<figure class="list__thumbnail">
		<a href="https://aadinternals.com/post/deviceidentity/">
			<img src="/images/posts/deviceidentity.png" alt="Stealing and faking Azure AD device identities">
		</a>
	</figure>
	<div class="list__content clearfix">
		<header class="list__header">
			<h3 class="list__title post__title ">
				<a href="/post/deviceidentity/" rel="bookmark">Stealing and faking Azure AD device identities</a>
			</h3>
			<div class="list__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"></path></svg>
				<time class="list__meta-date" datetime="2022-02-15T00:00:00">February 15, 2022</time>
					<time class="list__meta-lastmod" datetime="2022-02-17T00:00:00"> (Last Modified: February 17, 2022)</time>
			</div>
		</header>
		<div class="list__excerpt">
			<p>In my previous blog posts I’ve covered details on <a href="/post/prt" target="_blank"> PRTs</a>, <a href="/post/bprt" target="_blank">BPRTs</a>, <a href="/post/mdm" target="_blank">device compliance</a>, and Azure AD <a href="/post/devices" target="_blank">device join</a>.</p>

<p>In this blog, I’ll show how to <strong>steal identities of existing Azure AD joined devices</strong>, and how to <strong>fake identies</strong> of non-AAD joined <strong>Windows devices</strong> with <a href="/aadinternals/" target="_blank">AADInternals</a> <strong>v0.6.6</strong>.</p>

<p></p>
		</div>
	</div>
</article>
<article class="list__item post clearfix">
	<figure class="list__thumbnail">
		<a href="https://aadinternals.com/post/partners/">
			<img src="/images/posts/partners.png" alt="Microsoft partners: The Good, The Bad, or The Ugly?">
		</a>
	</figure>
	<div class="list__content clearfix">
		<header class="list__header">
			<h3 class="list__title post__title ">
				<a href="/post/partners/" rel="bookmark">Microsoft partners: The Good, The Bad, or The Ugly?</a>
			</h3>
			<div class="list__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"></path></svg>
				<time class="list__meta-date" datetime="2021-12-11T00:00:00">December 11, 2021</time>
					<time class="list__meta-lastmod" datetime="2022-02-15T00:00:00"> (Last Modified: February 15, 2022)</time>
			</div>
		</header>
		<div class="list__excerpt">
			<p>In 2018, I <a href="/post/o365-gdpr/#delegated-administration" target="_blank">blogged</a> first time about risks related to Delegated Administrative Privileges (DAP) given to Microsoft partners.
Now, in 2021, Microsoft <a href="https://www.microsoft.com/security/blog/2021/10/25/nobelium-targeting-delegated-administrative-privileges-to-facilitate-broader-attacks/" target="_blank">blogged</a> how NOBELIUM exploited DAP to compromise
customers of some Microsoft partners.</p>

<p>In this blog, I’ll explain why DAP is so dangerous, how to exploit it, how to detect exploitation, and how to view partner related information with <strong>AADInternals v0.6.5</strong>.</p>

<p></p>
		</div>
	</div>
</article>
<article class="list__item post clearfix">
	<figure class="list__thumbnail">
		<a href="https://aadinternals.com/post/admintools/">
			<img src="/images/posts/admintools.png" alt="AADInternals admin and blue team tools">
		</a>
	</figure>
	<div class="list__content clearfix">
		<header class="list__header">
			<h3 class="list__title post__title ">
				<a href="/post/admintools/" rel="bookmark">AADInternals admin and blue team tools</a>
			</h3>
			<div class="list__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"></path></svg>
				<time class="list__meta-date" datetime="2021-09-07T00:00:00">September 07, 2021</time>
					<time class="list__meta-lastmod" datetime="2021-12-22T00:00:00"> (Last Modified: December 22, 2021)</time>
			</div>
		</header>
		<div class="list__excerpt">
			<p>AADInternals toolkit is best known of its offensive or red teams tools. Its origins, however, is in administration - especially for tasks not supported by official tools.</p>

<p>In this blog, I’ll introduce recent additions to the admin &amp; blue team tools and also some old goodies!</p>

<p></p>
		</div>
	</div>
</article>
<article class="list__item post clearfix">
	<figure class="list__thumbnail">
		<a href="https://aadinternals.com/post/hybridhealthagent/">
			<img src="/images/posts/hhealth.png" alt="Spoofing Azure AD sign-ins logs by imitating AD FS Hybrid Health Agent">
		</a>
	</figure>
	<div class="list__content clearfix">
		<header class="list__header">
			<h3 class="list__title post__title ">
				<a href="/post/hybridhealthagent/" rel="bookmark">Spoofing Azure AD sign-ins logs by imitating AD FS Hybrid Health Agent</a>
			</h3>
			<div class="list__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"></path></svg>
				<time class="list__meta-date" datetime="2021-07-08T00:00:00">July 08, 2021</time>
					<time class="list__meta-lastmod" datetime="2021-09-08T00:00:00"> (Last Modified: September 08, 2021)</time>
			</div>
		</header>
		<div class="list__excerpt">
			<p><strong>Azure AD Connect Health</strong> is a feature that allows viewing the health of on-prem hybrid infrastructure components, including Azure AD Connect and AD FS servers.
Health information is gathered by agents installed on each on-prem hybrid server. Since March 2021, also AD FS sign-in events are gathered and sent to Azure AD.</p>

<p>In this write-up (based on a Threat Analysis <a href="https://www.secureworks.com/research/azure-active-directory-sign-ins-log-tampering" target="_blank">report</a> by Secureworks), I’ll explain how anyone with a local administrator access to AD FS server (or proxy), can create arbitrary sign-ins events to Azure AD sign-ins log.
Moreover, I’ll show how Global Administrators can register fake agents to Azure AD - even for tenants not using AD FS at all.</p>

<p></p>
		</div>
	</div>
</article>
<article class="list__item post clearfix">
	<figure class="list__thumbnail">
		<a href="https://aadinternals.com/post/adfs/">
			<img src="/images/posts/ADFS.png" alt="Exporting AD FS certificates revisited: Tactics, Techniques and Procedures">
		</a>
	</figure>
	<div class="list__content clearfix">
		<header class="list__header">
			<h3 class="list__title post__title ">
				<a href="/post/adfs/" rel="bookmark">Exporting AD FS certificates revisited: Tactics, Techniques and Procedures</a>
			</h3>
			<div class="list__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"></path></svg>
				<time class="list__meta-date" datetime="2021-04-27T00:00:00">April 27, 2021</time>
					<time class="list__meta-lastmod" datetime="2022-09-09T00:00:00"> (Last Modified: September 09, 2022)</time>
			</div>
		</header>
		<div class="list__excerpt">
			<p>I’ve talked about AD FS issues for a couple years now, and finally, after the Solorigate/Sunburst, the world is finally listening 😉</p>

<p>In this blog, I’ll explain the currently known TTPs to exploit AD FS certificates, and introduce a totally new technique to export the configuration data remotely.</p>

<p></p>
		</div>
	</div>
</article>
<article class="list__item post clearfix">
	<figure class="list__thumbnail">
		<a href="https://aadinternals.com/post/devices/">
			<img src="/images/posts/devices.png" alt="Deep-dive to Azure AD device join">
		</a>
	</figure>
	<div class="list__content clearfix">
		<header class="list__header">
			<h3 class="list__title post__title ">
				<a href="/post/devices/" rel="bookmark">Deep-dive to Azure AD device join</a>
			</h3>
			<div class="list__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"></path></svg>
				<time class="list__meta-date" datetime="2021-03-03T00:00:00">March 03, 2021</time>
					<time class="list__meta-lastmod" datetime="2021-09-10T00:00:00"> (Last Modified: September 10, 2021)</time>
			</div>
		</header>
		<div class="list__excerpt">
			<p>Devices (endpoints) are a crucial part of Microsoft’s Zero Trust concept. Devices can be Registered, Joined, or Hybrid Joined to Azure AD.
Conditional Access uses the device information as one of the decisions criteria to allow or block access to services.</p>

<p>In this blog, I’ll explain what these different registration types are, what happens under-the-hood during the registration, and how to register devices with <a href="/aadinternals/#hack-functions-azure-ad-join-mdm-prt" target="_blank">AADInternals</a> <strong>v0.4.6</strong>.</p>

<p></p>
		</div>
	</div>
</article>
<article class="list__item post clearfix">
	<figure class="list__thumbnail">
		<a href="https://aadinternals.com/post/bprt/">
			<img src="/images/posts/bprt.png" alt="BPRT unleashed: Joining multiple devices to Azure AD and Intune">
		</a>
	</figure>
	<div class="list__content clearfix">
		<header class="list__header">
			<h3 class="list__title post__title ">
				<a href="/post/bprt/" rel="bookmark">BPRT unleashed: Joining multiple devices to Azure AD and Intune</a>
			</h3>
			<div class="list__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"></path></svg>
				<time class="list__meta-date" datetime="2021-01-31T00:00:00">January 31, 2021</time>
					<time class="list__meta-lastmod" datetime="2022-09-26T00:00:00"> (Last Modified: September 26, 2022)</time>
			</div>
		</header>
		<div class="list__excerpt">
			<p>In October 2020, someone contacted me and asked whether it would be possible
to create BPRTs using AADInternals. I hadn’t even heard of BPRTs, but was eventually able to help him to create BPRTs. Now this
functionality is included in <strong><a href="/aadinternals/" target="_blank">AADInternals</a> v0.4.5</strong>.</p>

<p>In this blog, I’ll explain what BPRTs are and how they can be used to join multiple devices to both Azure AD and Intune.
I’ll also show the dark side of BPRTs: how they can be used to conduct DOS attacks against Azure AD, and how to detect and prevent this.</p>

<p></p>
		</div>
	</div>
</article>
<article class="list__item post clearfix">
	<figure class="list__thumbnail">
		<a href="https://aadinternals.com/post/teams-policies/">
			<img src="/images/posts/teams-policies.png" alt="Abusing Teams client protocol to bypass Teams security policies">
		</a>
	</figure>
	<div class="list__content clearfix">
		<header class="list__header">
			<h3 class="list__title post__title ">
				<a href="/post/teams-policies/" rel="bookmark">Abusing Teams client protocol to bypass Teams security policies</a>
			</h3>
			<div class="list__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"></path></svg>
				<time class="list__meta-date" datetime="2020-10-27T00:00:00">October 27, 2020</time>
					<time class="list__meta-lastmod" datetime="2020-10-29T00:00:00"> (Last Modified: October 29, 2020)</time>
			</div>
		</header>
		<div class="list__excerpt">
			<p>Administrators can use teams policies for controlling what users can do in Microsoft Teams.</p>

<p>In this blog, I’ll show that these policies are applied only in client and thus can be easily bypassed.</p>

<p></p>
		</div>
	</div>
</article>
<article class="list__item post clearfix">
	<figure class="list__thumbnail">
		<a href="https://aadinternals.com/post/cloudidentitysummit2020/">
			<img src="/images/posts/AADInt_CloudIdentitySummit2020.png" alt="AADInternals Cloud Identity Summit 2020 edition">
		</a>
	</figure>
	<div class="list__content clearfix">
		<header class="list__header">
			<h3 class="list__title post__title ">
				<a href="/post/cloudidentitysummit2020/" rel="bookmark">AADInternals Cloud Identity Summit 2020 edition</a>
			</h3>
			<div class="list__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"></path></svg>
				<time class="list__meta-date" datetime="2020-10-19T00:00:00">October 19, 2020</time>
			</div>
		</header>
		<div class="list__excerpt">
			<p>The new AADInternals release v0.4.4 <strong>AADInternals Cloud Identity Summit 2020 edition</strong> is now released! Read on to see the list of updates and new features.</p>

<p></p>
		</div>
	</div>
</article>
<article class="list__item post clearfix">
	<figure class="list__thumbnail">
		<a href="https://aadinternals.com/post/phishing/">
			<img src="/images/posts/phishing.png" alt="Introducing a new phishing technique for compromising Office 365 accounts">
		</a>
	</figure>
	<div class="list__content clearfix">
		<header class="list__header">
			<h3 class="list__title post__title ">
				<a href="/post/phishing/" rel="bookmark">Introducing a new phishing technique for compromising Office 365 accounts</a>
			</h3>
			<div class="list__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"></path></svg>
				<time class="list__meta-date" datetime="2020-10-13T00:00:00">October 13, 2020</time>
					<time class="list__meta-lastmod" datetime="2021-09-10T00:00:00"> (Last Modified: September 10, 2021)</time>
			</div>
		</header>
		<div class="list__excerpt">
			<p>The <a href="https://threatpost.com/microsoft-seizes-domains-office-365-phishing-scam/157261" target="_blank">ongoing global phishing campaings</a> againts Microsoft 365 have used various phishing techniques.
Currently attackers are utilising forged login sites and OAuth app consents.</p>

<p>In this blog, I’ll introduce a new phishing technique based on Azure AD device code authentication flow.
I’ll also provide instructions on how to detect usage of compromised credentials and what to do to prevent phishing using the new technique.</p>

<p></p>
		</div>
	</div>
</article>
<article class="list__item post clearfix">
	<figure class="list__thumbnail">
		<a href="https://aadinternals.com/post/cloudshell/">
			<img src="/images/posts/cloudshell.png" alt="Using Azure Cloud Shell from PowerShell">
		</a>
	</figure>
	<div class="list__content clearfix">
		<header class="list__header">
			<h3 class="list__title post__title ">
				<a href="/post/cloudshell/" rel="bookmark">Using Azure Cloud Shell from PowerShell</a>
			</h3>
			<div class="list__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"></path></svg>
				<time class="list__meta-date" datetime="2020-09-30T00:00:00">September 30, 2020</time>
			</div>
		</header>
		<div class="list__excerpt">
			<p>Azure Cloud Shell is a browser-based shell for managing Azure resources using your favourite shell, Bash or PowerShell.
Cloud Shell is typically used from Azure Portal. It provides an easy access to Azure CLI, Azure PowerShell and Azure AD PowerShell.</p>

<p>In this blog, I’ll introduce a new way to access Cloud Shell from PowerShell (requires <strong>AADInternals v0.4.3</strong> or newer).</p>

<p></p>
		</div>
	</div>
</article>
<article class="list__item post clearfix">
	<figure class="list__thumbnail">
		<a href="https://aadinternals.com/post/mdm/">
			<img src="/images/posts/MDM.png" alt="Bypassing conditional access by faking device compliance.">
		</a>
	</figure>
	<div class="list__content clearfix">
		<header class="list__header">
			<h3 class="list__title post__title ">
				<a href="/post/mdm/" rel="bookmark">Bypassing conditional access by faking device compliance.</a>
			</h3>
			<div class="list__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"></path></svg>
				<time class="list__meta-date" datetime="2020-09-06T00:00:00">September 06, 2020</time>
					<time class="list__meta-lastmod" datetime="2020-09-29T00:00:00"> (Last Modified: September 29, 2020)</time>
			</div>
		</header>
		<div class="list__excerpt">
			<p>In my previous <a href="/post/prt/#creating-your-own-prt" target="_blank">blog</a> I demonstrated how to create
a Persistent Refresh Token (PRT) by joining imaginary device to Azure AD.</p>

<p>In this blog, with <strong>AADInternals v0.4.2</strong>, I’ll show how to make those devices compliant, allowing bypassing compliance related conditional access (CA) policies.</p>

<p></p>
		</div>
	</div>
</article>

		

		
<div class="pagination clearfix">
	<span class="pagination__item pagination__item--current">1/3</span>
	<a class="pagination__item pagination__item--next" href="/page/2/">»</a>
</div>

	</main>

	</div>
		<footer class="footer" itemscope="itemscope" itemtype="http://schema.org/WPFooter">
			<div class="container container-inner">
				<p class="footer__copyright"><span><a href="https://creativecommons.org/licenses/by/4.0/" target="_blank"><img src="/images/CC-BY.png"></a> </span></p>
			</div>
		</footer>
	</div>

<script>
	var navigation = responsiveNav(".menu", {
		navClass: "menu--collapse",
	});
</script>

</body></html>