<html lang="en" data-rh="lang"><head><title>Calling Home, Get Your Callbacks Through RBI | by Lance B. Cain | Posts By SpecterOps Team Members</title><meta data-rh="true" charset="utf-8"><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"><meta data-rh="true" name="theme-color" content="#000000"><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"><meta data-rh="true" property="al:ios:app_name" content="Medium"><meta data-rh="true" property="al:ios:app_store_id" content="828256236"><meta data-rh="true" property="al:android:package" content="com.medium.reader"><meta data-rh="true" property="fb:app_id" content="542599432471018"><meta data-rh="true" property="og:site_name" content="Medium"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-01-17T22:59:21.101Z"><meta data-rh="true" name="title" content="Calling Home, Get Your Callbacks Through RBI | by Lance B. Cain | Posts By SpecterOps Team Members"><meta data-rh="true" property="og:title" content="Calling Home, Get Your Callbacks Through RBI"><meta data-rh="true" property="al:android:url" content="medium://p/50633a233999"><meta data-rh="true" property="al:ios:url" content="medium://p/50633a233999"><meta data-rh="true" property="al:android:app_name" content="Medium"><meta data-rh="true" name="description" content="Remote Browser Isolation (RBI) is a security technology which has been gaining popularity for large businesses securing their enterprise networks in recent years. This blog post describes methods…"><meta data-rh="true" property="og:description" content="Authored By: Lance B. Cain and Alexander DeMine"><meta data-rh="true" property="og:url" content="https://posts.specterops.io/calling-home-get-your-callbacks-through-rbi-50633a233999"><meta data-rh="true" property="al:web:url" content="https://posts.specterops.io/calling-home-get-your-callbacks-through-rbi-50633a233999"><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:979/1*EJZIdvkDgdThnyDr0mV5MA.png"><meta data-rh="true" property="article:author" content="https://medium.com/@lbcain18"><meta data-rh="true" name="author" content="Lance B. Cain"><meta data-rh="true" name="robots" content="index,follow,max-image-preview:large"><meta data-rh="true" name="referrer" content="unsafe-url"><meta data-rh="true" property="twitter:title" content="Calling Home, Get Your Callbacks Through RBI"><meta data-rh="true" name="twitter:site" content="@specterops"><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/50633a233999"><meta data-rh="true" property="twitter:description" content="Authored By: Lance B. Cain and Alexander DeMine"><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:979/1*EJZIdvkDgdThnyDr0mV5MA.png"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="twitter:label1" content="Reading time"><meta data-rh="true" name="twitter:data1" content="18 min read"><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:152:152/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:120:120/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:76:76/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:60:60/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/Medium-Avatar-500x500.svg" color="#171717"><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"><link data-rh="true" rel="author" href="https://medium.com/@lbcain18"><link data-rh="true" rel="canonical" href="https://posts.specterops.io/calling-home-get-your-callbacks-through-rbi-50633a233999"><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/50633a233999"><style type="text/css" data-fela-rehydration="534" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="534" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-webkit-keyframes k1{0%{transform:translate(-50%, -100px)}100%{transform:translate(-50%, 0)}}@-moz-keyframes k1{0%{transform:translate(-50%, -100px)}100%{transform:translate(-50%, 0)}}@keyframes k1{0%{transform:translate(-50%, -100px)}100%{transform:translate(-50%, 0)}}</style><style type="text/css" data-fela-rehydration="534" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{fill:rgba(0, 0, 0, 1)}.av{height:22px}.aw{margin-left:16px}.ax{border:none}.ay{border-radius:20px}.az{width:240px}.ba{background:#F9F9F9}.bb path{fill:#6B6B6B}.bd{outline:none}.be{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bf{font-size:14px}.bg{width:100%}.bh{padding:10px 20px 10px 0}.bi{background-color:transparent}.bj{color:#242424}.bk::placeholder{color:#6B6B6B}.bl{display:inline-block}.bm{margin-left:12px}.bn{margin-right:12px}.bo{border-radius:4px}.bp{margin-left:24px}.bq{height:24px}.bw{background-color:#F9F9F9}.bx{border-radius:50%}.by{height:32px}.bz{width:32px}.ca{justify-content:center}.cg{max-width:680px}.ch{min-width:0}.ci{animation:k1 1.2s ease-in-out infinite}.cj{height:100vh}.ck{margin-bottom:16px}.cl{margin-top:48px}.cm{align-items:flex-start}.cn{flex-direction:column}.co{justify-content:space-between}.cp{margin-bottom:24px}.cv{width:80%}.cw{background-color:#F2F2F2}.dc{height:44px}.dd{width:44px}.de{margin:auto 0}.df{margin-bottom:4px}.dg{height:16px}.dh{width:120px}.di{width:80px}.do{margin-bottom:8px}.dp{width:96%}.dq{width:98%}.dr{width:81%}.ds{margin-left:8px}.dt{color:#6B6B6B}.du{font-size:13px}.dv{height:100%}.eo{color:#FFFFFF}.ep{fill:#FFFFFF}.eq{background:rgba(128, 128, 183, 1)}.er{border-color:rgba(128, 128, 183, 1)}.ev:disabled{cursor:inherit !important}.ew:disabled{opacity:0.3}.ex:disabled:hover{background:rgba(128, 128, 183, 1)}.ey:disabled:hover{border-color:rgba(128, 128, 183, 1)}.ez{border-radius:99em}.fa{border-width:1px}.fb{border-style:solid}.fc{box-sizing:border-box}.fd{text-decoration:none}.fe{text-align:center}.fh{margin-right:32px}.fi{position:relative}.fj{fill:#6B6B6B}.fm{background:transparent}.fn svg{margin-left:4px}.fo svg{fill:#6B6B6B}.fq{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fr{position:absolute}.fy{margin:0 24px}.gc{background:rgba(255, 255, 255, 1)}.gd{border:1px solid #F2F2F2}.ge{box-shadow:0 1px 4px #F2F2F2}.gf{max-height:100vh}.gg{overflow-y:auto}.gh{left:0}.gi{top:calc(100vh + 100px)}.gj{bottom:calc(100vh + 100px)}.gk{width:10px}.gl{pointer-events:none}.gm{word-break:break-word}.gn{word-wrap:break-word}.go:after{display:block}.gp:after{content:""}.gq:after{clear:both}.gr{line-height:1.23}.gs{letter-spacing:0}.gt{font-style:normal}.gu{font-weight:700}.hu{@media all and (max-width: 551.98px):8px}.hv{@media all and (min-width: 552px) and (max-width: 727.98px):8px}.hw{@media all and (min-width: 728px) and (max-width: 903.98px):16px}.hx{@media all and (min-width: 904px) and (max-width: 1079.98px):16px}.hy{@media all and (min-width: 1080px):16px}.ie{align-items:baseline}.if{width:48px}.ig{height:48px}.ih{border:2px solid rgba(255, 255, 255, 1)}.ii{z-index:0}.ij{box-shadow:none}.ik{border:1px solid rgba(0, 0, 0, 0.05)}.il{margin-left:-12px}.im{width:28px}.in{height:28px}.io{z-index:1}.ip{width:24px}.iq{margin-bottom:2px}.ir{flex-wrap:nowrap}.is{font-size:16px}.it{line-height:24px}.iv{margin:0 8px}.iw{display:inline}.ix{color:rgba(128, 128, 183, 1)}.iy{fill:rgba(128, 128, 183, 1)}.jb{flex:0 0 auto}.je{flex-wrap:wrap}.jh{white-space:pre-wrap}.ji{margin-right:4px}.jj{overflow:hidden}.jk{max-height:20px}.jl{text-overflow:ellipsis}.jm{display:-webkit-box}.jn{-webkit-line-clamp:1}.jo{-webkit-box-orient:vertical}.jp{word-break:break-all}.jr{padding-left:8px}.js{padding-right:8px}.kt> *{flex-shrink:0}.ku{overflow-x:scroll}.kv::-webkit-scrollbar{display:none}.kw{scrollbar-width:none}.kx{-ms-overflow-style:none}.ky{width:74px}.kz{flex-direction:row}.la{z-index:2}.ld{-webkit-user-select:none}.le{border:0}.lf{fill:rgba(117, 117, 117, 1)}.li{outline:0}.lj{user-select:none}.lk> svg{pointer-events:none}.lt{cursor:progress}.lu{opacity:1}.lv{padding:4px 0}.ly{margin-top:0px}.lz{width:16px}.mb{display:inline-flex}.mh{max-width:100%}.mi{padding:8px 2px}.mj svg{color:#6B6B6B}.na{line-height:1.58}.nb{letter-spacing:-0.004em}.nc{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.nx{margin-bottom:-0.46em}.ny{font-style:italic}.nz{background:none}.oa{line-height:1.12}.ob{letter-spacing:-0.022em}.oc{font-weight:600}.ox{margin-bottom:-0.28em}.pd{text-decoration:underline}.pe{margin-left:auto}.pf{margin-right:auto}.pg{max-width:979px}.pm{clear:both}.po{cursor:zoom-in}.pp{z-index:auto}.pr{height:auto}.ps{margin-top:10px}.pt{max-width:728px}.pw{font-style:inherit}.px{line-height:1.18}.ql{margin-bottom:-0.31em}.qm{max-width:383px}.qn{max-width:428px}.qo{max-width:600px}.qp{max-width:470px}.qq{max-width:402px}.qr{max-width:414px}.qs{margin-top:32px}.qt{margin-bottom:14px}.qu{padding-top:24px}.qv{padding-bottom:10px}.qw{background-color:#000000}.qx{height:3px}.qy{width:3px}.qz{margin-right:20px}.ra{margin-bottom:26px}.rb{margin-top:6px}.rc{margin-top:8px}.rd{margin-right:8px}.re{padding:8px 16px}.rf{border-radius:100px}.rg{transition:background 300ms ease}.ri{white-space:nowrap}.rj{border-top:none}.rp{height:52px}.rq{max-height:52px}.rr{box-sizing:content-box}.rs{position:static}.ru{max-width:155px}.sf{align-items:flex-end}.sg{width:76px}.sh{height:76px}.si{border:2px solid #F9F9F9}.sj{height:72px}.sk{width:72px}.sl{margin-left:-16px}.sm{width:36px}.sn{height:36px}.so{width:auto}.sp{stroke:#F2F2F2}.sq{color:#F2F2F2}.sr{fill:#F2F2F2}.ss{background:#F2F2F2}.st{border-color:#F2F2F2}.sz{font-weight:500}.ta{font-size:24px}.tb{line-height:30px}.tc{letter-spacing:-0.016em}.td{margin-top:16px}.te{height:0px}.tf{border-bottom:solid 1px #E5E5E5}.tl{margin-top:72px}.tm{padding:24px 0}.tn{margin-bottom:0px}.to{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.es:hover{background:rgba(110, 110, 154, 1)}.et:hover{border-color:rgba(110, 110, 154, 1)}.eu:hover{cursor:pointer}.fk:hover{color:#242424}.fl:hover{fill:#242424}.fp:hover svg{fill:#242424}.fs:hover{background-color:rgba(0, 0, 0, 0.1)}.iu:hover{text-decoration:underline}.iz:hover:not(:disabled){color:rgba(110, 110, 154, 1)}.ja:hover:not(:disabled){fill:rgba(110, 110, 154, 1)}.lh:hover{fill:rgba(8, 8, 8, 1)}.lw:hover{fill:#000000}.lx:hover p{color:#000000}.ma:hover{color:#000000}.mk:hover svg{color:#000000}.rh:hover{background-color:#F2F2F2}.su:hover{background:#F2F2F2}.sv:hover{border-color:#F2F2F2}.sw:hover{cursor:wait}.sx:hover{color:#F2F2F2}.sy:hover{fill:#F2F2F2}.bc:focus-within path{fill:#242424}.lg:focus{fill:rgba(8, 8, 8, 1)}.ml:focus svg{color:#000000}.pq:focus{transform:scale(1.01)}.ll:active{border-style:none}</style><style type="text/css" data-fela-rehydration="534" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ee{font-size:14px}.ef{line-height:20px}.el{font-size:13px}.em{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:68px}.gb{max-width:680px}.hp{font-size:42px}.hq{margin-top:1.19em}.hr{margin-bottom:32px}.hs{line-height:52px}.ht{letter-spacing:-0.011em}.id{align-items:center}.kf{border-top:solid 1px #F2F2F2}.kg{border-bottom:solid 1px #F2F2F2}.kh{margin:32px 0 0}.ki{padding:3px 8px}.kr> *{margin-right:24px}.ks> :last-child{margin-right:0}.ls{margin-top:0px}.mg{margin:0}.nt{font-size:20px}.nu{margin-top:2.14em}.nv{line-height:32px}.nw{letter-spacing:-0.003em}.ot{font-size:24px}.ou{margin-top:1.95em}.ov{line-height:30px}.ow{letter-spacing:-0.016em}.pc{margin-top:0.94em}.pl{margin-top:56px}.qi{margin-top:1.72em}.qj{line-height:24px}.qk{letter-spacing:0}.ro{margin-bottom:88px}.rz{display:inline-block}.se{padding-top:72px}.tk{margin-top:40px}</style><style type="text/css" data-fela-rehydration="534" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.lr{margin-top:0px}.pu{margin-left:auto}.pv{text-align:center}.ry{display:inline-block}</style><style type="text/css" data-fela-rehydration="534" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.lq{margin-top:0px}.rx{display:inline-block}</style><style type="text/css" data-fela-rehydration="534" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.lo{margin-top:0px}.lp{margin-right:0px}.rw{display:inline-block}</style><style type="text/css" data-fela-rehydration="534" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.br{width:24px}.cb{margin:0 24px}.cq{height:40px}.cx{margin-bottom:44px}.dj{margin-bottom:32px}.dw{font-size:13px}.dx{line-height:20px}.eg{padding:0px 8px 1px}.ft{margin-bottom:4px}.gv{font-size:32px}.gw{margin-top:1.01em}.gx{margin-bottom:24px}.gy{line-height:38px}.gz{letter-spacing:-0.014em}.hz{align-items:flex-start}.jc{flex-direction:column}.jf{margin-bottom:2px}.jt{margin:24px -24px 0}.ju{padding:0}.kj> *{margin-right:8px}.kk> :last-child{margin-right:24px}.lb{margin-left:0px}.lm{margin-top:0px}.ln{margin-right:0px}.mc{margin:0}.mm{border:1px solid #F2F2F2}.mn{border-radius:99em}.mo{padding:0px 16px 0px 12px}.mp{height:38px}.mq{align-items:center}.ms svg{margin-right:8px}.nd{font-size:18px}.ne{margin-top:1.56em}.nf{line-height:28px}.ng{letter-spacing:-0.003em}.od{font-size:20px}.oe{margin-top:1.2em}.of{line-height:24px}.og{letter-spacing:0}.oy{margin-top:0.67em}.ph{margin-top:40px}.py{font-size:16px}.pz{margin-top:1.23em}.rk{margin-bottom:80px}.rv{display:inline-block}.sa{padding-top:48px}.tg{margin-top:32px}.mr:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="534" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bu{width:64px}.ce{margin:0 64px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.ec{font-size:14px}.ed{line-height:20px}.ej{font-size:13px}.ek{padding:5px 12px}.ff{display:flex}.fw{margin-bottom:68px}.ga{max-width:680px}.hk{font-size:42px}.hl{margin-top:1.19em}.hm{margin-bottom:32px}.hn{line-height:52px}.ho{letter-spacing:-0.011em}.ic{align-items:center}.kb{border-top:solid 1px #F2F2F2}.kc{border-bottom:solid 1px #F2F2F2}.kd{margin:32px 0 0}.ke{padding:3px 8px}.kp> *{margin-right:24px}.kq> :last-child{margin-right:0}.mf{margin:0}.np{font-size:20px}.nq{margin-top:2.14em}.nr{line-height:32px}.ns{letter-spacing:-0.003em}.op{font-size:24px}.oq{margin-top:1.95em}.or{line-height:30px}.os{letter-spacing:-0.016em}.pb{margin-top:0.94em}.pk{margin-top:56px}.qf{margin-top:1.72em}.qg{line-height:24px}.qh{letter-spacing:0}.rn{margin-bottom:88px}.sd{padding-top:72px}.tj{margin-top:40px}</style><style type="text/css" data-fela-rehydration="534" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bt{width:64px}.cd{margin:0 48px}.cs{height:48px}.cz{margin-bottom:52px}.dl{margin-bottom:48px}.ea{font-size:13px}.eb{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:68px}.fz{max-width:680px}.hf{font-size:42px}.hg{margin-top:1.19em}.hh{margin-bottom:32px}.hi{line-height:52px}.hj{letter-spacing:-0.011em}.ib{align-items:center}.jx{border-top:solid 1px #F2F2F2}.jy{border-bottom:solid 1px #F2F2F2}.jz{margin:32px 0 0}.ka{padding:3px 8px}.kn> *{margin-right:24px}.ko> :last-child{margin-right:0}.me{margin:0}.nl{font-size:20px}.nm{margin-top:2.14em}.nn{line-height:32px}.no{letter-spacing:-0.003em}.ol{font-size:24px}.om{margin-top:1.95em}.on{line-height:30px}.oo{letter-spacing:-0.016em}.pa{margin-top:0.94em}.pj{margin-top:56px}.qc{margin-top:1.72em}.qd{line-height:24px}.qe{letter-spacing:0}.rm{margin-bottom:88px}.sc{padding-top:72px}.ti{margin-top:40px}</style><style type="text/css" data-fela-rehydration="534" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dy{font-size:13px}.dz{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:4px}.ha{font-size:32px}.hb{margin-top:1.01em}.hc{margin-bottom:24px}.hd{line-height:38px}.he{letter-spacing:-0.014em}.ia{align-items:flex-start}.jd{flex-direction:column}.jg{margin-bottom:2px}.jv{margin:24px 0 0}.jw{padding:0}.kl> *{margin-right:8px}.km> :last-child{margin-right:8px}.lc{margin-left:0px}.md{margin:0}.mt{border:1px solid #F2F2F2}.mu{border-radius:99em}.mv{padding:0px 16px 0px 12px}.mw{height:38px}.mx{align-items:center}.mz svg{margin-right:8px}.nh{font-size:18px}.ni{margin-top:1.56em}.nj{line-height:28px}.nk{letter-spacing:-0.003em}.oh{font-size:20px}.oi{margin-top:1.2em}.oj{line-height:24px}.ok{letter-spacing:0}.oz{margin-top:0.67em}.pi{margin-top:40px}.qa{font-size:16px}.qb{margin-top:1.23em}.rl{margin-bottom:80px}.sb{padding-top:48px}.th{margin-top:32px}.my:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="534" data-fela-type="RULE" media="print">.rt{display:none}</style><style type="text/css" data-fela-rehydration="534" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.jq{max-height:none}</style><style type="text/css" data-fela-rehydration="534" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.pn{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style><script type="text/javascript" async="" src="https://www.gstatic.com/recaptcha/releases/TqxSU0dsOd2Q9IbI7CpFnJLD/recaptcha__pl.js" crossorigin="anonymous" integrity="sha384-EtuwsrUt4o3rjKbOIgbMlrdETicyC7YJiOMF4S2kRPR2c6EcUDPrB1OFkiSEO3IC"></script><script async="" src="https://cdn.branch.io/branch-latest.min.js"></script><link rel="icon" href="https://miro.medium.com/v2/resize:fill:160:160/1*D-FDlfkqivRBQZoESrwtqw.png" data-rh="true"><script type="application/ld+json" data-rh="true">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*EJZIdvkDgdThnyDr0mV5MA.png"],"url":"https:\u002F\u002Fposts.specterops.io\u002Fcalling-home-get-your-callbacks-through-rbi-50633a233999","dateCreated":"2024-01-17T22:59:21.101Z","datePublished":"2024-01-17T22:59:21.101Z","dateModified":"2024-01-20T23:20:35.760Z","headline":"Calling Home, Get Your Callbacks Through RBI - Posts By SpecterOps Team Members","name":"Calling Home, Get Your Callbacks Through RBI - Posts By SpecterOps Team Members","description":"Remote Browser Isolation (RBI) is a security technology which has been gaining popularity for large businesses securing their enterprise networks in recent years. This blog post describes methods…","identifier":"50633a233999","author":{"@type":"Person","name":"Lance B. Cain","url":"https:\u002F\u002Fposts.specterops.io\u002F@lbcain18"},"creator":["Lance B. Cain"],"publisher":{"@type":"Organization","name":"Posts By SpecterOps Team Members","url":"posts.specterops.io","logo":{"@type":"ImageObject","width":149,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:186\u002F1*s-5BWBr8XsgtIU5azKNhZQ.jpeg"}},"mainEntityOfPage":"https:\u002F\u002Fposts.specterops.io\u002Fcalling-home-get-your-callbacks-through-rbi-50633a233999"}</script><script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-7JY7T788PK" data-rh="true"></script><script data-rh="true">window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'G-7JY7T788PK');</script><script src="https://www.google.com/recaptcha/enterprise.js?render=6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp" data-rh="true"></script><script type="text/javascript" data-rh="true">(function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src="https://cdn.branch.io/branch-latest.min.js";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,"script","branch",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},"addListener applyCode autoAppIndex banner closeBanner closeJourney creditHistory credits data deepview deepviewCta first getCode init link logout redeem referrals removeListener sendSMS setBranchViewData setIdentity track validateCode trackCommerceEvent logEvent".split(" "), 0);
branch.init('key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm', {metadata: {}, 'no_journeys': true, 'disable_exit_animation': true, 'disable_entry_animation': true, 'tracking_disabled': null}, function(err, data) {});</script></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div><script>if (window.self !== window.top) window.location = "about:blank"</script></div><div class="l c"><div class="l m n o c" style="transform: translateY(0px);"><div class="p q r s t u v w x i d y z"><a class="dt ag du be ak b am an ao ap aq ar as at s u w i d q dv z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F50633a233999&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderCollection&amp;source=---two_column_layout_nav----------------------------------" rel="noopener follow">Open in app<svg width="10" height="10" viewBox="0 0 10 10" fill="none" class="ds"><path d="M.98 8.48a.37.37 0 1 0 .54.54l-.54-.54zm7.77-7.23h.38c0-.2-.17-.38-.38-.38v.38zM8.37 6.5a.37.37 0 1 0 .76 0h-.76zM3.5.87a.37.37 0 1 0 0 .76V.88zM1.52 9.03l7.5-7.5-.54-.54-7.5 7.5.54.54zm6.86-7.77V6.5h.74V1.25h-.74zm-4.88.38h5.25V.88H3.5v.74z" fill="currentColor"></path></svg></a><div class="ab q"><p class="be b dw dx dy dz ea eb ec ed ee ef dt"><span><a class="be b dw dx eg dy dz eh ea eb ei ej ed ek el ef em eo ep eq er es et eu ev ew ex ey ez fa fb fc bl fd fe" data-testid="headerSignUpButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcalling-home-get-your-callbacks-through-rbi-50633a233999&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign up</a></span></p><div class="aw l"><p class="be b dw dx dy dz ea eb ec ed ee ef dt"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcalling-home-get-your-callbacks-through-rbi-50633a233999&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=---two_column_layout_nav----------------------------------" rel="noopener follow"><svg width="120" height="27" viewBox="0 0 120 27" fill="none"><mask id="logo-wordmark-pride_svg__a" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="1" y="0" width="119" height="27"><path d="M29.69 2.36h.03v-.29h-7.26L15.7 18.05 8.96 2.07H1.12v.28l.04.01c1.32.3 2 .75 2 2.37v19c0 1.62-.68 2.07-2 2.37h-.04v.29h5.31v-.28H6.4c-1.33-.3-2-.76-2-2.38V5.83l8.67 20.56h.5l8.91-21.13V24.2c-.1 1.28-.78 1.67-1.98 1.95h-.03v.28h9.25v-.27l-.03-.01c-1.2-.28-1.89-.67-2-1.95V4.73c0-1.62.67-2.07 2-2.37zm4.23 12.58c.15-3.41 1.37-5.87 3.4-5.92.64.01 1.17.22 1.58.62.87.86 1.28 2.64 1.22 5.3h-6.2zm-.1.96h10.86v-.04c-.03-2.61-.78-4.64-2.23-6.03a7.3 7.3 0 0 0-5.05-1.87h-.04a7.31 7.31 0 0 0-5.75 2.78 10.4 10.4 0 0 0-2.08 5.72l-.02.2a7.61 7.61 0 0 0-.02.56v.58c.11 5.09 2.84 9.16 7.69 9.16 4.25 0 6.73-3.14 7.35-7.34l-.32-.11c-1.08 2.26-3.03 3.63-5.25 3.46-3.03-.23-5.35-3.32-5.13-7.06m23.12 6.89c-.36.85-1.1 1.32-2.1 1.32s-1.9-.7-2.55-1.94a12.23 12.23 0 0 1-1.06-5.49c0-4.68 1.45-7.7 3.68-7.7.94 0 1.68.47 2.03 1.28V22.8zm7.2 3.33c-1.33-.31-2-.78-2-2.49V.96l-8.07 2.39v.3l.05-.01c1.11-.1 1.87.06 2.3.47.35.32.52.8.52 1.5v3.1a5.18 5.18 0 0 0-2.89-.75c-2.33 0-4.45.98-5.99 2.78-1.6 1.86-2.44 4.42-2.44 7.38 0 5.28 2.58 8.84 6.43 8.84a5.09 5.09 0 0 0 4.89-3.34v2.81h7.23v-.29h-.03zm6.9-22.09c0-1.65-1.23-2.9-2.87-2.9a2.87 2.87 0 0 0-2.9 2.9c0 1.63 1.27 2.9 2.9 2.9a2.82 2.82 0 0 0 2.88-2.9zm1.91 22.1c-1.32-.32-2-.8-2-2.5V8.01l-7.24 2.1v.28h.05c1.56.14 1.99.68 1.99 2.53v13.51H73v-.29h-.04zm18.54 0c-1.33-.32-2-.8-2-2.5V8.01l-6.89 2.02v.29h.04c1.28.14 1.65.71 1.65 2.56v9.88a2.48 2.48 0 0 1-2.2 1.4c-1.57 0-2.43-1.08-2.43-3.02V8.01l-7.24 2.1v.28h.04c1.57.14 2 .68 2 2.53v8.36c0 .58.05 1.16.15 1.74l.13.57c.61 2.21 2.22 3.37 4.73 3.37 2.13 0 4-1.33 4.82-3.4v2.88h7.23v-.3h-.03zm28.1.3v-.3h-.03c-1.44-.34-2-.97-2-2.26V13.25c0-3.31-1.85-5.3-4.95-5.3a5.08 5.08 0 0 0-4.9 3.37c-.58-2.17-2.25-3.36-4.73-3.36a4.7 4.7 0 0 0-4.61 3.1V8.02l-7.23 2v.3h.04c1.55.14 2 .7 2 2.49v13.63h6.74v-.29h-.03c-1.15-.28-1.52-.78-1.52-2.05V11.9c.3-.71.91-1.56 2.13-1.56 1.5 0 2.26 1.05 2.26 3.12v12.97h6.75v-.29h-.03c-1.15-.28-1.52-.78-1.52-2.05V13.25a7 7 0 0 0-.1-1.21c.32-.78.97-1.7 2.23-1.7 1.53 0 2.27 1.02 2.27 3.12v12.97h7.23z" fill="#242424"></path></mask><g filter="url(#logo-wordmark-pride_svg__filter0_f_238_6555)" mask="url(#logo-wordmark-pride_svg__a)"><path d="M42.3-64.7l-15.52-6.74L-24.62 47l15.53 6.74L42.3-64.7z" fill="#000"></path><path d="M53.18-59.98L42.3-64.7-9.1 53.74l10.88 4.72 51.4-118.44z" fill="#603917"></path><path d="M64.96-54.87l-11.78-5.11L1.78 58.46l11.79 5.11 51.4-118.44z" fill="#71E2FD"></path><path d="M75.84-50.15l-10.88-4.72-51.4 118.44 10.89 4.72L75.84-50.15z" fill="#FF9BC9"></path><path d="M86.71-45.43l-10.87-4.72L24.44 68.3l10.88 4.72 51.4-118.44z" fill="#FF472F"></path><path d="M97.6-40.7L86.7-45.44 35.32 73.01l10.88 4.72L97.6-40.7z" fill="#FF8312"></path><path d="M108.47-35.99L97.6-40.7 46.2 77.73l10.88 4.72 51.4-118.44z" fill="#FFCE00"></path><path d="M120.25-30.88l-11.78-5.1-51.4 118.43 11.79 5.11 51.4-118.44z" fill="#48E348"></path><path d="M131.13-26.16l-10.88-4.72L68.86 87.56l10.88 4.72 51.4-118.44z" fill="#008EF0"></path><path d="M148.48-18.63l-17.35-7.53-51.4 118.44 17.35 7.53 51.4-118.44z" fill="#9A50FC"></path></g><defs><filter id="logo-wordmark-pride_svg__filter0_f_238_6555" x="-29.5" y="-76.33" width="182.87" height="181.03" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood><feBlend in="SourceGraphic" in2="BackgroundImageFix" result="shape"></feBlend><feGaussianBlur stdDeviation="2.45" result="effect1_foregroundBlur_238_6555"></feGaussianBlur></filter></defs></svg></a><div class="aw h"><div class="ab ax ay az ba q bb bc"><div class="bl" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bm bn ab"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.1 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0zm6.94-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .8-.79l-3.74-3.73A8.05 8.05 0 0 0 11.04 3v.01z" fill="currentColor"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ax bd be bf z bg bh bi bj bk" placeholder="Search" value=""></div></div></div><div class="h k w ff fg"><div class="fh ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---two_column_layout_nav-----------------------new_post_topnav-----------" rel="noopener follow"><div class="be b bf z dt fi fj ab q fk fl"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-label="Write"><path d="M14 4a.5.5 0 0 0 0-1v1zm7 6a.5.5 0 0 0-1 0h1zm-7-7H4v1h10V3zM3 4v16h1V4H3zm1 17h16v-1H4v1zm17-1V10h-1v10h1zm-1 1a1 1 0 0 0 1-1h-1v1zM3 20a1 1 0 0 0 1 1v-1H3zM4 3a1 1 0 0 0-1 1h1V3z" fill="currentColor"></path><path d="M17.5 4.5l-8.46 8.46a.25.25 0 0 0-.06.1l-.82 2.47c-.07.2.12.38.31.31l2.47-.82a.25.25 0 0 0 .1-.06L19.5 6.5m-2-2l2.32-2.32c.1-.1.26-.1.36 0l1.64 1.64c.1.1.1.26 0 .36L19.5 6.5m-2-2l2 2" stroke="currentColor"></path></svg><div class="ds l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fh ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" href="https://medium.com/search?source=---two_column_layout_nav----------------------------------" rel="noopener follow"><div class="be b bf z dt fi fj ab q fk fl"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-label="Search"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.1 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0zm6.94-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .8-.79l-3.74-3.73A8.05 8.05 0 0 0 11.04 3v.01z" fill="currentColor"></path></svg></div></a></div></div><div class="fh h k j"><div class="ab q"><p class="be b dw dx dy dz ea eb ec ed ee ef dt"><span><a class="be b dw dx eg dy dz eh ea eb ei ej ed ek el ef em eo ep eq er es et eu ev ew ex ey ez fa fb fc bl fd fe" data-testid="headerSignUpButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcalling-home-get-your-callbacks-through-rbi-50633a233999&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign up</a></span></p><div class="aw l"><p class="be b dw dx dy dz ea eb ec ed ee ef dt"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcalling-home-get-your-callbacks-through-rbi-50633a233999&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ax fm am ab q ao fn fo fp" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fi"><img alt="" class="l fc bx by bz cw" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"><div class="fq bx l by bz fr n ax fs"></div></div></button></div></div></div><div class="l"><div class="rt" role="dialog" aria-modal="true" tabindex="-1"><div class="wu wv bg dv ua ww tw ao wx gl wy" aria-hidden="true" role="presentation"></div><div class="wz ua xa xb xc wu dv fc xd xe xf lu xg xh ub xi xj xk xl xm xn" aria-hidden="true"></div></div><div class="ft fu fv fw fx l"><div class="ab ca"><div class="ch bg fy fz ga gb"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fr gh gi gj gk gl"></div><div class="gm gn go gp gq"><div class="ab ca"><div class="ch bg fy fz ga gb"><div><h1 id="1d7c" class="pw-post-title gr gs gt be gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht bj" data-testid="storyTitle" data-selectable-paragraph="">Calling Home, Get Your Callbacks Through RBI</h1><div class="hu hv hw hx hy"><div class="speechify-ignore ab co"><div class="speechify-ignore bg l"><div class="hz ia ib ic id ab"><div><div class="ab ie"><a href="https://medium.com/@lbcain18?source=post_page-----50633a233999--------------------------------" rel="noopener follow"><div><div class="bl" aria-hidden="false" aria-describedby="1" aria-labelledby="1"><div class="l if ig bx ih ii"><div class="l fi"><img alt="Lance B. Cain" class="l fc bx dc dd cw" src="https://miro.medium.com/v2/da:true/resize:fill:88:88/0*v0d00TR4cFqVeADo" width="44" height="44" loading="lazy" data-testid="authorPhoto"><div class="ij bx l dc dd fr n ik fs"></div></div></div></div></div></a><a href="https://posts.specterops.io/?source=post_page-----50633a233999--------------------------------" rel="noopener  ugc nofollow"><div class="il ab fi"><div><div class="bl" aria-hidden="false" aria-describedby="2" aria-labelledby="2"><div class="l im in bx ih io"><div class="l fi"><img alt="Posts By SpecterOps Team Members" class="l fc bx bq ip cw" src="https://miro.medium.com/v2/resize:fill:48:48/1*D-FDlfkqivRBQZoESrwtqw.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto"><div class="ij bx l bq ip fr n ik fs"></div></div></div></div></div></div></a></div></div><div class="bm bg l"><div class="ab"><div style="flex:1"><span class="be b bf z bj"><div class="iq ab q"><div class="ab q ir"><div class="ab q"><div><div class="bl" aria-hidden="false" aria-describedby="3" aria-labelledby="3"><p class="be b is it bj"><a class="af ag ah ai aj ak al am an ao ap aq ar iu" data-testid="authorName" href="https://medium.com/@lbcain18?source=post_page-----50633a233999--------------------------------" rel="noopener follow">Lance B. Cain</a></p></div></div></div><span class="iv iw" aria-hidden="true"><span class="be b bf z dt">·</span></span><p class="be b is it dt"><span><a class="ix iy ah ai aj ak al am an ao ap aq ar ew iz ja" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F040c3e09d079&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcalling-home-get-your-callbacks-through-rbi-50633a233999&amp;user=Lance+B.+Cain&amp;userId=040c3e09d079&amp;source=post_page-040c3e09d079----50633a233999---------------------post_header-----------" rel="noopener follow">Follow</a></span></p></div></div></span></div></div><div class="l jb"><span class="be b bf z dt"><div class="ab cm jc jd je"><div class="jf jg ab"><div class="be b bf z dt ab jh"><span class="ji l jb">Published in</span><div><div class="l" aria-hidden="false" aria-describedby="4" aria-labelledby="4"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" data-testid="publicationName" href="https://posts.specterops.io/?source=post_page-----50633a233999--------------------------------" rel="noopener  ugc nofollow"><p class="be b bf z jj jk jl jm jn jo jp jq bj">Posts By SpecterOps Team Members</p></a></div></div></div><div class="h k"><span class="iv iw" aria-hidden="true"><span class="be b bf z dt">·</span></span></div></div><span class="be b bf z dt"><div class="ab ae"><span data-testid="storyReadTime">18 min read</span><div class="jr js l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="be b bf z dt">·</span></span></div><span data-testid="storyPublishDate">Jan 17, 2024</span></div></span></div></span></div></div></div><div class="ab co jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki"><div class="h k w ff fg q"><div class="ky l"><div class="ab q kz la"><div class="pw-multi-vote-icon fi ji lb lc ld"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspecter-ops-posts%2F50633a233999&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcalling-home-get-your-callbacks-through-rbi-50633a233999&amp;user=Lance+B.+Cain&amp;userId=040c3e09d079&amp;source=-----50633a233999---------------------clap_footer-----------" rel="noopener follow"><div><div class="bl" aria-hidden="false" aria-describedby="5" aria-labelledby="5"><div class="le ao lf lg lh li am lj lk ll ld"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lm ln lo lp lq lr ls"><div><div class="bl" aria-hidden="false" aria-describedby="78" aria-labelledby="78"><p class="be b du z dt"><button class="af ag ah ai aj ak al am an ao ap aq ar as at yt ma">9<span class="l h g f ry rz"></span></button></p></div></div></div></div></div><div><div class="bl" aria-hidden="false" aria-describedby="6" aria-labelledby="6"><button class="ao le lu lv ab q fj lw lx" aria-label="responses"><svg width="24" height="24" viewBox="0 0 24 24" class="ly"><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></button></div></div></div><div class="ab q kj kk kl km kn ko kp kq kr ks kt ku kv kw kx"><div class="lz k j i d"></div><div class="h k"><div><div class="bl" aria-hidden="false" aria-describedby="7" aria-labelledby="7"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F50633a233999&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcalling-home-get-your-callbacks-through-rbi-50633a233999&amp;source=-----50633a233999---------------------bookmark_footer-----------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div><div class="fc mb cm"><div class="l ae"><div class="ab ca"><div class="mc md me mf mg mh ch bg"><div class="ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2Fplans%3Fdimension%3Dpost_audio_button%26postId%3D50633a233999&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcalling-home-get-your-callbacks-through-rbi-50633a233999&amp;source=-----50633a233999---------------------post_audio_button-----------" rel="noopener follow"><div><div class="bl" aria-hidden="false" aria-describedby="26" aria-labelledby="26"><button aria-label="Listen" data-testid="audioPlayButton" class="af fj ah ai aj ak al mi an ao ap ew mj mk lx ml mm mn mo mp s mq mr ms mt mu mv mw u mx my mz"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0zm9-10a10 10 0 1 0 0 20 10 10 0 0 0 0-20zm3.38 10.42l-4.6 3.06a.5.5 0 0 1-.78-.41V8.93c0-.4.45-.63.78-.41l4.6 3.06c.3.2.3.64 0 .84z" fill="currentColor"></path></svg><div class="j i d"><p class="be b bf z dt">Listen</p></div></button></div></div></a></span></div></div></div></div></div><div class="bl" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bl" aria-hidden="false" aria-describedby="9" aria-labelledby="9"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fj ah ai aj ak al mi an ao ap ew mj mk lx ml mm mn mo mp s mq mr ms mt mu mv mw u mx my mz"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.22 4.93a.42.42 0 0 1-.12.13h.01a.45.45 0 0 1-.29.08.52.52 0 0 1-.3-.13L12.5 3v7.07a.5.5 0 0 1-.5.5.5.5 0 0 1-.5-.5V3.02l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.8a.42.42 0 0 1 .07.5zm-.1.14zm.88 2h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11a2 2 0 0 1-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.14c.1.1.15.22.15.35a.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9V8.96c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1z" fill="currentColor"></path></svg><div class="j i d"><p class="be b bf z dt">Share</p></div></button></div></div></div></div></div></div></div></div></div><p id="8707" class="pw-post-body-paragraph na nb gt nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gm bj" data-selectable-paragraph=""><em class="ny">Authored By: </em><div class="bl so"><div><div class="bl" aria-hidden="false" aria-describedby="83" aria-labelledby="83"><a class="nz ix fd" href="https://medium.com/u/040c3e09d079?source=post_page-----50633a233999--------------------------------" rel="noopener" target="_blank">Lance B. Cain</a></div></div></div><em class="ny"> and </em><div class="bl so"><div><div class="bl" aria-hidden="false" aria-describedby="84" aria-labelledby="84"><a class="nz ix fd" href="https://medium.com/u/de29a5193240?source=post_page-----50633a233999--------------------------------" rel="noopener" target="_blank"><em class="ny">Alexander DeMine</em></a></div></div></div></p><h1 id="1451" class="oa ob gt be oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov ow ox bj" data-selectable-paragraph="">Overview</h1><p id="f7f7" class="pw-post-body-paragraph na nb gt nc b nd oy nf ng nh oz nj nk nl pa nn no np pb nr ns nt pc nv nw nx gm bj" data-selectable-paragraph="">Remote Browser Isolation (RBI) is a security technology which has been gaining popularity for large businesses securing their enterprise networks in recent years. This blog post describes methods that SpecterOps consultants have researched to successfully circumvent this technology during offensive assessments. Following a brief introduction to the technology, we share our firsthand experiences when encountering RBI solutions and techniques the SpecterOps team have employed for establishing command and control (C2) to systems that proxy traffic through RBI products broken down into three segments: <a class="af pd" href="#ca1b" rel="noopener ugc nofollow"><strong class="nc gu">Payload Ingress</strong></a>, <a class="af pd" href="#18e8" rel="noopener ugc nofollow"><strong class="nc gu">C2 Egress</strong></a>, and <a class="af pd" href="#f257" rel="noopener ugc nofollow"><strong class="nc gu">RBI Bypass</strong></a>. This post then concludes with us sharing our perspective regarding the recommendation of RBIs as a defensive product for the modern enterprise.</p><h1 id="e710" class="oa ob gt be oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov ow ox bj" data-selectable-paragraph="">What is RBI and Why Use It?</h1><p id="f7b2" class="pw-post-body-paragraph na nb gt nc b nd oy nf ng nh oz nj nk nl pa nn no np pb nr ns nt pc nv nw nx gm bj" data-selectable-paragraph="">Browser isolation is a security concept in which a user’s web traffic is isolated in a virtual machine, hosted web browser, or some other manner to prevent malicious activities from reaching the end user; thereby lowering the general risk of web browsing. There are three types of browser isolation in use today: client-side browser isolation, on-premises browser isolation, and RBI. As these names imply, client-side virtualizes the browsing on the local host, on-premises runs within the organization, and RBI virtualizes the web sessions in the cloud. Each type of browser isolation has different pros and cons, but we will focus on RBI today.</p><p id="582c" class="pw-post-body-paragraph na nb gt nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gm bj" data-selectable-paragraph="">The general concept of RBI is relatively simple. When users open their web browser to surf the web, they are not merely doing so from their local machine; rather, they are connecting to a cloud-hosted virtualized browser in which all web content is rendered and executed and then sent back to the end-user in a sanitized manner (Figure 1). Different vendors stream the content to the user differently, but it is sufficient to say they all do the same thing: sanitize and render client web traffic.</p><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fi pp bg pq"><div class="pe pf pg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*EJZIdvkDgdThnyDr0mV5MA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*EJZIdvkDgdThnyDr0mV5MA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*EJZIdvkDgdThnyDr0mV5MA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*EJZIdvkDgdThnyDr0mV5MA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*EJZIdvkDgdThnyDr0mV5MA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*EJZIdvkDgdThnyDr0mV5MA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EJZIdvkDgdThnyDr0mV5MA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*EJZIdvkDgdThnyDr0mV5MA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*EJZIdvkDgdThnyDr0mV5MA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*EJZIdvkDgdThnyDr0mV5MA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*EJZIdvkDgdThnyDr0mV5MA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*EJZIdvkDgdThnyDr0mV5MA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*EJZIdvkDgdThnyDr0mV5MA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*EJZIdvkDgdThnyDr0mV5MA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bg mh pr c" width="700" height="351" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*EJZIdvkDgdThnyDr0mV5MA.png"></picture></div></div><figcaption class="ps fe pt pe pf pu pv be b bf z dt" data-selectable-paragraph=""><em class="pw">Figure 1 — Cloudflare RBI Diagram</em></figcaption></figure><p id="26cb" class="pw-post-body-paragraph na nb gt nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gm bj" data-selectable-paragraph="">The primary focus of RBI is to prevent user interactions with web-based malware such as cross-site scripting (XSS), drive-by downloads, and various forms of malicious JavaScript. In this function, it does an excellent job. It is tough to get a user to fall for your finely crafted HTML smuggling attack when the webpage never actually makes it to the end user; their browser just shows a stream of pixels while the content renders on a separate system.</p><h1 id="ebd8" class="oa ob gt be oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov ow ox bj" data-selectable-paragraph="">Why Do We Care?</h1><p id="f695" class="pw-post-body-paragraph na nb gt nc b nd oy nf ng nh oz nj nk nl pa nn no np pb nr ns nt pc nv nw nx gm bj" data-selectable-paragraph="">At this point, you may ask yourself, “I don’t really do web-based attacks. Why should I care?” Well, my friend, RBI has many more implications than what the vendors provide at face value. Most RBI security vendors supplement their solution with extra email protections to block the delivery of malware via user inboxes along with scanning, sanitizing, and blocking malicious downloads from any site. Additionally, one of the primary concerns you should have as an offensive professional is the profound impact RBI will likely have on your C2 traffic.</p><p id="05e5" class="pw-post-body-paragraph na nb gt nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gm bj" data-selectable-paragraph="">It is not generally advertised on the product pages that RBI affects C2 traffic, but we promise you it does. Most RBI solutions we have dealt with are not set up to send individual browser sessions to a cloud-virtualized host. They may offer a link where a user can do that, but an organization usually has a proxy setup that sends <strong class="nc gu">ALL </strong>web traffic through RBI. This means your stealthy HTTPS C2 traffic gets sent through the same virtualized host process the same as everything else and results in the server responses to your agents being rendered as an inert stream. As you can probably imagine, trying to figure out why your C2 traffic is not returning when an organization uses RBI can be very frustrating.</p><p id="6b56" class="pw-post-body-paragraph na nb gt nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gm bj" data-selectable-paragraph="">If your next engagement has RBI in place to protect their web traffic; what do you do? Fear not, dear reader; we have asked the same question and are here to help you work through it. We categorize our suggested techniques into three categories:<strong class="nc gu"> </strong>ingress, egress, and bypass. Ingress is pretty self-explanatory, but you may wonder why egress and bypass are separated. In our opinion, they are similar but distinctly different techniques concerning RBI. Egress can be summarized as getting your C2 traffic to call back using traffic that communicates “through” the RBI solution, while bypass (as the name implies) means we are taking a different route entirely by avoiding RBI solutions.</p><h1 id="ca1b" class="oa ob gt be oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov ow ox bj" data-selectable-paragraph="">Payload Ingress</h1><p id="a14a" class="pw-post-body-paragraph na nb gt nc b nd oy nf ng nh oz nj nk nl pa nn no np pb nr ns nt pc nv nw nx gm bj" data-selectable-paragraph="">When delivering payloads to clients through RBI solutions, these solutions’ sandboxing and scanning capabilities present significant hurdles that must be overcome to achieve code execution in your target environment. RBI solutions typically allow the configuration of file upload and download profiles, restricting the types of files that can be submitted or retrieved from websites based on multiple factors such as file extension, size, entropy/encryption of data, signatures, site reputation, and more. As is tradition, different vendors implement these checks in diverse ways, so you will want to brush up on what the target organization is using to give your payloads the best chance of making it through these defensive solutions, but we have some generalized recommendations to help with that.</p><h2 id="a302" class="px ob gt be oc py pz dx og qa qb dz ok nl qc qd qe np qf qg qh nt qi qj qk ql bj" data-selectable-paragraph="">Sandbox Evasion and System Checks</h2><p id="ebf6" class="pw-post-body-paragraph na nb gt nc b nd oy nf ng nh oz nj nk nl pa nn no np pb nr ns nt pc nv nw nx gm bj" data-selectable-paragraph="">These two considerations should hopefully be standard in most of your payloads, but you will want to implement them if you haven’t already. Utilizing standard techniques such as prime factorization, thread sleep checks, executing environment checks/guardrails like enumerating processors in a system, string obfuscation, string building, non-terminating conditional-based loops, and logic structures relying on user input will help you get through the RBI scanning process. Why? Well, the RBI solutions need to attempt to scan, sandbox, and evaluate the files they are proxying to users without causing too much of a burden on the user’s browsing experience. Slow browsing leads to unhappy users and unhappy users lead to security products being removed. By increasing the time it takes to evaluate a file, we can bypass some RBI products that, by default, are set to a fail-open state (i.e., if they cannot scan a file in a sufficient amount of time nor detect malicious logic while executing it in a sandbox, then it will just let the file through).</p><h2 id="d0f4" class="px ob gt be oc py pz dx og qa qb dz ok nl qc qd qe np qf qg qh nt qi qj qk ql bj" data-selectable-paragraph="">Antivirus Inspection</h2><p id="acaa" class="pw-post-body-paragraph na nb gt nc b nd oy nf ng nh oz nj nk nl pa nn no np pb nr ns nt pc nv nw nx gm bj" data-selectable-paragraph="">Not all RBI products will prioritize this time factor. Some may only allow a user to view the file contents in the browser or allow the user to download a sanitized version of the file in which the product removes macros, JavaScript, or any other content the vendor deems may be suspicious; leaving the user with an inert download. Other RBI solutions are set to a fail-closed state that blocks the download of a file if it cannot scan it. This can be due to encryption or even size. For example, Cloudflare Zero Trust blocks uploads and downloads of encrypted, password-protected files or files larger than 15MB by default because it cannot scan those files.</p><p id="34d1" class="pw-post-body-paragraph na nb gt nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gm bj" data-selectable-paragraph="">If we cannot send an encrypted payload because AV will block it since it cannot scan it, but we also cannot send an unencrypted payload because it will fail an AV check and get blocked, then what do we do? In our experience, obfuscation techniques like encoding data with Caesar ciphers and sandbox evasion checks have proven successful when delivering payloads through RBI solutions. Encoding using a technique with low entropy often has the products scan the delivered files since they are not fully encrypted. However, environment checks, large prime factorization calculations, and non-terminating loops relying on user input prevent the sandbox analysis from observing malicious logic execution since these cannot supply additional input or meet the environment requirements.</p><h2 id="da8c" class="px ob gt be oc py pz dx og qa qb dz ok nl qc qd qe np qf qg qh nt qi qj qk ql bj" data-selectable-paragraph="">Users Are Still a Weak Point</h2><p id="0ba0" class="pw-post-body-paragraph na nb gt nc b nd oy nf ng nh oz nj nk nl pa nn no np pb nr ns nt pc nv nw nx gm bj" data-selectable-paragraph="">The additional challenges RBI solutions present mean we likely need to leverage the human factor to deliver payloads successfully. Although not impossible, the likelihood of bypassing the RBI in a technical manner is low. However, people are naturally curious, and like any good campaign, enticing the user to pull the payload to their system is often the preferred way to go.</p><p id="2224" class="pw-post-body-paragraph na nb gt nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gm bj" data-selectable-paragraph="">When creating payloads such as Office documents, <em class="ny">.pdf </em>files, etc., that serve as an initial dropper capability, it is imperative to design them with hidden content or obfuscation that forces user interaction. Requiring user-supplied values such as passwords to access content increases the likelihood of successful payload detonation and delivery. With user input required, it is unlikely that an RBI solution will be capable of supplying a password or clicking a user engagement button/checkbox when sandboxing a payload and, therefore, cannot detonate any malicious logic during analysis. Be mindful of how you implement the password, though, as fully encrypting a document with a password may get the file blocked since it cannot be scanned. If a user is presented with a rendered document that is obfuscated/unreadable in the RBI browser rendering or sanitized version, they will be enticed to download the document locally and execute the included payload.</p><p id="0312" class="pw-post-body-paragraph na nb gt nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gm bj" data-selectable-paragraph="">Let us move into some demonstrations on payload ingress. We will use Cloudflare’s Zero Trust RBI solution for the demonstrations in this post. This is by no means any slight against Cloudflare’s product; it does its job well and we are fans of it. It just happened to be the solution we were actually able to get our hands on at a reasonable price, which we also see as a good thing as they make RBI reasonably available for most people. We will not be covering any phishing portions of the task, instead leaving that to the reader and presuming the user has reached the point of downloading and executing our payload. During these demonstrations, we are using the Mythic framework with the Apollo agent.</p><p id="63f1" class="pw-post-body-paragraph na nb gt nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gm bj" data-selectable-paragraph="">First, we will use a straightforward HTTP C2 profile configuration going to our testing C2 domain (i.e., <em class="ny">HTTPS://WWW.HALFLINGHIDEOUT.COM</em>) with a standard accept header and user agent (Figure 2).</p><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fi pp bg pq"><div class="pe pf pg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*CcxaxlT11fiUgHTjbMc4jg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*CcxaxlT11fiUgHTjbMc4jg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*CcxaxlT11fiUgHTjbMc4jg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*CcxaxlT11fiUgHTjbMc4jg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*CcxaxlT11fiUgHTjbMc4jg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*CcxaxlT11fiUgHTjbMc4jg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CcxaxlT11fiUgHTjbMc4jg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*CcxaxlT11fiUgHTjbMc4jg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*CcxaxlT11fiUgHTjbMc4jg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*CcxaxlT11fiUgHTjbMc4jg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*CcxaxlT11fiUgHTjbMc4jg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*CcxaxlT11fiUgHTjbMc4jg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*CcxaxlT11fiUgHTjbMc4jg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*CcxaxlT11fiUgHTjbMc4jg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bg mh pr c" width="700" height="525" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*CcxaxlT11fiUgHTjbMc4jg.png"></picture></div></div><figcaption class="ps fe pt pe pf pu pv be b bf z dt" data-selectable-paragraph=""><em class="pw">Figure 2 — HTTP C2 Profile Configuration</em></figcaption></figure><p id="cd52" class="pw-post-body-paragraph na nb gt nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gm bj" data-selectable-paragraph="">In testing the payload, we can see that in Burp Suite it is successfully reaching back to Mythic through our redirectors (Figure 3).</p><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fi pp bg pq"><div class="pe pf pg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*frzXhsZfrBzbliXfMRstGw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*frzXhsZfrBzbliXfMRstGw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*frzXhsZfrBzbliXfMRstGw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*frzXhsZfrBzbliXfMRstGw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*frzXhsZfrBzbliXfMRstGw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*frzXhsZfrBzbliXfMRstGw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*frzXhsZfrBzbliXfMRstGw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*frzXhsZfrBzbliXfMRstGw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*frzXhsZfrBzbliXfMRstGw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*frzXhsZfrBzbliXfMRstGw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*frzXhsZfrBzbliXfMRstGw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*frzXhsZfrBzbliXfMRstGw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*frzXhsZfrBzbliXfMRstGw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*frzXhsZfrBzbliXfMRstGw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bg mh pr c" width="700" height="291" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*frzXhsZfrBzbliXfMRstGw.png"></picture></div></div><figcaption class="ps fe pt pe pf pu pv be b bf z dt" data-selectable-paragraph="">Figure 3 — Tested C2 Callback Successful</figcaption></figure><p id="6096" class="pw-post-body-paragraph na nb gt nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gm bj" data-selectable-paragraph="">For our initial payload delivery, we are using a ClickOnce application. If you want to know more about abusing ClickOnce applications, we highly recommend you check out the blog post Nick Powers (<a class="af pd" href="https://twitter.com/zyn3rgy" rel="noopener ugc nofollow" target="_blank">@zyn3rgy</a>) and Steven Flores (<a class="af pd" href="https://twitter.com/0xthirteen" rel="noopener ugc nofollow" target="_blank">@0xthirteen</a>) posted on the subject: <a class="af pd" rel="noopener ugc nofollow" target="_blank" href="/less-smartscreen-more-caffeine-ab-using-clickonce-for-trusted-code-execution-1446ea8051c5">Less Smartscreen More Caffeine: (Ab)using ClickOnce for Trusted Code Execution</a>. In standard ClickOnce fashion, we click the application file and are prompted with the application run prompt security warning; clicking “Run” starts the installation (Figure 4).</p><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fi pp bg pq"><div class="pe pf pg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Wzujuz2FHrpJEBE5q_WpsA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Wzujuz2FHrpJEBE5q_WpsA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Wzujuz2FHrpJEBE5q_WpsA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Wzujuz2FHrpJEBE5q_WpsA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Wzujuz2FHrpJEBE5q_WpsA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Wzujuz2FHrpJEBE5q_WpsA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wzujuz2FHrpJEBE5q_WpsA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*Wzujuz2FHrpJEBE5q_WpsA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Wzujuz2FHrpJEBE5q_WpsA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Wzujuz2FHrpJEBE5q_WpsA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Wzujuz2FHrpJEBE5q_WpsA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Wzujuz2FHrpJEBE5q_WpsA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Wzujuz2FHrpJEBE5q_WpsA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Wzujuz2FHrpJEBE5q_WpsA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bg mh pr c" width="700" height="472" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*Wzujuz2FHrpJEBE5q_WpsA.png"></picture></div></div><figcaption class="ps fe pt pe pf pu pv be b bf z dt" data-selectable-paragraph=""><em class="pw">Figure 4 — ClickOnce Application Security Warning</em></figcaption></figure><p id="81ae" class="pw-post-body-paragraph na nb gt nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gm bj" data-selectable-paragraph="">However, halfway through the installation, we encounter an error message. The application cannot retrieve all the files, corrupting the installation (Figure 5).</p><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fi pp bg pq"><div class="pe pf pg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ybbxNSN079RcTvSbPCg4pQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ybbxNSN079RcTvSbPCg4pQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ybbxNSN079RcTvSbPCg4pQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ybbxNSN079RcTvSbPCg4pQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ybbxNSN079RcTvSbPCg4pQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ybbxNSN079RcTvSbPCg4pQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ybbxNSN079RcTvSbPCg4pQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*ybbxNSN079RcTvSbPCg4pQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ybbxNSN079RcTvSbPCg4pQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ybbxNSN079RcTvSbPCg4pQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ybbxNSN079RcTvSbPCg4pQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ybbxNSN079RcTvSbPCg4pQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ybbxNSN079RcTvSbPCg4pQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ybbxNSN079RcTvSbPCg4pQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bg mh pr c" width="700" height="256" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*ybbxNSN079RcTvSbPCg4pQ.png"></picture></div></div><figcaption class="ps fe pt pe pf pu pv be b bf z dt" data-selectable-paragraph=""><em class="pw">Figure 5 — ClickOnce Application Installation Error</em></figcaption></figure><p id="ac8c" class="pw-post-body-paragraph na nb gt nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gm bj" data-selectable-paragraph="">By digging into the details, we can see that the issue lies in the <em class="ny">Syncfusion.Tools.Window</em>s<em class="ny">.dll</em> file (Figure 6). Furthermore, we can see in the Cloudflare gateway logs that the file was blocked for failing the AV scan (Figure 7 and Figure 8).</p><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fi pp bg pq"><div class="pe pf pg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*WcMo6WuCEH7rWhiK2H3zDg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*WcMo6WuCEH7rWhiK2H3zDg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*WcMo6WuCEH7rWhiK2H3zDg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*WcMo6WuCEH7rWhiK2H3zDg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*WcMo6WuCEH7rWhiK2H3zDg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*WcMo6WuCEH7rWhiK2H3zDg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WcMo6WuCEH7rWhiK2H3zDg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*WcMo6WuCEH7rWhiK2H3zDg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*WcMo6WuCEH7rWhiK2H3zDg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*WcMo6WuCEH7rWhiK2H3zDg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*WcMo6WuCEH7rWhiK2H3zDg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*WcMo6WuCEH7rWhiK2H3zDg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*WcMo6WuCEH7rWhiK2H3zDg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*WcMo6WuCEH7rWhiK2H3zDg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bg mh pr c" width="700" height="51" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*WcMo6WuCEH7rWhiK2H3zDg.png"></picture></div></div><figcaption class="ps fe pt pe pf pu pv be b bf z dt" data-selectable-paragraph=""><em class="pw">Figure 6 — ClickOnce Application Error Details</em></figcaption></figure><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fi pp bg pq"><div class="pe pf pg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*MJErTHKLR-P3wA0tRENvJQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*MJErTHKLR-P3wA0tRENvJQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*MJErTHKLR-P3wA0tRENvJQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*MJErTHKLR-P3wA0tRENvJQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*MJErTHKLR-P3wA0tRENvJQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*MJErTHKLR-P3wA0tRENvJQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MJErTHKLR-P3wA0tRENvJQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*MJErTHKLR-P3wA0tRENvJQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*MJErTHKLR-P3wA0tRENvJQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*MJErTHKLR-P3wA0tRENvJQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*MJErTHKLR-P3wA0tRENvJQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*MJErTHKLR-P3wA0tRENvJQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*MJErTHKLR-P3wA0tRENvJQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*MJErTHKLR-P3wA0tRENvJQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bg mh pr c" width="700" height="26" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*MJErTHKLR-P3wA0tRENvJQ.png"></picture></div></div><figcaption class="ps fe pt pe pf pu pv be b bf z dt" data-selectable-paragraph=""><em class="pw">Figure 7 — Cloudflare Block Log</em></figcaption></figure><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div class="pe pf qm"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*41EJEEiOm9xaHtCMA5d_Bw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*41EJEEiOm9xaHtCMA5d_Bw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*41EJEEiOm9xaHtCMA5d_Bw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*41EJEEiOm9xaHtCMA5d_Bw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*41EJEEiOm9xaHtCMA5d_Bw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*41EJEEiOm9xaHtCMA5d_Bw.png 1100w, https://miro.medium.com/v2/resize:fit:766/format:webp/1*41EJEEiOm9xaHtCMA5d_Bw.png 766w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 383px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*41EJEEiOm9xaHtCMA5d_Bw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*41EJEEiOm9xaHtCMA5d_Bw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*41EJEEiOm9xaHtCMA5d_Bw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*41EJEEiOm9xaHtCMA5d_Bw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*41EJEEiOm9xaHtCMA5d_Bw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*41EJEEiOm9xaHtCMA5d_Bw.png 1100w, https://miro.medium.com/v2/resize:fit:766/1*41EJEEiOm9xaHtCMA5d_Bw.png 766w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 383px"><img alt="" class="bg mh pr c" width="383" height="279" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:479/1*41EJEEiOm9xaHtCMA5d_Bw.png"></picture></div><figcaption class="ps fe pt pe pf pu pv be b bf z dt" data-selectable-paragraph=""><em class="pw">Figure 8 — Cloudflare Block Log Details</em></figcaption></figure><p id="3df8" class="pw-post-body-paragraph na nb gt nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gm bj" data-selectable-paragraph="">We know this file does not contain malicious content, but if we check the setting on our Cloudflare setup, we can confirm that the default setting that blocks all requests that cannot be scanned is the issue because the file is too large (Figure 9). We will not be able to get our payload in this way if we cannot get all of our application files in. If we dig into the documentation, we can get the complete set of information on the non-scannable files (Figure 10). The default setting for Cloudflare is to fail-closed.</p><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fi pp bg pq"><div class="pe pf pg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*4_NyZxJi5a6jyQr_Smp6mw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*4_NyZxJi5a6jyQr_Smp6mw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*4_NyZxJi5a6jyQr_Smp6mw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*4_NyZxJi5a6jyQr_Smp6mw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*4_NyZxJi5a6jyQr_Smp6mw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*4_NyZxJi5a6jyQr_Smp6mw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4_NyZxJi5a6jyQr_Smp6mw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*4_NyZxJi5a6jyQr_Smp6mw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*4_NyZxJi5a6jyQr_Smp6mw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*4_NyZxJi5a6jyQr_Smp6mw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*4_NyZxJi5a6jyQr_Smp6mw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*4_NyZxJi5a6jyQr_Smp6mw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*4_NyZxJi5a6jyQr_Smp6mw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*4_NyZxJi5a6jyQr_Smp6mw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bg mh pr c" width="700" height="171" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*4_NyZxJi5a6jyQr_Smp6mw.png"></picture></div></div><figcaption class="ps fe pt pe pf pu pv be b bf z dt" data-selectable-paragraph=""><em class="pw">Figure 9 — Cloudflare Network Settings</em></figcaption></figure><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fi pp bg pq"><div class="pe pf pg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*tzFhDQBZgrjCY3vGktko3g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*tzFhDQBZgrjCY3vGktko3g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*tzFhDQBZgrjCY3vGktko3g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*tzFhDQBZgrjCY3vGktko3g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*tzFhDQBZgrjCY3vGktko3g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*tzFhDQBZgrjCY3vGktko3g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tzFhDQBZgrjCY3vGktko3g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*tzFhDQBZgrjCY3vGktko3g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*tzFhDQBZgrjCY3vGktko3g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*tzFhDQBZgrjCY3vGktko3g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*tzFhDQBZgrjCY3vGktko3g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*tzFhDQBZgrjCY3vGktko3g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*tzFhDQBZgrjCY3vGktko3g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*tzFhDQBZgrjCY3vGktko3g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bg mh pr c" width="700" height="378" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*tzFhDQBZgrjCY3vGktko3g.png"></picture></div></div><figcaption class="ps fe pt pe pf pu pv be b bf z dt" data-selectable-paragraph=""><em class="pw">Figure 10 — Cloudflare Documentation</em></figcaption></figure><p id="fcac" class="pw-post-body-paragraph na nb gt nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gm bj" data-selectable-paragraph="">Since our initial ClickOnce route did not work, let’s change tactics. We can swap our delivery vector to a ISO image file (<em class="ny">.iso</em>) with a macro-embedded Excel file (<em class="ny">.xlsm</em>). The Excel file is obfuscated and uses a password to protect the content; however, we are protecting it via the macro instead of Excel’s standard password protection encryption. We do this so Cloudflare can still scan the file, but the scanner will not make it past the password prompt when running sandboxed analysis. With everything loaded up and sent, we can see that we can download the <em class="ny">.iso </em>file instead of getting blocked like our previous ClickOnce attempt (Figure 11).</p><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fi pp bg pq"><div class="pe pf pg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*lb74KTDIkvBZAdAqNjQfrg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*lb74KTDIkvBZAdAqNjQfrg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*lb74KTDIkvBZAdAqNjQfrg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*lb74KTDIkvBZAdAqNjQfrg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*lb74KTDIkvBZAdAqNjQfrg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*lb74KTDIkvBZAdAqNjQfrg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lb74KTDIkvBZAdAqNjQfrg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*lb74KTDIkvBZAdAqNjQfrg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*lb74KTDIkvBZAdAqNjQfrg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*lb74KTDIkvBZAdAqNjQfrg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*lb74KTDIkvBZAdAqNjQfrg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*lb74KTDIkvBZAdAqNjQfrg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*lb74KTDIkvBZAdAqNjQfrg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*lb74KTDIkvBZAdAqNjQfrg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bg mh pr c" width="700" height="354" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*lb74KTDIkvBZAdAqNjQfrg.png"></picture></div></div><figcaption class="ps fe pt pe pf pu pv be b bf z dt" data-selectable-paragraph=""><em class="pw">Figure 11 — Successful ISO Download</em></figcaption></figure><p id="5697" class="pw-post-body-paragraph na nb gt nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gm bj" data-selectable-paragraph="">Next, we double-click the ISO file and select “Open” to mount it (Figure 12). Then, we drag the Excel file to our desktop, so we do not have the Windows <a class="af pd" href="https://learn.microsoft.com/en-us/deployoffice/security/internet-macros-blocked#mark-of-the-web-and-trusted-documents" rel="noopener ugc nofollow" target="_blank">Mark-of-the-Web</a> on it (Figure 13).</p><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div class="pe pf qn"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Vlr0CqyLdhqDzgK4v7DuAQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Vlr0CqyLdhqDzgK4v7DuAQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Vlr0CqyLdhqDzgK4v7DuAQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Vlr0CqyLdhqDzgK4v7DuAQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Vlr0CqyLdhqDzgK4v7DuAQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Vlr0CqyLdhqDzgK4v7DuAQ.png 1100w, https://miro.medium.com/v2/resize:fit:856/format:webp/1*Vlr0CqyLdhqDzgK4v7DuAQ.png 856w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 428px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*Vlr0CqyLdhqDzgK4v7DuAQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Vlr0CqyLdhqDzgK4v7DuAQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Vlr0CqyLdhqDzgK4v7DuAQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Vlr0CqyLdhqDzgK4v7DuAQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Vlr0CqyLdhqDzgK4v7DuAQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Vlr0CqyLdhqDzgK4v7DuAQ.png 1100w, https://miro.medium.com/v2/resize:fit:856/1*Vlr0CqyLdhqDzgK4v7DuAQ.png 856w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 428px"><img alt="" class="bg mh pr c" width="428" height="349" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:535/1*Vlr0CqyLdhqDzgK4v7DuAQ.png"></picture></div><figcaption class="ps fe pt pe pf pu pv be b bf z dt" data-selectable-paragraph=""><em class="pw">Figure 12 — ISO Mounting Security Warning</em></figcaption></figure><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div class="pe pf qo"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*QAGoKprnja9TTQ6F 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*QAGoKprnja9TTQ6F 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*QAGoKprnja9TTQ6F 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*QAGoKprnja9TTQ6F 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*QAGoKprnja9TTQ6F 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*QAGoKprnja9TTQ6F 1100w, https://miro.medium.com/v2/resize:fit:1200/format:webp/0*QAGoKprnja9TTQ6F 1200w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 600px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/0*QAGoKprnja9TTQ6F 640w, https://miro.medium.com/v2/resize:fit:720/0*QAGoKprnja9TTQ6F 720w, https://miro.medium.com/v2/resize:fit:750/0*QAGoKprnja9TTQ6F 750w, https://miro.medium.com/v2/resize:fit:786/0*QAGoKprnja9TTQ6F 786w, https://miro.medium.com/v2/resize:fit:828/0*QAGoKprnja9TTQ6F 828w, https://miro.medium.com/v2/resize:fit:1100/0*QAGoKprnja9TTQ6F 1100w, https://miro.medium.com/v2/resize:fit:1200/0*QAGoKprnja9TTQ6F 1200w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 600px"><img alt="" class="bg mh pr c" width="600" height="338" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:750/0*QAGoKprnja9TTQ6F"></picture></div><figcaption class="ps fe pt pe pf pu pv be b bf z dt" data-selectable-paragraph=""><em class="pw">Figure 13 — Excel Export</em></figcaption></figure><p id="ea16" class="pw-post-body-paragraph na nb gt nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gm bj" data-selectable-paragraph="">When we open the Excel file, we see what appears to be encrypted contents, and the warning asks us if we want to enable the macro. The content is hidden to entice the user to enable the macros. Once we enable the macros, we are prompted to input a decryption password (Figure 14). When the password is entered, Excel tells us we have started decrypting (Figure 15), and finally, we switch out the shown sheets, and the content is shown to the user (Figure 16). On the backend of this process, the macro is writing our payload to disk and executing it.</p><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fi pp bg pq"><div class="pe pf pg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*d_PI6LypODmtpJhNzruEbg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*d_PI6LypODmtpJhNzruEbg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*d_PI6LypODmtpJhNzruEbg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*d_PI6LypODmtpJhNzruEbg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*d_PI6LypODmtpJhNzruEbg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*d_PI6LypODmtpJhNzruEbg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d_PI6LypODmtpJhNzruEbg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*d_PI6LypODmtpJhNzruEbg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*d_PI6LypODmtpJhNzruEbg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*d_PI6LypODmtpJhNzruEbg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*d_PI6LypODmtpJhNzruEbg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*d_PI6LypODmtpJhNzruEbg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*d_PI6LypODmtpJhNzruEbg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*d_PI6LypODmtpJhNzruEbg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bg mh pr c" width="700" height="334" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*d_PI6LypODmtpJhNzruEbg.png"></picture></div></div><figcaption class="ps fe pt pe pf pu pv be b bf z dt" data-selectable-paragraph=""><em class="pw">Figure 14 — Macro Password Protected Excel</em></figcaption></figure><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div class="pe pf qp"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*fvUmDFzRRTUJN-Fy9pK1Zg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*fvUmDFzRRTUJN-Fy9pK1Zg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*fvUmDFzRRTUJN-Fy9pK1Zg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*fvUmDFzRRTUJN-Fy9pK1Zg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*fvUmDFzRRTUJN-Fy9pK1Zg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*fvUmDFzRRTUJN-Fy9pK1Zg.png 1100w, https://miro.medium.com/v2/resize:fit:940/format:webp/1*fvUmDFzRRTUJN-Fy9pK1Zg.png 940w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 470px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*fvUmDFzRRTUJN-Fy9pK1Zg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*fvUmDFzRRTUJN-Fy9pK1Zg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*fvUmDFzRRTUJN-Fy9pK1Zg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*fvUmDFzRRTUJN-Fy9pK1Zg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*fvUmDFzRRTUJN-Fy9pK1Zg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*fvUmDFzRRTUJN-Fy9pK1Zg.png 1100w, https://miro.medium.com/v2/resize:fit:940/1*fvUmDFzRRTUJN-Fy9pK1Zg.png 940w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 470px"><img alt="" class="bg mh pr c" width="470" height="430" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:588/1*fvUmDFzRRTUJN-Fy9pK1Zg.png"></picture></div><figcaption class="ps fe pt pe pf pu pv be b bf z dt" data-selectable-paragraph=""><em class="pw">Figure 15 — Macro Decryption</em></figcaption></figure><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fi pp bg pq"><div class="pe pf qq"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Fc9kECaxbZpPkGish9bgTA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Fc9kECaxbZpPkGish9bgTA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Fc9kECaxbZpPkGish9bgTA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Fc9kECaxbZpPkGish9bgTA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Fc9kECaxbZpPkGish9bgTA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Fc9kECaxbZpPkGish9bgTA.png 1100w, https://miro.medium.com/v2/resize:fit:804/format:webp/1*Fc9kECaxbZpPkGish9bgTA.png 804w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 402px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*Fc9kECaxbZpPkGish9bgTA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Fc9kECaxbZpPkGish9bgTA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Fc9kECaxbZpPkGish9bgTA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Fc9kECaxbZpPkGish9bgTA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Fc9kECaxbZpPkGish9bgTA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Fc9kECaxbZpPkGish9bgTA.png 1100w, https://miro.medium.com/v2/resize:fit:804/1*Fc9kECaxbZpPkGish9bgTA.png 804w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 402px"><img alt="" class="bg mh pr c" width="402" height="208" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:503/1*Fc9kECaxbZpPkGish9bgTA.png"></picture></div></div><figcaption class="ps fe pt pe pf pu pv be b bf z dt" data-selectable-paragraph=""><em class="pw">Figure 16 — Excel Content Shown</em></figcaption></figure><p id="2b09" class="pw-post-body-paragraph na nb gt nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gm bj" data-selectable-paragraph="">However, we still have not received our callback. When we check out Burp Suite logs, we see that the C2 traffic is not getting the 200 response we hoped for (Figure 17). We then check out Cloudflare logs and confirm that the RBI is isolating our C2 traffic (Figure 18).</p><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fi pp bg pq"><div class="pe pf pg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*o42tqKniPDZJKw5Ds6Sd8w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*o42tqKniPDZJKw5Ds6Sd8w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*o42tqKniPDZJKw5Ds6Sd8w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*o42tqKniPDZJKw5Ds6Sd8w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*o42tqKniPDZJKw5Ds6Sd8w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*o42tqKniPDZJKw5Ds6Sd8w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o42tqKniPDZJKw5Ds6Sd8w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*o42tqKniPDZJKw5Ds6Sd8w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*o42tqKniPDZJKw5Ds6Sd8w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*o42tqKniPDZJKw5Ds6Sd8w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*o42tqKniPDZJKw5Ds6Sd8w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*o42tqKniPDZJKw5Ds6Sd8w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*o42tqKniPDZJKw5Ds6Sd8w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*o42tqKniPDZJKw5Ds6Sd8w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bg mh pr c" width="700" height="269" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*o42tqKniPDZJKw5Ds6Sd8w.png"></picture></div></div><figcaption class="ps fe pt pe pf pu pv be b bf z dt" data-selectable-paragraph=""><em class="pw">Figure 17 — Unsuccessful C2 Callback</em></figcaption></figure><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fi pp bg pq"><div class="pe pf pg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*zBrl1uSf-JgfFRSgXrqgbg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*zBrl1uSf-JgfFRSgXrqgbg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*zBrl1uSf-JgfFRSgXrqgbg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*zBrl1uSf-JgfFRSgXrqgbg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*zBrl1uSf-JgfFRSgXrqgbg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*zBrl1uSf-JgfFRSgXrqgbg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zBrl1uSf-JgfFRSgXrqgbg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*zBrl1uSf-JgfFRSgXrqgbg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*zBrl1uSf-JgfFRSgXrqgbg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*zBrl1uSf-JgfFRSgXrqgbg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*zBrl1uSf-JgfFRSgXrqgbg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*zBrl1uSf-JgfFRSgXrqgbg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*zBrl1uSf-JgfFRSgXrqgbg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*zBrl1uSf-JgfFRSgXrqgbg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bg mh pr c" width="700" height="26" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*zBrl1uSf-JgfFRSgXrqgbg.png"></picture></div></div><figcaption class="ps fe pt pe pf pu pv be b bf z dt" data-selectable-paragraph=""><em class="pw">Figure 18 — Cloudflare Isolation Log</em></figcaption></figure><h1 id="18e8" class="oa ob gt be oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov ow ox bj" data-selectable-paragraph="">C2 Egress</h1><p id="58d3" class="pw-post-body-paragraph na nb gt nc b nd oy nf ng nh oz nj nk nl pa nn no np pb nr ns nt pc nv nw nx gm bj" data-selectable-paragraph="">The first hurdle is over; we got our payload into the target environment. Now, we need to get the C2 session back out. Like the ingress section, while some talking points may not be new, we will cover them to better explain how RBI products affect C2 traffic when deployed in a target environment.</p><h2 id="7c19" class="px ob gt be oc py pz dx og qa qb dz ok nl qc qd qe np qf qg qh nt qi qj qk ql bj" data-selectable-paragraph="">HTTP</h2><p id="7aa6" class="pw-post-body-paragraph na nb gt nc b nd oy nf ng nh oz nj nk nl pa nn no np pb nr ns nt pc nv nw nx gm bj" data-selectable-paragraph="">We will start with general HTTP(S) communication methods. Based on our experience with RBI, our first recommendation when crafting C2 traffic intended to egress an RBI solution with HTTP traffic is to omit any <em class="ny">POST </em>requests. Most RBI solutions implement features for Data Loss Prevention (DLP) that limit data that can be submitted or posted to different websites. Some vendors require explicit whitelisting of websites where data can be submitted using <em class="ny">PUT </em>or <em class="ny">POST </em>HTTP requests. A <em class="ny">GET</em>-only C2 profile will help save some heartache in the initial stages of getting an initial foothold; however, you can always expand into <em class="ny">POST </em>requests once you have the foothold to try and get the better C2 flow since <em class="ny">GET</em>-only profiles tend to be slower overall and produce significantly more transactions to exchange data with C2 servers.</p><p id="be62" class="pw-post-body-paragraph na nb gt nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gm bj" data-selectable-paragraph="">If your C2 supports it, you can also try using web socket profiles like those available for many payloads in the Mythic framework. Since web sockets can currently only function without isolation, some RBI solutions may allow them by default. However, vendors differ and some may require whitelisting of approved sites where web sockets can be utilized. As with much of this post, your best bet is to study which vendor your target is using so you know how to use this information to fine-tune your traffic.</p><h2 id="50d2" class="px ob gt be oc py pz dx og qa qb dz ok nl qc qd qe np qf qg qh nt qi qj qk ql bj" data-selectable-paragraph="">Headers</h2><p id="e0de" class="pw-post-body-paragraph na nb gt nc b nd oy nf ng nh oz nj nk nl pa nn no np pb nr ns nt pc nv nw nx gm bj" data-selectable-paragraph="">Like many web proxies and traffic-based security solutions, the headers in your C2 profile will matter in terms of blending in and getting through. However, the type of header you use can change how the RBI solution responds to your C2 traffic and may allow you to get out without much trouble. One initial significant header to include is a user agent. Be sure to explicitly set a modern browser-based user agent that is expected to exist in your target environment. Not all RBI solutions will block this, but many will block web traffic with user agents that do not match approved web browsers or do not meet a minimum sufficient version of a browser.</p><p id="5be3" class="pw-post-body-paragraph na nb gt nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gm bj" data-selectable-paragraph="">Next, we have the Content-Type. While setting Content-Type to try to match vanilla web traffic to blend in is common, this can be a significant hindrance (and easy fix) when dealing with RBI products. Many RBI solutions will look for a Content-Type of “text/html” and send that traffic through isolation to ensure safe browsing for the user, which will result in breaking our C2 traffic. We recommend changing the Content-Type away from “text/html” if possible. Below is an example of two web requests from PowerShell, one isolated and the other inspected but not isolated (Figure 19 and Figure 20). The only difference between the requests was that the request on the left had a Content-Type of “application/json” and the right had “text/html”. We have even succeeded by removing the Content-Type header entirely, though we do not regularly recommend doing this as it will make your traffic look very suspicious.</p><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fi pp bg pq"><div class="pe pf pg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*RtdBnnYKcOXeO8lMw98QWQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*RtdBnnYKcOXeO8lMw98QWQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*RtdBnnYKcOXeO8lMw98QWQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*RtdBnnYKcOXeO8lMw98QWQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*RtdBnnYKcOXeO8lMw98QWQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*RtdBnnYKcOXeO8lMw98QWQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RtdBnnYKcOXeO8lMw98QWQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*RtdBnnYKcOXeO8lMw98QWQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*RtdBnnYKcOXeO8lMw98QWQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*RtdBnnYKcOXeO8lMw98QWQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*RtdBnnYKcOXeO8lMw98QWQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*RtdBnnYKcOXeO8lMw98QWQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*RtdBnnYKcOXeO8lMw98QWQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*RtdBnnYKcOXeO8lMw98QWQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bg mh pr c" width="700" height="445" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*RtdBnnYKcOXeO8lMw98QWQ.png"></picture></div></div><figcaption class="ps fe pt pe pf pu pv be b bf z dt" data-selectable-paragraph=""><em class="pw">Figure 19 — Accept Header Comparison “application/json”</em></figcaption></figure><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fi pp bg pq"><div class="pe pf pg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*0W8CzZ0z2k8kAEnIj7wfJA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*0W8CzZ0z2k8kAEnIj7wfJA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*0W8CzZ0z2k8kAEnIj7wfJA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*0W8CzZ0z2k8kAEnIj7wfJA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*0W8CzZ0z2k8kAEnIj7wfJA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*0W8CzZ0z2k8kAEnIj7wfJA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0W8CzZ0z2k8kAEnIj7wfJA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*0W8CzZ0z2k8kAEnIj7wfJA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*0W8CzZ0z2k8kAEnIj7wfJA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*0W8CzZ0z2k8kAEnIj7wfJA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*0W8CzZ0z2k8kAEnIj7wfJA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*0W8CzZ0z2k8kAEnIj7wfJA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*0W8CzZ0z2k8kAEnIj7wfJA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*0W8CzZ0z2k8kAEnIj7wfJA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bg mh pr c" width="700" height="445" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*0W8CzZ0z2k8kAEnIj7wfJA.png"></picture></div></div><figcaption class="ps fe pt pe pf pu pv be b bf z dt" data-selectable-paragraph=""><em class="pw">Figure 20— Accept Header Comparison “text/html”</em></figcaption></figure><h2 id="30e4" class="px ob gt be oc py pz dx og qa qb dz ok nl qc qd qe np qf qg qh nt qi qj qk ql bj" data-selectable-paragraph="">Cookies</h2><p id="c03b" class="pw-post-body-paragraph na nb gt nc b nd oy nf ng nh oz nj nk nl pa nn no np pb nr ns nt pc nv nw nx gm bj" data-selectable-paragraph="">Our final header worth mentioning is cookies. Passing the C2 traffic in a cookie is not a new way of doing business, but it can be a great technique to get through RBI. Some RBI solutions virtualize and stream the web page content but transparently pass the cookie header to the other end of the channel for usability since many sites require cookie functionality. As with many solutions, usability equals abusability. We recommend modifying your C2 profile to send the traffic in the cookie and get your sessions out of the target environment as another potential option.</p><h2 id="f7af" class="px ob gt be oc py pz dx og qa qb dz ok nl qc qd qe np qf qg qh nt qi qj qk ql bj" data-selectable-paragraph="">HTTP Authentication</h2><p id="4864" class="pw-post-body-paragraph na nb gt nc b nd oy nf ng nh oz nj nk nl pa nn no np pb nr ns nt pc nv nw nx gm bj" data-selectable-paragraph="">When attempting to have HTTP traffic egress an RBI security product, you must be prepared to authenticate to get out. Many RBI solutions implement SAML/NTLM/Basic authentication for outbound traffic that requires payloads to be able to authenticate to the web proxy when a HTTP 407 “Proxy Authentication Required” authorization message is returned.</p><p id="0f16" class="pw-post-body-paragraph na nb gt nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gm bj" data-selectable-paragraph="">Some tools do not need to worry about this as much as others. PowerShell can natively use stored Kerberos tickets when creating web requests and can be a fundamental capability for web traffic to egress an authenticated proxy using Invoke-WebRequest for droppers. Cobalt Strike has a native capability to specify a proxy and credentials if known. It can automatically utilize stored NTLM credentials if available on a local system using the WinInet API if the proxy accepts it for basic or NTLM authentication. If you use payloads that are not proxy-aware or do not support providing credentials to egress, you will likely need to modify them or pick a new C2 framework for your RBI engagement.</p><h2 id="b466" class="px ob gt be oc py pz dx og qa qb dz ok nl qc qd qe np qf qg qh nt qi qj qk ql bj" data-selectable-paragraph="">Redirectors</h2><p id="b357" class="pw-post-body-paragraph na nb gt nc b nd oy nf ng nh oz nj nk nl pa nn no np pb nr ns nt pc nv nw nx gm bj" data-selectable-paragraph="">As with any C2 channel, your redirector setup will significantly impact how RBI solutions react to your traffic. If you use a strict set of rewriting rules to filter traffic to your redirectors, you may need to open the rules up if the customer uses RBI since the traffic frequently traverses cloud-virtualized infrastructure instead of directly egressing from an organization’s assets; this is to avoid inadvertently blocking new payloads checking in from client environments because they originate from unknown addresses/spaces. Once you know where the traffic is coming from, you should trim down the rules to only what you need to allow and redirect everything else to somewhere else (like the ubiquitous <em class="ny">HTTPS://WWW.GOOGLE.COM</em>).</p><p id="127b" class="pw-post-body-paragraph na nb gt nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gm bj" data-selectable-paragraph="">Another critical factor is the need to use reputable domains for your redirectors. We do not mean just using domains not classified as malicious; you need actual classifications. Many RBI solutions will block uncategorized sites or sites classified as grayware. More than one RBI security vendor has begun internally tracking site categorizations and can even develop profiles per domain when users access new sites. This makes it more imperative that C2 domains are well established with positive reputations and a good history of being categorized as trustworthy in reputable categories such as news, finance, or healthcare sites.</p><p id="a8da" class="pw-post-body-paragraph na nb gt nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gm bj" data-selectable-paragraph="">Lastly, you can likely kiss any unencrypted HTTP traffic goodbye. Ensure you have valid TLS certificates, as RBI products often block unencrypted HTTP traffic. Again, there is nothing necessarily new here, but it is something you want to get set up correctly to help you get a C2 session back to your infrastructure.</p><p id="8ea1" class="pw-post-body-paragraph na nb gt nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gm bj" data-selectable-paragraph="">So why was our traffic not getting through before? If we look into the product documentation, we can find the answer we need for now. We can see in the isolation documentation that the isolation policies will apply to requests that include the “text/html” accept header (Figure 21). In this case, ensuring our C2 traffic included that to blend in with most web traffic was our downfall.</p><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fi pp bg pq"><div class="pe pf pg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*y6x3MmDCcPK5fvKNjAqiMg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*y6x3MmDCcPK5fvKNjAqiMg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*y6x3MmDCcPK5fvKNjAqiMg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*y6x3MmDCcPK5fvKNjAqiMg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*y6x3MmDCcPK5fvKNjAqiMg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*y6x3MmDCcPK5fvKNjAqiMg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y6x3MmDCcPK5fvKNjAqiMg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*y6x3MmDCcPK5fvKNjAqiMg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*y6x3MmDCcPK5fvKNjAqiMg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*y6x3MmDCcPK5fvKNjAqiMg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*y6x3MmDCcPK5fvKNjAqiMg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*y6x3MmDCcPK5fvKNjAqiMg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*y6x3MmDCcPK5fvKNjAqiMg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*y6x3MmDCcPK5fvKNjAqiMg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bg mh pr c" width="700" height="306" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*y6x3MmDCcPK5fvKNjAqiMg.png"></picture></div></div><figcaption class="ps fe pt pe pf pu pv be b bf z dt" data-selectable-paragraph=""><em class="pw">Figure 21 — Cloudflare Isolation Documentation</em></figcaption></figure><p id="5adf" class="pw-post-body-paragraph na nb gt nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gm bj" data-selectable-paragraph="">Let us change our headers and try again. We modify our accept headers on our C2 profile in Mythic and build a new payload (Figure 22).</p><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fi pp bg pq"><div class="pe pf pg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*HOUbulEvm2cyS9fiBHwPpA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*HOUbulEvm2cyS9fiBHwPpA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*HOUbulEvm2cyS9fiBHwPpA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*HOUbulEvm2cyS9fiBHwPpA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*HOUbulEvm2cyS9fiBHwPpA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*HOUbulEvm2cyS9fiBHwPpA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HOUbulEvm2cyS9fiBHwPpA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*HOUbulEvm2cyS9fiBHwPpA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*HOUbulEvm2cyS9fiBHwPpA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*HOUbulEvm2cyS9fiBHwPpA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*HOUbulEvm2cyS9fiBHwPpA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*HOUbulEvm2cyS9fiBHwPpA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*HOUbulEvm2cyS9fiBHwPpA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*HOUbulEvm2cyS9fiBHwPpA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bg mh pr c" width="700" height="507" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*HOUbulEvm2cyS9fiBHwPpA.png"></picture></div></div><figcaption class="ps fe pt pe pf pu pv be b bf z dt" data-selectable-paragraph=""><em class="pw">Figure 22 — Updated HTTP C2 Profile</em></figcaption></figure><p id="f191" class="pw-post-body-paragraph na nb gt nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gm bj" data-selectable-paragraph="">Once we get the new payload on the host and execute it, we can see the difference in the traffic. Our Burp Suite shows our desired 200 response code (Figure 23), and Cloudflare shows that our traffic was allowed through to the redirector (Figure 24). Finally, we have our callback to Mythic (Figure 25).</p><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fi pp bg pq"><div class="pe pf pg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*zvsTVQ920QJrWMUKHBCMxg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*zvsTVQ920QJrWMUKHBCMxg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*zvsTVQ920QJrWMUKHBCMxg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*zvsTVQ920QJrWMUKHBCMxg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*zvsTVQ920QJrWMUKHBCMxg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*zvsTVQ920QJrWMUKHBCMxg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zvsTVQ920QJrWMUKHBCMxg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*zvsTVQ920QJrWMUKHBCMxg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*zvsTVQ920QJrWMUKHBCMxg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*zvsTVQ920QJrWMUKHBCMxg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*zvsTVQ920QJrWMUKHBCMxg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*zvsTVQ920QJrWMUKHBCMxg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*zvsTVQ920QJrWMUKHBCMxg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*zvsTVQ920QJrWMUKHBCMxg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bg mh pr c" width="700" height="204" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*zvsTVQ920QJrWMUKHBCMxg.png"></picture></div></div><figcaption class="ps fe pt pe pf pu pv be b bf z dt" data-selectable-paragraph=""><em class="pw">Figure 23 — Successful Callback in Burp</em></figcaption></figure><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fi pp bg pq"><div class="pe pf pg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*QNdjrHuuH-JoCbX3hHEOxA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*QNdjrHuuH-JoCbX3hHEOxA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*QNdjrHuuH-JoCbX3hHEOxA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*QNdjrHuuH-JoCbX3hHEOxA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*QNdjrHuuH-JoCbX3hHEOxA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*QNdjrHuuH-JoCbX3hHEOxA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QNdjrHuuH-JoCbX3hHEOxA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*QNdjrHuuH-JoCbX3hHEOxA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*QNdjrHuuH-JoCbX3hHEOxA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*QNdjrHuuH-JoCbX3hHEOxA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*QNdjrHuuH-JoCbX3hHEOxA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*QNdjrHuuH-JoCbX3hHEOxA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*QNdjrHuuH-JoCbX3hHEOxA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*QNdjrHuuH-JoCbX3hHEOxA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bg mh pr c" width="700" height="24" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*QNdjrHuuH-JoCbX3hHEOxA.png"></picture></div></div><figcaption class="ps fe pt pe pf pu pv be b bf z dt" data-selectable-paragraph=""><em class="pw">Figure 24 — Cloudflare Allowed Log</em></figcaption></figure><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div class="pe pf qr"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Lg5v4rHlkT-6EDAstcVrFg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Lg5v4rHlkT-6EDAstcVrFg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Lg5v4rHlkT-6EDAstcVrFg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Lg5v4rHlkT-6EDAstcVrFg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Lg5v4rHlkT-6EDAstcVrFg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Lg5v4rHlkT-6EDAstcVrFg.png 1100w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Lg5v4rHlkT-6EDAstcVrFg.png 828w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 414px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*Lg5v4rHlkT-6EDAstcVrFg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Lg5v4rHlkT-6EDAstcVrFg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Lg5v4rHlkT-6EDAstcVrFg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Lg5v4rHlkT-6EDAstcVrFg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Lg5v4rHlkT-6EDAstcVrFg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Lg5v4rHlkT-6EDAstcVrFg.png 1100w, https://miro.medium.com/v2/resize:fit:828/1*Lg5v4rHlkT-6EDAstcVrFg.png 828w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 414px"><img alt="" class="bg mh pr c" width="414" height="52" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:518/1*Lg5v4rHlkT-6EDAstcVrFg.png"></picture></div><figcaption class="ps fe pt pe pf pu pv be b bf z dt" data-selectable-paragraph=""><em class="pw">Figure 25 — New Callback in Mythic</em></figcaption></figure><h1 id="f257" class="oa ob gt be oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov ow ox bj" data-selectable-paragraph="">RBI Bypass</h1><p id="dd18" class="pw-post-body-paragraph na nb gt nc b nd oy nf ng nh oz nj nk nl pa nn no np pb nr ns nt pc nv nw nx gm bj" data-selectable-paragraph="">Though we are covering it last, the most accessible methods of establishing C2 communications in customer environments that have deployed RBI solutions are to bypass these protections altogether when possible. This can be accomplished in a couple of different ways depending on the capabilities and configuration of the RBI implementation using either <a class="af pd" href="#453a" rel="noopener ugc nofollow"><strong class="nc gu">DNS C2</strong></a> or <a class="af pd" href="#60ab" rel="noopener ugc nofollow"><strong class="nc gu">Third-Party C2</strong></a><strong class="nc gu">.</strong></p><h2 id="453a" class="px ob gt be oc py pz dx og qa qb dz ok nl qc qd qe np qf qg qh nt qi qj qk ql bj" data-selectable-paragraph="">DNS C2</h2><p id="eddf" class="pw-post-body-paragraph na nb gt nc b nd oy nf ng nh oz nj nk nl pa nn no np pb nr ns nt pc nv nw nx gm bj" data-selectable-paragraph="">Many RBI solutions only monitor HTTP/HTTPS traffic by default and either require explicitly configuring DNS monitoring or lack that capability altogether. A DNS C2 channel will commonly establish successful callbacks using UDP traffic that will be under less scrutiny rather than egressing a proxy. This comes with the OPSEC consideration that an increase in the volume of DNS requests, especially without any additional web requests resulting from the DNS resolution, can indicate compromise.</p><p id="b300" class="pw-post-body-paragraph na nb gt nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gm bj" data-selectable-paragraph="">Some RBI solutions purport to perform DNS monitoring and inspection, but the effectiveness of these measures will vary by vendor; ultimately, this will rely upon the defensive maturity of your client environments. In our experience, DNS traffic is typically either being monitored and C2 communications will be quickly identified, or it is not monitored at all in many environments.</p><h2 id="60ab" class="px ob gt be oc py pz dx og qa qb dz ok nl qc qd qe np qf qg qh nt qi qj qk ql bj" data-selectable-paragraph="">Third-Party C2</h2><p id="52d2" class="pw-post-body-paragraph na nb gt nc b nd oy nf ng nh oz nj nk nl pa nn no np pb nr ns nt pc nv nw nx gm bj" data-selectable-paragraph="">When establishing new HTTP/S communication channels through RBI solutions, new domains and IP connections will be subject to inspection for any new traffic. However, it is common for popular applications to either be implicitly or explicitly excluded from inspection for RBI solutions, allowing their traffic to essentially bypass isolation when communicating with their servers. This can be leveraged to establish C2 communication through trusted applications using projects such as <a class="af pd" href="https://github.com/WithSecureLabs/C3" rel="noopener ugc nofollow" target="_blank">C3</a> on GitHub, which uses third-party applications like Dropbox, Google Drive, Discord, and Slack to communicate with a team server over the web application channels.</p><h1 id="fd21" class="oa ob gt be oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov ow ox bj" data-selectable-paragraph="">Our Recommended Methodology</h1><p id="bac2" class="pw-post-body-paragraph na nb gt nc b nd oy nf ng nh oz nj nk nl pa nn no np pb nr ns nt pc nv nw nx gm bj" data-selectable-paragraph="">If you are dealing with an RBI solution on your next engagement and cannot test your C2 channels beforehand, you are likely better off trying to go around first. Although DNS C2 callbacks are not the best for constant interaction, they can provide a great initial foothold that you can use to expand into an HTTP C2 channel slowly. Once you establish a DNS C2 foothold, work into a GET-only HTTP C2 channel. It will be your second-best chance of getting out and with the DNS backup, you will be able to troubleshoot what is going wrong. Lastly, you should try to move to a <em class="ny">GET-POST</em> HTTP C2 channel if the RBI will let them through.</p><h1 id="5686" class="oa ob gt be oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov ow ox bj" data-selectable-paragraph="">Why Do We Still Recommend RBI?</h1><p id="b145" class="pw-post-body-paragraph na nb gt nc b nd oy nf ng nh oz nj nk nl pa nn no np pb nr ns nt pc nv nw nx gm bj" data-selectable-paragraph="">Like every other security product vendor today, RBI vendors will pitch their products as a solution that will cure all your security woes and their product is infallible. We, like many of you, make our living proving that every product is fallible in some way. This does not mean we do not support companies developing RBI solutions. These products were a significant thorn in our side whenever we first encountered them during red team engagements. They do an excellent job allowing enterprises to fine-tune the sites, resources, and applications their users engage with on the web. We are actually quite big fans of RBI and hope that by releasing works like this focusing on the technology more entities will adopt it as they become aware of the benefits and the producers of these proxies can further refine their products. While they are not a one-stop solution for protecting your network, they are a significant advancement in preventative and detective tooling, and we highly recommend adding them to defense-in-depth solutions and testing recommendations.</p></div></div></div><div class="ab ca qs qt qu qv" role="separator"><span class="qw bx bl qx qy qz"></span><span class="qw bx bl qx qy qz"></span><span class="qw bx bl qx qy"></span></div><div class="gm gn go gp gq"><div class="ab ca"><div class="ch bg fy fz ga gb"><h2 id="cb9d" class="px ob gt be oc py pz dx og qa qb dz ok nl qc qd qe np qf qg qh nt qi qj qk ql bj" data-selectable-paragraph="">About Us</h2><p id="4032" class="pw-post-body-paragraph na nb gt nc b nd oy nf ng nh oz nj nk nl pa nn no np pb nr ns nt pc nv nw nx gm bj" data-selectable-paragraph="">Lance Cain is an Adversary Simulation Senior Consultant with SpecterOps. Lance has over seven years of experience in information technology with five of those specializing in Red Teaming and Penetration Testing. Lance formerly served as the Engineering Cell Lead of the Marine Corps’ Red Team specializing in payload and C2 channel development.</p><p id="2f8a" class="pw-post-body-paragraph na nb gt nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gm bj" data-selectable-paragraph="">Alexander DeMine is an Adversary Simulation Consultant at SpecterOps with over 10 years of experience in the field of information technology. Formerly, Alex was the Chief of the Marine Corps’ Red Team, where he supervised and provided full-scope operational assessments of Marine Corps and DoD networks.</p><p id="9161" class="pw-post-body-paragraph na nb gt nc b nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx gm bj" data-selectable-paragraph="">We began our journey into RBI while serving on the Marine Corps’ Red Team and have continued this research while working in a variety of different client environments during consultation work with SpecterOps. RBI has been a unique hurdle to overcome each time we have encountered it when working to establish C2 channels on offensive engagements. We hope that by sharing our tradecraft we are able to help shed some light for other teams out there that may be encountering the same challenges.</p></div></div></div></div></section></div></div></article><div class="ab ca"><div class="ch bg fy fz ga gb"></div></div></div><div></div><div class="m tw tx ty"><div class="bw tz ua bg xo" style="bottom: 0px;"><div class="uc t ud v ue uf ug uh ui uj ab q cn fi"><div class="uk ul um un uo l"><div class="am l fr up uq"><div class="h k"><div class="l fi n ur"><button class="af ag ah ai aj ak al am an ao ap aq ar as at ab" data-testid="close-button" aria-label="close"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" class="fj dt fl fk"><path d="M5 5l7 7m7 7l-7-7m0 0l7-7m-7 7l-7 7" stroke="currentColor" stroke-linecap="round"></path></svg></button></div></div><div class="j i d"><div class="l fi n ur"><button class="af ag ah ai aj ak al am an ao ap aq ar as at ab fi us gp ut uu uv uw" data-testid="close-button" aria-label="close"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" class="fj dt fl fk"><path d="M5 5l7 7m7 7l-7-7m0 0l7-7m-7 7l-7 7" stroke="currentColor" stroke-linecap="round"></path></svg></button></div></div></div><div class="ab q jc jd ve vf"><img class="fr tx gh vg" src="https://miro.medium.com/v2/da:true/resize:fit:0/5c50caa54067fd622d2f0fac18392213bf92f6e2fae89b691e62bceb40885e74" loading="lazy" role="presentation"><div class="gx vh hc vi dl vj dm vk vl l"><svg viewBox="0 0 3940 610" class="ux uy uz va vb hh vc hm vd hr"><path d="M594.79 308.2c0 163.76-131.85 296.52-294.5 296.52S5.8 472 5.8 308.2 137.65 11.69 300.29 11.69s294.5 132.75 294.5 296.51M917.86 308.2c0 154.16-65.93 279.12-147.25 279.12s-147.25-125-147.25-279.12S689.29 29.08 770.61 29.08s147.25 125 147.25 279.12M1050 308.2c0 138.12-23.19 250.08-51.79 250.08s-51.79-112-51.79-250.08 23.19-250.08 51.8-250.08S1050 170.09 1050 308.2M1862.77 37.4l.82-.18v-6.35h-167.48l-155.51 365.5-155.51-365.5h-180.48v6.35l.81.18c30.57 6.9 46.09 17.19 46.09 54.3v434.45c0 37.11-15.58 47.4-46.15 54.3l-.81.18V587H1327v-6.35l-.81-.18c-30.57-6.9-46.09-17.19-46.09-54.3V116.9L1479.87 587h11.33l205.59-483.21V536.9c-2.62 29.31-18 38.36-45.68 44.61l-.82.19v6.3h213.3v-6.3l-.82-.19c-27.71-6.25-43.46-15.3-46.08-44.61l-.14-445.2h.14c0-37.11 15.52-47.4 46.08-54.3m97.43 287.8c3.49-78.06 31.52-134.4 78.56-135.37 14.51.24 26.68 5 36.14 14.16 20.1 19.51 29.55 60.28 28.09 121.21zm-2.11 22h250v-1.05c-.71-59.69-18-106.12-51.34-138-28.82-27.55-71.49-42.71-116.31-42.71h-1c-23.26 0-51.79 5.64-72.09 15.86-23.11 10.7-43.49 26.7-60.45 47.7-27.3 33.83-43.84 79.55-47.86 130.93-.13 1.54-.24 3.08-.35 4.62s-.18 2.92-.25 4.39a332.64 332.64 0 0 0-.36 21.69C1860.79 507 1923.65 600 2035.3 600c98 0 155.07-71.64 169.3-167.8l-7.19-2.53c-25 51.68-69.9 83-121 79.18-69.76-5.22-123.2-75.95-118.35-161.63m532.69 157.68c-8.2 19.45-25.31 30.15-48.24 30.15s-43.89-15.74-58.78-44.34c-16-30.7-24.42-74.1-24.42-125.51 0-107 33.28-176.21 84.79-176.21 21.57 0 38.55 10.7 46.65 29.37zm165.84 76.28c-30.57-7.23-46.09-18-46.09-57V5.28L2424.77 60v6.7l1.14-.09c25.62-2.07 43 1.47 53.09 10.79 7.9 7.3 11.75 18.5 11.75 34.26v71.14c-18.31-11.69-40.09-17.38-66.52-17.38-53.6 0-102.59 22.57-137.92 63.56-36.83 42.72-56.3 101.1-56.3 168.81C2230 518.72 2289.53 600 2378.13 600c51.83 0 93.53-28.4 112.62-76.3V588h166.65v-6.66zm159.29-505.33c0-37.76-28.47-66.24-66.24-66.24-37.59 0-67 29.1-67 66.24s29.44 66.24 67 66.24c37.77 0 66.24-28.48 66.24-66.24m43.84 505.33c-30.57-7.23-46.09-18-46.09-57h-.13V166.65l-166.66 47.85v6.5l1 .09c36.06 3.21 45.93 15.63 45.93 57.77V588h166.8v-6.66zm427.05 0c-30.57-7.23-46.09-18-46.09-57V166.65L3082 212.92v6.52l.94.1c29.48 3.1 38 16.23 38 58.56v226c-9.83 19.45-28.27 31-50.61 31.78-36.23 0-56.18-24.47-56.18-68.9V166.66l-166.66 47.85V221l1 .09c36.06 3.2 45.94 15.62 45.94 57.77v191.27a214.48 214.48 0 0 0 3.47 39.82l3 13.05c14.11 50.56 51.08 77 109 77 49.06 0 92.06-30.37 111-77.89v66h166.66v-6.66zM3934.2 588v-6.67l-.81-.19c-33.17-7.65-46.09-22.07-46.09-51.43v-243.2c0-75.83-42.59-121.09-113.93-121.09-52 0-95.85 30.05-112.73 76.86-13.41-49.6-52-76.86-109.06-76.86-50.12 0-89.4 26.45-106.25 71.13v-69.87l-166.66 45.89v6.54l1 .09c35.63 3.16 45.93 15.94 45.93 57V588h155.5v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66V255.72c7-16.35 21.11-35.72 49-35.72 34.64 0 52.2 24 52.2 71.28V588h155.54v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66v-248a160.45 160.45 0 0 0-2.2-27.68c7.42-17.77 22.34-38.8 51.37-38.8 35.13 0 52.2 23.31 52.2 71.28V588z"></path></svg><h2 class="vm b nd vn vo nh vp vq ol vr vs op vt vu ot vv vw vx vy">Sign up to discover human stories that deepen your understanding of the world.</h2></div><div class="ab q jc jd"><div class="vz gd bo gx wa hc wb wc wd we wf wg wh l c"><div class="ab q"><h2 class="be sz is z gs bj">Free</h2></div><div class="td wi l cw"></div><div class="td ab"><div class="bn l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="be b bf z bj">Distraction-free reading. No ads.</p></div><div class="td ab"><div class="bn l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="be b bf z bj">Organize your knowledge with lists and highlights.</p></div><div class="td ab"><div class="bn l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="be b bf z bj">Tell your story. Find your audience.</p></div><div class="ck wj wi l cw"></div><span><a class="be b bf z wk re wl wm wn wo wp eu ev wq wr ws ez bg fa fb fc bl fd fe" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcalling-home-get-your-callbacks-through-rbi-50633a233999&amp;source=---post_footer_upsell--50633a233999---------------------lo_non_moc_upsell-----------" rel="noopener follow">Sign up for free</a></span></div><div class="vz gd bo wa wb wd wf wh l c"><div class="ab q"><svg width="64" height="64" viewBox="0 0 64 64" fill="none" class="wt rd dg lz"><path d="M39.64 40.83L33.87 56.7a1.99 1.99 0 0 1-3.74 0l-5.77-15.87a2.02 2.02 0 0 0-1.2-1.2L7.3 33.88a1.99 1.99 0 0 1 0-3.74l15.87-5.77a2.02 2.02 0 0 0 1.2-1.2L30.12 7.3a1.99 1.99 0 0 1 3.74 0l5.77 15.87a2.02 2.02 0 0 0 1.2 1.2l15.86 5.76a1.99 1.99 0 0 1 0 3.74l-15.87 5.77a2.02 2.02 0 0 0-1.2 1.2z" fill="#FFC017"></path></svg><h2 class="be sz is z gs bj">Membership</h2></div><div class="td wi l cw"></div><div class="td ab"><div class="bn l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="be b bf z bj">Access the best member-only stories.</p></div><div class="td ab"><div class="bn l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="be b bf z bj">Support independent authors.</p></div><div class="td ab"><div class="bn l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="be b bf z bj">Listen to audio narrations.</p></div><div class="td ab"><div class="bn l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="be b bf z bj">Read offline.</p></div><div class="td ab"><div class="bn l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="be b bf z bj">Join the Partner Program and earn for your writing.</p></div><div class="ck wj wi l cw"></div><span><a class="be b bf z wk re wl wm wn wo wp eu ev wq wr ws ez bg fa fb fc bl fd fe" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fplans&amp;source=---post_footer_upsell--50633a233999---------------------lo_non_moc_upsell-----------" rel="noopener follow">Try for 5&nbsp;$/month</a></span></div></div></div></div></div></div></div><div class="ab ca"><div class="ch bg fy fz ga gb"><div class="ra rb ab je"><div class="rc ab"><a class="rd ax am ao" href="https://medium.com/tag/penetration-testing?source=post_page-----50633a233999---------------penetration_testing-----------------" rel="noopener follow"><div class="re fi cw rf gd rg rh be b bf z bj ri">Penetration Testing</div></a></div><div class="rc ab"><a class="rd ax am ao" href="https://medium.com/tag/web?source=post_page-----50633a233999---------------web-----------------" rel="noopener follow"><div class="re fi cw rf gd rg rh be b bf z bj ri">Web</div></a></div><div class="rc ab"><a class="rd ax am ao" href="https://medium.com/tag/command-and-control?source=post_page-----50633a233999---------------command_and_control-----------------" rel="noopener follow"><div class="re fi cw rf gd rg rh be b bf z bj ri">Command And Control</div></a></div><div class="rc ab"><a class="rd ax am ao" href="https://medium.com/tag/payload?source=post_page-----50633a233999---------------payload-----------------" rel="noopener follow"><div class="re fi cw rf gd rg rh be b bf z bj ri">Payload</div></a></div><div class="rc ab"><a class="rd ax am ao" href="https://medium.com/tag/red-team?source=post_page-----50633a233999---------------red_team-----------------" rel="noopener follow"><div class="re fi cw rf gd rg rh be b bf z bj ri">Red Team</div></a></div></div></div></div><div class="l"></div><footer class="rj rk rl rm rn ro rp rq rr ab q rs io c"><div class="l ae"><div class="ab ca"><div class="ch bg fy fz ga gb"><div class="ab co rt"><div class="ab q kz"><div class="ru l"><span class="l rv rw rx e d"><div class="ab q kz la"><div class="pw-multi-vote-icon fi ji lb lc ld"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspecter-ops-posts%2F50633a233999&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcalling-home-get-your-callbacks-through-rbi-50633a233999&amp;user=Lance+B.+Cain&amp;userId=040c3e09d079&amp;source=-----50633a233999---------------------clap_footer-----------" rel="noopener follow"><div><div class="bl" aria-hidden="false" aria-describedby="10" aria-labelledby="10"><div class="le ao lf lg lh li am lj lk ll ld"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lm ln lo lp lq lr ls"><div><div class="bl" aria-hidden="false" aria-describedby="86" aria-labelledby="86"><p class="be b du z dt"><button class="af ag ah ai aj ak al am an ao ap aq ar as at yt ma">9<span class="l h g f ry rz"></span></button></p></div></div></div></div></span><span class="l h g f ry rz"><div class="ab q kz la"><div class="pw-multi-vote-icon fi ji lb lc ld"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspecter-ops-posts%2F50633a233999&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcalling-home-get-your-callbacks-through-rbi-50633a233999&amp;user=Lance+B.+Cain&amp;userId=040c3e09d079&amp;source=-----50633a233999---------------------clap_footer-----------" rel="noopener follow"><div><div class="bl" aria-hidden="false" aria-describedby="11" aria-labelledby="11"><div class="le ao lf lg lh li am lj lk ll ld"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lm ln lo lp lq lr ls"><div><div class="bl" aria-hidden="false" aria-describedby="88" aria-labelledby="88"><p class="be b du z dt"><button class="af ag ah ai aj ak al am an ao ap aq ar as at yt ma">9</button></p></div></div></div></div></span></div><div class="bp ab"><div><div class="bl" aria-hidden="false" aria-describedby="12" aria-labelledby="12"><button class="ao le lu lv ab q fj lw lx" aria-label="responses"><svg width="24" height="24" viewBox="0 0 24 24" class="ly"><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></button></div></div></div></div><div class="ab q"><div class="qz l jb"><div><div class="bl" aria-hidden="false" aria-describedby="13" aria-labelledby="13"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F50633a233999&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcalling-home-get-your-callbacks-through-rbi-50633a233999&amp;source=--------------------------bookmark_footer-----------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div><div class="qz l jb"><div class="bl" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bl" aria-hidden="false" aria-describedby="14" aria-labelledby="14"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fj ah ai aj ak al mi an ao ap ew mj mk lx ml"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.22 4.93a.42.42 0 0 1-.12.13h.01a.45.45 0 0 1-.29.08.52.52 0 0 1-.3-.13L12.5 3v7.07a.5.5 0 0 1-.5.5.5.5 0 0 1-.5-.5V3.02l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.8a.42.42 0 0 1 .07.5zm-.1.14zm.88 2h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11a2 2 0 0 1-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.14c.1.1.15.22.15.35a.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9V8.96c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1z" fill="currentColor"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="sa sb sc sd se l bw"><div class="ab ca"><div class="ch bg fy fz ga gb"><div class="ck ab sf co"><div class="ab ie"><a href="https://medium.com/@lbcain18?source=post_page-----50633a233999--------------------------------" rel="noopener follow"><div class="l sg sh bx si ii"><div class="l fi"><img alt="Lance B. Cain" class="l fc bx sj sk cw" src="https://miro.medium.com/v2/da:true/resize:fill:144:144/0*v0d00TR4cFqVeADo" width="72" height="72" loading="lazy"><div class="ij bx l sj sk fr n ik fs"></div></div></div></a><a href="https://posts.specterops.io/?source=post_page-----50633a233999--------------------------------" rel="noopener follow"><div class="sl ab fi"><div><div class="bl" aria-hidden="false" aria-describedby="15" aria-labelledby="15"><div class="l sm sn bx si io"><div class="l fi"><img alt="Posts By SpecterOps Team Members" class="l fc bx by bz cw" src="https://miro.medium.com/v2/resize:fill:64:64/1*D-FDlfkqivRBQZoESrwtqw.png" width="32" height="32" loading="lazy"><div class="ij bx l by bz fr n ik fs"></div></div></div></div></div></div></a></div><div class="j i d"><div class="ab"><span><a class="be b bf z eo re ep eq er es et eu ev ew ex ey ez so fa fb fc bl fd fe" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F040c3e09d079&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcalling-home-get-your-callbacks-through-rbi-50633a233999&amp;user=Lance+B.+Cain&amp;userId=040c3e09d079&amp;source=post_page-040c3e09d079----50633a233999---------------------follow_profile-----------" rel="noopener follow">Follow</a></span><div class="ds l"><div><div><div class="bl" aria-hidden="false" aria-describedby="116" aria-labelledby="116"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F040c3e09d079%2Flazily-enable-writer-subscription&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcalling-home-get-your-callbacks-through-rbi-50633a233999&amp;user=Lance+B.+Cain&amp;userId=040c3e09d079&amp;source=-----50633a233999---------------------subscribe_user-----------" rel="noopener follow"><button class="be b bf z eo am ep eq er es et eu ev ew ex ey ez fa fb fc bl fd fe" aria-label="Subscribe"><svg width="38" height="38" viewBox="0 0 38 38" fill="none" class="yv sn sm"><rect x="26.25" y="9.25" width="0.5" height="6.5" rx="0.25"></rect><rect x="29.75" y="12.25" width="0.5" height="6.5" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5L19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="ab cm co"><div class="l"><div class="ab q"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab q" href="https://medium.com/@lbcain18?source=post_page-----50633a233999--------------------------------" rel="noopener follow"><h2 class="pw-author-name be sz ta tb tc bj"><span class="gm js">Written by <!-- -->Lance B. Cain</span></h2></a></div><div class="rc ab"><div class="l jb"><span class="pw-follower-count be b bf z bj"><a class="af ag ah ai aj ak al am an ao ap aq ar iu" href="https://medium.com/@lbcain18/followers?source=post_page-----50633a233999--------------------------------" rel="noopener follow">13 Followers</a></span></div><div class="be b bf z jj jk jl ab jn jo jp jq dt jh"><span class="iv l" aria-hidden="true"><span class="be b bf z dt">·</span></span><span class="l jb">Writer for </span><div><div class="l" aria-hidden="false" aria-describedby="17" aria-labelledby="17"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://posts.specterops.io/?source=post_page-----50633a233999--------------------------------" rel="noopener follow"><p class="be b bf z jj jk jl jm jn jo jp jq bj">Posts By SpecterOps Team Members</p></a></div></div></div></div><div class="td l"></div></div><div class="h k"><div class="ab"><span><a class="be b bf z eo re ep eq er es et eu ev ew ex ey ez so fa fb fc bl fd fe" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F040c3e09d079&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcalling-home-get-your-callbacks-through-rbi-50633a233999&amp;user=Lance+B.+Cain&amp;userId=040c3e09d079&amp;source=post_page-040c3e09d079----50633a233999---------------------follow_profile-----------" rel="noopener follow">Follow</a></span><div class="ds l"><div><div><div class="bl" aria-hidden="false" aria-describedby="118" aria-labelledby="118"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F040c3e09d079%2Flazily-enable-writer-subscription&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcalling-home-get-your-callbacks-through-rbi-50633a233999&amp;user=Lance+B.+Cain&amp;userId=040c3e09d079&amp;source=-----50633a233999---------------------subscribe_user-----------" rel="noopener follow"><button class="be b bf z eo am ep eq er es et eu ev ew ex ey ez fa fb fc bl fd fe" aria-label="Subscribe"><svg width="38" height="38" viewBox="0 0 38 38" fill="none" class="yv sn sm"><rect x="26.25" y="9.25" width="0.5" height="6.5" rx="0.25"></rect><rect x="29.75" y="12.25" width="0.5" height="6.5" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5L19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="te bg tf tg th ti tj tk"></div></div></div><div class="ab ca"><div class="ch bg fy fz ga gb"><div class="yw yx l"><h2 class="be sz is z gs bj">More from Lance B. Cain and Posts By SpecterOps Team Members</h2></div><div class="yy ab kz je yz za zb zc zd ze zf zg zh zi zj zk zl zm zn"><div class="zo zp zq zr zs zt zu zv zw zx zy zz yn aba abb abc yo abd abe abf abg"><div class="abh abi abj abk abl dv l"><article class="dv"><div class="dv rr l"><div class="bg dv"><div class="dv l"><div class="fi dv abm abn abo abp abq abr abs abt abu abv abw abx aby" role="link" data-href="https://posts.specterops.io/certified-pre-owned-d95910965cd2" tabindex="0"><div class="abz"><div aria-label="Certified Pre-Owned"><div class="acb acc acd ace acf"><img alt="Certified Pre-Owned" class="bg acg ach aci acj bw" src="https://miro.medium.com/v2/resize:fit:849/0*uf2o4Dwroh6Xb77l" loading="lazy"></div></div></div><div class="aca ab ca cn"><div class="ab cn ack bg acl acm acn aco"><div class="uy va acp acq acr ab q"><div class="rd l"><div><div class="l" aria-hidden="false" aria-describedby="119" aria-labelledby="119"><a tabindex="-1" href="https://harmj0y.medium.com/?source=author_recirc-----50633a233999----0---------------------6d080829_d4eb_4f88_8345_7f879e023754-------" rel="noopener follow"><div class="l fi"><img alt="Will Schroeder" class="l fc bx acs act cw" src="https://miro.medium.com/v2/resize:fill:25:25/1*idzSM22ouVWVRLUiU5Kpkg.jpeg" width="20" height="20" loading="lazy"><div class="fq bx l acs act fr n ax fs"></div></div></a></div></div></div><div class="acu l"><div><div class="l" aria-hidden="false" aria-describedby="120" aria-labelledby="120"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://harmj0y.medium.com/?source=author_recirc-----50633a233999----0---------------------6d080829_d4eb_4f88_8345_7f879e023754-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Will Schroeder</p></a></div></div></div><div class="acu l"><p class="be b du z dt">in</p></div><div class="l"><div><div class="l" aria-hidden="false" aria-describedby="121" aria-labelledby="121"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://posts.specterops.io/?source=author_recirc-----50633a233999----0---------------------6d080829_d4eb_4f88_8345_7f879e023754-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Posts By SpecterOps Team Members</p></a></div></div></div></div><div class="acv l acw acx acy acz ada gm"><div class="adb adc add ade adf adg adh adi"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/certified-pre-owned-d95910965cd2?source=author_recirc-----50633a233999----0---------------------6d080829_d4eb_4f88_8345_7f879e023754-------"><div title=""><h2 class="be gu od of adj adk og oh oj adl adm ok nl qd adn ado qe np qg adp adq qh nt qj adr ads qk jj jl jm jo jq bj">Certified Pre-Owned</h2></div><div class="adt l"><h3 class="be b is z jj adu jl jm adv jo jq dt">Active Directory Certificate Services has a lot of attack potential!</h3></div></a></div></div><span class="be b du z dt"><div class="ig ab co ae"><div class="ab q"><span>Jun 17, 2021</span><div class=""><div class="fi adw dg ab q"><div class="fr wx adx ab q"><div class="aw dg di l cw"></div></div><a class="fr lu adx ab q" tabindex="-1" rel="noopener follow" href="/certified-pre-owned-d95910965cd2?source=author_recirc-----50633a233999----0---------------------6d080829_d4eb_4f88_8345_7f879e023754-------"><div class="aw l"><div><div class="ab" aria-hidden="false" aria-describedby="175" aria-labelledby="175"><div class="ab q fi"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.67 10.17l2.14 2.14c1.72 1.72 4.33 2.43 5.96.8a4.38 4.38 0 0 0 .76-5.38L10.7 4.25c-.35-.53-.85-1.22-1.33-.96-.5.26 0 1.56 0 1.56l.78 1.93-3.73-3.91C5.6 1.9 4.96 1.76 4.5 2.22c-.33.33-.26.85.48 1.6.5.5 1.89 1.95 1.89 1.95.17.18.08.49-.1.66-.09.1-.2.15-.34.16a.43.43 0 0 1-.31-.13l-2.8-2.87c-.35-.35-.8-.54-1.2-.15-.4.4-.27 1.06.11 1.44l2.69 2.67.06.06c.17.18.27.63.1.8-.2.2-.46.33-.69.28a.92.92 0 0 1-.44-.28S2.5 6.84 1.89 6.23c-.4-.4-.9-.33-1.23 0-.52.52.27 1.28 1.73 2.7.39.36.82.77 1.28 1.24zm8.47-7.22c.38-.3.95-.28 1.3.24l1.57 3a5 5 0 0 1-.48 5.24l-.03.04c-.21.27-.35.43-.74.61 1.38-1.85.96-3.47-.25-5.45l-1.57-2.75v-.04c-.02-.3-.04-.7.2-.9z" fill="#6B6B6B"></path></svg><span style="margin-left: 4px;">480</span></div></div></div></div><div class="aw l"><div><div class="ab" aria-hidden="false" aria-describedby="122" aria-labelledby="122"><div class="ab q fi"><svg width="16" height="16" viewBox="0 0 16 16" fill="#6B6B6B"><path d="M12.34 11.46A5.28 5.28 0 0 0 14 7.53C14 4.48 11.4 2 8.05 2 4.71 2 2 4.48 2 7.53c0 3.05 2.71 5.52 6.06 5.52.6 0 1.18-.08 1.76-.23.17.14.35.29.55.41.78.51 1.63.77 2.51.77.17 0 .3-.08.36-.22a.37.37 0 0 0-.03-.38 4.73 4.73 0 0 1-.86-1.96v.02z" fill="#6B6B6B"></path></svg><span style="margin-left: 4px;">4</span></div></div></div></div></a></div></div></div><div class="ab q ady adz"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="123" aria-labelledby="123"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd95910965cd2&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcertified-pre-owned-d95910965cd2&amp;source=-----50633a233999----0-----------------bookmark_preview----6d080829_d4eb_4f88_8345_7f879e023754-------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma aea" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></span><div class="j i d"><div class="te bg tf ly"></div></div></div></div></div></div></div></div></article></div></div><div class="zo zp zq zr zs zt zu zv zw zx zy zz yn aba abb abc yo abd abe abf abg"><div class="abh abi abj abk abl dv l"><article class="dv"><div class="dv rr l"><div class="bg dv"><div class="dv l"><div class="fi dv abm abn abo abp abq abr abs abt abu abv abw abx aby" role="link" data-href="https://posts.specterops.io/an-introduction-to-manual-active-directory-querying-with-dsquery-and-ldapsearch-84943c13d7eb" tabindex="0"><div class="abz"><div aria-label="An Introduction to Manual Active Directory Querying with Dsquery and Ldapsearch"><div class="acb acc acd ace acf"><img alt="An Introduction to Manual Active Directory Querying with Dsquery and Ldapsearch" class="bg acg ach aci acj bw" src="https://miro.medium.com/v2/resize:fit:849/1*ckMjsbf15mZr_nvv8kxYXw.png" loading="lazy"></div></div></div><div class="aca ab ca cn"><div class="ab cn ack bg acl acm acn aco"><div class="uy va acp acq acr ab q"><div class="rd l"><div><div class="l" aria-hidden="false" aria-describedby="124" aria-labelledby="124"><a tabindex="-1" href="https://medium.com/@Ice_Moon?source=author_recirc-----50633a233999----1---------------------6d080829_d4eb_4f88_8345_7f879e023754-------" rel="noopener follow"><div class="l fi"><img alt="Hope Walker" class="l fc bx acs act cw" src="https://miro.medium.com/v2/resize:fill:25:25/0*1dLPs8bH356Tkfng.jpg" width="20" height="20" loading="lazy"><div class="fq bx l acs act fr n ax fs"></div></div></a></div></div></div><div class="acu l"><div><div class="l" aria-hidden="false" aria-describedby="125" aria-labelledby="125"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://medium.com/@Ice_Moon?source=author_recirc-----50633a233999----1---------------------6d080829_d4eb_4f88_8345_7f879e023754-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Hope Walker</p></a></div></div></div><div class="acu l"><p class="be b du z dt">in</p></div><div class="l"><div><div class="l" aria-hidden="false" aria-describedby="126" aria-labelledby="126"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://posts.specterops.io/?source=author_recirc-----50633a233999----1---------------------6d080829_d4eb_4f88_8345_7f879e023754-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Posts By SpecterOps Team Members</p></a></div></div></div></div><div class="acv l acw acx acy acz ada gm"><div class="adb adc add ade adf adg adh adi"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/an-introduction-to-manual-active-directory-querying-with-dsquery-and-ldapsearch-84943c13d7eb?source=author_recirc-----50633a233999----1---------------------6d080829_d4eb_4f88_8345_7f879e023754-------"><div title="An Introduction to Manual Active Directory Querying with Dsquery and Ldapsearch"><h2 class="be gu od of adj adk og oh oj adl adm ok nl qd adn ado qe np qg adp adq qh nt qj adr ads qk jj jl jm jo jq bj">An Introduction to Manual Active Directory Querying with Dsquery and Ldapsearch</h2></div><div class="adt l"><h3 class="be b is z jj adu jl jm adv jo jq dt">Introduction</h3></div></a></div></div><span class="be b du z dt"><div class="ig ab co ae"><div class="ab q"><span>Jun 2, 2021</span><div class=""><div class="fi adw dg ab q"><div class="fr wx adx ab q"><div class="aw dg di l cw"></div></div><a class="fr lu adx ab q" tabindex="-1" rel="noopener follow" href="/an-introduction-to-manual-active-directory-querying-with-dsquery-and-ldapsearch-84943c13d7eb?source=author_recirc-----50633a233999----1---------------------6d080829_d4eb_4f88_8345_7f879e023754-------"><div class="aw l"><div><div class="ab" aria-hidden="false" aria-describedby="177" aria-labelledby="177"><div class="ab q fi"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.67 10.17l2.14 2.14c1.72 1.72 4.33 2.43 5.96.8a4.38 4.38 0 0 0 .76-5.38L10.7 4.25c-.35-.53-.85-1.22-1.33-.96-.5.26 0 1.56 0 1.56l.78 1.93-3.73-3.91C5.6 1.9 4.96 1.76 4.5 2.22c-.33.33-.26.85.48 1.6.5.5 1.89 1.95 1.89 1.95.17.18.08.49-.1.66-.09.1-.2.15-.34.16a.43.43 0 0 1-.31-.13l-2.8-2.87c-.35-.35-.8-.54-1.2-.15-.4.4-.27 1.06.11 1.44l2.69 2.67.06.06c.17.18.27.63.1.8-.2.2-.46.33-.69.28a.92.92 0 0 1-.44-.28S2.5 6.84 1.89 6.23c-.4-.4-.9-.33-1.23 0-.52.52.27 1.28 1.73 2.7.39.36.82.77 1.28 1.24zm8.47-7.22c.38-.3.95-.28 1.3.24l1.57 3a5 5 0 0 1-.48 5.24l-.03.04c-.21.27-.35.43-.74.61 1.38-1.85.96-3.47-.25-5.45l-1.57-2.75v-.04c-.02-.3-.04-.7.2-.9z" fill="#6B6B6B"></path></svg><span style="margin-left: 4px;">90</span></div></div></div></div><div class="aw l"><div><div class="ab" aria-hidden="false" aria-describedby="127" aria-labelledby="127"><div class="ab q fi"><svg width="16" height="16" viewBox="0 0 16 16" fill="#6B6B6B"><path d="M12.34 11.46A5.28 5.28 0 0 0 14 7.53C14 4.48 11.4 2 8.05 2 4.71 2 2 4.48 2 7.53c0 3.05 2.71 5.52 6.06 5.52.6 0 1.18-.08 1.76-.23.17.14.35.29.55.41.78.51 1.63.77 2.51.77.17 0 .3-.08.36-.22a.37.37 0 0 0-.03-.38 4.73 4.73 0 0 1-.86-1.96v.02z" fill="#6B6B6B"></path></svg><span style="margin-left: 4px;">3</span></div></div></div></div></a></div></div></div><div class="ab q ady adz"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="128" aria-labelledby="128"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F84943c13d7eb&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fan-introduction-to-manual-active-directory-querying-with-dsquery-and-ldapsearch-84943c13d7eb&amp;source=-----50633a233999----1-----------------bookmark_preview----6d080829_d4eb_4f88_8345_7f879e023754-------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma aea" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></span><div class="j i d"><div class="te bg tf ly"></div></div></div></div></div></div></div></div></article></div></div><div class="zo zp zq zr zs zt zu zv zw zx zy zz yn aba abb abc yo abd abe abf abg"><div class="abh abi abj abk abl dv l"><article class="dv"><div class="dv rr l"><div class="bg dv"><div class="dv l"><div class="fi dv abm abn abo abp abq abr abs abt abu abv abw abx aby" role="link" data-href="https://posts.specterops.io/lateral-movement-with-the-net-profiler-8772c86f9523" tabindex="0"><div class="abz"><div aria-label="Lateral Movement with the&nbsp;.NET Profiler"><div class="acb acc acd ace acf"><img alt="Lateral Movement with the&nbsp;.NET Profiler" class="bg acg ach aci acj bw" src="https://miro.medium.com/v2/resize:fit:849/1*ItDuxnzw5lEskkG_rW9bVQ.png" loading="lazy"></div></div></div><div class="aca ab ca cn"><div class="ab cn ack bg acl acm acn aco"><div class="uy va acp acq acr ab q"><div class="rd l"><div><div class="l" aria-hidden="false" aria-describedby="129" aria-labelledby="129"><a tabindex="-1" href="https://medium.com/@dan__mayer?source=author_recirc-----50633a233999----2---------------------6d080829_d4eb_4f88_8345_7f879e023754-------" rel="noopener follow"><div class="l fi"><img alt="Daniel Mayer" class="l fc bx acs act cw" src="https://miro.medium.com/v2/resize:fill:25:25/0*nUrW0bmxVnq1m9Yg.jpg" width="20" height="20" loading="lazy"><div class="fq bx l acs act fr n ax fs"></div></div></a></div></div></div><div class="acu l"><div><div class="l" aria-hidden="false" aria-describedby="130" aria-labelledby="130"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://medium.com/@dan__mayer?source=author_recirc-----50633a233999----2---------------------6d080829_d4eb_4f88_8345_7f879e023754-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Daniel Mayer</p></a></div></div></div><div class="acu l"><p class="be b du z dt">in</p></div><div class="l"><div><div class="l" aria-hidden="false" aria-describedby="131" aria-labelledby="131"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://posts.specterops.io/?source=author_recirc-----50633a233999----2---------------------6d080829_d4eb_4f88_8345_7f879e023754-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Posts By SpecterOps Team Members</p></a></div></div></div></div><div class="acv l acw acx acy acz ada gm"><div class="adb adc add ade adf adg adh adi"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/lateral-movement-with-the-net-profiler-8772c86f9523?source=author_recirc-----50633a233999----2---------------------6d080829_d4eb_4f88_8345_7f879e023754-------"><div title=""><h2 class="be gu od of adj adk og oh oj adl adm ok nl qd adn ado qe np qg adp adq qh nt qj adr ads qk jj jl jm jo jq bj">Lateral Movement with the&nbsp;.NET Profiler</h2></div><div class="adt l"><h3 class="be b is z jj adu jl jm adv jo jq dt">The accompanying code for this blogpost can be found HERE.</h3></div></a></div></div><span class="be b du z dt"><div class="ig ab co ae"><div class="ab q">3d ago<div class=""><div class="fi adw dg ab q"><div class="fr wx adx ab q"><div class="aw dg di l cw"></div></div><a class="fr lu adx ab q" tabindex="-1" rel="noopener follow" href="/lateral-movement-with-the-net-profiler-8772c86f9523?source=author_recirc-----50633a233999----2---------------------6d080829_d4eb_4f88_8345_7f879e023754-------"><div class="aw l"><div><div class="ab" aria-hidden="false" aria-describedby="179" aria-labelledby="179"><div class="ab q fi"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.67 10.17l2.14 2.14c1.72 1.72 4.33 2.43 5.96.8a4.38 4.38 0 0 0 .76-5.38L10.7 4.25c-.35-.53-.85-1.22-1.33-.96-.5.26 0 1.56 0 1.56l.78 1.93-3.73-3.91C5.6 1.9 4.96 1.76 4.5 2.22c-.33.33-.26.85.48 1.6.5.5 1.89 1.95 1.89 1.95.17.18.08.49-.1.66-.09.1-.2.15-.34.16a.43.43 0 0 1-.31-.13l-2.8-2.87c-.35-.35-.8-.54-1.2-.15-.4.4-.27 1.06.11 1.44l2.69 2.67.06.06c.17.18.27.63.1.8-.2.2-.46.33-.69.28a.92.92 0 0 1-.44-.28S2.5 6.84 1.89 6.23c-.4-.4-.9-.33-1.23 0-.52.52.27 1.28 1.73 2.7.39.36.82.77 1.28 1.24zm8.47-7.22c.38-.3.95-.28 1.3.24l1.57 3a5 5 0 0 1-.48 5.24l-.03.04c-.21.27-.35.43-.74.61 1.38-1.85.96-3.47-.25-5.45l-1.57-2.75v-.04c-.02-.3-.04-.7.2-.9z" fill="#6B6B6B"></path></svg><span style="margin-left: 4px;">17</span></div></div></div></div><div class="aw l"><div><div class="ab" aria-hidden="false" aria-describedby="132" aria-labelledby="132"><div class="ab q fi"><svg width="16" height="16" viewBox="0 0 16 16" fill="#6B6B6B"><path d="M12.34 11.46A5.28 5.28 0 0 0 14 7.53C14 4.48 11.4 2 8.05 2 4.71 2 2 4.48 2 7.53c0 3.05 2.71 5.52 6.06 5.52.6 0 1.18-.08 1.76-.23.17.14.35.29.55.41.78.51 1.63.77 2.51.77.17 0 .3-.08.36-.22a.37.37 0 0 0-.03-.38 4.73 4.73 0 0 1-.86-1.96v.02z" fill="#6B6B6B"></path></svg><span style="margin-left: 4px;">1</span></div></div></div></div></a></div></div></div><div class="ab q ady adz"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="133" aria-labelledby="133"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8772c86f9523&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Flateral-movement-with-the-net-profiler-8772c86f9523&amp;source=-----50633a233999----2-----------------bookmark_preview----6d080829_d4eb_4f88_8345_7f879e023754-------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma aea" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></span><div class="j i d"><div class="te bg tf ly"></div></div></div></div></div></div></div></div></article></div></div><div class="zo zp zq zr zs zt zu zv zw zx zy zz yn aba abb abc yo abd abe abf abg"><div class="abh abi abj abk abl dv l"><article class="dv"><div class="dv rr l"><div class="bg dv"><div class="dv l"><div class="fi dv abm abn abo abp abq abr abs abt abu abv abw abx aby" role="link" data-href="https://posts.specterops.io/behavior-vs-execution-modality-3318e8e81739" tabindex="0"><div class="abz"><div aria-label="Part 12: Behavior vs. Execution Modality"><div class="acb acc acd ace acf"><img alt="Part 12: Behavior vs. Execution Modality" class="bg acg ach aci acj bw" src="https://miro.medium.com/v2/resize:fit:849/1*UIS7fXeaD9cq--Mzb7cTPQ.png" loading="lazy"></div></div></div><div class="aca ab ca cn"><div class="ab cn ack bg acl acm acn aco"><div class="uy va acp acq acr ab q"><div class="rd l"><div><div class="l" aria-hidden="false" aria-describedby="134" aria-labelledby="134"><a tabindex="-1" href="https://medium.com/@jaredcatkinson?source=author_recirc-----50633a233999----3---------------------6d080829_d4eb_4f88_8345_7f879e023754-------" rel="noopener follow"><div class="l fi"><img alt="Jared Atkinson" class="l fc bx acs act cw" src="https://miro.medium.com/v2/resize:fill:25:25/1*sRu1zCJZ_h69U4RuksJhKQ@2x.jpeg" width="20" height="20" loading="lazy"><div class="fq bx l acs act fr n ax fs"></div></div></a></div></div></div><div class="acu l"><div><div class="l" aria-hidden="false" aria-describedby="135" aria-labelledby="135"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://medium.com/@jaredcatkinson?source=author_recirc-----50633a233999----3---------------------6d080829_d4eb_4f88_8345_7f879e023754-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Jared Atkinson</p></a></div></div></div><div class="acu l"><p class="be b du z dt">in</p></div><div class="l"><div><div class="l" aria-hidden="false" aria-describedby="136" aria-labelledby="136"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://posts.specterops.io/?source=author_recirc-----50633a233999----3---------------------6d080829_d4eb_4f88_8345_7f879e023754-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Posts By SpecterOps Team Members</p></a></div></div></div></div><div class="acv l acw acx acy acz ada gm"><div class="adb adc add ade adf adg adh adi"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/behavior-vs-execution-modality-3318e8e81739?source=author_recirc-----50633a233999----3---------------------6d080829_d4eb_4f88_8345_7f879e023754-------"><div title=""><h2 class="be gu od of adj adk og oh oj adl adm ok nl qd adn ado qe np qg adp adq qh nt qj adr ads qk jj jl jm jo jq bj">Part 12: Behavior vs. Execution Modality</h2></div></a></div></div><span class="be b du z dt"><div class="ig ab co ae"><div class="ab q"><span>May 21</span><div class=""><div class="fi adw dg ab q"><div class="fr wx adx ab q"><div class="aw dg di l cw"></div></div><a class="fr lu adx ab q" tabindex="-1" rel="noopener follow" href="/behavior-vs-execution-modality-3318e8e81739?source=author_recirc-----50633a233999----3---------------------6d080829_d4eb_4f88_8345_7f879e023754-------"><div class="aw l"><div><div class="ab" aria-hidden="false" aria-describedby="181" aria-labelledby="181"><div class="ab q fi"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.67 10.17l2.14 2.14c1.72 1.72 4.33 2.43 5.96.8a4.38 4.38 0 0 0 .76-5.38L10.7 4.25c-.35-.53-.85-1.22-1.33-.96-.5.26 0 1.56 0 1.56l.78 1.93-3.73-3.91C5.6 1.9 4.96 1.76 4.5 2.22c-.33.33-.26.85.48 1.6.5.5 1.89 1.95 1.89 1.95.17.18.08.49-.1.66-.09.1-.2.15-.34.16a.43.43 0 0 1-.31-.13l-2.8-2.87c-.35-.35-.8-.54-1.2-.15-.4.4-.27 1.06.11 1.44l2.69 2.67.06.06c.17.18.27.63.1.8-.2.2-.46.33-.69.28a.92.92 0 0 1-.44-.28S2.5 6.84 1.89 6.23c-.4-.4-.9-.33-1.23 0-.52.52.27 1.28 1.73 2.7.39.36.82.77 1.28 1.24zm8.47-7.22c.38-.3.95-.28 1.3.24l1.57 3a5 5 0 0 1-.48 5.24l-.03.04c-.21.27-.35.43-.74.61 1.38-1.85.96-3.47-.25-5.45l-1.57-2.75v-.04c-.02-.3-.04-.7.2-.9z" fill="#6B6B6B"></path></svg><span style="margin-left: 4px;">33</span></div></div></div></div></a></div></div></div><div class="ab q ady adz"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="137" aria-labelledby="137"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3318e8e81739&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fbehavior-vs-execution-modality-3318e8e81739&amp;source=-----50633a233999----3-----------------bookmark_preview----6d080829_d4eb_4f88_8345_7f879e023754-------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma aea" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></span></div></div></div></div></div></div></article></div></div></div><div class="te bg tf dj dk aeb aec aed"></div><div class="ab jc jd aee aef aeg"><a class="be b bf z bj re aeh aei aej ma lw wp eu ev ew aek ael aem ez wa wb aen aeo aep fa fb fc bl fd fe" href="https://medium.com/@lbcain18?source=post_page-----50633a233999--------------------------------" rel="noopener follow"><div class="l fe">See all from Lance B. Cain</div></a><div class="aeq aer aes aet aeu aev aew aex aey ls l"><a class="be b bf z bj re aeh aei aej ma lw wp eu ev ew aek ael aem ez wa wb aen aeo aep fa fb fc bl fd fe" href="https://posts.specterops.io/?source=post_page-----50633a233999--------------------------------" rel="noopener follow"><div class="l fe">See all from Posts By SpecterOps Team Members</div></a></div></div></div></div><div class="te bg tf aez afa afb afc afd"></div><div class="ab ca"><div class="ch bg fy fz ga gb"><div class="afe aff l"><h2 class="be sz od of og oh oj ok ol on oo op or os ot ov ow bj">Recommended from Medium</h2><div class="ph pi pj pk pl l"><div class="yy ab kz je yz za zb zc zd ze zf zg zh zi zj zk zl zm zn"><div class="zo zp zq zr zs zt zu zv zw zx zy zz yn aba abb abc yo abd abe abf abg"><div class="abh abi abj abk abl dv l"><article class="dv"><div class="dv rr l"><div class="bg dv"><div class="dv l"><div class="fi dv abm abn abo abp abq abr abs abt abu abv abw abx aby" role="link" data-href="https://medium.com/@n4d/interesting-av-edr-bypass-3ffa70fa338f" tabindex="0"><div class="abz"><div aria-label="Interesting AV/EDR bypass."><div class="acb acc acd ace acf"><img alt="Interesting AV/EDR bypass." class="bg acg ach aci acj bw" src="https://miro.medium.com/v2/resize:fit:849/1*xSgIUBcfnQMrRt2cE1udRQ.png" loading="lazy"></div></div></div><div class="aca ab ca cn"><div class="ab cn ack bg acl acm acn aco"><div class="uy va acp acq acr ab q"><div class="rd l"><div><div class="l" aria-hidden="false" aria-describedby="138" aria-labelledby="138"><a tabindex="-1" href="https://medium.com/@n4d?source=read_next_recirc-----50633a233999----0---------------------b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><div class="l fi"><img alt="n4d" class="l fc bx acs act cw" src="https://miro.medium.com/v2/resize:fill:25:25/1*6AN3wI37fGdDoaBIMYhpEw.png" width="20" height="20" loading="lazy"><div class="fq bx l acs act fr n ax fs"></div></div></a></div></div></div><div class="acu l"><div><div class="l" aria-hidden="false" aria-describedby="139" aria-labelledby="139"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://medium.com/@n4d?source=read_next_recirc-----50633a233999----0---------------------b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">n4d</p></a></div></div></div></div><div class="acv l acw acx acy acz ada gm"><div class="adb adc add ade adf adg adh adi"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/@n4d/interesting-av-edr-bypass-3ffa70fa338f?source=read_next_recirc-----50633a233999----0---------------------b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><div title=""><h2 class="be gu od of adj adk og oh oj adl adm ok nl qd adn ado qe np qg adp adq qh nt qj adr ads qk jj jl jm jo jq bj">Interesting AV/EDR bypass.</h2></div><div class="adt l"><h3 class="be b is z jj adu jl jm adv jo jq dt">Long story short: I pulled up a bunch of techniques and code together and it worked (again).&nbsp;:P</h3></div></a></div></div><span class="be b du z dt"><div class="ig ab co ae"><div class="ab q"><span>Feb 20</span><div class=""><div class="fi adw dg ab q"><div class="fr wx adx ab q"><div class="aw dg di l cw"></div></div><a class="fr lu adx ab q" tabindex="-1" href="https://medium.com/@n4d/interesting-av-edr-bypass-3ffa70fa338f?source=read_next_recirc-----50633a233999----0---------------------b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><div class="aw l"><div><div class="ab" aria-hidden="false" aria-describedby="182" aria-labelledby="182"><div class="ab q fi"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.67 10.17l2.14 2.14c1.72 1.72 4.33 2.43 5.96.8a4.38 4.38 0 0 0 .76-5.38L10.7 4.25c-.35-.53-.85-1.22-1.33-.96-.5.26 0 1.56 0 1.56l.78 1.93-3.73-3.91C5.6 1.9 4.96 1.76 4.5 2.22c-.33.33-.26.85.48 1.6.5.5 1.89 1.95 1.89 1.95.17.18.08.49-.1.66-.09.1-.2.15-.34.16a.43.43 0 0 1-.31-.13l-2.8-2.87c-.35-.35-.8-.54-1.2-.15-.4.4-.27 1.06.11 1.44l2.69 2.67.06.06c.17.18.27.63.1.8-.2.2-.46.33-.69.28a.92.92 0 0 1-.44-.28S2.5 6.84 1.89 6.23c-.4-.4-.9-.33-1.23 0-.52.52.27 1.28 1.73 2.7.39.36.82.77 1.28 1.24zm8.47-7.22c.38-.3.95-.28 1.3.24l1.57 3a5 5 0 0 1-.48 5.24l-.03.04c-.21.27-.35.43-.74.61 1.38-1.85.96-3.47-.25-5.45l-1.57-2.75v-.04c-.02-.3-.04-.7.2-.9z" fill="#6B6B6B"></path></svg><span style="margin-left: 4px;">28</span></div></div></div></div></a></div></div></div><div class="ab q ady adz"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="140" aria-labelledby="140"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3ffa70fa338f&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40n4d%2Finteresting-av-edr-bypass-3ffa70fa338f&amp;source=-----50633a233999----0-----------------bookmark_preview----b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma aea" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></span><div class="j i d"><div class="te bg tf ly"></div></div></div></div></div></div></div></div></article></div></div><div class="zo zp zq zr zs zt zu zv zw zx zy zz yn aba abb abc yo abd abe abf abg"><div class="abh abi abj abk abl dv l"><article class="dv"><div class="dv rr l"><div class="bg dv"><div class="dv l"><div class="fi dv abm abn abo abp abq abr abs abt abu abv abw abx aby" role="link" data-href="https://an0nbil.medium.com/the-only-recon-methodology-you-need-cf6c3aff1af1" tabindex="0"><div class="abz"><div aria-label="The only recon methodology you need."><div class="acb acc acd ace acf"><img alt="The only recon methodology you need." class="bg acg ach aci acj bw" src="https://miro.medium.com/v2/resize:fit:849/1*rbN4yk0DKuNkka5K8ptJUg.jpeg" loading="lazy"></div></div></div><div class="aca ab ca cn"><div class="ab cn ack bg acl acm acn aco"><div class="uy va acp acq acr ab q"><div class="rd l"><div><div class="l" aria-hidden="false" aria-describedby="141" aria-labelledby="141"><a tabindex="-1" href="https://an0nbil.medium.com/?source=read_next_recirc-----50633a233999----1---------------------b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><div class="l fi"><img alt="an0nbil" class="l fc bx acs act cw" src="https://miro.medium.com/v2/resize:fill:25:25/1*dUNqqReKHaTBZkMi1R3hQw.jpeg" width="20" height="20" loading="lazy"><div class="fq bx l acs act fr n ax fs"></div></div></a></div></div></div><div class="acu l"><div><div class="l" aria-hidden="false" aria-describedby="142" aria-labelledby="142"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://an0nbil.medium.com/?source=read_next_recirc-----50633a233999----1---------------------b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">an0nbil</p></a></div></div></div></div><div class="acv l acw acx acy acz ada gm"><div class="adb adc add ade adf adg adh adi"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://an0nbil.medium.com/the-only-recon-methodology-you-need-cf6c3aff1af1?source=read_next_recirc-----50633a233999----1---------------------b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><div title=""><h2 class="be gu od of adj adk og oh oj adl adm ok nl qd adn ado qe np qg adp adq qh nt qj adr ads qk jj jl jm jo jq bj">The only recon methodology you need.</h2></div><div class="adt l"><h3 class="be b is z jj adu jl jm adv jo jq dt">the best way to recon using just one tool.</h3></div></a></div></div><span class="be b du z dt"><div class="ig ab co ae"><div class="ab q"><span>Jun 6</span><div class=""><div class="fi adw dg ab q"><div class="fr wx adx ab q"><div class="aw dg di l cw"></div></div><a class="fr lu adx ab q" tabindex="-1" href="https://an0nbil.medium.com/the-only-recon-methodology-you-need-cf6c3aff1af1?source=read_next_recirc-----50633a233999----1---------------------b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><div class="aw l"><div><div class="ab" aria-hidden="false" aria-describedby="183" aria-labelledby="183"><div class="ab q fi"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.67 10.17l2.14 2.14c1.72 1.72 4.33 2.43 5.96.8a4.38 4.38 0 0 0 .76-5.38L10.7 4.25c-.35-.53-.85-1.22-1.33-.96-.5.26 0 1.56 0 1.56l.78 1.93-3.73-3.91C5.6 1.9 4.96 1.76 4.5 2.22c-.33.33-.26.85.48 1.6.5.5 1.89 1.95 1.89 1.95.17.18.08.49-.1.66-.09.1-.2.15-.34.16a.43.43 0 0 1-.31-.13l-2.8-2.87c-.35-.35-.8-.54-1.2-.15-.4.4-.27 1.06.11 1.44l2.69 2.67.06.06c.17.18.27.63.1.8-.2.2-.46.33-.69.28a.92.92 0 0 1-.44-.28S2.5 6.84 1.89 6.23c-.4-.4-.9-.33-1.23 0-.52.52.27 1.28 1.73 2.7.39.36.82.77 1.28 1.24zm8.47-7.22c.38-.3.95-.28 1.3.24l1.57 3a5 5 0 0 1-.48 5.24l-.03.04c-.21.27-.35.43-.74.61 1.38-1.85.96-3.47-.25-5.45l-1.57-2.75v-.04c-.02-.3-.04-.7.2-.9z" fill="#6B6B6B"></path></svg><span style="margin-left: 4px;">248</span></div></div></div></div></a></div></div></div><div class="ab q ady adz"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="143" aria-labelledby="143"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcf6c3aff1af1&amp;operation=register&amp;redirect=https%3A%2F%2Fan0nbil.medium.com%2Fthe-only-recon-methodology-you-need-cf6c3aff1af1&amp;source=-----50633a233999----1-----------------bookmark_preview----b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma aea" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></span></div></div></div></div></div></div></article></div></div></div></div><div class="te bg tf afg"></div><h2 class="be sz is z gs bj">Lists</h2><div class="qs l"><div class="cm ab kz je yz za zb zc zd ze zf zg zh zi zj zk zl zm zn"><div class="zo zp zq zr zs zt zu zv zw zx zy zz yn aba abb abc yo abd abe abf abg"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab ck cm" href="https://medium.com/@MediumStaff/list/stories-to-help-you-grow-as-a-software-developer-b1d913188c20?source=read_next_recirc-----50633a233999--------------------------------" rel="noopener follow"><div class="afm afn jj ab jb fi"><div class="fi acg afi bw afj"><div class="acg ig jj l"><img alt="" class="" src="https://miro.medium.com/v2/resize:fill:60:60/1*yr2O5U-a0-rfY34C6yOXMw.jpeg" width="48" height="48" loading="lazy" role="presentation"></div></div><div class="fi acg afi bw la afk"><div class="acg ig jj l"><div class="ig if l afo"><div class="bx dv bg l afp"></div></div></div></div><div class="fi acg bw io afl"><div class="acg ig jj l"><img alt="" class="" src="https://miro.medium.com/v2/resize:fill:60:60/1*_3WdkzQRqIq8tt3Wh-WhbA.jpeg" width="48" height="48" loading="lazy" role="presentation"></div></div></div><div class="aw l"><h2 class="be sz is z jj adu jl jm adv jo jq gs bj">Stories to Help You Grow as a Software Developer</h2><div class="be b du z dt ab afh">19 stories<span class="iv l" aria-hidden="true"><span class="be b bf z dt">·</span></span>1128 saves</div></div></a></div><div class="zo zp zq zr zs zt zu zv zw zx zy zz yn aba abb abc yo abd abe abf abg"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab ck cm" href="https://medium.com/@MediumStaff/list/staff-picks-c7bc6e1ee00f?source=read_next_recirc-----50633a233999--------------------------------" rel="noopener follow"><div class="afm afn jj ab jb fi"><div class="fi acg afi bw afj"><div class="acg ig jj l"><img alt="" class="" src="https://miro.medium.com/v2/resize:fill:60:60/1*c7CPwH-Dd-z-EuXCWt-nTQ.png" width="48" height="48" loading="lazy" role="presentation"></div></div><div class="fi acg afi bw la afk"><div class="acg ig jj l"><img alt="" class="" src="https://miro.medium.com/v2/resize:fill:60:60/1*k5MtMpG6s7gg982F6PKUDA.jpeg" width="48" height="48" loading="lazy" role="presentation"></div></div><div class="fi acg bw io afl"><div class="acg ig jj l"><img alt="" class="" src="https://miro.medium.com/v2/da:true/resize:fill:60:60/0*jVeDj5NiHn7uQS1B" width="48" height="48" loading="lazy" role="presentation"></div></div></div><div class="aw l"><h2 class="be sz is z jj adu jl jm adv jo jq gs bj">Staff Picks</h2><div class="be b du z dt ab afh">662 stories<span class="iv l" aria-hidden="true"><span class="be b bf z dt">·</span></span>1054 saves</div></div></a></div></div></div><div class="te bg tf aer dj aet dk afq afr afs aft afu afv"></div><div class="yy ab kz je yz za zb zc zd ze zf zg zh zi zj zk zl zm zn"><div class="zo zp zq zr zs zt zu zv zw zx zy zz yn aba abb abc yo abd abe abf abg"><div class="abh abi abj abk abl dv l"><article class="dv"><div class="dv rr l"><div class="bg dv"><div class="dv l"><div class="fi dv abm abn abo abp abq abr abs abt abu abv abw abx aby" role="link" data-href="https://medium.com/mii-cybersec/leveraging-exiftool-to-modify-file-metadata-and-inject-xss-102d0b891778" tabindex="0"><div class="abz"><div aria-label="Leveraging ExifTool to Modify File Metadata and Inject XSS"><div class="acb acc acd ace acf"><img alt="Leveraging ExifTool to Modify File Metadata and Inject XSS" class="bg acg ach aci acj bw" src="https://miro.medium.com/v2/resize:fit:849/0*fRl5Cc1i0uco0rZa.jpeg" loading="lazy"></div></div></div><div class="aca ab ca cn"><div class="ab cn ack bg acl acm acn aco"><div class="uy va acp acq acr ab q"><div class="rd l"><div><div class="l" aria-hidden="false" aria-describedby="144" aria-labelledby="144"><a tabindex="-1" href="https://medium.com/@32vincentie?source=read_next_recirc-----50633a233999----0---------------------b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><div class="l fi"><img alt="Vincent ie" class="l fc bx acs act cw" src="https://miro.medium.com/v2/resize:fill:25:25/1*dmbNkD5D-u45r44go_cf0g.png" width="20" height="20" loading="lazy"><div class="fq bx l acs act fr n ax fs"></div></div></a></div></div></div><div class="acu l"><div><div class="l" aria-hidden="false" aria-describedby="145" aria-labelledby="145"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://medium.com/@32vincentie?source=read_next_recirc-----50633a233999----0---------------------b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Vincent ie</p></a></div></div></div><div class="acu l"><p class="be b du z dt">in</p></div><div class="l"><div><div class="l" aria-hidden="false" aria-describedby="146" aria-labelledby="146"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://medium.com/mii-cybersec?source=read_next_recirc-----50633a233999----0---------------------b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">MII Cyber Security Consulting Services</p></a></div></div></div></div><div class="acv l acw acx acy acz ada gm"><div class="adb adc add ade adf adg adh adi"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/mii-cybersec/leveraging-exiftool-to-modify-file-metadata-and-inject-xss-102d0b891778?source=read_next_recirc-----50633a233999----0---------------------b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><div title=""><h2 class="be gu od of adj adk og oh oj adl adm ok nl qd adn ado qe np qg adp adq qh nt qj adr ads qk jj jl jm jo jq bj">Leveraging ExifTool to Modify File Metadata and Inject XSS</h2></div><div class="adt l"><h3 class="be b is z jj adu jl jm adv jo jq dt">What is Exiftool?</h3></div></a></div></div><span class="be b du z dt"><div class="ig ab co ae"><div class="ab q">3d ago<div class=""><div class="fi adw dg ab q"><div class="fr wx adx ab q"><div class="aw dg di l cw"></div></div><a class="fr lu adx ab q" tabindex="-1" href="https://medium.com/mii-cybersec/leveraging-exiftool-to-modify-file-metadata-and-inject-xss-102d0b891778?source=read_next_recirc-----50633a233999----0---------------------b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><div class="aw l"><div><div class="ab" aria-hidden="false" aria-describedby="184" aria-labelledby="184"><div class="ab q fi"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.67 10.17l2.14 2.14c1.72 1.72 4.33 2.43 5.96.8a4.38 4.38 0 0 0 .76-5.38L10.7 4.25c-.35-.53-.85-1.22-1.33-.96-.5.26 0 1.56 0 1.56l.78 1.93-3.73-3.91C5.6 1.9 4.96 1.76 4.5 2.22c-.33.33-.26.85.48 1.6.5.5 1.89 1.95 1.89 1.95.17.18.08.49-.1.66-.09.1-.2.15-.34.16a.43.43 0 0 1-.31-.13l-2.8-2.87c-.35-.35-.8-.54-1.2-.15-.4.4-.27 1.06.11 1.44l2.69 2.67.06.06c.17.18.27.63.1.8-.2.2-.46.33-.69.28a.92.92 0 0 1-.44-.28S2.5 6.84 1.89 6.23c-.4-.4-.9-.33-1.23 0-.52.52.27 1.28 1.73 2.7.39.36.82.77 1.28 1.24zm8.47-7.22c.38-.3.95-.28 1.3.24l1.57 3a5 5 0 0 1-.48 5.24l-.03.04c-.21.27-.35.43-.74.61 1.38-1.85.96-3.47-.25-5.45l-1.57-2.75v-.04c-.02-.3-.04-.7.2-.9z" fill="#6B6B6B"></path></svg><span style="margin-left: 4px;">3</span></div></div></div></div></a></div></div></div><div class="ab q ady adz"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="147" aria-labelledby="147"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F102d0b891778&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fmii-cybersec%2Fleveraging-exiftool-to-modify-file-metadata-and-inject-xss-102d0b891778&amp;source=-----50633a233999----0-----------------bookmark_preview----b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma aea" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></span><div class="j i d"><div class="te bg tf ly"></div></div></div></div></div></div></div></div></article></div></div><div class="zo zp zq zr zs zt zu zv zw zx zy zz yn aba abb abc yo abd abe abf abg"><div class="abh abi abj abk abl dv l"><article class="dv"><div class="dv rr l"><div class="bg dv"><div class="dv l"><div class="fi dv abm abn abo abp abq abr abs abt abu abv abw abx aby" role="link" data-href="https://medium.com/r3d-buck3t/red-teaming-in-cloud-leverage-azure-frontdoor-cdn-for-c2-redirectors-79dd9ca98178" tabindex="0"><div class="abz"><div aria-label="Red Teaming in Cloud: Leverage Azure FrontDoor CDN for C2 Redirectors"><div class="acb acc acd ace acf"><img alt="Red Teaming in Cloud: Leverage Azure FrontDoor CDN for C2 Redirectors" class="bg acg ach aci acj bw" src="https://miro.medium.com/v2/resize:fit:849/1*kTru0_882oqHwY0QXscLNw.jpeg" loading="lazy"></div></div></div><div class="aca ab ca cn"><div class="ab cn ack bg acl acm acn aco"><div class="uy va acp acq acr ab q"><div class="rd l"><div><div class="l" aria-hidden="false" aria-describedby="148" aria-labelledby="148"><a tabindex="-1" href="https://nairuzabulhul.medium.com/?source=read_next_recirc-----50633a233999----1---------------------b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><div class="l fi"><img alt="Nairuz Abulhul" class="l fc bx acs act cw" src="https://miro.medium.com/v2/resize:fill:25:25/0*kBFFDUVEn3zxUrt7.jpg" width="20" height="20" loading="lazy"><div class="fq bx l acs act fr n ax fs"></div></div></a></div></div></div><div class="acu l"><div><div class="l" aria-hidden="false" aria-describedby="149" aria-labelledby="149"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://nairuzabulhul.medium.com/?source=read_next_recirc-----50633a233999----1---------------------b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Nairuz Abulhul</p></a></div></div></div><div class="acu l"><p class="be b du z dt">in</p></div><div class="l"><div><div class="l" aria-hidden="false" aria-describedby="150" aria-labelledby="150"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://medium.com/r3d-buck3t?source=read_next_recirc-----50633a233999----1---------------------b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">R3d Buck3T</p></a></div></div></div></div><div class="acv l acw acx acy acz ada gm"><div class="adb adc add ade adf adg adh adi"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/r3d-buck3t/red-teaming-in-cloud-leverage-azure-frontdoor-cdn-for-c2-redirectors-79dd9ca98178?source=read_next_recirc-----50633a233999----1---------------------b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><div title=""><h2 class="be gu od of adj adk og oh oj adl adm ok nl qd adn ado qe np qg adp adq qh nt qj adr ads qk jj jl jm jo jq bj">Red Teaming in Cloud: Leverage Azure FrontDoor CDN for C2 Redirectors</h2></div><div class="adt l"><h3 class="be b is z jj adu jl jm adv jo jq dt">Evading Detection: Obfuscating C2 Infrastructure with Azure FrontDoor</h3></div></a></div></div><span class="be b du z dt"><div class="ig ab co ae"><div class="ab q"><span>Jan 11</span><div class=""><div class="fi adw dg ab q"><div class="fr wx adx ab q"><div class="aw dg di l cw"></div></div><a class="fr lu adx ab q" tabindex="-1" href="https://medium.com/r3d-buck3t/red-teaming-in-cloud-leverage-azure-frontdoor-cdn-for-c2-redirectors-79dd9ca98178?source=read_next_recirc-----50633a233999----1---------------------b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><div class="aw l"><div><div class="ab" aria-hidden="false" aria-describedby="185" aria-labelledby="185"><div class="ab q fi"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.67 10.17l2.14 2.14c1.72 1.72 4.33 2.43 5.96.8a4.38 4.38 0 0 0 .76-5.38L10.7 4.25c-.35-.53-.85-1.22-1.33-.96-.5.26 0 1.56 0 1.56l.78 1.93-3.73-3.91C5.6 1.9 4.96 1.76 4.5 2.22c-.33.33-.26.85.48 1.6.5.5 1.89 1.95 1.89 1.95.17.18.08.49-.1.66-.09.1-.2.15-.34.16a.43.43 0 0 1-.31-.13l-2.8-2.87c-.35-.35-.8-.54-1.2-.15-.4.4-.27 1.06.11 1.44l2.69 2.67.06.06c.17.18.27.63.1.8-.2.2-.46.33-.69.28a.92.92 0 0 1-.44-.28S2.5 6.84 1.89 6.23c-.4-.4-.9-.33-1.23 0-.52.52.27 1.28 1.73 2.7.39.36.82.77 1.28 1.24zm8.47-7.22c.38-.3.95-.28 1.3.24l1.57 3a5 5 0 0 1-.48 5.24l-.03.04c-.21.27-.35.43-.74.61 1.38-1.85.96-3.47-.25-5.45l-1.57-2.75v-.04c-.02-.3-.04-.7.2-.9z" fill="#6B6B6B"></path></svg><span style="margin-left: 4px;">14</span></div></div></div></div></a></div></div></div><div class="ab q ady adz"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="151" aria-labelledby="151"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F79dd9ca98178&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fr3d-buck3t%2Fred-teaming-in-cloud-leverage-azure-frontdoor-cdn-for-c2-redirectors-79dd9ca98178&amp;source=-----50633a233999----1-----------------bookmark_preview----b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma aea" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></span><div class="j i d"><div class="te bg tf ly"></div></div></div></div></div></div></div></div></article></div></div><div class="zo zp zq zr zs zt zu zv zw zx zy zz yn aba abb abc yo abd abe abf abg"><div class="abh abi abj abk abl dv l"><article class="dv"><div class="dv rr l"><div class="bg dv"><div class="dv l"><div class="fi dv abm abn abo abp abq abr abs abt abu abv abw abx aby" role="link" data-href="https://machiavellli.medium.com/how-i-got-my-first-bounty-65ad8a1763de" tabindex="0"><div class="abz"><div aria-label="How I Got My First €€€€ Bounty"><div class="acb acc acd ace acf"><img alt="How I Got My First €€€€ Bounty" class="bg acg ach aci acj bw" src="https://miro.medium.com/v2/resize:fit:849/1*myYtv3B4kw4eQcnsjE-5Kw.png" loading="lazy"></div></div></div><div class="aca ab ca cn"><div class="ab cn ack bg acl acm acn aco"><div class="uy va acp acq acr ab q"><div class="rd l"><div><div class="l" aria-hidden="false" aria-describedby="152" aria-labelledby="152"><a tabindex="-1" href="https://machiavellli.medium.com/?source=read_next_recirc-----50633a233999----2---------------------b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><div class="l fi"><img alt="Machiavelli" class="l fc bx acs act cw" src="https://miro.medium.com/v2/resize:fill:25:25/1*zLtLjSvuXsXYW_s7Pq5SRw.jpeg" width="20" height="20" loading="lazy"><div class="fq bx l acs act fr n ax fs"></div></div></a></div></div></div><div class="acu l"><div><div class="l" aria-hidden="false" aria-describedby="153" aria-labelledby="153"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://machiavellli.medium.com/?source=read_next_recirc-----50633a233999----2---------------------b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Machiavelli</p></a></div></div></div></div><div class="acv l acw acx acy acz ada gm"><div class="adb adc add ade adf adg adh adi"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://machiavellli.medium.com/how-i-got-my-first-bounty-65ad8a1763de?source=read_next_recirc-----50633a233999----2---------------------b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><div title=""><h2 class="be gu od of adj adk og oh oj adl adm ok nl qd adn ado qe np qg adp adq qh nt qj adr ads qk jj jl jm jo jq bj">How I Got My First €€€€ Bounty</h2></div><div class="adt l"><h3 class="be b is z jj adu jl jm adv jo jq dt">I’ll share In this write-up how I discovered my first €€€€ bounty.</h3></div></a></div></div><span class="be b du z dt"><div class="ig ab co ae"><div class="ab q"><span>Jun 3</span><div class=""><div class="fi adw dg ab q"><div class="fr wx adx ab q"><div class="aw dg di l cw"></div></div><a class="fr lu adx ab q" tabindex="-1" href="https://machiavellli.medium.com/how-i-got-my-first-bounty-65ad8a1763de?source=read_next_recirc-----50633a233999----2---------------------b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><div class="aw l"><div><div class="ab" aria-hidden="false" aria-describedby="186" aria-labelledby="186"><div class="ab q fi"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.67 10.17l2.14 2.14c1.72 1.72 4.33 2.43 5.96.8a4.38 4.38 0 0 0 .76-5.38L10.7 4.25c-.35-.53-.85-1.22-1.33-.96-.5.26 0 1.56 0 1.56l.78 1.93-3.73-3.91C5.6 1.9 4.96 1.76 4.5 2.22c-.33.33-.26.85.48 1.6.5.5 1.89 1.95 1.89 1.95.17.18.08.49-.1.66-.09.1-.2.15-.34.16a.43.43 0 0 1-.31-.13l-2.8-2.87c-.35-.35-.8-.54-1.2-.15-.4.4-.27 1.06.11 1.44l2.69 2.67.06.06c.17.18.27.63.1.8-.2.2-.46.33-.69.28a.92.92 0 0 1-.44-.28S2.5 6.84 1.89 6.23c-.4-.4-.9-.33-1.23 0-.52.52.27 1.28 1.73 2.7.39.36.82.77 1.28 1.24zm8.47-7.22c.38-.3.95-.28 1.3.24l1.57 3a5 5 0 0 1-.48 5.24l-.03.04c-.21.27-.35.43-.74.61 1.38-1.85.96-3.47-.25-5.45l-1.57-2.75v-.04c-.02-.3-.04-.7.2-.9z" fill="#6B6B6B"></path></svg><span style="margin-left: 4px;">379</span></div></div></div></div><div class="aw l"><div><div class="ab" aria-hidden="false" aria-describedby="154" aria-labelledby="154"><div class="ab q fi"><svg width="16" height="16" viewBox="0 0 16 16" fill="#6B6B6B"><path d="M12.34 11.46A5.28 5.28 0 0 0 14 7.53C14 4.48 11.4 2 8.05 2 4.71 2 2 4.48 2 7.53c0 3.05 2.71 5.52 6.06 5.52.6 0 1.18-.08 1.76-.23.17.14.35.29.55.41.78.51 1.63.77 2.51.77.17 0 .3-.08.36-.22a.37.37 0 0 0-.03-.38 4.73 4.73 0 0 1-.86-1.96v.02z" fill="#6B6B6B"></path></svg><span style="margin-left: 4px;">4</span></div></div></div></div></a></div></div></div><div class="ab q ady adz"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="155" aria-labelledby="155"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F65ad8a1763de&amp;operation=register&amp;redirect=https%3A%2F%2Fmachiavellli.medium.com%2Fhow-i-got-my-first-bounty-65ad8a1763de&amp;source=-----50633a233999----2-----------------bookmark_preview----b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma aea" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></span><div class="j i d"><div class="te bg tf ly"></div></div></div></div></div></div></div></div></article></div></div><div class="zo zp zq zr zs zt zu zv zw zx zy zz yn aba abb abc yo abd abe abf abg"><div class="abh abi abj abk abl dv l"><article class="dv"><div class="dv rr l"><div class="bg dv"><div class="dv l"><div class="fi dv abm abn abo abp abq abr abs abt abu abv abw abx aby" role="link" data-href="https://medium.com/@0xcc00/bypassing-edr-ntds-dit-protection-using-blueteam-tools-1d161a554f9f" tabindex="0"><div class="abz"><div aria-label="Bypassing EDR NTDS.dit protection using BlueTeam tools."><div class="acb acc acd ace acf"><img alt="Bypassing EDR NTDS.dit protection using BlueTeam tools." class="bg acg ach aci acj bw" src="https://miro.medium.com/v2/resize:fit:849/1*OekjFzy0rb7CEPgzXtLU0g.png" loading="lazy"></div></div></div><div class="aca ab ca cn"><div class="ab cn ack bg acl acm acn aco"><div class="uy va acp acq acr ab q"><div class="rd l"><div><div class="l" aria-hidden="false" aria-describedby="156" aria-labelledby="156"><a tabindex="-1" href="https://medium.com/@0xcc00?source=read_next_recirc-----50633a233999----3---------------------b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><div class="l fi"><img alt="bilal al-qurneh" class="l fc bx acs act cw" src="https://miro.medium.com/v2/resize:fill:25:25/1*pYE8wYFiiPEGeYB7BYkd0w.png" width="20" height="20" loading="lazy"><div class="fq bx l acs act fr n ax fs"></div></div></a></div></div></div><div class="acu l"><div><div class="l" aria-hidden="false" aria-describedby="157" aria-labelledby="157"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://medium.com/@0xcc00?source=read_next_recirc-----50633a233999----3---------------------b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">bilal al-qurneh</p></a></div></div></div></div><div class="acv l acw acx acy acz ada gm"><div class="adb adc add ade adf adg adh adi"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/@0xcc00/bypassing-edr-ntds-dit-protection-using-blueteam-tools-1d161a554f9f?source=read_next_recirc-----50633a233999----3---------------------b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><div title=""><h2 class="be gu od of adj adk og oh oj adl adm ok nl qd adn ado qe np qg adp adq qh nt qj adr ads qk jj jl jm jo jq bj">Bypassing EDR NTDS.dit protection using BlueTeam tools.</h2></div><div class="adt l"><h3 class="be b is z jj adu jl jm adv jo jq dt">During an internal penetration test, Cortex EDR was installed in the domain controller. After obtaining Domain Admin privileges on the…</h3></div></a></div></div><span class="be b du z dt"><div class="ig ab co ae"><div class="ab q">6d ago<div class=""><div class="fi adw dg ab q"><div class="fr wx adx ab q"><div class="aw dg di l cw"></div></div><a class="fr lu adx ab q" tabindex="-1" href="https://medium.com/@0xcc00/bypassing-edr-ntds-dit-protection-using-blueteam-tools-1d161a554f9f?source=read_next_recirc-----50633a233999----3---------------------b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><div class="aw l"><div><div class="ab" aria-hidden="false" aria-describedby="188" aria-labelledby="188"><div class="ab q fi"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.67 10.17l2.14 2.14c1.72 1.72 4.33 2.43 5.96.8a4.38 4.38 0 0 0 .76-5.38L10.7 4.25c-.35-.53-.85-1.22-1.33-.96-.5.26 0 1.56 0 1.56l.78 1.93-3.73-3.91C5.6 1.9 4.96 1.76 4.5 2.22c-.33.33-.26.85.48 1.6.5.5 1.89 1.95 1.89 1.95.17.18.08.49-.1.66-.09.1-.2.15-.34.16a.43.43 0 0 1-.31-.13l-2.8-2.87c-.35-.35-.8-.54-1.2-.15-.4.4-.27 1.06.11 1.44l2.69 2.67.06.06c.17.18.27.63.1.8-.2.2-.46.33-.69.28a.92.92 0 0 1-.44-.28S2.5 6.84 1.89 6.23c-.4-.4-.9-.33-1.23 0-.52.52.27 1.28 1.73 2.7.39.36.82.77 1.28 1.24zm8.47-7.22c.38-.3.95-.28 1.3.24l1.57 3a5 5 0 0 1-.48 5.24l-.03.04c-.21.27-.35.43-.74.61 1.38-1.85.96-3.47-.25-5.45l-1.57-2.75v-.04c-.02-.3-.04-.7.2-.9z" fill="#6B6B6B"></path></svg><span style="margin-left: 4px;">42</span></div></div></div></div><div class="aw l"><div><div class="ab" aria-hidden="false" aria-describedby="158" aria-labelledby="158"><div class="ab q fi"><svg width="16" height="16" viewBox="0 0 16 16" fill="#6B6B6B"><path d="M12.34 11.46A5.28 5.28 0 0 0 14 7.53C14 4.48 11.4 2 8.05 2 4.71 2 2 4.48 2 7.53c0 3.05 2.71 5.52 6.06 5.52.6 0 1.18-.08 1.76-.23.17.14.35.29.55.41.78.51 1.63.77 2.51.77.17 0 .3-.08.36-.22a.37.37 0 0 0-.03-.38 4.73 4.73 0 0 1-.86-1.96v.02z" fill="#6B6B6B"></path></svg><span style="margin-left: 4px;">2</span></div></div></div></div></a></div></div></div><div class="ab q ady adz"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="159" aria-labelledby="159"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1d161a554f9f&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%400xcc00%2Fbypassing-edr-ntds-dit-protection-using-blueteam-tools-1d161a554f9f&amp;source=-----50633a233999----3-----------------bookmark_preview----b13eae5d_ce9e_4327_865b_1dda92d3895c-------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma aea" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></span></div></div></div></div></div></div></article></div></div></div><div class="te bg tf dj dk aeb aec aed"></div><a class="be b bf z bj re aeh aei aej ma lw wp eu ev ew aek ael aem ez wa wb aen aeo aep fa fb fc bl fd fe" href="https://medium.com/?source=post_page-----50633a233999--------------------------------" rel="noopener follow"><div class="l fe">See more recommendations</div></a></div></div></div><div class="h k j"><div class="te bg tf tl"></div><div class="ab ca"><div class="ch bg fy fz ga gb"><div class="tm ab kz je"><div class="tn to l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----50633a233999--------------------------------" rel="noopener follow"><p class="be b du z dt">Help</p></a></div><div class="tn to l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----50633a233999--------------------------------" rel="noopener follow"><p class="be b du z dt">Status</p></a></div><div class="tn to l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/about?autoplay=1&amp;source=post_page-----50633a233999--------------------------------" rel="noopener follow"><p class="be b du z dt">About</p></a></div><div class="tn to l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----50633a233999--------------------------------" rel="noopener follow"><p class="be b du z dt">Careers</p></a></div><div class="tn to l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="mailto:pressinquiries@medium.com?source=post_page-----50633a233999--------------------------------" rel="noopener follow"><p class="be b du z dt">Press</p></a></div><div class="tn to l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----50633a233999--------------------------------" rel="noopener follow"><p class="be b du z dt">Blog</p></a></div><div class="tn to l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----50633a233999--------------------------------" rel="noopener follow"><p class="be b du z dt">Privacy</p></a></div><div class="tn to l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----50633a233999--------------------------------" rel="noopener follow"><p class="be b du z dt">Terms</p></a></div><div class="tn to l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----50633a233999--------------------------------" rel="noopener follow"><p class="be b du z dt">Text to speech</p></a></div><div class="tn l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/business?source=post_page-----50633a233999--------------------------------" rel="noopener follow"><p class="be b du z dt">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20240614-221838-3ba87a70fa"</script><script>window.__GRAPHQL_URI__ = "https://posts.specterops.io/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"This request is not using the cache middleware worker","group":"disabled","tags":["group-edgeCachePosts","post-50633a233999","user-040c3e09d079","collection-f05f8696e3cc"],"serverVariantState":"","middlewareEnabled":false,"cacheStatus":"DYNAMIC","shouldUseCache":false,"vary":[],"updatedPostPreviewsEnabled":false,"lohpExperimentEnabled":"control","prideLogoEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":true,"routingEntity":{"type":"COLLECTION","id":"f05f8696e3cc","explicit":true},"viewerIsBot":false},"debug":{"requestId":"e126c431-0ca9-491d-961d-6095665f1289","hybridDevServices":[],"originalSpanCarrier":{"ot-tracer-spanid":"70de7b9234cf4cf4","ot-tracer-traceid":"790d2fad3e482d09","ot-tracer-sampled":"true"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fposts.specterops.io\u002Fcalling-home-get-your-callbacks-through-rbi-50633a233999","host":"posts.specterops.io","hostname":"posts.specterops.io","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null}},"config":{"nodeEnv":"production","version":"main-20240614-221838-3ba87a70fa","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20240614-221838-3ba87a70fa","commit":"3ba87a70fa89456c9162015acb3c1797c92f4b41"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"1*OMF3fSqH8t4xBJ9-6oZDZw.png","height":106,"width":545},"postLogo":{"imageId":"1*kFrc4tBFM_tCis-2Ic87WA.png","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","isLoggedIn":false,"variantFlags":[{"__typename":"VariantFlag","name":"ios_social_share_sheet","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rito_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pre_pp_v4","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_speechify_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_display_paywall_after_onboarding","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_cards_byline","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_legacy_feed_in_iceland","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_homepage","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_for_members","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_friend_links_creation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_offline_reading","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_entities_to_follow_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_rating_prompt_stories_read_threshold","valueType":{"__typename":"VariantFlagNumber"}},{"__typename":"VariantFlag","name":"enable_group_gifting","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_monthly_premium_plan","valueType":{"__typename":"VariantFlagString","value":"12a660186432"}},{"__typename":"VariantFlag","name":"enable_android_dynamic_aspirational_paywall","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_pub_follower_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_dynamic_paywall_aspiriational","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_premium_tier_badge","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_recirc_model","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tipping_v0_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_syntax_highlight","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_archive_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_susi_redesign_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_partner_program_enrollment","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_bg_post_post","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sharer_validate_post_share_key","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"signin_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"enable_automod","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ml_rank_rex_anno","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pp_v4","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"signup_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"enable_explicit_signals_updated_post_previews","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_medium2_kbfd","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_streamline_pub_newsletters","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_diversification_rex","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pill_based_home_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_topic_portals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"textshots_userid","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"enable_import","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lo_homepage","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"rex_generator_max_candidates","valueType":{"__typename":"VariantFlagNumber"}},{"__typename":"VariantFlag","name":"enable_mobile_lohp_short_hero","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"enable_rex_new_push_notification_endpoint","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tag_recs","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"browsable_stream_config_bucket","valueType":{"__typename":"VariantFlagString","value":"curated-topics"}},{"__typename":"VariantFlag","name":"enable_footer_app_buttons","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_home_post_menu","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_for_members_username_selection","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_members_only_audio","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_monthly_plan","valueType":{"__typename":"VariantFlagString","value":"60e220181034"}},{"__typename":"VariantFlag","name":"enable_android_verified_author","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_app_flirty_thirty","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_pub_stats","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_response_markup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_marketing_emails","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_maim_the_meter","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"glyph_font_set","valueType":{"__typename":"VariantFlagString","value":"m2-unbound-source-serif-pro"}},{"__typename":"VariantFlag","name":"ios_enable_friend_links_creation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_verifications_service","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_server_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"can_send_tips_v0","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_cards","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_offline_reading","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"price_smoke_test_monthly","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"available_annual_plan","valueType":{"__typename":"VariantFlagString","value":"2c754bcc2995"}},{"__typename":"VariantFlag","name":"enable_braintree_paypal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_integration","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_avatar_upload","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sharer_create_post_share_key","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_image_sharer","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_switch_plan_premium_tier","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_deprecate_legacy_providers_v3","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_newsletter_lo_flow_custom_domains","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"reader_fair_distribution_non_qp","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_editor_new_publishing_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"coronavirus_topic_recirc","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"onboarding_tags_from_top_views","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_annual_premium_plan","valueType":{"__typename":"VariantFlagString","value":"4a442ace1476"}},{"__typename":"VariantFlag","name":"enable_branch_io","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_stripe_customers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_friend_links_postpage_banners","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_simplified_digest_v2_b","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tick_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_friend_links_postpage_banners","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_signup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_dynamic_paywall_programming","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"skip_fs_cache_user_vals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_miro_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tribute_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"mobile_custom_app_icon","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"redefined_top_posts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_one_tap","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_dynamic_programming_paywall","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_google_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_creator_welcome_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pride_logo","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tipping_v0_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_recaptcha_enterprise","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_client","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_premium_tier","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_trial_membership","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_post_referrers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sprig","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"reengagement_notification_duration","valueType":{"__typename":"VariantFlagNumber"}},{"__typename":"VariantFlag","name":"enable_apple_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_continue_this_thread","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_seamless_social_sharing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_two_hour_refresh","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_iceland_nux","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"can_receive_tips_v0","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_sign_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_apple_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_cache_less_following_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"crm_send_contact_to_sendgrid","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_eventstats_event_processing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_medium_forever_introductory_discount","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_user_follows","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_easy_resubscribe","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_speechify_widget","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_auto_follow_on_subscribe","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_aggregator_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_susi_redesign_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_explicit_signals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_first_story","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_reading_history","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_in_app_free_trial","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_autorefresh","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_starspace","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_verified_book_author","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"price_smoke_test_yearly","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"allow_access","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_lists_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_test_auth","valueType":{"__typename":"VariantFlagString","value":"disallow"}},{"__typename":"VariantFlag","name":"enable_braintree_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_iceland_forced_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_remove_twitter_onboarding_step","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_c","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mps_pp_writer_stats","valueType":{"__typename":"VariantFlagBoolean","value":true}}],"collectionByDomainOrSlug({\"domainOrSlug\":\"posts.specterops.io\"})":{"__ref":"Collection:f05f8696e3cc"},"viewer":null,"postResult({\"id\":\"50633a233999\"})":{"__ref":"Post:50633a233999"}},"ImageMetadata:1*D-FDlfkqivRBQZoESrwtqw.png":{"__typename":"ImageMetadata","id":"1*D-FDlfkqivRBQZoESrwtqw.png"},"Collection:f05f8696e3cc":{"__typename":"Collection","id":"f05f8696e3cc","favicon":{"__ref":"ImageMetadata:1*D-FDlfkqivRBQZoESrwtqw.png"},"customStyleSheet":null,"colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFF3F1FF","point":0},{"__typename":"ColorPoint","color":"#FFF1EFFF","point":0.1},{"__typename":"ColorPoint","color":"#FFEEEDFF","point":0.2},{"__typename":"ColorPoint","color":"#FFECEBFF","point":0.3},{"__typename":"ColorPoint","color":"#FFEAE9FF","point":0.4},{"__typename":"ColorPoint","color":"#FFE8E7FF","point":0.5},{"__typename":"ColorPoint","color":"#FFE5E4FF","point":0.6},{"__typename":"ColorPoint","color":"#FFE3E2FF","point":0.7},{"__typename":"ColorPoint","color":"#FFE1E0FF","point":0.8},{"__typename":"ColorPoint","color":"#FFDEDEFF","point":0.9},{"__typename":"ColorPoint","color":"#FFDCDCFF","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF8080B7","point":0},{"__typename":"ColorPoint","color":"#FF7777A8","point":0.1},{"__typename":"ColorPoint","color":"#FF6E6E9A","point":0.2},{"__typename":"ColorPoint","color":"#FF65658B","point":0.3},{"__typename":"ColorPoint","color":"#FF5C5B7D","point":0.4},{"__typename":"ColorPoint","color":"#FF52526E","point":0.5},{"__typename":"ColorPoint","color":"#FF484860","point":0.6},{"__typename":"ColorPoint","color":"#FF3D3D51","point":0.7},{"__typename":"ColorPoint","color":"#FF323241","point":0.8},{"__typename":"ColorPoint","color":"#FF262632","point":0.9},{"__typename":"ColorPoint","color":"#FF191921","point":1}]},"tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FF1E184B","colorPoints":[{"__typename":"ColorPoint","color":"#FF1E184B","point":0},{"__typename":"ColorPoint","color":"#FF3A3866","point":0.1},{"__typename":"ColorPoint","color":"#FF54537D","point":0.2},{"__typename":"ColorPoint","color":"#FF6C6C93","point":0.3},{"__typename":"ColorPoint","color":"#FF8383A6","point":0.4},{"__typename":"ColorPoint","color":"#FF9999B9","point":0.5},{"__typename":"ColorPoint","color":"#FFAEAECA","point":0.6},{"__typename":"ColorPoint","color":"#FFC3C2DB","point":0.7},{"__typename":"ColorPoint","color":"#FFD8D6EB","point":0.8},{"__typename":"ColorPoint","color":"#FFEBEAFA","point":0.9},{"__typename":"ColorPoint","color":"#FFFFFDFF","point":1}]}},"googleAnalyticsId":"UA-102239211-2","editors":[{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:74ad66811b78"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:70f84c574024"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:f4ab382d41"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:1bb43103a9a9"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:b9c2df322eaf"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:b206c297df42"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:d59f95c1ed1c"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:6e849bed7683"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:9bef3c9a8b49"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:10eca8f7a844"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:d248a36145f8"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:2562fc45d9a9"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:645ffcef8682"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:a041d7ac11fe"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:507d73de7b97"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:e7dfc7678b59"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:ff850017e32a"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:4d7214ceeaf8"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:a7b4cdae1aaa"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:760e415ea3c9"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:f95d89c4ba81"}}],"name":"Posts By SpecterOps Team Members","avatar":{"__ref":"ImageMetadata:1*D-FDlfkqivRBQZoESrwtqw.png"},"domain":"posts.specterops.io","slug":"specter-ops-posts","description":"Posts from SpecterOps team members on various topics relating information security","subscriberCount":4294,"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:f05f8696e3cc-viewerId:lo_feab786b6e83"},"twitterUsername":"specterops","facebookPageId":null,"logo":{"__ref":"ImageMetadata:1*s-5BWBr8XsgtIU5azKNhZQ.jpeg"}},"User:74ad66811b78":{"__typename":"User","id":"74ad66811b78"},"User:70f84c574024":{"__typename":"User","id":"70f84c574024"},"User:f4ab382d41":{"__typename":"User","id":"f4ab382d41"},"User:1bb43103a9a9":{"__typename":"User","id":"1bb43103a9a9"},"User:b9c2df322eaf":{"__typename":"User","id":"b9c2df322eaf"},"User:b206c297df42":{"__typename":"User","id":"b206c297df42"},"User:d59f95c1ed1c":{"__typename":"User","id":"d59f95c1ed1c"},"User:6e849bed7683":{"__typename":"User","id":"6e849bed7683"},"User:9bef3c9a8b49":{"__typename":"User","id":"9bef3c9a8b49"},"User:10eca8f7a844":{"__typename":"User","id":"10eca8f7a844"},"User:d248a36145f8":{"__typename":"User","id":"d248a36145f8"},"User:2562fc45d9a9":{"__typename":"User","id":"2562fc45d9a9"},"User:645ffcef8682":{"__typename":"User","id":"645ffcef8682"},"User:a041d7ac11fe":{"__typename":"User","id":"a041d7ac11fe"},"User:507d73de7b97":{"__typename":"User","id":"507d73de7b97"},"User:e7dfc7678b59":{"__typename":"User","id":"e7dfc7678b59"},"User:ff850017e32a":{"__typename":"User","id":"ff850017e32a"},"User:4d7214ceeaf8":{"__typename":"User","id":"4d7214ceeaf8"},"User:a7b4cdae1aaa":{"__typename":"User","id":"a7b4cdae1aaa"},"User:760e415ea3c9":{"__typename":"User","id":"760e415ea3c9"},"User:f95d89c4ba81":{"__typename":"User","id":"f95d89c4ba81"},"LinkedAccounts:040c3e09d079":{"__typename":"LinkedAccounts","mastodon":null,"id":"040c3e09d079"},"UserViewerEdge:userId:040c3e09d079-viewerId:lo_feab786b6e83":{"__typename":"UserViewerEdge","id":"userId:040c3e09d079-viewerId:lo_feab786b6e83","isFollowing":false,"isUser":false,"isMuting":false},"User:040c3e09d079":{"__typename":"User","id":"040c3e09d079","linkedAccounts":{"__ref":"LinkedAccounts:040c3e09d079"},"isSuspended":false,"imageId":"0*v0d00TR4cFqVeADo","mediumMemberAt":0,"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"name":"Lance B. Cain","socialStats":{"__typename":"SocialStats","followerCount":13},"username":"lbcain18","customDomainState":null,"hasSubdomain":false,"bio":"","isPartnerProgramEnrolled":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:040c3e09d079-viewerId:lo_feab786b6e83"},"viewerIsUser":false,"newsletterV3":null,"postSubscribeMembershipUpsellShownAt":0,"allowNotes":true,"membership":null,"twitterScreenName":""},"Paragraph:ef93a4900e65_0":{"__typename":"Paragraph","id":"ef93a4900e65_0","name":"1d7c","type":"H3","href":null,"layout":null,"metadata":null,"text":"Calling Home, Get Your Callbacks Through RBI","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_1":{"__typename":"Paragraph","id":"ef93a4900e65_1","name":"8707","type":"P","href":null,"layout":null,"metadata":null,"text":"Authored By: Lance B. Cain and Alexander DeMine","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":13,"end":26,"href":null,"anchorType":"USER","userId":"040c3e09d079","linkMetadata":null},{"__typename":"Markup","type":"A","start":31,"end":47,"href":null,"anchorType":"USER","userId":"de29a5193240","linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":26,"end":47,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_2":{"__typename":"Paragraph","id":"ef93a4900e65_2","name":"1451","type":"H3","href":null,"layout":null,"metadata":null,"text":"Overview","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_3":{"__typename":"Paragraph","id":"ef93a4900e65_3","name":"f7f7","type":"P","href":null,"layout":null,"metadata":null,"text":"Remote Browser Isolation (RBI) is a security technology which has been gaining popularity for large businesses securing their enterprise networks in recent years. This blog post describes methods that SpecterOps consultants have researched to successfully circumvent this technology during offensive assessments. Following a brief introduction to the technology, we share our firsthand experiences when encountering RBI solutions and techniques the SpecterOps team have employed for establishing command and control (C2) to systems that proxy traffic through RBI products broken down into three segments: Payload Ingress, C2 Egress, and RBI Bypass. This post then concludes with us sharing our perspective regarding the recommendation of RBIs as a defensive product for the modern enterprise.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":605,"end":620,"href":"#ca1b","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":622,"end":631,"href":"#18e8","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":637,"end":647,"href":"#f257","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":605,"end":620,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":622,"end":631,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":637,"end":647,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_4":{"__typename":"Paragraph","id":"ef93a4900e65_4","name":"e710","type":"H3","href":null,"layout":null,"metadata":null,"text":"What is RBI and Why Use It?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_5":{"__typename":"Paragraph","id":"ef93a4900e65_5","name":"f7b2","type":"P","href":null,"layout":null,"metadata":null,"text":"Browser isolation is a security concept in which a user’s web traffic is isolated in a virtual machine, hosted web browser, or some other manner to prevent malicious activities from reaching the end user; thereby lowering the general risk of web browsing. There are three types of browser isolation in use today: client-side browser isolation, on-premises browser isolation, and RBI. As these names imply, client-side virtualizes the browsing on the local host, on-premises runs within the organization, and RBI virtualizes the web sessions in the cloud. Each type of browser isolation has different pros and cons, but we will focus on RBI today.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_6":{"__typename":"Paragraph","id":"ef93a4900e65_6","name":"582c","type":"P","href":null,"layout":null,"metadata":null,"text":"The general concept of RBI is relatively simple. When users open their web browser to surf the web, they are not merely doing so from their local machine; rather, they are connecting to a cloud-hosted virtualized browser in which all web content is rendered and executed and then sent back to the end-user in a sanitized manner (Figure 1). Different vendors stream the content to the user differently, but it is sufficient to say they all do the same thing: sanitize and render client web traffic.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*EJZIdvkDgdThnyDr0mV5MA.png":{"__typename":"ImageMetadata","id":"1*EJZIdvkDgdThnyDr0mV5MA.png","originalHeight":490,"originalWidth":979,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ef93a4900e65_7":{"__typename":"Paragraph","id":"ef93a4900e65_7","name":"826f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*EJZIdvkDgdThnyDr0mV5MA.png"},"text":"Figure 1 — Cloudflare RBI Diagram","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":33,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_8":{"__typename":"Paragraph","id":"ef93a4900e65_8","name":"26cb","type":"P","href":null,"layout":null,"metadata":null,"text":"The primary focus of RBI is to prevent user interactions with web-based malware such as cross-site scripting (XSS), drive-by downloads, and various forms of malicious JavaScript. In this function, it does an excellent job. It is tough to get a user to fall for your finely crafted HTML smuggling attack when the webpage never actually makes it to the end user; their browser just shows a stream of pixels while the content renders on a separate system.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_9":{"__typename":"Paragraph","id":"ef93a4900e65_9","name":"ebd8","type":"H3","href":null,"layout":null,"metadata":null,"text":"Why Do We Care?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_10":{"__typename":"Paragraph","id":"ef93a4900e65_10","name":"f695","type":"P","href":null,"layout":null,"metadata":null,"text":"At this point, you may ask yourself, “I don’t really do web-based attacks. Why should I care?” Well, my friend, RBI has many more implications than what the vendors provide at face value. Most RBI security vendors supplement their solution with extra email protections to block the delivery of malware via user inboxes along with scanning, sanitizing, and blocking malicious downloads from any site. Additionally, one of the primary concerns you should have as an offensive professional is the profound impact RBI will likely have on your C2 traffic.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_11":{"__typename":"Paragraph","id":"ef93a4900e65_11","name":"05e5","type":"P","href":null,"layout":null,"metadata":null,"text":"It is not generally advertised on the product pages that RBI affects C2 traffic, but we promise you it does. Most RBI solutions we have dealt with are not set up to send individual browser sessions to a cloud-virtualized host. They may offer a link where a user can do that, but an organization usually has a proxy setup that sends ALL web traffic through RBI. This means your stealthy HTTPS C2 traffic gets sent through the same virtualized host process the same as everything else and results in the server responses to your agents being rendered as an inert stream. As you can probably imagine, trying to figure out why your C2 traffic is not returning when an organization uses RBI can be very frustrating.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":332,"end":336,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_12":{"__typename":"Paragraph","id":"ef93a4900e65_12","name":"6b56","type":"P","href":null,"layout":null,"metadata":null,"text":"If your next engagement has RBI in place to protect their web traffic; what do you do? Fear not, dear reader; we have asked the same question and are here to help you work through it. We categorize our suggested techniques into three categories: ingress, egress, and bypass. Ingress is pretty self-explanatory, but you may wonder why egress and bypass are separated. In our opinion, they are similar but distinctly different techniques concerning RBI. Egress can be summarized as getting your C2 traffic to call back using traffic that communicates “through” the RBI solution, while bypass (as the name implies) means we are taking a different route entirely by avoiding RBI solutions.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":245,"end":246,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_13":{"__typename":"Paragraph","id":"ef93a4900e65_13","name":"ca1b","type":"H3","href":null,"layout":null,"metadata":null,"text":"Payload Ingress","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_14":{"__typename":"Paragraph","id":"ef93a4900e65_14","name":"a14a","type":"P","href":null,"layout":null,"metadata":null,"text":"When delivering payloads to clients through RBI solutions, these solutions’ sandboxing and scanning capabilities present significant hurdles that must be overcome to achieve code execution in your target environment. RBI solutions typically allow the configuration of file upload and download profiles, restricting the types of files that can be submitted or retrieved from websites based on multiple factors such as file extension, size, entropy\u002Fencryption of data, signatures, site reputation, and more. As is tradition, different vendors implement these checks in diverse ways, so you will want to brush up on what the target organization is using to give your payloads the best chance of making it through these defensive solutions, but we have some generalized recommendations to help with that.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_15":{"__typename":"Paragraph","id":"ef93a4900e65_15","name":"a302","type":"H4","href":null,"layout":null,"metadata":null,"text":"Sandbox Evasion and System Checks","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_16":{"__typename":"Paragraph","id":"ef93a4900e65_16","name":"ebf6","type":"P","href":null,"layout":null,"metadata":null,"text":"These two considerations should hopefully be standard in most of your payloads, but you will want to implement them if you haven’t already. Utilizing standard techniques such as prime factorization, thread sleep checks, executing environment checks\u002Fguardrails like enumerating processors in a system, string obfuscation, string building, non-terminating conditional-based loops, and logic structures relying on user input will help you get through the RBI scanning process. Why? Well, the RBI solutions need to attempt to scan, sandbox, and evaluate the files they are proxying to users without causing too much of a burden on the user’s browsing experience. Slow browsing leads to unhappy users and unhappy users lead to security products being removed. By increasing the time it takes to evaluate a file, we can bypass some RBI products that, by default, are set to a fail-open state (i.e., if they cannot scan a file in a sufficient amount of time nor detect malicious logic while executing it in a sandbox, then it will just let the file through).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_17":{"__typename":"Paragraph","id":"ef93a4900e65_17","name":"d0f4","type":"H4","href":null,"layout":null,"metadata":null,"text":"Antivirus Inspection","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_18":{"__typename":"Paragraph","id":"ef93a4900e65_18","name":"acaa","type":"P","href":null,"layout":null,"metadata":null,"text":"Not all RBI products will prioritize this time factor. Some may only allow a user to view the file contents in the browser or allow the user to download a sanitized version of the file in which the product removes macros, JavaScript, or any other content the vendor deems may be suspicious; leaving the user with an inert download. Other RBI solutions are set to a fail-closed state that blocks the download of a file if it cannot scan it. This can be due to encryption or even size. For example, Cloudflare Zero Trust blocks uploads and downloads of encrypted, password-protected files or files larger than 15MB by default because it cannot scan those files.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_19":{"__typename":"Paragraph","id":"ef93a4900e65_19","name":"34d1","type":"P","href":null,"layout":null,"metadata":null,"text":"If we cannot send an encrypted payload because AV will block it since it cannot scan it, but we also cannot send an unencrypted payload because it will fail an AV check and get blocked, then what do we do? In our experience, obfuscation techniques like encoding data with Caesar ciphers and sandbox evasion checks have proven successful when delivering payloads through RBI solutions. Encoding using a technique with low entropy often has the products scan the delivered files since they are not fully encrypted. However, environment checks, large prime factorization calculations, and non-terminating loops relying on user input prevent the sandbox analysis from observing malicious logic execution since these cannot supply additional input or meet the environment requirements.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_20":{"__typename":"Paragraph","id":"ef93a4900e65_20","name":"da8c","type":"H4","href":null,"layout":null,"metadata":null,"text":"Users Are Still a Weak Point","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_21":{"__typename":"Paragraph","id":"ef93a4900e65_21","name":"0ba0","type":"P","href":null,"layout":null,"metadata":null,"text":"The additional challenges RBI solutions present mean we likely need to leverage the human factor to deliver payloads successfully. Although not impossible, the likelihood of bypassing the RBI in a technical manner is low. However, people are naturally curious, and like any good campaign, enticing the user to pull the payload to their system is often the preferred way to go.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_22":{"__typename":"Paragraph","id":"ef93a4900e65_22","name":"2224","type":"P","href":null,"layout":null,"metadata":null,"text":"When creating payloads such as Office documents, .pdf files, etc., that serve as an initial dropper capability, it is imperative to design them with hidden content or obfuscation that forces user interaction. Requiring user-supplied values such as passwords to access content increases the likelihood of successful payload detonation and delivery. With user input required, it is unlikely that an RBI solution will be capable of supplying a password or clicking a user engagement button\u002Fcheckbox when sandboxing a payload and, therefore, cannot detonate any malicious logic during analysis. Be mindful of how you implement the password, though, as fully encrypting a document with a password may get the file blocked since it cannot be scanned. If a user is presented with a rendered document that is obfuscated\u002Funreadable in the RBI browser rendering or sanitized version, they will be enticed to download the document locally and execute the included payload.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":49,"end":54,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_23":{"__typename":"Paragraph","id":"ef93a4900e65_23","name":"0312","type":"P","href":null,"layout":null,"metadata":null,"text":"Let us move into some demonstrations on payload ingress. We will use Cloudflare’s Zero Trust RBI solution for the demonstrations in this post. This is by no means any slight against Cloudflare’s product; it does its job well and we are fans of it. It just happened to be the solution we were actually able to get our hands on at a reasonable price, which we also see as a good thing as they make RBI reasonably available for most people. We will not be covering any phishing portions of the task, instead leaving that to the reader and presuming the user has reached the point of downloading and executing our payload. During these demonstrations, we are using the Mythic framework with the Apollo agent.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_24":{"__typename":"Paragraph","id":"ef93a4900e65_24","name":"63f1","type":"P","href":null,"layout":null,"metadata":null,"text":"First, we will use a straightforward HTTP C2 profile configuration going to our testing C2 domain (i.e., HTTPS:\u002F\u002FWWW.HALFLINGHIDEOUT.COM) with a standard accept header and user agent (Figure 2).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":105,"end":136,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*CcxaxlT11fiUgHTjbMc4jg.png":{"__typename":"ImageMetadata","id":"1*CcxaxlT11fiUgHTjbMc4jg.png","originalHeight":733,"originalWidth":979,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ef93a4900e65_25":{"__typename":"Paragraph","id":"ef93a4900e65_25","name":"19c1","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*CcxaxlT11fiUgHTjbMc4jg.png"},"text":"Figure 2 — HTTP C2 Profile Configuration","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":40,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_26":{"__typename":"Paragraph","id":"ef93a4900e65_26","name":"cd52","type":"P","href":null,"layout":null,"metadata":null,"text":"In testing the payload, we can see that in Burp Suite it is successfully reaching back to Mythic through our redirectors (Figure 3).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*frzXhsZfrBzbliXfMRstGw.png":{"__typename":"ImageMetadata","id":"1*frzXhsZfrBzbliXfMRstGw.png","originalHeight":406,"originalWidth":979,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ef93a4900e65_27":{"__typename":"Paragraph","id":"ef93a4900e65_27","name":"ac5b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*frzXhsZfrBzbliXfMRstGw.png"},"text":"Figure 3 — Tested C2 Callback Successful","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_28":{"__typename":"Paragraph","id":"ef93a4900e65_28","name":"6096","type":"P","href":null,"layout":null,"metadata":null,"text":"For our initial payload delivery, we are using a ClickOnce application. If you want to know more about abusing ClickOnce applications, we highly recommend you check out the blog post Nick Powers (@zyn3rgy) and Steven Flores (@0xthirteen) posted on the subject: Less Smartscreen More Caffeine: (Ab)using ClickOnce for Trusted Code Execution. In standard ClickOnce fashion, we click the application file and are prompted with the application run prompt security warning; clicking “Run” starts the installation (Figure 4).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":196,"end":204,"href":"https:\u002F\u002Ftwitter.com\u002Fzyn3rgy","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":225,"end":236,"href":"https:\u002F\u002Ftwitter.com\u002F0xthirteen","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":261,"end":339,"href":"https:\u002F\u002Fposts.specterops.io\u002Fless-smartscreen-more-caffeine-ab-using-clickonce-for-trusted-code-execution-1446ea8051c5","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Wzujuz2FHrpJEBE5q_WpsA.png":{"__typename":"ImageMetadata","id":"1*Wzujuz2FHrpJEBE5q_WpsA.png","originalHeight":660,"originalWidth":979,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ef93a4900e65_29":{"__typename":"Paragraph","id":"ef93a4900e65_29","name":"ac4e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Wzujuz2FHrpJEBE5q_WpsA.png"},"text":"Figure 4 — ClickOnce Application Security Warning","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":49,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_30":{"__typename":"Paragraph","id":"ef93a4900e65_30","name":"81ae","type":"P","href":null,"layout":null,"metadata":null,"text":"However, halfway through the installation, we encounter an error message. The application cannot retrieve all the files, corrupting the installation (Figure 5).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ybbxNSN079RcTvSbPCg4pQ.png":{"__typename":"ImageMetadata","id":"1*ybbxNSN079RcTvSbPCg4pQ.png","originalHeight":358,"originalWidth":979,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ef93a4900e65_31":{"__typename":"Paragraph","id":"ef93a4900e65_31","name":"fa52","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ybbxNSN079RcTvSbPCg4pQ.png"},"text":"Figure 5 — ClickOnce Application Installation Error","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":51,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_32":{"__typename":"Paragraph","id":"ef93a4900e65_32","name":"ac8c","type":"P","href":null,"layout":null,"metadata":null,"text":"By digging into the details, we can see that the issue lies in the Syncfusion.Tools.Windows.dll file (Figure 6). Furthermore, we can see in the Cloudflare gateway logs that the file was blocked for failing the AV scan (Figure 7 and Figure 8).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":67,"end":90,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":91,"end":95,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*WcMo6WuCEH7rWhiK2H3zDg.png":{"__typename":"ImageMetadata","id":"1*WcMo6WuCEH7rWhiK2H3zDg.png","originalHeight":70,"originalWidth":979,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ef93a4900e65_33":{"__typename":"Paragraph","id":"ef93a4900e65_33","name":"b2f1","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*WcMo6WuCEH7rWhiK2H3zDg.png"},"text":"Figure 6 — ClickOnce Application Error Details","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":46,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*MJErTHKLR-P3wA0tRENvJQ.png":{"__typename":"ImageMetadata","id":"1*MJErTHKLR-P3wA0tRENvJQ.png","originalHeight":35,"originalWidth":979,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ef93a4900e65_34":{"__typename":"Paragraph","id":"ef93a4900e65_34","name":"fac5","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*MJErTHKLR-P3wA0tRENvJQ.png"},"text":"Figure 7 — Cloudflare Block Log","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":31,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*41EJEEiOm9xaHtCMA5d_Bw.png":{"__typename":"ImageMetadata","id":"1*41EJEEiOm9xaHtCMA5d_Bw.png","originalHeight":279,"originalWidth":383,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ef93a4900e65_35":{"__typename":"Paragraph","id":"ef93a4900e65_35","name":"c4a5","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*41EJEEiOm9xaHtCMA5d_Bw.png"},"text":"Figure 8 — Cloudflare Block Log Details","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":39,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_36":{"__typename":"Paragraph","id":"ef93a4900e65_36","name":"3df8","type":"P","href":null,"layout":null,"metadata":null,"text":"We know this file does not contain malicious content, but if we check the setting on our Cloudflare setup, we can confirm that the default setting that blocks all requests that cannot be scanned is the issue because the file is too large (Figure 9). We will not be able to get our payload in this way if we cannot get all of our application files in. If we dig into the documentation, we can get the complete set of information on the non-scannable files (Figure 10). The default setting for Cloudflare is to fail-closed.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*4_NyZxJi5a6jyQr_Smp6mw.png":{"__typename":"ImageMetadata","id":"1*4_NyZxJi5a6jyQr_Smp6mw.png","originalHeight":239,"originalWidth":979,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ef93a4900e65_37":{"__typename":"Paragraph","id":"ef93a4900e65_37","name":"ae1e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*4_NyZxJi5a6jyQr_Smp6mw.png"},"text":"Figure 9 — Cloudflare Network Settings","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":38,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*tzFhDQBZgrjCY3vGktko3g.png":{"__typename":"ImageMetadata","id":"1*tzFhDQBZgrjCY3vGktko3g.png","originalHeight":528,"originalWidth":979,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ef93a4900e65_38":{"__typename":"Paragraph","id":"ef93a4900e65_38","name":"2f76","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*tzFhDQBZgrjCY3vGktko3g.png"},"text":"Figure 10 — Cloudflare Documentation","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":36,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_39":{"__typename":"Paragraph","id":"ef93a4900e65_39","name":"fcac","type":"P","href":null,"layout":null,"metadata":null,"text":"Since our initial ClickOnce route did not work, let’s change tactics. We can swap our delivery vector to a ISO image file (.iso) with a macro-embedded Excel file (.xlsm). The Excel file is obfuscated and uses a password to protect the content; however, we are protecting it via the macro instead of Excel’s standard password protection encryption. We do this so Cloudflare can still scan the file, but the scanner will not make it past the password prompt when running sandboxed analysis. With everything loaded up and sent, we can see that we can download the .iso file instead of getting blocked like our previous ClickOnce attempt (Figure 11).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":123,"end":127,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":163,"end":168,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":561,"end":566,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*lb74KTDIkvBZAdAqNjQfrg.png":{"__typename":"ImageMetadata","id":"1*lb74KTDIkvBZAdAqNjQfrg.png","originalHeight":494,"originalWidth":979,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ef93a4900e65_40":{"__typename":"Paragraph","id":"ef93a4900e65_40","name":"c018","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*lb74KTDIkvBZAdAqNjQfrg.png"},"text":"Figure 11 — Successful ISO Download","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":35,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_41":{"__typename":"Paragraph","id":"ef93a4900e65_41","name":"5697","type":"P","href":null,"layout":null,"metadata":null,"text":"Next, we double-click the ISO file and select “Open” to mount it (Figure 12). Then, we drag the Excel file to our desktop, so we do not have the Windows Mark-of-the-Web on it (Figure 13).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":153,"end":168,"href":"https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fdeployoffice\u002Fsecurity\u002Finternet-macros-blocked#mark-of-the-web-and-trusted-documents","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Vlr0CqyLdhqDzgK4v7DuAQ.png":{"__typename":"ImageMetadata","id":"1*Vlr0CqyLdhqDzgK4v7DuAQ.png","originalHeight":349,"originalWidth":428,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ef93a4900e65_42":{"__typename":"Paragraph","id":"ef93a4900e65_42","name":"d075","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Vlr0CqyLdhqDzgK4v7DuAQ.png"},"text":"Figure 12 — ISO Mounting Security Warning","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":41,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*QAGoKprnja9TTQ6F":{"__typename":"ImageMetadata","id":"0*QAGoKprnja9TTQ6F","originalHeight":338,"originalWidth":600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ef93a4900e65_43":{"__typename":"Paragraph","id":"ef93a4900e65_43","name":"bb82","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*QAGoKprnja9TTQ6F"},"text":"Figure 13 — Excel Export","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":24,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_44":{"__typename":"Paragraph","id":"ef93a4900e65_44","name":"ea16","type":"P","href":null,"layout":null,"metadata":null,"text":"When we open the Excel file, we see what appears to be encrypted contents, and the warning asks us if we want to enable the macro. The content is hidden to entice the user to enable the macros. Once we enable the macros, we are prompted to input a decryption password (Figure 14). When the password is entered, Excel tells us we have started decrypting (Figure 15), and finally, we switch out the shown sheets, and the content is shown to the user (Figure 16). On the backend of this process, the macro is writing our payload to disk and executing it.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*d_PI6LypODmtpJhNzruEbg.png":{"__typename":"ImageMetadata","id":"1*d_PI6LypODmtpJhNzruEbg.png","originalHeight":467,"originalWidth":979,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ef93a4900e65_45":{"__typename":"Paragraph","id":"ef93a4900e65_45","name":"8183","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*d_PI6LypODmtpJhNzruEbg.png"},"text":"Figure 14 — Macro Password Protected Excel","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":42,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*fvUmDFzRRTUJN-Fy9pK1Zg.png":{"__typename":"ImageMetadata","id":"1*fvUmDFzRRTUJN-Fy9pK1Zg.png","originalHeight":430,"originalWidth":470,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ef93a4900e65_46":{"__typename":"Paragraph","id":"ef93a4900e65_46","name":"1941","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*fvUmDFzRRTUJN-Fy9pK1Zg.png"},"text":"Figure 15 — Macro Decryption","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":28,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Fc9kECaxbZpPkGish9bgTA.png":{"__typename":"ImageMetadata","id":"1*Fc9kECaxbZpPkGish9bgTA.png","originalHeight":207,"originalWidth":402,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ef93a4900e65_47":{"__typename":"Paragraph","id":"ef93a4900e65_47","name":"a93e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Fc9kECaxbZpPkGish9bgTA.png"},"text":"Figure 16 — Excel Content Shown","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":31,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_48":{"__typename":"Paragraph","id":"ef93a4900e65_48","name":"2b09","type":"P","href":null,"layout":null,"metadata":null,"text":"However, we still have not received our callback. When we check out Burp Suite logs, we see that the C2 traffic is not getting the 200 response we hoped for (Figure 17). We then check out Cloudflare logs and confirm that the RBI is isolating our C2 traffic (Figure 18).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*o42tqKniPDZJKw5Ds6Sd8w.png":{"__typename":"ImageMetadata","id":"1*o42tqKniPDZJKw5Ds6Sd8w.png","originalHeight":375,"originalWidth":979,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ef93a4900e65_49":{"__typename":"Paragraph","id":"ef93a4900e65_49","name":"0510","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*o42tqKniPDZJKw5Ds6Sd8w.png"},"text":"Figure 17 — Unsuccessful C2 Callback","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":36,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*zBrl1uSf-JgfFRSgXrqgbg.png":{"__typename":"ImageMetadata","id":"1*zBrl1uSf-JgfFRSgXrqgbg.png","originalHeight":35,"originalWidth":979,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ef93a4900e65_50":{"__typename":"Paragraph","id":"ef93a4900e65_50","name":"da3e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*zBrl1uSf-JgfFRSgXrqgbg.png"},"text":"Figure 18 — Cloudflare Isolation Log","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":36,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_51":{"__typename":"Paragraph","id":"ef93a4900e65_51","name":"18e8","type":"H3","href":null,"layout":null,"metadata":null,"text":"C2 Egress","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_52":{"__typename":"Paragraph","id":"ef93a4900e65_52","name":"58d3","type":"P","href":null,"layout":null,"metadata":null,"text":"The first hurdle is over; we got our payload into the target environment. Now, we need to get the C2 session back out. Like the ingress section, while some talking points may not be new, we will cover them to better explain how RBI products affect C2 traffic when deployed in a target environment.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_53":{"__typename":"Paragraph","id":"ef93a4900e65_53","name":"7c19","type":"H4","href":null,"layout":null,"metadata":null,"text":"HTTP","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_54":{"__typename":"Paragraph","id":"ef93a4900e65_54","name":"7aa6","type":"P","href":null,"layout":null,"metadata":null,"text":"We will start with general HTTP(S) communication methods. Based on our experience with RBI, our first recommendation when crafting C2 traffic intended to egress an RBI solution with HTTP traffic is to omit any POST requests. Most RBI solutions implement features for Data Loss Prevention (DLP) that limit data that can be submitted or posted to different websites. Some vendors require explicit whitelisting of websites where data can be submitted using PUT or POST HTTP requests. A GET-only C2 profile will help save some heartache in the initial stages of getting an initial foothold; however, you can always expand into POST requests once you have the foothold to try and get the better C2 flow since GET-only profiles tend to be slower overall and produce significantly more transactions to exchange data with C2 servers.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":210,"end":215,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":454,"end":458,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":461,"end":466,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":483,"end":486,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":623,"end":628,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":704,"end":707,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_55":{"__typename":"Paragraph","id":"ef93a4900e65_55","name":"be62","type":"P","href":null,"layout":null,"metadata":null,"text":"If your C2 supports it, you can also try using web socket profiles like those available for many payloads in the Mythic framework. Since web sockets can currently only function without isolation, some RBI solutions may allow them by default. However, vendors differ and some may require whitelisting of approved sites where web sockets can be utilized. As with much of this post, your best bet is to study which vendor your target is using so you know how to use this information to fine-tune your traffic.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_56":{"__typename":"Paragraph","id":"ef93a4900e65_56","name":"50d2","type":"H4","href":null,"layout":null,"metadata":null,"text":"Headers","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_57":{"__typename":"Paragraph","id":"ef93a4900e65_57","name":"e0de","type":"P","href":null,"layout":null,"metadata":null,"text":"Like many web proxies and traffic-based security solutions, the headers in your C2 profile will matter in terms of blending in and getting through. However, the type of header you use can change how the RBI solution responds to your C2 traffic and may allow you to get out without much trouble. One initial significant header to include is a user agent. Be sure to explicitly set a modern browser-based user agent that is expected to exist in your target environment. Not all RBI solutions will block this, but many will block web traffic with user agents that do not match approved web browsers or do not meet a minimum sufficient version of a browser.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_58":{"__typename":"Paragraph","id":"ef93a4900e65_58","name":"5be3","type":"P","href":null,"layout":null,"metadata":null,"text":"Next, we have the Content-Type. While setting Content-Type to try to match vanilla web traffic to blend in is common, this can be a significant hindrance (and easy fix) when dealing with RBI products. Many RBI solutions will look for a Content-Type of “text\u002Fhtml” and send that traffic through isolation to ensure safe browsing for the user, which will result in breaking our C2 traffic. We recommend changing the Content-Type away from “text\u002Fhtml” if possible. Below is an example of two web requests from PowerShell, one isolated and the other inspected but not isolated (Figure 19 and Figure 20). The only difference between the requests was that the request on the left had a Content-Type of “application\u002Fjson” and the right had “text\u002Fhtml”. We have even succeeded by removing the Content-Type header entirely, though we do not regularly recommend doing this as it will make your traffic look very suspicious.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*RtdBnnYKcOXeO8lMw98QWQ.png":{"__typename":"ImageMetadata","id":"1*RtdBnnYKcOXeO8lMw98QWQ.png","originalHeight":621,"originalWidth":979,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ef93a4900e65_59":{"__typename":"Paragraph","id":"ef93a4900e65_59","name":"f595","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*RtdBnnYKcOXeO8lMw98QWQ.png"},"text":"Figure 19 — Accept Header Comparison “application\u002Fjson”","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":55,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*0W8CzZ0z2k8kAEnIj7wfJA.png":{"__typename":"ImageMetadata","id":"1*0W8CzZ0z2k8kAEnIj7wfJA.png","originalHeight":622,"originalWidth":979,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ef93a4900e65_60":{"__typename":"Paragraph","id":"ef93a4900e65_60","name":"2520","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*0W8CzZ0z2k8kAEnIj7wfJA.png"},"text":"Figure 20— Accept Header Comparison “text\u002Fhtml”","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":47,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_61":{"__typename":"Paragraph","id":"ef93a4900e65_61","name":"30e4","type":"H4","href":null,"layout":null,"metadata":null,"text":"Cookies","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_62":{"__typename":"Paragraph","id":"ef93a4900e65_62","name":"c03b","type":"P","href":null,"layout":null,"metadata":null,"text":"Our final header worth mentioning is cookies. Passing the C2 traffic in a cookie is not a new way of doing business, but it can be a great technique to get through RBI. Some RBI solutions virtualize and stream the web page content but transparently pass the cookie header to the other end of the channel for usability since many sites require cookie functionality. As with many solutions, usability equals abusability. We recommend modifying your C2 profile to send the traffic in the cookie and get your sessions out of the target environment as another potential option.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_63":{"__typename":"Paragraph","id":"ef93a4900e65_63","name":"f7af","type":"H4","href":null,"layout":null,"metadata":null,"text":"HTTP Authentication","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_64":{"__typename":"Paragraph","id":"ef93a4900e65_64","name":"4864","type":"P","href":null,"layout":null,"metadata":null,"text":"When attempting to have HTTP traffic egress an RBI security product, you must be prepared to authenticate to get out. Many RBI solutions implement SAML\u002FNTLM\u002FBasic authentication for outbound traffic that requires payloads to be able to authenticate to the web proxy when a HTTP 407 “Proxy Authentication Required” authorization message is returned.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_65":{"__typename":"Paragraph","id":"ef93a4900e65_65","name":"0f16","type":"P","href":null,"layout":null,"metadata":null,"text":"Some tools do not need to worry about this as much as others. PowerShell can natively use stored Kerberos tickets when creating web requests and can be a fundamental capability for web traffic to egress an authenticated proxy using Invoke-WebRequest for droppers. Cobalt Strike has a native capability to specify a proxy and credentials if known. It can automatically utilize stored NTLM credentials if available on a local system using the WinInet API if the proxy accepts it for basic or NTLM authentication. If you use payloads that are not proxy-aware or do not support providing credentials to egress, you will likely need to modify them or pick a new C2 framework for your RBI engagement.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_66":{"__typename":"Paragraph","id":"ef93a4900e65_66","name":"b466","type":"H4","href":null,"layout":null,"metadata":null,"text":"Redirectors","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_67":{"__typename":"Paragraph","id":"ef93a4900e65_67","name":"b357","type":"P","href":null,"layout":null,"metadata":null,"text":"As with any C2 channel, your redirector setup will significantly impact how RBI solutions react to your traffic. If you use a strict set of rewriting rules to filter traffic to your redirectors, you may need to open the rules up if the customer uses RBI since the traffic frequently traverses cloud-virtualized infrastructure instead of directly egressing from an organization’s assets; this is to avoid inadvertently blocking new payloads checking in from client environments because they originate from unknown addresses\u002Fspaces. Once you know where the traffic is coming from, you should trim down the rules to only what you need to allow and redirect everything else to somewhere else (like the ubiquitous HTTPS:\u002F\u002FWWW.GOOGLE.COM).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":709,"end":731,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_68":{"__typename":"Paragraph","id":"ef93a4900e65_68","name":"127b","type":"P","href":null,"layout":null,"metadata":null,"text":"Another critical factor is the need to use reputable domains for your redirectors. We do not mean just using domains not classified as malicious; you need actual classifications. Many RBI solutions will block uncategorized sites or sites classified as grayware. More than one RBI security vendor has begun internally tracking site categorizations and can even develop profiles per domain when users access new sites. This makes it more imperative that C2 domains are well established with positive reputations and a good history of being categorized as trustworthy in reputable categories such as news, finance, or healthcare sites.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_69":{"__typename":"Paragraph","id":"ef93a4900e65_69","name":"a8da","type":"P","href":null,"layout":null,"metadata":null,"text":"Lastly, you can likely kiss any unencrypted HTTP traffic goodbye. Ensure you have valid TLS certificates, as RBI products often block unencrypted HTTP traffic. Again, there is nothing necessarily new here, but it is something you want to get set up correctly to help you get a C2 session back to your infrastructure.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_70":{"__typename":"Paragraph","id":"ef93a4900e65_70","name":"8ea1","type":"P","href":null,"layout":null,"metadata":null,"text":"So why was our traffic not getting through before? If we look into the product documentation, we can find the answer we need for now. We can see in the isolation documentation that the isolation policies will apply to requests that include the “text\u002Fhtml” accept header (Figure 21). In this case, ensuring our C2 traffic included that to blend in with most web traffic was our downfall.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*y6x3MmDCcPK5fvKNjAqiMg.png":{"__typename":"ImageMetadata","id":"1*y6x3MmDCcPK5fvKNjAqiMg.png","originalHeight":427,"originalWidth":979,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ef93a4900e65_71":{"__typename":"Paragraph","id":"ef93a4900e65_71","name":"268a","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*y6x3MmDCcPK5fvKNjAqiMg.png"},"text":"Figure 21 — Cloudflare Isolation Documentation","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":46,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_72":{"__typename":"Paragraph","id":"ef93a4900e65_72","name":"5adf","type":"P","href":null,"layout":null,"metadata":null,"text":"Let us change our headers and try again. We modify our accept headers on our C2 profile in Mythic and build a new payload (Figure 22).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*HOUbulEvm2cyS9fiBHwPpA.png":{"__typename":"ImageMetadata","id":"1*HOUbulEvm2cyS9fiBHwPpA.png","originalHeight":709,"originalWidth":979,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ef93a4900e65_73":{"__typename":"Paragraph","id":"ef93a4900e65_73","name":"d9fa","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*HOUbulEvm2cyS9fiBHwPpA.png"},"text":"Figure 22 — Updated HTTP C2 Profile","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":35,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_74":{"__typename":"Paragraph","id":"ef93a4900e65_74","name":"f191","type":"P","href":null,"layout":null,"metadata":null,"text":"Once we get the new payload on the host and execute it, we can see the difference in the traffic. Our Burp Suite shows our desired 200 response code (Figure 23), and Cloudflare shows that our traffic was allowed through to the redirector (Figure 24). Finally, we have our callback to Mythic (Figure 25).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*zvsTVQ920QJrWMUKHBCMxg.png":{"__typename":"ImageMetadata","id":"1*zvsTVQ920QJrWMUKHBCMxg.png","originalHeight":284,"originalWidth":979,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ef93a4900e65_75":{"__typename":"Paragraph","id":"ef93a4900e65_75","name":"1256","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*zvsTVQ920QJrWMUKHBCMxg.png"},"text":"Figure 23 — Successful Callback in Burp","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":39,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*QNdjrHuuH-JoCbX3hHEOxA.png":{"__typename":"ImageMetadata","id":"1*QNdjrHuuH-JoCbX3hHEOxA.png","originalHeight":33,"originalWidth":979,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ef93a4900e65_76":{"__typename":"Paragraph","id":"ef93a4900e65_76","name":"76fb","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*QNdjrHuuH-JoCbX3hHEOxA.png"},"text":"Figure 24 — Cloudflare Allowed Log","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":34,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Lg5v4rHlkT-6EDAstcVrFg.png":{"__typename":"ImageMetadata","id":"1*Lg5v4rHlkT-6EDAstcVrFg.png","originalHeight":52,"originalWidth":414,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ef93a4900e65_77":{"__typename":"Paragraph","id":"ef93a4900e65_77","name":"7fac","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Lg5v4rHlkT-6EDAstcVrFg.png"},"text":"Figure 25 — New Callback in Mythic","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":34,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_78":{"__typename":"Paragraph","id":"ef93a4900e65_78","name":"f257","type":"H3","href":null,"layout":null,"metadata":null,"text":"RBI Bypass","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_79":{"__typename":"Paragraph","id":"ef93a4900e65_79","name":"dd18","type":"P","href":null,"layout":null,"metadata":null,"text":"Though we are covering it last, the most accessible methods of establishing C2 communications in customer environments that have deployed RBI solutions are to bypass these protections altogether when possible. This can be accomplished in a couple of different ways depending on the capabilities and configuration of the RBI implementation using either DNS C2 or Third-Party C2.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":352,"end":358,"href":"#453a","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":362,"end":376,"href":"#60ab","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":352,"end":358,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":362,"end":377,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_80":{"__typename":"Paragraph","id":"ef93a4900e65_80","name":"453a","type":"H4","href":null,"layout":null,"metadata":null,"text":"DNS C2","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_81":{"__typename":"Paragraph","id":"ef93a4900e65_81","name":"eddf","type":"P","href":null,"layout":null,"metadata":null,"text":"Many RBI solutions only monitor HTTP\u002FHTTPS traffic by default and either require explicitly configuring DNS monitoring or lack that capability altogether. A DNS C2 channel will commonly establish successful callbacks using UDP traffic that will be under less scrutiny rather than egressing a proxy. This comes with the OPSEC consideration that an increase in the volume of DNS requests, especially without any additional web requests resulting from the DNS resolution, can indicate compromise.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_82":{"__typename":"Paragraph","id":"ef93a4900e65_82","name":"b300","type":"P","href":null,"layout":null,"metadata":null,"text":"Some RBI solutions purport to perform DNS monitoring and inspection, but the effectiveness of these measures will vary by vendor; ultimately, this will rely upon the defensive maturity of your client environments. In our experience, DNS traffic is typically either being monitored and C2 communications will be quickly identified, or it is not monitored at all in many environments.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_83":{"__typename":"Paragraph","id":"ef93a4900e65_83","name":"60ab","type":"H4","href":null,"layout":null,"metadata":null,"text":"Third-Party C2","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_84":{"__typename":"Paragraph","id":"ef93a4900e65_84","name":"52d2","type":"P","href":null,"layout":null,"metadata":null,"text":"When establishing new HTTP\u002FS communication channels through RBI solutions, new domains and IP connections will be subject to inspection for any new traffic. However, it is common for popular applications to either be implicitly or explicitly excluded from inspection for RBI solutions, allowing their traffic to essentially bypass isolation when communicating with their servers. This can be leveraged to establish C2 communication through trusted applications using projects such as C3 on GitHub, which uses third-party applications like Dropbox, Google Drive, Discord, and Slack to communicate with a team server over the web application channels.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":484,"end":486,"href":"https:\u002F\u002Fgithub.com\u002FWithSecureLabs\u002FC3","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_85":{"__typename":"Paragraph","id":"ef93a4900e65_85","name":"fd21","type":"H3","href":null,"layout":null,"metadata":null,"text":"Our Recommended Methodology","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_86":{"__typename":"Paragraph","id":"ef93a4900e65_86","name":"bac2","type":"P","href":null,"layout":null,"metadata":null,"text":"If you are dealing with an RBI solution on your next engagement and cannot test your C2 channels beforehand, you are likely better off trying to go around first. Although DNS C2 callbacks are not the best for constant interaction, they can provide a great initial foothold that you can use to expand into an HTTP C2 channel slowly. Once you establish a DNS C2 foothold, work into a GET-only HTTP C2 channel. It will be your second-best chance of getting out and with the DNS backup, you will be able to troubleshoot what is going wrong. Lastly, you should try to move to a GET-POST HTTP C2 channel if the RBI will let them through.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":573,"end":581,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_87":{"__typename":"Paragraph","id":"ef93a4900e65_87","name":"5686","type":"H3","href":null,"layout":null,"metadata":null,"text":"Why Do We Still Recommend RBI?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_88":{"__typename":"Paragraph","id":"ef93a4900e65_88","name":"b145","type":"P","href":null,"layout":null,"metadata":null,"text":"Like every other security product vendor today, RBI vendors will pitch their products as a solution that will cure all your security woes and their product is infallible. We, like many of you, make our living proving that every product is fallible in some way. This does not mean we do not support companies developing RBI solutions. These products were a significant thorn in our side whenever we first encountered them during red team engagements. They do an excellent job allowing enterprises to fine-tune the sites, resources, and applications their users engage with on the web. We are actually quite big fans of RBI and hope that by releasing works like this focusing on the technology more entities will adopt it as they become aware of the benefits and the producers of these proxies can further refine their products. While they are not a one-stop solution for protecting your network, they are a significant advancement in preventative and detective tooling, and we highly recommend adding them to defense-in-depth solutions and testing recommendations.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_89":{"__typename":"Paragraph","id":"ef93a4900e65_89","name":"cb9d","type":"H4","href":null,"layout":null,"metadata":null,"text":"About Us","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_90":{"__typename":"Paragraph","id":"ef93a4900e65_90","name":"4032","type":"P","href":null,"layout":null,"metadata":null,"text":"Lance Cain is an Adversary Simulation Senior Consultant with SpecterOps. Lance has over seven years of experience in information technology with five of those specializing in Red Teaming and Penetration Testing. Lance formerly served as the Engineering Cell Lead of the Marine Corps’ Red Team specializing in payload and C2 channel development.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_91":{"__typename":"Paragraph","id":"ef93a4900e65_91","name":"2f8a","type":"P","href":null,"layout":null,"metadata":null,"text":"Alexander DeMine is an Adversary Simulation Consultant at SpecterOps with over 10 years of experience in the field of information technology. Formerly, Alex was the Chief of the Marine Corps’ Red Team, where he supervised and provided full-scope operational assessments of Marine Corps and DoD networks.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ef93a4900e65_92":{"__typename":"Paragraph","id":"ef93a4900e65_92","name":"9161","type":"P","href":null,"layout":null,"metadata":null,"text":"We began our journey into RBI while serving on the Marine Corps’ Red Team and have continued this research while working in a variety of different client environments during consultation work with SpecterOps. RBI has been a unique hurdle to overcome each time we have encountered it when working to establish C2 channels on offensive engagements. We hope that by sharing our tradecraft we are able to help shed some light for other teams out there that may be encountering the same challenges.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"CollectionViewerEdge:collectionId:f05f8696e3cc-viewerId:lo_feab786b6e83":{"__typename":"CollectionViewerEdge","id":"collectionId:f05f8696e3cc-viewerId:lo_feab786b6e83","isEditor":false,"isMuting":false},"ImageMetadata:1*s-5BWBr8XsgtIU5azKNhZQ.jpeg":{"__typename":"ImageMetadata","id":"1*s-5BWBr8XsgtIU5azKNhZQ.jpeg","originalWidth":2000,"originalHeight":805},"Tag:penetration-testing":{"__typename":"Tag","id":"penetration-testing","displayTitle":"Penetration Testing","normalizedTagSlug":"penetration-testing"},"Tag:web":{"__typename":"Tag","id":"web","displayTitle":"Web","normalizedTagSlug":"web"},"Tag:command-and-control":{"__typename":"Tag","id":"command-and-control","displayTitle":"Command And Control","normalizedTagSlug":"command-and-control"},"Tag:payload":{"__typename":"Tag","id":"payload","displayTitle":"Payload","normalizedTagSlug":"payload"},"Tag:red-team":{"__typename":"Tag","id":"red-team","displayTitle":"Red Team","normalizedTagSlug":"red-team"},"Post:50633a233999":{"__typename":"Post","id":"50633a233999","collection":{"__ref":"Collection:f05f8696e3cc"},"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"9aa9","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"20a2","startIndex":89,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:ef93a4900e65_0"},{"__ref":"Paragraph:ef93a4900e65_1"},{"__ref":"Paragraph:ef93a4900e65_2"},{"__ref":"Paragraph:ef93a4900e65_3"},{"__ref":"Paragraph:ef93a4900e65_4"},{"__ref":"Paragraph:ef93a4900e65_5"},{"__ref":"Paragraph:ef93a4900e65_6"},{"__ref":"Paragraph:ef93a4900e65_7"},{"__ref":"Paragraph:ef93a4900e65_8"},{"__ref":"Paragraph:ef93a4900e65_9"},{"__ref":"Paragraph:ef93a4900e65_10"},{"__ref":"Paragraph:ef93a4900e65_11"},{"__ref":"Paragraph:ef93a4900e65_12"},{"__ref":"Paragraph:ef93a4900e65_13"},{"__ref":"Paragraph:ef93a4900e65_14"},{"__ref":"Paragraph:ef93a4900e65_15"},{"__ref":"Paragraph:ef93a4900e65_16"},{"__ref":"Paragraph:ef93a4900e65_17"},{"__ref":"Paragraph:ef93a4900e65_18"},{"__ref":"Paragraph:ef93a4900e65_19"},{"__ref":"Paragraph:ef93a4900e65_20"},{"__ref":"Paragraph:ef93a4900e65_21"},{"__ref":"Paragraph:ef93a4900e65_22"},{"__ref":"Paragraph:ef93a4900e65_23"},{"__ref":"Paragraph:ef93a4900e65_24"},{"__ref":"Paragraph:ef93a4900e65_25"},{"__ref":"Paragraph:ef93a4900e65_26"},{"__ref":"Paragraph:ef93a4900e65_27"},{"__ref":"Paragraph:ef93a4900e65_28"},{"__ref":"Paragraph:ef93a4900e65_29"},{"__ref":"Paragraph:ef93a4900e65_30"},{"__ref":"Paragraph:ef93a4900e65_31"},{"__ref":"Paragraph:ef93a4900e65_32"},{"__ref":"Paragraph:ef93a4900e65_33"},{"__ref":"Paragraph:ef93a4900e65_34"},{"__ref":"Paragraph:ef93a4900e65_35"},{"__ref":"Paragraph:ef93a4900e65_36"},{"__ref":"Paragraph:ef93a4900e65_37"},{"__ref":"Paragraph:ef93a4900e65_38"},{"__ref":"Paragraph:ef93a4900e65_39"},{"__ref":"Paragraph:ef93a4900e65_40"},{"__ref":"Paragraph:ef93a4900e65_41"},{"__ref":"Paragraph:ef93a4900e65_42"},{"__ref":"Paragraph:ef93a4900e65_43"},{"__ref":"Paragraph:ef93a4900e65_44"},{"__ref":"Paragraph:ef93a4900e65_45"},{"__ref":"Paragraph:ef93a4900e65_46"},{"__ref":"Paragraph:ef93a4900e65_47"},{"__ref":"Paragraph:ef93a4900e65_48"},{"__ref":"Paragraph:ef93a4900e65_49"},{"__ref":"Paragraph:ef93a4900e65_50"},{"__ref":"Paragraph:ef93a4900e65_51"},{"__ref":"Paragraph:ef93a4900e65_52"},{"__ref":"Paragraph:ef93a4900e65_53"},{"__ref":"Paragraph:ef93a4900e65_54"},{"__ref":"Paragraph:ef93a4900e65_55"},{"__ref":"Paragraph:ef93a4900e65_56"},{"__ref":"Paragraph:ef93a4900e65_57"},{"__ref":"Paragraph:ef93a4900e65_58"},{"__ref":"Paragraph:ef93a4900e65_59"},{"__ref":"Paragraph:ef93a4900e65_60"},{"__ref":"Paragraph:ef93a4900e65_61"},{"__ref":"Paragraph:ef93a4900e65_62"},{"__ref":"Paragraph:ef93a4900e65_63"},{"__ref":"Paragraph:ef93a4900e65_64"},{"__ref":"Paragraph:ef93a4900e65_65"},{"__ref":"Paragraph:ef93a4900e65_66"},{"__ref":"Paragraph:ef93a4900e65_67"},{"__ref":"Paragraph:ef93a4900e65_68"},{"__ref":"Paragraph:ef93a4900e65_69"},{"__ref":"Paragraph:ef93a4900e65_70"},{"__ref":"Paragraph:ef93a4900e65_71"},{"__ref":"Paragraph:ef93a4900e65_72"},{"__ref":"Paragraph:ef93a4900e65_73"},{"__ref":"Paragraph:ef93a4900e65_74"},{"__ref":"Paragraph:ef93a4900e65_75"},{"__ref":"Paragraph:ef93a4900e65_76"},{"__ref":"Paragraph:ef93a4900e65_77"},{"__ref":"Paragraph:ef93a4900e65_78"},{"__ref":"Paragraph:ef93a4900e65_79"},{"__ref":"Paragraph:ef93a4900e65_80"},{"__ref":"Paragraph:ef93a4900e65_81"},{"__ref":"Paragraph:ef93a4900e65_82"},{"__ref":"Paragraph:ef93a4900e65_83"},{"__ref":"Paragraph:ef93a4900e65_84"},{"__ref":"Paragraph:ef93a4900e65_85"},{"__ref":"Paragraph:ef93a4900e65_86"},{"__ref":"Paragraph:ef93a4900e65_87"},{"__ref":"Paragraph:ef93a4900e65_88"},{"__ref":"Paragraph:ef93a4900e65_89"},{"__ref":"Paragraph:ef93a4900e65_90"},{"__ref":"Paragraph:ef93a4900e65_91"},{"__ref":"Paragraph:ef93a4900e65_92"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:040c3e09d079"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fcalling-home-get-your-callbacks-through-rbi-50633a233999","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"cybersecurity"}],"isPublished":true,"latestPublishedVersion":"ef93a4900e65","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"createdAt":1705348106784,"firstPublishedAt":1705532361101,"latestPublishedAt":1705532361101,"clapCount":9,"allowResponses":true,"isLimitedState":false,"title":"Calling Home, Get Your Callbacks Through RBI","isSeries":false,"sequence":null,"uniqueSlug":"calling-home-get-your-callbacks-through-rbi-50633a233999","socialTitle":"","socialDek":"","noIndex":null,"canonicalUrl":"","metaDescription":"","readingTime":17.954716981132073,"previewContent":{"__typename":"PreviewContent","subtitle":"Authored By: Lance B. Cain and Alexander DeMine"},"previewImage":{"__ref":"ImageMetadata:1*EJZIdvkDgdThnyDr0mV5MA.png"},"isShortform":false,"seoTitle":"","updatedAt":1705792835760,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:penetration-testing"},{"__ref":"Tag:web"},{"__ref":"Tag:command-and-control"},{"__ref":"Tag:payload"},{"__ref":"Tag:red-team"}],"isNewsletter":false,"statusForCollection":"APPROVED","pendingCollection":null,"detectedLanguage":"en","wordCount":4228,"layerCake":6}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.3cc5e3b6.js"></script><script src="https://cdn-client.medium.com/lite/static/js/2640.3217006c.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.7db0aaff.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.4ddbf12e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.2021fe63.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6068.e9093f2e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4398.db4d4378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7883.0e445e04.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9281.e9be8bce.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7111.b294e9da.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6481.362dec70.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8695.6f58679b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8978.4b110123.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3418.eb013b5a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3894.e3d01e2c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5514.32e692f6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5203.e7f058c5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7098.93054372.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8051.0a9d3f4b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8558.abbaadfd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1711.7605eb3e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8597.762eae49.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9174.b1b0f607.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8883.2f95bbf4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/705.e5898c57.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2911.d072adec.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8580.feeb2549.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6046.f9be485b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/500.d5389c14.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9408.22b56993.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6605.84e81b15.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6637.661bd7cf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7421.3f94f5ea.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/51.d8fb2684.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2133.c8ba56b1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.81dff084.chunk.js"></script><script>window.main();</script><div><div class="grecaptcha-badge" data-style="bottomright" style="width: 256px; height: 60px; display: block; transition: right 0.3s; position: fixed; bottom: 14px; right: -186px; box-shadow: gray 0px 0px 5px; border-radius: 2px; overflow: hidden;"><div class="grecaptcha-logo"><iframe title="reCAPTCHA" width="256" height="60" role="presentation" name="a-9p9hae5bp015" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox allow-storage-access-by-user-activation" src="https://www.google.com/recaptcha/enterprise/anchor?ar=1&amp;k=6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp&amp;co=aHR0cHM6Ly9wb3N0cy5zcGVjdGVyb3BzLmlvOjQ0Mw..&amp;hl=pl&amp;v=TqxSU0dsOd2Q9IbI7CpFnJLD&amp;size=invisible&amp;cb=jpjcrj3e5z3l"></iframe></div><div class="grecaptcha-error"></div><textarea id="g-recaptcha-response-100000" name="g-recaptcha-response" class="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea></div><iframe style="display: none;"></iframe></div><div><div class="ua n xp xq td xr xs xt xu xv xw xx xy xz ya cg bo qw yb yc lu yd ye"><div class="be b du z wk"><div class="ab co yf yg"><div class="l" role="alert">To make Medium work, we log user data. By using Medium, you agree to our <a class="af ag ah ai aj ak al am an ao ap yh yi pd" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9" rel="noopener follow" target="_blank">Privacy Policy</a>, including cookie policy.</div><div class="yj yk yl ym yn yo l yp jb yq"><div class="l fi n ur"><button class="af ag ah ai aj ak al am an ao ap yh yi yr ys ab" data-testid="close-button" aria-label="close"><svg width="19" height="19" viewBox="0 0 19 19" class="ep eo"><path d="M13.8 4.6L9.5 8.89 5.21 4.6l-.61.61 4.29 4.3-4.29 4.28.61.62 4.3-4.3 4.28 4.3.62-.62-4.3-4.29 4.3-4.29" fill-rule="evenodd"></path></svg></button></div></div></div></div></div></div></body></html>