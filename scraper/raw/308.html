<html class="v2" dir="ltr" lang="en"><head>
<link href="https://www.blogger.com/static/v1/widgets/3566091532-css_bundle_v2.css" rel="stylesheet" type="text/css">
<meta content="width=1100" name="viewport">
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<meta content="blogger" name="generator">
<link href="https://labs.ioactive.com/favicon.ico" rel="icon" type="image/x-icon">
<link href="https://labs.ioactive.com/2021/07/breaking-protocol-buffers-reverse.html" rel="canonical">
<link rel="alternate" type="application/atom+xml" title="IOActive Labs - Atom" href="https://labs.ioactive.com/feeds/posts/default">
<link rel="alternate" type="application/rss+xml" title="IOActive Labs - RSS" href="https://labs.ioactive.com/feeds/posts/default?alt=rss">
<link rel="service.post" type="application/atom+xml" title="IOActive Labs - Atom" href="https://www.blogger.com/feeds/2165778380262691600/posts/default">

<link rel="alternate" type="application/atom+xml" title="IOActive Labs - Atom" href="https://labs.ioactive.com/feeds/4469446424408015238/comments/default">
<!--Can't find substitution for tag [blog.ieCssRetrofitLinks]-->
<link href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh9E3nAC5KM9vLWMim3MUzvjPQ1BegmKO8UwDRTyxe8K8pnGGEYlyxPBlwpK3HPmbl67Vpt6ASLsjFVhoWR6SxrsOlu-9J-S47rRPCKknFyGyBfezttxAjP3f-Tul2Q4gZnjvN-9xejeqc/w617-h73/RegisterService_xrefs.png" rel="image_src">
<meta content="https://labs.ioactive.com/2021/07/breaking-protocol-buffers-reverse.html" property="og:url">
<meta content="Breaking Protocol (Buffers): Reverse Engineering gRPC Binaries" property="og:title">
<meta content="by Ethan Shackelford The Basics gRPC is an open-source RPC  framework from Google which leverages automatic code generation to allow  easy i..." property="og:description">
<meta content="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh9E3nAC5KM9vLWMim3MUzvjPQ1BegmKO8UwDRTyxe8K8pnGGEYlyxPBlwpK3HPmbl67Vpt6ASLsjFVhoWR6SxrsOlu-9J-S47rRPCKknFyGyBfezttxAjP3f-Tul2Q4gZnjvN-9xejeqc/w1200-h630-p-k-no-nu/RegisterService_xrefs.png" property="og:image">
<title>IOActive Labs: Breaking Protocol (Buffers): Reverse Engineering gRPC Binaries</title>
<style id="page-skin-1" type="text/css"><!--
/*
-----------------------------------------------
Blogger Template Style
Name:     Simple
Designer: Blogger
URL:      www.blogger.com
----------------------------------------------- */
/* Content
----------------------------------------------- */
body {
font: normal normal 12px 'Trebuchet MS', Trebuchet, Verdana, sans-serif;
color: #666666;
background: #ffffff none repeat scroll top left;
padding: 0 0 0 0;
}
html body .region-inner {
min-width: 0;
max-width: 100%;
width: auto;
}
h2 {
font-size: 22px;
}
a:link {
text-decoration:none;
color: #2288bb;
}
a:visited {
text-decoration:none;
color: #888888;
}
a:hover {
text-decoration:underline;
color: #33aaff;
}
.body-fauxcolumn-outer .fauxcolumn-inner {
background: transparent none repeat scroll top left;
_background-image: none;
}
.body-fauxcolumn-outer .cap-top {
position: absolute;
z-index: 1;
height: 400px;
width: 100%;
}
.body-fauxcolumn-outer .cap-top .cap-left {
width: 100%;
background: transparent none repeat-x scroll top left;
_background-image: none;
}
.content-outer {
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .15);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .15);
-goog-ms-box-shadow: 0 0 0 #333333;
box-shadow: 0 0 0 rgba(0, 0, 0, .15);
margin-bottom: 1px;
}
.content-inner {
padding: 10px 40px;
}
.content-inner {
background-color: #ffffff;
}
/* Header
----------------------------------------------- */
.header-outer {
background: transparent none repeat-x scroll 0 -400px;
_background-image: none;
}
.Header h1 {
font: normal normal 40px 'Trebuchet MS',Trebuchet,Verdana,sans-serif;
color: #000000;
text-shadow: 0 0 0 rgba(0, 0, 0, .2);
}
.Header h1 a {
color: #000000;
}
.Header .description {
font-size: 18px;
color: #000000;
}
.header-inner .Header .titlewrapper {
padding: 22px 0;
}
.header-inner .Header .descriptionwrapper {
padding: 0 0;
}
/* Tabs
----------------------------------------------- */
.tabs-inner .section:first-child {
border-top: 0 solid #dddddd;
}
.tabs-inner .section:first-child ul {
margin-top: -1px;
border-top: 1px solid #dddddd;
border-left: 1px solid #dddddd;
border-right: 1px solid #dddddd;
}
.tabs-inner .widget ul {
background: transparent none repeat-x scroll 0 -800px;
_background-image: none;
border-bottom: 1px solid #dddddd;
margin-top: 0;
margin-left: -30px;
margin-right: -30px;
}
.tabs-inner .widget li a {
display: inline-block;
padding: .6em 1em;
font: normal normal 12px 'Trebuchet MS', Trebuchet, Verdana, sans-serif;
color: #000000;
border-left: 1px solid #ffffff;
border-right: 1px solid #dddddd;
}
.tabs-inner .widget li:first-child a {
border-left: none;
}
.tabs-inner .widget li.selected a, .tabs-inner .widget li a:hover {
color: #000000;
background-color: #eeeeee;
text-decoration: none;
}
/* Columns
----------------------------------------------- */
.main-outer {
border-top: 0 solid transparent;
}
.fauxcolumn-left-outer .fauxcolumn-inner {
border-right: 1px solid transparent;
}
.fauxcolumn-right-outer .fauxcolumn-inner {
border-left: 1px solid transparent;
}
/* Headings
----------------------------------------------- */
div.widget > h2,
div.widget h2.title {
margin: 0 0 1em 0;
font: normal bold 11px 'Trebuchet MS',Trebuchet,Verdana,sans-serif;
color: #000000;
}
/* Widgets
----------------------------------------------- */
.widget .zippy {
color: #999999;
text-shadow: 2px 2px 1px rgba(0, 0, 0, .1);
}
.widget .popular-posts ul {
list-style: none;
}
/* Posts
----------------------------------------------- */
h2.date-header {
font: normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
}
.date-header span {
background-color: #bbbbbb;
color: #ffffff;
padding: 0.4em;
letter-spacing: 3px;
margin: inherit;
}
.main-inner {
padding-top: 35px;
padding-bottom: 65px;
}
.main-inner .column-center-inner {
padding: 0 0;
}
.main-inner .column-center-inner .section {
margin: 0 1em;
}
.post {
margin: 0 0 45px 0;
}
h3.post-title, .comments h4 {
font: normal normal 22px 'Trebuchet MS',Trebuchet,Verdana,sans-serif;
margin: .75em 0 0;
}
.post-body {
font-size: 110%;
line-height: 1.4;
position: relative;
}
.post-body img, .post-body .tr-caption-container, .Profile img, .Image img,
.BlogList .item-thumbnail img {
padding: 2px;
background: #ffffff;
border: 1px solid #eeeeee;
-moz-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
-webkit-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
}
.post-body img, .post-body .tr-caption-container {
padding: 5px;
}
.post-body .tr-caption-container {
color: #666666;
}
.post-body .tr-caption-container img {
padding: 0;
background: transparent;
border: none;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
box-shadow: 0 0 0 rgba(0, 0, 0, .1);
}
.post-header {
margin: 0 0 1.5em;
line-height: 1.6;
font-size: 90%;
}
.post-footer {
margin: 20px -2px 0;
padding: 5px 10px;
color: #666666;
background-color: #eeeeee;
border-bottom: 1px solid #eeeeee;
line-height: 1.6;
font-size: 90%;
}
#comments .comment-author {
padding-top: 1.5em;
border-top: 1px solid transparent;
background-position: 0 1.5em;
}
#comments .comment-author:first-child {
padding-top: 0;
border-top: none;
}
.avatar-image-container {
margin: .2em 0 0;
}
#comments .avatar-image-container img {
border: 1px solid #eeeeee;
}
/* Comments
----------------------------------------------- */
.comments .comments-content .icon.blog-author {
background-repeat: no-repeat;
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB9sLFwMeCjjhcOMAAAD+SURBVDjLtZSvTgNBEIe/WRRnm3U8RC1neQdsm1zSBIU9VVF1FkUguQQsD9ITmD7ECZIJSE4OZo9stoVjC/zc7ky+zH9hXwVwDpTAWWLrgS3QAe8AZgaAJI5zYAmc8r0G4AHYHQKVwII8PZrZFsBFkeRCABYiMh9BRUhnSkPTNCtVXYXURi1FpBDgArj8QU1eVXUzfnjv7yP7kwu1mYrkWlU33vs1QNu2qU8pwN0UpKoqokjWwCztrMuBhEhmh8bD5UDqur75asbcX0BGUB9/HAMB+r32hznJgXy2v0sGLBcyAJ1EK3LFcbo1s91JeLwAbwGYu7TP/3ZGfnXYPgAVNngtqatUNgAAAABJRU5ErkJggg==);
}
.comments .comments-content .loadmore a {
border-top: 1px solid #999999;
border-bottom: 1px solid #999999;
}
.comments .comment-thread.inline-thread {
background-color: #eeeeee;
}
.comments .continue {
border-top: 2px solid #999999;
}
/* Accents
---------------------------------------------- */
.section-columns td.columns-cell {
border-left: 1px solid transparent;
}
.blog-pager {
background: transparent url(https://resources.blogblog.com/blogblog/data/1kt/simple/paging_dot.png) repeat-x scroll top center;
}
.blog-pager-older-link, .home-link,
.blog-pager-newer-link {
background-color: #ffffff;
padding: 5px;
}
.footer-outer {
border-top: 1px dashed #bbbbbb;
}
/* Mobile
----------------------------------------------- */
body.mobile  {
background-size: auto;
}
.mobile .body-fauxcolumn-outer {
background: transparent none repeat scroll top left;
}
.mobile .body-fauxcolumn-outer .cap-top {
background-size: 100% auto;
}
.mobile .content-outer {
-webkit-box-shadow: 0 0 3px rgba(0, 0, 0, .15);
box-shadow: 0 0 3px rgba(0, 0, 0, .15);
}
.mobile .tabs-inner .widget ul {
margin-left: 0;
margin-right: 0;
}
.mobile .post {
margin: 0;
}
.mobile .main-inner .column-center-inner .section {
margin: 0;
}
.mobile .date-header span {
padding: 0.1em 10px;
margin: 0 -10px;
}
.mobile h3.post-title {
margin: 0;
}
.mobile .blog-pager {
background: transparent none no-repeat scroll top center;
}
.mobile .footer-outer {
border-top: none;
}
.mobile .main-inner, .mobile .footer-inner {
background-color: #ffffff;
}
.mobile-index-contents {
color: #666666;
}
.mobile-link-button {
background-color: #2288bb;
}
.mobile-link-button a:link, .mobile-link-button a:visited {
color: #ffffff;
}
.mobile .tabs-inner .section:first-child {
border-top: none;
}
.mobile .tabs-inner .PageList .widget-content {
background-color: #eeeeee;
color: #000000;
border-top: 1px solid #dddddd;
border-bottom: 1px solid #dddddd;
}
.mobile .tabs-inner .PageList .widget-content .pagelist-arrow {
border-left: 1px solid #dddddd;
}

--></style>
<style id="template-skin-1" type="text/css"><!--
body {
min-width: 1045px;
}
.content-outer, .content-fauxcolumn-outer, .region-inner {
min-width: 1045px;
max-width: 1045px;
_width: 1045px;
}
.main-inner .columns {
padding-left: 0px;
padding-right: 238px;
}
.main-inner .fauxcolumn-center-outer {
left: 0px;
right: 238px;
/* IE6 does not respect left and right together */
_width: expression(this.parentNode.offsetWidth -
parseInt("0px") -
parseInt("238px") + 'px');
}
.main-inner .fauxcolumn-left-outer {
width: 0px;
}
.main-inner .fauxcolumn-right-outer {
width: 238px;
}
.main-inner .column-left-outer {
width: 0px;
right: 100%;
margin-left: -0px;
}
.main-inner .column-right-outer {
width: 238px;
margin-right: -238px;
}
#layout {
min-width: 0;
}
#layout .content-outer {
min-width: 0;
width: 800px;
}
#layout .region-inner {
min-width: 0;
width: auto;
}
body#layout div.add_widget {
padding: 8px;
}
body#layout div.add_widget a {
margin-left: 32px;
}
--></style>
<link href="https://www.blogger.com/dyn-css/authorization.css?targetBlogID=2165778380262691600&amp;zx=fba63757-ec09-4d9e-a862-e481a213df22" media="all" onload="if(media!='all')media='all'" rel="stylesheet"><noscript><link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=2165778380262691600&amp;zx=fba63757-ec09-4d9e-a862-e481a213df22' rel='stylesheet'/></noscript>
<meta name="google-adsense-platform-account" content="ca-host-pub-1556223355139109">
<meta name="google-adsense-platform-domain" content="blogspot.com">

<script type="text/javascript" language="javascript">
  // Supply ads personalization default for EEA readers
  // See https://www.blogger.com/go/adspersonalization
  adsbygoogle = window.adsbygoogle || [];
  if (typeof adsbygoogle.requestNonPersonalizedAds === 'undefined') {
    adsbygoogle.requestNonPersonalizedAds = 1;
  }
</script>


<style class="singleton-element" type="text/css">.cookie-choices-info { position:fixed;width:100%;background-color:#666;margin:0;left:0;top:0;padding:0;z-index:4000;text-align:center;color:#fff;line-height:140%;padding:10px 0;font-family:roboto,Arial; } .cookie-choices-info .cookie-choices-inner { position:relative;width:initial;margin:0;left:0;top:0; } .cookie-choices-info .cookie-choices-text { display:inline-block;vertical-align:middle;font-size:16px;margin:10px 20px;color:#ccc;max-width:800px;text-align:left; }.cookie-choices-info .cookie-choices-buttons { display:inline-block;vertical-align:middle;white-space:nowrap;margin:0 10px; } .cookie-choices-info .cookie-choices-button:hover {  color: #fff; } .cookie-choices-info .cookie-choices-button { font-weight:bold;text-transform:UPPERCASE;white-space:nowrap;color:#eee;margin-left:8px;padding:0 6px; text-decoration:none; }</style></head>
<body class=" variant-simplysimple">
<div class="navbar no-items section" id="navbar" name="Navbar">
</div>
<div class="body-fauxcolumns">
<div class="fauxcolumn-outer body-fauxcolumn-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</div>
<div class="content">
<div class="content-fauxcolumns">
<div class="fauxcolumn-outer content-fauxcolumn-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</div>
<div class="content-outer">
<div class="content-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left content-fauxborder-left">
<div class="fauxborder-right content-fauxborder-right"></div>
<div class="content-inner">
<header>
<div class="header-outer">
<div class="header-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left header-fauxborder-left">
<div class="fauxborder-right header-fauxborder-right"></div>
<div class="region-inner header-inner">
<div class="header section" id="header" name="Header"><div class="widget Header" data-version="1" id="Header1">
<div id="header-inner">
<div class="titlewrapper">
<h1 class="title">
<a href="https://labs.ioactive.com/">
IOActive Labs
</a>
</h1>
</div>
<div class="descriptionwrapper">
<p class="description"><span>
</span></p>
</div>
</div>
</div></div>
</div>
</div>
<div class="header-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</header>
<div class="tabs-outer">
<div class="tabs-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left tabs-fauxborder-left">
<div class="fauxborder-right tabs-fauxborder-right"></div>
<div class="region-inner tabs-inner">
<div class="tabs no-items section" id="crosscol" name="Cross-Column"></div>
<div class="tabs no-items section" id="crosscol-overflow" name="Cross-Column 2"></div>
</div>
</div>
<div class="tabs-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<div class="main-outer">
<div class="main-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left main-fauxborder-left">
<div class="fauxborder-right main-fauxborder-right"></div>
<div class="region-inner main-inner">
<div class="columns fauxcolumns">
<div class="fauxcolumn-outer fauxcolumn-center-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<div class="fauxcolumn-outer fauxcolumn-left-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<div class="fauxcolumn-outer fauxcolumn-right-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<!-- corrects IE6 width calculation -->
<div class="columns-inner">
<div class="column-center-outer">
<div class="column-center-inner">
<div class="main section" id="main" name="Main"><div class="widget Blog" data-version="1" id="Blog1">
<div class="blog-posts hfeed">

          <div class="date-outer">
        
<h2 class="date-header"><span>Friday, July 30, 2021</span></h2>

          <div class="date-posts">
        
<div class="post-outer">
<div class="post hentry uncustomized-post-template" itemprop="blogPost" itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
<meta content="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh9E3nAC5KM9vLWMim3MUzvjPQ1BegmKO8UwDRTyxe8K8pnGGEYlyxPBlwpK3HPmbl67Vpt6ASLsjFVhoWR6SxrsOlu-9J-S47rRPCKknFyGyBfezttxAjP3f-Tul2Q4gZnjvN-9xejeqc/w617-h73/RegisterService_xrefs.png" itemprop="image_url">
<meta content="2165778380262691600" itemprop="blogId">
<meta content="4469446424408015238" itemprop="postId">
<a name="4469446424408015238"></a>
<h3 class="post-title entry-title" itemprop="name">
Breaking Protocol (Buffers): Reverse Engineering gRPC Binaries
</h3>
<div class="post-header">
<div class="post-header-line-1"></div>
</div>
<div class="post-body entry-content" id="post-body-4469446424408015238" itemprop="description articleBody">
<h4 style="line-height: 16px; margin-bottom: 0in;"><span style="font-family: inherit;"><span style="font-size: small;"><span style="font-weight: normal;">by Ethan Shackelford</span></span></span></h4><h2 style="text-align: left;"><p></p><p><b>The Basics
</b></p></h2><p data-sourcepos="24:1-24:586" style="text-align: left;">gRPC is an open-source RPC 
framework from Google which leverages automatic code generation to allow
 easy integration to a number of languages. Architecturally, it follows 
the standard seen in many other RPC frameworks: services are defined 
which determine the available RPCs. It uses HTTP version 2 as its 
transport, and supports plain HTTP as well as HTTPS for secure 
communication. Services and messages, which act as the structures passed
 to and returned by defined RPCs, are defined as protocol buffers. 
Protocol buffers are a common serialization solution, also designed by 
Google.</p>
<h3 data-sourcepos="26:1-26:20" style="text-align: left;">
Protocol Buffers</h3>
<p data-sourcepos="27:1-27:290" style="text-align: left;">Serialization using protobufs is accomplished by definining <b>services</b> and <b>messages</b> in .proto files, which are then used by the <code>protoc</code>
 protocol buffer compiler to generate boilerplate code in whatever 
language you're working in. An example .proto file might look like the 
following:</p>
<pre class="code highlight js-syntax-highlight language-protobuf white" lang="protobuf" style="text-align: left;"><code><span class="line" id="LC1" lang="protobuf"><span class="c1">// Declares which syntax version is to follow; read by protoc</span></span>
<span class="line" id="LC2" lang="protobuf"><span class="na">syntax</span> <span class="o">=</span> <span class="s">"proto3"</span><span class="p">;</span></span>
<span class="line" id="LC3" lang="protobuf"></span>
<span class="line" id="LC4" lang="protobuf"><span class="c1">// package name allows for namespacing to avoid conflicts</span></span>
<span class="line" id="LC5" lang="protobuf"><span class="c1">// between message types. Will also determine namespace in C++</span></span>
<span class="line" id="LC6" lang="protobuf"><span class="kn">package</span> <span class="nn">stringmanipulation</span><span class="p">;</span></span>
<span class="line" id="LC7" lang="protobuf"></span>
<span class="line" id="LC8" lang="protobuf"></span>
<span class="line" id="LC9" lang="protobuf"><span class="c1">// The Service definition: this specifies what RPCs are offered</span></span>
<span class="line" id="LC10" lang="protobuf"><span class="c1">// by the service</span></span>
<span class="line" id="LC11" lang="protobuf"><span class="kd">service</span> <span class="n">StringManipulation</span> <span class="p">{</span></span>
<span class="line" id="LC12" lang="protobuf"></span>
<span class="line" id="LC13" lang="protobuf">    <span class="c1">// First RPC. RPC definitions are like function prototypes:</span></span>
<span class="line" id="LC14" lang="protobuf">    <span class="c1">// RPC name, argument types, and return type is specified.</span></span>
<span class="line" id="LC15" lang="protobuf">    <span class="k">rpc</span> <span class="n">reverseString</span> <span class="p">(</span><span class="n">StringRequest</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">StringReply</span><span class="p">)</span> <span class="p">{}</span></span>
<span class="line" id="LC16" lang="protobuf"></span>
<span class="line" id="LC17" lang="protobuf">    <span class="c1">// Second RPC. There can be arbitrarily many defined for</span></span>
<span class="line" id="LC18" lang="protobuf">    <span class="c1">// a service.</span></span>
<span class="line" id="LC19" lang="protobuf">    <span class="k">rpc</span> <span class="n">uppercaseString</span> <span class="p">(</span><span class="n">StringRequest</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">StringReply</span><span class="p">)</span> <span class="p">{}</span></span>
<span class="line" id="LC20" lang="protobuf"><span class="p">}</span></span>
<span class="line" id="LC21" lang="protobuf"></span>
<span class="line" id="LC22" lang="protobuf"><span class="c1">// Example of a message definition, containing only scalar values.</span></span>
<span class="line" id="LC23" lang="protobuf"><span class="c1">// Each message field has a defined type, a name, and a field number.</span></span>
<span class="line" id="LC24" lang="protobuf"><span class="kd">message</span> <span class="nc">innerMessage</span> <span class="p">{</span></span>
<span class="line" id="LC25" lang="protobuf">    <span class="kt">int32</span> <span class="na">some_val</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span></span>
<span class="line" id="LC26" lang="protobuf">    <span class="kt">string</span> <span class="na">some_string</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span></span>
<span class="line" id="LC27" lang="protobuf"><span class="p">}</span></span>
<span class="line" id="LC28" lang="protobuf"></span>
<span class="line" id="LC29" lang="protobuf"><span class="c1">// It is also possible to specify an enum type. This can</span></span>
<span class="line" id="LC30" lang="protobuf"><span class="c1">// be used as a member of other messages.</span></span>
<span class="line" id="LC31" lang="protobuf"><span class="kd">enum</span> <span class="n">testEnumeration</span> <span class="p">{</span></span>
<span class="line" id="LC32" lang="protobuf">    <span class="na">ZERO</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span></span>
<span class="line" id="LC33" lang="protobuf">    <span class="na">ONE</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span></span>
<span class="line" id="LC34" lang="protobuf">    <span class="na">TWO</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span></span>
<span class="line" id="LC35" lang="protobuf">    <span class="na">THREE</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span></span>
<span class="line" id="LC36" lang="protobuf">    <span class="na">FOUR</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span></span>
<span class="line" id="LC37" lang="protobuf">    <span class="na">FIVE</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span></span>
<span class="line" id="LC38" lang="protobuf"><span class="p">}</span></span>
<span class="line" id="LC39" lang="protobuf"></span>
<span class="line" id="LC40" lang="protobuf"><span class="c1">// messages can contain other messages as field types.</span></span>
<span class="line" id="LC41" lang="protobuf"><span class="kd">message</span> <span class="nc">complexMessage</span> <span class="p">{</span></span>
<span class="line" id="LC42" lang="protobuf">    <span class="n">innerMessage</span> <span class="na">some_message</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span></span>
<span class="line" id="LC43" lang="protobuf">    <span class="n">testEnumeration</span> <span class="na">innerEnum</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span></span>
<span class="line" id="LC44" lang="protobuf"><span class="p">}</span></span>
<span class="line" id="LC45" lang="protobuf"></span>
<span class="line" id="LC46" lang="protobuf"><span class="c1">// This message is the type used as the input to both defined RPCs.</span></span>
<span class="line" id="LC47" lang="protobuf"><span class="c1">// Messages can be arbitrarily nested, and contain arbitrarily complex types.</span></span>
<span class="line" id="LC48" lang="protobuf"><span class="kd">message</span> <span class="nc">StringRequest</span> <span class="p">{</span></span>
<span class="line" id="LC49" lang="protobuf">    <span class="n">complexMessage</span> <span class="na">cm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span></span>
<span class="line" id="LC50" lang="protobuf">    <span class="kt">string</span> <span class="na">original</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span></span>
<span class="line" id="LC51" lang="protobuf">    <span class="kt">int64</span> <span class="na">timestamp</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span></span>
<span class="line" id="LC52" lang="protobuf">    <span class="kt">int32</span> <span class="na">testval</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span></span>
<span class="line" id="LC53" lang="protobuf">    <span class="kt">int32</span> <span class="na">testval2</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span></span>
<span class="line" id="LC54" lang="protobuf">    <span class="kt">int32</span> <span class="na">testval3</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span></span>
<span class="line" id="LC55" lang="protobuf"><span class="p">}</span></span>
<span class="line" id="LC56" lang="protobuf"></span>
<span class="line" id="LC57" lang="protobuf"><span class="c1">// This message is the type for the return value of both defined RPCs.</span></span>
<span class="line" id="LC58" lang="protobuf"><span class="kd">message</span> <span class="nc">StringReply</span> <span class="p">{</span></span>
<span class="line" id="LC59" lang="protobuf">    <span class="kt">string</span> <span class="na">result</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span></span>
<span class="line" id="LC60" lang="protobuf">    <span class="kt">int64</span> <span class="na">timestamp</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span></span>
<span class="line" id="LC61" lang="protobuf">    <span class="n">complexMessage</span> <span class="na">cm</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span></span>
<span class="line" id="LC62" lang="protobuf"><span class="p">}</span></span>
<span class="line" id="LC63" lang="protobuf"></span></code></pre>
<p data-sourcepos="95:1-95:189" style="text-align: left;">There is a lot more to protocol buffers and the available options, if you're interested Google has a very good <a href="https://developers.google.com/protocol-buffers/docs/proto3" rel="nofollow noreferrer noopener" target="_blank">language guide</a>.</p>
<h3 data-sourcepos="97:1-97:8" style="text-align: left;">
gRPC</h3>
<p data-sourcepos="98:1-98:553" style="text-align: left;">gRPC is an RPC implementation
 designed to use protobufs to take care of all boilerplating necessary 
for implementation, as well as provided functions to manage the 
connection between the RPC server and its clients. The majority of 
compiled code in a gRPC server binary will likely be either gRPC library
 code and autogenerated classes, stubs etc. created with protoc. Only 
the actual implementation of RPCs is required of the developer and 
accomplished by extending the base <code>Service</code> class generated by protoc based on the definitions in .proto files..</p>
<h4 data-sourcepos="100:1-100:14" style="text-align: left;">
Transport</h4>
<p data-sourcepos="101:1-101:232" style="text-align: left;">gRPC uses HTTP2 for 
transport, which can either be on top of a TLS connection, or in the 
clear. gRPC also supports mTLS out of the box. What type of channel is 
used is configured by the developer while setting up the server/client.</p>
<h4 data-sourcepos="103:1-103:19" style="text-align: left;">
Authentication</h4>
<p data-sourcepos="104:1-104:471" style="text-align: left;">As mentioned above, gRPC support mTLS, wherein both the server <i>and the client</i>
 are identified based on exchanged TLS certificates. This appears to be 
the most common authentication mechanism seen in the wild (though "no 
authentication" is also popular). gRPC also supports Google's weird <a href="https://cloud.google.com/security/encryption-in-transit/application-layer-transport-security" rel="nofollow noreferrer noopener" target="_blank">ALTS</a> which I've never seen actually being used, as well as token-based authentication.</p>
<p data-sourcepos="106:1-106:318" style="text-align: left;">It is also possible that 
the built-in authentication mechanisms will be eschewed for a custom 
authentication mechanism. Such a custom implementation is of particular 
interest from a security perspective, as the need for a custom mechanism
 suggests a more complex (and thus more error prone) authentication 
requirement.</p>
<h4 data-sourcepos="108:1-108:31" style="text-align: left;">
gRPC Server Implementation</h4>
<p data-sourcepos="109:1-109:502" style="text-align: left;">The following will be an 
overview of the major parts of a gRPC server implementation in C++. A 
compiled gRPC server binary can be extremely difficult to follow, thanks
 to the extensive automatically generated code and heavy use of gRPC 
library functions. Understanding the rough structure that any such 
server will follow (important function calls and their arguments) will 
greatly improve your ability to make sense of things and identify 
relevant sections of code which may present an attack surface.</p>
<h5 data-sourcepos="111:1-111:18" style="text-align: left;">
Server Setup</h5>
<p data-sourcepos="112:1-112:203" style="text-align: left;">The following is the setup 
boilerplate for a simple gRPC server. While a real implementation will 
likely be more complex, the function calls seen here will be the ones to
 look for in unraveling the code.</p>
<pre class="code highlight js-syntax-highlight language-cpp white" lang="cpp" style="text-align: left;"><code><span class="line" id="LC1" lang="cpp"><span class="kt">void</span> <span class="nf">RunServer</span><span class="p">()</span> <span class="p">{</span></span>
<span class="line" id="LC2" lang="cpp">    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">listen</span> <span class="o">=</span> <span class="s">"127.0.0.1:50006"</span><span class="p">;</span></span>
<span class="line" id="LC3" lang="cpp">    <span class="c1">// This is the class defined to implement RPCs, will be covered later</span></span>
<span class="line" id="LC4" lang="cpp">    <span class="n">StringManipulationImpl</span> <span class="n">service</span><span class="p">;</span></span>
<span class="line" id="LC5" lang="cpp"></span>
<span class="line" id="LC6" lang="cpp">    <span class="n">ServerBuilder</span> <span class="n">builder</span><span class="p">;</span></span>
<span class="line" id="LC7" lang="cpp"></span>
<span class="line" id="LC8" lang="cpp">    <span class="n">builder</span><span class="p">.</span><span class="n">AddListeningPort</span><span class="p">(</span><span class="n">listen</span><span class="p">,</span> <span class="n">grpc</span><span class="o">::</span><span class="n">InsecureServerCredentials</span><span class="p">());</span></span>
<span class="line" id="LC9" lang="cpp">    <span class="n">builder</span><span class="p">.</span><span class="n">RegisterService</span><span class="p">(</span><span class="o">&amp;</span><span class="n">service</span><span class="p">);</span></span>
<span class="line" id="LC10" lang="cpp"></span>
<span class="line" id="LC11" lang="cpp">    <span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">grpc</span><span class="o">::</span><span class="n">Server</span><span class="o">&gt;</span> <span class="n">server</span><span class="p">(</span><span class="n">builder</span><span class="p">.</span><span class="n">BuildAndStart</span><span class="p">());</span></span>
<span class="line" id="LC12" lang="cpp">    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Server listening on port: "</span> <span class="o">&lt;&lt;</span> <span class="n">listen</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span></span>
<span class="line" id="LC13" lang="cpp">    <span class="n">server</span><span class="o">-&gt;</span><span class="n">Wait</span><span class="p">();</span></span>
<span class="line" id="LC14" lang="cpp"><span class="p">}</span></span></code></pre>
<ul data-sourcepos="131:1-137:0" style="text-align: left;"><li data-sourcepos="131:1-135:658">
<code>builder.AddListeningPort</code>: This function sets up the listening socket as well as handling the transport setup for the channel.
<ul data-sourcepos="132:5-135:658"><li data-sourcepos="132:5-132:127">arg1: <code>addr_uri</code>: a string composed of the IP address and port to listen on, separated by a colon. i.e. "127.0.0.1:50001"</li><li data-sourcepos="133:5-135:658">arg2: <code>creds</code>: The 
credentials associated with the server. The function call used here to 
generate credentials will indicate what kind of transport is being used,
 as follows:
<ul data-sourcepos="134:9-135:658"><li data-sourcepos="134:9-134:65">
<code>InsecureServerCredentials</code>: No encryption; plain HTTP2</li><li data-sourcepos="135:9-135:658">
<code>SslServerCredentials</code>: TLS is in use, meaning the client can
 verify the server and communication will be encrypted. If client 
authentication (mTLS) is to be used, relevant options will be passed to 
this function call. For example, setting <code>opts.client_certificate_request</code> to <code>GRPC_SSL_REQUEST_AND_REQUIRE_CLIENT_CERTIFICATE_AND_VERIFY</code>
 will require the client supply a valid certificate. Any potential 
vulnerabilities at this point will be in the options passed to the 
SslServerCredentials constructor, and will be familiar to any 
consultant. Do they verify the client certificate? Are self-signed 
certificates allowed? etc., standard TLS issues.</li></ul>
</li></ul>
</li><li data-sourcepos="136:1-137:0">
<code>builder.RegisterService</code>: This crucial function is what 
determines what services (and thereby what RPC calls) are available to a
 connecting client. This function is called as many times as there are 
services. The argument to the function is an instance of the class which
 actually implements the logic for each of the RPCs -- custom code. This
 is the main point of interest for any gRPC server code review or static
 analysis, as it will contain the clients own implementation, where the 
likelihood of mistakes and errors will be higher.</li></ul>
<h5 data-sourcepos="138:1-138:24" style="text-align: left;">
RPC Implementation</h5>
<p data-sourcepos="139:1-139:111" style="text-align: left;">The following is the implementation of the <code>StringManipulationImpl</code> instance passed to <code>RegisterService</code> above.</p>
<pre class="code highlight js-syntax-highlight language-cpp white" lang="cpp" style="text-align: left;"><code><span class="line" id="LC1" lang="cpp"><span class="k">class</span> <span class="nc">StringManipulationImpl</span> <span class="o">:</span> <span class="k">public</span> <span class="n">stringmanipulation</span><span class="o">::</span><span class="n">StringManipulation</span><span class="o">::</span><span class="n">Service</span> <span class="p">{</span></span>
<span class="line" id="LC2" lang="cpp">    <span class="n">Status</span> <span class="n">reverseString</span><span class="p">(</span><span class="n">ServerContext</span> <span class="o">*</span><span class="n">context</span><span class="p">,</span> </span>
<span class="line" id="LC3" lang="cpp">                         <span class="k">const</span> <span class="n">StringRequest</span> <span class="o">*</span><span class="n">request</span><span class="p">,</span> </span>
<span class="line" id="LC4" lang="cpp">                         <span class="n">StringReply</span> <span class="o">*</span><span class="n">reply</span><span class="p">)</span> <span class="p">{</span></span>
<span class="line" id="LC5" lang="cpp"></span>
<span class="line" id="LC6" lang="cpp"></span>
<span class="line" id="LC7" lang="cpp">        <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">original</span> <span class="o">=</span> <span class="n">request</span><span class="o">-&gt;</span><span class="n">original</span><span class="p">();</span></span>
<span class="line" id="LC8" lang="cpp">        <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">working_copy</span> <span class="o">=</span> <span class="n">original</span><span class="p">;</span></span>
<span class="line" id="LC9" lang="cpp">        <span class="n">std</span><span class="o">::</span><span class="n">reverse</span><span class="p">(</span><span class="n">working_copy</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">working_copy</span><span class="p">.</span><span class="n">end</span><span class="p">());</span></span>
<span class="line" id="LC10" lang="cpp">        <span class="n">reply</span><span class="o">-&gt;</span><span class="n">set_result</span><span class="p">(</span><span class="n">working_copy</span><span class="p">);</span></span>
<span class="line" id="LC11" lang="cpp"></span>
<span class="line" id="LC12" lang="cpp">        <span class="k">struct</span> <span class="nc">timeval</span> <span class="n">tv</span><span class="p">;</span></span>
<span class="line" id="LC13" lang="cpp">        <span class="n">gettimeofday</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tv</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span></span>
<span class="line" id="LC14" lang="cpp"></span>
<span class="line" id="LC15" lang="cpp">        <span class="n">printf</span><span class="p">(</span><span class="s">"[%ld|%s] reverseString(</span><span class="se">\"</span><span class="s">%s</span><span class="se">\"</span><span class="s">) -&gt; </span><span class="se">\"</span><span class="s">%s</span><span class="se">\"\n</span><span class="s">"</span><span class="p">,</span> </span>
<span class="line" id="LC16" lang="cpp">                <span class="n">tv</span><span class="p">.</span><span class="n">tv_sec</span><span class="p">,</span> </span>
<span class="line" id="LC17" lang="cpp">                <span class="n">context</span><span class="o">-&gt;</span><span class="n">peer</span><span class="p">().</span><span class="n">c_str</span><span class="p">(),</span> </span>
<span class="line" id="LC18" lang="cpp">                <span class="n">request</span><span class="o">-&gt;</span><span class="n">original</span><span class="p">().</span><span class="n">c_str</span><span class="p">(),</span> </span>
<span class="line" id="LC19" lang="cpp">                <span class="n">working_copy</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span></span>
<span class="line" id="LC20" lang="cpp"></span>
<span class="line" id="LC21" lang="cpp">        <span class="k">return</span> <span class="n">Status</span><span class="o">::</span><span class="n">OK</span><span class="p">;</span></span>
<span class="line" id="LC22" lang="cpp">    <span class="p">}</span></span>
<span class="line" id="LC23" lang="cpp"></span>
<span class="line" id="LC24" lang="cpp">    <span class="n">Status</span> <span class="n">uppercaseString</span><span class="p">(</span><span class="n">ServerContext</span> <span class="o">*</span><span class="n">context</span><span class="p">,</span> </span>
<span class="line" id="LC25" lang="cpp">                           <span class="k">const</span> <span class="n">StringRequest</span> <span class="o">*</span><span class="n">request</span><span class="p">,</span> </span>
<span class="line" id="LC26" lang="cpp">                           <span class="n">StringReply</span> <span class="o">*</span><span class="n">reply</span><span class="p">)</span> <span class="p">{</span></span>
<span class="line" id="LC27" lang="cpp"></span>
<span class="line" id="LC28" lang="cpp">        <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">working_copy</span> <span class="o">=</span> <span class="n">request</span><span class="o">-&gt;</span><span class="n">original</span><span class="p">();</span></span>
<span class="line" id="LC29" lang="cpp">        <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="o">&amp;</span><span class="n">c</span><span class="o">:</span> <span class="n">working_copy</span><span class="p">)</span> <span class="n">c</span> <span class="o">=</span> <span class="n">toupper</span><span class="p">(</span><span class="n">c</span><span class="p">);</span></span>
<span class="line" id="LC30" lang="cpp">        <span class="n">reply</span><span class="o">-&gt;</span><span class="n">set_result</span><span class="p">(</span><span class="n">working_copy</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span></span>
<span class="line" id="LC31" lang="cpp"></span>
<span class="line" id="LC32" lang="cpp">        <span class="k">struct</span> <span class="nc">timeval</span> <span class="n">tv</span><span class="p">;</span></span>
<span class="line" id="LC33" lang="cpp">        <span class="n">gettimeofday</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tv</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span></span>
<span class="line" id="LC34" lang="cpp"></span>
<span class="line" id="LC35" lang="cpp">        <span class="n">printf</span><span class="p">(</span><span class="s">"[%ld|%s] uppercaseString(</span><span class="se">\"</span><span class="s">%s</span><span class="se">\"</span><span class="s">) -&gt; </span><span class="se">\"</span><span class="s">%s</span><span class="se">\"\n</span><span class="s">"</span><span class="p">,</span> </span>
<span class="line" id="LC36" lang="cpp">                <span class="n">tv</span><span class="p">.</span><span class="n">tv_sec</span><span class="p">,</span> </span>
<span class="line" id="LC37" lang="cpp">                <span class="n">context</span><span class="o">-&gt;</span><span class="n">peer</span><span class="p">().</span><span class="n">c_str</span><span class="p">(),</span> </span>
<span class="line" id="LC38" lang="cpp">                <span class="n">request</span><span class="o">-&gt;</span><span class="n">original</span><span class="p">().</span><span class="n">c_str</span><span class="p">(),</span> </span>
<span class="line" id="LC39" lang="cpp">                <span class="n">working_copy</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span></span>
<span class="line" id="LC40" lang="cpp"></span>
<span class="line" id="LC41" lang="cpp">        <span class="k">return</span> <span class="n">Status</span><span class="o">::</span><span class="n">OK</span><span class="p">;</span></span>
<span class="line" id="LC42" lang="cpp"></span>
<span class="line" id="LC43" lang="cpp">    <span class="p">}</span></span>
<span class="line" id="LC44" lang="cpp"><span class="p">};</span></span></code></pre>
<p data-sourcepos="187:1-187:335" style="text-align: left;">Here we see the 
implementation for each of the two defined RPCs for the 
StringManipulation service. This is accomplished by extending the base 
service class generated by protoc. gRPC implementation code like this 
will often follow this naming scheme, or something like it -- the 
service name, appended by "Impl," "Implementation," etc.</p>
<h2 data-sourcepos="189:1-189:18" style="text-align: left;">
Static Analysis</h2>
<h3 data-sourcepos="190:1-190:29" style="text-align: left;">
Finding Interesting Logic</h3>
<p data-sourcepos="191:1-191:365" style="text-align: left;">These functions, generally,
 are among the most interesting targets in any test of a gRPC service. 
The bulk of the logic baked into a gRPC binary will be library code, and
 these functions which will actually be parsing and handling the data 
transmitted via the gRPC link. These functions can be 
located/categorized by looking for calls to <code>builder.RegisterService</code>.</p><p data-sourcepos="191:1-191:365" style="text-align: left;"></p><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh9E3nAC5KM9vLWMim3MUzvjPQ1BegmKO8UwDRTyxe8K8pnGGEYlyxPBlwpK3HPmbl67Vpt6ASLsjFVhoWR6SxrsOlu-9J-S47rRPCKknFyGyBfezttxAjP3f-Tul2Q4gZnjvN-9xejeqc/s1695/RegisterService_xrefs.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="201" data-original-width="1695" height="73" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh9E3nAC5KM9vLWMim3MUzvjPQ1BegmKO8UwDRTyxe8K8pnGGEYlyxPBlwpK3HPmbl67Vpt6ASLsjFVhoWR6SxrsOlu-9J-S47rRPCKknFyGyBfezttxAjP3f-Tul2Q4gZnjvN-9xejeqc/w617-h73/RegisterService_xrefs.png" width="617"></a></div>&nbsp;<p></p><p data-sourcepos="191:1-191:365" style="text-align: left;">Here we see just one call, 
because the example is simple, but in a more complex implementation 
there may be many calls to this function. Each one represents a 
particular service being made available, and will allow for the tracking
 down of the implementations of each RPC for those services. Navigating 
to the cross reference address, we see that an object is being passed to
 this function. Keep in mind this binary has been pre-annotated for 
clarity and the initial output of the reverse engineering tool will 
likely be less clear. However the function calls we care about should be
 clear enough to follow without much effort.&nbsp;</p><p data-sourcepos="197:1-197:68" style="text-align: left;"></p><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEissmkdfn6rkm26KW3eejaxyiveFWloZ2Nrrt2ItC5tX5xrXLCQRUCTiyGsXkR8UgCw8IUzY34Pw3jJDNd03FznbB3pe6u114GkaeadwRTPUog4SMxwX6A3c0T51bZU6SJLbPG3L_Ho2Ks/s932/runserver.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="500" data-original-width="932" height="304" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEissmkdfn6rkm26KW3eejaxyiveFWloZ2Nrrt2ItC5tX5xrXLCQRUCTiyGsXkR8UgCw8IUzY34Pw3jJDNd03FznbB3pe6u114GkaeadwRTPUog4SMxwX6A3c0T51bZU6SJLbPG3L_Ho2Ks/w565-h304/runserver.png" width="565"></a></div>&nbsp;<p></p><p data-sourcepos="197:1-197:68" style="text-align: left;">We see that before being passed to RegisterService, the <code>stringManipulationImplInstance</code> (name added by me) is being passed to a function, <code>StringManipulationImpl::StringManipulationImpl</code>.
 Based both on the context and the demangled name, this is a constructor
 for whatever class this is. We can see the constructor itself is very 
simple:&nbsp;</p><p data-sourcepos="197:1-197:68" style="text-align: left;"></p><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiySGsbdbYRU_QPB6c9gISiCR8VVk2bAoEsjsS6xnlxJ_sS1p-XUIQcpglLLgBhVDevQbOt6c4cpSs-fe0MyljWgdiDzdu-fhUDpVnq7mDwrobhxZQZ01P_OYoOTWgxz1fnrlIlRW-aY54/s854/service_constructor.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="92" data-original-width="854" height="65" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiySGsbdbYRU_QPB6c9gISiCR8VVk2bAoEsjsS6xnlxJ_sS1p-XUIQcpglLLgBhVDevQbOt6c4cpSs-fe0MyljWgdiDzdu-fhUDpVnq7mDwrobhxZQZ01P_OYoOTWgxz1fnrlIlRW-aY54/w620-h65/service_constructor.png" width="620"></a></div><br><p></p>
<p data-sourcepos="203:1-203:255" style="text-align: left;">The function calls another 
constructor (the base class constructor) on the passed object, then sets
 the value at object offset 0. In C++, this offset is usually (and in 
this case) reserved for the class's vtable. Navigating to that address, 
we can see it:</p><p data-sourcepos="203:1-203:255" style="text-align: left;"></p><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh0IvFYKU36CqeAVCg_F7eNDOr8sHLu-N_t2norYweaMt5YuJ8EXtVxz3KDWQI-Ef0Rh72v3LxOSjr7r88R-JoQCNeZci1OBs3OgO2Rm4DNAt5DA3_i9mZQmyFTTOsoOLQEADz6_LC3fik/s1361/service_vtable.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="95" data-original-width="1361" height="41" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh0IvFYKU36CqeAVCg_F7eNDOr8sHLu-N_t2norYweaMt5YuJ8EXtVxz3KDWQI-Ef0Rh72v3LxOSjr7r88R-JoQCNeZci1OBs3OgO2Rm4DNAt5DA3_i9mZQmyFTTOsoOLQEADz6_LC3fik/w610-h41/service_vtable.png" width="610"></a></div>&nbsp;<p></p><p data-sourcepos="203:1-203:255" style="text-align: left;">Because this binary is not 
stripped, the actual names of the functions (matching the RPCs) are 
displayed. With a stripped binary, this is not the case, however an 
important quirk of the gRPC implementation results in the vtables for 
service implementations always being structured in a particular way, as 
follows.
</p><ul data-sourcepos="209:1-211:0" style="text-align: left;"><li data-sourcepos="209:1-209:65">The first two entries in the vtable are constructor/destructors.</li><li data-sourcepos="210:1-211:0">Each subsequent entry is one of the custom RPC implementations, <i>in the order that they appear in the .proto file</i>.
 This means that if you are in possession of the .proto file for a 
particular service, even if a binary is stripped, you can quickly 
identify which implementation corresponds to which RPC. And if you don't
 have the .proto file, but do have the binary, there is tooling 
available which is very effective at recovering .proto files from gRPC 
binaries, which will be covered later. This is helpful not only because 
you may get a hint at what the RPC does based on its name, but also 
because you will know the exact types of each of the arguments.</li></ul>
<h3 data-sourcepos="212:1-212:21" style="text-align: left;">
Anatomy of an RPC</h3>
<p data-sourcepos="213:1-213:180" style="text-align: left;">There are a few details 
which will be common to all RPC implementations which will aid greatly 
in reverse engineering these functions. The first are the arguments to 
the functions:</p><p data-sourcepos="213:1-213:180" style="text-align: left;"></p><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjNRmHCZjMQbB1XNp0hhrNB3N63aeF_VmCX0pMCxL7eG20QunrvwSaw4dK-dWDDx4TH-ZDFGWtdcZ_v_XX_siS3GWJD1n1s4ZgR2Rg460i3CpttoX8cNnYGCJdChCPYncktN9XgWi2UozQ/s1426/RPC_implementation.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="558" data-original-width="1426" height="237" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjNRmHCZjMQbB1XNp0hhrNB3N63aeF_VmCX0pMCxL7eG20QunrvwSaw4dK-dWDDx4TH-ZDFGWtdcZ_v_XX_siS3GWJD1n1s4ZgR2Rg460i3CpttoX8cNnYGCJdChCPYncktN9XgWi2UozQ/w606-h237/RPC_implementation.png" width="606"></a></div><p></p><ul data-sourcepos="217:1-230:0" style="text-align: left;"><li data-sourcepos="217:1-217:534">
<p data-sourcepos="217:3-217:534"><b>Argument 1</b>: Return value, usually of type grpc::Status. This is a C++ ABI thing, see section 3.1.3.1 of the <a href="https://itanium-cxx-abi.github.io/cxx-abi/abi.html" rel="nofollow noreferrer noopener" target="_blank">Itanium C++ ABI Spec</a>.
 Tracking sections of the code which write to this argument may be 
helpful in understanding authorization logic which may be baked into the
 function, for example if a function is called, and depending on its 
return value, arg1 is set to either grpc::Status::OK or 
grpc::Status::CANCELLED, that function may have something to do with 
access controls.</p><b>
</b></li><li data-sourcepos="218:1-218:106"><b>Argument 2</b>: The <code>this</code> pointer. Points to the instance of whatever service class the RPC is a method on.
</li><li data-sourcepos="219:1-227:0">
<p data-sourcepos="219:3-219:57"><b>Argument 3</b>: ServerContext. From the gRPC documentation:</p>
<blockquote data-sourcepos="220:5-224:44">
<p data-sourcepos="220:6-220:96">A ServerContext or CallbackServerContext allows the code implementing a service handler to:</p>
<ul data-sourcepos="221:6-224:44"><li data-sourcepos="221:6-221:104">Add custom initial and trailing metadata key-value pairs that will propagated to the client side.</li><li data-sourcepos="222:6-222:68">Control call settings such as compression and authentication.</li><li data-sourcepos="223:6-223:46">Access metadata coming from the client.</li><li data-sourcepos="224:6-224:44">Get performance metrics (ie, census).</li></ul>
</blockquote>
<p data-sourcepos="226:5-226:561">We can see in this function that the context is being accessed in a call to <code>ServerContextBase::peer</code>,
 which retrieves metadata containing the client's IP and port. For the 
purposes of reverse engineering, that means that accesses of this 
argument (or method calls on it) can be used to access metadata and/or 
authentication information associated with the client calling the RPC. 
So, it may be of interest regarding authentication/authorization 
auditing. Additionally, if metadata is being parsed, look for data 
parsing/memory corruption etc. issues there.</p>
</li><li data-sourcepos="228:1-228:426">
<p data-sourcepos="228:3-228:426"><b>Argument 4</b>: RPC call argument object. 
This object will be of the input type specified by the .proto file for a
 given RPC. So in this example, this argument would be of type <code>stringmanipulation::StringRequest</code>.
 Generally, this is the data that the RPC will be parsing and 
manipulating, so any logic associated with handling this data is 
important to review for data parsing issues or similar that may lead to 
vulnerabilities.</p>
</li><li data-sourcepos="229:1-230:0">
<p data-sourcepos="229:3-229:279"><b>Argument 5</b>: RPC call return object. 
This object will be of the return type specified by the .proto file for a
 given RPC. So in this example, this argument would be of type <code>stringmanipulation::StringReply</code>. This is the object which is manipulated prior to return to the client.</p>
</li></ul>
<p data-sourcepos="231:1-231:624" style="text-align: left;"><b>Note</b>: In addition to unary RPCs (a single request object and single response object), gRPC also supports <i>streaming</i>
 RPCs. In the case of unidirectional streams, i.e. where only one of the
 request or response is a stream, the number of arguments and order is 
the same, and only the type of one of the arguments will differ. For 
client-side streaming (i.e. the request is streamed) Argument 4 will be 
wrapped with a <code>ServerReader</code>, so in this example it will be of type <code>ServerReader&lt;StringRequest&gt;</code>. For Server side streaming (streamed response), it will be wrapped with a <code>ServerWriter</code>, so <code>ServerWriter&lt;StringReply&gt;</code>.</p>
<p data-sourcepos="233:1-233:505" style="text-align: left;">For bidirectional streams, where both the request <i>and</i>
 the response are streamed, the number of arguments differ. Rather than a
 separate argument for request and response, the function only has four 
arguments, with the forth being a <code>ServerReaderWriter</code> wrapping <i>both</i> types. In this example, <code>ServerReaderWriter&lt;StringRequest, StringReply&gt;</code>. See the gRPC documentation for more information on these wrappers. The <a href="https://grpc.io/docs/languages/cpp/basics/" rel="nofollow noreferrer noopener" target="_blank">C++ Basics Tutorial</a> has some good examples.</p>
<h3 data-sourcepos="235:1-235:35" style="text-align: left;">
Protobuf Member Accesses in C++</h3>
<p data-sourcepos="236:1-236:353" style="text-align: left;">The classes generated by 
protoc for each of the input/output types defined in the .proto file are
 fairly simple. Scalar typed members are stored by value as member 
variables inside the class instance. Non-scalar values are stored as 
pointers to the member. The class includes (among other things) the 
following functions for getting and setting members:</p>
<ul data-sourcepos="237:1-240:0" style="text-align: left;"><li data-sourcepos="237:1-237:205">
<code>.&lt;member&gt;()</code>: get the value of the field with name <code>&lt;member&gt;</code>.
 This is applicable to all types, and will return the value itself for 
scalar types and a pointer to the member for complex/allocated types.</li><li data-sourcepos="238:1-238:131">
<code>.set_&lt;member&gt;(value_to_set)</code>: set the value for a type which does not require allocation. This includes scalar fields and enums.</li><li data-sourcepos="239:1-240:0">
<code>.set_allocated_&lt;member&gt;(value_to_set)</code>: set the value 
for a complex type, which requires allocation and setting of its own 
member values prior to setting in the request or reply. This is for 
composite/nested types.</li></ul>
<p data-sourcepos="241:1-241:307" style="text-align: left;">The actual implementation 
for these functions is fairly uncomplicated, even for allocated types, 
and basically boils down to accessing the value of a pointer at some 
offset into the object whose member is being retrieved or set. These 
functions will not be named in a stripped binary, but are easy to spot.</p>
<p data-sourcepos="243:1-243:410" style="text-align: left;">The getters take the request message (in this example, <code>request</code>)
 as the sole argument, pass it through a couple of nested function 
calls, and eventually make an access to some offset into the message. 
Based on the offset, you can determine which field is being accessed, 
(with the help of the generated pb.h files, generation of which is 
covered later) and can thus identify the function and its return value.</p><p data-sourcepos="243:1-243:410" style="text-align: left;">&nbsp;</p><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiPSExsPtvRy7KPP851Um1WxbJu27yBvrDd3uFdoX1OIvyTl4ywQopHc52I4oWmyMI4X2DBAthxI3x6cdkk33cMXqr4J0NlzCh_VYv83Yxgc5OynjbyluisQCb5NZ-JVjACTf-B3Zt1Ogo/s592/identify_getters.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="154" data-original-width="592" height="145" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiPSExsPtvRy7KPP851Um1WxbJu27yBvrDd3uFdoX1OIvyTl4ywQopHc52I4oWmyMI4X2DBAthxI3x6cdkk33cMXqr4J0NlzCh_VYv83Yxgc5OynjbyluisQCb5NZ-JVjACTf-B3Zt1Ogo/w562-h145/identify_getters.png" width="562"></a></div><br><br><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgNEhLa50w7aQa2E-xDLjPDepKfQluXs-ttpJKRi-4kYd2foZ8SaKPpta3R6bw73TWYogRiYEoLR5kh4-y82mGZWwZaOtvgCzrBaoQXgR8eO_gzi8fBRBidemiZRRVXxc2AGh_B07B2QKA/s312/identify_getters2.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="52" data-original-width="312" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgNEhLa50w7aQa2E-xDLjPDepKfQluXs-ttpJKRi-4kYd2foZ8SaKPpta3R6bw73TWYogRiYEoLR5kh4-y82mGZWwZaOtvgCzrBaoQXgR8eO_gzi8fBRBidemiZRRVXxc2AGh_B07B2QKA/s0/identify_getters2.png"></a></div><br><p></p>
<p data-sourcepos="251:1-251:118" style="text-align: left;"></p><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi569RP0LpeMZuem5zf7xrdsc9_REBNwSD1RhfxmIeWNsBELfXeiwcZrEiUleFD0oAgPiOFhNdVlgM0nwbg4wfxhGWN7z9Rk_3XgYjkUTTD9lIJhJpzTQ4SXOBnMmALXAqdvra0NtArXGk/s318/identify_getters3.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="56" data-original-width="318" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi569RP0LpeMZuem5zf7xrdsc9_REBNwSD1RhfxmIeWNsBELfXeiwcZrEiUleFD0oAgPiOFhNdVlgM0nwbg4wfxhGWN7z9Rk_3XgYjkUTTD9lIJhJpzTQ4SXOBnMmALXAqdvra0NtArXGk/s0/identify_getters3.png"></a></div>&nbsp;<p></p><p data-sourcepos="251:1-251:118" style="text-align: left;">The implementation for complex types is similar, adding a small amount of extra code to account for allocation issues.</p><p data-sourcepos="251:1-251:118" style="text-align: left;"></p><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi2gerYhttoEuVrIWWZOhqoXw8EzgbhLszOfHPEluGRo8TC_ShKwYSCUuOo3xArNWrz1i-QklrpSWYljIGMpytjOvyuSWi9MoW9EBejaknxSoRFqOyHQK45p78g1vjRNV2FncULo1dY72w/s722/identify_getters_complex.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="95" data-original-width="722" height="83" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi2gerYhttoEuVrIWWZOhqoXw8EzgbhLszOfHPEluGRo8TC_ShKwYSCUuOo3xArNWrz1i-QklrpSWYljIGMpytjOvyuSWi9MoW9EBejaknxSoRFqOyHQK45p78g1vjRNV2FncULo1dY72w/w635-h83/identify_getters_complex.png" width="635"></a></div><br><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhljxoJq56awhIPcv0ehK9FIjan2fUDImzbdCad1nRZbaWj04KDb6toikBWavv5jNXUzgk-kxUbn4YOa4PRGvr9SeuAMz2T_QqltcxQRRpbqMoj9zfUfwWnySCnBFSo_aP-UoXmEPEJPHU/s267/identify_getters_complex2.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="52" data-original-width="267" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhljxoJq56awhIPcv0ehK9FIjan2fUDImzbdCad1nRZbaWj04KDb6toikBWavv5jNXUzgk-kxUbn4YOa4PRGvr9SeuAMz2T_QqltcxQRRpbqMoj9zfUfwWnySCnBFSo_aP-UoXmEPEJPHU/s0/identify_getters_complex2.png"></a></div><br><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhqLKOgJNdLVJf22Xh6Kug7RpB2JREeiKFFSvH61qLqmxYr_dHKaJ_9k5nb2AYkDDjOHku60bZQ31O3TLrVFxuQ1oKJocJXxz7z21dUovFQxnBMHTtk132JeK8OMroj9OOVoZPyHpoglZ4/s308/identify_getters_complex3.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="145" data-original-width="308" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhqLKOgJNdLVJf22Xh6Kug7RpB2JREeiKFFSvH61qLqmxYr_dHKaJ_9k5nb2AYkDDjOHku60bZQ31O3TLrVFxuQ1oKJocJXxz7z21dUovFQxnBMHTtk132JeK8OMroj9OOVoZPyHpoglZ4/s0/identify_getters_complex3.png"></a></div>&nbsp;<p></p><p data-sourcepos="251:1-251:118" style="text-align: left;">Setter functions follow an 
almost identical structure, with the only difference being that they 
take the response message (in this example, <code>reply</code>) as the first argument and the value to set the field to as the second argument.&nbsp;</p><p data-sourcepos="251:1-251:118" style="text-align: left;"></p><p></p><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiKN2lXzd4C1revksuXKCmG1V0r2puqFj_ewU50Eln2l6Iiek6hIgs6AcKcI0nbsI-AcM1kPtTpH30Xfjhr12FgRyoptAl_PO7SQQ_RDwy0ZJe3eQyldKUbM5g7dpouv64v67Kb6kGwX88/s466/identify_setters.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="81" data-original-width="466" height="85" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiKN2lXzd4C1revksuXKCmG1V0r2puqFj_ewU50Eln2l6Iiek6hIgs6AcKcI0nbsI-AcM1kPtTpH30Xfjhr12FgRyoptAl_PO7SQQ_RDwy0ZJe3eQyldKUbM5g7dpouv64v67Kb6kGwX88/w486-h85/identify_setters.png" width="486"></a></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgQkgnvGz3i9mKojwo0jyCp0JSj-3Zo-2YtDBAUAaca5AtIK9f9VF38UboN2M34DBJMUXO0c6MHIrPTZHGl5jHsvr5YqU5o5DfUw7IS0fIgWFEw_nMZtpbaUq-uS6rbhpUXnD-SoGMunys/s499/identify_setters2.png" style="margin-left: 1em; margin-right: 1em;"><br><img border="0" data-original-height="54" data-original-width="499" height="45" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgQkgnvGz3i9mKojwo0jyCp0JSj-3Zo-2YtDBAUAaca5AtIK9f9VF38UboN2M34DBJMUXO0c6MHIrPTZHGl5jHsvr5YqU5o5DfUw7IS0fIgWFEw_nMZtpbaUq-uS6rbhpUXnD-SoGMunys/w413-h45/identify_setters2.png" width="413"></a></div><br><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjlM19VAkcSZ4O2nfgPcyZqWuPLK5ZysA4WU108leBkh5zycksHl0dH9fPHmTGGSh1wfOXy4nNttVcyz0K79PLwKQaBYYF3yonWqZUm6aH-Bq1EBPHvtchzJvnrEqzBFFM8fyF_hPuI_uw/s409/identify_setters3.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="65" data-original-width="409" height="63" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjlM19VAkcSZ4O2nfgPcyZqWuPLK5ZysA4WU108leBkh5zycksHl0dH9fPHmTGGSh1wfOXy4nNttVcyz0K79PLwKQaBYYF3yonWqZUm6aH-Bq1EBPHvtchzJvnrEqzBFFM8fyF_hPuI_uw/w396-h63/identify_setters3.png" width="396"></a></div><br><p><br></p><p data-sourcepos="267:1-267:116" style="text-align: left;">And again, the only difference for complex type setters is a bit of extra logic to handle allocation when necessary.</p><p data-sourcepos="267:1-267:116" style="text-align: left;"></p><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjzDLMQbEJ-gIfLbxkSW_UYBPCyodOMYAfUl3wgAXx5YCJ9o-xa5L-d9U-ORzk9ZZSavOfAKfTC4-gYOgzDzc3oz7oYWgLVwd18Tlh93gMjzl7MT0QkiNfzctKK10WXJqbRuYYwxOMmFcE/s539/identify_setters_complex2.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="247" data-original-width="539" height="246" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjzDLMQbEJ-gIfLbxkSW_UYBPCyodOMYAfUl3wgAXx5YCJ9o-xa5L-d9U-ORzk9ZZSavOfAKfTC4-gYOgzDzc3oz7oYWgLVwd18Tlh93gMjzl7MT0QkiNfzctKK10WXJqbRuYYwxOMmFcE/w536-h246/identify_setters_complex2.png" width="536"></a></div>&nbsp;<p></p><h3 data-sourcepos="271:1-271:24" style="text-align: left;">
Reconstructing Types</h3>
<p data-sourcepos="272:1-272:536" style="text-align: left;">The huge amount of 
automatically generated code used by gRPC is a great annoyance to a 
prospective reverse engineer, but it can also be a great ally. Because 
the manner in which the .proto files are integrated into the final 
binary is uniform, and because the binary must include this information 
in some form to correctly deserialize incoming messages, it is possible 
in most cases to extract a complete reconstruction of the original 
.proto file from any software which uses gRPC for communication, whether
 that be a client or server.</p>
<p data-sourcepos="274:1-274:409" style="text-align: left;">This can be done manually with some studying up on protobuf <code>Filedescriptor</code>s,
 but more than likely this will not be necessary -- someone has probably
 already written something to do it for you. For this guide the <i>Protobuf Toolkit</i> (<code>pbtk</code>)
 will be used, but a more extensive list of available software for 
extracting .proto structures from gRPC clients and servers will be 
included in the <i>Tooling</i> section.</p>
<h4 data-sourcepos="276:1-276:28" style="text-align: left;">
Generating .proto Files</h4>
<p data-sourcepos="277:1-277:99" style="text-align: left;">By feeding the server binary we are working with into pbtk, the following .proto file is generated.</p>
<pre class="code highlight js-syntax-highlight language-protobuf white" lang="protobuf" style="text-align: left;"><code><span class="line" id="LC1" lang="protobuf"><span class="na">syntax</span> <span class="o">=</span> <span class="s">"proto3"</span><span class="p">;</span></span>
<span class="line" id="LC2" lang="protobuf"></span>
<span class="line" id="LC3" lang="protobuf"><span class="kn">package</span> <span class="nn">stringmanipulation</span><span class="p">;</span></span>
<span class="line" id="LC4" lang="protobuf"></span>
<span class="line" id="LC5" lang="protobuf"><span class="kd">service</span> <span class="n">StringManipulation</span> <span class="p">{</span></span>
<span class="line" id="LC6" lang="protobuf">    <span class="k">rpc</span> <span class="n">reverseString</span><span class="p">(</span><span class="n">StringRequest</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">StringReply</span><span class="p">);</span></span>
<span class="line" id="LC7" lang="protobuf">    <span class="k">rpc</span> <span class="n">uppercaseString</span><span class="p">(</span><span class="n">StringRequest</span><span class="p">)</span> <span class="k">returns</span> <span class="p">(</span><span class="n">StringReply</span><span class="p">);</span></span>
<span class="line" id="LC8" lang="protobuf"><span class="p">}</span></span>
<span class="line" id="LC9" lang="protobuf"></span>
<span class="line" id="LC10" lang="protobuf"><span class="kd">message</span> <span class="nc">innerMessage</span> <span class="p">{</span></span>
<span class="line" id="LC11" lang="protobuf">    <span class="kt">int32</span> <span class="na">some_val</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span></span>
<span class="line" id="LC12" lang="protobuf">    <span class="kt">string</span> <span class="na">some_string</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span></span>
<span class="line" id="LC13" lang="protobuf"><span class="p">}</span></span>
<span class="line" id="LC14" lang="protobuf"></span>
<span class="line" id="LC15" lang="protobuf"><span class="kd">message</span> <span class="nc">complexMessage</span> <span class="p">{</span></span>
<span class="line" id="LC16" lang="protobuf">    <span class="n">innerMessage</span> <span class="na">some_message</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span></span>
<span class="line" id="LC17" lang="protobuf">    <span class="n">testEnumeration</span> <span class="na">innerEnum</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span></span>
<span class="line" id="LC18" lang="protobuf"><span class="p">}</span></span>
<span class="line" id="LC19" lang="protobuf"></span>
<span class="line" id="LC20" lang="protobuf"><span class="kd">message</span> <span class="nc">StringRequest</span> <span class="p">{</span></span>
<span class="line" id="LC21" lang="protobuf">    <span class="n">complexMessage</span> <span class="na">cm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span></span>
<span class="line" id="LC22" lang="protobuf">    <span class="kt">string</span> <span class="na">original</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span></span>
<span class="line" id="LC23" lang="protobuf">    <span class="kt">int64</span> <span class="na">timestamp</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span></span>
<span class="line" id="LC24" lang="protobuf">    <span class="kt">bool</span> <span class="na">testval</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span></span>
<span class="line" id="LC25" lang="protobuf">    <span class="kt">bool</span> <span class="na">testval2</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span></span>
<span class="line" id="LC26" lang="protobuf">    <span class="kt">bool</span> <span class="na">testval3</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span></span>
<span class="line" id="LC27" lang="protobuf"><span class="p">}</span></span>
<span class="line" id="LC28" lang="protobuf"></span>
<span class="line" id="LC29" lang="protobuf"><span class="kd">message</span> <span class="nc">StringReply</span> <span class="p">{</span></span>
<span class="line" id="LC30" lang="protobuf">    <span class="kt">string</span> <span class="na">result</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span></span>
<span class="line" id="LC31" lang="protobuf">    <span class="kt">int64</span> <span class="na">timestamp</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span></span>
<span class="line" id="LC32" lang="protobuf">    <span class="n">complexMessage</span> <span class="na">cm</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span></span>
<span class="line" id="LC33" lang="protobuf"><span class="p">}</span></span>
<span class="line" id="LC34" lang="protobuf"></span>
<span class="line" id="LC35" lang="protobuf"><span class="kd">enum</span> <span class="n">testEnumeration</span> <span class="p">{</span></span>
<span class="line" id="LC36" lang="protobuf">    <span class="na">ZERO</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span></span>
<span class="line" id="LC37" lang="protobuf">    <span class="na">ONE</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span></span>
<span class="line" id="LC38" lang="protobuf">    <span class="na">TWO</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span></span>
<span class="line" id="LC39" lang="protobuf">    <span class="na">THREE</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span></span>
<span class="line" id="LC40" lang="protobuf">    <span class="na">FOUR</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span></span>
<span class="line" id="LC41" lang="protobuf">    <span class="na">FIVE</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span></span>
<span class="line" id="LC42" lang="protobuf"><span class="p">}</span></span></code></pre>
<p data-sourcepos="324:1-324:619" style="text-align: left;">Referring back to the 
original .proto example at the beginning, we can see this is a perfect 
match, even preserving order of RPC declarations and message fields. 
This is important because we can now begin to correlate vtable members 
with RPCs by name and argument types. However, while we know the types 
of arguments being passed to each RPC, we do not know how each field is 
ordered inside the c++ object for each type. Annoyingly, the order of 
member variables for the generated class for a given type appears to be 
correlated neither to the order of definition in the .proto file, nor to
 the field numbers specified.</p>
<p data-sourcepos="326:1-326:500" style="text-align: left;">However, auto-generated 
code comes to the rescue again. While the order of member variables doe 
not appear to be tied to the .proto file at all, it <i>does</i> appear
 to be deterministic, based on analysis of numerous gRPC binaries. 
protoc uses some consistent metric for ordering the fields when 
generating the .pb.h header files, which are the source of truth for 
class/structure layout for the final binary. And conveniently, now that 
we have possession of a .proto file, we can generate these headers.</p>
<h4 data-sourcepos="328:1-328:32" style="text-align: left;">
Defining Message Structures</h4>
<p data-sourcepos="330:1-330:570" style="text-align: left;">The command <code>protoc --cpp_out=. &lt;your_generated_proto_file&gt;.proto</code>
 will compile the .proto file into the corresponding pb.cc and pb.h 
files. Here we're interested in the headers. There is quite a bit of 
cruft to sift through in these files, but the general structure is easy 
to follow. Each type defined in the .proto file gets defined as a class,
 which includes all methods and member variables. The member variables 
are what we are interested in, since we need to know their order and C++
 type in order to map out structures for each of them while reverse 
engineering.</p>
<p data-sourcepos="332:1-332:180" style="text-align: left;">The member variable declarations can be found at the very bottom of the class declaration, under a comment which reads <code>@@protoc_insertion_point(class_scope:&lt;package&gt;.&lt;type name&gt;)</code></p>
<pre class="code highlight js-syntax-highlight language-cpp white" lang="cpp" style="text-align: left;"><code><span class="line" id="LC1" lang="cpp">  <span class="c1">// @@protoc_insertion_point(class_scope:stringmanipulation.StringRequest)</span></span>
<span class="line" id="LC2" lang="cpp"> <span class="k">private</span><span class="o">:</span></span>
<span class="line" id="LC3" lang="cpp">  <span class="k">class</span> <span class="nc">_Internal</span><span class="p">;</span></span>
<span class="line" id="LC4" lang="cpp"></span>
<span class="line" id="LC5" lang="cpp">  <span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="nc">T</span><span class="p">&gt;</span> <span class="k">friend</span> <span class="k">class</span> <span class="o">::</span><span class="n">PROTOBUF_NAMESPACE_ID</span><span class="o">::</span><span class="n">Arena</span><span class="o">::</span><span class="n">InternalHelper</span><span class="p">;</span></span>
<span class="line" id="LC6" lang="cpp">  <span class="k">typedef</span> <span class="kt">void</span> <span class="n">InternalArenaConstructable_</span><span class="p">;</span></span>
<span class="line" id="LC7" lang="cpp">  <span class="k">typedef</span> <span class="kt">void</span> <span class="n">DestructorSkippable_</span><span class="p">;</span></span>
<span class="line" id="LC8" lang="cpp">  <span class="o">::</span><span class="n">PROTOBUF_NAMESPACE_ID</span><span class="o">::</span><span class="n">internal</span><span class="o">::</span><span class="n">ArenaStringPtr</span> <span class="n">original_</span><span class="p">;</span></span>
<span class="line" id="LC9" lang="cpp">  <span class="o">::</span><span class="n">stringmanipulation</span><span class="o">::</span><span class="n">complexMessage</span><span class="o">*</span> <span class="n">cm_</span><span class="p">;</span></span>
<span class="line" id="LC10" lang="cpp">  <span class="o">::</span><span class="n">PROTOBUF_NAMESPACE_ID</span><span class="o">::</span><span class="n">int64</span> <span class="n">timestamp_</span><span class="p">;</span></span>
<span class="line" id="LC11" lang="cpp">  <span class="kt">bool</span> <span class="n">testval_</span><span class="p">;</span></span>
<span class="line" id="LC12" lang="cpp">  <span class="kt">bool</span> <span class="n">testval2_</span><span class="p">;</span></span>
<span class="line" id="LC13" lang="cpp">  <span class="kt">bool</span> <span class="n">testval3_</span><span class="p">;</span></span>
<span class="line" id="LC14" lang="cpp">  <span class="k">mutable</span> <span class="o">::</span><span class="n">PROTOBUF_NAMESPACE_ID</span><span class="o">::</span><span class="n">internal</span><span class="o">::</span><span class="n">CachedSize</span> <span class="n">_cached_size_</span><span class="p">;</span></span>
<span class="line" id="LC15" lang="cpp">  <span class="k">friend</span> <span class="k">struct</span> <span class="o">::</span><span class="n">TableStruct_stringmanipulation_2eproto</span><span class="p">;</span></span></code></pre>
<p data-sourcepos="352:1-352:201" style="text-align: left;">The member fields defined in the .proto file will always start at offset <code>sizeof(size_t) * 2</code> bytes from the class object, so 8 bytes for 32 bit, and 16 bytes for 64 bit. Thus, for the above class (<code>StringRequest</code>), we can define the following struct for static analysis:</p>
<pre class="code highlight js-syntax-highlight language-c white" lang="c" style="text-align: left;"><code><span class="line" id="LC1" lang="c"><span class="c1">// assuming 64bit architecture, if 32bit pointer sizes will differ</span></span>
<span class="line" id="LC2" lang="c"><span class="k">struct</span> <span class="n">StringRequest</span> <span class="n">__packed</span> <span class="p">{</span></span>
<span class="line" id="LC3" lang="c">    <span class="mh">0x00</span><span class="o">:</span> <span class="kt">uint8_t</span> <span class="n">dontcare</span><span class="p">[</span><span class="mh">0x10</span><span class="p">];</span></span>
<span class="line" id="LC4" lang="c">    <span class="mh">0x10</span><span class="o">:</span> <span class="kt">void</span> <span class="o">*</span><span class="n">original_string</span><span class="p">;</span> </span>
<span class="line" id="LC5" lang="c">    <span class="mh">0x18</span><span class="o">:</span> <span class="k">struct</span> <span class="n">complexMessage</span> <span class="o">*</span><span class="n">cm</span><span class="p">;</span> <span class="c1">// This will also need to be defined, </span></span>
<span class="line" id="LC6" lang="c">                                     <span class="c1">// the same technique inspecting the pb.h file applies</span></span>
<span class="line" id="LC7" lang="c">    <span class="mh">0x20</span><span class="o">:</span> <span class="kt">int64_t</span> <span class="n">timestamp</span><span class="p">;</span></span>
<span class="line" id="LC8" lang="c">    <span class="mh">0x28</span><span class="o">:</span> <span class="kt">uint8_t</span> <span class="n">testval</span><span class="p">;</span></span>
<span class="line" id="LC9" lang="c">    <span class="mh">0x29</span><span class="o">:</span> <span class="kt">uint8_t</span> <span class="n">testval2</span><span class="p">;</span></span>
<span class="line" id="LC10" lang="c">    <span class="mh">0x2a</span><span class="o">:</span> <span class="kt">uint8_t</span> <span class="n">testval3</span><span class="p">;</span></span>
<span class="line" id="LC11" lang="c"><span class="p">};</span></span></code></pre>
<p data-sourcepos="368:1-368:400" style="text-align: left;"><b>Note</b>: 
protobuf classes are packed, meaning there is no padding added between 
members to ensure 4 or 8 byte alignment. For example, in the above 
structure, the three bools will be found one after another at offsets 
0x28, 0x29, and 0x2a, rather than at 0x28, 0x2c, and 0x30 as would be 
the case with 4 bit aligned padding. Ensure that your reverse 
engineering tool knows this when defining structs.</p>
<p data-sourcepos="370:1-370:263" style="text-align: left;">Once structures have been 
correctly defined for each of the types, it becomes quite easy to 
determine what each function and variable is. Take the first example for
 the <i>Protobuf Member Accesses</i> section, now updated to accept an argument of type <code>StringRequest</code>:</p><p data-sourcepos="370:1-370:263" style="text-align: left;"></p><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhV2-gjSNvC7k2ePyZgqwZzRYfI0zfpmVFGcYcqZpRo0d4oEsRyugIMBvDyainmqx2yueu4SYVzH8pXdaoqr7h6FsICwaoTBoz28OuUc2od-eJOFznu4O7RJ0G33oladQHDLRzDw_f4qHQ/s408/get_original.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="427" data-original-width="237" height="320" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiJJznS4r_JuDWVV1L9I_HtPPkIyqcvgnev3bNmk7ery_7cnDd4UmMI3ZkgZqoVugRkvVNBd8vRPlqGCP02N10Foh8AzdaXTW5j0Z0Jn7csQZ01O41Pa8V-Qoe12a9yDoELysLvYhT7XtE/s320/message_structs.png"><img border="0" data-original-height="117" data-original-width="408" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhV2-gjSNvC7k2ePyZgqwZzRYfI0zfpmVFGcYcqZpRo0d4oEsRyugIMBvDyainmqx2yueu4SYVzH8pXdaoqr7h6FsICwaoTBoz28OuUc2od-eJOFznu4O7RJ0G33oladQHDLRzDw_f4qHQ/s320/get_original.png" width="320"></a></div><p></p><p data-sourcepos="376:1-376:234" style="text-align: left;">Its clear now that this 
function is the getter for the StringRequest.original, a string. 
Applying this technique to the rest of the RPC, changing function and 
variable names as necessary, produces fairly easy to follow 
decomplication:</p>
<div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhHGbML5TxZB7eOWQgLaZKV9FZCsikq8-sETfa-Yi4yn-A4ZCcKPaD_dDZ5QISo6Utg_rrFLUTzrNB_hhqmWebPceHj98FTGP5MfoQcVPnHg7NMAv4ptCoL7NrPnW0de92l-jL1fnqM33M/s988/applied_decomp.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="477" data-original-width="988" height="290" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhHGbML5TxZB7eOWQgLaZKV9FZCsikq8-sETfa-Yi4yn-A4ZCcKPaD_dDZ5QISo6Utg_rrFLUTzrNB_hhqmWebPceHj98FTGP5MfoQcVPnHg7NMAv4ptCoL7NrPnW0de92l-jL1fnqM33M/w604-h290/applied_decomp.png" width="604"></a></div><br><p data-sourcepos="378:1-378:78" style="text-align: left;"><br></p>
<p data-sourcepos="380:1-380:185" style="text-align: left;">From here, it is as simple 
as standard static analysis to look for any vulnerabilities which might 
be exploited in the server, whether it be in incoming data parsing or 
something else.</p>
<h2 data-sourcepos="382:1-382:17" style="text-align: left;">
Active Testing</h2>
<p data-sourcepos="383:1-383:647" style="text-align: left;">Most of the active 
testing/dynamic analysis to be performed re: gRPC is fairly self 
explanatory, and is essentially just fuzzing/communicating over a 
network protocol. If the .proto files are available (or the server or 
client binary is available, and thus the .proto files can be generated),
 they can be provided to a number of existing gRPC tooling to 
communicate with the server. If no server, client, or .protos are 
available, it is still possible to reconstruct the .proto to some extend
 via captured gRPC messages. Resources for various techniques and tools 
for actively testing a gRPC connection can be found in the <i>Tooling</i> section below.</p>
<h2 data-sourcepos="385:1-385:10" style="text-align: left;">
Tooling</h2>
<ul data-sourcepos="386:1-388:116" style="text-align: left;"><li data-sourcepos="386:1-387:0">
<p data-sourcepos="386:3-386:280"><b><a href="https://github.com/trailofbits/protofuzz" rel="nofollow noreferrer noopener" target="_blank">Protofuzz</a></b>
 - ProtoFuzz is a generic fuzzer for Google’s Protocol Buffers format. 
Takes a proto specification and outputs mutations based on that 
specification. Does not actually connect to the gRPC server, just 
produces the data.</p>
</li><li data-sourcepos="388:1-388:116">
<p data-sourcepos="388:3-388:116"><b><a href="https://github.com/marin-m/pbtk" rel="nofollow noreferrer noopener" target="_blank">Protobuf Toolkit</a></b> - From the <a href="https://github.com/marin-m/pbtk" rel="nofollow noreferrer noopener" target="_blank">pbtk README</a>:</p>
</li></ul>
<blockquote data-sourcepos="389:1-396:198" style="text-align: left;">
<p data-sourcepos="389:2-389:126">pbtk (Protobuf toolkit) is a full-fledged set of scripts, accessible through an unified GUI, that provides two main features:</p>
<ol data-sourcepos="390:5-396:198"><li data-sourcepos="390:5-395:1">
<p data-sourcepos="390:8-390:132">Extracting Protobuf structures from programs, converting them back into readable .protos, supporting various implementations:</p>
<ul data-sourcepos="392:9-395:1"><li data-sourcepos="392:9-392:97">All the main Java runtimes (base, Lite, Nano, Micro, J2ME), with full Proguard support,</li><li data-sourcepos="393:9-393:115">Binaries containing embedded reflection metadata (typically C++, sometimes Java and most other bindings),</li><li data-sourcepos="394:9-395:1">Web applications using the JsProtoUrl runtime.</li></ul>
</li><li data-sourcepos="396:5-396:198">
<p data-sourcepos="396:8-396:198">Editing, replaying and fuzzing data 
sent to Protobuf network endpoints, through a handy graphical interface 
that allows you to edit live the fields for a Protobuf message and view 
the result.</p>
</li></ol>
</blockquote>
<ul data-sourcepos="398:1-403:0" style="text-align: left;"><li data-sourcepos="398:1-399:0">
<p data-sourcepos="398:3-398:374"><b><a href="https://github.com/bradleyjkemp/grpc-tools" rel="nofollow noreferrer noopener" target="_blank">grpc-tools/grpc-dump</a></b>
 - grpc-dump is a grpc proxy capable of deducing protobuf structure if 
no .protos are provided. Can be used similarly to mitmdump. grpc-tools 
includes other useful tools, including the grpc-proxy go library which 
can be used to write a custom proxy if grpc-dump does not suit the needs
 of a given test.</p>
</li><li data-sourcepos="400:1-401:0">
<p data-sourcepos="400:3-400:181"><b><a href="https://protogen.marcgravell.com/decode" rel="nofollow noreferrer noopener" target="_blank">Online Protobuf Decoder</a></b> - Will pull apart arbitrary protobuf data (without requiring a schema), displaying the hierarchical content.</p>
</li><li data-sourcepos="402:1-403:0">
<p data-sourcepos="402:3-402:115"><b><a href="https://github.com/grpc-ecosystem/awesome-grpc" rel="nofollow noreferrer noopener" target="_blank">Awesome gRPC</a></b> - A curated list of useful resources for gRPC.</p>
</li></ul>
<h2 data-sourcepos="404:1-404:12" style="text-align: left;">
Resources</h2>
<ul data-sourcepos="405:1-414:0" style="text-align: left;"><li data-sourcepos="405:1-405:87"><a href="https://github.com/Ethan-ks/gRPC-reversing-example" rel="nofollow noreferrer noopener" target="_blank">The code I wrote for this guide</a></li><li data-sourcepos="406:1-406:63"><a href="https://grpc.io/blog/wireshark/" rel="nofollow noreferrer noopener" target="_blank">gRPC Wireshark Integration</a></li><li data-sourcepos="407:1-407:89"><a href="https://developers.google.com/protocol-buffers/docs/proto3" rel="nofollow noreferrer noopener" target="_blank">Protobuf 3 Language Guide</a></li><li data-sourcepos="408:1-408:92"><a href="https://developers.google.com/protocol-buffers/docs/tutorials" rel="nofollow noreferrer noopener" target="_blank">Google Protobuf Tutorials</a></li><li data-sourcepos="409:1-409:58"><a href="https://grpc.io/docs/languages/" rel="nofollow noreferrer noopener" target="_blank">Google gRPC Tutorials</a></li><li data-sourcepos="410:1-410:84"><a href="https://grpc.github.io/grpc/cpp/namespacegrpc.html" rel="nofollow noreferrer noopener" target="_blank">gRPC C++ Namespace Reference</a></li><li data-sourcepos="411:1-411:64"><a href="https://grpc.io/docs/guides/auth/" rel="nofollow noreferrer noopener" target="_blank">gRPC Authentication Guide</a></li><li data-sourcepos="412:1-412:142"><a href="https://blog.davidvassallo.me/2018/10/17/pentesting-grpc-protobuf-decoding-first-steps/" rel="nofollow noreferrer noopener" target="_blank">Pentesting gRPC / Protobuf : Decoding First steps</a></li><li data-sourcepos="413:1-414:0"><a href="https://blog.davidvassallo.me/2018/10/27/pentesting-grpc-web-recon-and-reverse-engineering/" rel="nofollow noreferrer noopener" target="_blank">Pentesting gRPC-Web : Recon and reverse-engineering</a> <br></li></ul>
<div style="clear: both;"></div>
</div>
<div class="post-footer">
<div class="post-footer-line post-footer-line-1">
<span class="post-author vcard">
</span>
<span class="post-timestamp">
at
<meta content="https://labs.ioactive.com/2021/07/breaking-protocol-buffers-reverse.html" itemprop="url">
<a class="timestamp-link" href="https://labs.ioactive.com/2021/07/breaking-protocol-buffers-reverse.html" rel="bookmark" title="permanent link"><abbr class="published" itemprop="datePublished" title="2021-07-30T03:47:00-07:00">July 30, 2021</abbr></a>
</span>
<span class="post-comment-link">
</span>
<span class="post-icons">
<span class="item-control blog-admin pid-1536902149">
<a href="https://www.blogger.com/post-edit.g?blogID=2165778380262691600&amp;postID=4469446424408015238&amp;from=pencil" title="Edit Post">
<img alt="" class="icon-action" height="18" src="https://resources.blogblog.com/img/icon18_edit_allbkg.gif" width="18">
</a>
</span>
</span>
<div class="post-share-buttons goog-inline-block">
<a class="goog-inline-block share-button sb-email" href="https://www.blogger.com/share-post.g?blogID=2165778380262691600&amp;postID=4469446424408015238&amp;target=email" target="_blank" title="Email This"><span class="share-button-link-text">Email This</span></a><a class="goog-inline-block share-button sb-blog" href="https://www.blogger.com/share-post.g?blogID=2165778380262691600&amp;postID=4469446424408015238&amp;target=blog" onclick="window.open(this.href, &quot;_blank&quot;, &quot;height=270,width=475&quot;); return false;" target="_blank" title="BlogThis!"><span class="share-button-link-text">BlogThis!</span></a><a class="goog-inline-block share-button sb-twitter" href="https://www.blogger.com/share-post.g?blogID=2165778380262691600&amp;postID=4469446424408015238&amp;target=twitter" target="_blank" title="Share to Twitter"><span class="share-button-link-text">Share to Twitter</span></a><a class="goog-inline-block share-button sb-facebook" href="https://www.blogger.com/share-post.g?blogID=2165778380262691600&amp;postID=4469446424408015238&amp;target=facebook" onclick="window.open(this.href, &quot;_blank&quot;, &quot;height=430,width=640&quot;); return false;" target="_blank" title="Share to Facebook"><span class="share-button-link-text">Share to Facebook</span></a><a class="goog-inline-block share-button sb-pinterest" href="https://www.blogger.com/share-post.g?blogID=2165778380262691600&amp;postID=4469446424408015238&amp;target=pinterest" target="_blank" title="Share to Pinterest"><span class="share-button-link-text">Share to Pinterest</span></a>
</div>
</div>
<div class="post-footer-line post-footer-line-2">
<span class="post-labels">
</span>
</div>
<div class="post-footer-line post-footer-line-3">
<span class="post-location">
</span>
</div>
</div>
</div>
<div class="comments" id="comments">
<a name="comments"></a>
<h4>No comments:</h4>
<div id="Blog1_comments-block-wrapper">
<dl class="avatar-comment-indent" id="comments-block">
</dl>
</div>
<p class="comment-footer">
</p><div class="comment-form">
<a name="comment-form"></a>
<h4 id="comment-post-message">Post a Comment</h4>
<p>
</p>
<p>Note: Only a member of this blog may post a comment.</p>
<a href="https://www.blogger.com/comment/frame/2165778380262691600?po=4469446424408015238&amp;hl=en&amp;blogspotRpcToken=6871326" id="comment-editor-src"></a>
<iframe allowtransparency="true" class="blogger-iframe-colorize blogger-comment-from-post" frameborder="0" height="88px" id="comment-editor" name="comment-editor" src="https://www.blogger.com/comment/frame/2165778380262691600?po=4469446424408015238&amp;hl=en&amp;blogspotRpcToken=6871326#%7B%22color%22%3A%22rgb(102%2C%20102%2C%20102)%22%2C%22backgroundColor%22%3A%22rgb(255%2C%20255%2C%20255)%22%2C%22unvisitedLinkColor%22%3A%22rgb(34%2C%20136%2C%20187)%22%2C%22fontFamily%22%3A%22%5C%22Trebuchet%20MS%5C%22%2C%20Trebuchet%2C%20Verdana%2C%20sans-serif%22%7D" width="100%" data-resized="true"></iframe>
<script src="https://www.blogger.com/static/v1/jsbin/1466990918-comment_from_post_iframe.js" type="text/javascript"></script>
<script type="text/javascript">
      BLOG_CMT_createIframe('https://www.blogger.com/rpc_relay.html');
    </script>
</div>
<p></p>
</div>
</div>
<div class="inline-ad">
<!--Can't find substitution for tag [adCode]-->
</div>

        </div></div>
      
</div>
<div class="blog-pager" id="blog-pager">
<span id="blog-pager-newer-link">
<a class="blog-pager-newer-link" href="https://labs.ioactive.com/2021/12/cracking-snapcode.html" id="Blog1_blog-pager-newer-link" title="Newer Post">Newer Post</a>
</span>
<span id="blog-pager-older-link">
<a class="blog-pager-older-link" href="https://labs.ioactive.com/2021/04/watch-your-step-research-into-concrete.html" id="Blog1_blog-pager-older-link" title="Older Post">Older Post</a>
</span>
<a class="home-link" href="https://labs.ioactive.com/">Home</a>
</div>
<div class="clear"></div>
<div class="post-feeds">
<div class="feed-links">
Subscribe to:
<a class="feed-link" href="https://labs.ioactive.com/feeds/4469446424408015238/comments/default" target="_blank" type="application/atom+xml">Post Comments (Atom)</a>
</div>
</div>
</div></div>
</div>
</div>
<div class="column-left-outer">
<div class="column-left-inner">
<aside>
</aside>
</div>
</div>
<div class="column-right-outer">
<div class="column-right-inner">
<aside>
<div class="sidebar section" id="sidebar-right-1"><div class="widget Image" data-version="1" id="Image1">
<h2>IOACTIVE LABS</h2>
<div class="widget-content">
<img alt="IOACTIVE LABS" height="178" id="Image1_img" src="//3.bp.blogspot.com/-wX68vNZ8ngY/X055xEiGNCI/AAAAAAAAAEQ/j1lyKOoZex4GXmaVha-MHAwU-OOEY8dWACK4BGAYYCw/s187/200-200-max.jpg" width="178" style="visibility: visible;">
<br>
</div>
<div class="clear"></div>
</div><div class="widget LinkList" data-version="1" id="LinkList1">
<h2>IOActive Labs External Links</h2>
<div class="widget-content">
<ul>
<li><a href="https://twitter.com/IoaLabs">IOActive Labs Twitter</a></li>
<li><a href="https://twitter.com/IOActive">IOActive Inc Twitter </a></li>
<li><a href="https://www.facebook.com/IOActive">IOActive Facebook</a></li>
<li><a href="https://www.ioactive.com">IOActive Inc</a></li>
<li><a href="https://ioactive.com/resources/blogs/">IOActive's previous blog site</a></li>
</ul>
<div class="clear"></div>
</div>
</div><div class="widget BlogSearch" data-version="1" id="BlogSearch1">
<h2 class="title">Search This Blog</h2>
<div class="widget-content">
<div id="BlogSearch1_form">
<form action="https://labs.ioactive.com/search" class="gsc-search-box" target="_top">
<table cellpadding="0" cellspacing="0" class="gsc-search-box">
<tbody>
<tr>
<td class="gsc-input">
<input autocomplete="off" class="gsc-input" name="q" size="10" title="search" type="text" value="">
</td>
<td class="gsc-search-button">
<input class="gsc-search-button" title="search" type="submit" value="Search">
</td>
</tr>
</tbody>
</table>
</form>
</div>
</div>
<div class="clear"></div>
</div><div class="widget BlogArchive" data-version="1" id="BlogArchive1">
<h2>Blog Archive</h2>
<div class="widget-content">
<div id="ArchiveList">
<div id="BlogArchive1_ArchiveList">
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://labs.ioactive.com/2024/">
2024
</a>
<span class="post-count" dir="ltr">(2)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://labs.ioactive.com/2024/02/">
February 2024
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://labs.ioactive.com/2024/01/">
January 2024
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://labs.ioactive.com/2023/">
2023
</a>
<span class="post-count" dir="ltr">(3)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://labs.ioactive.com/2023/06/">
June 2023
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://labs.ioactive.com/2023/02/">
February 2023
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://labs.ioactive.com/2022/">
2022
</a>
<span class="post-count" dir="ltr">(6)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://labs.ioactive.com/2022/11/">
November 2022
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://labs.ioactive.com/2022/09/">
September 2022
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://labs.ioactive.com/2022/04/">
April 2022
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://labs.ioactive.com/2022/03/">
March 2022
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://labs.ioactive.com/2022/02/">
February 2022
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://labs.ioactive.com/2022/01/">
January 2022
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate expanded">
<a class="toggle" href="javascript:void(0)">
<span class="zippy toggle-open">

        ▼&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://labs.ioactive.com/2021/">
2021
</a>
<span class="post-count" dir="ltr">(8)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://labs.ioactive.com/2021/12/">
December 2021
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate expanded">
<a class="toggle" href="javascript:void(0)">
<span class="zippy toggle-open">

        ▼&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://labs.ioactive.com/2021/07/">
July 2021
</a>
<span class="post-count" dir="ltr">(1)</span>
<ul class="posts">
<li><a href="https://labs.ioactive.com/2021/07/breaking-protocol-buffers-reverse.html">Breaking Protocol (Buffers): Reverse Engineering g...</a></li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://labs.ioactive.com/2021/04/">
April 2021
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://labs.ioactive.com/2021/02/">
February 2021
</a>
<span class="post-count" dir="ltr">(3)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://labs.ioactive.com/2021/01/">
January 2021
</a>
<span class="post-count" dir="ltr">(2)</span>
</li>
</ul>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://labs.ioactive.com/2020/">
2020
</a>
<span class="post-count" dir="ltr">(8)</span>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://labs.ioactive.com/2020/12/">
December 2020
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://labs.ioactive.com/2020/11/">
November 2020
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://labs.ioactive.com/2020/10/">
October 2020
</a>
<span class="post-count" dir="ltr">(1)</span>
</li>
</ul>
<ul class="hierarchy">
<li class="archivedate collapsed">
<a class="toggle" href="javascript:void(0)">
<span class="zippy">

        ►&nbsp;
      
</span>
</a>
<a class="post-count-link" href="https://labs.ioactive.com/2020/09/">
September 2020
</a>
<span class="post-count" dir="ltr">(5)</span>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="clear"></div>
</div>
</div><div class="widget PopularPosts" data-version="1" id="PopularPosts2">
<h2>Popular Posts</h2>
<div class="widget-content popular-posts">
<ul>
<li>
<div class="item-content">
<div class="item-thumbnail">
<a href="https://labs.ioactive.com/2021/02/a-practical-approach-to-attacking-iot.html" target="_blank">
<img alt="" border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj4rvHtmHYBxHlYg5MBhIezkkyr2unQMPAwzw_eEL_Gs6RUZZa5VP3gp-kFs-6YnIQmEW8LAbnPKy2xlKvpTRvrVo0VS3FazygB5bzwRkK5HAGi2IrCUJHBIoBLgTWczXy8aLseMASw40CN/w72-h72-p-k-no-nu/soc.png">
</a>
</div>
<div class="item-title"><a href="https://labs.ioactive.com/2021/02/a-practical-approach-to-attacking-iot.html">A Practical Approach To Attacking IoT Embedded Designs (I) </a></div>
<div class="item-snippet">by Ruben Santamarta    The booming IoT ecosystem has meant massive growth in the embedded systems market due to the high demand for connecte...</div>
</div>
<div style="clear: both;"></div>
</li>
<li>
<div class="item-content">
<div class="item-thumbnail">
<a href="https://labs.ioactive.com/2021/07/breaking-protocol-buffers-reverse.html" target="_blank">
<img alt="" border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh9E3nAC5KM9vLWMim3MUzvjPQ1BegmKO8UwDRTyxe8K8pnGGEYlyxPBlwpK3HPmbl67Vpt6ASLsjFVhoWR6SxrsOlu-9J-S47rRPCKknFyGyBfezttxAjP3f-Tul2Q4gZnjvN-9xejeqc/w72-h72-p-k-no-nu/RegisterService_xrefs.png">
</a>
</div>
<div class="item-title"><a href="https://labs.ioactive.com/2021/07/breaking-protocol-buffers-reverse.html">Breaking Protocol (Buffers): Reverse Engineering gRPC Binaries</a></div>
<div class="item-snippet">by Ethan Shackelford The Basics gRPC is an open-source RPC  framework from Google which leverages automatic code generation to allow  easy i...</div>
</div>
<div style="clear: both;"></div>
</li>
<li>
<div class="item-content">
<div class="item-thumbnail">
<a href="https://labs.ioactive.com/2021/02/a-practical-approach-to-attacking-iot_23.html" target="_blank">
<img alt="" border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgyOs69J6vluEvFlb_nZrI0SA8p38F2NRh4WrxYkB3UNJGMydH3RLd4r2BpNhLxwg0v75MO8ucMOCforYOt4iAIOLlwD53X6oSXnZu8aqOtNfxE4ySbS7pO3LrkZlmc0HsPoMk_GeO2Xm8D/w72-h72-p-k-no-nu/BLE_Header.png">
</a>
</div>
<div class="item-title"><a href="https://labs.ioactive.com/2021/02/a-practical-approach-to-attacking-iot_23.html">A Practical Approach to Attacking IoT Embedded Designs (II)</a></div>
<div class="item-snippet">by Ruben Santamarta    In this second and final blog post on this topic, we cover some OTA vulnerabilities we identified in wireless communi...</div>
</div>
<div style="clear: both;"></div>
</li>
<li>
<div class="item-content">
<div class="item-thumbnail">
<a href="https://labs.ioactive.com/2021/12/cracking-snapcode.html" target="_blank">
<img alt="" border="0" src="https://blogger.googleusercontent.com/img/a/AVvXsEjA2mQ0Ttgzu_tMzCyZTIyuu7A61qUEBLlKCFQAJ2QqRmbSXZRqxViejSGrwsREg7fARM-OOaJI5Gi5pSWQrq_RuEtkUcZmwGGeuskvwciOhxtmBtbEXoiZN-dCKT_Ac24hvweN0oFlieFakGday2T-OL33MpAmPlLVFagWFhp-b0CyEuTJTYzLPxvk=w72-h72-p-k-no-nu">
</a>
</div>
<div class="item-title"><a href="https://labs.ioactive.com/2021/12/cracking-snapcode.html">Cracking the Snapcode</a></div>
<div class="item-snippet">by Daniel Moder &nbsp; &nbsp; &nbsp;A Brief Introduction to Barcodes    	 	 	 	     	 	 	 	  Barcodes are used everywhere: trains, planes, passports, post ...</div>
</div>
<div style="clear: both;"></div>
</li>
<li>
<div class="item-content">
<div class="item-thumbnail">
<a href="https://labs.ioactive.com/2022/02/biometric-hacking-face-authentication.html" target="_blank">
<img alt="" border="0" src="https://blogger.googleusercontent.com/img/a/AVvXsEhL0acvIzrvzRzi5F-6P3AkrnkMzglpLR8lAe0CfTU34Sc5V4w_smz9e_yyKk6QaDguJpVb_ja9taeuSm3LZn_lBXta7YO_ikCdO8fe_695MvnsFjk48wSUZFLyi0wReFwo1bZyKjcNLaTpHUIwQb6l6asQmkho0ho1t7jaTh5EdyRPp7HvJfoh-mKf=w72-h72-p-k-no-nu">
</a>
</div>
<div class="item-title"><a href="https://labs.ioactive.com/2022/02/biometric-hacking-face-authentication.html">Biometric Hacking: Face Authentication Systems</a></div>
<div class="item-snippet">by Alejo Moles &amp; Gabriel Gonzalez In our Biometric Testing Facility, we have conducted a large number of security assessment of both 2D ...</div>
</div>
<div style="clear: both;"></div>
</li>
<li>
<div class="item-content">
<div class="item-title"><a href="https://labs.ioactive.com/2023/06/applying-fault-injection-to-firmware.html">Applying Fault Injection to the Firmware Update Process of a Drone</a></div>
<div class="item-snippet">IOActive recently published a whitepaper ( https://ioac.tv/3N005Bn ) covering the current security posture of the drone industry. IOActive h...</div>
</div>
<div style="clear: both;"></div>
</li>
<li>
<div class="item-content">
<div class="item-thumbnail">
<a href="https://labs.ioactive.com/2020/11/cve-2020-16877-exploiting-microsoft.html" target="_blank">
<img alt="" border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi2CSsOkYw7eWkbSGVbQVX3sG0k2yefBI3VOvMSsoXosnMgPR9q_Ql6ajGWdRhuMO7zeLVLFUNiWof9N3-gcXoNm3xhN9aTd8r3ZKRFSSfWODvSWqd_iaPLs-6SUZcTd5EifNvPmCRWh-IF/w72-h72-p-k-no-nu/1_windowsapps.png">
</a>
</div>
<div class="item-title"><a href="https://labs.ioactive.com/2020/11/cve-2020-16877-exploiting-microsoft.html">CVE-2020-16877: Exploiting Microsoft Store Games</a></div>
<div class="item-snippet">by Donato Ferrante      TL;DR   This blog post describes a privilege escalation issue in Windows ( CVE-2020-16877 ) I reported to Microsoft ...</div>
</div>
<div style="clear: both;"></div>
</li>
<li>
<div class="item-content">
<div class="item-thumbnail">
<a href="https://labs.ioactive.com/2023/02/adventures-in-platform-security.html" target="_blank">
<img alt="" border="0" src="https://lh5.googleusercontent.com/yUcTWsvUCCC0CoRl4wCNYZrap9PdC1-KsuXnVvBf8quJIQCw61aQcwNkG8QPAnMzDXdu4Qjow8QQ9j0RKDNrdn9o-egL5lQ4zaykIK2JHxY_3EL8b7sBiwP8Hws8DUmH7E8hhVhPxyFM7Ao3DZ1-p2o=w72-h72-p-k-no-nu">
</a>
</div>
<div class="item-title"><a href="https://labs.ioactive.com/2023/02/adventures-in-platform-security.html"> Adventures in the Platform Security Coordinated Disclosure Circus</a></div>
<div class="item-snippet">&nbsp; by&nbsp; Enrique Nissim ,&nbsp; Krzysztof Okupski &nbsp;and&nbsp; Joseph Tartaro Platform security is one of the specialized service lines IOActive offers and...</div>
</div>
<div style="clear: both;"></div>
</li>
<li>
<div class="item-content">
<div class="item-thumbnail">
<a href="https://labs.ioactive.com/2024/01/atm-security-owning-bitcoin-atm.html" target="_blank">
<img alt="" border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjMchttCEmVMETVXADcqx2Ti9hlCPepul0xg2x0aEFqtZAT5g8YiNGypKH6eEaRbqsBLMttqAuLAR7ADW0Lw7whkedcGl35yby_Qrut73U3aUDMBwYo0QArI7YCRW05w3tQ77GjLoN-VfRQ7jaN831KvqYWT3C7vaENuutFNHTxe-mJEW-pTL3vawIQbjg/w72-h72-p-k-no-nu/atm.jpg">
</a>
</div>
<div class="item-title"><a href="https://labs.ioactive.com/2024/01/atm-security-owning-bitcoin-atm.html">Owning a Bitcoin ATM</a></div>
<div class="item-snippet">&nbsp;by Antonio Requena, Gabriel Gonzalez and Sergio Ruiz. Nowadays, Bitcoin and cryptocurrencies might look lees popular than they did just a f...</div>
</div>
<div style="clear: both;"></div>
</li>
<li>
<div class="item-content">
<div class="item-thumbnail">
<a href="https://labs.ioactive.com/2020/10/a-journey-into-defeating-regulated.html" target="_blank">
<img alt="" border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi8sSedBBVfK4nyOC51cap5okm-cLmlBPvMfouVovpCKqKRL-Sqoehh-ii_IVQEbmhzH4itjYC3oSiX7wph69WMm-2zaBwsfNJ1p4Zv30MX4wKpHAxFQCpqumLPNW23SFAcwIl-4-rejxUd/w72-h72-p-k-no-nu/stats.jpg">
</a>
</div>
<div class="item-title"><a href="https://labs.ioactive.com/2020/10/a-journey-into-defeating-regulated.html">A journey into defeating regulated electronic cigarette protections</a></div>
<div class="item-snippet">By Ehab Hussein.  TL;DR: This blog post does not encourage smoking nor vaping. The main focus of this blog will be defeating the protections...</div>
</div>
<div style="clear: both;"></div>
</li>
</ul>
<div class="clear"></div>
</div>
</div><div class="widget PageList" data-version="1" id="PageList1">
<div class="widget-content">
<ul>
<li>
<a href="https://labs.ioactive.com/">Home</a>
</li>
</ul>
<div class="clear"></div>
</div>
</div>
</div>
</aside>
</div>
</div>
</div>
<div style="clear: both"></div>
<!-- columns -->
</div>
<!-- main -->
</div>
</div>
<div class="main-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<footer>
<div class="footer-outer">
<div class="footer-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left footer-fauxborder-left">
<div class="fauxborder-right footer-fauxborder-right"></div>
<div class="region-inner footer-inner">
<div class="foot no-items section" id="footer-1"></div>
<!-- outside of the include in order to lock Attribution widget -->
<div class="foot section" id="footer-3" name="Footer"><div class="widget Attribution" data-version="1" id="Attribution1">
<div class="widget-content" style="text-align: center;">
©2020 IOActive Inc. All Rights Reserved. Simple theme. Powered by <a href="https://www.blogger.com" target="_blank">Blogger</a>.
</div>
<div class="clear"></div>
</div></div>
</div>
</div>
<div class="footer-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</footer>
<!-- content -->
</div>
</div>
<div class="content-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</div>
<script type="text/javascript">
    window.setTimeout(function() {
        document.body.className = document.body.className.replace('loading', '');
      }, 10);
  </script>
<!--To Ty odpowiadasz za poinformowanie u\u017cytkownik\xf3w o\xa0u\u017cywaniu plik\xf3w cookie i\xa0zbieraniu danych na blogu. Blogger udost\u0119pnia standardowe powiadomienie, kt\xf3rego mo\u017cesz u\u017cywa\u0107 na swoim blogu. Mo\u017cesz je dostosowa\u0107 do swoich potrzeb lub zast\u0105pi\u0107 w\u0142asnym. Tu znajdziesz wi\u0119cej informacji: http://www.blogger.com/go/cookiechoices.-->
<script defer="" src="/js/cookienotice.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function(event) {
      window.cookieChoices && cookieChoices.showCookieConsentBar && cookieChoices.showCookieConsentBar(
          (window.cookieOptions && cookieOptions.msg) || 'W\xa0tej witrynie s\u0105 wykorzystywane pliki cookie, kt\xf3rych Google u\u017cywa do \u015bwiadczenia swoich us\u0142ug i\xa0analizowania ruchu. Tw\xf3j adres\xa0IP i\xa0nazwa klienta u\u017cytkownika oraz dane dotycz\u0105ce wydajno\u015bci i\xa0bezpiecze\u0144stwa s\u0105 udost\u0119pniane firmie Google, by zapewni\u0107 odpowiedni\u0105 jako\u015b\u0107 us\u0142ug, generowa\u0107 statystyki u\u017cytkowania oraz wykrywa\u0107 nadu\u017cycia i\xa0na nie reagowa\u0107.',
          (window.cookieOptions && cookieOptions.close) || 'Rozumiem',
          (window.cookieOptions && cookieOptions.learn) || 'Dowiedz si\u0119 wi\u0119cej',
          (window.cookieOptions && cookieOptions.link) || 'https://www.blogger.com/go/blogspot-cookies');
    });
  </script>

<script type="text/javascript" src="https://www.blogger.com/static/v1/widgets/922809059-widgets.js"></script>
<script type="text/javascript">
window['__wavt'] = 'AOuZoY4izEvaNUvFh9zMN5TG3QQhLuey1Q:1718445145319';_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d2165778380262691600','//labs.ioactive.com/2021/07/breaking-protocol-buffers-reverse.html','2165778380262691600');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '2165778380262691600', 'title': 'IOActive Labs', 'url': 'https://labs.ioactive.com/2021/07/breaking-protocol-buffers-reverse.html', 'canonicalUrl': 'https://labs.ioactive.com/2021/07/breaking-protocol-buffers-reverse.html', 'homepageUrl': 'https://labs.ioactive.com/', 'searchUrl': 'https://labs.ioactive.com/search', 'canonicalHomepageUrl': 'https://labs.ioactive.com/', 'blogspotFaviconUrl': 'https://labs.ioactive.com/favicon.ico', 'bloggerUrl': 'https://www.blogger.com', 'hasCustomDomain': true, 'httpsEnabled': true, 'enabledCommentProfileImages': true, 'gPlusViewType': 'FILTERED_POSTMOD', 'adultContent': false, 'analyticsAccountNumber': '', 'encoding': 'UTF-8', 'locale': 'en', 'localeUnderscoreDelimited': 'en', 'languageDirection': 'ltr', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'isDynamicViewsAvailable': true, 'feedLinks': '\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22IOActive Labs - Atom\x22 href\x3d\x22https://labs.ioactive.com/feeds/posts/default\x22 /\x3e\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/rss+xml\x22 title\x3d\x22IOActive Labs - RSS\x22 href\x3d\x22https://labs.ioactive.com/feeds/posts/default?alt\x3drss\x22 /\x3e\n\x3clink rel\x3d\x22service.post\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22IOActive Labs - Atom\x22 href\x3d\x22https://www.blogger.com/feeds/2165778380262691600/posts/default\x22 /\x3e\n\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22IOActive Labs - Atom\x22 href\x3d\x22https://labs.ioactive.com/feeds/4469446424408015238/comments/default\x22 /\x3e\n', 'meTag': '', 'adsenseHostId': 'ca-host-pub-1556223355139109', 'adsenseHasAds': false, 'adsenseAutoAds': false, 'boqCommentIframeForm': true, 'loginRedirectParam': '', 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/1156f5042d12a8cd', 'plusOneApiSrc': 'https://apis.google.com/js/platform.js', 'disableGComments': true, 'interstitialAccepted': false, 'sharing': {'platforms': [{'name': 'Get link', 'key': 'link', 'shareMessage': 'Get link', 'target': ''}, {'name': 'Facebook', 'key': 'facebook', 'shareMessage': 'Share to Facebook', 'target': 'facebook'}, {'name': 'BlogThis!', 'key': 'blogThis', 'shareMessage': 'BlogThis!', 'target': 'blog'}, {'name': 'Twitter', 'key': 'twitter', 'shareMessage': 'Share to Twitter', 'target': 'twitter'}, {'name': 'Pinterest', 'key': 'pinterest', 'shareMessage': 'Share to Pinterest', 'target': 'pinterest'}, {'name': 'Email', 'key': 'email', 'shareMessage': 'Email', 'target': 'email'}], 'disableGooglePlus': true, 'googlePlusShareButtonWidth': 0, 'googlePlusBootstrap': '\x3cscript type\x3d\x22text/javascript\x22\x3ewindow.___gcfg \x3d {\x27lang\x27: \x27en\x27};\x3c/script\x3e'}, 'hasCustomJumpLinkMessage': false, 'jumpLinkMessage': 'Read more', 'pageType': 'item', 'postId': '4469446424408015238', 'postImageThumbnailUrl': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh9E3nAC5KM9vLWMim3MUzvjPQ1BegmKO8UwDRTyxe8K8pnGGEYlyxPBlwpK3HPmbl67Vpt6ASLsjFVhoWR6SxrsOlu-9J-S47rRPCKknFyGyBfezttxAjP3f-Tul2Q4gZnjvN-9xejeqc/s72-w617-c-h73/RegisterService_xrefs.png', 'postImageUrl': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh9E3nAC5KM9vLWMim3MUzvjPQ1BegmKO8UwDRTyxe8K8pnGGEYlyxPBlwpK3HPmbl67Vpt6ASLsjFVhoWR6SxrsOlu-9J-S47rRPCKknFyGyBfezttxAjP3f-Tul2Q4gZnjvN-9xejeqc/w617-h73/RegisterService_xrefs.png', 'pageName': 'Breaking Protocol (Buffers): Reverse Engineering gRPC Binaries', 'pageTitle': 'IOActive Labs: Breaking Protocol (Buffers): Reverse Engineering gRPC Binaries'}}, {'name': 'features', 'data': {}}, {'name': 'messages', 'data': {'edit': 'Edit', 'linkCopiedToClipboard': 'Link copied to clipboard!', 'ok': 'Ok', 'postLink': 'Post Link'}}, {'name': 'template', 'data': {'name': 'Simple', 'localizedName': 'Simple', 'isResponsive': false, 'isAlternateRendering': false, 'isCustom': false, 'variant': 'simplysimple', 'variantId': 'simplysimple'}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\x3dclassic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\x3dflipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\x3dmagazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\x3dmosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\x3dsidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\x3dsnapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\x3dtimeslide'}, 'isMobile': false, 'title': 'Breaking Protocol (Buffers): Reverse Engineering gRPC Binaries', 'description': 'by Ethan Shackelford The Basics gRPC is an open-source RPC  framework from Google which leverages automatic code generation to allow  easy i...', 'featuredImage': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh9E3nAC5KM9vLWMim3MUzvjPQ1BegmKO8UwDRTyxe8K8pnGGEYlyxPBlwpK3HPmbl67Vpt6ASLsjFVhoWR6SxrsOlu-9J-S47rRPCKknFyGyBfezttxAjP3f-Tul2Q4gZnjvN-9xejeqc/w617-h73/RegisterService_xrefs.png', 'url': 'https://labs.ioactive.com/2021/07/breaking-protocol-buffers-reverse.html', 'type': 'item', 'isSingleItem': true, 'isMultipleItems': false, 'isError': false, 'isPage': false, 'isPost': true, 'isHomepage': false, 'isArchive': false, 'isLabelSearch': false, 'postId': 4469446424408015238}}]);
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'lightboxEnabled': true, 'lightboxModuleUrl': 'https://www.blogger.com/static/v1/jsbin/630159536-lbx.js', 'lightboxCssUrl': 'https://www.blogger.com/static/v1/v-css/13464135-lightbox_bundle.css'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_ImageView', new _WidgetInfo('Image1', 'sidebar-right-1', document.getElementById('Image1'), {'resize': true}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_LinkListView', new _WidgetInfo('LinkList1', 'sidebar-right-1', document.getElementById('LinkList1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogSearchView', new _WidgetInfo('BlogSearch1', 'sidebar-right-1', document.getElementById('BlogSearch1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive1', 'sidebar-right-1', document.getElementById('BlogArchive1'), {'languageDirection': 'ltr', 'loadingMessage': 'Loading\x26hellip;'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_PopularPostsView', new _WidgetInfo('PopularPosts2', 'sidebar-right-1', document.getElementById('PopularPosts2'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_PageListView', new _WidgetInfo('PageList1', 'sidebar-right-1', document.getElementById('PageList1'), {'title': '', 'links': [{'isCurrentPage': false, 'href': 'https://labs.ioactive.com/', 'title': 'Home'}], 'mobile': false, 'showPlaceholder': true, 'hasCurrentPage': false}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_AttributionView', new _WidgetInfo('Attribution1', 'footer-3', document.getElementById('Attribution1'), {}, 'displayModeFull'));
</script>

<div id="cookieChoiceInfo" class="cookie-choices-info singleton-element"><div class="cookie-choices-inner"><span class="cookie-choices-text">W&nbsp;tej witrynie są wykorzystywane pliki cookie, których Google używa do świadczenia swoich usług i&nbsp;analizowania ruchu. Twój adres&nbsp;IP i&nbsp;nazwa klienta użytkownika oraz dane dotyczące wydajności i&nbsp;bezpieczeństwa są udostępniane firmie Google, by zapewnić odpowiednią jakość usług, generować statystyki użytkowania oraz wykrywać nadużycia i&nbsp;na nie reagować.</span><span class="cookie-choices-buttons"><a href="https://www.blogger.com/go/blogspot-cookies" target="_blank" class="cookie-choices-button">Dowiedz się więcej</a><a id="cookieChoiceDismiss" href="#" class="cookie-choices-button">Rozumiem</a></span></div></div><link type="text/css" rel="stylesheet" href="https://www.blogger.com/static/v1/v-css/13464135-lightbox_bundle.css"><script type="text/javascript" src="https://www.blogger.com/static/v1/jsbin/630159536-lbx.js"></script></body></html>