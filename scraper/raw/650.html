<html lang="en" class="wf-roboto-i4-active wf-roboto-n4-active wf-lato-n7-active wf-roboto-n7-active wf-roboto-i7-active wf-active"><head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://securitycafe.ro/xmlrpc.php">

<title>A Complete Kubernetes Config Review Methodology – Security Café</title>
<script src="https://s0.wp.com/wp-content/plugins/custom-fonts/js/webfont.js" type="text/javascript" async=""></script><script type="text/javascript">
  WebFontConfig = {"google":{"families":["Lato:b:latin,latin-ext","Roboto:r,i,b,bi:latin,latin-ext"]},"api_url":"https:\/\/fonts-api.wp.com\/css"};
  (function() {
    var wf = document.createElement('script');
    wf.src = 'https://s0.wp.com/wp-content/plugins/custom-fonts/js/webfont.js';
    wf.type = 'text/javascript';
    wf.async = 'true';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wf, s);
	})();
</script><style id="jetpack-custom-fonts-css">.wf-active code, .wf-active kbd, .wf-active pre, .wf-active samp{font-family:"Roboto",sans-serif}.wf-active body, .wf-active button, .wf-active input, .wf-active select, .wf-active textarea{font-family:"Roboto",sans-serif}.wf-active pre{font-family:"Roboto",sans-serif}.wf-active code, .wf-active kbd, .wf-active tt, .wf-active var{font-family:"Roboto",sans-serif}.wf-active .main-navigation-menu a{font-family:"Roboto",sans-serif}.wf-active .top-navigation-menu a{font-family:"Roboto",sans-serif}.wf-active .footer-navigation-menu a{font-family:"Roboto",sans-serif}@media (max-width: 60em){.wf-active .main-navigation-toggle{font-family:"Roboto",sans-serif}}.wf-active h1{font-size:1.4em;font-style:normal;font-weight:700}.wf-active .site-title{font-family:"Lato",sans-serif;font-size:25.2px;font-weight:700;font-style:normal}.wf-active .site-description{font-size:15.4px;font-family:"Lato",sans-serif;font-style:normal;font-weight:700}.wf-active .widget-title{font-family:"Lato",sans-serif;font-size:14px;font-weight:700;font-style:normal}.wf-active .archive-title, .wf-active .entry-title, .wf-active .page-title{font-family:"Lato",sans-serif;font-size:19.6px;font-weight:700;font-style:normal}.wf-active .post-layout-columns .post-wrapper .post-column article .entry-title{font-size:15.4px;font-style:normal;font-weight:700}.wf-active .comment-reply-title span, .wf-active .comments-header .comments-title{font-family:"Lato",sans-serif;font-size:14px;font-weight:700;font-style:normal}@media (max-width: 80em){.wf-active .site-description{font-size:14px;font-style:normal;font-weight:700}}@media (max-width: 70em){.wf-active .post-layout-columns .post-wrapper .post-column article .entry-title{font-size:14px;font-style:normal;font-weight:700}}@media (max-width: 60em){.wf-active .site-description{font-size:12.6px;font-style:normal;font-weight:700}}@media (max-width: 60em){.wf-active .archive-title, .wf-active .entry-title, .wf-active .page-title{font-size:18.2px;font-style:normal;font-weight:700}}@media (max-width: 60em){.wf-active .post-layout-columns .post-wrapper .post-column article .entry-title{font-size:15.4px;font-style:normal;font-weight:700}}</style>
<meta name="robots" content="max-image-preview:large">
<meta name="google-site-verification" content="WR9DMwLp2vvnoeElDrf6Sh33hLEGi20JRuaX-Ud5c5c">

<!-- Async WordPress.com Remote Login -->
<script id="wpcom_remote_login_js">
var wpcom_remote_login_extra_auth = '';
function wpcom_remote_login_remove_dom_node_id( element_id ) {
	var dom_node = document.getElementById( element_id );
	if ( dom_node ) { dom_node.parentNode.removeChild( dom_node ); }
}
function wpcom_remote_login_remove_dom_node_classes( class_name ) {
	var dom_nodes = document.querySelectorAll( '.' + class_name );
	for ( var i = 0; i < dom_nodes.length; i++ ) {
		dom_nodes[ i ].parentNode.removeChild( dom_nodes[ i ] );
	}
}
function wpcom_remote_login_final_cleanup() {
	wpcom_remote_login_remove_dom_node_classes( "wpcom_remote_login_msg" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_remote_login_key" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_remote_login_validate" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_remote_login_js" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_request_access_iframe" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_request_access_styles" );
}

// Watch for messages back from the remote login
window.addEventListener( "message", function( e ) {
	if ( e.origin === "https://r-login.wordpress.com" ) {
		var data = {};
		try {
			data = JSON.parse( e.data );
		} catch( e ) {
			wpcom_remote_login_final_cleanup();
			return;
		}

		if ( data.msg === 'LOGIN' ) {
			// Clean up the login check iframe
			wpcom_remote_login_remove_dom_node_id( "wpcom_remote_login_key" );

			var id_regex = new RegExp( /^[0-9]+$/ );
			var token_regex = new RegExp( /^.*|.*|.*$/ );
			if (
				token_regex.test( data.token )
				&& id_regex.test( data.wpcomid )
			) {
				// We have everything we need to ask for a login
				var script = document.createElement( "script" );
				script.setAttribute( "id", "wpcom_remote_login_validate" );
				script.src = '/remote-login.php?wpcom_remote_login=validate'
					+ '&wpcomid=' + data.wpcomid
					+ '&token=' + encodeURIComponent( data.token )
					+ '&host=' + window.location.protocol
					+ '//' + window.location.hostname
					+ '&postid=2905'
					+ '&is_singular=1';
				document.body.appendChild( script );
			}

			return;
		}

		// Safari ITP, not logged in, so redirect
		if ( data.msg === 'LOGIN-REDIRECT' ) {
			window.location = 'https://wordpress.com/log-in?redirect_to=' + window.location.href;
			return;
		}

		// Safari ITP, storage access failed, remove the request
		if ( data.msg === 'LOGIN-REMOVE' ) {
			var css_zap = 'html { -webkit-transition: margin-top 1s; transition: margin-top 1s; } /* 9001 */ html { margin-top: 0 !important; } * html body { margin-top: 0 !important; } @media screen and ( max-width: 782px ) { html { margin-top: 0 !important; } * html body { margin-top: 0 !important; } }';
			var style_zap = document.createElement( 'style' );
			style_zap.type = 'text/css';
			style_zap.appendChild( document.createTextNode( css_zap ) );
			document.body.appendChild( style_zap );

			var e = document.getElementById( 'wpcom_request_access_iframe' );
			e.parentNode.removeChild( e );

			document.cookie = 'wordpress_com_login_access=denied; path=/; max-age=31536000';

			return;
		}

		// Safari ITP
		if ( data.msg === 'REQUEST_ACCESS' ) {
			console.log( 'request access: safari' );

			// Check ITP iframe enable/disable knob
			if ( wpcom_remote_login_extra_auth !== 'safari_itp_iframe' ) {
				return;
			}

			// If we are in a "private window" there is no ITP.
			var private_window = false;
			try {
				var opendb = window.openDatabase( null, null, null, null );
			} catch( e ) {
				private_window = true;
			}

			if ( private_window ) {
				console.log( 'private window' );
				return;
			}

			var iframe = document.createElement( 'iframe' );
			iframe.id = 'wpcom_request_access_iframe';
			iframe.setAttribute( 'scrolling', 'no' );
			iframe.setAttribute( 'sandbox', 'allow-storage-access-by-user-activation allow-scripts allow-same-origin allow-top-navigation-by-user-activation' );
			iframe.src = 'https://r-login.wordpress.com/remote-login.php?wpcom_remote_login=request_access&origin=' + encodeURIComponent( data.origin ) + '&wpcomid=' + encodeURIComponent( data.wpcomid );

			var css = 'html { -webkit-transition: margin-top 1s; transition: margin-top 1s; } /* 9001 */ html { margin-top: 46px !important; } * html body { margin-top: 46px !important; } @media screen and ( max-width: 660px ) { html { margin-top: 71px !important; } * html body { margin-top: 71px !important; } #wpcom_request_access_iframe { display: block; height: 71px !important; } } #wpcom_request_access_iframe { border: 0px; height: 46px; position: fixed; top: 0; left: 0; width: 100%; min-width: 100%; z-index: 99999; background: #23282d; } ';

			var style = document.createElement( 'style' );
			style.type = 'text/css';
			style.id = 'wpcom_request_access_styles';
			style.appendChild( document.createTextNode( css ) );
			document.body.appendChild( style );

			document.body.appendChild( iframe );
		}

		if ( data.msg === 'DONE' ) {
			wpcom_remote_login_final_cleanup();
		}
	}
}, false );

// Inject the remote login iframe after the page has had a chance to load
// more critical resources
window.addEventListener( "DOMContentLoaded", function( e ) {
	var iframe = document.createElement( "iframe" );
	iframe.style.display = "none";
	iframe.setAttribute( "scrolling", "no" );
	iframe.setAttribute( "id", "wpcom_remote_login_key" );
	iframe.src = "https://r-login.wordpress.com/remote-login.php"
		+ "?wpcom_remote_login=key"
		+ "&origin=aHR0cHM6Ly9zZWN1cml0eWNhZmUucm8%3D"
		+ "&wpcomid=78950108"
		+ "&time=1718351017";
	document.body.appendChild( iframe );
}, false );
</script>
<link rel="dns-prefetch" href="//s0.wp.com">
<link rel="dns-prefetch" href="//widgets.wp.com">
<link rel="dns-prefetch" href="//wordpress.com">
<link rel="alternate" type="application/rss+xml" title="Security Café » Feed" href="https://securitycafe.ro/feed/">
<link rel="alternate" type="application/rss+xml" title="Security Café » Comments Feed" href="https://securitycafe.ro/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Security Café » A Complete Kubernetes Config Review Methodology Comments Feed" href="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/feed/">
	<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
	<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s0.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1710334132i&ver=6.6-beta2-58393"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link crossorigin="anonymous" rel="stylesheet" id="all-css-0-1" href="https://s0.wp.com/_static/??-eJxtzFsKgCAQQNENZaMg+BWtRXQI39KMtP0ogiD6PHC5cHThWmWsDGWInscWKkFE7talx0CjQml+ZCTYMVtGL3oj/mh2RBP8H3NI+H5vXflaFmWU0VJLo+MJKT40cA==&amp;cssminify=yes" type="text/css" media="all">
<style id="wp-emoji-styles-inline-css">

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link crossorigin="anonymous" rel="stylesheet" id="all-css-2-1" href="https://s0.wp.com/wp-content/plugins/gutenberg-core/v18.4.1/build/block-library/style.css?m=1716578158i&amp;cssminify=yes" type="text/css" media="all">
<style id="wp-block-library-inline-css">
.has-text-align-justify {
	text-align:justify;
}
.wp-block-cover__image-background.has-parallax {
	background-size: cover;
}
.has-text-align-justify{text-align:justify;}
</style>
<link crossorigin="anonymous" rel="stylesheet" id="all-css-4-1" href="https://s0.wp.com/_static/??-eJzTLy/QzcxLzilNSS3WzyrWz01NyUxMzUnNTc0rQeEU5CRWphbp5qSmJyZX6uVm5uklFxfr6OPTDpRD5sM02efaGpoZmFkYGRuZGmQBAHPvL0Y=&amp;cssminify=yes" type="text/css" media="all">
<style id="jetpack-sharing-buttons-style-inline-css">
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<link crossorigin="anonymous" rel="stylesheet" id="all-css-6-1" href="https://s0.wp.com/_static/??-eJyVjEEOwiAQAD/ksgGN4sH4Fko3hJYCYZea/r49mF6Nx0lmBj8VfMlCWbCmHmJmDP3AgVqAIRU/M04k1fkZkttKFwgtjsiyJVKe+YL/LJqTmAP/yH35ZkZpqzRwXGoiaLSqG46R5TTgHL2Xl75bba/GPB/TDthVT3U=&amp;cssminify=yes" type="text/css" media="all">
<style id="classic-theme-styles-inline-css">
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<link crossorigin="anonymous" rel="stylesheet" id="all-css-8-1" href="https://s0.wp.com/_static/??/wp-content/mu-plugins/core-compat/wp-mediaelement.css,/wp-content/mu-plugins/wpcom-bbpress-premium-themes.css?m=1432920480j&amp;cssminify=yes" type="text/css" media="all">
<style id="global-styles-inline-css">
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--primary: #dd5533;--wp--preset--color--secondary: #c43c1a;--wp--preset--color--accent: #22aadd;--wp--preset--color--highlight: #67bf96;--wp--preset--color--light-gray: #dddddd;--wp--preset--color--gray: #808080;--wp--preset--color--dark-gray: #303030;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-size--huge: 36px;--wp--preset--font-family--albert-sans: 'Albert Sans', sans-serif;--wp--preset--font-family--alegreya: Alegreya, serif;--wp--preset--font-family--arvo: Arvo, serif;--wp--preset--font-family--bodoni-moda: 'Bodoni Moda', serif;--wp--preset--font-family--bricolage-grotesque: 'Bricolage Grotesque', sans-serif;--wp--preset--font-family--cabin: Cabin, sans-serif;--wp--preset--font-family--chivo: Chivo, sans-serif;--wp--preset--font-family--commissioner: Commissioner, sans-serif;--wp--preset--font-family--cormorant: Cormorant, serif;--wp--preset--font-family--courier-prime: 'Courier Prime', monospace;--wp--preset--font-family--crimson-pro: 'Crimson Pro', serif;--wp--preset--font-family--dm-mono: 'DM Mono', monospace;--wp--preset--font-family--dm-sans: 'DM Sans', sans-serif;--wp--preset--font-family--dm-serif-display: 'DM Serif Display', serif;--wp--preset--font-family--domine: Domine, serif;--wp--preset--font-family--eb-garamond: 'EB Garamond', serif;--wp--preset--font-family--epilogue: Epilogue, sans-serif;--wp--preset--font-family--fahkwang: Fahkwang, sans-serif;--wp--preset--font-family--figtree: Figtree, sans-serif;--wp--preset--font-family--fira-sans: 'Fira Sans', sans-serif;--wp--preset--font-family--fjalla-one: 'Fjalla One', sans-serif;--wp--preset--font-family--fraunces: Fraunces, serif;--wp--preset--font-family--gabarito: Gabarito, system-ui;--wp--preset--font-family--ibm-plex-mono: 'IBM Plex Mono', monospace;--wp--preset--font-family--ibm-plex-sans: 'IBM Plex Sans', sans-serif;--wp--preset--font-family--ibarra-real-nova: 'Ibarra Real Nova', serif;--wp--preset--font-family--instrument-serif: 'Instrument Serif', serif;--wp--preset--font-family--inter: Inter, sans-serif;--wp--preset--font-family--josefin-sans: 'Josefin Sans', sans-serif;--wp--preset--font-family--jost: Jost, sans-serif;--wp--preset--font-family--libre-baskerville: 'Libre Baskerville', serif;--wp--preset--font-family--libre-franklin: 'Libre Franklin', sans-serif;--wp--preset--font-family--literata: Literata, serif;--wp--preset--font-family--lora: Lora, serif;--wp--preset--font-family--merriweather: Merriweather, serif;--wp--preset--font-family--montserrat: Montserrat, sans-serif;--wp--preset--font-family--newsreader: Newsreader, serif;--wp--preset--font-family--noto-sans-mono: 'Noto Sans Mono', sans-serif;--wp--preset--font-family--nunito: Nunito, sans-serif;--wp--preset--font-family--open-sans: 'Open Sans', sans-serif;--wp--preset--font-family--overpass: Overpass, sans-serif;--wp--preset--font-family--pt-serif: 'PT Serif', serif;--wp--preset--font-family--petrona: Petrona, serif;--wp--preset--font-family--piazzolla: Piazzolla, serif;--wp--preset--font-family--playfair-display: 'Playfair Display', serif;--wp--preset--font-family--plus-jakarta-sans: 'Plus Jakarta Sans', sans-serif;--wp--preset--font-family--poppins: Poppins, sans-serif;--wp--preset--font-family--raleway: Raleway, sans-serif;--wp--preset--font-family--roboto: Roboto, sans-serif;--wp--preset--font-family--roboto-slab: 'Roboto Slab', serif;--wp--preset--font-family--rubik: Rubik, sans-serif;--wp--preset--font-family--rufina: Rufina, serif;--wp--preset--font-family--sora: Sora, sans-serif;--wp--preset--font-family--source-sans-3: 'Source Sans 3', sans-serif;--wp--preset--font-family--source-serif-4: 'Source Serif 4', serif;--wp--preset--font-family--space-mono: 'Space Mono', monospace;--wp--preset--font-family--syne: Syne, sans-serif;--wp--preset--font-family--texturina: Texturina, serif;--wp--preset--font-family--urbanist: Urbanist, sans-serif;--wp--preset--font-family--work-sans: 'Work Sans', sans-serif;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}.has-albert-sans-font-family{font-family: var(--wp--preset--font-family--albert-sans) !important;}.has-alegreya-font-family{font-family: var(--wp--preset--font-family--alegreya) !important;}.has-arvo-font-family{font-family: var(--wp--preset--font-family--arvo) !important;}.has-bodoni-moda-font-family{font-family: var(--wp--preset--font-family--bodoni-moda) !important;}.has-bricolage-grotesque-font-family{font-family: var(--wp--preset--font-family--bricolage-grotesque) !important;}.has-cabin-font-family{font-family: var(--wp--preset--font-family--cabin) !important;}.has-chivo-font-family{font-family: var(--wp--preset--font-family--chivo) !important;}.has-commissioner-font-family{font-family: var(--wp--preset--font-family--commissioner) !important;}.has-cormorant-font-family{font-family: var(--wp--preset--font-family--cormorant) !important;}.has-courier-prime-font-family{font-family: var(--wp--preset--font-family--courier-prime) !important;}.has-crimson-pro-font-family{font-family: var(--wp--preset--font-family--crimson-pro) !important;}.has-dm-mono-font-family{font-family: var(--wp--preset--font-family--dm-mono) !important;}.has-dm-sans-font-family{font-family: var(--wp--preset--font-family--dm-sans) !important;}.has-dm-serif-display-font-family{font-family: var(--wp--preset--font-family--dm-serif-display) !important;}.has-domine-font-family{font-family: var(--wp--preset--font-family--domine) !important;}.has-eb-garamond-font-family{font-family: var(--wp--preset--font-family--eb-garamond) !important;}.has-epilogue-font-family{font-family: var(--wp--preset--font-family--epilogue) !important;}.has-fahkwang-font-family{font-family: var(--wp--preset--font-family--fahkwang) !important;}.has-figtree-font-family{font-family: var(--wp--preset--font-family--figtree) !important;}.has-fira-sans-font-family{font-family: var(--wp--preset--font-family--fira-sans) !important;}.has-fjalla-one-font-family{font-family: var(--wp--preset--font-family--fjalla-one) !important;}.has-fraunces-font-family{font-family: var(--wp--preset--font-family--fraunces) !important;}.has-gabarito-font-family{font-family: var(--wp--preset--font-family--gabarito) !important;}.has-ibm-plex-mono-font-family{font-family: var(--wp--preset--font-family--ibm-plex-mono) !important;}.has-ibm-plex-sans-font-family{font-family: var(--wp--preset--font-family--ibm-plex-sans) !important;}.has-ibarra-real-nova-font-family{font-family: var(--wp--preset--font-family--ibarra-real-nova) !important;}.has-instrument-serif-font-family{font-family: var(--wp--preset--font-family--instrument-serif) !important;}.has-inter-font-family{font-family: var(--wp--preset--font-family--inter) !important;}.has-josefin-sans-font-family{font-family: var(--wp--preset--font-family--josefin-sans) !important;}.has-jost-font-family{font-family: var(--wp--preset--font-family--jost) !important;}.has-libre-baskerville-font-family{font-family: var(--wp--preset--font-family--libre-baskerville) !important;}.has-libre-franklin-font-family{font-family: var(--wp--preset--font-family--libre-franklin) !important;}.has-literata-font-family{font-family: var(--wp--preset--font-family--literata) !important;}.has-lora-font-family{font-family: var(--wp--preset--font-family--lora) !important;}.has-merriweather-font-family{font-family: var(--wp--preset--font-family--merriweather) !important;}.has-montserrat-font-family{font-family: var(--wp--preset--font-family--montserrat) !important;}.has-newsreader-font-family{font-family: var(--wp--preset--font-family--newsreader) !important;}.has-noto-sans-mono-font-family{font-family: var(--wp--preset--font-family--noto-sans-mono) !important;}.has-nunito-font-family{font-family: var(--wp--preset--font-family--nunito) !important;}.has-open-sans-font-family{font-family: var(--wp--preset--font-family--open-sans) !important;}.has-overpass-font-family{font-family: var(--wp--preset--font-family--overpass) !important;}.has-pt-serif-font-family{font-family: var(--wp--preset--font-family--pt-serif) !important;}.has-petrona-font-family{font-family: var(--wp--preset--font-family--petrona) !important;}.has-piazzolla-font-family{font-family: var(--wp--preset--font-family--piazzolla) !important;}.has-playfair-display-font-family{font-family: var(--wp--preset--font-family--playfair-display) !important;}.has-plus-jakarta-sans-font-family{font-family: var(--wp--preset--font-family--plus-jakarta-sans) !important;}.has-poppins-font-family{font-family: var(--wp--preset--font-family--poppins) !important;}.has-raleway-font-family{font-family: var(--wp--preset--font-family--raleway) !important;}.has-roboto-font-family{font-family: var(--wp--preset--font-family--roboto) !important;}.has-roboto-slab-font-family{font-family: var(--wp--preset--font-family--roboto-slab) !important;}.has-rubik-font-family{font-family: var(--wp--preset--font-family--rubik) !important;}.has-rufina-font-family{font-family: var(--wp--preset--font-family--rufina) !important;}.has-sora-font-family{font-family: var(--wp--preset--font-family--sora) !important;}.has-source-sans-3-font-family{font-family: var(--wp--preset--font-family--source-sans-3) !important;}.has-source-serif-4-font-family{font-family: var(--wp--preset--font-family--source-serif-4) !important;}.has-space-mono-font-family{font-family: var(--wp--preset--font-family--space-mono) !important;}.has-syne-font-family{font-family: var(--wp--preset--font-family--syne) !important;}.has-texturina-font-family{font-family: var(--wp--preset--font-family--texturina) !important;}.has-urbanist-font-family{font-family: var(--wp--preset--font-family--urbanist) !important;}.has-work-sans-font-family{font-family: var(--wp--preset--font-family--work-sans) !important;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
</style>
<link crossorigin="anonymous" rel="stylesheet" id="all-css-10-1" href="https://s0.wp.com/wp-content/mu-plugins/jetpack-mu-wpcom-plugin/sun/vendor/automattic/jetpack-mu-wpcom/src/build/verbum-comments/verbum-comments.css?m=1709133875i&amp;cssminify=yes" type="text/css" media="all">
<link rel="stylesheet" id="verbum-gutenberg-css-css" href="https://widgets.wp.com/verbum-block-editor/block-editor.css?ver=1717067639" media="all">
<link crossorigin="anonymous" rel="stylesheet" id="all-css-12-1" href="https://s0.wp.com/_static/??-eJyVUMsOwjAM+yFKtgOIC+JT0OhCCWubqk018feEh3gLxM12YscKjMlYjoJRIFSTfHUUC1gOQSXjaUBl5UWZqjIBgshC6i43cBk8ZMoOgyakjIFqAOEs1XVQ5ODxbfmhwB4ldXa4cig1wpqiBYcR8+XmR/hnZuC+eu03Uu9QivZLJnFR9LOhQzaebSfE8YmYre8of7Nm3Hh2Ct35tXd6Mq3Csp0vZm07a+bN/gh/Qp0n&amp;cssminify=yes" type="text/css" media="all">
<style id="jetpack-global-styles-frontend-style-inline-css">
:root { --font-headings: unset; --font-base: unset; --font-headings-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif; --font-base-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;}
</style>
<link crossorigin="anonymous" rel="stylesheet" id="all-css-14-1" href="https://s0.wp.com/_static/??-eJyNjcsKQjEMBX/ImlsQry7ET5GahrbXNCmmRfx7H7gRN+7OwGEGbs2hSifpUIdrPFIRg4V6C3j5MNgQqBoHk4HlcKUYYry/Z5G0RrMV/C06FUEwxRLYsSa1L/iR9Uz1mc0bSKznwK/DsR787Kd5P/ntbnkAuNBIYA==&amp;cssminify=yes" type="text/css" media="all">
<link rel="stylesheet" href="https://fonts-api.wp.com/css?family=Lato:b%7CRoboto:r,i,b,bi&amp;subset=latin,latin-ext,latin,latin-ext" media="all"><script type="text/javascript" id="jetpack_related-posts-js-extra">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="text/javascript" id="tortuga-jquery-navigation-js-extra">
/* <![CDATA[ */
var tortuga_menu_title = "Menu";
/* ]]> */
</script>
<script type="text/javascript" id="media-video-jwt-bridge-js-extra">
/* <![CDATA[ */
var videopressAjax = {"ajaxUrl":"https:\/\/kpmgsecurity.wordpress.com\/wp-admin\/admin-ajax.php","bridgeUrl":"\/wp-content\/mu-plugins\/jetpack-plugin\/sun\/jetpack_vendor\/automattic\/jetpack-videopress\/build\/lib\/token-bridge.js","post_id":"2905"};
/* ]]> */
</script>
<script type="text/javascript" id="wpcom-actionbar-placeholder-js-extra">
/* <![CDATA[ */
var actionbardata = {"siteID":"78950108","postID":"2905","siteURL":"https:\/\/securitycafe.ro","xhrURL":"https:\/\/securitycafe.ro\/wp-admin\/admin-ajax.php","nonce":"ddb55d0e9b","isLoggedIn":"","statusMessage":"","subsEmailDefault":"instantly","proxyScriptUrl":"https:\/\/s0.wp.com\/wp-content\/js\/wpcom-proxy-request.js?ver=20211021","shortlink":"https:\/\/wp.me\/p5lgwQ-KR","i18n":{"followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/read\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar"}};
/* ]]> */
</script>
<script crossorigin="anonymous" type="text/javascript" src="https://s0.wp.com/_static/??-eJx9kN1OwzAMhV+IzMBFRS8QjzKljcncJXGwnY69PZnUofF7Zdnn+Hyy4VTdzMWwGCwKmSdK6Jqi+Nhnjsor7xa9gxtfbq6mFqkoLGjVz8etB20F9lRmmBqlAILJGwZXWU2/drtM5Xtu50syV4Xfz1eth6UWUC/i8tZQzlu5DfjT5DJF6dDfaHbA3FeqYKaWwVisRX+JKH6l6I34x87/l2+j/YolsIBvxtmb0fxpXikgd6Lq9qFEUycfsbhJKETswJf8/DCM4/g0PA73ywdZqZyB"></script>
<script type="text/javascript" id="rlt-proxy-js-after">
/* <![CDATA[ */
	window.addEventListener( 'DOMContentLoaded', function() {
		rltInitialize( {"token":null,"iframeOrigins":["https:\/\/widgets.wp.com"]} );
	} );
/* ]]> */
</script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://kpmgsecurity.wordpress.com/xmlrpc.php?rsd">
<meta name="generator" content="WordPress.com">
<link rel="canonical" href="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/">
<link rel="shortlink" href="https://wp.me/p5lgwQ-KR">
<link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/?format=json&amp;url=https%3A%2F%2Fsecuritycafe.ro%2F2023%2F02%2F27%2Fa-complete-kubernetes-config-review-methodology%2F&amp;for=wpcom-auto-discovery"><link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/?format=xml&amp;url=https%3A%2F%2Fsecuritycafe.ro%2F2023%2F02%2F27%2Fa-complete-kubernetes-config-review-methodology%2F&amp;for=wpcom-auto-discovery">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article">
<meta property="og:title" content="A Complete Kubernetes Config Review Methodology">
<meta property="og:url" content="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/">
<meta property="og:description" content="The are many resources out there that tap into the subject of Kubernetes Pentesting or Configuration Review, however, they usually detail specific topics and misconfigurations and don’t offer…">
<meta property="article:published_time" content="2023-02-27T08:16:00+00:00">
<meta property="article:modified_time" content="2023-11-27T11:19:42+00:00">
<meta property="og:site_name" content="Security Café">
<meta property="og:image" content="https://securitycafe.ro/wp-content/uploads/2023/01/kube1.png">
<meta property="og:image:width" content="673">
<meta property="og:image:height" content="281">
<meta property="og:image:alt" content="">
<meta property="og:locale" content="en_US">
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom">
<meta name="twitter:text:title" content="A Complete Kubernetes Config Review Methodology">
<meta name="twitter:image" content="https://securitycafe.ro/wp-content/uploads/2023/01/kube1.png?w=640">
<meta name="twitter:card" content="summary_large_image">

<!-- End Jetpack Open Graph Tags -->
<link rel="shortcut icon" type="image/x-icon" href="https://secure.gravatar.com/blavatar/c798a440ec703a17d8eda6a25b9dac06fa8162164e7e563dbc832069a934ce2b?s=32" sizes="16x16">
<link rel="icon" type="image/x-icon" href="https://secure.gravatar.com/blavatar/c798a440ec703a17d8eda6a25b9dac06fa8162164e7e563dbc832069a934ce2b?s=32" sizes="16x16">
<link rel="apple-touch-icon" href="https://secure.gravatar.com/blavatar/c798a440ec703a17d8eda6a25b9dac06fa8162164e7e563dbc832069a934ce2b?s=114">
<link rel="openid.server" href="https://securitycafe.ro/?openidserver=1">
<link rel="openid.delegate" href="https://securitycafe.ro/">
<link rel="search" type="application/opensearchdescription+xml" href="https://securitycafe.ro/osd.xml" title="Security Café">
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com">
		<style type="text/css">
			.recentcomments a {
				display: inline !important;
				padding: 0 !important;
				margin: 0 !important;
			}

			table.recentcommentsavatartop img.avatar, table.recentcommentsavatarend img.avatar {
				border: 0px;
				margin: 0;
			}

			table.recentcommentsavatartop a, table.recentcommentsavatarend a {
				border: 0px !important;
				background-color: transparent !important;
			}

			td.recentcommentsavatarend, td.recentcommentsavatartop {
				padding: 0px 0px 1px 0px;
				margin: 0px;
			}

			td.recentcommentstextend {
				border: none !important;
				padding: 0px 0px 2px 10px;
			}

			.rtl td.recentcommentstextend {
				padding: 0px 10px 2px 0px;
			}

			td.recentcommentstexttop {
				border: none;
				padding: 0px 0px 0px 10px;
			}

			.rtl td.recentcommentstexttop {
				padding: 0px 10px 0px 0px;
			}
		</style>
		<meta name="application-name" content="Security Café"><meta name="msapplication-window" content="width=device-width;height=device-height"><meta name="msapplication-tooltip" content="Security Research and Services"><meta name="description" content="The are many resources out there that tap into the subject of Kubernetes Pentesting or Configuration Review, however, they usually detail specific topics and misconfigurations and don't offer a broad perspective on how to do a complete Security Review. That is why in this article I want to cover a more complete overview on all…">
<style type="text/css" id="custom-colors-css">
	/* Navigation */
	.primary-navigation-wrap {
		background-color: transparent;
	}

	.main-navigation-menu a:hover,
	.main-navigation-menu a:hover:after,
	.main-navigation-menu a:active,
	.main-navigation-menu a:active:after {
		color: #fff !important;
	}

	.main-navigation-menu li.current-menu-item > a,
	.main-navigation-menu li.current-menu-item > a:after:hover,
	.main-navigation-menu ul .menu-item-has-children > a:after:hover,
	.widget_wpcom_social_media_icons_widget ul li a {
		color: #fff !important;
	}

	.widget_tag_cloud div a:link,
	.footer-widgets .widget_tag_cloud div a:link,
	.widget_tag_cloud div a:hover,
	.footer-widgets .widget_tag_cloud div a:hover,
	.widget_tag_cloud div a:active,
	.footer-widgets .widget_tag_cloud div a:active,
	.widget_tag_cloud div a:visited,
	.footer-widgets .widget_tag_cloud div a:visited,
	.wp_widget_tag_cloud div a:link,
	.footer-widgets .wp_widget_tag_cloud div a:link,
	.wp_widget_tag_cloud div a:hover,
	.footer-widgets .wp_widget_tag_cloud div a:hover,
	.wp_widget_tag_cloud div a:active,
	.footer-widgets .wp_widget_tag_cloud div a:active,
	.wp_widget_tag_cloud div a:visited,
	.footer-widgets .wp_widget_tag_cloud div a:visited {
		color: #fff !important;
	}

	.rtl blockquote {
		border-left-color: #ddd !important;
	}

	/* Entry meta */
	.entry-meta a:hover,
	.entry-meta a:active,
	.footer-widgets .widget a:hover,
	.footer-widgets .widget a:active,
	.site-footer a:hover,
	.site-footer a:active {
		opacity: 0.8;
	}

	.footer-widgets .widget_tag_cloud div a:hover,
	.footer-widgets .widget_tag_cloud div a:active,
	.footer-widgets .wp_widget_tag_cloud div a:hover,
	.footer-widgets .wp_widget_tag_cloud div a:active {
		opacity: 1.0;
	}

	/* Widgets */
	.a-stats a {
		color: #fff !important;
	}

.site-header,
		.site-title a:link,
		.site-title a:visited,
		.main-navigation-menu a:link,
		.main-navigation-menu a:visited,
		.top-navigation-menu a:link,
		.top-navigation-menu a:visited,
		.main-navigation-menu > .menu-item-has-children > a:after,
		.top-navigation-menu > .menu-item-has-children > a:after,
		.main-navigation-menu ul .menu-item-has-children > a:after,
		.top-navigation-menu ul .menu-item-has-children > a:after,
		.jetpack-social-navigation .menu li a:before,
		.footer-widgets .widget-title,
		.footer-widgets .widget a:link,
		.footer-widgets .widget a:visited,
		.footer-widgets .widget,
		.site-footer,
		.site-footer a:link,
		.site-footer a:visited { color: #FFFFFF;}
.main-navigation-menu a:hover,
		.top-navigation-menu a:hover { color: #FFFFFF;}
.site-footer a:link,
		.site-footer a:visited { border-color: #FFFFFF;}
body { background-color: #dddddd;}
body a:hover,
		body a:focus,
		body a:active,
		body .widget_flickr #flickr_badge_uber_wrapper a:hover,
		body .widget_flickr #flickr_badge_uber_wrapper a:active,
		body .entry-title a:hover,
		body .entry-title a:active,
		.entry-meta,
		.entry-meta a:link,
		.entry-meta a:visited { color: #003292;}
button:hover,
		input[type="button"]:hover,
		input[type="reset"]:hover,
		input[type="submit"]:hover,
		button:focus,
		input[type="button"]:focus,
		input[type="reset"]:focus,
		input[type="submit"]:focus,
		button:active,
		input[type="button"]:active,
		input[type="reset"]:active,
		input[type="submit"]:active,
		.widget_wpcom_social_media_icons_widget ul li a:hover,
		.more-link:hover,
		.more-link:active,
		.widget_tag_cloud .tagcloud a,
		.entry-tags .meta-tags a,
		.widget_tag_cloud div a,
		.wp_widget_tag_cloud div a,
		.post-navigation .nav-links a:hover,
		.post-navigation .nav-links a:active,
		.post-pagination a,
		.post-pagination .current,
		.infinite-scroll #infinite-handle span,
		.post-slider-controls .zeeflex-direction-nav a:hover,
		.post-slider-controls .zeeflex-direction-nav a:active { background: #003292;}
.site-header,
		.main-navigation-menu ul,
		.footer-widgets-wrap { background: #003292;}
.header-bar-wrap { background: #002A7A;}
.primary-navigation-wrap,
		.footer-wrap,
		.top-navigation-menu ul { background: #002160;}
a,
		a:link,
		a:visited,
		.widget-title,
		.widget_flickr #flickr_badge_uber_wrapper a:link,
		.widget_flickr #flickr_badge_uber_wrapper a:visited,
		.archive-title,
		.page-title,
		.entry-title,
		.entry-title a:link,
		.entry-title a:visited,
		.comments-header .comments-title,
		.comment-reply-title span { color: #003292;}
button,
		input[type="button"],
		input[type="reset"],
		input[type="submit"],
		.main-navigation-menu a:hover,
		.main-navigation-menu a:active,
		.main-navigation-menu li.current-menu-item > a,
		.widget_wpcom_social_media_icons_widget ul li a,
		.more-link,
		.entry-tags .meta-tags a:hover,
		.entry-tags .meta-tags a:active,
		.widget_tag_cloud div a:hover,
		.widget_tag_cloud div a:active,
		.wp_widget_tag_cloud div a:hover,
		.wp_widget_tag_cloud div a:active,
		.post-navigation .nav-links a,
		.post-pagination a:hover,
		.post-pagination a:active,
		.post-pagination .current,
		.infinite-scroll #infinite-handle span:hover,
		.main-navigation-toggle,
		.main-navigation-toggle:active,
		.main-navigation-toggle:focus,
		.main-navigation-toggle:hover,
		.main-navigation-menu .submenu-dropdown-toggle:hover,
		.main-navigation-menu .submenu-dropdown-toggle:active,
		.post-slider-controls .zeeflex-direction-nav a { background: #003292;}
.primary-navigation-wrap,
		.main-navigation-menu ul,
		.widget,
		.type-post,
		.type-page,
		.type-attachment,
		.comments-area,
		.sticky,
		.page-header,
		.main-navigation-menu-wrap { border-color: #003292;}
blockquote { border-left-color: #003292;}
.rtl blockquote { border-right-color: #003292;}
</style>
			<link rel="stylesheet" id="custom-css-css" type="text/css" href="https://s0.wp.com/?custom-css=1&amp;csblog=5lgwQ&amp;cscache=6&amp;csrev=63">
			<!-- Your Google Analytics Plugin is missing the tracking ID -->
<link href="https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.css?v=20240115" type="text/css" rel="stylesheet"></head>

<body class="post-template-default single single-post postid-2905 single-format-standard wp-embed-responsive customizer-styles-applied post-layout-two-columns post-layout-columns jetpack-reblog-enabled custom-colors">

	<div id="page" class="hfeed site">

		<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

		<div id="header-top" class="header-bar-wrap">

			
<div id="header-bar" class="header-bar container clearfix">

	
</div>

		</div>

		<header id="masthead" class="site-header clearfix" role="banner">

			<div class="header-main container clearfix">

				<div id="logo" class="site-branding clearfix">

										
		<p class="site-title"><a href="https://securitycafe.ro/" rel="home">Security Café</a></p>

						
			<p class="site-description">Security Research and Services</p>

		
				</div><!-- .site-branding -->

			</div><!-- .header-main -->

			<div id="main-navigation-wrap" class="primary-navigation-wrap">

				<button id="main-navigation-toggle" class="main-navigation-toggle">Menu</button><nav id="main-navigation" class="primary-navigation navigation container clearfix" role="navigation">

					<div class="main-navigation-menu-wrap">
						<ul id="menu-main-navigation" class="main-navigation-menu menu"><li class="page_item page-item-18 page_item_has_children"><span class="submenu-dropdown-toggle"></span><a href="https://securitycafe.ro/security-services-for-business/">Things we do on a daily basis</a>
<ul class="children" style="display: none;">
	<li class="page_item page-item-4154"><a href="https://securitycafe.ro/security-services-for-business/dora-tiber-exercises/">Red Team (DORA/TIBER) exercises</a></li>
	<li class="page_item page-item-279"><a href="https://securitycafe.ro/security-services-for-business/web-application-penetration-testing/">Web Application Penetration Testing</a></li>
	<li class="page_item page-item-281"><a href="https://securitycafe.ro/security-services-for-business/mobile-application-penetration-testing/">Mobile Application Penetration Testing</a></li>
	<li class="page_item page-item-286"><a href="https://securitycafe.ro/security-services-for-business/infrastructure-penetration-testing/">Infrastructure Penetration Testing</a></li>
	<li class="page_item page-item-289"><a href="https://securitycafe.ro/security-services-for-business/vulnerability-assessment/">Vulnerability Assessment</a></li>
</ul>
</li>
<li class="page_item page-item-3579"><a href="https://securitycafe.ro/cves-talks-and-tools/">CVEs, Talks and Tools</a></li>
<li class="page_item page-item-20"><a href="https://securitycafe.ro/contact/">Contact</a></li>
<li class="page_item page-item-1"><a href="https://securitycafe.ro/about/">About</a></li>
</ul>					</div>

				</nav><!-- #main-navigation -->

			</div>

		</header><!-- #masthead -->

		
			<div id="headimg" class="header-image">

				<a href="https://securitycafe.ro/" rel="home">

					<img src="https://securitycafe.ro/wp-content/uploads/2015/01/cropped-cropped-coffee-banner-2-4.jpg">

				</a>

			</div>

		
		<div id="content" class="site-content container clearfix">

	<section id="primary" class="content-single content-area">
		<main id="main" class="site-main" role="main">

		
<article id="post-2905" class="post-2905 post type-post status-publish format-standard has-post-thumbnail hentry category-cloud-security category-kubernetes category-penetration-testing tag-amazon tag-aws tag-configuration-review tag-container tag-docker tag-eks tag-k8s tag-kubernetes tag-methodology tag-penetration-testing tag-pentesting tag-permission tag-pods tag-policies tag-privilege-escalation tag-roles tag-secrets tag-security-context tag-service-account tag-services tag-verbs tag-vulnerability">

	<img width="673" height="281" src="https://securitycafe.ro/wp-content/uploads/2023/01/kube1.png?w=673" class="attachment-tortuga-single-post size-tortuga-single-post wp-post-image" alt="" decoding="async" data-attachment-id="2925" data-permalink="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/kube1/" data-orig-file="https://securitycafe.ro/wp-content/uploads/2023/01/kube1.png" data-orig-size="673,281" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="kube1" data-image-description="" data-image-caption="" data-medium-file="https://securitycafe.ro/wp-content/uploads/2023/01/kube1.png?w=300" data-large-file="https://securitycafe.ro/wp-content/uploads/2023/01/kube1.png?w=673">
	<header class="entry-header"><h1 class="entry-title">A Complete Kubernetes Config Review Methodology</h1></header>
	<div class="entry-meta clearfix"><span class="meta-date"><a href="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/" title="10:16 am" rel="bookmark"><time class="entry-date published updated" datetime="2023-02-27T10:16:00+02:00">February 27, 2023</time></a></span><span class="meta-author"> <span class="author vcard"><a class="url fn n" href="https://securitycafe.ro/author/stitakpmgcom/" title="View all posts by Stefan Tita" rel="author">Stefan Tita</a></span></span><span class="meta-category"> <a href="https://securitycafe.ro/tag/cloud-security/" rel="category tag">Cloud Security</a>, <a href="https://securitycafe.ro/category/cloud-security/kubernetes/" rel="category tag">Kubernetes</a>, <a href="https://securitycafe.ro/tag/penetration-testing/" rel="category tag">Penetration Testing</a></span><span class="meta-comments"> <a href="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/#respond">Leave a comment</a></span></div>
	<div class="entry-content clearfix">

		
<p>The are many resources out there that tap into the subject of Kubernetes Pentesting or Configuration Review, however, they usually detail specific topics and misconfigurations and don’t offer a broad perspective on how to do a complete Security Review. That is why in this article I want to cover a more complete overview on all the possible aspects that should be reviewed when dealing with a Kubernetes Security Assessment.</p>



<p>Because there are many topics in this discussion, I will avoid going into too much details on each aspect and instead I will be providing links to references where you can find more details.</p>



<h4 class="wp-block-heading">Table of Contents</h4>



<ul class="wp-block-list">
<li><a href="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/#intro">Intro</a></li>



<li><a href="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/#1-image-and-container-inspection">1. Image and Container inspection</a></li>



<li><a href="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/#2-configuration-review-aka-benchmark-tests">2. Configuration Review (aka Benchmark Tests)</a></li>



<li><a href="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/#3-permissions-rbac-privilege-escalation-vectors">3. Permissions/RBAC (Privilege Escalation vectors)</a>
<ul class="wp-block-list">
<li><a href="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/#1-create-pods-badpods">1. Create Pods (BadPods)</a></li>



<li><a href="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/#2-list-get-watch-secrets">2. List/Get/Watch Secrets</a></li>



<li><a href="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/#3-any-resource-or-verb-wildcards">3. Any Resource or Verb (wildcards)</a></li>



<li><a href="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/#4-create-pods-exec">4. Create Pods/Exec</a></li>



<li><a href="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/#5-create-update-delete-deployment-daemonsets-statefulsets-replicationcontrollers-replicasets-jobs-and-cronjobs">5. Create/Update/Delete Deployment, Daemonsets, Statefulsets, Replicationcontrollers, Replicasets, Jobs and Cronjobs</a></li>



<li><a href="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/#6-get-patch-create-rolebindings">6. Get/Patch/Create Rolebindings</a></li>



<li><a href="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/#7-get-create-node-proxy">7. Get/Create Node/Proxy</a></li>



<li><a href="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/#8-impersonate-user-group-service-account">8. Impersonate user, group, service account</a></li>
</ul>
</li>



<li><a href="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/#4-publicly-exposed-services-and-ingresses">4. Publicly Exposed Services and Ingresses</a></li>



<li><a href="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/#5-vulnerability-service-scanning">5. Vulnerability/Service Scanning</a></li>



<li><a href="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/#6-add-ons">6. Add-ons</a></li>



<li><a href="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/#wrap-up">Wrap-Up</a></li>
</ul>



<h2 class="wp-block-heading" id="intro">Intro</h2>



<p>Dealing with a Kubernetes (K8s) Security Assessment is relatively similar to a Cloud (AWS/Azure) Configuration Review/Pentest, in that there are many components that each introduce specific security implications and in order to understand these implications a basic understanding of these underlying components is necessary.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large"><img data-attachment-id="2911" data-permalink="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/k8s-2/" data-orig-file="https://securitycafe.ro/wp-content/uploads/2023/01/k8s-2.png" data-orig-size="1042,582" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="k8s-2" data-image-description="" data-image-caption="" data-medium-file="https://securitycafe.ro/wp-content/uploads/2023/01/k8s-2.png?w=300" data-large-file="https://securitycafe.ro/wp-content/uploads/2023/01/k8s-2.png?w=840" width="1024" height="571" src="https://securitycafe.ro/wp-content/uploads/2023/01/k8s-2.png?w=1024" alt="" class="wp-image-2911" srcset="https://securitycafe.ro/wp-content/uploads/2023/01/k8s-2.png?w=1022 1022w, https://securitycafe.ro/wp-content/uploads/2023/01/k8s-2.png?w=220 220w, https://securitycafe.ro/wp-content/uploads/2023/01/k8s-2.png?w=300 300w, https://securitycafe.ro/wp-content/uploads/2023/01/k8s-2.png?w=768 768w, https://securitycafe.ro/wp-content/uploads/2023/01/k8s-2.png 1042w" sizes="(max-width: 1024px) 100vw, 1024px"></figure></div>


<p>At a high level a K8s cluster consists of at least one <strong>Worker Node</strong> which hosts the&nbsp;Pods&nbsp;that run containerized applications, and one <strong>Control Plane</strong> (or Master Node) that manages the worker nodes and the Pods in the cluster. For more details on what each underlying component (API Server, etcd, Scheduler, Kubelet, etc.) is responsible for, visit the official documentation:</p>



<ul class="wp-block-list">
<li><a href="https://kubernetes.io/docs/concepts/overview/components/" target="_blank" rel="noreferrer noopener">https://kubernetes.io/docs/concepts/overview/components/</a></li>
</ul>



<p>On top of the main components, the K8s Cluster contains many <strong>resources </strong>and each of them comes with specific security implications. Resources can be configured through the API Server located on the Control Plane. The following is a list of all resources running under a K8s Cluster:</p>



<pre class="wp-block-preformatted">//kubectl api-resources    #gets a list of all resources 

configmaps
secrets
persistentvolumeclaims
pods
daemonsets
deployments
replicasets
statefulsets
jobs
cronjobs
services (ClusterIP, LoadBalancer, NodePort)
ingresses
events
bindings
endpoints
limitranges
podtemplates
replicationcontrollers
resourcequotas
serviceaccounts
controllerrevisions
localsubjectaccessreviews
horizontalpodautoscalers
leases
endpointslices
networkpolicies
securitygrouppolicies    #Security groups for pods, only on AWS EKS
poddisruptionbudgets
rolebindings
roles</pre>



<p>In order to conduct the Configuration Review the “<em>get</em>” and “<em>list</em>” permissions should be allowed on all these resources (maybe except secrets in order to avoid disclosure). In order to review the nodes, SSH access would be ideal in order to inspect file permissions and their content settings. In case Amazon EKS (Elastic Kubernetes Service) is used, in order to review the Control Plane configuration the ListCluster and DescribeCluster permission would be required (<a rel="noreferrer noopener" href="https://docs.aws.amazon.com/eks/latest/userguide/security_iam_id-based-policy-examples.html#policy_example2" target="_blank">https://docs.aws.amazon.com/eks/latest/userguide/security_iam_id-based-policy-examples.html#policy_example2</a>).</p>



<h2 class="wp-block-heading" id="1-image-and-container-inspection">1. Image and Container inspection</h2>



<p>There is a good change that during the assessment you will also have access to container images. Depending on the company practices these can be publicly available images (such as from Docker Hub, Google Container Registry, GitHub Container Registry, etc.) or images from a private container registry, either way it is a good idea for a company to have a defined standard for allowed and trusted image sources.</p>



<p>One manual method of inspecting images would be to perform Image Forensics by decompressing the archive (a Docker image is essentially an archive) and searching for sensitive information inside the files (<a rel="noreferrer noopener" href="https://www.youtube.com/watch?v=pOO_dDKGvY4" target="_blank">Docker Container Forensics</a>). Another option would be to deploy containers in your own private environment using the available images and try to look for potential issues inside a container, such as:</p>



<ul class="wp-block-list">
<li>OS vulnerabilities</li>



<li>Vulnerable software dependencies (libraries, packages, modules, etc.)</li>



<li>Known vulnerabilities affecting installed applications/servers</li>



<li>Server/Application misconfigurations</li>



<li>Hardcoded sensitive information or secrets</li>
</ul>



<p>There is however an easier option and that would be to leverage existing tools that automatically scan container images and look for the previously mentioned aspects.</p>



<p>Two of the popular tools that I have used in previous K8s security assessments are <span style="text-decoration: underline">Trivy</span> and <span style="text-decoration: underline">Grype</span>.</p>



<ul class="wp-block-list">
<li><a href="https://github.com/aquasecurity/trivy" target="_blank" rel="noreferrer noopener">https://github.com/aquasecurity/trivy</a></li>



<li><a href="https://github.com/anchore/grype" target="_blank" rel="noreferrer noopener">https://github.com/anchore/grype</a></li>
</ul>



<p>Both tools are updated continuously and relatively easy to use, you just provide the image and they will return an output with the findings.</p>



<p>In case you have access <strong>inside the Containers</strong> deployed to the K8s cluster (this can be achieved either through SSH, through the Pods/Exec permission or through some compromised vulnerability) there are some interesting settings we can enumerate by using container scanning and exploitation tools. </p>



<p><span style="text-decoration: underline">Peirates</span> (<a rel="noreferrer noopener" href="https://github.com/inguardians/peirates" target="_blank">https://github.com/inguardians/peirates</a>) is an exploitation framework that can be run from within a container and can automate known techniques for privilege escalation and lateral movement leading to greater control of the cluster (these techniques are later described in chapter 3). </p>



<p><span style="text-decoration: underline">Kdigger</span> (<a rel="noreferrer noopener" href="https://github.com/quarkslab/kdigger" target="_blank">https://github.com/quarkslab/kdigger</a>) is a tool that can automate the tedious tasks of acquiring information from inside a Kubernetes container, making it much easier to enumerate settings that can later be used for privilege escalation, such as:</p>



<ul class="wp-block-list">
<li>Pod Security Context – this includes settings such as Privileged pod, Linux capabilities, allowed system calls, allowPrivilegeEscalation setting (more details about Pod Security Context: <a rel="noreferrer noopener" href="https://kubernetes.io/docs/tasks/configure-pod-container/security-context/" target="_blank">https://kubernetes.io/docs/tasks/configure-pod-container/security-context/</a>)</li>



<li>Host Namespace configuration (hostPid, hostPath, hostNetwork, hostIPC)</li>



<li>Retrieve the Service Account token and scan its permissions (the service account provides an identity for processes that run in a pod/container and is used for authenticating that process to the API Server in case it is required)</li>



<li>Identify all services available in the K8s Cluster</li>



<li>Fuzzing the Admission Controller chain (in case you have the pods/create permission) in order to identify what type of pods you are allowed to create (this could result in creating pods in the cluster, so be aware of this side effect and use with caution)</li>
</ul>



<h2 class="wp-block-heading" id="2-configuration-review-aka-benchmark-tests">2. Configuration Review (aka Benchmark Tests)</h2>



<p>In this step of the Configuration Review process, you will have to go over a standard set of best practices that should be implemented when configuring the components and resources of the Kubernetes Cluster.</p>



<p>A well-known Security Baseline that can be used as a checklist for testing if best practices are indeed implemented is the <strong>CIS (Center for Internet Security) Kubernetes Benchmark</strong> (<a rel="noreferrer noopener" href="https://downloads.cisecurity.org/" target="_blank">https://downloads.cisecurity.org/</a>). This goes over many configuration checks (that are beyond the scope of this article) and gives exact instructions on how to perform them. Performing these checks manually is a relatively easy task and involves aspects such as:</p>



<ul class="wp-block-list">
<li>Software version</li>



<li>Logging</li>



<li>Policies</li>



<li>Service Accounts (e.g. disable auto-mounting of service account tokens on pods)</li>



<li>Security Contexts</li>



<li>Encrypting communication and stored data (e.g. Secrets are not encrypted by default)</li>



<li>Authentication, Authorization and Certficates (e.g. if the API Server or Kubelets have the <em>anonymous-auth</em> set to <em>true</em> then we can interact with them without authentication)</li>



<li>File permissions</li>



<li>Control Plane access (e.g. reviewing public/private access configuration)</li>
</ul>



<p>And the list goes on, so if you’re thinking that manually testing them all is a daunting task and you prefer automation, you could consider implementing something like <span style="text-decoration: underline">Kube-Bench</span> (<a rel="noreferrer noopener" href="https://github.com/aquasecurity/kube-bench" target="_blank">https://github.com/aquasecurity/kube-bench</a>) from Aqua Security. </p>



<p>I personally prefer the manual method mainly because automation tools might return false positives or false negatives especially if your testing account does not have the appropriate permissions set.</p>



<p>I also prefer this method because it gives me the opportunity to go over the cluster environment and understand all the settings, making other aspects of the Security Assessment easier, that is why I usually start the Kubernetes Assessment with this step. If it’s not the first time going over all these checks, it should not take longer than a day to review all of them.</p>



<p>Besides all these standard checks, if you have command line access to the pods or nodes, you should also inspect common files usually found on these machines that can contain secrets and confidential information, and could lead to escalation of privilege. A list of common files can be found here:</p>



<ul class="wp-block-list">
<li><a href="https://github.com/random-robbie/bruteforce-lists/blob/master/k8s.txt" target="_blank" rel="noreferrer noopener">https://github.com/random-robbie/bruteforce-lists/blob/master/k8s.txt</a></li>
</ul>



<p>One more aspect that I usually go over in the Configuration Review step is looking for plaintext credentials stored in resources such as <strong>Jobs</strong> and <strong>Cronjobs</strong>. Jobs and Cronjobs represent an automated way of executing recurring tasks and it is possible that Kubernetes administrators might make the mistake of hardcoding credentials in order to authenticate to a specific service or application.</p>



<h2 class="wp-block-heading" id="3-permissions-rbac-privilege-escalation-vectors">3. Permissions/RBAC (Privilege Escalation vectors)</h2>



<p>Besides finding credentials laying around in plaintext form due to misconfigurations or bad practices, another dangerous aspect that can lead to security issues is giving overly permissive rights to users and service accounts. (therefore, ignoring the principle of least privilege)</p>



<p>The RBAC (Role Based Access Control) implemented in Kubernetes is composed of <strong>Roles</strong>/<strong>ClusterRoles </strong>(these basically represent a group of permissions; Roles are applied at the Namespace level, while ClusterRoles are applied for all the Namespaces in the Cluster) and <strong>RoleBindings</strong>/<strong>ClusterRoleBindings </strong>(RoleBindings represent the mechanism that allows binding a role to a user/service account for a specific Namespace, while ClusterRoleBindings create the binding for all the Namespaces). </p>



<p>When configuring a permission inside a Role/ClusterRole you need to specify the <strong>verb </strong>(allowed action) and <strong>resource </strong>(on what resource is the action allowed). While the resources are mentioned in the intro, here is a list of possible verbs: <em>create</em>, <em>delete</em>, <em>deletecollection</em>, <em>bind</em>, <em>get</em>, <em>list</em>, <em>patch</em>, <em>update</em>, <em>watch</em>.</p>



<p>As mentioned earlier service accounts are used to give an identity to processes running in the container, so in case you find service account tokens inside a container or if you gain access to a user account there is a list of overly permissive rights that could lead to privilege escalation. Any Kubernetes administrator should be cautious about allocating the following permissions and such accounts should be protected at all costs.</p>



<h5 class="wp-block-heading" id="1-create-pods-badpods">1. Create Pods (BadPods)</h5>



<p>Creating pods can lead to different potential issues depending on what Security Context (e.g. privileged pod, allowPrivilegeEscalation) and Host Namespace (e.g. hostNetwork, hostPID, hostIPC, hostPath) settings we are allowed to configure the pod with. The concept of <strong>BadPods </strong>was defined in the following article (which I definitely encourage you to go read because I will not go into details here) to present all the ways that we can privilege escalate if we are able to create pods. (<a rel="noreferrer noopener" href="https://bishopfox.com/blog/kubernetes-pod-privilege-escalation" target="_blank">https://bishopfox.com/blog/kubernetes-pod-privilege-escalation</a>)</p>



<p>Besides restricting access to the create pods permission, it is recommended to implement Pod Security Standards (PSS) in order to prevent creating pods with dangerous configurations that could lead to privilege escalation. If you do not fully trust an account to create suitably secure and isolated Pods, you should enforce either the <strong>Baseline</strong> or <strong>Restricted</strong> Pod Security Standard.</p>



<h5 class="wp-block-heading" id="2-list-get-watch-secrets">2. List/Get/Watch Secrets</h5>



<p>Depending on what type of confidential information is stored inside Kubernetes secrets, the list secrets permission can result in compromising application credentials, API keys, SSH credentials or even other Kubernetes service account tokens.</p>



<p><strong>IMPORTANT:</strong> It is usually considered that the LIST verb allows only to view the secret name and not the secret itself, and that only the GET verb allows reading the actual secret, BUT this is a misconception, both LIST and WATCH can retrieve the secret value. When using the LIST permission &nbsp;(for example using&nbsp;“<code>kubectl get secrets -A -o json</code>“) all the secrets names including their individual secret values are pulled from the Kuberntes API. So, any of these permissions are enough in order to read secret values.</p>



<p>The following command can be used to view the secret when we have only the LIST permission:</p>



<pre class="wp-block-preformatted">kubectl get secret --token $TOKEN -o json | jq -r '.items[] | select(.metadata.name=="secret-name")'</pre>



<h5 class="wp-block-heading" id="3-any-resource-or-verb-wildcards">3. Any Resource or Verb (wildcards)</h5>



<p>When configuring permissions, the wildcard character (“*”) should be used with care. If administrators abuse this to configure either verbs or resources, it will eventually result in misconfigurations (<a rel="noreferrer noopener" href="https://docs.boostsecurity.io/rules/k8s-rbac-wildcards.html" target="_blank">https://docs.boostsecurity.io/rules/k8s-rbac-wildcards.html</a>). Examples of permissions that could be used to compromise the Kubernetes cluster:</p>



<ul class="wp-block-list">
<li>resources: [“*”] verbs: [“*”]</li>



<li>resources: [“*”] verbs: [“create”]</li>



<li>resources: [“*”] verbs: [“get”]</li>



<li>resources: [“pods”] verbs: [“*”]</li>
</ul>



<p>Here is a command that will give you a list of all the Roles and ClusterRoles containing wildcard permissions:</p>



<pre class="wp-block-preformatted">kubectl get roles/clusterroles -A -o yaml | grep "name:\|*" | grep -B 1 "*" | grep "name:" | cut -d ":" -f 2</pre>



<p>Custom created Roles and ClusterRoles should be the focus and they should be individually inspected to make sure that permissions were given according to their purpose.</p>



<h5 class="wp-block-heading" id="4-create-pods-exec">4. Create Pods/Exec</h5>



<p>As mentioned earlier in chapter1, this permission would allow an account to connect inside a container (similar to SSH access). Connecting to containers should be allowed only to administrators in order to prevent others from accessing all the pods in the cluster.</p>



<h5 class="wp-block-heading" id="5-create-update-delete-deployment-daemonsets-statefulsets-replicationcontrollers-replicasets-jobs-and-cronjobs">5. Create/Update/Delete Deployment, Daemonsets, Statefulsets, Replicationcontrollers, Replicasets, Jobs and Cronjobs</h5>



<p>If we can create, update or delete these resources, we can therefore manipulate pods because these rights allow us to modify the YAML files that control the desired state configuration for the pods in the cluster.</p>



<h5 class="wp-block-heading" id="6-get-patch-create-rolebindings">6. Get/Patch/Create Rolebindings</h5>



<p>Because this permission allows binding a role to a user, an attacker could easily use this to give himself the <em>admin </em>ClusterRole.</p>



<h5 class="wp-block-heading" id="7-get-create-node-proxy">7. Get/Create Node/Proxy</h5>



<p>Users or service accounts with node/proxy rights can essentially do anything the Kubelet API allows for, including executing commands in <em>every pod on the node</em>. If we have access to this permission, the following command can be used to execute commands on a container:</p>



<pre class="wp-block-preformatted">curl -k -H “Authorization: Bearer $TOKEN” -XPOST https://kube-apiserver:10250/run/{namespace}/{pod}/{container} -d “cmd=whoami”</pre>



<figure class="wp-block-image size-large"><img data-attachment-id="2989" data-permalink="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/image-4-3/" data-orig-file="https://securitycafe.ro/wp-content/uploads/2023/02/image-4.png" data-orig-size="896,130" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-4" data-image-description="" data-image-caption="" data-medium-file="https://securitycafe.ro/wp-content/uploads/2023/02/image-4.png?w=300" data-large-file="https://securitycafe.ro/wp-content/uploads/2023/02/image-4.png?w=840" width="896" height="130" src="https://securitycafe.ro/wp-content/uploads/2023/02/image-4.png?w=896" alt="" class="wp-image-2989" srcset="https://securitycafe.ro/wp-content/uploads/2023/02/image-4.png 896w, https://securitycafe.ro/wp-content/uploads/2023/02/image-4.png?w=220 220w, https://securitycafe.ro/wp-content/uploads/2023/02/image-4.png?w=300 300w, https://securitycafe.ro/wp-content/uploads/2023/02/image-4.png?w=768 768w" sizes="(max-width: 896px) 100vw, 896px"><figcaption class="wp-element-caption">Example of discovered Service Account with nodes/proxy permission</figcaption></figure>



<p>More details about this privilege escalation vector can be found here: <a href="https://blog.aquasec.com/privilege-escalation-kubernetes-rbac" target="_blank" rel="noreferrer noopener">https://blog.aquasec.com/privilege-escalation-kubernetes-rbac</a></p>



<h5 class="wp-block-heading" id="8-impersonate-user-group-service-account">8. Impersonate user, group, service account</h5>



<p>A user or service account could potentially be used to privilege escalate through impersonation if it has the ability to perform the “impersonate” verb on another kind of attribute such as a user, group or uid (<a rel="noreferrer noopener" href="https://kubernetes.io/docs/reference/access-authn-authz/authentication/#user-impersonation" target="_blank">https://kubernetes.io/docs/reference/access-authn-authz/authentication/#user-impersonation</a>). If we can impersonate a privileged account like the cluster-admin, that would be game over.</p>



<p>I’ve only given a short description of these dangerous privileges and their impact, so if you want more details you can check out the original article by CyberArk: <a rel="noreferrer noopener" href="https://www.cyberark.com/resources/threat-research-blog/kubernetes-pentest-methodology-part-1" target="_blank">https://www.cyberark.com/resources/threat-research-blog/kubernetes-pentest-methodology-part-1</a> </p>



<p>Now, inspecting all these roles, clusterroles, rolebindings, clusterrolebinding and trying to identify the groups and accounts that have the above permissions is not an easy task (to say the least) if you are using the <span style="text-decoration: underline">kubectl</span> command line tool to inspect permissions. It would be really hard to manually track all these settings and find all the high value accounts, especially in a large and complex Kubernetes Cluster. That is why for this task I always rely on <a rel="noreferrer noopener" href="https://github.com/cyberark/KubiScan" target="_blank">KubiScan</a> and <a rel="noreferrer noopener" href="https://github.com/alcideio/rbac-tool" target="_blank">rbac-tool</a>.</p>



<p>KubiScan is a CLI tool developed by CyberArk that offers an easier way of identifying risky Roles/ClusterRoles, RoleBindings/ClusterRoleBindings, Pods/Containers and high value Users/Groups/Service Accounts. The following image shows the build in options that can help automate multiple tasks:</p>


<div class="wp-block-image">
<figure class="aligncenter size-large"><img data-attachment-id="2948" data-permalink="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/image-20/" data-orig-file="https://securitycafe.ro/wp-content/uploads/2023/02/image.png" data-orig-size="1165,626" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://securitycafe.ro/wp-content/uploads/2023/02/image.png?w=300" data-large-file="https://securitycafe.ro/wp-content/uploads/2023/02/image.png?w=840" loading="lazy" width="1024" height="550" src="https://securitycafe.ro/wp-content/uploads/2023/02/image.png?w=1024" alt="" class="wp-image-2948" srcset="https://securitycafe.ro/wp-content/uploads/2023/02/image.png?w=1024 1024w, https://securitycafe.ro/wp-content/uploads/2023/02/image.png?w=220 220w, https://securitycafe.ro/wp-content/uploads/2023/02/image.png?w=300 300w, https://securitycafe.ro/wp-content/uploads/2023/02/image.png?w=768 768w, https://securitycafe.ro/wp-content/uploads/2023/02/image.png 1165w" sizes="(max-width: 1024px) 100vw, 1024px"><figcaption class="wp-element-caption">KubiScan parameter options</figcaption></figure></div>


<p>The following images show the results generated by the “<em>kubiscan –all</em>” command where the risk levels are highlighted:</p>


<div class="wp-block-image">
<figure class="aligncenter size-large"><img data-attachment-id="2951" data-permalink="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/kubiscan1-2/" data-orig-file="https://securitycafe.ro/wp-content/uploads/2023/02/kubiscan1.jpg" data-orig-size="1611,448" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="kubiscan1" data-image-description="" data-image-caption="" data-medium-file="https://securitycafe.ro/wp-content/uploads/2023/02/kubiscan1.jpg?w=300" data-large-file="https://securitycafe.ro/wp-content/uploads/2023/02/kubiscan1.jpg?w=840" loading="lazy" width="1024" height="284" src="https://securitycafe.ro/wp-content/uploads/2023/02/kubiscan1.jpg?w=1024" alt="" class="wp-image-2951" srcset="https://securitycafe.ro/wp-content/uploads/2023/02/kubiscan1.jpg?w=1024 1024w, https://securitycafe.ro/wp-content/uploads/2023/02/kubiscan1.jpg?w=1021 1021w, https://securitycafe.ro/wp-content/uploads/2023/02/kubiscan1.jpg?w=220 220w, https://securitycafe.ro/wp-content/uploads/2023/02/kubiscan1.jpg?w=300 300w, https://securitycafe.ro/wp-content/uploads/2023/02/kubiscan1.jpg?w=768 768w, https://securitycafe.ro/wp-content/uploads/2023/02/kubiscan1.jpg 1611w" sizes="(max-width: 1024px) 100vw, 1024px"><figcaption class="wp-element-caption">Roles/ClusterRoles risk levels</figcaption></figure></div>

<div class="wp-block-image">
<figure class="aligncenter size-large"><img data-attachment-id="2952" data-permalink="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/kubiscan2-2/" data-orig-file="https://securitycafe.ro/wp-content/uploads/2023/02/kubiscan2.jpg" data-orig-size="1733,381" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="kubiscan2" data-image-description="" data-image-caption="" data-medium-file="https://securitycafe.ro/wp-content/uploads/2023/02/kubiscan2.jpg?w=300" data-large-file="https://securitycafe.ro/wp-content/uploads/2023/02/kubiscan2.jpg?w=840" loading="lazy" width="1024" height="225" src="https://securitycafe.ro/wp-content/uploads/2023/02/kubiscan2.jpg?w=1024" alt="" class="wp-image-2952" srcset="https://securitycafe.ro/wp-content/uploads/2023/02/kubiscan2.jpg?w=1024 1024w, https://securitycafe.ro/wp-content/uploads/2023/02/kubiscan2.jpg?w=220 220w, https://securitycafe.ro/wp-content/uploads/2023/02/kubiscan2.jpg?w=300 300w, https://securitycafe.ro/wp-content/uploads/2023/02/kubiscan2.jpg?w=768 768w, https://securitycafe.ro/wp-content/uploads/2023/02/kubiscan2.jpg 1733w" sizes="(max-width: 1024px) 100vw, 1024px"><figcaption class="wp-element-caption">RoleBindings/ClusterRoleBindings risk levels</figcaption></figure></div>


<p>Rbac-tool also has multiple functionalities but the main command that I use is “<em>rbac-tool who-can</em>” in order to identify accounts that have the previously mentioned permissions that lead to privilege escalation (create pods, list secrets, etc.). Here are some examples of commands and their generated output:</p>



<pre class="wp-block-preformatted">rbac-tool who-can create pods
rbac-tool who-can list secrets
rbac-tool who-can create pods/exec
rbac-tool who-can bind clusterroles
rbac-tool who-can create rolebindings
rbac-tool who-can create pods</pre>


<div class="wp-block-image">
<figure class="aligncenter size-large"><img data-attachment-id="2953" data-permalink="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/rbac1/" data-orig-file="https://securitycafe.ro/wp-content/uploads/2023/02/rbac1.png" data-orig-size="712,250" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="rbac1" data-image-description="" data-image-caption="" data-medium-file="https://securitycafe.ro/wp-content/uploads/2023/02/rbac1.png?w=300" data-large-file="https://securitycafe.ro/wp-content/uploads/2023/02/rbac1.png?w=712" loading="lazy" width="712" height="250" src="https://securitycafe.ro/wp-content/uploads/2023/02/rbac1.png?w=712" alt="" class="wp-image-2953" srcset="https://securitycafe.ro/wp-content/uploads/2023/02/rbac1.png 712w, https://securitycafe.ro/wp-content/uploads/2023/02/rbac1.png?w=220 220w, https://securitycafe.ro/wp-content/uploads/2023/02/rbac1.png?w=300 300w" sizes="(max-width: 712px) 100vw, 712px"><figcaption class="wp-element-caption">Subjects with Create Pods permission</figcaption></figure></div>

<div class="wp-block-image">
<figure class="aligncenter size-large"><img data-attachment-id="2954" data-permalink="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/rbac2/" data-orig-file="https://securitycafe.ro/wp-content/uploads/2023/02/rbac2.png" data-orig-size="730,110" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="rbac2" data-image-description="" data-image-caption="" data-medium-file="https://securitycafe.ro/wp-content/uploads/2023/02/rbac2.png?w=300" data-large-file="https://securitycafe.ro/wp-content/uploads/2023/02/rbac2.png?w=730" loading="lazy" width="730" height="110" src="https://securitycafe.ro/wp-content/uploads/2023/02/rbac2.png?w=730" alt="" class="wp-image-2954" srcset="https://securitycafe.ro/wp-content/uploads/2023/02/rbac2.png 730w, https://securitycafe.ro/wp-content/uploads/2023/02/rbac2.png?w=220 220w, https://securitycafe.ro/wp-content/uploads/2023/02/rbac2.png?w=300 300w" sizes="(max-width: 730px) 100vw, 730px"><figcaption class="wp-element-caption">Subjects with Create RoleBindings permission</figcaption></figure></div>


<p>Once we manage to identify an account that we control and has one of the mentioned dangerous permissions, we can easily escalate our privileges and try to extend our reach inside the Kubernetes Cluster.</p>



<p>Even if we don’t have access to any other user/service account, all the accounts/groups/roles should be reviewed in order to ensure that they are still used and not some legacy accounts, and that there are no overlapping role assignments that could cause misconfigurations. This requires a deep understanding of the K8s Cluster so it’s important to do it in close collaboration with the K8s Administrators.</p>



<h2 class="wp-block-heading" id="4-publicly-exposed-services-and-ingresses">4. Publicly Exposed Services and Ingresses</h2>



<p>Services (such as ClusterIP, NodePort, LoadBalancer) and Ingresses are two methods of making application ports running inside the container accessible to other containers inside the K8s Cluster, to the internal company network or ever publicly available to the Internet.</p>



<p>During the Configuration Review you should have access to read resources such as Services and Ingresses, therefore, viewing all of them could be achieved easily by using the following commands:</p>



<pre class="wp-block-preformatted">#get all services and ingresses, from all namespaces
kubectl get services --all-namespaces
kubectl get ingresses --all-namespaces

#view details about a service or ingress
kubectl get service &lt;SERVICENAME&gt; -n &lt;NAMESPACE&gt; -o json
kubectl get ingress &lt;INGRESSNAME&gt; -n &lt;NAMESPACE&gt; -o json</pre>



<p><code><strong>ClusterIP</strong></code>: Exposes the Service on a cluster-internal IP. Choosing this value makes the Service only reachable from within the cluster. Therefore, this service type does not present a significant risk because services are not publicly accessible.</p>



<p><code><strong>NodePort</strong></code>: Unlike a ClusterIP, a NodePort service can be accessible from outside the cluster because it exposes a port in each Node, through which external access is possible. As a result, NodePort services should be reviewed to ensure that exposed container applications do not present any risk.</p>



<p><code><strong>LoadBalancer</strong>:</code> It is very similar to a NodePort but uses a LoadBalancer implementation from a cloud provider (e.g. Amazon Elastic Load Balancer) that distributes the traffic equally and directly to the Pods. Obviously, this should also be reviewed carefully to identify public exposure.</p>



<p><code><strong>ExternalName</strong>:</code> It is a connector that directs to a service available in a different cluster. This is useful if you want to configure an application in one cluster to connect to an application in a different cluster. Through the ExternalName service we can observe what services are exposed in other Kubernetes Clusters and if they are publicly accessible.</p>



<p><code><strong>Ingress</strong>:</code> Ingresses are used to direct HTTP and HTTPS traffic from outside the cluster to specific web applications inside the cluster based on the URL path (such as /app1, /app2) and they are managed by an Ingress&nbsp;Controller (which is basically a reverse proxy like Nginx or AWS Application Load Balancer that is hosted on a pod inside the cluster). Because ingresses expose web services outside the cluster they also can be misconfigured and result in public exposure of sensitive information.</p>



<p>If any of the resources mentioned above are publicly available, we should take note and confirm with the administrators that external access is indeed the desired behavior. (e.g. there is no reason for a portal like Skooner, ArgoCD, Prometheus to be publicly accessible)</p>



<p>Allocating public IP addresses to worker nodes/control plane for external access should be avoided, only services/apps hosted inside pods should be publicly accessible if indeed required.</p>



<p>Moreover, it is important that all pods hosting services exposed outside the cluster should be strictly configured (this includes security contexts, host namespaces, service accounts, network policies) to avoid privesc or lateral movement in case of a breach. Therefore, any pod configured as a <em>privileged pod</em> or with a <em>service account with privileged permissions</em> should be considered a huge risk.</p>



<p>In order to identify if services and ingresses are publicly exposed we also need to review the configured <code><strong>Network Policies</strong></code>. If Amazon EKS is used then you should also review <code><strong>Security Groups for Pods</strong></code> and <code><strong>Security Groups for the Cluster</strong></code> (more details about the EKS Cluster Security Groups: <a rel="noreferrer noopener" href="https://docs.aws.amazon.com/eks/latest/userguide/sec-group-reqs.html" target="_blank">https://docs.aws.amazon.com/eks/latest/userguide/sec-group-reqs.html</a>). </p>



<p>Network Policies and Security Groups for Pods are configured at the Namespace level and if they are missing then all traffic is allowed between all pods inside the cluster which is ideal for an attacker seeking to compromise as many services as possible.</p>



<pre class="wp-block-preformatted">#get network policies from all namespaces
kubectl get networkpolicies -A

#get security groups for pods (in case of Amazon EKS)
kubectl get securitygrouppolicies -A</pre>



<p>The following images suggest that no network restrictions exist and all traffic is allowed, a situation that is not ideal.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large"><img data-attachment-id="2979" data-permalink="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/image-2-5/" data-orig-file="https://securitycafe.ro/wp-content/uploads/2023/02/image-2.png" data-orig-size="515,37" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-2" data-image-description="" data-image-caption="" data-medium-file="https://securitycafe.ro/wp-content/uploads/2023/02/image-2.png?w=300" data-large-file="https://securitycafe.ro/wp-content/uploads/2023/02/image-2.png?w=515" loading="lazy" width="700" height="50" src="https://securitycafe.ro/wp-content/uploads/2023/02/image-2.png?w=700" alt="" class="wp-image-2979" srcset="https://securitycafe.ro/wp-content/uploads/2023/02/image-2.png 515w, https://securitycafe.ro/wp-content/uploads/2023/02/image-2.png?w=220 220w, https://securitycafe.ro/wp-content/uploads/2023/02/image-2.png?w=300 300w" sizes="(max-width: 700px) 100vw, 700px"><figcaption class="wp-element-caption">Lack of Network Policies</figcaption></figure></div>

<div class="wp-block-image">
<figure class="aligncenter size-large"><img data-attachment-id="2980" data-permalink="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/image-3-3/" data-orig-file="https://securitycafe.ro/wp-content/uploads/2023/02/image-3.png" data-orig-size="557,38" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-3" data-image-description="" data-image-caption="" data-medium-file="https://securitycafe.ro/wp-content/uploads/2023/02/image-3.png?w=300" data-large-file="https://securitycafe.ro/wp-content/uploads/2023/02/image-3.png?w=557" loading="lazy" width="700" height="47" src="https://securitycafe.ro/wp-content/uploads/2023/02/image-3.png?w=700" alt="" class="wp-image-2980" srcset="https://securitycafe.ro/wp-content/uploads/2023/02/image-3.png 557w, https://securitycafe.ro/wp-content/uploads/2023/02/image-3.png?w=220 220w, https://securitycafe.ro/wp-content/uploads/2023/02/image-3.png?w=300 300w" sizes="(max-width: 700px) 100vw, 700px"><figcaption class="wp-element-caption">Lack of Security Groups for Pods (EKS only)</figcaption></figure></div>


<h2 class="wp-block-heading" id="5-vulnerability-service-scanning">5. Vulnerability/Service Scanning</h2>



<p>Ideally, in order to ensure that the services hosted by Kubernetes are secure, conducting a Penetration Test on all the services and applications would be the solution to achieve this objective. </p>



<p>But conducting a proper penetration test could require a lot of time and resources, especially if there are many custom developed services/apps hosted by the Kubernetes Cluster, that is why a penetration test is outside the scope of a Kubernetes Configuration Review and should be planned separately.</p>



<p>However, during this step in our process it is recommended to go over services commonly found in a Kubernetes Cluster in order to fingerprint and scan for well-known vulnerabilities, basically look for <em>low-hanging fruits</em> that could be easily exploited.</p>



<p>Common Kubernetes ports can be seen in the following picture:</p>



<figure class="wp-block-image size-large"><img data-attachment-id="2998" data-permalink="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/image-5-3/" data-orig-file="https://securitycafe.ro/wp-content/uploads/2023/02/image-5.png" data-orig-size="1243,615" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-5" data-image-description="" data-image-caption="" data-medium-file="https://securitycafe.ro/wp-content/uploads/2023/02/image-5.png?w=300" data-large-file="https://securitycafe.ro/wp-content/uploads/2023/02/image-5.png?w=840" loading="lazy" width="1024" height="506" src="https://securitycafe.ro/wp-content/uploads/2023/02/image-5.png?w=1024" alt="" class="wp-image-2998" srcset="https://securitycafe.ro/wp-content/uploads/2023/02/image-5.png?w=1024 1024w, https://securitycafe.ro/wp-content/uploads/2023/02/image-5.png?w=220 220w, https://securitycafe.ro/wp-content/uploads/2023/02/image-5.png?w=300 300w, https://securitycafe.ro/wp-content/uploads/2023/02/image-5.png?w=768 768w, https://securitycafe.ro/wp-content/uploads/2023/02/image-5.png 1243w" sizes="(max-width: 1024px) 100vw, 1024px"><figcaption class="wp-element-caption">source: <a href="https://www.cyberark.com/resources/threat-research-blog/kubernetes-pentest-methodology-part-2" target="_blank" rel="noreferrer noopener">https://www.cyberark.com/resources/threat-research-blog/kubernetes-pentest-methodology-part-2</a></figcaption></figure>



<p>On top of these common ports we can identify other open ports by using the following <em>kubectl get services</em> command (this will display the namespace, the service name, the port):</p>



<pre class="wp-block-preformatted">kubectl get svc --all-namespaces -o go-template='{{range .items}}{{ $save := . }}{{range.spec.ports}}{{if .nodePort}}{{$save.metadata.namespace}}{{"/"}}{{$save.metadata.name}}{{" - "}}{{.name}}{{": "}}{{.nodePort}}{{"\n"}}{{end}}{{end}}{{end}}'</pre>



<p>Going through all ports manually and looking for issues is the preferred method, but this could take a long time in a large and complex cluster.</p>



<p>Alternatively, we can opt for the automated method, using a vulnerability scanner. A dedicated tool for Kubernetes vulnerability scanning can offer better results than generic vulnerability scanners, that is why the best tool for this job is <a rel="noreferrer noopener" href="https://github.com/aquasecurity/kube-hunter" target="_blank">Kube-Hunter</a>, which I strongly recommend using.</p>



<p>Kube-Hunter can be run from inside a pod or remotely from your attacker machine. It can run under a specific account, and based on the account permissions, it will try to enumerate all the Kubernetes components and resources in order to identify potential issues. The long list of Active and Passive checks that it performs can be seen using the <code><em>--list</em></code> command.</p>



<p>By default, the tool runs in Passive mode because active hunting can potentially do state-changing operations on the cluster,&nbsp;<strong>which could be harmful</strong> (e.g. will attempt to add a new key to the etcd DB). In order to run in Active mode, the <code><em>--active</em></code> command must be used.</p>



<p>The tool is straight forward to use and the documentation explains everything really well, but here is a summary of the commands:</p>



<pre class="wp-block-preformatted">#view the Active and Passive mode actions
kube-hunter --list
kube-hunter --list --active

#scan specific worker/master node
kube-hunter --remote &lt;node-ip&gt;
#scan all IP addresses in a network segment
kube-hunter --cidr 192.168.0.0/24
#use the kubeconfig file to connect to the Kubernetes API and detect nodes
kube-hunter --k8s-auto-discover-nodes

#run the tool in active mode
kube-hunter --remote &lt;node-ip&gt; --active

#manually specify the service account token
kube-hunter --active --service-account-token &lt;token&gt;</pre>



<h2 class="wp-block-heading" id="6-add-ons">6. Add-ons</h2>



<p>The final step in the Kubernetes Configuration Review process involves reviewing <strong>Add-ons</strong> which are an integral part of the Kubernetes Cluster and can offer adjacent services such as performance metrics (Prometheus, New Relic, cAdvisor), management portal (Skooner), logging (Fluentbit), network policy enforcement (Calico), DNS server (CoreDNS), continuous delivery (ArgoCD). In some situations, the pods hosting these add-ons can outnumber the pods running the main services and applications that are critical for the business.</p>



<p>When these services are configured to run inside the Kubernetes Cluster it is possible that privileged accounts are created for the installation process without being removed afterwards, or that pods are created with dangerous permissions.</p>



<p>One commonly found configuration that could lead to potential issues involves configuring the pods that host a specific Add-on as <strong>privileged pods</strong>, even though it is not required or it is required for a specific functionality that is not used. When configuring privileged pods, we must first understand why this is required before approving this privileged pod configuration.</p>



<p>This is the reason why the documentation associated to each add-on should be reviewed in order to ensure that pods are created with the proper Security Context, Host Namespaces, service account permissions and network policies. (e.g. NewRelic Add-on documentation: <a rel="noreferrer noopener" href="https://github.com/newrelic/nri-kubernetes/tree/main/charts/newrelic-infrastructure#privileged-toggle" target="_blank">https://github.com/newrelic/nri-kubernetes/tree/main/charts/newrelic-infrastructure#privileged-toggle</a>)</p>



<p>Also, many of these Add-ons have services or GUI applications that should only be accessed from inside the company or cluster, so there is no reason for public access, as mentioned in chapter 4. </p>



<p>Reviewing add-ons requires a deep understanding of each specific add-on and could require significant time depending on the complexity of the cluster configuration, that is why I usually leave this task at the end after finishing all the other checks.</p>



<h2 class="wp-block-heading" id="wrap-up">Wrap-Up</h2>



<p>In the end I would like to leave you with some cheat sheets that contain many useful <em><code>kubectl</code> </em>commands for enumerating all the components and resources in Kubernetes:</p>



<ul class="wp-block-list">
<li><a rel="noreferrer noopener" href="https://kubernetes.io/docs/reference/kubectl/cheatsheet/" target="_blank">https://kubernetes.io/docs/reference/kubectl/cheatsheet/</a> – Kubectl cheatsheet #1</li>



<li><a rel="noreferrer noopener" href="https://spacelift.io/blog/kubernetes-cheat-sheet" target="_blank">https://spacelift.io/blog/kubernetes-cheat-sheet</a> – Kubectl cheatsheet #2</li>



<li><a rel="noreferrer noopener" href="https://owasp.org/www-project-kubernetes-top-ten/" target="_blank">https://owasp.org/www-project-kubernetes-top-ten/</a> – OWASP Kubernetes Top 10</li>
</ul>
<div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul data-sharing-events-added="true"><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-2905" class="share-facebook sd-button share-icon" href="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/?share=facebook&amp;nb=1" target="_blank" title="Click to share on Facebook"><span>Facebook</span></a></li><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-2905" class="share-twitter sd-button share-icon" href="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/?share=twitter&amp;nb=1" target="_blank" title="Click to share on Twitter"><span>Twitter</span></a></li><li class="share-linkedin"><a rel="nofollow noopener noreferrer" data-shared="sharing-linkedin-2905" class="share-linkedin sd-button share-icon" href="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/?share=linkedin&amp;nb=1" target="_blank" title="Click to share on LinkedIn"><span>LinkedIn</span></a></li><li class="share-reddit"><a rel="nofollow noopener noreferrer" data-shared="" class="share-reddit sd-button share-icon" href="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/?share=reddit&amp;nb=1" target="_blank" title="Click to share on Reddit"><span>Reddit</span></a></li><li class="share-end"></li></ul></div></div></div><div class="sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded" id="like-post-wrapper-78950108-2905-666bf4a9c9a5b" data-src="//widgets.wp.com/likes/index.html?ver=20240614#blog_id=78950108&amp;post_id=2905&amp;origin=kpmgsecurity.wordpress.com&amp;obj_id=78950108-2905-666bf4a9c9a5b&amp;domain=securitycafe.ro" data-name="like-post-frame-78950108-2905-666bf4a9c9a5b" data-title="Like or Reblog"><div class="likes-widget-placeholder post-likes-widget-placeholder" style="height: 55px;"><span class="button"><span>Like</span></span> <span class="loading">Loading...</span></div><span class="sd-text-color"></span><a class="sd-link-color"></a></div>
<div id="jp-relatedposts" class="jp-relatedposts" style="display: block;">
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
<div class="jp-relatedposts-items jp-relatedposts-items-visual jp-relatedposts-grid "><div class="jp-relatedposts-post jp-relatedposts-post0 jp-relatedposts-post-thumbs" data-post-id="2886" data-post-format="false"><a class="jp-relatedposts-post-a" href="https://securitycafe.ro/2023/02/01/our-defcamp-2022-talks-are-here/" title="Our DefCamp 2022 talks are here!" data-origin="2905" data-position="0"><img class="jp-relatedposts-post-img" loading="lazy" src="https://i0.wp.com/securitycafe.ro/wp-content/uploads/2023/01/defcamp-square-3026001938-e1674651656847.png?resize=350%2C200&amp;ssl=1" width="350" height="200" srcset="https://i0.wp.com/securitycafe.ro/wp-content/uploads/2023/01/defcamp-square-3026001938-e1674651656847.png?resize=350%2C200&amp;ssl=1 1x, https://i0.wp.com/securitycafe.ro/wp-content/uploads/2023/01/defcamp-square-3026001938-e1674651656847.png?resize=525%2C300&amp;ssl=1 1.5x, https://i0.wp.com/securitycafe.ro/wp-content/uploads/2023/01/defcamp-square-3026001938-e1674651656847.png?resize=700%2C400&amp;ssl=1 2x" alt=""></a><h4 class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://securitycafe.ro/2023/02/01/our-defcamp-2022-talks-are-here/" title="Our DefCamp 2022 talks are here!" data-origin="2905" data-position="0">Our DefCamp 2022 talks are here!</a></h4><p class="jp-relatedposts-post-excerpt">Both presentations we held this year at DefCamp are now available online (recordings and slides). DefCamp is one of the largest and most important cybersecurity conferences from central and eastern Europe. Our presence at DefCamp was constant in the last years either through talks, partnership or both. Through the topics…</p><time class="jp-relatedposts-post-date" datetime="February 1, 2023" style="display: block;">February 1, 2023</time><p class="jp-relatedposts-post-context">In "aws"</p></div><div class="jp-relatedposts-post jp-relatedposts-post1 jp-relatedposts-post-thumbs" data-post-id="1001" data-post-format="false"><a class="jp-relatedposts-post-a" href="https://securitycafe.ro/2015/07/31/netripper-smart-traffic-sniffing-for-penetration-testers/" title="NetRipper &amp;#8211; Smart traffic sniffing for penetration testers" data-origin="2905" data-position="1"><img class="jp-relatedposts-post-img" loading="lazy" src="https://kpmgsecurity.files.wordpress.com/2015/07/ionut.jpg?w=350&amp;h=200&amp;crop=1" width="350" height="200" alt="Ionut"></a><h4 class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://securitycafe.ro/2015/07/31/netripper-smart-traffic-sniffing-for-penetration-testers/" title="NetRipper &amp;#8211; Smart traffic sniffing for penetration testers" data-origin="2905" data-position="1">NetRipper – Smart traffic sniffing for penetration testers</a></h4><p class="jp-relatedposts-post-excerpt">Ionut Popescu, Senior Security Consultant @ KPMG Romania&nbsp;has been accepted as speaker at the prestigious DEFCON conference. He will present one of his projects: NetRipper tool, developed especially to be used in penetration testing projects. The conference will be held in Las Vegas, Nevada, between 6-9 August 2015. NetRipper -…</p><time class="jp-relatedposts-post-date" datetime="July 31, 2015" style="display: block;">July 31, 2015</time><p class="jp-relatedposts-post-context">In "Conferences"</p></div><div class="jp-relatedposts-post jp-relatedposts-post2 jp-relatedposts-post-thumbs" data-post-id="2172" data-post-format="false"><a class="jp-relatedposts-post-a" href="https://securitycafe.ro/2022/04/08/iot-pentesting-101-how-to-hack-mqtt-the-standard-for-iot-messaging/" title="IoT Pentesting 101: How to Hack MQTT &amp;#8211; The Standard for IoT Messaging" data-origin="2905" data-position="2"><img class="jp-relatedposts-post-img" loading="lazy" src="https://i0.wp.com/securitycafe.ro/wp-content/uploads/2022/02/iot_blogpost.png?resize=350%2C200&amp;ssl=1" width="350" height="200" srcset="https://i0.wp.com/securitycafe.ro/wp-content/uploads/2022/02/iot_blogpost.png?resize=350%2C200&amp;ssl=1 1x, https://i0.wp.com/securitycafe.ro/wp-content/uploads/2022/02/iot_blogpost.png?resize=525%2C300&amp;ssl=1 1.5x, https://i0.wp.com/securitycafe.ro/wp-content/uploads/2022/02/iot_blogpost.png?resize=700%2C400&amp;ssl=1 2x, https://i0.wp.com/securitycafe.ro/wp-content/uploads/2022/02/iot_blogpost.png?resize=1050%2C600&amp;ssl=1 3x" alt=""></a><h4 class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://securitycafe.ro/2022/04/08/iot-pentesting-101-how-to-hack-mqtt-the-standard-for-iot-messaging/" title="IoT Pentesting 101: How to Hack MQTT &amp;#8211; The Standard for IoT Messaging" data-origin="2905" data-position="2">IoT Pentesting 101: How to Hack MQTT – The Standard for IoT Messaging</a></h4><p class="jp-relatedposts-post-excerpt">Pentesting IoT MQTT protocol on emulated environment deployed using mosquitto. Dictionary attacks, DoS, or exploiting dummy ICS Environments are presented.</p><time class="jp-relatedposts-post-date" datetime="April 8, 2022" style="display: block;">April 8, 2022</time><p class="jp-relatedposts-post-context">In "Embedded systems security"</p></div></div></div></div>
		
	</div><!-- .entry-content -->

	<footer class="entry-footer">

		
			<div class="entry-tags clearfix">
				<span class="meta-tags">
					<a href="https://securitycafe.ro/tag/amazon/" rel="tag">amazon</a><a href="https://securitycafe.ro/tag/aws/" rel="tag">aws</a><a href="https://securitycafe.ro/tag/configuration-review/" rel="tag">configuration review</a><a href="https://securitycafe.ro/tag/container/" rel="tag">container</a><a href="https://securitycafe.ro/tag/docker/" rel="tag">docker</a><a href="https://securitycafe.ro/tag/eks/" rel="tag">eks</a><a href="https://securitycafe.ro/tag/k8s/" rel="tag">k8s</a><a href="https://securitycafe.ro/tag/kubernetes/" rel="tag">Kubernetes</a><a href="https://securitycafe.ro/tag/methodology/" rel="tag">methodology</a><a href="https://securitycafe.ro/tag/penetration-testing/" rel="tag">Penetration Testing</a><a href="https://securitycafe.ro/tag/pentesting/" rel="tag">pentesting</a><a href="https://securitycafe.ro/tag/permission/" rel="tag">permission</a><a href="https://securitycafe.ro/tag/pods/" rel="tag">pods</a><a href="https://securitycafe.ro/tag/policies/" rel="tag">policies</a><a href="https://securitycafe.ro/tag/privilege-escalation/" rel="tag">privilege escalation</a><a href="https://securitycafe.ro/tag/roles/" rel="tag">roles</a><a href="https://securitycafe.ro/tag/secrets/" rel="tag">secrets</a><a href="https://securitycafe.ro/tag/security-context/" rel="tag">security context</a><a href="https://securitycafe.ro/tag/service-account/" rel="tag">service account</a><a href="https://securitycafe.ro/tag/services/" rel="tag">services</a><a href="https://securitycafe.ro/tag/verbs/" rel="tag">verbs</a><a href="https://securitycafe.ro/tag/vulnerability/" rel="tag">vulnerability</a>				</span>
			</div><!-- .entry-tags -->
			
	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://securitycafe.ro/2023/02/01/our-defcamp-2022-talks-are-here/" rel="prev"><span class="screen-reader-text">Previous Post:</span> Our DefCamp 2022 talks are here!</a></div><div class="nav-next"><a href="https://securitycafe.ro/2023/03/08/ec2stepshell-reverse-shells-private-ec2-instances/" rel="next"><span class="screen-reader-text">Next Post:</span> EC2StepShell: A Tool for Getting Reverse Shells on Instances with Network Restrictions</a></div></div>
	</nav>
	</footer><!-- .entry-footer -->

</article>

	<div id="comments" class="comments-area">

		
		
			<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title"><span>Leave a Reply</span> <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2023/02/27/a-complete-kubernetes-config-review-methodology/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://securitycafe.ro/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate="">


<div id="comment-form__verbum" class="transparent"></div><div class="verbum-form-meta"><input type="hidden" name="comment_post_ID" value="2905" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">

			<input type="hidden" name="highlander_comment_nonce" id="highlander_comment_nonce" value="2903fa8ac3">
			<input type="hidden" name="verbum_show_subscription_modal" value=""></div><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="f44e67a9ce"></p><p style="display: none !important;" class="akismet-fields-container" data-prefix="ak_"><label>Δ<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_1" name="ak_js" value="1718452255048"><script>document.getElementById( "ak_js_1" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>	</div><!-- #respond -->
	
	</div><!-- #comments -->


		</main><!-- #main -->
	</section><!-- #primary -->

	
	<section id="secondary" class="sidebar widget-area clearfix" role="complementary">

		<div class="widget-wrap"><aside id="block-3" class="widget widget_block widget_search clearfix"><form role="search" method="get" action="https://securitycafe.ro/" class="wp-block-search__button-outside wp-block-search__icon-button wp-block-search"><label class="wp-block-search__label has-small-font-size" for="wp-block-search__input-1">Search</label><div class="wp-block-search__inside-wrapper " style="width: 100%"><input class="wp-block-search__input has-small-font-size" id="wp-block-search__input-1" placeholder="" value="" type="search" name="s" required=""><button aria-label="Search" class="wp-block-search__button has-small-font-size has-icon wp-element-button" type="submit"><svg class="search-icon" viewBox="0 0 24 24" width="24" height="24">
					<path d="M13 5c-3.3 0-6 2.7-6 6 0 1.4.5 2.7 1.3 3.7l-3.8 3.8 1.1 1.1 3.8-3.8c1 .8 2.3 1.3 3.7 1.3 3.3 0 6-2.7 6-6S16.3 5 13 5zm0 10.5c-2.5 0-4.5-2-4.5-4.5s2-4.5 4.5-4.5 4.5 2 4.5 4.5-2 4.5-4.5 4.5z"></path>
				</svg></button></div></form></aside></div><div class="widget-wrap"><aside id="top-posts-3" class="widget widget_top-posts clearfix"><div class="widget-header"><h3 class="widget-title">Top Posts</h3></div><ul><li><a href="https://securitycafe.ro/2024/03/12/how-to-install-ipa-files-on-iphone-without-jailbreak/" class="bump-view" data-bump-view="tp">How to Install .ipa Files on iPhone Without Jailbreak</a></li><li><a href="https://securitycafe.ro/2023/05/15/ai-hacking-games-jailbreak-ctfs/" class="bump-view" data-bump-view="tp">Introduction to AI Prompt Injections (Jailbreak CTFs)</a></li><li><a href="https://securitycafe.ro/2024/05/08/aws-cloudquarry-digging-for-secrets-in-public-amis/" class="bump-view" data-bump-view="tp">AWS CloudQuarry: Digging for Secrets in Public AMIs</a></li><li><a href="https://securitycafe.ro/2022/09/05/mobile-pentesting-101-bypassing-biometric-authentication/" class="bump-view" data-bump-view="tp">Mobile Pentesting 101 - Bypassing Biometric Authentication</a></li><li><a href="https://securitycafe.ro/2022/02/01/root-detection-and-ssl-pinning-bypass/" class="bump-view" data-bump-view="tp">Root detection and SSL pinning bypass</a></li></ul></aside></div><div class="widget-wrap"><aside id="blog-stats-3" class="widget widget_blog-stats clearfix"><div class="widget-header"><h3 class="widget-title">Blog Stats</h3></div>		<ul>
			<li>388,347 hits</li>
		</ul>
		</aside></div><div class="widget-wrap"><aside id="blog_subscription-2" class="widget widget_blog_subscription jetpack_subscription_widget clearfix"><div class="widget-header"><h3 class="widget-title"><label for="subscribe-field">Follow us via Email</label></h3></div>

			<div class="wp-block-jetpack-subscriptions__container">
			<form action="https://subscribe.wordpress.com" method="post" accept-charset="utf-8" data-blog="78950108" data-post_access_level="everybody" id="subscribe-blog">
				<p>Enter your email address to follow this blog and receive notifications of new posts by email.</p>
				<p id="subscribe-email">
					<label id="subscribe-field-label" for="subscribe-field" class="screen-reader-text">
						Email Address:					</label>

					<input type="email" name="email" style="width: 95%; padding: 1px 10px" placeholder="Email Address" value="" id="subscribe-field" required="">				</p>

				<p id="subscribe-submit">
					<input type="hidden" name="action" value="subscribe">
					<input type="hidden" name="blog_id" value="78950108">
					<input type="hidden" name="source" value="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/">
					<input type="hidden" name="sub-type" value="widget">
					<input type="hidden" name="redirect_fragment" value="subscribe-blog">
					<input type="hidden" id="_wpnonce" name="_wpnonce" value="fe7234971c">					<button type="submit" class="wp-block-button__link">
						Follow					</button>
				</p>
			</form>
							<div class="wp-block-jetpack-subscriptions__subscount">
					Join 148 other subscribers				</div>
						</div>
			
</aside></div><div class="widget-wrap"><aside id="categories-5" class="widget widget_categories clearfix"><div class="widget-header"><h3 class="widget-title">Categories</h3></div>
			<ul>
					<li class="cat-item cat-item-35699"><a href="https://securitycafe.ro/category/active-directory/">Active Directory</a> (3)
</li>
	<li class="cat-item cat-item-217"><a href="https://securitycafe.ro/category/announcements/">Announcements</a> (2)
</li>
	<li class="cat-item cat-item-112614"><a href="https://securitycafe.ro/category/c2/">C2</a> (1)
</li>
	<li class="cat-item cat-item-10250297"><a href="https://securitycafe.ro/category/cloud-security/">Cloud Security</a> (10)
<ul class="children">
	<li class="cat-item cat-item-144203"><a href="https://securitycafe.ro/category/cloud-security/aws/">aws</a> (8)
</li>
	<li class="cat-item cat-item-335778"><a href="https://securitycafe.ro/category/cloud-security/azure/">Azure</a> (1)
</li>
	<li class="cat-item cat-item-46713213"><a href="https://securitycafe.ro/category/cloud-security/kubernetes/">Kubernetes</a> (1)
</li>
</ul>
</li>
	<li class="cat-item cat-item-9204"><a href="https://securitycafe.ro/category/conferences/">Conferences</a> (4)
</li>
	<li class="cat-item cat-item-27124032"><a href="https://securitycafe.ro/category/embedded-systems-security/">Embedded systems security</a> (3)
<ul class="children">
	<li class="cat-item cat-item-644897326"><a href="https://securitycafe.ro/category/embedded-systems-security/iot-pentesting/">IoT Pentesting</a> (2)
</li>
</ul>
</li>
	<li class="cat-item cat-item-625073"><a href="https://securitycafe.ro/category/ethical-hacking/">Ethical Hacking</a> (17)
</li>
	<li class="cat-item cat-item-297221"><a href="https://securitycafe.ro/category/general-security/">General security</a> (13)
</li>
	<li class="cat-item cat-item-553931643"><a href="https://securitycafe.ro/category/it-security-assurance/">IT Security Assurance</a> (1)
</li>
	<li class="cat-item cat-item-191013437"><a href="https://securitycafe.ro/category/it-security-audit/">IT Security Audit</a> (2)
</li>
	<li class="cat-item cat-item-35640384"><a href="https://securitycafe.ro/category/metasploit-2/">Metasploit</a> (1)
</li>
	<li class="cat-item cat-item-277"><a href="https://securitycafe.ro/category/misc/">Misc</a> (18)
<ul class="children">
	<li class="cat-item cat-item-12374"><a href="https://securitycafe.ro/category/misc/artificial-intelligence/">Artificial Intelligence</a> (1)
</li>
	<li class="cat-item cat-item-348621"><a href="https://securitycafe.ro/category/misc/code-review/">Code Review</a> (1)
</li>
	<li class="cat-item cat-item-5010150"><a href="https://securitycafe.ro/category/misc/cve/">CVE</a> (1)
</li>
</ul>
</li>
	<li class="cat-item cat-item-201499"><a href="https://securitycafe.ro/category/mobile-security/">Mobile security</a> (10)
</li>
	<li class="cat-item cat-item-45655"><a href="https://securitycafe.ro/category/network-security/">Network security</a> (6)
</li>
	<li class="cat-item cat-item-3015"><a href="https://securitycafe.ro/category/operating-systems/">Operating systems</a> (2)
</li>
	<li class="cat-item cat-item-177400"><a href="https://securitycafe.ro/category/penetration-testing/">Penetration Testing</a> (22)
</li>
	<li class="cat-item cat-item-222642394"><a href="https://securitycafe.ro/category/pentest-techniques/">Pentest techniques</a> (30)
</li>
	<li class="cat-item cat-item-668"><a href="https://securitycafe.ro/category/research/">Research</a> (1)
</li>
	<li class="cat-item cat-item-225051"><a href="https://securitycafe.ro/category/web-security/">Web security</a> (12)
</li>
	<li class="cat-item cat-item-324046"><a href="https://securitycafe.ro/category/wireless-security/">Wireless security</a> (1)
</li>
			</ul>

			</aside></div>
	</section><!-- #secondary -->



	</div><!-- #content -->

	
	<div id="footer" class="footer-wrap">

		<footer id="colophon" class="site-footer container clearfix" role="contentinfo">

			
			
		<div class="site-info">

			<a href="https://wordpress.com/?ref=footer_blog" rel="nofollow">Blog at WordPress.com.</a>
			
			
		</div><!-- .site-info -->

		
		</footer><!-- #colophon -->

	</div>

</div><!-- #page -->

<!--  -->
	<div style="display:none">
	</div>
	<div id="actionbar" class="actnbr-premium-tortuga actnbr-has-follow">
		<ul>
								<li class="actnbr-btn actnbr-hidden">
						<a class="actnbr-action actnbr-actn-comment" href="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/#respond">
							<svg class="gridicon gridicons-comment" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M12 16l-5 5v-5H5c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2h14c1.1 0 2 .9 2 2v9c0 1.1-.9 2-2 2h-7z"></path></g></svg>							<span>Comment						</span>
						</a>
					</li>
									<li class="actnbr-btn actnbr-hidden">
						<a class="actnbr-action actnbr-actn-reblog" href="">
							<svg class="gridicon gridicons-reblog" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M22.086 9.914L20 7.828V18c0 1.105-.895 2-2 2h-7v-2h7V7.828l-2.086 2.086L14.5 8.5 19 4l4.5 4.5-1.414 1.414zM6 16.172V6h7V4H6c-1.105 0-2 .895-2 2v10.172l-2.086-2.086L.5 15.5 5 20l4.5-4.5-1.414-1.414L6 16.172z"></path></g></svg><span>Reblog</span>
						</a>
					</li>
									<li class="actnbr-btn actnbr-hidden">
								<a class="actnbr-action actnbr-actn-follow " href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path clip-rule="evenodd" d="m4 4.5h12v6.5h1.5v-6.5-1.5h-1.5-12-1.5v1.5 10.5c0 1.1046.89543 2 2 2h7v-1.5h-7c-.27614 0-.5-.2239-.5-.5zm10.5 2h-9v1.5h9zm-5 3h-4v1.5h4zm3.5 1.5h-1v1h1zm-1-1.5h-1.5v1.5 1 1.5h1.5 1 1.5v-1.5-1-1.5h-1.5zm-2.5 2.5h-4v1.5h4zm6.5 1.25h1.5v2.25h2.25v1.5h-2.25v2.25h-1.5v-2.25h-2.25v-1.5h2.25z" fill-rule="evenodd"></path></svg>
			<span>Subscribe</span>
		</a>
		<a class="actnbr-action actnbr-actn-following  no-display" href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 4.5H4V15C4 15.2761 4.22386 15.5 4.5 15.5H11.5V17H4.5C3.39543 17 2.5 16.1046 2.5 15V4.5V3H4H16H17.5V4.5V12.5H16V4.5ZM5.5 6.5H14.5V8H5.5V6.5ZM5.5 9.5H9.5V11H5.5V9.5ZM12 11H13V12H12V11ZM10.5 9.5H12H13H14.5V11V12V13.5H13H12H10.5V12V11V9.5ZM5.5 12H9.5V13.5H5.5V12Z" fill="#008A20"></path><path class="following-icon-tick" d="M13.5 16L15.5 18L19 14.5" stroke="#008A20" stroke-width="1.5"></path></svg>
			<span>Subscribed</span>
		</a>
							<div class="actnbr-popover tip tip-top-left actnbr-notice" id="follow-bubble">
							<div class="tip-arrow"></div>
							<div class="tip-inner actnbr-follow-bubble">
															<ul>
											<li class="actnbr-sitename">
			<a href="https://securitycafe.ro">
				<img alt="" src="https://secure.gravatar.com/blavatar/c798a440ec703a17d8eda6a25b9dac06fa8162164e7e563dbc832069a934ce2b?s=50&amp;d=https%3A%2F%2Fs0.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png" srcset="https://secure.gravatar.com/blavatar/c798a440ec703a17d8eda6a25b9dac06fa8162164e7e563dbc832069a934ce2b?s=50&amp;d=https%3A%2F%2Fs0.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png 1x, https://secure.gravatar.com/blavatar/c798a440ec703a17d8eda6a25b9dac06fa8162164e7e563dbc832069a934ce2b?s=75&amp;d=https%3A%2F%2Fs0.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png 1.5x, https://secure.gravatar.com/blavatar/c798a440ec703a17d8eda6a25b9dac06fa8162164e7e563dbc832069a934ce2b?s=100&amp;d=https%3A%2F%2Fs0.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png 2x, https://secure.gravatar.com/blavatar/c798a440ec703a17d8eda6a25b9dac06fa8162164e7e563dbc832069a934ce2b?s=150&amp;d=https%3A%2F%2Fs0.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png 3x, https://secure.gravatar.com/blavatar/c798a440ec703a17d8eda6a25b9dac06fa8162164e7e563dbc832069a934ce2b?s=200&amp;d=https%3A%2F%2Fs0.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png 4x" class="avatar avatar-50" height="50" width="50">				Security Café			</a>
		</li>
										<div class="actnbr-message no-display"></div>
									<form method="post" action="https://subscribe.wordpress.com" accept-charset="utf-8" style="display: none;">
																						<div class="actnbr-follow-count">Join 148 other subscribers</div>
																					<div>
										<input type="email" name="email" placeholder="Enter your email address" class="actnbr-email-field" aria-label="Enter your email address">
										</div>
										<input type="hidden" name="action" value="subscribe">
										<input type="hidden" name="blog_id" value="78950108">
										<input type="hidden" name="source" value="https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/">
										<input type="hidden" name="sub-type" value="actionbar-follow">
										<input type="hidden" id="_wpnonce" name="_wpnonce" value="fe7234971c">										<div class="actnbr-button-wrap">
											<button type="submit" value="Sign me up">
												Sign me up											</button>
										</div>
									</form>
									<li class="actnbr-login-nudge">
										<div>
											Already have a WordPress.com account? <a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fsecuritycafe.ro%252F2023%252F02%252F27%252Fa-complete-kubernetes-config-review-methodology%252F">Log in now.</a>										</div>
									</li>
								</ul>
															</div>
						</div>
					</li>
									<li class="actnbr-btn actnbr-hidden no-display" onclick="javascript:__tcfapi( 'showUi' );">
						<a class="actnbr-action actnbr-actn-privacy" href="#">
							<svg class="gridicon gridicons-info-outline" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M13 9h-2V7h2v2zm0 2h-2v6h2v-6zm-1-7c-4.41 0-8 3.59-8 8s3.59 8 8 8 8-3.59 8-8-3.59-8-8-8m0-2c5.523 0 10 4.477 10 10s-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2z"></path></g></svg>							<span>Privacy						</span>
						</a>
					</li>
							<li class="actnbr-ellipsis actnbr-hidden">
				<svg class="gridicon gridicons-ellipsis" height="24" width="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M7 12c0 1.104-.896 2-2 2s-2-.896-2-2 .896-2 2-2 2 .896 2 2zm12-2c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2zm-7 0c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2z"></path></g></svg>				<div class="actnbr-popover tip tip-top-left actnbr-more">
					<div class="tip-arrow"></div>
					<div class="tip-inner">
						<ul>
									<li class="actnbr-sitename">
			<a href="https://securitycafe.ro">
				<img alt="" src="https://secure.gravatar.com/blavatar/c798a440ec703a17d8eda6a25b9dac06fa8162164e7e563dbc832069a934ce2b?s=50&amp;d=https%3A%2F%2Fs0.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png" srcset="https://secure.gravatar.com/blavatar/c798a440ec703a17d8eda6a25b9dac06fa8162164e7e563dbc832069a934ce2b?s=50&amp;d=https%3A%2F%2Fs0.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png 1x, https://secure.gravatar.com/blavatar/c798a440ec703a17d8eda6a25b9dac06fa8162164e7e563dbc832069a934ce2b?s=75&amp;d=https%3A%2F%2Fs0.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png 1.5x, https://secure.gravatar.com/blavatar/c798a440ec703a17d8eda6a25b9dac06fa8162164e7e563dbc832069a934ce2b?s=100&amp;d=https%3A%2F%2Fs0.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png 2x, https://secure.gravatar.com/blavatar/c798a440ec703a17d8eda6a25b9dac06fa8162164e7e563dbc832069a934ce2b?s=150&amp;d=https%3A%2F%2Fs0.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png 3x, https://secure.gravatar.com/blavatar/c798a440ec703a17d8eda6a25b9dac06fa8162164e7e563dbc832069a934ce2b?s=200&amp;d=https%3A%2F%2Fs0.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png 4x" class="avatar avatar-50" height="50" width="50">				Security Café			</a>
		</li>
								<li class="actnbr-folded-customize">
								<a href="https://kpmgsecurity.wordpress.com/wp-admin/customize.php?url=https%3A%2F%2Fkpmgsecurity.wordpress.com%2F2023%2F02%2F27%2Fa-complete-kubernetes-config-review-methodology%2F">
									<svg class="gridicon gridicons-customize" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M2 6c0-1.505.78-3.08 2-4 0 .845.69 2 2 2 1.657 0 3 1.343 3 3 0 .386-.08.752-.212 1.09.74.594 1.476 1.19 2.19 1.81L8.9 11.98c-.62-.716-1.214-1.454-1.807-2.192C6.753 9.92 6.387 10 6 10c-2.21 0-4-1.79-4-4zm12.152 6.848l1.34-1.34c.607.304 1.283.492 2.008.492 2.485 0 4.5-2.015 4.5-4.5 0-.725-.188-1.4-.493-2.007L18 9l-2-2 3.507-3.507C18.9 3.188 18.225 3 17.5 3 15.015 3 13 5.015 13 7.5c0 .725.188 1.4.493 2.007L3 20l2 2 6.848-6.848c1.885 1.928 3.874 3.753 5.977 5.45l1.425 1.148 1.5-1.5-1.15-1.425c-1.695-2.103-3.52-4.092-5.448-5.977z"></path></g></svg>									<span>Customize</span>
								</a>
							</li>
																<li class="actnbr-folded-follow">
												<a class="actnbr-action actnbr-actn-follow " href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path clip-rule="evenodd" d="m4 4.5h12v6.5h1.5v-6.5-1.5h-1.5-12-1.5v1.5 10.5c0 1.1046.89543 2 2 2h7v-1.5h-7c-.27614 0-.5-.2239-.5-.5zm10.5 2h-9v1.5h9zm-5 3h-4v1.5h4zm3.5 1.5h-1v1h1zm-1-1.5h-1.5v1.5 1 1.5h1.5 1 1.5v-1.5-1-1.5h-1.5zm-2.5 2.5h-4v1.5h4zm6.5 1.25h1.5v2.25h2.25v1.5h-2.25v2.25h-1.5v-2.25h-2.25v-1.5h2.25z" fill-rule="evenodd"></path></svg>
			<span>Subscribe</span>
		</a>
		<a class="actnbr-action actnbr-actn-following  no-display" href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 4.5H4V15C4 15.2761 4.22386 15.5 4.5 15.5H11.5V17H4.5C3.39543 17 2.5 16.1046 2.5 15V4.5V3H4H16H17.5V4.5V12.5H16V4.5ZM5.5 6.5H14.5V8H5.5V6.5ZM5.5 9.5H9.5V11H5.5V9.5ZM12 11H13V12H12V11ZM10.5 9.5H12H13H14.5V11V12V13.5H13H12H10.5V12V11V9.5ZM5.5 12H9.5V13.5H5.5V12Z" fill="#008A20"></path><path class="following-icon-tick" d="M13.5 16L15.5 18L19 14.5" stroke="#008A20" stroke-width="1.5"></path></svg>
			<span>Subscribed</span>
		</a>
										</li>
																	<li class="actnbr-signup"><a href="https://wordpress.com/start/">Sign up</a></li>
									<li class="actnbr-login"><a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fsecuritycafe.ro%252F2023%252F02%252F27%252Fa-complete-kubernetes-config-review-methodology%252F">Log in</a></li>
																	<li class="actnbr-shortlink"><a href="https://wp.me/p5lgwQ-KR">Copy shortlink</a></li>
																	<li class="flb-report">
										<a href="https://wordpress.com/abuse/?report_url=https://securitycafe.ro/2023/02/27/a-complete-kubernetes-config-review-methodology/" target="_blank" rel="noopener noreferrer">
											Report this content										</a>
									</li>
																	<li class="actnbr-reader">
										<a href="https://wordpress.com/read/blogs/78950108/posts/2905">
											View post in Reader										</a>
									</li>
																	<li class="actnbr-subs">
										<a href="https://subscribe.wordpress.com/">Manage subscriptions</a>
									</li>
																		<li class="actnbr-fold"><a href="">Collapse this bar</a></li>
															</ul>
					</div>
				</div>
			</li>
		</ul>
	</div>
	
<script>
window.addEventListener( "load", function( event ) {
	var link = document.createElement( "link" );
	link.href = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.css?v=20240115";
	link.type = "text/css";
	link.rel = "stylesheet";
	document.head.appendChild( link );

	var script = document.createElement( "script" );
	script.src = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.js?v=20231122";
	script.defer = true;
	document.body.appendChild( script );
} );
</script>

			<div id="jp-carousel-loading-overlay">
			<div id="jp-carousel-loading-wrapper">
				<span id="jp-carousel-library-loading">&nbsp;</span>
			</div>
		</div>
		<div class="jp-carousel-overlay" style="display: none;">

		<div class="jp-carousel-container">
			<!-- The Carousel Swiper -->
			<div class="jp-carousel-wrap swiper-container jp-carousel-swiper-container jp-carousel-transitions" itemscope="" itemtype="https://schema.org/ImageGallery">
				<div class="jp-carousel swiper-wrapper"></div>
				<div class="jp-swiper-button-prev swiper-button-prev">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskPrev" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="9" height="12">
							<path d="M16.2072 16.59L11.6496 12L16.2072 7.41L14.8041 6L8.8335 12L14.8041 18L16.2072 16.59Z" fill="white"></path>
						</mask>
						<g mask="url(#maskPrev)">
							<rect x="0.579102" width="23.8823" height="24" fill="#FFFFFF"></rect>
						</g>
					</svg>
				</div>
				<div class="jp-swiper-button-next swiper-button-next">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskNext" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="8" height="12">
							<path d="M8.59814 16.59L13.1557 12L8.59814 7.41L10.0012 6L15.9718 12L10.0012 18L8.59814 16.59Z" fill="white"></path>
						</mask>
						<g mask="url(#maskNext)">
							<rect x="0.34375" width="23.8822" height="24" fill="#FFFFFF"></rect>
						</g>
					</svg>
				</div>
			</div>
			<!-- The main close buton -->
			<div class="jp-carousel-close-hint">
				<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<mask id="maskClose" mask-type="alpha" maskUnits="userSpaceOnUse" x="5" y="5" width="15" height="14">
						<path d="M19.3166 6.41L17.9135 5L12.3509 10.59L6.78834 5L5.38525 6.41L10.9478 12L5.38525 17.59L6.78834 19L12.3509 13.41L17.9135 19L19.3166 17.59L13.754 12L19.3166 6.41Z" fill="white"></path>
					</mask>
					<g mask="url(#maskClose)">
						<rect x="0.409668" width="23.8823" height="24" fill="#FFFFFF"></rect>
					</g>
				</svg>
			</div>
			<!-- Image info, comments and meta -->
			<div class="jp-carousel-info">
				<div class="jp-carousel-info-footer">
					<div class="jp-carousel-pagination-container">
						<div class="jp-swiper-pagination swiper-pagination"></div>
						<div class="jp-carousel-pagination"></div>
					</div>
					<div class="jp-carousel-photo-title-container">
						<h2 class="jp-carousel-photo-caption"></h2>
					</div>
					<div class="jp-carousel-photo-icons-container">
						<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-info" aria-label="Toggle photo metadata visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskInfo" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M12.7537 2C7.26076 2 2.80273 6.48 2.80273 12C2.80273 17.52 7.26076 22 12.7537 22C18.2466 22 22.7046 17.52 22.7046 12C22.7046 6.48 18.2466 2 12.7537 2ZM11.7586 7V9H13.7488V7H11.7586ZM11.7586 11V17H13.7488V11H11.7586ZM4.79292 12C4.79292 16.41 8.36531 20 12.7537 20C17.142 20 20.7144 16.41 20.7144 12C20.7144 7.59 17.142 4 12.7537 4C8.36531 4 4.79292 7.59 4.79292 12Z" fill="white"></path>
									</mask>
									<g mask="url(#maskInfo)">
										<rect x="0.8125" width="23.8823" height="24" fill="#FFFFFF"></rect>
									</g>
								</svg>
							</span>
						</a>
												<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-comments" aria-label="Toggle photo comments visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskComments" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M4.3271 2H20.2486C21.3432 2 22.2388 2.9 22.2388 4V16C22.2388 17.1 21.3432 18 20.2486 18H6.31729L2.33691 22V4C2.33691 2.9 3.2325 2 4.3271 2ZM6.31729 16H20.2486V4H4.3271V18L6.31729 16Z" fill="white"></path>
									</mask>
									<g mask="url(#maskComments)">
										<rect x="0.34668" width="23.8823" height="24" fill="#FFFFFF"></rect>
									</g>
								</svg>

								<span class="jp-carousel-has-comments-indicator" aria-label="This image has comments."></span>
							</span>
						</a>
											</div>
				</div>
				<div class="jp-carousel-info-extra">
					<div class="jp-carousel-info-content-wrapper">
						<div class="jp-carousel-photo-title-container">
							<h2 class="jp-carousel-photo-title"></h2>
						</div>
						<div class="jp-carousel-comments-wrapper">
															<div id="jp-carousel-comments-loading">
									<span>Loading Comments...</span>
								</div>
								<div class="jp-carousel-comments"></div>
								<div id="jp-carousel-comment-form-container">
									<span id="jp-carousel-comment-form-spinner">&nbsp;</span>
									<div id="jp-carousel-comment-post-results"></div>
																														<form id="jp-carousel-comment-form">
												<label for="jp-carousel-comment-form-comment-field" class="screen-reader-text">Write a Comment...</label>
												<textarea name="comment" class="jp-carousel-comment-form-field jp-carousel-comment-form-textarea" id="jp-carousel-comment-form-comment-field" placeholder="Write a Comment..."></textarea>
												<div id="jp-carousel-comment-form-submit-and-info-wrapper">
													<div id="jp-carousel-comment-form-commenting-as">
																													<fieldset>
																<label for="jp-carousel-comment-form-email-field">Email (Required)</label>
																<input type="text" name="email" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-email-field">
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-author-field">Name (Required)</label>
																<input type="text" name="author" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-author-field">
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-url-field">Website</label>
																<input type="text" name="url" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-url-field">
															</fieldset>
																											</div>
													<input type="submit" name="submit" class="jp-carousel-comment-form-button" id="jp-carousel-comment-form-button-submit" value="Post Comment">
												</div>
											</form>
																											</div>
													</div>
						<div class="jp-carousel-image-meta">
							<div class="jp-carousel-title-and-caption">
								<div class="jp-carousel-photo-info">
									<h3 class="jp-carousel-caption" itemprop="caption description"></h3>
								</div>

								<div class="jp-carousel-photo-description"></div>
							</div>
							<ul class="jp-carousel-image-exif" style="display: none;"></ul>
							<a class="jp-carousel-image-download" href="#" target="_blank" style="display: none;">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="3" y="3" width="19" height="18">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M5.84615 5V19H19.7775V12H21.7677V19C21.7677 20.1 20.8721 21 19.7775 21H5.84615C4.74159 21 3.85596 20.1 3.85596 19V5C3.85596 3.9 4.74159 3 5.84615 3H12.8118V5H5.84615ZM14.802 5V3H21.7677V10H19.7775V6.41L9.99569 16.24L8.59261 14.83L18.3744 5H14.802Z" fill="white"></path>
									</mask>
									<g mask="url(#mask0)">
										<rect x="0.870605" width="23.8823" height="24" fill="#FFFFFF"></rect>
									</g>
								</svg>
								<span class="jp-carousel-download-text"></span>
							</a>
							<div class="jp-carousel-image-map" style="display: none;"></div>
						</div>
					</div>
				</div>
			</div>
		</div>

		</div>
		
	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/securitycafe.ro\/2023\/02\/27\/a-complete-kubernetes-config-review-methodology\/":2905};
	</script>
				<link crossorigin="anonymous" rel="stylesheet" id="all-css-0-2" href="https://s0.wp.com/_static/??-eJydjEEKgCAQAD+UrR6KLtFbTJfQdJXWxe9HUB/oOMMw0KtyhRpSgyyqJjkCMURs1brzZWAhyMVLQgZnryKMCbiHipfahXzC0TEP8H/2NZ94fltezbxMxkx61vEGx+U/hQ==&amp;cssminify=yes" type="text/css" media="all">
<script type="text/javascript" id="comment-like-js-extra">
/* <![CDATA[ */
var comment_like_text = {"loading":"Loading...","swipeUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/comment-likes\/js\/lib\/swipe.js?ver=20131008"};
/* ]]> */
</script>
<script type="text/javascript" id="coblocks-loader-js-extra">
/* <![CDATA[ */
var wpcom_coblocks_js = {"coblocks_masonry_js":"https:\/\/s0.wp.com\/wp-content\/plugins\/coblocks\/2.18.1-simple-rev.4\/dist\/js\/coblocks-masonry.min.js","coblocks_lightbox_js":"https:\/\/s0.wp.com\/wp-content\/plugins\/coblocks\/2.18.1-simple-rev.4\/dist\/js\/coblocks-lightbox.min.js","jquery_core_js":"\/wp-includes\/js\/jquery\/jquery.min.js","jquery_migrate_js":"\/wp-includes\/js\/jquery\/jquery-migrate.min.js","masonry_js":"\/wp-includes\/js\/masonry.min.js","imagesloaded_js":"\/wp-includes\/js\/imagesloaded.min.js"};
var coblocksLigthboxData = {"closeLabel":"Close Gallery","leftLabel":"Previous","rightLabel":"Next"};
/* ]]> */
</script>
<script type="text/javascript" id="jetpack-carousel-js-extra">
/* <![CDATA[ */
var jetpackSwiperLibraryPath = {"url":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/jetpack-plugin\/sun\/_inc\/build\/carousel\/swiper-bundle.min.js"};
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/securitycafe.ro\/wp-admin\/admin-ajax.php","nonce":"dee9a0ad16","display_exif":"0","display_comments":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","copyright":"Copyright","comment_registration":"0","require_name_email":"1","login_url":"https:\/\/kpmgsecurity.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fsecuritycafe.ro%2F2023%2F02%2F27%2Fa-complete-kubernetes-config-review-methodology%2F","blog_id":"78950108","meta_data":["camera","aperture","shutter_speed","focal_length","copyright"],"stats_query_args":"blog=78950108&v=wpcom&tz=3&user_id=0&subd=kpmgsecurity","is_public":"1"};
/* ]]> */
</script>
<script type="text/javascript" id="sharing-js-js-extra">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script type="text/javascript" id="verbum-settings-js-before">
/* <![CDATA[ */
window.VerbumComments = {"Log in or provide your name and email to leave a reply.":"Log in or provide your name and email to leave a reply.","Log in or provide your name and email to leave a comment.":"Log in or provide your name and email to leave a comment.","Receive web and mobile notifications for posts on this site.":"Receive web and mobile notifications for posts on this site.","Name":"Name","Email (address never made public)":"Email (address never made public)","Website (optional)":"Website (optional)","Leave a reply. (log in optional)":"Leave a reply. (log in optional)","Leave a comment. (log in optional)":"Leave a comment. (log in optional)","Log in to leave a reply.":"Log in to leave a reply.","Log in to leave a comment.":"Log in to leave a comment.","Logged in via %s":"Logged in via %s","Log out":"Log out","Email":"Email","(Address never made public)":"(Address never made public)","Instantly":"Instantly","Daily":"Daily","Reply":"Reply","Comment":"Comment","WordPress":"WordPress","Weekly":"Weekly","Notify me of new posts":"Notify me of new posts","Email me new posts":"Email me new posts","Email me new comments":"Email me new comments","Cancel":"Cancel","Write a comment...":"Write a comment...","Write a reply...":"Write a reply...","Website":"Website","Optional":"Optional","We'll keep you in the loop!":"We'll keep you in the loop!","Loading your comment...":"Loading your comment...","Discover more from":"Discover more from Security Caf\u00e9","Subscribe now to keep reading and get access to the full archive.":"Subscribe now to keep reading and get access to the full archive.","Continue reading":"Continue reading","Never miss a beat!":"Never miss a beat!","Interested in getting blog post updates? Simply click the button below to stay in the loop!":"Interested in getting blog post updates? Simply click the button below to stay in the loop!","Enter your email address":"Enter your email address","Subscribe":"Subscribe","Comment sent successfully":"Comment sent successfully","Save my name, email, and website in this browser for the next time I comment.":"Save my name, email, and website in this browser for the next time I comment.","siteId":78950108,"postId":2905,"mustLogIn":false,"requireNameEmail":true,"commentRegistration":false,"connectURL":"https:\/\/kpmgsecurity.wordpress.com\/public.api\/connect\/?action=request&domain=securitycafe.ro","logoutURL":"https:\/\/kpmgsecurity.wordpress.com\/wp-login.php?action=logout&_wpnonce=ad61a9e8d4","homeURL":"https:\/\/securitycafe.ro\/","subscribeToBlog":true,"subscribeToComment":true,"isJetpackCommentsLoggedIn":false,"jetpackUsername":"","jetpackUserId":0,"jetpackSignature":"","jetpackAvatar":null,"enableBlocks":true,"enableSubscriptionModal":true,"currentLocale":"en","isJetpackComments":false,"allowedBlocks":["core\/paragraph","core\/list","core\/code","core\/list-item","core\/quote","core\/image","core\/embed","core\/quote","core\/code"],"embedNonce":"24cbd648ce","verbumBundleUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/jetpack-mu-wpcom-plugin\/sun\/vendor\/automattic\/jetpack-mu-wpcom\/src\/features\/verbum-comments\/dist\/index.js","isRTL":false,"vbeCacheBuster":1717067639}
/* ]]> */
</script>
<script crossorigin="anonymous" type="text/javascript" src="https://s0.wp.com/_static/??-eJydUe1OwzAMfCFSt1Cp/EE8Ckpjs6XNF3GyqW9PtKawDVQkfiU5n+/sC5yDUN4lcglsFsHkg3YMRs/E8JEp01E6NBSbiR/gd/JEKUg1iwKdg/K2FoCzgxM59BFkTt7KlLT6wQaOCsasDRZyHLMtFtYWCwbJTOXAxUmrlTBe4u4gtVGs0093wH3jd9dovJoZHpvuuekEaxsMiUinpgfUnFallbQNYbXb9LRTJuOtYaRglmvSTmxXab0VrZqFktFnJvNF24A/VOWs2VIST027ym3Ae7yQcS+/alE/5vb57034KCOhRFwuV+0OdYVX+9IN3dC3fTv00ye2jvLO"></script>
<script type="text/javascript" id="sharing-js-js-after">
/* <![CDATA[ */
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-linkedin' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-linkedin' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
						return false;
					}
				} );
			} )();
/* ]]> */
</script>

	<script type="text/javascript">
		(function () {
			var wpcom_reblog = {
				source: 'toolbar',

				toggle_reblog_box_flair: function (obj_id, post_id) {

					// Go to site selector. This will redirect to their blog if they only have one.
					const postEndpoint = `https://wordpress.com/post`;

					// Ideally we would use the permalink here, but fortunately this will be replaced with the 
					// post permalink in the editor.
					const originalURL = `${ document.location.href }?page_id=${ post_id }`; 
					
					const url =
						postEndpoint +
						'?url=' +
						encodeURIComponent( originalURL ) +
						'&is_post_share=true' +
						'&v=5';

					const redirect = function () {
						if (
							! window.open( url, '_blank' )
						) {
							location.href = url;
						}
					};

					if ( /Firefox/.test( navigator.userAgent ) ) {
						setTimeout( redirect, 0 );
					} else {
						redirect();
					}
				},
			};

			window.wpcom_reblog = wpcom_reblog;
		})();
	</script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script>	<iframe src="https://widgets.wp.com/likes/master.html?ver=20240614#ver=20240614&amp;origin=https://securitycafe.ro" scrolling="no" id="likes-master" name="likes-master" style="display:none;"></iframe>
	<div id="likes-other-gravatars" class="wpl-new-layout" role="dialog" aria-hidden="true" tabindex="-1">
		<div class="likes-text">
			<span>%d</span>		</div>
		<ul class="wpl-avatars sd-like-gravatars"></ul>
	</div>

		<script src="//stats.wp.com/w.js?67" defer=""></script> <script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'78950108','blog_tz':'3','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'78950108','v':'wpcom','tz':'3','user_id':'0','post':'2905','subd':'kpmgsecurity'}]);
		_stq.push(['extra', {'crypt':'UE40eW5QN0p8M2Y/RE1mNzc2NTVTamdsRWFxcEV3XUtMXVR5aWlmMVNIcUxBaFstUWRrZVpWQ2tORExSfEpUVm05SlpEZzZWOEtlbW5nZHV0dkhDNjhwP35JbkdHLyZqSTU5SSxHRVVfOFVnQjFDcSxWeGJoMD1jcHN1UV1EL2wxNyxUPy9BMjFybWN5Zjl3Qm1mVU04Tmlddi05Q25pZjVra0hUdm1peCV0NWFQTURsUCxEK1JbR0FJSGJtUzFxP1VISEYud0VQZy5OfjQvY0xWSjdBZiVFS09PLDRPV3V6UjRuU1E3WDFdYmZiR2ZUYk0zbU9UMjdzTnRHcEY1Tzk1dyU/cGo3JnB8fDB2ODlQQUYwWGVVd1B3c1JbRCwubGJLQXpjY0tEeC5BSHZOVXNjSSssTWVRPVJnQ2pdZE98X1N2Y29mQUlRdzc2d0FycUtra01KLlZPOVY5MlZTb29H'}]);
_stq.push([ 'clickTrackerInit', '78950108', '2905' ]);
</script>
<noscript><img src="https://pixel.wp.com/b.gif?v=noscript" style="height:1px;width:1px;overflow:hidden;position:absolute;bottom:1px;" alt="" /></noscript>
<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script>
<script type="disabled" id="wp-enqueue-dynamic-script:wp-i18n:after:1">
wp.i18n.setLocaleData( { 'text direction\u0004ltr': [ 'ltr' ] } );
</script>

<script>
(function() {
	'use strict';

	const fetches = {};
	const promises = {};
	const urls = {
		'wp-polyfill': 'https://s0.wp.com/wp-includes/js/dist/vendor/wp-polyfill.min.js?m=1710866488i&ver=3.15.0',
		'wp-hooks': 'https://s0.wp.com/wp-content/plugins/gutenberg-core/v18.4.1/build/hooks/index.min.js?m=1716578158i&ver=3aee234ea7807d8d70bc',
		'wp-i18n': 'https://s0.wp.com/wp-content/plugins/gutenberg-core/v18.4.1/build/i18n/index.min.js?m=1716578158i&ver=5baa98e4345eccc97e24',
		'verbum': 'https://s0.wp.com/wp-content/mu-plugins/jetpack-mu-wpcom-plugin/sun/vendor/automattic/jetpack-mu-wpcom/src/build/verbum-comments/verbum-comments.js?m=1718300862i&minify=false&ver=f722f8e738413ba13e41'
	};
	const loaders = {
		'verbum': () => {
			fetchExternalScript('wp-polyfill');
			fetchExternalScript('wp-hooks');
			fetchExternalScript('wp-i18n');
			fetchExternalScript('verbum');
			promises['wp-polyfill'] = promises['wp-polyfill'] || loadWPScript('wp-polyfill');
			promises['wp-hooks'] = promises['wp-hooks'] || promises['wp-polyfill'].then( () => loadWPScript('wp-hooks') );
			promises['wp-i18n'] = promises['wp-i18n'] || Promise.all( [ promises['wp-hooks'], promises['wp-polyfill'],  ] ).then( () => loadWPScript('wp-i18n') );
			promises['verbum'] = promises['verbum'] || promises['wp-i18n'].then( () => loadWPScript('verbum') );
			return promises['verbum'];
		},
		
	};
	const scriptExtras = {
		'wp-i18n': { translations: 0, before: 0, after: 1 },
		
	};

	window.WP_Enqueue_Dynamic_Script = {
		loadScript: (handle) => {
			if (!loaders[handle]) {
				console.error('WP_Enqueue_Dynamic_Script: unregistered script `' + handle + '`.');
			}
			return loaders[handle]();
		}
	};

	function fetchExternalScript(handle) {
		if (!urls[handle]) {
			return Promise.resolve();
		}

		fetches[handle] = fetches[handle] || fetch(urls[handle], { mode: 'no-cors' });
		return fetches[handle];
	}

	function runExtraScript(handle, type, index) {
		const id = 'wp-enqueue-dynamic-script:' + handle + ':' + type + ':' + (index + 1);
		const template = document.getElementById(id);
		if (!template) {
			return Promise.reject();
		}

		const script = document.createElement( 'script' );
		script.innerHTML = template.innerHTML;
		document.body.appendChild( script );
		return Promise.resolve();
	}

	function loadExternalScript(handle) {
		if (!urls[handle]) {
			return Promise.resolve();
		}

		return fetches[handle].then(() => {
			return new Promise((resolve, reject) => {
				const script = document.createElement('script');
				script.onload = () => resolve();
				script.onerror = (e) => reject(e);
				script.src = urls[handle];
				document.body.appendChild(script);
			});
		});
	}

	function loadExtra(handle, pos) {
		const count = (scriptExtras[handle] && scriptExtras[handle][pos]) || 0;
		let promise = Promise.resolve();

		for (let i = 0; i < count; i++) {
			promise = promise.then(() => runExtraScript(handle, pos, i));
		}

		return promise;
	}

	function loadWPScript(handle) {
		// Core loads scripts in this order. See: https://github.com/WordPress/WordPress/blob/a59eb9d39c4fcba834b70c9e8dfd64feeec10ba6/wp-includes/class-wp-scripts.php#L428.
		return loadExtra(handle, 'translations')
			.then(() => loadExtra(handle, 'before'))
			.then(() => loadExternalScript(handle))
			.then(() => loadExtra(handle, 'after'));
	}
} )();
</script>



<div class="comment-likes-overlay" style="display: none;"></div><iframe style="display: none;" scrolling="no" id="wpcom_remote_login_key" src="https://r-login.wordpress.com/remote-login.php?wpcom_remote_login=key&amp;origin=aHR0cHM6Ly9zZWN1cml0eWNhZmUucm8%3D&amp;wpcomid=78950108&amp;time=1718351017"></iframe><script src="https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.js?v=20231122" defer=""></script></body></html>