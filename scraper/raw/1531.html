<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head>
	<link rel="stylesheet" href="/styles/font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="/styles/styles.css" type="text/css">
<link rel="stylesheet" href="/styles/affiliates.css" type="text/css">
<link rel="stylesheet" href="/scripts/highlight/styles/railscasts.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Cookie">

<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"> 
<link rel="apple-touch-icon" href="/apple-touch-icon.png">

<link rel="alternate" type="application/rss+xml" title="Latest Updates" href="https://digi.ninja/rss.xml">

<link rel="manifest" href="/manifest.json">

<meta http-equiv="Content-Type" content="text/html;charset=utf-8">

<meta name="Author" content="Robin Wood - DigiNinja">
<meta name="twitter:site" content="@digininja">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#272727">

<script type="text/javascript" src="/scripts/highlight/highlight.pack.js"></script>
	<link rel="canonical" href="https://digi.ninja/projects/cewl.php">
	
	<title>CeWL - Custom Wordlist Generator - DigiNinja</title>
	<meta name="Description" content="CeWL spiders a target site and creates a list of all unique words found on the site, this list can then be used for things such as password brute forcing.">
	<meta name="Keywords" content="cewl,custom,wordlist,word,list,generator,spider,wifi,web,site,security,open source,projects,development,wifi,web,site,security,ethical,hacking,penetration,testing,website,application,ninja,digininja,freedom,software,karma,jasager,madwifi">

	<meta property="og:title" content="CeWL - Custom Wordlist Generator - DigiNinja">
	<meta property="og:description" content="CeWL spiders a target site and creates a list of all unique words found on the site, this list can then be used for things such as password brute forcing.">
	<meta property="og:url" content="/projects/cewl.php">
	<meta property="og:image" content="https://digi.ninja/images/cewl_cubes.png">
	<meta property="og:type" content="website">
	<meta property="og:sitename" content="DigiNinja">

	<meta name="twitter:card" content="summary">
	<meta name="twitter:title" content="CeWL - Custom Wordlist Generator - DigiNinja">
	<meta name="twitter:description" content="CeWL spiders a target site and creates a list of all unique words found on the site, this list can then be used for things such as password brute forcing.">
	<meta name="twitter:site" content="@digininja">
	<meta name="twitter:creator" content="@digininja">
	<meta name="twitter:domain" content="digi.ninja">
	<meta name="twitter:site" content="@digininja">
	<meta name="twitter:image" content="https://digi.ninja/images/cewl_cubes.png">
	</head>
<body>
	<div id="wrapper"> 
		<div id="header"></div>
		<div id="section"> 
			<div id="nav"><!-- nav -->
<ul><li><a class="link-breadcrumb" href="/">Home</a></li><li><a class="link-breadcrumb" href="/about.php">Hire me</a></li><li><a class="link-breadcrumb" href="/labs.php">Labs</a></li><li><a class="link-breadcrumb" href="/blog.php">Blog</a></li><li class="active"><a class="link-breadcrumb" href="/projects.php">Projects</a></li><li><a class="link-breadcrumb" href="/contact.php">Contact</a></li></ul><ul class="social">
    <li><a title="RSS Feed" href="/rss.xml"><i class="fa fa-rss" aria-hidden="true"></i></a></li>


	<!-- twitter -->
	<li>
		<a title="Share on Twitter" id="twitter-share" href="https://twitter.com/share?text=CeWL - Custom Wordlist Generator&amp;url=https://digi.ninja/projects/cewl.php" rel="noopener" target="_blank"><i class="fa fa-twitter"></i></a>
	</li>
	<!-- facebook -->
	<li>
		<a title="Share on Facebook" id="facebook-share" href="https://www.facebook.com/sharer/sharer.php?u=https://digi.ninja/projects/cewl.php" rel="noopener" target="_blank"><i class="fa fa-facebook"></i></a>
	</li>
	<!-- google plus -->
	<li>
		<a title="Share on Google+" id="google-plus-share" href="https://plus.google.com/share?url=https://digi.ninja/projects/cewl.php" rel="noopener" target="_blank"><i class="fa fa-google-plus"></i></a>
	</li>
	<!-- pinterest -->
	<li>
		<a title="Share on Pintrest" id="pinterest-share" href="https://pinterest.com/pin/create/button/?url=https://digi.ninja/projects/cewl.php&amp;description=CeWL - Custom Wordlist Generator" rel="noopener" target="_blank"><i class="fa fa-pinterest"></i></a>
	</li>
	<!-- linkedin -->
	<li>
		<a title="Share on LinkedIn" id="linked-in-share" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://digi.ninja/projects/cewl.php&amp;title=CeWL - Custom Wordlist Generator" rel="noopener" target="_blank"><i class="fa fa-linkedin"></i></a>
	</li>
	<!-- reddit -->
	<li>
		<a title="Share on Reddit" id="reddit-share" href="https:////www.reddit.com/submit?url=https://digi.ninja/projects/cewl.php&amp;title=CeWL - Custom Wordlist Generator" rel="noopener" target="_blank"><i class="fa fa-reddit"></i></a>
	</li>
	<!-- hacker news -->
	<li>
		<a title="Share on Hacker News" id="hacker-news-share" href="https://news.ycombinator.com/submitlink?u=https://digi.ninja/projects/cewl.php&amp;t=CeWL - Custom Wordlist Generator" rel="noopener" target="_blank"><i class="fa fa-hacker-news"></i></a>
	</li>
</ul>
</div><!-- nav close -->


			<div id="banner"></div>
<div id="content" class="clearfix">
				
				<div id="article" class="clearfix">
					<h1><span>CeWL - Custom Word List generator</span></h1>	<ul class="breadcrumbs">
		<li><a class="link-breadcrumb" href="/">Home</a></li><li><a class="link-breadcrumb" href="/projects.php">Projects</a></li><li><a class="link-breadcrumb" href="/projects_general.php">General</a></li><li><a class="link-breadcrumb" href="/projects/cewl.php">CeWL - Custom Word List</a></li>
	</ul>    
		<p>
			Based on a discussion on <a rel="nofollow" href="http://wiki.securityweekly.com/wiki/index.php/Episode129">PaulDotCom episode 129</a> about creating custom word lists by spidering a targets website and collecting unique words I decided to write CeWL, the Custom Word List generator. CeWL is a ruby app which spiders a given url to a specified depth, optionally following external links, and returns a list of words which can then be used for password crackers such as <a rel="nofollow" href="http://www.openwall.com/john/">John the Ripper</a>.
		</p>
		<p>
			CeWL also has an associated command line app, FAB (Files Already Bagged) which uses the same meta data extraction techniques to create author/creator lists from already downloaded.
		</p>
		<h2><span>Change Log</span></h2>    
		<h3><span>Version 5.2</span></h3>
		<p>
			Loads of changes including:
		</p>
		<ul class="list">
			<li>Code refactoring by <a href="https://twitter.com/g0tmi1k" rel="nofollow">@g0tmi1k</a></li>
			<li>Internationalisation - should now handle non-ASCII sites much better</li>
			<li>Found more ways to pull words out of JavaScript content and other areas that aren't normal HTML</li>
			<li>Lots of little bug fixes</li>
		</ul>
		<h3><span>Version 5.1</span></h3>
		<p>
			Added the GPL-3+ licence to allow inclusion in Debian.
		</p>
		<p>
			Added a Gemfile to make installing gems easier.
		</p>
		<h3><span>Version 5.0</span></h3>    
<p>
Adds proxy support from the command line and the ability to pass in
credentials for both basic and digest authentication. Usage is simple, check
the help (<code>--help</code>) for full information.
</p>
<p>
A few other smaller bug fixes as well.
</p>

		<h3><span>Version 4.3</span></h3>    
		<p>
			CeWL now sorts the words found by count and optionally (new --count argument) includes the word count in the output. I've left the words in the case they are in the pages so "Product" is different to "product" I figure that if it is being used for password generation then the case may be significant so let the user strip it if they want to. There are also more improvments to the stability of the spider in this release.
		</p>
		<p>
			By default, CeWL sticks to just the site you have specified and will go to a depth of 2 links, this behaviour can be changed by passing arguments. Be careful if setting a large depth and allowing it to go offsite, you could end up drifting on to a lot of other domains. All words of three characters and over are output to stdout. This length can be increased and the words can be written to a file rather than screen so the app can be automated.
		</p>
		<h3><span>Version 4.2</span></h3>    
		<p>
			Version 4.2 fixes a pretty major bug that I found while fixing a smaller bug for @yorikv. The bug was related to a hack I had to put in place because of a problem I was having with the spider, while I was looking in to it I spotted this line which is the one that the spider uses to find new links in downloaded pages:
		</p>
<pre><code class="hljs cpp">web_page.scan(/href=<span class="hljs-string">"(.*?)"</span>/i).flatten.<span class="hljs-built_in">map</span> <span class="hljs-keyword">do</span> |link|</code></pre>
		<p>
			This is fine if all the links look like this:
		</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"test.php"</span>&gt;</span>link<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>
		<p>
			But if the link looks like either of these:
		</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">'test.php'</span>&gt;</span>link<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">test.php</span>&gt;</span>link<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>
		<p>
			the regex will fail so the links will be ignored.
		</p>
		<p>
			To fix this up I've had to override the function that parses the page to find all the links, rather than use a regex I've changed it to use Nokogiri which is designed to parse a page looking for links rather than just running through it with a custom regex. This brings in a new dependency but I think it is worth it for the fix to the functionality. I also found another bug where a link like this:
		</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">'#name'</span>&gt;</span>local<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre>
		<p>
			which should be ignored as it just links to an internal name was actually being translated to '/#name' which may unintentionally mean referencing the index page. I've fixed this one as well after a lot of debugging to find how best to do it.
		</p>
		<p>
			A final addition is to allow a user to specify a depth of 0 which allows CeWL to spider a single page.
		</p>
		<p>
			I'm only putting this out as a point release as I'd like to rewrite the spidering to use a better spider, that will come out as the next major release.
		</p>

		<h3><span>Version 4.1</span></h3>    
		<p>
			Version 4.1 is mainly bug fixes but one important feature change is the addition of two new parameters, meta_file and email_file. Previously you specified the filename for email and metadata output as optional fields to the email and meta parameters but I found that if you used the parameters in a specific order you could end up with this:
		</p>
<pre><code class="hljs sql">./cewl.rb <span class="hljs-comment">--email http://www.digininja.org</span></code></pre>
		<p>
			This would take the URL as the output filename for the email parameter which isn't what is meant, hence removing the optional filename from the email parameter and adding the email_file parameter instead.
		</p>
		<p>
			The main change in version 4 is the upgrade to run with Ruby 1.9.x, this has been tested on various machines and on BT5 as that is a popular platform for running it and it appears to run fine. Another minor change is that Up to version 4 all HTML tags were stripped out before the page was parsed for words, this meant that text in alt and title tags were missed. I now grab the text from those tags before stripping the HTML to give those extra few works.
		</p>
		<h3><span>Version 3.0</span></h3>    
		<p>
			Version 3 of CeWL addresses a problem spotted by Josh Wright. The Spider gem doesn't handle JavaScript redirection URLs, for exmaple an index page containing just the following:
		</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">language</span>=<span class="hljs-string">"JavaScript"</span>&gt;</span><span class="javascript">
self.location.href =
<span class="hljs-string">'http://www.FOO.com/FOO/connect/FOONet/Top+Navigator/Home'</span>;
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
		<p>
			wasn't spidered because the redirect wasn't picked up. I now scan through a page looking for any lines containing "location.href=" and then add the given URL to the list of pages to spider.
		</p>
		<h3><span>Version 2.0</span></h3>    
		<p>
			Version 2 of CeWL can also create two new lists, a list of email addresses found in mailto links and a list of author/creator names collected from meta data found in documents on the site. It can currently process documents in Office pre 2007, Office 2007 and PDF formats. This user data can then be used to create the list of usernames to be used in association with the password list.
		</p>
		<h2><span><a name="pronunciation"></a>Pronunciation</span></h2>
		<p>
			Seeing as I was asked, CeWL is pronounced "cool".
		</p>
		<h2><span><a name="download"></a>Download</span></h2>
		<p>
			The latest version is now available on <a href="https://github.com/digininja/CeWL/" rel="nofollow">GitHub</a>. Tagged releases are also available in various distros, including Kali.
		</p>
		<p>
			<a href="https://github.com/digininja/CeWL/releases/tag/5.2">download cewl version 5.2</a><br>
			<a href="https://github.com/digininja/CeWL/releases/tag/5.1">download cewl version 5.1</a><br>
			<a href="/files/cewl_5.0.tar.bz2">download cewl version 5.0</a><br>
			<a href="/files/cewl_4.3.tar.bz2">download cewl version 4.3</a><br>
			<a href="/files/cewl_4.2.tar.bz2">download cewl version 4.2</a><br>
			<a href="/files/cewl_4.1.tar.bz2">download cewl version 4.1</a><br>
			<a href="/files/cewl_3.0.tar.bz2">download cewl version 3.0</a>
		</p>
		<h2><span><a name="installation"></a>Installation</span></h2>
		<p>
			CeWL needs the rubygems package to be installed along with the following gems:
		</p>
					<ul class="list">
			<li>nokogiri</li>
			<li>mime-types</li>
			<li>mini_exiftool</li>
			<li>rubyzip</li>
			<li>spider</li>
		</ul>
		<p>
			These can be installed by running
		</p>
		<pre><code class="hljs sql">bundle <span class="hljs-keyword">install</span></code></pre>
		<p>
		from the cewl directory. The mini_exiftool gem also requires the exiftool application to be installed.
		</p>
		<p>
			On BT5 there is a problem with the version of Ruby installed by default. To get around this I've found the following works well on a brand new BT5 install:
		</p>
<pre><code class="hljs sql">gem source -c
gem <span class="hljs-keyword">install</span> <span class="hljs-comment">--user-install spider http_configuration mini_exiftool zip mime-types</span></code></pre>
		<p>
			To use the gems you may also need to set the following environment variable:
		</p>
		<pre><code class="hljs ini"><span class="hljs-attr">RUBYOPT</span>=<span class="hljs-string">"rubygems"</span></code></pre>
		<p>
			Then just save CeWL to a directory and make it executable.
		</p>
		<h2><span><a name="usage"></a>Usage</span></h2>
		<p>
			cewl [OPTION] ... URL
		</p>
		<dl class="usage">
			<dt>--help, -h</dt><dd>Show help</dd>
			<dt>--depth x, -d x</dt><dd>The depth to spider to, default 2</dd>
			<dt>--min_word_length, -m</dt><dd>The minimum word length, this strips out all words under the specified length, default 3</dd>
			<dt>--offsite, -o</dt><dd>By default, the spider will only visit the site specified. With this option it will also visit external sites</dd>
			<dt>--write, -w file</dt><dd>Write the ouput to the file rather than to stdout</dd>
			<dt>--ua, -u user-agent</dt><dd>Change the user agent</dd>
			<dt>-v</dt><dd>Verbose, show debug and extra output</dd>
			<dt>--no-words, -n</dt><dd>Don't output the wordlist</dd>
			<dt>--meta, -a file</dt><dd>Include meta data, optional output file</dd>
			<dt>--email, -e file</dt><dd>Include email addresses, optional output file</dd>
			<dt>--meta_file file</dt><dd>Filename for metadata output</dd>
			<dt>--email_file file</dt><dd>Filename for email output</dd>
			<dt>--meta-temp-dir directory</dt><dd>The directory used used by exiftool when parsing files, the default is /tmp</dd>
			<dt>--count, -c:</dt><dd>Show the count for each of the words found</dd>
			<dt>--auth_type</dt><dd>Digest or basic</dd>
			<dt>--auth_user</dt><dd>Authentication username</dd>
			<dt>--auth_pass</dt><dd>Authentication password</dd>
			<dt>--proxy_host</dt><dd>Proxy host</dd>
			<dt>--proxy_port</dt><dd>Proxy port, default 8080</dd>
			<dt>--proxy_username</dt><dd>Username for proxy, if required</dd>
			<dt>--proxy_password</dt><dd>Password for proxy, if required</dd>
			<dt>--verbose, -v</dt><dd>Verbose</dd>


			<dt>URL</dt><dd>The site to spider.</dd>
		</dl>
		<h2><span><a name="problems"></a>Common Problems</span></h2>
		<p>
			Here are a couple of the common problems people have seen while trying to use CeWL and FAB.
		</p>
		<h3><span>Missing exiftool</span></h3>
		<p>
		If you see this error while trying to run either CeWL or FAB
		</p>
<pre><code class="hljs coffeescript">
/usr/lib/ruby/gems/<span class="hljs-number">1.8</span>/gems/mini_exiftool<span class="hljs-number">-1.0</span><span class="hljs-number">.1</span>/lib/mini_exiftool.rb:<span class="hljs-number">246</span>:<span class="hljs-keyword">in</span> `<span class="javascript">exiftool_version<span class="hljs-string">': Command '</span>exiftool<span class="hljs-string">' not found (MiniExiftool::Error)
from /usr/lib/ruby/gems/1.8/gems/mini_exiftool-1.0.1/lib/mini_exiftool.rb:265
from /usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:36:in </span></span>`gem_original_require<span class="hljs-string">'
from /usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:36:in `require'</span>
from ./cewl_lib.rb:<span class="hljs-number">1</span>
from /usr/local/lib/site_ruby/<span class="hljs-number">1.8</span>/rubygems/custom_require.rb:<span class="hljs-number">31</span>:<span class="hljs-keyword">in</span> `<span class="javascript"><span class="hljs-string">gem_original_require'</span>
<span class="hljs-keyword">from</span> /usr/local/lib/site_ruby/<span class="hljs-number">1.8</span>/rubygems/custom_require.rb:<span class="hljs-number">31</span>:<span class="hljs-keyword">in</span> </span>`<span class="hljs-built_in">require</span><span class="hljs-string">'
from ./cewl.rb:58</span></code></pre>
		<p>
			then the application can't access exiftool. Either install it or make sure it is in your path.
		</p>
		<h3><span>HTTPS Problem</span></h3>
		<p>
			It has been reported that if you see this problem
		</p>
<pre><code class="hljs sql">/usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require': no such file to <span class="hljs-keyword">load</span> <span class="hljs-comment">-- net/https (LoadError)</span>
<span class="hljs-keyword">from</span> /usr/<span class="hljs-keyword">local</span>/lib/site_ruby/<span class="hljs-number">1.8</span>/rubygems/custom_require.rb:<span class="hljs-number">31</span>:<span class="hljs-keyword">in</span> <span class="hljs-string">`require'
from /usr/lib/ruby/gems/1.8/gems/spider-0.4.4/lib/spider/spider_instance.rb:30
from /usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:31:in `</span>gem_original_require<span class="hljs-string">'
from /usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:31:in `require'</span>
<span class="hljs-keyword">from</span> /usr/lib/ruby/gems/<span class="hljs-number">1.8</span>/gems/spider<span class="hljs-number">-0.4</span><span class="hljs-number">.4</span>/lib/spider.rb:<span class="hljs-number">26</span>
<span class="hljs-keyword">from</span> /usr/<span class="hljs-keyword">local</span>/lib/site_ruby/<span class="hljs-number">1.8</span>/rubygems/custom_require.rb:<span class="hljs-number">36</span>:<span class="hljs-keyword">in</span> <span class="hljs-string">`gem_original_require'
from /usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:36:in `</span>require<span class="hljs-string">'
from ./cewl.rb:56</span></code></pre>
		<p>
			Then you need the Ruby libopenssl package. In Debian the package is called libopenssl-ruby.
		</p>
		<h3><span>Spider Missing Pages</span></h3>
		<p>
			Someone has reported that the spider misses some pages which are have querystrings on them. I haven't been able to reproduce this in my tests. If anyone has this problem and can reproduce it please let me know and I'll investigate it further.
		</p>
				</div><!-- article close -->
<div id="aside">
	<h3><span>Table of Contents</span></h3>    
					<ul class="list">
		<li><a href="#pronunciation">Pronunciation</a></li>
		<li><a href="#download">Download</a></li>
		<li><a href="#installation">Installation</a></li>
		<li><a href="#usage">Usage</a></li>
		<li><a href="#problems">Common Problems</a></li>
	</ul>
	<h3><span>Categories</span></h3>    
					<ul class="list">
		<li><a href="/projects_wifi.php">Wifi</a></li>
		<li><a href="/projects_networking.php">Networking</a></li>
		<li><a href="/projects_metasploit.php">Metasploit</a></li>
		<li><a href="/projects_general.php">General</a></li>
	</ul>

	<div>
	<h3><span>Support The Site</span></h3>
	<p>
		I don't get paid for any of the projects on this site so if you'd like to support my work you can do so by using the affiliate links below where I either get account credits or cash back. Usually only pennies, but they all add up.
	</p>
	<div class="amazon-links">
		<p>
		<a class="bmc-button" target="_blank" href="https://www.buymeacoffee.com/digininja"><img src="/styles/images/bmc-new-btn-logo.png" alt="Buy me a smoothie"><span>Buy me a smoothie</span></a>
		</p>
		<p>
		<a id="tpw-button" href="https://www.theproteinworks.com/referral-program/MTMyODg0NGoydA==/"><img src="/styles/images/tpw.png" alt="The Protein Works"></a>
		</p>
	</div>
</div>

</div><!-- aside -->	
			</div><!-- content close -->
		</div><!-- section close -->
			
		<div id="footer">
  	<p id="designedby">
	All content created by <a href="https://twitter.com/digininja" rel="author">Robin Wood</a> unless otherwise stated
	</p>
</div><!-- footer -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-9T9CFM6WE0"></script>
<script type="text/javascript" src="/google_analytics.js"></script>
		  
	</div><!-- wrapper close -->


</body></html>