<html lang="en" data-rh="lang"><head><title>Snake&amp;Apple IV—Dylib Hijacking | Medium</title><meta data-rh="true" charset="utf-8"><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"><meta data-rh="true" name="theme-color" content="#000000"><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"><meta data-rh="true" property="al:ios:app_name" content="Medium"><meta data-rh="true" property="al:ios:app_store_id" content="828256236"><meta data-rh="true" property="al:android:package" content="com.medium.reader"><meta data-rh="true" property="fb:app_id" content="542599432471018"><meta data-rh="true" property="og:site_name" content="Medium"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-01-17T11:31:10.817Z"><meta data-rh="true" name="title" content="Snake&amp;Apple IV—Dylib Hijacking | Medium"><meta data-rh="true" property="og:title" content="Snake&amp;Apple IV — Dylibs"><meta data-rh="true" property="al:android:url" content="medium://p/2c955439b94e"><meta data-rh="true" property="al:ios:url" content="medium://p/2c955439b94e"><meta data-rh="true" property="al:android:app_name" content="Medium"><meta data-rh="true" name="description" content="The article describes the concept of libraries and how to detect Dylib Hijacking vulnerability and secure applications against it on macOS."><meta data-rh="true" property="og:description" content="Automating Dylib Hijacking detection with Python."><meta data-rh="true" property="og:url" content="https://karol-mazurek.medium.com/snake-apple-iv-dylibs-2c955439b94e"><meta data-rh="true" property="al:web:url" content="https://karol-mazurek.medium.com/snake-apple-iv-dylibs-2c955439b94e"><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/da:true/resize:fit:1200/0*HgjbPiuRBfG57HPL"><meta data-rh="true" property="article:author" content="https://karol-mazurek.medium.com"><meta data-rh="true" name="author" content="Karol Mazurek"><meta data-rh="true" name="robots" content="index,follow,max-image-preview:large"><meta data-rh="true" name="referrer" content="unsafe-url"><meta data-rh="true" property="twitter:title" content="Snake&amp;Apple IV — Dylibs"><meta data-rh="true" name="twitter:site" content="@Medium"><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/2c955439b94e"><meta data-rh="true" property="twitter:description" content="Automating Dylib Hijacking detection with Python."><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/da:true/resize:fit:1200/0*HgjbPiuRBfG57HPL"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="twitter:label1" content="Reading time"><meta data-rh="true" name="twitter:data1" content="19 min read"><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/1*m-R_BkNf1Qjr1YbyOIJY2w.png"><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:152:152/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:120:120/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:76:76/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:60:60/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/Medium-Avatar-500x500.svg" color="#171717"><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossorigin=""><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"><link data-rh="true" rel="author" href="https://karol-mazurek.medium.com"><link data-rh="true" rel="canonical" href="https://karol-mazurek.medium.com/snake-apple-iv-dylibs-2c955439b94e"><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/2c955439b94e"><style type="text/css" data-fela-rehydration="471" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="471" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-webkit-keyframes k1{0%{transform:translate(-50%, -100px)}100%{transform:translate(-50%, 0)}}@-moz-keyframes k1{0%{transform:translate(-50%, -100px)}100%{transform:translate(-50%, 0)}}@keyframes k1{0%{transform:translate(-50%, -100px)}100%{transform:translate(-50%, 0)}}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{margin-left:16px}.av{border:none}.aw{border-radius:20px}.ax{width:240px}.ay{background:#F9F9F9}.az path{fill:#6B6B6B}.bb{outline:none}.bc{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bd{font-size:14px}.be{width:100%}.bf{padding:10px 20px 10px 0}.bg{background-color:transparent}.bh{color:#242424}.bi::placeholder{color:#6B6B6B}.bj{display:inline-block}.bk{margin-left:12px}.bl{margin-right:12px}.bm{border-radius:4px}.bn{margin-left:24px}.bo{height:24px}.bu{background-color:#F9F9F9}.bv{border-radius:50%}.bw{height:32px}.bx{width:32px}.by{justify-content:center}.ce{max-width:680px}.cf{min-width:0}.cg{animation:k1 1.2s ease-in-out infinite}.ch{height:100vh}.ci{margin-bottom:16px}.cj{margin-top:48px}.ck{align-items:flex-start}.cl{flex-direction:column}.cm{justify-content:space-between}.cn{margin-bottom:24px}.ct{width:80%}.cu{background-color:#F2F2F2}.da{height:44px}.db{width:44px}.dc{margin:auto 0}.dd{margin-bottom:4px}.de{height:16px}.df{width:120px}.dg{width:80px}.dm{margin-bottom:8px}.dn{width:96%}.do{width:98%}.dp{width:81%}.dq{margin-left:8px}.dr{color:#6B6B6B}.ds{font-size:13px}.dt{height:100%}.el{color:#FFFFFF}.em{fill:#FFFFFF}.eo{background:#1A8917}.ep{border-color:#1A8917}.et:disabled{cursor:inherit !important}.eu:disabled{opacity:0.3}.ev:disabled:hover{background:#1A8917}.ew:disabled:hover{border-color:#1A8917}.ex{border-radius:99em}.ey{border-width:1px}.ez{border-style:solid}.fa{box-sizing:border-box}.fb{text-decoration:none}.fc{text-align:center}.ff{margin-right:32px}.fg{position:relative}.fh{fill:#6B6B6B}.fk{background:transparent}.fl svg{margin-left:4px}.fm svg{fill:#6B6B6B}.fo{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fp{position:absolute}.fr{display:none}.fx{margin:0 24px}.gb{background:rgba(255, 255, 255, 1)}.gc{border:1px solid #F2F2F2}.gd{box-shadow:0 1px 4px #F2F2F2}.ge{max-height:100vh}.gf{overflow-y:auto}.gg{left:0}.gh{top:calc(100vh + 100px)}.gi{bottom:calc(100vh + 100px)}.gj{width:10px}.gk{pointer-events:none}.gq{margin-right:4px}.gr{margin-top:2px}.gs{box-sizing:content-box}.gt{word-break:break-word}.gu{word-wrap:break-word}.gv:after{display:block}.gw:after{content:""}.gx:after{clear:both}.gy{line-height:1.23}.gz{letter-spacing:0}.ha{font-style:normal}.hb{font-weight:700}.hw{margin-top:0px}.hx{@media all and (max-width: 551.98px):8px}.hy{@media all and (min-width: 552px) and (max-width: 727.98px):8px}.hz{@media all and (min-width: 728px) and (max-width: 903.98px):16px}.ia{@media all and (min-width: 904px) and (max-width: 1079.98px):16px}.ib{@media all and (min-width: 1080px):16px}.ih{align-items:baseline}.ii{width:48px}.ij{height:48px}.ik{border:2px solid rgba(255, 255, 255, 1)}.il{z-index:0}.im{box-shadow:none}.in{border:1px solid rgba(0, 0, 0, 0.05)}.io{margin-bottom:2px}.ip{flex-wrap:nowrap}.iq{font-size:16px}.ir{line-height:24px}.it{margin:0 8px}.iu{display:inline}.iv{color:#1A8917}.iw{fill:#1A8917}.iz{flex:0 0 auto}.jc{flex-wrap:wrap}.jd{padding-left:8px}.je{padding-right:8px}.kf> *{flex-shrink:0}.kg{overflow-x:scroll}.kh::-webkit-scrollbar{display:none}.ki{scrollbar-width:none}.kj{-ms-overflow-style:none}.kk{width:74px}.kl{flex-direction:row}.km{z-index:2}.kp{-webkit-user-select:none}.kq{border:0}.kr{fill:rgba(117, 117, 117, 1)}.ku{outline:0}.kv{user-select:none}.kw> svg{pointer-events:none}.lf{cursor:progress}.lg{opacity:1}.lh{padding:4px 0}.lk{width:16px}.lm{display:inline-flex}.ls{max-width:100%}.lt{padding:8px 2px}.lu svg{color:#6B6B6B}.ml{line-height:1.58}.mm{letter-spacing:-0.004em}.mn{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.ni{margin-bottom:-0.46em}.nj{margin-left:auto}.nk{margin-right:auto}.nl{max-width:1600px}.nr{clear:both}.nt{cursor:zoom-in}.nu{z-index:auto}.nw{height:auto}.nx{line-height:1.12}.ny{letter-spacing:-0.022em}.nz{font-weight:600}.ou{margin-bottom:-0.28em}.pa{text-decoration:underline}.pb{border-top:none}.ph{height:52px}.pi{max-height:52px}.pj{position:static}.pk{z-index:1}.pm{max-width:155px}.ps{margin-right:20px}.py{align-items:flex-end}.pz{width:76px}.qa{height:76px}.qb{border:2px solid #F9F9F9}.qc{height:72px}.qd{width:72px}.qe{padding:8px 16px}.qf{width:auto}.qg{stroke:#F2F2F2}.qh{height:36px}.qi{width:36px}.qj{color:#F2F2F2}.qk{fill:#F2F2F2}.ql{background:#F2F2F2}.qm{border-color:#F2F2F2}.qs{font-weight:500}.qt{font-size:24px}.qu{line-height:30px}.qv{letter-spacing:-0.016em}.qw{margin-top:8px}.qx{margin-top:16px}.qy{height:0px}.qz{border-bottom:solid 1px #E5E5E5}.ra{margin-top:72px}.rb{padding:24px 0}.rc{margin-bottom:0px}.rd{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.eq:hover{background:#156D12}.er:hover{border-color:#156D12}.es:hover{cursor:pointer}.fi:hover{color:#242424}.fj:hover{fill:#242424}.fn:hover svg{fill:#242424}.fq:hover{background-color:rgba(0, 0, 0, 0.1)}.is:hover{text-decoration:underline}.ix:hover:not(:disabled){color:#156D12}.iy:hover:not(:disabled){fill:#156D12}.kt:hover{fill:rgba(8, 8, 8, 1)}.li:hover{fill:#000000}.lj:hover p{color:#000000}.ll:hover{color:#000000}.lv:hover svg{color:#000000}.qn:hover{background:#F2F2F2}.qo:hover{border-color:#F2F2F2}.qp:hover{cursor:wait}.qq:hover{color:#F2F2F2}.qr:hover{fill:#F2F2F2}.ba:focus-within path{fill:#242424}.ks:focus{fill:rgba(8, 8, 8, 1)}.lw:focus svg{color:#000000}.nv:focus{transform:scale(1.01)}.kx:active{border-style:none}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bt{width:64px}.cd{margin:0 64px}.cs{height:48px}.cz{margin-bottom:52px}.dl{margin-bottom:48px}.ec{font-size:14px}.ed{line-height:20px}.ej{font-size:13px}.ek{padding:5px 12px}.fe{display:flex}.fw{margin-bottom:68px}.ga{max-width:680px}.gp{margin-top:40px}.hs{font-size:42px}.ht{margin-bottom:32px}.hu{line-height:52px}.hv{letter-spacing:-0.011em}.ig{align-items:center}.jr{border-top:solid 1px #F2F2F2}.js{border-bottom:solid 1px #F2F2F2}.jt{margin:32px 0 0}.ju{padding:3px 8px}.kd> *{margin-right:24px}.ke> :last-child{margin-right:0}.le{margin-top:0px}.lr{margin:0}.ne{font-size:20px}.nf{margin-top:2.14em}.ng{line-height:32px}.nh{letter-spacing:-0.003em}.nq{margin-top:56px}.oq{font-size:24px}.or{margin-top:1.95em}.os{line-height:30px}.ot{letter-spacing:-0.016em}.oz{margin-top:0.94em}.pg{margin-bottom:88px}.pr{display:inline-block}.px{padding-top:72px}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.ld{margin-top:0px}.pq{display:inline-block}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.lc{margin-top:0px}.pp{display:inline-block}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.la{margin-top:0px}.lb{margin-right:0px}.po{display:inline-block}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bp{width:24px}.bz{margin:0 24px}.co{height:40px}.cv{margin-bottom:44px}.dh{margin-bottom:32px}.du{font-size:13px}.dv{line-height:20px}.ee{padding:0px 8px 1px}.fs{margin-bottom:4px}.gl{margin-top:32px}.hc{font-size:32px}.hd{margin-bottom:24px}.he{line-height:38px}.hf{letter-spacing:-0.014em}.ic{align-items:flex-start}.ja{flex-direction:column}.jf{margin:24px -24px 0}.jg{padding:0}.jv> *{margin-right:8px}.jw> :last-child{margin-right:24px}.kn{margin-left:0px}.ky{margin-top:0px}.kz{margin-right:0px}.ln{margin:0}.lx{border:1px solid #F2F2F2}.ly{border-radius:99em}.lz{padding:0px 16px 0px 12px}.ma{height:38px}.mb{align-items:center}.md svg{margin-right:8px}.mo{font-size:18px}.mp{margin-top:1.56em}.mq{line-height:28px}.mr{letter-spacing:-0.003em}.nm{margin-top:40px}.oa{font-size:20px}.ob{margin-top:1.2em}.oc{line-height:24px}.od{letter-spacing:0}.ov{margin-top:0.67em}.pc{margin-bottom:80px}.pn{display:inline-block}.pt{padding-top:48px}.mc:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bs{width:64px}.cc{margin:0 64px}.cr{height:48px}.cy{margin-bottom:52px}.dk{margin-bottom:48px}.ea{font-size:14px}.eb{line-height:20px}.eh{font-size:13px}.ei{padding:5px 12px}.fd{display:flex}.fv{margin-bottom:68px}.fz{max-width:680px}.go{margin-top:40px}.ho{font-size:42px}.hp{margin-bottom:32px}.hq{line-height:52px}.hr{letter-spacing:-0.011em}.if{align-items:center}.jn{border-top:solid 1px #F2F2F2}.jo{border-bottom:solid 1px #F2F2F2}.jp{margin:32px 0 0}.jq{padding:3px 8px}.kb> *{margin-right:24px}.kc> :last-child{margin-right:0}.lq{margin:0}.na{font-size:20px}.nb{margin-top:2.14em}.nc{line-height:32px}.nd{letter-spacing:-0.003em}.np{margin-top:56px}.om{font-size:24px}.on{margin-top:1.95em}.oo{line-height:30px}.op{letter-spacing:-0.016em}.oy{margin-top:0.94em}.pf{margin-bottom:88px}.pw{padding-top:72px}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.br{width:64px}.cb{margin:0 48px}.cq{height:48px}.cx{margin-bottom:52px}.dj{margin-bottom:48px}.dy{font-size:13px}.dz{line-height:20px}.eg{padding:0px 8px 1px}.fu{margin-bottom:68px}.fy{max-width:680px}.gn{margin-top:40px}.hk{font-size:42px}.hl{margin-bottom:32px}.hm{line-height:52px}.hn{letter-spacing:-0.011em}.ie{align-items:center}.jj{border-top:solid 1px #F2F2F2}.jk{border-bottom:solid 1px #F2F2F2}.jl{margin:32px 0 0}.jm{padding:3px 8px}.jz> *{margin-right:24px}.ka> :last-child{margin-right:0}.lp{margin:0}.mw{font-size:20px}.mx{margin-top:2.14em}.my{line-height:32px}.mz{letter-spacing:-0.003em}.no{margin-top:56px}.oi{font-size:24px}.oj{margin-top:1.95em}.ok{line-height:30px}.ol{letter-spacing:-0.016em}.ox{margin-top:0.94em}.pe{margin-bottom:88px}.pv{padding-top:72px}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bq{width:24px}.ca{margin:0 24px}.cp{height:40px}.cw{margin-bottom:44px}.di{margin-bottom:32px}.dw{font-size:13px}.dx{line-height:20px}.ef{padding:0px 8px 1px}.ft{margin-bottom:4px}.gm{margin-top:32px}.hg{font-size:32px}.hh{margin-bottom:24px}.hi{line-height:38px}.hj{letter-spacing:-0.014em}.id{align-items:flex-start}.jb{flex-direction:column}.jh{margin:24px 0 0}.ji{padding:0}.jx> *{margin-right:8px}.jy> :last-child{margin-right:8px}.ko{margin-left:0px}.lo{margin:0}.me{border:1px solid #F2F2F2}.mf{border-radius:99em}.mg{padding:0px 16px 0px 12px}.mh{height:38px}.mi{align-items:center}.mk svg{margin-right:8px}.ms{font-size:18px}.mt{margin-top:1.56em}.mu{line-height:28px}.mv{letter-spacing:-0.003em}.nn{margin-top:40px}.oe{font-size:20px}.of{margin-top:1.2em}.og{line-height:24px}.oh{letter-spacing:0}.ow{margin-top:0.67em}.pd{margin-bottom:80px}.pu{padding-top:48px}.mj:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE" media="print">.pl{display:none}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.ns{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style><script type="text/javascript" async="" src="https://www.gstatic.com/recaptcha/releases/TqxSU0dsOd2Q9IbI7CpFnJLD/recaptcha__pl.js" crossorigin="anonymous" integrity="sha384-EtuwsrUt4o3rjKbOIgbMlrdETicyC7YJiOMF4S2kRPR2c6EcUDPrB1OFkiSEO3IC"></script><script async="" src="https://cdn.branch.io/branch-latest.min.js"></script><script type="application/ld+json" data-rh="true">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fda:true\u002Fresize:fit:1200\u002F0*HgjbPiuRBfG57HPL"],"url":"https:\u002F\u002Fkarol-mazurek.medium.com\u002Fsnake-apple-iv-dylibs-2c955439b94e","dateCreated":"2024-01-17T11:31:10.817Z","datePublished":"2024-01-17T11:31:10.817Z","dateModified":"2024-02-19T11:26:05.487Z","headline":"Snake&Apple IV—Dylib Hijacking | Medium","name":"Snake&Apple IV—Dylib Hijacking | Medium","description":"The article describes the concept of libraries and how to detect Dylib Hijacking vulnerability and secure applications against it on macOS.","identifier":"2c955439b94e","author":{"@type":"Person","name":"Karol Mazurek","url":"https:\u002F\u002Fkarol-mazurek.medium.com"},"creator":["Karol Mazurek"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fkarol-mazurek.medium.com\u002F","logo":{"@type":"ImageObject","width":308,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:385\u002F1*OMF3fSqH8t4xBJ9-6oZDZw.png"}},"mainEntityOfPage":"https:\u002F\u002Fkarol-mazurek.medium.com\u002Fsnake-apple-iv-dylibs-2c955439b94e","isAccessibleForFree":"False","hasPart":{"@type":"WebPageElement","isAccessibleForFree":"False","cssSelector":".meteredContent"}}</script><script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-7JY7T788PK" data-rh="true"></script><script data-rh="true">window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'G-7JY7T788PK');</script><script type="text/javascript" data-rh="true">(function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src="https://cdn.branch.io/branch-latest.min.js";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,"script","branch",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},"addListener applyCode autoAppIndex banner closeBanner closeJourney creditHistory credits data deepview deepviewCta first getCode init link logout redeem referrals removeListener sendSMS setBranchViewData setIdentity track validateCode trackCommerceEvent logEvent".split(" "), 0);
branch.init('key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm', {metadata: {}, 'no_journeys': true, 'disable_exit_animation': true, 'disable_entry_animation': true, 'tracking_disabled': null}, function(err, data) {});</script><script src="https://www.google.com/recaptcha/enterprise.js?render=6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp" data-rh="true"></script><style data-fela-type="RULE" type="text/css" media="(orientation: landscape) and (max-width: 903.98px)"></style><script charset="utf-8" data-webpack="lite:chunk-1878" src="https://cdn-client.medium.com/lite/static/js/1878.73a360f3.chunk.js"></script><script charset="utf-8" data-webpack="lite:chunk-8097" src="https://cdn-client.medium.com/lite/static/js/8097.afb6fd3b.chunk.js"></script><script type="text/javascript" async="" src="https://app.link/_r?sdk=web2.85.0&amp;branch_key=key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm&amp;callback=branch_callback__0"></script></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div><script>if (window.self !== window.top) window.location = "about:blank"</script></div><div class="l c"><div class="l m n o c" style="transform: translateY(0px);"><div class="p q r s t u v w x i d y z"><a class="dr ag ds bc ak b am an ao ap aq ar as at s u w i d q dt z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F2c955439b94e&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderUser&amp;source=---two_column_layout_nav----------------------------------" rel="noopener follow">Open in app<svg width="10" height="10" viewBox="0 0 10 10" fill="none" class="dq"><path d="M.98 8.48a.37.37 0 1 0 .54.54l-.54-.54zm7.77-7.23h.38c0-.2-.17-.38-.38-.38v.38zM8.37 6.5a.37.37 0 1 0 .76 0h-.76zM3.5.87a.37.37 0 1 0 0 .76V.88zM1.52 9.03l7.5-7.5-.54-.54-7.5 7.5.54.54zm6.86-7.77V6.5h.74V1.25h-.74zm-4.88.38h5.25V.88H3.5v.74z" fill="currentColor"></path></svg></a><div class="ab q"><p class="bc b du dv dw dx dy dz ea eb ec ed dr"><span><button class="bc b du dv ee dw dx ef dy dz eg eh eb ei ej ed ek el em eo ep eq er es et eu ev ew ex ey ez fa bj fb fc" data-testid="headerSignUpButton">Sign up</button></span></p><div class="au l"><p class="bc b du dv dw dx dy dz ea eb ec ed dr"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fsnake-apple-iv-dylibs-2c955439b94e&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=---two_column_layout_nav----------------------------------" rel="noopener follow"><svg width="120" height="27" viewBox="0 0 120 27" fill="none"><mask id="logo-wordmark-pride_svg__a" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="1" y="0" width="119" height="27"><path d="M29.69 2.36h.03v-.29h-7.26L15.7 18.05 8.96 2.07H1.12v.28l.04.01c1.32.3 2 .75 2 2.37v19c0 1.62-.68 2.07-2 2.37h-.04v.29h5.31v-.28H6.4c-1.33-.3-2-.76-2-2.38V5.83l8.67 20.56h.5l8.91-21.13V24.2c-.1 1.28-.78 1.67-1.98 1.95h-.03v.28h9.25v-.27l-.03-.01c-1.2-.28-1.89-.67-2-1.95V4.73c0-1.62.67-2.07 2-2.37zm4.23 12.58c.15-3.41 1.37-5.87 3.4-5.92.64.01 1.17.22 1.58.62.87.86 1.28 2.64 1.22 5.3h-6.2zm-.1.96h10.86v-.04c-.03-2.61-.78-4.64-2.23-6.03a7.3 7.3 0 0 0-5.05-1.87h-.04a7.31 7.31 0 0 0-5.75 2.78 10.4 10.4 0 0 0-2.08 5.72l-.02.2a7.61 7.61 0 0 0-.02.56v.58c.11 5.09 2.84 9.16 7.69 9.16 4.25 0 6.73-3.14 7.35-7.34l-.32-.11c-1.08 2.26-3.03 3.63-5.25 3.46-3.03-.23-5.35-3.32-5.13-7.06m23.12 6.89c-.36.85-1.1 1.32-2.1 1.32s-1.9-.7-2.55-1.94a12.23 12.23 0 0 1-1.06-5.49c0-4.68 1.45-7.7 3.68-7.7.94 0 1.68.47 2.03 1.28V22.8zm7.2 3.33c-1.33-.31-2-.78-2-2.49V.96l-8.07 2.39v.3l.05-.01c1.11-.1 1.87.06 2.3.47.35.32.52.8.52 1.5v3.1a5.18 5.18 0 0 0-2.89-.75c-2.33 0-4.45.98-5.99 2.78-1.6 1.86-2.44 4.42-2.44 7.38 0 5.28 2.58 8.84 6.43 8.84a5.09 5.09 0 0 0 4.89-3.34v2.81h7.23v-.29h-.03zm6.9-22.09c0-1.65-1.23-2.9-2.87-2.9a2.87 2.87 0 0 0-2.9 2.9c0 1.63 1.27 2.9 2.9 2.9a2.82 2.82 0 0 0 2.88-2.9zm1.91 22.1c-1.32-.32-2-.8-2-2.5V8.01l-7.24 2.1v.28h.05c1.56.14 1.99.68 1.99 2.53v13.51H73v-.29h-.04zm18.54 0c-1.33-.32-2-.8-2-2.5V8.01l-6.89 2.02v.29h.04c1.28.14 1.65.71 1.65 2.56v9.88a2.48 2.48 0 0 1-2.2 1.4c-1.57 0-2.43-1.08-2.43-3.02V8.01l-7.24 2.1v.28h.04c1.57.14 2 .68 2 2.53v8.36c0 .58.05 1.16.15 1.74l.13.57c.61 2.21 2.22 3.37 4.73 3.37 2.13 0 4-1.33 4.82-3.4v2.88h7.23v-.3h-.03zm28.1.3v-.3h-.03c-1.44-.34-2-.97-2-2.26V13.25c0-3.31-1.85-5.3-4.95-5.3a5.08 5.08 0 0 0-4.9 3.37c-.58-2.17-2.25-3.36-4.73-3.36a4.7 4.7 0 0 0-4.61 3.1V8.02l-7.23 2v.3h.04c1.55.14 2 .7 2 2.49v13.63h6.74v-.29h-.03c-1.15-.28-1.52-.78-1.52-2.05V11.9c.3-.71.91-1.56 2.13-1.56 1.5 0 2.26 1.05 2.26 3.12v12.97h6.75v-.29h-.03c-1.15-.28-1.52-.78-1.52-2.05V13.25a7 7 0 0 0-.1-1.21c.32-.78.97-1.7 2.23-1.7 1.53 0 2.27 1.02 2.27 3.12v12.97h7.23z" fill="#242424"></path></mask><g filter="url(#logo-wordmark-pride_svg__filter0_f_238_6555)" mask="url(#logo-wordmark-pride_svg__a)"><path d="M42.3-64.7l-15.52-6.74L-24.62 47l15.53 6.74L42.3-64.7z" fill="#000"></path><path d="M53.18-59.98L42.3-64.7-9.1 53.74l10.88 4.72 51.4-118.44z" fill="#603917"></path><path d="M64.96-54.87l-11.78-5.11L1.78 58.46l11.79 5.11 51.4-118.44z" fill="#71E2FD"></path><path d="M75.84-50.15l-10.88-4.72-51.4 118.44 10.89 4.72L75.84-50.15z" fill="#FF9BC9"></path><path d="M86.71-45.43l-10.87-4.72L24.44 68.3l10.88 4.72 51.4-118.44z" fill="#FF472F"></path><path d="M97.6-40.7L86.7-45.44 35.32 73.01l10.88 4.72L97.6-40.7z" fill="#FF8312"></path><path d="M108.47-35.99L97.6-40.7 46.2 77.73l10.88 4.72 51.4-118.44z" fill="#FFCE00"></path><path d="M120.25-30.88l-11.78-5.1-51.4 118.43 11.79 5.11 51.4-118.44z" fill="#48E348"></path><path d="M131.13-26.16l-10.88-4.72L68.86 87.56l10.88 4.72 51.4-118.44z" fill="#008EF0"></path><path d="M148.48-18.63l-17.35-7.53-51.4 118.44 17.35 7.53 51.4-118.44z" fill="#9A50FC"></path></g><defs><filter id="logo-wordmark-pride_svg__filter0_f_238_6555" x="-29.5" y="-76.33" width="182.87" height="181.03" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood><feBlend in="SourceGraphic" in2="BackgroundImageFix" result="shape"></feBlend><feGaussianBlur stdDeviation="2.45" result="effect1_foregroundBlur_238_6555"></feGaussianBlur></filter></defs></svg></a><div class="au h"><div class="ab av aw ax ay q az ba"><div class="bj" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bk bl ab"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.1 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0zm6.94-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .8-.79l-3.74-3.73A8.05 8.05 0 0 0 11.04 3v.01z" fill="currentColor"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="av bb bc bd z be bf bg bh bi" placeholder="Search" value=""></div></div></div><div class="h k w fd fe"><div class="ff ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---two_column_layout_nav-----------------------new_post_topnav-----------" rel="noopener follow"><div class="bc b bd z dr fg fh ab q fi fj"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-label="Write"><path d="M14 4a.5.5 0 0 0 0-1v1zm7 6a.5.5 0 0 0-1 0h1zm-7-7H4v1h10V3zM3 4v16h1V4H3zm1 17h16v-1H4v1zm17-1V10h-1v10h1zm-1 1a1 1 0 0 0 1-1h-1v1zM3 20a1 1 0 0 0 1 1v-1H3zM4 3a1 1 0 0 0-1 1h1V3z" fill="currentColor"></path><path d="M17.5 4.5l-8.46 8.46a.25.25 0 0 0-.06.1l-.82 2.47c-.07.2.12.38.31.31l2.47-.82a.25.25 0 0 0 .1-.06L19.5 6.5m-2-2l2.32-2.32c.1-.1.26-.1.36 0l1.64 1.64c.1.1.1.26 0 .36L19.5 6.5m-2-2l2 2" stroke="currentColor"></path></svg><div class="dq l">Write</div></div></a></span></div></div><div class="k j i d"><div class="ff ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" href="https://medium.com/search?source=---two_column_layout_nav----------------------------------" rel="noopener follow"><div class="bc b bd z dr fg fh ab q fi fj"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-label="Search"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.1 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0zm6.94-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .8-.79l-3.74-3.73A8.05 8.05 0 0 0 11.04 3v.01z" fill="currentColor"></path></svg></div></a></div></div><div class="ff h k j"><div class="ab q"><p class="bc b du dv dw dx dy dz ea eb ec ed dr"><span><button class="bc b du dv ee dw dx ef dy dz eg eh eb ei ej ed ek el em eo ep eq er es et eu ev ew ex ey ez fa bj fb fc" data-testid="headerSignUpButton">Sign up</button></span></p><div class="au l"><p class="bc b du dv dw dx dy dz ea eb ec ed dr"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fsnake-apple-iv-dylibs-2c955439b94e&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="av fk am ab q ao fl fm fn" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fg"><img alt="" class="l fa bv bw bx cu" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"><div class="fo bv l bw bx fp n av fq"></div></div></button></div></div></div><div class="fr"><a rel="me" href="https://infosec.exchange/@karmaz">Mastodon</a></div><div class="l"><div class="pl" role="dialog" aria-modal="true" tabindex="-1"><div class="rl rm be dt rn ro rp ao rq gk rr" aria-hidden="true" role="presentation"></div><div class="rs rn rt ru rv rl dt fa rw rx ry lg rz sa sb sc sd se sf sg sh" aria-hidden="true"></div></div><div class="fs ft fu fv fw l"><div class="ab by"><div class="cf be fx fy fz ga"></div></div><article class="meteredContent"><div class="l"><div class="l"><span class="l"></span><section><div><div class="fp gg gh gi gj gk"></div><div><div class="speechify-ignore l"><div class="tq tr ts tt tu l"></div><div class="ab by"><div class="cn dq tv be tw cf l"><div class="fg tx ty tz sr st ua ql"><p class="bc b bd z bh">You're reading for free via <a class="af ag ah ai aj ak al am an ao ap aq ar pa" href="https://medium.com/@monethic?source=post_page-----2c955439b94e--------------------------------" rel="noopener follow">Monethic.io's</a> Friend Link. <span><a class="af ag ah ai aj ak al am an ao ap aq ar pa" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fsnake-apple-iv-dylibs-2c955439b94e&amp;source=-----2c955439b94e---------------------post_friend_link_meter-----------" rel="noopener follow">Become a member</a></span> to access the best of Medium.</p></div><div class="ui uj uk ul um l"><div class="fp ub uc gv ud ue uf ug uh"></div></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><div class="ci l"><div class="gs ab"><div class="bj" aria-hidden="false" aria-describedby="2" aria-labelledby="2"><button class="l av ao am" aria-label="Member-only story"><div class="h k j i d"><div><div class="bj" aria-hidden="false" aria-describedby="1" aria-labelledby="1"><svg width="16" height="16" viewBox="0 0 64 64" fill="none"><path d="M39.64 40.83L33.87 56.7a1.99 1.99 0 0 1-3.74 0l-5.77-15.87a2.02 2.02 0 0 0-1.2-1.2L7.3 33.88a1.99 1.99 0 0 1 0-3.74l15.87-5.77a2.02 2.02 0 0 0 1.2-1.2L30.12 7.3a1.99 1.99 0 0 1 3.74 0l5.77 15.87a2.02 2.02 0 0 0 1.2 1.2l15.86 5.76a1.99 1.99 0 0 1 0 3.74l-15.87 5.77a2.02 2.02 0 0 0-1.2 1.2z" fill="#FFC017"></path></svg></div></div></div><div class="s u w fd fe q"><svg width="16" height="16" viewBox="0 0 64 64" fill="none" class="gq gr"><path d="M39.64 40.83L33.87 56.7a1.99 1.99 0 0 1-3.74 0l-5.77-15.87a2.02 2.02 0 0 0-1.2-1.2L7.3 33.88a1.99 1.99 0 0 1 0-3.74l15.87-5.77a2.02 2.02 0 0 0 1.2-1.2L30.12 7.3a1.99 1.99 0 0 1 3.74 0l5.77 15.87a2.02 2.02 0 0 0 1.2 1.2l15.86 5.76a1.99 1.99 0 0 1 0 3.74l-15.87 5.77a2.02 2.02 0 0 0-1.2 1.2z" fill="#FFC017"></path></svg><p class="bc b bd z dr">Member-only story</p></div></button></div></div></div></div></div></div></div><div class="gt gu gv gw gx"><div class="ab by"><div class="cf be fx fy fz ga"><div><h1 id="d443" class="pw-post-title gy gz ha bc hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu hv hw bh" data-testid="storyTitle" data-selectable-paragraph="">Snake&amp;Apple IV — Dylibs</h1><div class="re rf rg rh ri"><div class="speechify-ignore ab cm"><div class="speechify-ignore be l"><div class="ic id ie if ig ab"><div><div class="ab ih"><a rel="noopener follow" href="/?source=post_page-----2c955439b94e--------------------------------"><div><div class="bj" aria-hidden="false" aria-describedby="93" aria-labelledby="93"><div class="l ii ij bv ik il"><div class="l fg"><img alt="Karol Mazurek" class="l fa bv da db cu" src="https://miro.medium.com/v2/da:true/resize:fill:55:55/0*BLalJfMaz_JDj6fg" width="44" height="44" loading="lazy" data-testid="authorPhoto"><div class="im bv l da db fp n in fq"></div></div></div></div></div></a></div></div><div class="bk be l"><div class="ab"><div style="flex: 1 1 0%;"><span class="bc b bd z bh"><div class="io ab q"><div class="ab q ip"><div class="ab q"><div><div class="bj" aria-hidden="false" aria-describedby="94" aria-labelledby="94"><p class="bc b iq ir bh"><a class="af ag ah ai aj ak al am an ao ap aq ar is" data-testid="authorName" rel="noopener follow" href="/?source=post_page-----2c955439b94e--------------------------------">Karol Mazurek</a></p></div></div></div><span class="it iu" aria-hidden="true"><span class="bc b bd z dr">·</span></span><p class="bc b iq ir dr"><span><a class="iv iw ah ai aj ak al am an ao ap aq ar eu ix iy" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3f7ab05f0f68&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fsnake-apple-iv-dylibs-2c955439b94e&amp;user=Karol+Mazurek&amp;userId=3f7ab05f0f68&amp;source=post_page-3f7ab05f0f68----2c955439b94e---------------------post_header-----------" rel="noopener follow">Follow</a></span></p></div></div></span></div></div><div class="l iz"><span class="bc b bd z dr"><div class="ab ck ja jb jc"><span class="bc b bd z dr"><div class="ab ae"><span data-testid="storyReadTime">19 min read</span><div class="jd je l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bc b bd z dr">·</span></span></div><span data-testid="storyPublishDate">Jan 17, 2024</span></div></span></div></span></div></div></div><div class="ab cm jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju"><div class="h k w fd fe q"><div class="kk l"><div class="ab q kl km"><div class="pw-multi-vote-icon fg gq kn ko kp"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F2c955439b94e&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fsnake-apple-iv-dylibs-2c955439b94e&amp;user=Karol+Mazurek&amp;userId=3f7ab05f0f68&amp;source=-----2c955439b94e---------------------clap_footer-----------" rel="noopener follow"><div><div class="bj" aria-hidden="false" aria-describedby="95" aria-labelledby="95"><div class="kq ao kr ks kt ku am kv kw kx kp"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ky kz la lb lc ld le"><p class="bc b ds z dr"><span class="lf">--</span></p></div></div></div><div><div class="bj" aria-hidden="false" aria-describedby="96" aria-labelledby="96"><button class="ao kq lg lh ab q fh li lj" aria-label="responses"><svg width="24" height="24" viewBox="0 0 24 24" class="hw"><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></button></div></div></div><div class="ab q jv jw jx jy jz ka kb kc kd ke kf kg kh rj rk"><div class="lk k j i d"></div><div class="h k"><div><div class="bj" aria-hidden="false" aria-describedby="97" aria-labelledby="97"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2c955439b94e&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fsnake-apple-iv-dylibs-2c955439b94e&amp;source=-----2c955439b94e---------------------bookmark_footer-----------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dr ll" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div><div class="fa lm ck"><div class="l ae"><div class="ab by"><div class="ln lo lp lq lr ls cf be"><div class="ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2Fplans%3Fdimension%3Dpost_audio_button%26postId%3D2c955439b94e&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fsnake-apple-iv-dylibs-2c955439b94e&amp;source=-----2c955439b94e---------------------post_audio_button-----------" rel="noopener follow"><div><div class="bj" aria-hidden="false" aria-describedby="98" aria-labelledby="98"><button aria-label="Listen" data-testid="audioPlayButton" class="af fh ah ai aj ak al lt an ao ap eu lu lv lj lw lx ly lz ma s mb mc md me mf mg mh u mi mj mk"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0zm9-10a10 10 0 1 0 0 20 10 10 0 0 0 0-20zm3.38 10.42l-4.6 3.06a.5.5 0 0 1-.78-.41V8.93c0-.4.45-.63.78-.41l4.6 3.06c.3.2.3.64 0 .84z" fill="currentColor"></path></svg><div class="j i d"><p class="bc b bd z dr">Listen</p></div></button></div></div></a></span></div></div></div></div></div><div class="bj" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bj" aria-hidden="false" aria-describedby="99" aria-labelledby="99"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fh ah ai aj ak al lt an ao ap eu lu lv lj lw lx ly lz ma s mb mc md me mf mg mh u mi mj mk"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.22 4.93a.42.42 0 0 1-.12.13h.01a.45.45 0 0 1-.29.08.52.52 0 0 1-.3-.13L12.5 3v7.07a.5.5 0 0 1-.5.5.5.5 0 0 1-.5-.5V3.02l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.8a.42.42 0 0 1 .07.5zm-.1.14zm.88 2h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11a2 2 0 0 1-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.14c.1.1.15.22.15.35a.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9V8.96c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1z" fill="currentColor"></path></svg><div class="j i d"><p class="bc b bd z dr">Share</p></div></button></div></div></div></div></div></div></div></div></div><p id="520c" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">Automating Dylib Hijacking detection with Python.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk nl"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/0*HgjbPiuRBfG57HPL 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/0*HgjbPiuRBfG57HPL 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/0*HgjbPiuRBfG57HPL 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/0*HgjbPiuRBfG57HPL 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/0*HgjbPiuRBfG57HPL 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/0*HgjbPiuRBfG57HPL 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/0*HgjbPiuRBfG57HPL 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/0*HgjbPiuRBfG57HPL 640w, https://miro.medium.com/v2/resize:fit:720/0*HgjbPiuRBfG57HPL 720w, https://miro.medium.com/v2/resize:fit:750/0*HgjbPiuRBfG57HPL 750w, https://miro.medium.com/v2/resize:fit:786/0*HgjbPiuRBfG57HPL 786w, https://miro.medium.com/v2/resize:fit:828/0*HgjbPiuRBfG57HPL 828w, https://miro.medium.com/v2/resize:fit:1100/0*HgjbPiuRBfG57HPL 1100w, https://miro.medium.com/v2/resize:fit:1400/0*HgjbPiuRBfG57HPL 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="400" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/0*HgjbPiuRBfG57HPL"></picture></div></div></figure></div></div></div><div class="ab by un uo up uq" role="separator"><span class="su bv bj ur us ps"></span><span class="su bv bj ur us ps"></span><span class="su bv bj ur us"></span></div><div class="gt gu gv gw gx"><div class="ab by"><div class="cf be fx fy fz ga"><h1 id="e45e" class="nx ny ha bc nz oa ut oc od oe uu og oh oi uv ok ol om uw oo op oq ux os ot ou bh" data-selectable-paragraph="">INTRO</h1><p id="3b7c" class="pw-post-body-paragraph ml mm ha mn b mo ov mq mr ms ow mu mv mw ox my mz na oy nc nd ne oz ng nh ni gt bh" data-selectable-paragraph="">Welcome to another article in the series on macOS security internals!</p><p id="3ea1" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">In the <a class="af pa" href="https://medium.com/@karol-mazurek/snake-apple-i-mach-o-a8eda4b87263" rel="noopener">Snake&amp;Apple I — Mach-O</a>, I briefly introduced Load Commands, which provides Dynamic Loader (dyld) information on Dynamic Libraries (dylibs) without further explanation. This article will go deep into the concept of libraries and explain the Dylib Hijacking vulnerability.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk uy"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*hUQfDtmR5X3pgVT5QFDBnw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*hUQfDtmR5X3pgVT5QFDBnw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*hUQfDtmR5X3pgVT5QFDBnw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*hUQfDtmR5X3pgVT5QFDBnw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*hUQfDtmR5X3pgVT5QFDBnw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*hUQfDtmR5X3pgVT5QFDBnw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hUQfDtmR5X3pgVT5QFDBnw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*hUQfDtmR5X3pgVT5QFDBnw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*hUQfDtmR5X3pgVT5QFDBnw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*hUQfDtmR5X3pgVT5QFDBnw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*hUQfDtmR5X3pgVT5QFDBnw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*hUQfDtmR5X3pgVT5QFDBnw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*hUQfDtmR5X3pgVT5QFDBnw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*hUQfDtmR5X3pgVT5QFDBnw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="733" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*hUQfDtmR5X3pgVT5QFDBnw.png"></picture></div></div></figure><p id="b9e6" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">Toward the end, I will share my implementation of a Dylibtree tool and automatic Dylib Hijacking scanner, which example output is below:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div class="ab ck by uz"><picture><source srcset="https://miro.medium.com/v2/format:webp/1*zCjkhiJlKr76vBo66KmBGg.png 640w, https://miro.medium.com/v2/format:webp/1*zCjkhiJlKr76vBo66KmBGg.png 720w, https://miro.medium.com/v2/format:webp/1*zCjkhiJlKr76vBo66KmBGg.png 750w, https://miro.medium.com/v2/format:webp/1*zCjkhiJlKr76vBo66KmBGg.png 786w, https://miro.medium.com/v2/format:webp/1*zCjkhiJlKr76vBo66KmBGg.png 828w, https://miro.medium.com/v2/format:webp/1*zCjkhiJlKr76vBo66KmBGg.png 1100w, https://miro.medium.com/v2/format:webp/1*zCjkhiJlKr76vBo66KmBGg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/1*zCjkhiJlKr76vBo66KmBGg.png 640w, https://miro.medium.com/v2/1*zCjkhiJlKr76vBo66KmBGg.png 720w, https://miro.medium.com/v2/1*zCjkhiJlKr76vBo66KmBGg.png 750w, https://miro.medium.com/v2/1*zCjkhiJlKr76vBo66KmBGg.png 786w, https://miro.medium.com/v2/1*zCjkhiJlKr76vBo66KmBGg.png 828w, https://miro.medium.com/v2/1*zCjkhiJlKr76vBo66KmBGg.png 1100w, https://miro.medium.com/v2/1*zCjkhiJlKr76vBo66KmBGg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="ls be nw c" width="700" loading="lazy" role="presentation" src="https://miro.medium.com/v2/1*zCjkhiJlKr76vBo66KmBGg.png"></picture></div></figure><p id="ff02" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph=""><em class="va">Please note that some topics have been intentionally omitted and will be addressed in future articles. However, leave a comment if you have any questions or need clarification about anything written here while reading. I guarantee a response and will use your feedback for future articles.</em></p><blockquote class="vb vc vd"><p id="78a4" class="ml mm va mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">The <a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/tree/main" rel="noopener ugc nofollow" target="_blank">Snake&amp;Apple IV. Dylibs</a> repository contains all of the code used.</p></blockquote></div></div></div><div class="ab by un uo up uq" role="separator"><span class="su bv bj ur us ps"></span><span class="su bv bj ur us ps"></span><span class="su bv bj ur us"></span></div><div class="gt gu gv gw gx"><div class="ab by"><div class="cf be fx fy fz ga"><h1 id="3938" class="nx ny ha bc nz oa ut oc od oe uu og oh oi uv ok ol om uw oo op oq ux os ot ou bh" data-selectable-paragraph="">Libraries — Static vs Dynamic</h1><p id="5e87" class="pw-post-body-paragraph ml mm ha mn b mo ov mq mr ms ow mu mv mw ox my mz na oy nc nd ne oz ng nh ni gt bh" data-selectable-paragraph="">In programming, a library is a collection of precompiled code. It provides a reusable set of functionalities for executables and other libraries.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk ve"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*B8rLBQkRewicB_-K1Q0p9w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*B8rLBQkRewicB_-K1Q0p9w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*B8rLBQkRewicB_-K1Q0p9w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*B8rLBQkRewicB_-K1Q0p9w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*B8rLBQkRewicB_-K1Q0p9w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*B8rLBQkRewicB_-K1Q0p9w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B8rLBQkRewicB_-K1Q0p9w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*B8rLBQkRewicB_-K1Q0p9w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*B8rLBQkRewicB_-K1Q0p9w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*B8rLBQkRewicB_-K1Q0p9w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*B8rLBQkRewicB_-K1Q0p9w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*B8rLBQkRewicB_-K1Q0p9w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*B8rLBQkRewicB_-K1Q0p9w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*B8rLBQkRewicB_-K1Q0p9w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="433" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*B8rLBQkRewicB_-K1Q0p9w.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph=""><a class="af pa" href="https://developer.apple.com/videos/play/wwdc2022/110362" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><h2 id="f0f8" class="vi ny ha bc nz vj vk dv od vl vm dx oh mw vn vo vp na vq vr vs ne vt vu vv vw bh" data-selectable-paragraph="">Static Library</h2><p id="f994" class="pw-post-body-paragraph ml mm ha mn b mo ov mq mr ms ow mu mv mw ox my mz na oy nc nd ne oz ng nh ni gt bh" data-selectable-paragraph="">It contains object code <strong class="mn hb">directly linked with the program at compile time</strong>. During the linking phase, the contents of a static library are copied into the executable file, making the resulting file larger but self-sufficient, as it doesn’t require any external dependencies at runtime.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk vx"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*E6gnNsrR-kV3_q6qcSFl1w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*E6gnNsrR-kV3_q6qcSFl1w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*E6gnNsrR-kV3_q6qcSFl1w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*E6gnNsrR-kV3_q6qcSFl1w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*E6gnNsrR-kV3_q6qcSFl1w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*E6gnNsrR-kV3_q6qcSFl1w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E6gnNsrR-kV3_q6qcSFl1w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*E6gnNsrR-kV3_q6qcSFl1w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*E6gnNsrR-kV3_q6qcSFl1w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*E6gnNsrR-kV3_q6qcSFl1w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*E6gnNsrR-kV3_q6qcSFl1w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*E6gnNsrR-kV3_q6qcSFl1w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*E6gnNsrR-kV3_q6qcSFl1w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*E6gnNsrR-kV3_q6qcSFl1w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="482" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*E6gnNsrR-kV3_q6qcSFl1w.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph=""><a class="af pa" href="https://developer.apple.com/library/archive/documentation/DeveloperTools/Conceptual/DynamicLibraries/100-Articles/OverviewOfDynamicLibraries.html" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><blockquote class="vb vc vd"><p id="29a7" class="ml mm va mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">Any changes made to a static library require recompiling the entire program.</p></blockquote><h2 id="d79e" class="vi ny ha bc nz vj vk dv od vl vm dx oh mw vn vo vp na vq vr vs ne vt vu vv vw bh" data-selectable-paragraph="">Dynamic Library</h2><p id="3890" class="pw-post-body-paragraph ml mm ha mn b mo ov mq mr ms ow mu mv mw ox my mz na oy nc nd ne oz ng nh ni gt bh" data-selectable-paragraph="">It is a <strong class="mn hb">pre-compiled code loaded into memory when a program starts running</strong>, which enables multiple programs to use the same shared code in memory, leading to more efficient memory usage. They are stored separately from the executable file, making it smaller.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk vy"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*lJ0mvhzQJpS9H8aFhE0OWg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*lJ0mvhzQJpS9H8aFhE0OWg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*lJ0mvhzQJpS9H8aFhE0OWg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*lJ0mvhzQJpS9H8aFhE0OWg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*lJ0mvhzQJpS9H8aFhE0OWg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*lJ0mvhzQJpS9H8aFhE0OWg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lJ0mvhzQJpS9H8aFhE0OWg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*lJ0mvhzQJpS9H8aFhE0OWg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*lJ0mvhzQJpS9H8aFhE0OWg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*lJ0mvhzQJpS9H8aFhE0OWg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*lJ0mvhzQJpS9H8aFhE0OWg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*lJ0mvhzQJpS9H8aFhE0OWg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*lJ0mvhzQJpS9H8aFhE0OWg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*lJ0mvhzQJpS9H8aFhE0OWg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="445" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*lJ0mvhzQJpS9H8aFhE0OWg.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph=""><a class="af pa" href="https://developer.apple.com/library/archive/documentation/DeveloperTools/Conceptual/DynamicLibraries/100-Articles/OverviewOfDynamicLibraries.html" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><blockquote class="vb vc vd"><p id="c43c" class="ml mm va mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">Additionally, any changes to a dynamic library only require the updated library to be replaced without recompiling the entire program.</p></blockquote><h2 id="855c" class="vi ny ha bc nz vj vk dv od vl vm dx oh mw vn vo vp na vq vr vs ne vt vu vv vw bh" data-selectable-paragraph="">Frameworks</h2><p id="a2b2" class="pw-post-body-paragraph ml mm ha mn b mo ov mq mr ms ow mu mv mw ox my mz na oy nc nd ne oz ng nh ni gt bh" data-selectable-paragraph="">Going further — Frameworks on macOS are hierarchical directories that encapsulate Dynamic Shared Libraries. They allow multiple applications to use these resources simultaneously, reducing memory usage.</p><p id="9369" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">Frameworks are accessed as bundles, which can store additional resources like images, nib files, localized strings, headers, and documentation.</p><blockquote class="vb vc vd"><p id="0216" class="ml mm va mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">I will discuss frameworks later when I cover the bundle concept on macOS. To learn about it now, check out <a class="af pa" href="https://developer.apple.com/documentation/xcode/bundles-and-frameworks" rel="noopener ugc nofollow" target="_blank">Bundles and frameworks | Apple Developer</a>.</p></blockquote><h2 id="9c4b" class="vi ny ha bc nz vj vk dv od vl vm dx oh mw vn vo vp na vq vr vs ne vt vu vv vw bh" data-selectable-paragraph="">Safety consideration</h2><p id="a906" class="pw-post-body-paragraph ml mm ha mn b mo ov mq mr ms ow mu mv mw ox my mz na oy nc nd ne oz ng nh ni gt bh" data-selectable-paragraph="">Dynamic Libraries are more efficient than Static Libraries but come with security risks. In <strong class="mn hb">Static Libraries</strong>, all the code is checked and copied at build time, guaranteeing that everything will work as expected.</p><p id="90fc" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">When using Dynamic Libraries, dependencies are resolved at runtime, which can cause crashes and vulnerabilities if the dependencies are missing or not in the expected version.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk vz"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*4NE3hidNb9-nO9c8YIgLPw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*4NE3hidNb9-nO9c8YIgLPw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*4NE3hidNb9-nO9c8YIgLPw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*4NE3hidNb9-nO9c8YIgLPw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*4NE3hidNb9-nO9c8YIgLPw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*4NE3hidNb9-nO9c8YIgLPw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4NE3hidNb9-nO9c8YIgLPw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*4NE3hidNb9-nO9c8YIgLPw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*4NE3hidNb9-nO9c8YIgLPw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*4NE3hidNb9-nO9c8YIgLPw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*4NE3hidNb9-nO9c8YIgLPw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*4NE3hidNb9-nO9c8YIgLPw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*4NE3hidNb9-nO9c8YIgLPw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*4NE3hidNb9-nO9c8YIgLPw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="176" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*4NE3hidNb9-nO9c8YIgLPw.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph="">Example error where dyld is unable to find the specified library in the standard search paths</figcaption></figure><blockquote class="vb vc vd"><p id="3efd" class="ml mm va mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">This error can result in <strong class="mn hb">Dylib Hijacking</strong> if the attacker has write access to the directories where the missing file is searched for.</p></blockquote></div></div></div><div class="ab by un uo up uq" role="separator"><span class="su bv bj ur us ps"></span><span class="su bv bj ur us ps"></span><span class="su bv bj ur us"></span></div><div class="gt gu gv gw gx"><div class="ab by"><div class="cf be fx fy fz ga"><h1 id="3110" class="nx ny ha bc nz oa ut oc od oe uu og oh oi uv ok ol om uw oo op oq ux os ot ou bh" data-selectable-paragraph="">Mach-O Shared Libraries</h1><p id="9ba4" class="pw-post-body-paragraph ml mm ha mn b mo ov mq mr ms ow mu mv mw ox my mz na oy nc nd ne oz ng nh ni gt bh" data-selectable-paragraph="">MacOS uses a <code class="cu wa wb wc wd b">.dylib</code> extension for dynamic libraries, similar to <code class="cu wa wb wc wd b">.dll</code> on Windows and <code class="cu wa wb wc wd b">.so</code> on Linux. Although it is not required to use extension:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk we"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*SBYJBz7DL9hKNlhymHkOUg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*SBYJBz7DL9hKNlhymHkOUg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*SBYJBz7DL9hKNlhymHkOUg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*SBYJBz7DL9hKNlhymHkOUg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*SBYJBz7DL9hKNlhymHkOUg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*SBYJBz7DL9hKNlhymHkOUg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SBYJBz7DL9hKNlhymHkOUg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*SBYJBz7DL9hKNlhymHkOUg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*SBYJBz7DL9hKNlhymHkOUg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*SBYJBz7DL9hKNlhymHkOUg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*SBYJBz7DL9hKNlhymHkOUg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*SBYJBz7DL9hKNlhymHkOUg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*SBYJBz7DL9hKNlhymHkOUg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*SBYJBz7DL9hKNlhymHkOUg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="100" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*SBYJBz7DL9hKNlhymHkOUg.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph="">Example dylib without extension</figcaption></figure><p id="cac0" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">Below is an example of how to compile <code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/mylib.c" rel="noopener ugc nofollow" target="_blank">mylib.c</a></code> dylib using clang:</p><pre class="nm nn no np nq wf wd wg bm wh ay bh"><span id="49e7" class="wi ny ha wd b bd wj wk l wl wm" data-selectable-paragraph="">clang -dynamiclib -o mylib.dylib mylib.c</span></pre><p id="c2f8" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">Mach-O shared libraries have the <code class="cu wa wb wc wd b">MH_DYLIB</code> <code class="cu wa wb wc wd b">0x00000006</code> file type:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk wn"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*lvTyu0LKPOzLC0WIYx5zaw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*lvTyu0LKPOzLC0WIYx5zaw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*lvTyu0LKPOzLC0WIYx5zaw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*lvTyu0LKPOzLC0WIYx5zaw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*lvTyu0LKPOzLC0WIYx5zaw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*lvTyu0LKPOzLC0WIYx5zaw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lvTyu0LKPOzLC0WIYx5zaw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*lvTyu0LKPOzLC0WIYx5zaw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*lvTyu0LKPOzLC0WIYx5zaw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*lvTyu0LKPOzLC0WIYx5zaw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*lvTyu0LKPOzLC0WIYx5zaw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*lvTyu0LKPOzLC0WIYx5zaw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*lvTyu0LKPOzLC0WIYx5zaw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*lvTyu0LKPOzLC0WIYx5zaw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="235" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*lvTyu0LKPOzLC0WIYx5zaw.png"></picture></div></div></figure><p id="0273" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">We can use <code class="cu wa wb wc wd b">CrimsonUroboros</code> or other tools to identify dylibs easily:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk wo"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ixctvumoUFTc7NCxiCUraA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ixctvumoUFTc7NCxiCUraA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ixctvumoUFTc7NCxiCUraA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ixctvumoUFTc7NCxiCUraA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ixctvumoUFTc7NCxiCUraA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ixctvumoUFTc7NCxiCUraA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ixctvumoUFTc7NCxiCUraA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*ixctvumoUFTc7NCxiCUraA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ixctvumoUFTc7NCxiCUraA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ixctvumoUFTc7NCxiCUraA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ixctvumoUFTc7NCxiCUraA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ixctvumoUFTc7NCxiCUraA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ixctvumoUFTc7NCxiCUraA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ixctvumoUFTc7NCxiCUraA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="208" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*ixctvumoUFTc7NCxiCUraA.png"></picture></div></div></figure><p id="350c" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">Other binaries can use dylibs. For example, <code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/use_dylib.c" rel="noopener ugc nofollow" target="_blank">use_dylib.c</a></code>, but the compiler needs to know the function signatures and declarations from the library:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk wp"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*nnlx5rLF82BrZ_RWwycP8g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*nnlx5rLF82BrZ_RWwycP8g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*nnlx5rLF82BrZ_RWwycP8g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*nnlx5rLF82BrZ_RWwycP8g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*nnlx5rLF82BrZ_RWwycP8g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*nnlx5rLF82BrZ_RWwycP8g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nnlx5rLF82BrZ_RWwycP8g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*nnlx5rLF82BrZ_RWwycP8g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*nnlx5rLF82BrZ_RWwycP8g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*nnlx5rLF82BrZ_RWwycP8g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*nnlx5rLF82BrZ_RWwycP8g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*nnlx5rLF82BrZ_RWwycP8g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*nnlx5rLF82BrZ_RWwycP8g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*nnlx5rLF82BrZ_RWwycP8g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="162" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*nnlx5rLF82BrZ_RWwycP8g.png"></picture></div></div></figure><p id="63d3" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">These declarations must be provided in the form of a header file. For our example, it would be <code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/custom/mylib.h" rel="noopener ugc nofollow" target="_blank">mylib.h</a></code>. After making this file, you can compile it:</p><pre class="nm nn no np nq wf wd wg bm wh ay bh"><span id="3920" class="wi ny ha wd b bd wj wk l wl wm" data-selectable-paragraph="">clang -o use_mylib use_mylib.c mylib.dylib</span></pre><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk wq"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ESuifgjrn4Se4444Wo4N2g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ESuifgjrn4Se4444Wo4N2g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ESuifgjrn4Se4444Wo4N2g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ESuifgjrn4Se4444Wo4N2g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ESuifgjrn4Se4444Wo4N2g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ESuifgjrn4Se4444Wo4N2g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ESuifgjrn4Se4444Wo4N2g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*ESuifgjrn4Se4444Wo4N2g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ESuifgjrn4Se4444Wo4N2g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ESuifgjrn4Se4444Wo4N2g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ESuifgjrn4Se4444Wo4N2g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ESuifgjrn4Se4444Wo4N2g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ESuifgjrn4Se4444Wo4N2g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ESuifgjrn4Se4444Wo4N2g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="133" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*ESuifgjrn4Se4444Wo4N2g.png"></picture></div></div></figure><blockquote class="vb vc vd"><p id="f85b" class="ml mm va mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">Now, the <code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/custom/use_mylib.c" rel="noopener ugc nofollow" target="_blank"><em class="ha">use_dylib</em></a></code> binary depend on the <code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/custom/mylib.c" rel="noopener ugc nofollow" target="_blank"><em class="ha">mylibc.dylib</em></a></code>.</p></blockquote><h2 id="3592" class="vi ny ha bc nz vj vk dv od vl vm dx oh mw vn vo vp na vq vr vs ne vt vu vv vw bh" data-selectable-paragraph="">Dependencies</h2><p id="6c6a" class="pw-post-body-paragraph ml mm ha mn b mo ov mq mr ms ow mu mv mw ox my mz na oy nc nd ne oz ng nh ni gt bh" data-selectable-paragraph="">Mach-O files can have dependencies on other libraries. The <code class="cu wa wb wc wd b">otool</code> , with the <code class="cu wa wb wc wd b">-L</code> option can print shared libraries used by our created executable:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk wr"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*JQe2hnFCrTNOs6wjaHcLDg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*JQe2hnFCrTNOs6wjaHcLDg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*JQe2hnFCrTNOs6wjaHcLDg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*JQe2hnFCrTNOs6wjaHcLDg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*JQe2hnFCrTNOs6wjaHcLDg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*JQe2hnFCrTNOs6wjaHcLDg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JQe2hnFCrTNOs6wjaHcLDg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*JQe2hnFCrTNOs6wjaHcLDg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*JQe2hnFCrTNOs6wjaHcLDg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*JQe2hnFCrTNOs6wjaHcLDg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*JQe2hnFCrTNOs6wjaHcLDg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*JQe2hnFCrTNOs6wjaHcLDg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*JQe2hnFCrTNOs6wjaHcLDg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*JQe2hnFCrTNOs6wjaHcLDg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="94" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*JQe2hnFCrTNOs6wjaHcLDg.png"></picture></div></div></figure><p id="4424" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">I implemented a similar function (<code class="cu wa wb wc wd b">--dylibs</code>) to <code class="cu wa wb wc wd b">CrimsonUroboros</code>:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk ws"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*OI9fWTg4JOj8F9_d6cd6lg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*OI9fWTg4JOj8F9_d6cd6lg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*OI9fWTg4JOj8F9_d6cd6lg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*OI9fWTg4JOj8F9_d6cd6lg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*OI9fWTg4JOj8F9_d6cd6lg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*OI9fWTg4JOj8F9_d6cd6lg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OI9fWTg4JOj8F9_d6cd6lg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*OI9fWTg4JOj8F9_d6cd6lg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*OI9fWTg4JOj8F9_d6cd6lg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*OI9fWTg4JOj8F9_d6cd6lg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*OI9fWTg4JOj8F9_d6cd6lg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*OI9fWTg4JOj8F9_d6cd6lg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*OI9fWTg4JOj8F9_d6cd6lg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*OI9fWTg4JOj8F9_d6cd6lg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="92" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*OI9fWTg4JOj8F9_d6cd6lg.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph=""><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/python/CrimsonUroboros.py#L697" rel="noopener ugc nofollow" target="_blank">getSharedLibraries</a></figcaption></figure><p id="1698" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">As you can see above, beside our <code class="cu wa wb wc wd b">mylib.dylib</code> there is one more library <code class="cu wa wb wc wd b">libSystem.B.dylib</code>. However, if we try to inspect it, we will get an error:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk wt"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*oi7yb6TPHu25Jz_i1Ly8oA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*oi7yb6TPHu25Jz_i1Ly8oA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*oi7yb6TPHu25Jz_i1Ly8oA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*oi7yb6TPHu25Jz_i1Ly8oA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*oi7yb6TPHu25Jz_i1Ly8oA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*oi7yb6TPHu25Jz_i1Ly8oA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oi7yb6TPHu25Jz_i1Ly8oA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*oi7yb6TPHu25Jz_i1Ly8oA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*oi7yb6TPHu25Jz_i1Ly8oA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*oi7yb6TPHu25Jz_i1Ly8oA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*oi7yb6TPHu25Jz_i1Ly8oA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*oi7yb6TPHu25Jz_i1Ly8oA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*oi7yb6TPHu25Jz_i1Ly8oA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*oi7yb6TPHu25Jz_i1Ly8oA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="87" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*oi7yb6TPHu25Jz_i1Ly8oA.png"></picture></div></div></figure><p id="5883" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">We can use <code class="cu wa wb wc wd b">DYLD_PRINT_SEARCHING</code> environment variable for the dynamic linker to see the information about where it searched for libraries:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk wu"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*tDbeqh9lD-ipSUdy5IBVmQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*tDbeqh9lD-ipSUdy5IBVmQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*tDbeqh9lD-ipSUdy5IBVmQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*tDbeqh9lD-ipSUdy5IBVmQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*tDbeqh9lD-ipSUdy5IBVmQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*tDbeqh9lD-ipSUdy5IBVmQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tDbeqh9lD-ipSUdy5IBVmQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*tDbeqh9lD-ipSUdy5IBVmQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*tDbeqh9lD-ipSUdy5IBVmQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*tDbeqh9lD-ipSUdy5IBVmQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*tDbeqh9lD-ipSUdy5IBVmQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*tDbeqh9lD-ipSUdy5IBVmQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*tDbeqh9lD-ipSUdy5IBVmQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*tDbeqh9lD-ipSUdy5IBVmQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="316" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*tDbeqh9lD-ipSUdy5IBVmQ.png"></picture></div></div></figure><blockquote class="vb vc vd"><p id="0980" class="ml mm va mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">You can see that it found <code class="cu wa wb wc wd b">libSystem.B.dylib</code> in its shared cache at <code class="cu wa wb wc wd b">0x00AB</code>.</p></blockquote><h2 id="c9c1" class="vi ny ha bc nz vj vk dv od vl vm dx oh mw vn vo vp na vq vr vs ne vt vu vv vw bh" data-selectable-paragraph="">Dyld Shared Cache</h2><p id="41ff" class="pw-post-body-paragraph ml mm ha mn b mo ov mq mr ms ow mu mv mw ox my mz na oy nc nd ne oz ng nh ni gt bh" data-selectable-paragraph="">It optimizes app launch time by creating a single binary that contains all system dylibs in one big binary. On macOS Sonoma, <a class="af pa" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/cache-builder/dyld_cache_format.h#L543" rel="noopener ugc nofollow" target="_blank">we can find it in</a>:</p><pre class="nm nn no np nq wf wd wg bm wh ay bh"><span id="0f81" class="wi ny ha wd b bd wj wk l wl wm" data-selectable-paragraph="">/System/Volumes/Preboot/Cryptexes/OS/System/Library/dyld/</span></pre><p id="8dad" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">There is also a cache with shared libraries used by the <a class="af pa" href="https://developer.apple.com/documentation/driverkit" rel="noopener ugc nofollow" target="_blank">DriverKit</a>:</p><pre class="nm nn no np nq wf wd wg bm wh ay bh"><span id="56bf" class="wi ny ha wd b bd wj wk l wl wm" data-selectable-paragraph="">/System/Volumes/Preboot/Cryptexes/OS/System/DriverKit/System/Library/dyld/</span></pre><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk wv"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*2ra-EgkAHTCCsRT7BoALeg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*2ra-EgkAHTCCsRT7BoALeg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*2ra-EgkAHTCCsRT7BoALeg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*2ra-EgkAHTCCsRT7BoALeg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*2ra-EgkAHTCCsRT7BoALeg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*2ra-EgkAHTCCsRT7BoALeg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2ra-EgkAHTCCsRT7BoALeg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*2ra-EgkAHTCCsRT7BoALeg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*2ra-EgkAHTCCsRT7BoALeg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*2ra-EgkAHTCCsRT7BoALeg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*2ra-EgkAHTCCsRT7BoALeg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*2ra-EgkAHTCCsRT7BoALeg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*2ra-EgkAHTCCsRT7BoALeg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*2ra-EgkAHTCCsRT7BoALeg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="186" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*2ra-EgkAHTCCsRT7BoALeg.png"></picture></div></div></figure><p id="2477" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">The <code class="cu wa wb wc wd b">DYLD_PRINT_SEARCHING</code> environment variable showed us that it found <code class="cu wa wb wc wd b">libSystem.B.dylib</code> at <code class="cu wa wb wc wd b">0x00AB</code> and we can double-check that using <code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/blacktop/ipsw" rel="noopener ugc nofollow" target="_blank">ipsw</a></code>:</p><pre class="nm nn no np nq wf wd wg bm wh ay bh"><span id="0fc2" class="wi ny ha wd b bd wj wk l wl wm" data-selectable-paragraph="">ipsw dyld info -l -s /System/Volumes/Preboot/Cryptexes/OS/System/Library/dyld/dyld_shared_cache_arm64e | grep 'libSystem.B.dylib'</span></pre><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk ww"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*xDZUaLRAuLyKghhUnRrOmw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*xDZUaLRAuLyKghhUnRrOmw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*xDZUaLRAuLyKghhUnRrOmw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*xDZUaLRAuLyKghhUnRrOmw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*xDZUaLRAuLyKghhUnRrOmw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*xDZUaLRAuLyKghhUnRrOmw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xDZUaLRAuLyKghhUnRrOmw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*xDZUaLRAuLyKghhUnRrOmw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*xDZUaLRAuLyKghhUnRrOmw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*xDZUaLRAuLyKghhUnRrOmw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*xDZUaLRAuLyKghhUnRrOmw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*xDZUaLRAuLyKghhUnRrOmw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*xDZUaLRAuLyKghhUnRrOmw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*xDZUaLRAuLyKghhUnRrOmw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="87" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*xDZUaLRAuLyKghhUnRrOmw.png"></picture></div></div></figure><p id="1540" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">We can extract all dylibs using <code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/blacktop/ipsw" rel="noopener ugc nofollow" target="_blank">ipsw</a></code> or <code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/keith/dyld-shared-cache-extractor" rel="noopener ugc nofollow" target="_blank">dyld-shared-cache-extractor</a></code>:</p><pre class="nm nn no np nq wf wd wg bm wh ay bh"><span id="7f15" class="wi ny ha wd b bd wj wk l wl wm" data-selectable-paragraph="">brew install keith/formulae/dyld-shared-cache-extractor<br>dyld-shared-cache-extractor /System/Volumes/Preboot/Cryptexes/OS/System/Library/dyld/dyld_shared_cache_arm64e extracted/</span></pre><p id="1b01" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">The extracted dylibs will be stored in <code class="cu wa wb wc wd b">extracted/</code> directory. You can observe that <code class="cu wa wb wc wd b">libSystem.B.dylib</code> exists inside:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk wx"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*JF9JtfuTldaL1QVV30ALog.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*JF9JtfuTldaL1QVV30ALog.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*JF9JtfuTldaL1QVV30ALog.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*JF9JtfuTldaL1QVV30ALog.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*JF9JtfuTldaL1QVV30ALog.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*JF9JtfuTldaL1QVV30ALog.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JF9JtfuTldaL1QVV30ALog.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*JF9JtfuTldaL1QVV30ALog.png 640w, https://miro.medium.com/v2/resize:fit:720/1*JF9JtfuTldaL1QVV30ALog.png 720w, https://miro.medium.com/v2/resize:fit:750/1*JF9JtfuTldaL1QVV30ALog.png 750w, https://miro.medium.com/v2/resize:fit:786/1*JF9JtfuTldaL1QVV30ALog.png 786w, https://miro.medium.com/v2/resize:fit:828/1*JF9JtfuTldaL1QVV30ALog.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*JF9JtfuTldaL1QVV30ALog.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*JF9JtfuTldaL1QVV30ALog.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="209" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*JF9JtfuTldaL1QVV30ALog.png"></picture></div></div></figure><p id="21b7" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">Alternatively, we can use Hopper to inspect the chosen dylib from a cache:</p><pre class="nm nn no np nq wf wd wg bm wh ay bh"><span id="42b9" class="wi ny ha wd b bd wj wk l wl wm" data-selectable-paragraph="">hopper -e /System/Volumes/Preboot/Cryptexes/OS/System/Library/dyld/dyld_shared_cache_arm64e</span></pre><p id="4fcd" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">As you can see below, we can also confirm this way that dylib exists:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk wy"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*0F8DFoagh71ta2MmjxNY8A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*0F8DFoagh71ta2MmjxNY8A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*0F8DFoagh71ta2MmjxNY8A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*0F8DFoagh71ta2MmjxNY8A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*0F8DFoagh71ta2MmjxNY8A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*0F8DFoagh71ta2MmjxNY8A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0F8DFoagh71ta2MmjxNY8A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*0F8DFoagh71ta2MmjxNY8A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*0F8DFoagh71ta2MmjxNY8A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*0F8DFoagh71ta2MmjxNY8A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*0F8DFoagh71ta2MmjxNY8A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*0F8DFoagh71ta2MmjxNY8A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*0F8DFoagh71ta2MmjxNY8A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*0F8DFoagh71ta2MmjxNY8A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="501" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*0F8DFoagh71ta2MmjxNY8A.png"></picture></div></div></figure><p id="1ee9" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">I prefer the first method because when I extract all libraries at once, I can find specific functions and strings across the entire cache using <code class="cu wa wb wc wd b">grep</code>:</p></div></div><div class="nr"><div class="ab by"><div class="ln wz lo xa lp xb cc xc cd xd cf be"><figure class="nm nn no np nq nr xf xg paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk xe"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*qwDOtr81Fvc2Yh6hJB9zig.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*qwDOtr81Fvc2Yh6hJB9zig.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*qwDOtr81Fvc2Yh6hJB9zig.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*qwDOtr81Fvc2Yh6hJB9zig.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*qwDOtr81Fvc2Yh6hJB9zig.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*qwDOtr81Fvc2Yh6hJB9zig.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*qwDOtr81Fvc2Yh6hJB9zig.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*qwDOtr81Fvc2Yh6hJB9zig.png 640w, https://miro.medium.com/v2/resize:fit:720/1*qwDOtr81Fvc2Yh6hJB9zig.png 720w, https://miro.medium.com/v2/resize:fit:750/1*qwDOtr81Fvc2Yh6hJB9zig.png 750w, https://miro.medium.com/v2/resize:fit:786/1*qwDOtr81Fvc2Yh6hJB9zig.png 786w, https://miro.medium.com/v2/resize:fit:828/1*qwDOtr81Fvc2Yh6hJB9zig.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*qwDOtr81Fvc2Yh6hJB9zig.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*qwDOtr81Fvc2Yh6hJB9zig.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be ls nw c" width="1000" height="113" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*qwDOtr81Fvc2Yh6hJB9zig.png"></picture></div></div></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><p id="eedb" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">Last, but not least, the <code class="cu wa wb wc wd b"><a class="af pa" href="https://blacktop.github.io/ipsw/docs/guides/dyld" rel="noopener ugc nofollow" target="_blank">ipsw</a></code> is a great choice if you need to parse the Dyld Shared Cache header to get the memory mappings, library names etc.:</p><pre class="nm nn no np nq wf wd wg bm wh ay bh"><span id="e731" class="wi ny ha wd b bd wj wk l wl wm" data-selectable-paragraph="">ipsw dyld info -l -s "$dyld_shared_cache_arm64e_path" | head -n39</span></pre><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk xh"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*IB-f7KjvgtNBKwE83ZEyFg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*IB-f7KjvgtNBKwE83ZEyFg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*IB-f7KjvgtNBKwE83ZEyFg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*IB-f7KjvgtNBKwE83ZEyFg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*IB-f7KjvgtNBKwE83ZEyFg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*IB-f7KjvgtNBKwE83ZEyFg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IB-f7KjvgtNBKwE83ZEyFg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*IB-f7KjvgtNBKwE83ZEyFg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*IB-f7KjvgtNBKwE83ZEyFg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*IB-f7KjvgtNBKwE83ZEyFg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*IB-f7KjvgtNBKwE83ZEyFg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*IB-f7KjvgtNBKwE83ZEyFg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*IB-f7KjvgtNBKwE83ZEyFg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*IB-f7KjvgtNBKwE83ZEyFg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="478" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*IB-f7KjvgtNBKwE83ZEyFg.png"></picture></div></div></figure><blockquote class="vb vc vd"><p id="a48f" class="ml mm va mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">The structure of the shared cache format can be seen in <a class="af pa" href="https://github.com/apple-oss-distributions/dyld/blob/d1a0f6869ece370913a3f749617e457f3b4cd7c4/cache-builder/dyld_cache_format.h#L31C15-L31C15" rel="noopener ugc nofollow" target="_blank">dyld_cache_format.h</a>.</p></blockquote><h2 id="ec97" class="vi ny ha bc nz vj vk dv od vl vm dx oh mw vn vo vp na vq vr vs ne vt vu vv vw bh" data-selectable-paragraph="">Loading Process</h2><p id="ac92" class="pw-post-body-paragraph ml mm ha mn b mo ov mq mr ms ow mu mv mw ox my mz na oy nc nd ne oz ng nh ni gt bh" data-selectable-paragraph="">When an application is executed, dyld loads necessary libraries into the application's virtual address space.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk xi"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*kAaL0a1wxpCrzx8tjADTXA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*kAaL0a1wxpCrzx8tjADTXA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*kAaL0a1wxpCrzx8tjADTXA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*kAaL0a1wxpCrzx8tjADTXA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*kAaL0a1wxpCrzx8tjADTXA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*kAaL0a1wxpCrzx8tjADTXA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kAaL0a1wxpCrzx8tjADTXA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*kAaL0a1wxpCrzx8tjADTXA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*kAaL0a1wxpCrzx8tjADTXA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*kAaL0a1wxpCrzx8tjADTXA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*kAaL0a1wxpCrzx8tjADTXA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*kAaL0a1wxpCrzx8tjADTXA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*kAaL0a1wxpCrzx8tjADTXA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*kAaL0a1wxpCrzx8tjADTXA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="381" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*kAaL0a1wxpCrzx8tjADTXA.png"></picture></div></div></figure><p id="538a" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">However, more libraries are being loaded during runtime. They are system libraries, all dependencies loaded automatically by the dyld:</p><pre class="nm nn no np nq wf wd wg bm wh ay bh"><span id="0985" class="wi ny ha wd b bd wj wk l wl wm" data-selectable-paragraph="">DYLD_PRINT_LIBRARIES=1 DYLD_PRINT_RPATHS=1 DYLD_PRINT_TO_FILE=dyld.log ./use_mylib</span></pre><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk xj"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*N1Bv0utLALmL-EaF6YRijA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*N1Bv0utLALmL-EaF6YRijA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*N1Bv0utLALmL-EaF6YRijA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*N1Bv0utLALmL-EaF6YRijA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*N1Bv0utLALmL-EaF6YRijA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*N1Bv0utLALmL-EaF6YRijA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N1Bv0utLALmL-EaF6YRijA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*N1Bv0utLALmL-EaF6YRijA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*N1Bv0utLALmL-EaF6YRijA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*N1Bv0utLALmL-EaF6YRijA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*N1Bv0utLALmL-EaF6YRijA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*N1Bv0utLALmL-EaF6YRijA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*N1Bv0utLALmL-EaF6YRijA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*N1Bv0utLALmL-EaF6YRijA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="243" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*N1Bv0utLALmL-EaF6YRijA.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph="">The screenshot was redacted — there are a lot more libraries</figcaption></figure><p id="e29d" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">These additional libraries are dependencies for <code class="cu wa wb wc wd b">libSystem.B.dylib</code>. We can use the <code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/keith/dylibtree" rel="noopener ugc nofollow" target="_blank">dylibtree</a></code> tool to list all of them in a tree structure:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk xk"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*26UGRXV-4j_0F6i6-QIJbQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*26UGRXV-4j_0F6i6-QIJbQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*26UGRXV-4j_0F6i6-QIJbQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*26UGRXV-4j_0F6i6-QIJbQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*26UGRXV-4j_0F6i6-QIJbQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*26UGRXV-4j_0F6i6-QIJbQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*26UGRXV-4j_0F6i6-QIJbQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*26UGRXV-4j_0F6i6-QIJbQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*26UGRXV-4j_0F6i6-QIJbQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*26UGRXV-4j_0F6i6-QIJbQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*26UGRXV-4j_0F6i6-QIJbQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*26UGRXV-4j_0F6i6-QIJbQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*26UGRXV-4j_0F6i6-QIJbQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*26UGRXV-4j_0F6i6-QIJbQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="397" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*26UGRXV-4j_0F6i6-QIJbQ.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph="">The screenshot was redacted — there are a lot more libraries</figcaption></figure><p id="d88e" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">For our specific case <code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/custom/mylib.c" rel="noopener ugc nofollow" target="_blank">mylib.dylib</a></code>, to make the above command work, we must change the dylib source to absolute path. <em class="va">More on that in a moment.</em></p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk xl"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*UesUXmbZt1n5c_rB0iZz8g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*UesUXmbZt1n5c_rB0iZz8g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*UesUXmbZt1n5c_rB0iZz8g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*UesUXmbZt1n5c_rB0iZz8g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*UesUXmbZt1n5c_rB0iZz8g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*UesUXmbZt1n5c_rB0iZz8g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UesUXmbZt1n5c_rB0iZz8g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*UesUXmbZt1n5c_rB0iZz8g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*UesUXmbZt1n5c_rB0iZz8g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*UesUXmbZt1n5c_rB0iZz8g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*UesUXmbZt1n5c_rB0iZz8g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*UesUXmbZt1n5c_rB0iZz8g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*UesUXmbZt1n5c_rB0iZz8g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*UesUXmbZt1n5c_rB0iZz8g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="140" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*UesUXmbZt1n5c_rB0iZz8g.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph=""><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/python/CrimsonUroboros.py#L934" rel="noopener ugc nofollow" target="_blank">printDylibs</a></figcaption></figure><p id="4c89" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">If we try to run <code class="cu wa wb wc wd b">dylibtree</code> on the <code class="cu wa wb wc wd b">use_mylib</code> without the above changes, we would end up with the below error:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk xm"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*GpCOScttRuhtRP2-ej9ABA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*GpCOScttRuhtRP2-ej9ABA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*GpCOScttRuhtRP2-ej9ABA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*GpCOScttRuhtRP2-ej9ABA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*GpCOScttRuhtRP2-ej9ABA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*GpCOScttRuhtRP2-ej9ABA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GpCOScttRuhtRP2-ej9ABA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*GpCOScttRuhtRP2-ej9ABA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*GpCOScttRuhtRP2-ej9ABA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*GpCOScttRuhtRP2-ej9ABA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*GpCOScttRuhtRP2-ej9ABA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*GpCOScttRuhtRP2-ej9ABA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*GpCOScttRuhtRP2-ej9ABA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*GpCOScttRuhtRP2-ej9ABA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="91" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*GpCOScttRuhtRP2-ej9ABA.png"></picture></div></div></figure><p id="706e" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">For this reason, I created <code class="cu wa wb wc wd b">dylibtree</code> in <code class="cu wa wb wc wd b">CrimsonUroboros</code> to handle relative paths, print if any dylib is missing, and if it is inside the Dyld Shared Cache.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk nl"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*5PoMWXI_5rk0v1wPfVk5ew.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*5PoMWXI_5rk0v1wPfVk5ew.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*5PoMWXI_5rk0v1wPfVk5ew.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*5PoMWXI_5rk0v1wPfVk5ew.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*5PoMWXI_5rk0v1wPfVk5ew.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*5PoMWXI_5rk0v1wPfVk5ew.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5PoMWXI_5rk0v1wPfVk5ew.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*5PoMWXI_5rk0v1wPfVk5ew.png 640w, https://miro.medium.com/v2/resize:fit:720/1*5PoMWXI_5rk0v1wPfVk5ew.png 720w, https://miro.medium.com/v2/resize:fit:750/1*5PoMWXI_5rk0v1wPfVk5ew.png 750w, https://miro.medium.com/v2/resize:fit:786/1*5PoMWXI_5rk0v1wPfVk5ew.png 786w, https://miro.medium.com/v2/resize:fit:828/1*5PoMWXI_5rk0v1wPfVk5ew.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*5PoMWXI_5rk0v1wPfVk5ew.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*5PoMWXI_5rk0v1wPfVk5ew.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="467" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*5PoMWXI_5rk0v1wPfVk5ew.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph=""><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/python/CrimsonUroboros.py#L839" rel="noopener ugc nofollow" target="_blank">getDylibTree</a></figcaption></figure><p id="7edd" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">To use it, you must have preinstalled <code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/keith/dyld-shared-cache-extractor" rel="noopener ugc nofollow" target="_blank">dyld-shared-cache-extractor</a></code>. You can also check if the specified file has these “<em class="va">broken</em>” relative paths using:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk xn"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*sj-St6xj7nm7GiINHB2KzQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*sj-St6xj7nm7GiINHB2KzQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*sj-St6xj7nm7GiINHB2KzQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*sj-St6xj7nm7GiINHB2KzQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*sj-St6xj7nm7GiINHB2KzQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*sj-St6xj7nm7GiINHB2KzQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sj-St6xj7nm7GiINHB2KzQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*sj-St6xj7nm7GiINHB2KzQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*sj-St6xj7nm7GiINHB2KzQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*sj-St6xj7nm7GiINHB2KzQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*sj-St6xj7nm7GiINHB2KzQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*sj-St6xj7nm7GiINHB2KzQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*sj-St6xj7nm7GiINHB2KzQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*sj-St6xj7nm7GiINHB2KzQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="81" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*sj-St6xj7nm7GiINHB2KzQ.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph=""><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/python/CrimsonUroboros.py#L811" rel="noopener ugc nofollow" target="_blank">checkBrokenRelativeDylibSource</a></figcaption></figure><blockquote class="xo"><p id="ffda" class="xp xq ha bc xr xs xt xu xv xw xx ni dr" data-selectable-paragraph="">Relative paths are not allowed in Hardened Runtime.</p></blockquote><p id="5a2a" class="pw-post-body-paragraph ml mm ha mn b mo xy mq mr ms xz mu mv mw ya my mz na yb nc nd ne yc ng nh ni gt bh" data-selectable-paragraph=""><em class="va">As you can see, more dependencies are loaded when you execute the binary than just the two libraries we saw earlier with </em><code class="cu wa wb wc wd b"><em class="va">otool -L</em></code><em class="va">.</em></p><p id="eb97" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">Then, the dynamic linker resolves symbols, ensuring that the application can access functions and data defined in these libraries as described in:</p><div class="yd ye yf yg yh yi"><a rel="noopener follow" target="_blank" href="/snake-apple-i-mach-o-a8eda4b87263?source=post_page-----2c955439b94e--------------------------------"><div class="yj ab iz"><div class="yk ab cl by yl ym"><h2 class="bc hb iq z yn yo yp yq yr ys yt gz bh">Snake&amp;Apple I — Mach-O</h2></div><div class="yu l"><div class="yv l yw yx yy yu yz ls yi"></div></div></div></a></div><p id="a65a" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph=""><em class="va">Old versions (below dyld v.852) used the </em><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/macos/ImageLoader.cpp#L729" rel="noopener ugc nofollow" target="_blank"><em class="va">recursiveLoadLibraries</em></a><em class="va"> to gather paths with </em><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/macos/ImageLoader.cpp#L737" rel="noopener ugc nofollow" target="_blank"><em class="va">doGetDependentLibraries</em></a><em class="va"> and </em><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/macos/ImageLoader.cpp#L741" rel="noopener ugc nofollow" target="_blank"><em class="va">getRPaths</em></a><em class="va"> commands from </em><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/macos/ImageLoader.cpp" rel="noopener ugc nofollow" target="_blank"><em class="va">ImageLoader.cpp</em></a><em class="va">.</em></p><p id="0529" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">The current logic is described in <a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/macos/MachOFile.cpp" rel="noopener ugc nofollow" target="_blank">MachOFile.cpp</a>, <a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/macos/Loader.cpp" rel="noopener ugc nofollow" target="_blank">Loader. cpp</a> and <a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/macos/Header.cpp" rel="noopener ugc nofollow" target="_blank">Header.cpp</a> (dyld v. 1122).</p><p id="6db5" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">There are several Load Commands that are used to support dynamic linking, and they are listed below:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk za"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*2T1Gbhmg4jQAsImwVjtO9g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*2T1Gbhmg4jQAsImwVjtO9g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*2T1Gbhmg4jQAsImwVjtO9g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*2T1Gbhmg4jQAsImwVjtO9g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*2T1Gbhmg4jQAsImwVjtO9g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*2T1Gbhmg4jQAsImwVjtO9g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2T1Gbhmg4jQAsImwVjtO9g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*2T1Gbhmg4jQAsImwVjtO9g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*2T1Gbhmg4jQAsImwVjtO9g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*2T1Gbhmg4jQAsImwVjtO9g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*2T1Gbhmg4jQAsImwVjtO9g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*2T1Gbhmg4jQAsImwVjtO9g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*2T1Gbhmg4jQAsImwVjtO9g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*2T1Gbhmg4jQAsImwVjtO9g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="152" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*2T1Gbhmg4jQAsImwVjtO9g.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph="">Obsolete commands are greyed out</figcaption></figure><p id="6349" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">I created a <a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/MachOLoadCommandsCheker.py" rel="noopener ugc nofollow" target="_blank">MachODylibLoadCommandsFinder</a> script to analyze 39805 different Mach-O files to identify rarely used and obsolete commands.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk wn"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*6kdOTyqqjhE_Hm4mIcrfMw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*6kdOTyqqjhE_Hm4mIcrfMw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*6kdOTyqqjhE_Hm4mIcrfMw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*6kdOTyqqjhE_Hm4mIcrfMw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*6kdOTyqqjhE_Hm4mIcrfMw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*6kdOTyqqjhE_Hm4mIcrfMw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6kdOTyqqjhE_Hm4mIcrfMw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*6kdOTyqqjhE_Hm4mIcrfMw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*6kdOTyqqjhE_Hm4mIcrfMw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*6kdOTyqqjhE_Hm4mIcrfMw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*6kdOTyqqjhE_Hm4mIcrfMw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*6kdOTyqqjhE_Hm4mIcrfMw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*6kdOTyqqjhE_Hm4mIcrfMw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*6kdOTyqqjhE_Hm4mIcrfMw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="266" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*6kdOTyqqjhE_Hm4mIcrfMw.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph="">According to the chart, PREBOUND_DYLIB and LAZY_LOAD_DYLIB are no longer used</figcaption></figure><h2 id="da6d" class="vi ny ha bc nz vj vk dv od vl vm dx oh mw vn vo vp na vq vr vs ne vt vu vv vw bh" data-selectable-paragraph="">Load Commands</h2><p id="29dd" class="pw-post-body-paragraph ml mm ha mn b mo ov mq mr ms ow mu mv mw ox my mz na oy nc nd ne oz ng nh ni gt bh" data-selectable-paragraph="">Ultimately, there are five interesting load commands in context of dylib:</p><ul class=""><li id="a31b" class="ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni zb zc zd bh" data-selectable-paragraph=""><code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/macos/loader.h#L275" rel="noopener ugc nofollow" target="_blank">LC_LOAD_DYLIB</a></code> — load dylib.</li><li id="2f36" class="ml mm ha mn b mo ze mq mr ms zf mu mv mw zg my mz na zh nc nd ne zi ng nh ni zb zc zd bh" data-selectable-paragraph=""><code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/macos/loader.h#L293" rel="noopener ugc nofollow" target="_blank">LC_LOAD_WEAK_DYLIB</a></code> — if the dylib is missing, execution continues without any error.</li><li id="ac22" class="ml mm ha mn b mo ze mq mr ms zf mu mv mw zg my mz na zh nc nd ne zi ng nh ni zb zc zd bh" data-selectable-paragraph=""><code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/macos/loader.h#L302" rel="noopener ugc nofollow" target="_blank">LC_REEXPORT_DYLIB</a></code> — allows other libraries or executables to use the symbols from the re-exported library without linking directly against it. Consider it as a proxy stub that only points to another library.</li><li id="bbd2" class="ml mm ha mn b mo ze mq mr ms zf mu mv mw zg my mz na zh nc nd ne zi ng nh ni zb zc zd bh" data-selectable-paragraph=""><code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/macos/loader.h#L307C5-L307C5" rel="noopener ugc nofollow" target="_blank">LC_LOAD_UPWARD_DYLIB</a></code> —used when two libraries depend on each other (<a class="af pa" href="https://stackoverflow.com/questions/11053038/what-is-an-upward-dependency-for-linking#:~:text=An%20upward%20dependency%20is%20something%20that%20goes%20against,in%20library%20%22B%22%3B%20library%20%22A%22%20depends%20on%20%22B%22." rel="noopener ugc nofollow" target="_blank">upward dependency</a>).</li><li id="0777" class="ml mm ha mn b mo ze mq mr ms zf mu mv mw zg my mz na zh nc nd ne zi ng nh ni zb zc zd bh" data-selectable-paragraph=""><code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/macos/loader.h#L276" rel="noopener ugc nofollow" target="_blank">LC_ID_DYLIB</a></code> — used only in dylib (Mach-O type <code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/macos/loader.h#L115" rel="noopener ugc nofollow" target="_blank">MH_DYLIB</a></code>) as an ID.</li></ul><p id="6f27" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">All of them (except <code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/macos/loader.h#L299" rel="noopener ugc nofollow" target="_blank">LC_RPATH</a></code>) use <code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/macos/loader.h#L684" rel="noopener ugc nofollow" target="_blank">dylib_command</a></code> structure:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk zj"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*sxfLQ7bY1pPXLfw38M8bKw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*sxfLQ7bY1pPXLfw38M8bKw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*sxfLQ7bY1pPXLfw38M8bKw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*sxfLQ7bY1pPXLfw38M8bKw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*sxfLQ7bY1pPXLfw38M8bKw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*sxfLQ7bY1pPXLfw38M8bKw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sxfLQ7bY1pPXLfw38M8bKw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*sxfLQ7bY1pPXLfw38M8bKw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*sxfLQ7bY1pPXLfw38M8bKw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*sxfLQ7bY1pPXLfw38M8bKw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*sxfLQ7bY1pPXLfw38M8bKw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*sxfLQ7bY1pPXLfw38M8bKw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*sxfLQ7bY1pPXLfw38M8bKw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*sxfLQ7bY1pPXLfw38M8bKw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="370" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*sxfLQ7bY1pPXLfw38M8bKw.png"></picture></div></div></figure><p id="6b10" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">The structure is self-explanatory. The most important information here is the <strong class="mn hb">path of the library to load</strong>, which sometimes can use the <code class="cu wa wb wc wd b">rpath</code> prefix:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk zk"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*K4YPjtZ8I1eWbaVI-Zh59w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*K4YPjtZ8I1eWbaVI-Zh59w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*K4YPjtZ8I1eWbaVI-Zh59w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*K4YPjtZ8I1eWbaVI-Zh59w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*K4YPjtZ8I1eWbaVI-Zh59w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*K4YPjtZ8I1eWbaVI-Zh59w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K4YPjtZ8I1eWbaVI-Zh59w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*K4YPjtZ8I1eWbaVI-Zh59w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*K4YPjtZ8I1eWbaVI-Zh59w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*K4YPjtZ8I1eWbaVI-Zh59w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*K4YPjtZ8I1eWbaVI-Zh59w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*K4YPjtZ8I1eWbaVI-Zh59w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*K4YPjtZ8I1eWbaVI-Zh59w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*K4YPjtZ8I1eWbaVI-Zh59w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="165" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*K4YPjtZ8I1eWbaVI-Zh59w.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph="">Example dylib_command</figcaption></figure><p id="336e" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">The <code class="cu wa wb wc wd b">rpath</code> <strong class="mn hb">stores paths to directories, which are added at runtime</strong>. These paths are stored in the <code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/macos/loader.h#L299" rel="noopener ugc nofollow" target="_blank">LC_RPATH</a></code> described by the <code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/macos/loader.h#L1182" rel="noopener ugc nofollow" target="_blank">rpath_command</a></code> structure:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk zl"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*WF6cKB1EZXB9nvA8oU3qcQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*WF6cKB1EZXB9nvA8oU3qcQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*WF6cKB1EZXB9nvA8oU3qcQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*WF6cKB1EZXB9nvA8oU3qcQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*WF6cKB1EZXB9nvA8oU3qcQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*WF6cKB1EZXB9nvA8oU3qcQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WF6cKB1EZXB9nvA8oU3qcQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*WF6cKB1EZXB9nvA8oU3qcQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*WF6cKB1EZXB9nvA8oU3qcQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*WF6cKB1EZXB9nvA8oU3qcQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*WF6cKB1EZXB9nvA8oU3qcQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*WF6cKB1EZXB9nvA8oU3qcQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*WF6cKB1EZXB9nvA8oU3qcQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*WF6cKB1EZXB9nvA8oU3qcQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="186" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*WF6cKB1EZXB9nvA8oU3qcQ.png"></picture></div></div></figure><p id="ea44" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">On macOS it is impossible to create a longer directory|file name than 255B:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk zm"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*KHesJ-IBQwQAO4Eusz1ANA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*KHesJ-IBQwQAO4Eusz1ANA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*KHesJ-IBQwQAO4Eusz1ANA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*KHesJ-IBQwQAO4Eusz1ANA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*KHesJ-IBQwQAO4Eusz1ANA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*KHesJ-IBQwQAO4Eusz1ANA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KHesJ-IBQwQAO4Eusz1ANA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*KHesJ-IBQwQAO4Eusz1ANA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*KHesJ-IBQwQAO4Eusz1ANA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*KHesJ-IBQwQAO4Eusz1ANA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*KHesJ-IBQwQAO4Eusz1ANA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*KHesJ-IBQwQAO4Eusz1ANA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*KHesJ-IBQwQAO4Eusz1ANA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*KHesJ-IBQwQAO4Eusz1ANA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="277" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*KHesJ-IBQwQAO4Eusz1ANA.png"></picture></div></div></figure><p id="eb52" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">It is also impossible to create a longer nested directory at once than 1024B:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk zn"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*MwjoEQVmOvEnwgYdkAMkZA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*MwjoEQVmOvEnwgYdkAMkZA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*MwjoEQVmOvEnwgYdkAMkZA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*MwjoEQVmOvEnwgYdkAMkZA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*MwjoEQVmOvEnwgYdkAMkZA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*MwjoEQVmOvEnwgYdkAMkZA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MwjoEQVmOvEnwgYdkAMkZA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*MwjoEQVmOvEnwgYdkAMkZA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*MwjoEQVmOvEnwgYdkAMkZA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*MwjoEQVmOvEnwgYdkAMkZA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*MwjoEQVmOvEnwgYdkAMkZA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*MwjoEQVmOvEnwgYdkAMkZA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*MwjoEQVmOvEnwgYdkAMkZA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*MwjoEQVmOvEnwgYdkAMkZA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="534" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*MwjoEQVmOvEnwgYdkAMkZA.png"></picture></div></div></figure><p id="a427" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">Still, it is possible to set longer <code class="cu wa wb wc wd b">@rpath</code> than 1024B, but dyld while loading cut off anything beyond 1024B in fully resolved <code class="cu wa wb wc wd b">@rpath+path</code>:</p><pre class="nm nn no np nq wf wd wg bm wh ay bh"><span id="77e7" class="wi ny ha wd b bd wj wk l wl wm" data-selectable-paragraph="">a=$(python -c 'print(255*"C")')<br>clang -o use_mylib use_mylib.c A.dylib -Wl,-rpath,/Users/karmaz95/t/long_names_dylibs/$a/$a/$a/$a<br>install_name_tool -change 'A.dylib' '@rpath/A.dylib' use_mylib</span></pre><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk zo"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*i6jQ8buKbLuAdUcUEHQvog.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*i6jQ8buKbLuAdUcUEHQvog.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*i6jQ8buKbLuAdUcUEHQvog.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*i6jQ8buKbLuAdUcUEHQvog.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*i6jQ8buKbLuAdUcUEHQvog.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*i6jQ8buKbLuAdUcUEHQvog.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i6jQ8buKbLuAdUcUEHQvog.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*i6jQ8buKbLuAdUcUEHQvog.png 640w, https://miro.medium.com/v2/resize:fit:720/1*i6jQ8buKbLuAdUcUEHQvog.png 720w, https://miro.medium.com/v2/resize:fit:750/1*i6jQ8buKbLuAdUcUEHQvog.png 750w, https://miro.medium.com/v2/resize:fit:786/1*i6jQ8buKbLuAdUcUEHQvog.png 786w, https://miro.medium.com/v2/resize:fit:828/1*i6jQ8buKbLuAdUcUEHQvog.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*i6jQ8buKbLuAdUcUEHQvog.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*i6jQ8buKbLuAdUcUEHQvog.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="584" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*i6jQ8buKbLuAdUcUEHQvog.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph=""><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/python/CrimsonUroboros.py#L934C13-L934C13" rel="noopener ugc nofollow" target="_blank">printDylibs</a></figcaption></figure><p id="4f19" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">Dylib load commands can be used to load multiple dylibs. <code class="cu wa wb wc wd b">LC_RPATH</code> can be used numerous times to add multiple paths to <code class="cu wa wb wc wd b">@rpath</code>.</p></div></div><div class="nr"><div class="ab by"><div class="ln wz lo xa lp xb cc xc cd xd cf be"><figure class="nm nn no np nq nr xf xg paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk zm"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*8EYFnea3aqPV1vJK6Ryk9w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*8EYFnea3aqPV1vJK6Ryk9w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*8EYFnea3aqPV1vJK6Ryk9w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*8EYFnea3aqPV1vJK6Ryk9w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*8EYFnea3aqPV1vJK6Ryk9w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*8EYFnea3aqPV1vJK6Ryk9w.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*8EYFnea3aqPV1vJK6Ryk9w.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*8EYFnea3aqPV1vJK6Ryk9w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*8EYFnea3aqPV1vJK6Ryk9w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*8EYFnea3aqPV1vJK6Ryk9w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*8EYFnea3aqPV1vJK6Ryk9w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*8EYFnea3aqPV1vJK6Ryk9w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*8EYFnea3aqPV1vJK6Ryk9w.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*8EYFnea3aqPV1vJK6Ryk9w.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be ls nw c" width="1000" height="181" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*8EYFnea3aqPV1vJK6Ryk9w.png"></picture></div></div></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><p id="6c12" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">If there are multiple <code class="cu wa wb wc wd b">LC_LOAD_DYLIB</code> commands, they will be executed in the order they appear. The same rule applies to paths in <code class="cu wa wb wc wd b">LC_RPATH</code>.</p><ul class=""><li id="0cf2" class="ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni zb zc zd bh" data-selectable-paragraph="">All load commands that use <code class="cu wa wb wc wd b">rpath</code> directories:</li></ul><pre class="nm nn no np nq wf wd wg bm wh ay bh"><span id="032a" class="wi ny ha wd b bd wj wk l wl wm" data-selectable-paragraph="">otool -l "$BINARY_PATH" | grep -A2 "LC_.*._DYLIB" | grep "@rpath"<br>CrimsonUroboros -p "$BINARY_PATH" --dylibs_paths_u | grep "@rpath"</span></pre><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk zp"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*0murhAnojH4ZZSQH0bvI0A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*0murhAnojH4ZZSQH0bvI0A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*0murhAnojH4ZZSQH0bvI0A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*0murhAnojH4ZZSQH0bvI0A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*0murhAnojH4ZZSQH0bvI0A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*0murhAnojH4ZZSQH0bvI0A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0murhAnojH4ZZSQH0bvI0A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*0murhAnojH4ZZSQH0bvI0A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*0murhAnojH4ZZSQH0bvI0A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*0murhAnojH4ZZSQH0bvI0A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*0murhAnojH4ZZSQH0bvI0A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*0murhAnojH4ZZSQH0bvI0A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*0murhAnojH4ZZSQH0bvI0A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*0murhAnojH4ZZSQH0bvI0A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="323" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*0murhAnojH4ZZSQH0bvI0A.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph=""><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/python/CrimsonUroboros.py#L951" rel="noopener ugc nofollow" target="_blank">printUnresolvedDylibPaths</a></figcaption></figure><ul class=""><li id="1f14" class="ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni zb zc zd bh" data-selectable-paragraph="">All directories resolved in place of <code class="cu wa wb wc wd b">rpath</code>:</li></ul><pre class="nm nn no np nq wf wd wg bm wh ay bh"><span id="feef" class="wi ny ha wd b bd wj wk l wl wm" data-selectable-paragraph="">otool -l "$BINARY_PATH" | grep -A2 "LC_RPATH" | grep path<br>CrimsonUroboros -p "$BINARY_PATH" --rpaths</span></pre><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk zq"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*9ntnUYXUd2d1fsGUTMpm9A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*9ntnUYXUd2d1fsGUTMpm9A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*9ntnUYXUd2d1fsGUTMpm9A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*9ntnUYXUd2d1fsGUTMpm9A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*9ntnUYXUd2d1fsGUTMpm9A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*9ntnUYXUd2d1fsGUTMpm9A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9ntnUYXUd2d1fsGUTMpm9A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*9ntnUYXUd2d1fsGUTMpm9A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*9ntnUYXUd2d1fsGUTMpm9A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*9ntnUYXUd2d1fsGUTMpm9A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*9ntnUYXUd2d1fsGUTMpm9A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*9ntnUYXUd2d1fsGUTMpm9A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*9ntnUYXUd2d1fsGUTMpm9A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*9ntnUYXUd2d1fsGUTMpm9A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="207" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*9ntnUYXUd2d1fsGUTMpm9A.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph=""><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/python/CrimsonUroboros.py#L939" rel="noopener ugc nofollow" target="_blank">printRpathsResolved</a> &amp; <a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/python/CrimsonUroboros.py#L943" rel="noopener ugc nofollow" target="_blank">printRpathsUnresolved</a></figcaption></figure><p id="64d8" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">Based on the example the <code class="cu wa wb wc wd b">Base32</code> dylib will be loaded in the below order:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk zr"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*W2uDNzhYgFaCi4X923XXIg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*W2uDNzhYgFaCi4X923XXIg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*W2uDNzhYgFaCi4X923XXIg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*W2uDNzhYgFaCi4X923XXIg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*W2uDNzhYgFaCi4X923XXIg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*W2uDNzhYgFaCi4X923XXIg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W2uDNzhYgFaCi4X923XXIg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*W2uDNzhYgFaCi4X923XXIg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*W2uDNzhYgFaCi4X923XXIg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*W2uDNzhYgFaCi4X923XXIg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*W2uDNzhYgFaCi4X923XXIg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*W2uDNzhYgFaCi4X923XXIg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*W2uDNzhYgFaCi4X923XXIg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*W2uDNzhYgFaCi4X923XXIg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="90" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*W2uDNzhYgFaCi4X923XXIg.png"></picture></div></div></figure><blockquote class="vb vc vd"><p id="fcc6" class="ml mm va mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">When used in an executable, <code class="cu wa wb wc wd b">@loader_path</code> is equivalent to <code class="cu wa wb wc wd b">@executable_path</code> which is the path to the directory containing the main executable file.</p></blockquote><h2 id="809a" class="vi ny ha bc nz vj vk dv od vl vm dx oh mw vn vo vp na vq vr vs ne vt vu vv vw bh" data-selectable-paragraph="">Library IDs</h2><p id="dffe" class="pw-post-body-paragraph ml mm ha mn b mo ov mq mr ms ow mu mv mw ox my mz na oy nc nd ne oz ng nh ni gt bh" data-selectable-paragraph="">The <code class="cu wa wb wc wd b">LC_ID_DYLIB</code> load command is essential for compilation because it <strong class="mn hb">stores the path at which the dynamic library can be found</strong> at runtime.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk zs"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*_IXFqXlKEynfd_Rz9xh81g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*_IXFqXlKEynfd_Rz9xh81g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*_IXFqXlKEynfd_Rz9xh81g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*_IXFqXlKEynfd_Rz9xh81g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*_IXFqXlKEynfd_Rz9xh81g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*_IXFqXlKEynfd_Rz9xh81g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_IXFqXlKEynfd_Rz9xh81g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*_IXFqXlKEynfd_Rz9xh81g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*_IXFqXlKEynfd_Rz9xh81g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*_IXFqXlKEynfd_Rz9xh81g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*_IXFqXlKEynfd_Rz9xh81g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*_IXFqXlKEynfd_Rz9xh81g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*_IXFqXlKEynfd_Rz9xh81g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*_IXFqXlKEynfd_Rz9xh81g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="155" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*_IXFqXlKEynfd_Rz9xh81g.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph="">getPathFromDylibID</figcaption></figure><p id="8270" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">If a library has been compiled for several architectures, then <code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/macos/loader.h#L276" rel="noopener ugc nofollow" target="_blank">LC_ID_DYLIB</a></code> is present multiple times:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk zt"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ObVtY9jt5S5AMpp6cDtRGQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ObVtY9jt5S5AMpp6cDtRGQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ObVtY9jt5S5AMpp6cDtRGQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ObVtY9jt5S5AMpp6cDtRGQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ObVtY9jt5S5AMpp6cDtRGQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ObVtY9jt5S5AMpp6cDtRGQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ObVtY9jt5S5AMpp6cDtRGQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*ObVtY9jt5S5AMpp6cDtRGQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ObVtY9jt5S5AMpp6cDtRGQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ObVtY9jt5S5AMpp6cDtRGQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ObVtY9jt5S5AMpp6cDtRGQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ObVtY9jt5S5AMpp6cDtRGQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ObVtY9jt5S5AMpp6cDtRGQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ObVtY9jt5S5AMpp6cDtRGQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="230" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*ObVtY9jt5S5AMpp6cDtRGQ.png"></picture></div></div></figure><p id="0860" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">However, if <code class="cu wa wb wc wd b">@loader_path</code> is used in <code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/macos/loader.h#L276" rel="noopener ugc nofollow" target="_blank">LC_ID_DYLIB</a></code> it does not work the same way as <code class="cu wa wb wc wd b">@executable_path</code>. The path is then relative to the dependent library instead of the executable. Consider the below graph:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk zu"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*nlOBwBNBI5rrF0a_H1I9AQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*nlOBwBNBI5rrF0a_H1I9AQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*nlOBwBNBI5rrF0a_H1I9AQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*nlOBwBNBI5rrF0a_H1I9AQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*nlOBwBNBI5rrF0a_H1I9AQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*nlOBwBNBI5rrF0a_H1I9AQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nlOBwBNBI5rrF0a_H1I9AQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*nlOBwBNBI5rrF0a_H1I9AQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*nlOBwBNBI5rrF0a_H1I9AQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*nlOBwBNBI5rrF0a_H1I9AQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*nlOBwBNBI5rrF0a_H1I9AQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*nlOBwBNBI5rrF0a_H1I9AQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*nlOBwBNBI5rrF0a_H1I9AQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*nlOBwBNBI5rrF0a_H1I9AQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="228" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*nlOBwBNBI5rrF0a_H1I9AQ.png"></picture></div></div></figure><p id="7e99" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">Using <code class="cu wa wb wc wd b">@loader_path</code>, the <code class="cu wa wb wc wd b">LC_ID_DYLIB</code> field for <code class="cu wa wb wc wd b">dependant.dylib</code> can be set to <code class="cu wa wb wc wd b">@loader_path/Customs/dependant.dylib</code>.</p><blockquote class="vb vc vd"><p id="9e3f" class="ml mm va mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">In other words, during build time, the executable or library obtains the path from the dependent library using <code class="cu wa wb wc wd b">LC_ID_DYLIB</code>.</p></blockquote><h2 id="7b45" class="vi ny ha bc nz vj vk dv od vl vm dx oh mw vn vo vp na vq vr vs ne vt vu vv vw bh" data-selectable-paragraph="">Install Name</h2><p id="3145" class="pw-post-body-paragraph ml mm ha mn b mo ov mq mr ms ow mu mv mw ox my mz na oy nc nd ne oz ng nh ni gt bh" data-selectable-paragraph=""><code class="cu wa wb wc wd b"><a class="af pa" href="https://keith.github.io/xcode-man-pages/install_name_tool.1.html" rel="noopener ugc nofollow" target="_blank">install_name_tool</a></code> is a command-line tool that can modify the dyld install names and rpaths recorded in a Mach-O binary (sources).</p><ul class=""><li id="d5b0" class="ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni zb zc zd bh" data-selectable-paragraph="">Changing the source path for Dylib (<code class="cu wa wb wc wd b">LC_ID_DYLIB</code>):</li></ul><pre class="nm nn no np nq wf wd wg bm wh ay bh"><span id="8817" class="wi ny ha wd b bd wj wk l wl wm" data-selectable-paragraph="">install_name_tool -id NEW_ID LIB_PATH</span></pre><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk zv"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*WK6xH6u5O7l68au_ZvAaLw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*WK6xH6u5O7l68au_ZvAaLw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*WK6xH6u5O7l68au_ZvAaLw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*WK6xH6u5O7l68au_ZvAaLw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*WK6xH6u5O7l68au_ZvAaLw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*WK6xH6u5O7l68au_ZvAaLw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WK6xH6u5O7l68au_ZvAaLw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*WK6xH6u5O7l68au_ZvAaLw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*WK6xH6u5O7l68au_ZvAaLw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*WK6xH6u5O7l68au_ZvAaLw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*WK6xH6u5O7l68au_ZvAaLw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*WK6xH6u5O7l68au_ZvAaLw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*WK6xH6u5O7l68au_ZvAaLw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*WK6xH6u5O7l68au_ZvAaLw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="162" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*WK6xH6u5O7l68au_ZvAaLw.png"></picture></div></div></figure><ul class=""><li id="be0a" class="ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni zb zc zd bh" data-selectable-paragraph="">Changing the dylib loading command path for the executable:</li></ul><pre class="nm nn no np nq wf wd wg bm wh ay bh"><span id="7dc2" class="wi ny ha wd b bd wj wk l wl wm" data-selectable-paragraph="">install_name_tool -change 'OLD_DYLIB_PATH' 'NEW_DYLIB_PATH' 'EXECUTABLE_NAME'</span></pre><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk zw"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*9CA_Lz4IPTafn8Yq966SBQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*9CA_Lz4IPTafn8Yq966SBQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*9CA_Lz4IPTafn8Yq966SBQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*9CA_Lz4IPTafn8Yq966SBQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*9CA_Lz4IPTafn8Yq966SBQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*9CA_Lz4IPTafn8Yq966SBQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9CA_Lz4IPTafn8Yq966SBQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*9CA_Lz4IPTafn8Yq966SBQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*9CA_Lz4IPTafn8Yq966SBQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*9CA_Lz4IPTafn8Yq966SBQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*9CA_Lz4IPTafn8Yq966SBQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*9CA_Lz4IPTafn8Yq966SBQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*9CA_Lz4IPTafn8Yq966SBQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*9CA_Lz4IPTafn8Yq966SBQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="385" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*9CA_Lz4IPTafn8Yq966SBQ.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph="">An example process for manually repairing the loading path of an executable binary</figcaption></figure><blockquote class="vb vc vd"><p id="083f" class="ml mm va mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph=""><code class="cu wa wb wc wd b">install_name_tool</code> is a part of Xcode Command Line Tools that you can install using: <code class="cu wa wb wc wd b">xcode-select --install</code>.</p></blockquote><h2 id="3add" class="vi ny ha bc nz vj vk dv od vl vm dx oh mw vn vo vp na vq vr vs ne vt vu vv vw bh" data-selectable-paragraph="">Versioning</h2><p id="0619" class="pw-post-body-paragraph ml mm ha mn b mo ov mq mr ms ow mu mv mw ox my mz na oy nc nd ne oz ng nh ni gt bh" data-selectable-paragraph="">Mach-O shared libraries support versioning to manage interface changes and maintain backward compatibility. Version number parts form a 32-bit number (<code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/macos/loader.h#L673C9-L673C9" rel="noopener ugc nofollow" target="_blank">uint32_t current_version</a></code>) of the form <code class="cu wa wb wc wd b">AAAA.BB.CC</code>:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk zx"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*JIqPY9eFsOlvtw2D3A_Gag.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*JIqPY9eFsOlvtw2D3A_Gag.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*JIqPY9eFsOlvtw2D3A_Gag.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*JIqPY9eFsOlvtw2D3A_Gag.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*JIqPY9eFsOlvtw2D3A_Gag.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*JIqPY9eFsOlvtw2D3A_Gag.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JIqPY9eFsOlvtw2D3A_Gag.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*JIqPY9eFsOlvtw2D3A_Gag.png 640w, https://miro.medium.com/v2/resize:fit:720/1*JIqPY9eFsOlvtw2D3A_Gag.png 720w, https://miro.medium.com/v2/resize:fit:750/1*JIqPY9eFsOlvtw2D3A_Gag.png 750w, https://miro.medium.com/v2/resize:fit:786/1*JIqPY9eFsOlvtw2D3A_Gag.png 786w, https://miro.medium.com/v2/resize:fit:828/1*JIqPY9eFsOlvtw2D3A_Gag.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*JIqPY9eFsOlvtw2D3A_Gag.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*JIqPY9eFsOlvtw2D3A_Gag.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="216" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*JIqPY9eFsOlvtw2D3A_Gag.png"></picture></div></div></figure><p id="c205" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">On a single machine, it is possible to maintain different versions of the libraries using <a class="af pa" href="https://developer.apple.com/documentation/system/filedescriptor/openoptions/symlink" rel="noopener ugc nofollow" target="_blank">symlinks</a>. When the newest version, say <code class="cu wa wb wc wd b">2.3.2</code> is installed, the symlink <code class="cu wa wb wc wd b">custom.2.dylib</code> automatically updates to the latest version</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk zy"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*EyKdDAJ7n6-nRHUvb-tWug.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*EyKdDAJ7n6-nRHUvb-tWug.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*EyKdDAJ7n6-nRHUvb-tWug.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*EyKdDAJ7n6-nRHUvb-tWug.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*EyKdDAJ7n6-nRHUvb-tWug.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*EyKdDAJ7n6-nRHUvb-tWug.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EyKdDAJ7n6-nRHUvb-tWug.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*EyKdDAJ7n6-nRHUvb-tWug.png 640w, https://miro.medium.com/v2/resize:fit:720/1*EyKdDAJ7n6-nRHUvb-tWug.png 720w, https://miro.medium.com/v2/resize:fit:750/1*EyKdDAJ7n6-nRHUvb-tWug.png 750w, https://miro.medium.com/v2/resize:fit:786/1*EyKdDAJ7n6-nRHUvb-tWug.png 786w, https://miro.medium.com/v2/resize:fit:828/1*EyKdDAJ7n6-nRHUvb-tWug.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*EyKdDAJ7n6-nRHUvb-tWug.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*EyKdDAJ7n6-nRHUvb-tWug.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="131" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*EyKdDAJ7n6-nRHUvb-tWug.png"></picture></div></div></figure><p id="4b3d" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">As a result, all applications using that symlink are automatically pointed to the new version of the library.</p><blockquote class="vb vc vd"><p id="a30e" class="ml mm va mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">Versioning helps prevent application failures when libraries are updated.</p></blockquote><h2 id="8ca6" class="vi ny ha bc nz vj vk dv od vl vm dx oh mw vn vo vp na vq vr vs ne vt vu vv vw bh" data-selectable-paragraph="">Compatibility</h2><p id="ff94" class="pw-post-body-paragraph ml mm ha mn b mo ov mq mr ms ow mu mv mw ox my mz na oy nc nd ne oz ng nh ni gt bh" data-selectable-paragraph="">The <a class="af pa" href="https://developer.apple.com/documentation/kernel/dylib/1525832-compatibility_version" rel="noopener ugc nofollow" target="_blank">compatibility version</a> is a metadata field that indicates the library’s minimum version required by a program that links to it.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk zz"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*EhJI-xNHoK5utKhQB1s8pw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*EhJI-xNHoK5utKhQB1s8pw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*EhJI-xNHoK5utKhQB1s8pw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*EhJI-xNHoK5utKhQB1s8pw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*EhJI-xNHoK5utKhQB1s8pw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*EhJI-xNHoK5utKhQB1s8pw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EhJI-xNHoK5utKhQB1s8pw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*EhJI-xNHoK5utKhQB1s8pw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*EhJI-xNHoK5utKhQB1s8pw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*EhJI-xNHoK5utKhQB1s8pw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*EhJI-xNHoK5utKhQB1s8pw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*EhJI-xNHoK5utKhQB1s8pw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*EhJI-xNHoK5utKhQB1s8pw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*EhJI-xNHoK5utKhQB1s8pw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="100" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*EhJI-xNHoK5utKhQB1s8pw.png"></picture></div></div></figure><p id="0864" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">Libraries without a specified compatibility version number are assigned 0. Till MacOS version 12, the dynamic linker would not check these libraries.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk aba"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*0dO9k0_enkDbX1nv_bBlIw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*0dO9k0_enkDbX1nv_bBlIw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*0dO9k0_enkDbX1nv_bBlIw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*0dO9k0_enkDbX1nv_bBlIw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*0dO9k0_enkDbX1nv_bBlIw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*0dO9k0_enkDbX1nv_bBlIw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0dO9k0_enkDbX1nv_bBlIw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*0dO9k0_enkDbX1nv_bBlIw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*0dO9k0_enkDbX1nv_bBlIw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*0dO9k0_enkDbX1nv_bBlIw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*0dO9k0_enkDbX1nv_bBlIw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*0dO9k0_enkDbX1nv_bBlIw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*0dO9k0_enkDbX1nv_bBlIw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*0dO9k0_enkDbX1nv_bBlIw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="221" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*0dO9k0_enkDbX1nv_bBlIw.png"></picture></div></div></figure><p id="e59e" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">Moreover, if a compatibility version number was set, the linker would not load a library with a smaller compatibility version than the binary’s.</p></div></div><div class="nr"><div class="ab by"><div class="ln wz lo xa lp xb cc xc cd xd cf be"><figure class="nm nn no np nq nr xf xg paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk abb"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*e3LLOFDeUNQII_Wj6KgHgQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*e3LLOFDeUNQII_Wj6KgHgQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*e3LLOFDeUNQII_Wj6KgHgQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*e3LLOFDeUNQII_Wj6KgHgQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*e3LLOFDeUNQII_Wj6KgHgQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*e3LLOFDeUNQII_Wj6KgHgQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*e3LLOFDeUNQII_Wj6KgHgQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*e3LLOFDeUNQII_Wj6KgHgQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*e3LLOFDeUNQII_Wj6KgHgQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*e3LLOFDeUNQII_Wj6KgHgQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*e3LLOFDeUNQII_Wj6KgHgQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*e3LLOFDeUNQII_Wj6KgHgQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*e3LLOFDeUNQII_Wj6KgHgQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*e3LLOFDeUNQII_Wj6KgHgQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be ls nw c" width="1000" height="200" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*e3LLOFDeUNQII_Wj6KgHgQ.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph=""><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/macos/ImageLoader.cpp#L780" rel="noopener ugc nofollow" target="_blank">recursiveLoadLibraries</a></figcaption></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><p id="08f1" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">Validation depended on <code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/macos/MachOFile.cpp#L1279" rel="noopener ugc nofollow" target="_blank">enforceCompatVersion</a></code> which was checking the minimum compatible macOS version for the library:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk abc"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*wojckOTqkK42wrsBKr5vjQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*wojckOTqkK42wrsBKr5vjQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*wojckOTqkK42wrsBKr5vjQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*wojckOTqkK42wrsBKr5vjQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*wojckOTqkK42wrsBKr5vjQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*wojckOTqkK42wrsBKr5vjQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wojckOTqkK42wrsBKr5vjQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*wojckOTqkK42wrsBKr5vjQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*wojckOTqkK42wrsBKr5vjQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*wojckOTqkK42wrsBKr5vjQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*wojckOTqkK42wrsBKr5vjQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*wojckOTqkK42wrsBKr5vjQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*wojckOTqkK42wrsBKr5vjQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*wojckOTqkK42wrsBKr5vjQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="195" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*wojckOTqkK42wrsBKr5vjQ.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph=""><code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/macos/MachOFile.cpp#L1279" rel="noopener ugc nofollow" target="_blank">enforceCompatVersion</a></code></figcaption></figure><p id="1b4c" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">So to trigger the compatibility error, when compatibility in the binary was set for example to 1.0, the library had to be compiled using the below flags:</p><pre class="nm nn no np nq wf wd wg bm wh ay bh"><span id="99aa" class="wi ny ha wd b bd wj wk l wl wm" data-selectable-paragraph="">-current_version 0.9 -compatibility_version 0.9 --target=arm64-macos10.13</span></pre><p id="d1f4" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">However, since MacOS 12, compatibility validation is no longer used:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk abd"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*fUreAihRPu95EU8glf3PJw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*fUreAihRPu95EU8glf3PJw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*fUreAihRPu95EU8glf3PJw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*fUreAihRPu95EU8glf3PJw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*fUreAihRPu95EU8glf3PJw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*fUreAihRPu95EU8glf3PJw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fUreAihRPu95EU8glf3PJw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*fUreAihRPu95EU8glf3PJw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*fUreAihRPu95EU8glf3PJw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*fUreAihRPu95EU8glf3PJw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*fUreAihRPu95EU8glf3PJw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*fUreAihRPu95EU8glf3PJw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*fUreAihRPu95EU8glf3PJw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*fUreAihRPu95EU8glf3PJw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="269" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*fUreAihRPu95EU8glf3PJw.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph="">The binary is executed despite the dylib compatibility version mismatch</figcaption></figure></div></div></div><div class="ab by un uo up uq" role="separator"><span class="su bv bj ur us ps"></span><span class="su bv bj ur us ps"></span><span class="su bv bj ur us"></span></div><div class="gt gu gv gw gx"><div class="ab by"><div class="cf be fx fy fz ga"><h1 id="c38e" class="nx ny ha bc nz oa ut oc od oe uu og oh oi uv ok ol om uw oo op oq ux os ot ou bh" data-selectable-paragraph="">Dylib Hijacking</h1><p id="ad56" class="pw-post-body-paragraph ml mm ha mn b mo ov mq mr ms ow mu mv mw ox my mz na oy nc nd ne oz ng nh ni gt bh" data-selectable-paragraph="">The security issue arises when the Dylib cannot be found in a given path, and the attacker has write access there or can replace the current valid library, making applications execute arbitrary code. However, exploitation is not straightforward on macOS because of Code Signing.</p><h2 id="48a9" class="vi ny ha bc nz vj vk dv od vl vm dx oh mw vn vo vp na vq vr vs ne vt vu vv vw bh" data-selectable-paragraph="">Protections</h2><p id="b272" class="pw-post-body-paragraph ml mm ha mn b mo ov mq mr ms ow mu mv mw ox my mz na oy nc nd ne oz ng nh ni gt bh" data-selectable-paragraph="">MacOS loads libraries in a restricted manner, never searches in the folders of the <code class="cu wa wb wc wd b">$PATH</code> for libraries, and most locations are only writeable as root.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk abe"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*jmnmIQW6KCu7NlB5oZIO1A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*jmnmIQW6KCu7NlB5oZIO1A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*jmnmIQW6KCu7NlB5oZIO1A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*jmnmIQW6KCu7NlB5oZIO1A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*jmnmIQW6KCu7NlB5oZIO1A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*jmnmIQW6KCu7NlB5oZIO1A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jmnmIQW6KCu7NlB5oZIO1A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*jmnmIQW6KCu7NlB5oZIO1A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*jmnmIQW6KCu7NlB5oZIO1A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*jmnmIQW6KCu7NlB5oZIO1A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*jmnmIQW6KCu7NlB5oZIO1A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*jmnmIQW6KCu7NlB5oZIO1A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*jmnmIQW6KCu7NlB5oZIO1A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*jmnmIQW6KCu7NlB5oZIO1A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="189" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*jmnmIQW6KCu7NlB5oZIO1A.png"></picture></div></div></figure><p id="0277" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">On top of that, there are system mitigations that must be bypassed to exploit Dylib Hijacking successfully (described in the <a class="af pa" rel="noopener" href="/snake-apple-iii-checksec-ed64a4b766c1">Snake&amp;Apple III</a>):</p><ul class=""><li id="7302" class="ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni zb zc zd bh" data-selectable-paragraph=""><a class="af pa" href="https://developer.apple.com/documentation/security/hardened_runtime?language=objc" rel="noopener ugc nofollow" target="_blank"><strong class="mn hb">Hardened runtime flag</strong></a><strong class="mn hb"> — enables library validation by default.</strong></li></ul><pre class="nm nn no np nq wf wd wg bm wh ay bh"><span id="982b" class="wi ny ha wd b bd wj wk l wl wm" data-selectable-paragraph="">codesign -s IDENTITY --option=runtime BINARY_NAME</span></pre><ul class=""><li id="bca8" class="ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni zb zc zd bh" data-selectable-paragraph=""><a class="af pa" href="https://developer.apple.com/documentation/bundleresources/entitlements/com_apple_security_cs_disable-library-validation?language=objc" rel="noopener ugc nofollow" target="_blank"><strong class="mn hb">Library validation flag</strong></a><strong class="mn hb"> — libraries must be properly signed.</strong></li></ul><pre class="nm nn no np nq wf wd wg bm wh ay bh"><span id="8d60" class="wi ny ha wd b bd wj wk l wl wm" data-selectable-paragraph="">codesign -s IDENTITY --option=library BINARY_NAME</span></pre><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk abf"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*8NPqUjeENgXTUfaR3pPVZQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*8NPqUjeENgXTUfaR3pPVZQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*8NPqUjeENgXTUfaR3pPVZQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*8NPqUjeENgXTUfaR3pPVZQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*8NPqUjeENgXTUfaR3pPVZQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*8NPqUjeENgXTUfaR3pPVZQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8NPqUjeENgXTUfaR3pPVZQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*8NPqUjeENgXTUfaR3pPVZQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*8NPqUjeENgXTUfaR3pPVZQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*8NPqUjeENgXTUfaR3pPVZQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*8NPqUjeENgXTUfaR3pPVZQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*8NPqUjeENgXTUfaR3pPVZQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*8NPqUjeENgXTUfaR3pPVZQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*8NPqUjeENgXTUfaR3pPVZQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="121" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*8NPqUjeENgXTUfaR3pPVZQ.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph="">Image of error when exploiting dylib hijacking on signed binary with above restrictions</figcaption></figure><h2 id="9df5" class="vi ny ha bc nz vj vk dv od vl vm dx oh mw vn vo vp na vq vr vs ne vt vu vv vw bh" data-selectable-paragraph="">Bypasses</h2><p id="7dd3" class="pw-post-body-paragraph ml mm ha mn b mo ov mq mr ms ow mu mv mw ox my mz na oy nc nd ne oz ng nh ni gt bh" data-selectable-paragraph="">To bypass the protections mentioned above and exploit Dylib Hijacking, <strong class="mn hb">you must have write access</strong> to the target path where a Dylib is searched for. Additionally, at least <strong class="mn hb">one of the below conditions must be met</strong>:</p><ul class=""><li id="a87b" class="ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni zb zc zd bh" data-selectable-paragraph="">Binary does not have a <a class="af pa" href="https://developer.apple.com/documentation/security/hardened_runtime?language=objc" rel="noopener ugc nofollow" target="_blank">Hardened Runtime</a> or <a class="af pa" href="https://developer.apple.com/documentation/bundleresources/entitlements/com_apple_security_cs_disable-library-validation?language=objc" rel="noopener ugc nofollow" target="_blank">Library Validation</a> flag:</li></ul><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk abg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*JRJmiw4DDLUxR_QYR_uimQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*JRJmiw4DDLUxR_QYR_uimQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*JRJmiw4DDLUxR_QYR_uimQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*JRJmiw4DDLUxR_QYR_uimQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*JRJmiw4DDLUxR_QYR_uimQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*JRJmiw4DDLUxR_QYR_uimQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JRJmiw4DDLUxR_QYR_uimQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*JRJmiw4DDLUxR_QYR_uimQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*JRJmiw4DDLUxR_QYR_uimQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*JRJmiw4DDLUxR_QYR_uimQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*JRJmiw4DDLUxR_QYR_uimQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*JRJmiw4DDLUxR_QYR_uimQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*JRJmiw4DDLUxR_QYR_uimQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*JRJmiw4DDLUxR_QYR_uimQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="91" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*JRJmiw4DDLUxR_QYR_uimQ.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph="">Binaries with Hardened Runtime, Library Validation and without any protection</figcaption></figure><ul class=""><li id="8a6e" class="ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni zb zc zd bh" data-selectable-paragraph="">One of the below entitlements is used by the binary:</li></ul><pre class="nm nn no np nq wf wd wg bm wh ay bh"><span id="4fe7" class="wi ny ha wd b bd wj wk l wl wm" data-selectable-paragraph=""><a class="af pa" href="https://developer.apple.com/documentation/bundleresources/entitlements/com_apple_security_cs_disable-library-validation" rel="noopener ugc nofollow" target="_blank">com.apple.security.cs.disable-library-validation</a><br><a class="af pa" href="https://theevilbit.github.io/posts/com.apple.private.security.clear-library-validation/" rel="noopener ugc nofollow" target="_blank">com.apple.private.security.clear-library-validation</a></span></pre><ul class=""><li id="f8b5" class="ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni zb zc zd bh" data-selectable-paragraph="">You own certificate used for signing the binary:</li></ul><pre class="nm nn no np nq wf wd wg bm wh ay bh"><span id="531b" class="wi ny ha wd b bd wj wk l wl wm" data-selectable-paragraph=""># Checking if certificate used for signing TARGET_BINARY exists in the keychain<br>security find-certificate -c "$(codesign -dvv $TARGET_BINARY 2&gt;&amp;1 | grep "Authority" -m1 | cut -d "=" -f 2)"</span></pre><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk abh"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*FYV3l1yh3i-JIDWpwa08gA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*FYV3l1yh3i-JIDWpwa08gA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*FYV3l1yh3i-JIDWpwa08gA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*FYV3l1yh3i-JIDWpwa08gA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*FYV3l1yh3i-JIDWpwa08gA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*FYV3l1yh3i-JIDWpwa08gA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FYV3l1yh3i-JIDWpwa08gA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*FYV3l1yh3i-JIDWpwa08gA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*FYV3l1yh3i-JIDWpwa08gA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*FYV3l1yh3i-JIDWpwa08gA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*FYV3l1yh3i-JIDWpwa08gA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*FYV3l1yh3i-JIDWpwa08gA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*FYV3l1yh3i-JIDWpwa08gA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*FYV3l1yh3i-JIDWpwa08gA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="241" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*FYV3l1yh3i-JIDWpwa08gA.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph="">Loading a malicious library signed with the same certificate as the binary to escalate privileges via suid</figcaption></figure><h2 id="9691" class="vi ny ha bc nz vj vk dv od vl vm dx oh mw vn vo vp na vq vr vs ne vt vu vv vw bh" data-selectable-paragraph="">Impact</h2><p id="7d4b" class="pw-post-body-paragraph ml mm ha mn b mo ov mq mr ms ow mu mv mw ox my mz na oy nc nd ne oz ng nh ni gt bh" data-selectable-paragraph="">When an attacker hijacks the dylib, they can achieve three things:</p><ol class=""><li id="0477" class="ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni abi zc zd bh" data-selectable-paragraph=""><strong class="mn hb">Escalate</strong> their <strong class="mn hb">privileges</strong> <strong class="mn hb">locally</strong>, giving them access to functions that require higher privileges (<em class="va">rare cases when the app is run by root</em>).</li><li id="7480" class="ml mm ha mn b mo ze mq mr ms zf mu mv mw zg my mz na zh nc nd ne zi ng nh ni abi zc zd bh" data-selectable-paragraph=""><strong class="mn hb">Bypass</strong> <strong class="mn hb">security</strong> <strong class="mn hb">measures</strong> that may be in place, such as antivirus software or privacy (<a class="af pa" href="https://danrevah.github.io/2023/05/15/CVE-2023-26818-Bypass-TCC-with-Telegram/" rel="noopener ugc nofollow" target="_blank"><em class="va">CVE-2023–26818 — Bypass TCC with Telegram</em></a>).</li><li id="cde9" class="ml mm ha mn b mo ze mq mr ms zf mu mv mw zg my mz na zh nc nd ne zi ng nh ni abi zc zd bh" data-selectable-paragraph="">Ensure that malicious dylib is loaded every time the application runs, allowing <strong class="mn hb">persistence</strong> to be maintained<strong class="mn hb"> </strong>(<em class="va">launchd | cron</em>).</li></ol><blockquote class="vb vc vd"><p id="2df3" class="ml mm va mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">These are the known outcomes, but there may be more that I am unaware of.</p></blockquote><h2 id="370a" class="vi ny ha bc nz vj vk dv od vl vm dx oh mw vn vo vp na vq vr vs ne vt vu vv vw bh" data-selectable-paragraph="">Vulnerability detection — Direct Dylib Hijacking</h2><p id="cf08" class="pw-post-body-paragraph ml mm ha mn b mo ov mq mr ms ow mu mv mw ox my mz na oy nc nd ne oz ng nh ni gt bh" data-selectable-paragraph="">One of the directly dependant libraries can be overwritten.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk abj"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*lcaToI8pO3pMBtrZR9GwKA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*lcaToI8pO3pMBtrZR9GwKA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*lcaToI8pO3pMBtrZR9GwKA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*lcaToI8pO3pMBtrZR9GwKA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*lcaToI8pO3pMBtrZR9GwKA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*lcaToI8pO3pMBtrZR9GwKA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lcaToI8pO3pMBtrZR9GwKA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*lcaToI8pO3pMBtrZR9GwKA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*lcaToI8pO3pMBtrZR9GwKA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*lcaToI8pO3pMBtrZR9GwKA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*lcaToI8pO3pMBtrZR9GwKA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*lcaToI8pO3pMBtrZR9GwKA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*lcaToI8pO3pMBtrZR9GwKA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*lcaToI8pO3pMBtrZR9GwKA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="296" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*lcaToI8pO3pMBtrZR9GwKA.png"></picture></div></div></figure><p id="49b3" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">After considering all the information described above in this article, we can draw the following method for detecting Direct Dylib Hijacking:</p><ul class=""><li id="c839" class="ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni zb zc zd bh" data-selectable-paragraph="">Collect all dylib load commands — <code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/python/CrimsonUroboros.py#L709" rel="noopener ugc nofollow" target="_blank">getDylibLoadCommands</a></code>.</li><li id="130a" class="ml mm ha mn b mo ze mq mr ms zf mu mv mw zg my mz na zh nc nd ne zi ng nh ni zb zc zd bh" data-selectable-paragraph="">Resolve relative paths (<code class="cu wa wb wc wd b">@executable_path</code> and <code class="cu wa wb wc wd b">@loader_path</code>) for <code class="cu wa wb wc wd b">LC_RPATH</code> paths — <code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/python/CrimsonUroboros.py#L729" rel="noopener ugc nofollow" target="_blank">resolveRunPathLoadCommands</a></code>.</li><li id="0a98" class="ml mm ha mn b mo ze mq mr ms zf mu mv mw zg my mz na zh nc nd ne zi ng nh ni zb zc zd bh" data-selectable-paragraph="">Extract all absolute paths from the dylib load commands — <code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/python/CrimsonUroboros.py#L775" rel="noopener ugc nofollow" target="_blank">resolveDylibPaths</a></code>.</li><li id="5a2e" class="ml mm ha mn b mo ze mq mr ms zf mu mv mw zg my mz na zh nc nd ne zi ng nh ni zb zc zd bh" data-selectable-paragraph="">For the ones that use relative paths, prepare all possible paths by resolving <code class="cu wa wb wc wd b">@rpath</code> — <code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/python/CrimsonUroboros.py#L764" rel="noopener ugc nofollow" target="_blank">resolveRunPathPaths</a></code>.</li><li id="819a" class="ml mm ha mn b mo ze mq mr ms zf mu mv mw zg my mz na zh nc nd ne zi ng nh ni zb zc zd bh" data-selectable-paragraph="">Check if each path exists on the filesystem — <code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/python/CrimsonUroboros.py#L825" rel="noopener ugc nofollow" target="_blank">checkIfPathExists</a></code>.</li><li id="6841" class="ml mm ha mn b mo ze mq mr ms zf mu mv mw zg my mz na zh nc nd ne zi ng nh ni zb zc zd bh" data-selectable-paragraph="">In case of multiple paths (<code class="cu wa wb wc wd b">@rpath</code> being used), check sequentially until the first one is found — <code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/python/CrimsonUroboros.py#L961" rel="noopener ugc nofollow" target="_blank">getMissingPaths</a></code></li><li id="70b8" class="ml mm ha mn b mo ze mq mr ms zf mu mv mw zg my mz na zh nc nd ne zi ng nh ni zb zc zd bh" data-selectable-paragraph="">Check the write access to missing — <code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/python/CrimsonUroboros.py#L978" rel="noopener ugc nofollow" target="_blank">checkWriteAccessMissing</a></code> and existing paths—<code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/python/CrimsonUroboros.py#L1002" rel="noopener ugc nofollow" target="_blank">checkWriteAccessExisting</a></code>.</li><li id="38c9" class="ml mm ha mn b mo ze mq mr ms zf mu mv mw zg my mz na zh nc nd ne zi ng nh ni zb zc zd bh" data-selectable-paragraph="">Check the binary protections against dylib hijacking — <code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/python/CrimsonUroboros.py#L1051" rel="noopener ugc nofollow" target="_blank">checkDylibHijackingProtections</a></code>.</li></ul><blockquote class="vb vc vd"><p id="7f84" class="ml mm va mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">After these steps, we end up with a list of writeable missing and existing paths and know if the binary is protected against hijacking.</p></blockquote><h2 id="8756" class="vi ny ha bc nz vj vk dv od vl vm dx oh mw vn vo vp na vq vr vs ne vt vu vv vw bh" data-selectable-paragraph="">Vulnerability detection — Indirect Dylib Hijacking</h2><p id="98c3" class="pw-post-body-paragraph ml mm ha mn b mo ov mq mr ms ow mu mv mw ox my mz na oy nc nd ne oz ng nh ni gt bh" data-selectable-paragraph="">One of the dependent libraries in the whole dylibtree can be overwritten.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk abk"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*un49JzfueYk7YBugM3uhFA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*un49JzfueYk7YBugM3uhFA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*un49JzfueYk7YBugM3uhFA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*un49JzfueYk7YBugM3uhFA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*un49JzfueYk7YBugM3uhFA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*un49JzfueYk7YBugM3uhFA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*un49JzfueYk7YBugM3uhFA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*un49JzfueYk7YBugM3uhFA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*un49JzfueYk7YBugM3uhFA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*un49JzfueYk7YBugM3uhFA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*un49JzfueYk7YBugM3uhFA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*un49JzfueYk7YBugM3uhFA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*un49JzfueYk7YBugM3uhFA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*un49JzfueYk7YBugM3uhFA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="363" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*un49JzfueYk7YBugM3uhFA.png"></picture></div></div></figure><p id="f163" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">If the root binary is protected, it is impossible to hijack dependent binaries.</p></div></div><div class="nr"><div class="ab by"><div class="ln wz lo xa lp xb cc xc cd xd cf be"><figure class="nm nn no np nq nr xf xg paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk abl"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*sP941pjm4eb_SAdSmEIlqA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*sP941pjm4eb_SAdSmEIlqA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*sP941pjm4eb_SAdSmEIlqA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*sP941pjm4eb_SAdSmEIlqA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*sP941pjm4eb_SAdSmEIlqA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*sP941pjm4eb_SAdSmEIlqA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*sP941pjm4eb_SAdSmEIlqA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*sP941pjm4eb_SAdSmEIlqA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*sP941pjm4eb_SAdSmEIlqA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*sP941pjm4eb_SAdSmEIlqA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*sP941pjm4eb_SAdSmEIlqA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*sP941pjm4eb_SAdSmEIlqA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*sP941pjm4eb_SAdSmEIlqA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*sP941pjm4eb_SAdSmEIlqA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be ls nw c" width="1000" height="331" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*sP941pjm4eb_SAdSmEIlqA.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph="">In this example, lib2.dylib was a rogue replaced library</figcaption></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><p id="6373" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph=""><em class="va">Still, recursive checking should be performed on all libraries in dylibtree that are not part of the Dyld Shared Cache because other non-protected binaries could use the same dependencies. This is why we should:</em></p><ul class=""><li id="0c38" class="ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni zb zc zd bh" data-selectable-paragraph="">Repeat steps for Direct Hijacking for each existing path recursively — <code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/python/CrimsonUroboros.py#L1068" rel="noopener ugc nofollow" target="_blank">dylibHijackingScanner</a></code>.</li></ul><p id="6c81" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">Below, you can see the final output from the Dylib Hijacking Scanner for protected <code class="cu wa wb wc wd b">Safari</code> and not protected custom <code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/custom/main.c" rel="noopener ugc nofollow" target="_blank">executable</a></code>:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div class="ab ck by uz"><picture><source srcset="https://miro.medium.com/v2/format:webp/1*zCjkhiJlKr76vBo66KmBGg.png 640w, https://miro.medium.com/v2/format:webp/1*zCjkhiJlKr76vBo66KmBGg.png 720w, https://miro.medium.com/v2/format:webp/1*zCjkhiJlKr76vBo66KmBGg.png 750w, https://miro.medium.com/v2/format:webp/1*zCjkhiJlKr76vBo66KmBGg.png 786w, https://miro.medium.com/v2/format:webp/1*zCjkhiJlKr76vBo66KmBGg.png 828w, https://miro.medium.com/v2/format:webp/1*zCjkhiJlKr76vBo66KmBGg.png 1100w, https://miro.medium.com/v2/format:webp/1*zCjkhiJlKr76vBo66KmBGg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/1*zCjkhiJlKr76vBo66KmBGg.png 640w, https://miro.medium.com/v2/1*zCjkhiJlKr76vBo66KmBGg.png 720w, https://miro.medium.com/v2/1*zCjkhiJlKr76vBo66KmBGg.png 750w, https://miro.medium.com/v2/1*zCjkhiJlKr76vBo66KmBGg.png 786w, https://miro.medium.com/v2/1*zCjkhiJlKr76vBo66KmBGg.png 828w, https://miro.medium.com/v2/1*zCjkhiJlKr76vBo66KmBGg.png 1100w, https://miro.medium.com/v2/1*zCjkhiJlKr76vBo66KmBGg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="ls be nw c" width="700" loading="lazy" role="presentation" src="https://miro.medium.com/v2/1*zCjkhiJlKr76vBo66KmBGg.png"></picture></div></figure><blockquote class="vb vc vd"><p id="1b28" class="ml mm va mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">Check also an alternative <a class="af pa" href="https://objective-see.org/products/dhs.html" rel="noopener ugc nofollow" target="_blank">Dylib Hijack Scanner</a> from <a class="af pa" href="https://objective-see.org/" rel="noopener ugc nofollow" target="_blank">Objective-See</a>.</p></blockquote><blockquote class="xo"><p id="90be" class="xp xq ha bc xr xs xt xu xv xw xx ni dr" data-selectable-paragraph="">There is one edge case…</p></blockquote><h2 id="2fa0" class="vi ny ha bc nz vj abm dv od vl abn dx oh mw abo vo vp na abp vr vs ne abq vu vv vw bh" data-selectable-paragraph="">dlopen</h2><p id="c4cb" class="pw-post-body-paragraph ml mm ha mn b mo ov mq mr ms ow mu mv mw ox my mz na oy nc nd ne oz ng nh ni gt bh" data-selectable-paragraph="">There is a way to load library without using dylib-specific load commands and this is <code class="cu wa wb wc wd b"><a class="af pa" href="https://developer.apple.com/library/archive/documentation/System/Conceptual/ManPages_iPhoneOS/man3/dlopen.3.html" rel="noopener ugc nofollow" target="_blank">dlopen()</a></code> function which can be specified in the source code:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk abr"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*79UL9K3lthaqV5amWAWRaA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*79UL9K3lthaqV5amWAWRaA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*79UL9K3lthaqV5amWAWRaA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*79UL9K3lthaqV5amWAWRaA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*79UL9K3lthaqV5amWAWRaA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*79UL9K3lthaqV5amWAWRaA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*79UL9K3lthaqV5amWAWRaA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*79UL9K3lthaqV5amWAWRaA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*79UL9K3lthaqV5amWAWRaA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*79UL9K3lthaqV5amWAWRaA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*79UL9K3lthaqV5amWAWRaA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*79UL9K3lthaqV5amWAWRaA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*79UL9K3lthaqV5amWAWRaA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*79UL9K3lthaqV5amWAWRaA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="158" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*79UL9K3lthaqV5amWAWRaA.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph="">Subordinate dylib is missing in load commands, but it is used</figcaption></figure><p id="50b1" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">If <code class="cu wa wb wc wd b">dlopen()</code> is nested in some function, the library will only be loaded if the function is triggered. To identify this scenario, we can use the following:</p><ul class=""><li id="b8c7" class="ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni zb zc zd bh" data-selectable-paragraph="">Trace <code class="cu wa wb wc wd b">dlopen()</code> call while using the app with<code class="cu wa wb wc wd b"> DYLD_PRINT_APIS</code>:</li></ul><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk abs"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*h7iOO8iFBCPZSYJ6E0f9hw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*h7iOO8iFBCPZSYJ6E0f9hw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*h7iOO8iFBCPZSYJ6E0f9hw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*h7iOO8iFBCPZSYJ6E0f9hw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*h7iOO8iFBCPZSYJ6E0f9hw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*h7iOO8iFBCPZSYJ6E0f9hw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h7iOO8iFBCPZSYJ6E0f9hw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*h7iOO8iFBCPZSYJ6E0f9hw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*h7iOO8iFBCPZSYJ6E0f9hw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*h7iOO8iFBCPZSYJ6E0f9hw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*h7iOO8iFBCPZSYJ6E0f9hw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*h7iOO8iFBCPZSYJ6E0f9hw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*h7iOO8iFBCPZSYJ6E0f9hw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*h7iOO8iFBCPZSYJ6E0f9hw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="248" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*h7iOO8iFBCPZSYJ6E0f9hw.png"></picture></div></div></figure><pre class="nm nn no np nq wf wd wg bm wh ay bh"><span id="7ab3" class="wi ny ha wd b bd wj wk l wl wm" data-selectable-paragraph="">DYLD_PRINT_APIS=1 ./use_dylib_dlopen</span></pre><ul class=""><li id="bbff" class="ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni zb zc zd bh" data-selectable-paragraph="">Trace all library loads using <code class="cu wa wb wc wd b">DYLD_PRINT_LIBRARIES</code>:</li></ul><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk abt"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*8KLc7eOmqpPnt0uprfc1ug.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*8KLc7eOmqpPnt0uprfc1ug.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*8KLc7eOmqpPnt0uprfc1ug.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*8KLc7eOmqpPnt0uprfc1ug.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*8KLc7eOmqpPnt0uprfc1ug.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*8KLc7eOmqpPnt0uprfc1ug.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8KLc7eOmqpPnt0uprfc1ug.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*8KLc7eOmqpPnt0uprfc1ug.png 640w, https://miro.medium.com/v2/resize:fit:720/1*8KLc7eOmqpPnt0uprfc1ug.png 720w, https://miro.medium.com/v2/resize:fit:750/1*8KLc7eOmqpPnt0uprfc1ug.png 750w, https://miro.medium.com/v2/resize:fit:786/1*8KLc7eOmqpPnt0uprfc1ug.png 786w, https://miro.medium.com/v2/resize:fit:828/1*8KLc7eOmqpPnt0uprfc1ug.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*8KLc7eOmqpPnt0uprfc1ug.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*8KLc7eOmqpPnt0uprfc1ug.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="98" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*8KLc7eOmqpPnt0uprfc1ug.png"></picture></div></div></figure><pre class="nm nn no np nq wf wd wg bm wh ay bh"><span id="bdfb" class="wi ny ha wd b bd wj wk l wl wm" data-selectable-paragraph="">DYLD_PRINT_LIBRARIES=1 DYLD_PRINT_RPATHS=1 ./use_dylib_dlopen</span></pre><ul class=""><li id="475d" class="ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni zb zc zd bh" data-selectable-paragraph=""><a class="af pa" href="https://developer.apple.com/documentation/security/disabling_and_enabling_system_integrity_protection" rel="noopener ugc nofollow" target="_blank">Turn off the SIP</a> and use <code class="cu wa wb wc wd b">dtruss</code>:</li></ul><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk abu"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*DharM-23OB_W-fWCctphKw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*DharM-23OB_W-fWCctphKw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*DharM-23OB_W-fWCctphKw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*DharM-23OB_W-fWCctphKw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*DharM-23OB_W-fWCctphKw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*DharM-23OB_W-fWCctphKw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DharM-23OB_W-fWCctphKw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*DharM-23OB_W-fWCctphKw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*DharM-23OB_W-fWCctphKw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*DharM-23OB_W-fWCctphKw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*DharM-23OB_W-fWCctphKw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*DharM-23OB_W-fWCctphKw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*DharM-23OB_W-fWCctphKw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*DharM-23OB_W-fWCctphKw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="306" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*DharM-23OB_W-fWCctphKw.png"></picture></div></div></figure><pre class="nm nn no np nq wf wd wg bm wh ay bh"><span id="d82f" class="wi ny ha wd b bd wj wk l wl wm" data-selectable-paragraph="">sudo dtruss -t open ./use_dylib_dlopen</span></pre><ul class=""><li id="12b4" class="ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni zb zc zd bh" data-selectable-paragraph="">Trace filesystem errors using <code class="cu wa wb wc wd b">fs_usage</code>:</li></ul><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk abv"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*zzdzWumDBCnF9wIMWPpDEg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*zzdzWumDBCnF9wIMWPpDEg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*zzdzWumDBCnF9wIMWPpDEg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*zzdzWumDBCnF9wIMWPpDEg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*zzdzWumDBCnF9wIMWPpDEg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*zzdzWumDBCnF9wIMWPpDEg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zzdzWumDBCnF9wIMWPpDEg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*zzdzWumDBCnF9wIMWPpDEg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*zzdzWumDBCnF9wIMWPpDEg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*zzdzWumDBCnF9wIMWPpDEg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*zzdzWumDBCnF9wIMWPpDEg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*zzdzWumDBCnF9wIMWPpDEg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*zzdzWumDBCnF9wIMWPpDEg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*zzdzWumDBCnF9wIMWPpDEg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="60" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*zzdzWumDBCnF9wIMWPpDEg.png"></picture></div></div></figure><pre class="nm nn no np nq wf wd wg bm wh ay bh"><span id="b02f" class="wi ny ha wd b bd wj wk l wl wm" data-selectable-paragraph="">sudo fs_usage | grep use_dylib_dlopen</span></pre><ul class=""><li id="912b" class="ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni zb zc zd bh" data-selectable-paragraph="">Reverse engineer the app and find all <code class="cu wa wb wc wd b">dlopen()</code> calls.</li></ul><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk abw"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*9eqtc5Ul8kV4ySSdmo3GjA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*9eqtc5Ul8kV4ySSdmo3GjA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*9eqtc5Ul8kV4ySSdmo3GjA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*9eqtc5Ul8kV4ySSdmo3GjA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*9eqtc5Ul8kV4ySSdmo3GjA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*9eqtc5Ul8kV4ySSdmo3GjA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9eqtc5Ul8kV4ySSdmo3GjA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*9eqtc5Ul8kV4ySSdmo3GjA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*9eqtc5Ul8kV4ySSdmo3GjA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*9eqtc5Ul8kV4ySSdmo3GjA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*9eqtc5Ul8kV4ySSdmo3GjA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*9eqtc5Ul8kV4ySSdmo3GjA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*9eqtc5Ul8kV4ySSdmo3GjA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*9eqtc5Ul8kV4ySSdmo3GjA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="350" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*9eqtc5Ul8kV4ySSdmo3GjA.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph="">Export as C using Ghidra -&gt; FIle -&gt; Export Program</figcaption></figure><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk abx"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*0ymHUtYLxmWrWSiklz6MbA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*0ymHUtYLxmWrWSiklz6MbA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*0ymHUtYLxmWrWSiklz6MbA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*0ymHUtYLxmWrWSiklz6MbA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*0ymHUtYLxmWrWSiklz6MbA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*0ymHUtYLxmWrWSiklz6MbA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0ymHUtYLxmWrWSiklz6MbA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*0ymHUtYLxmWrWSiklz6MbA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*0ymHUtYLxmWrWSiklz6MbA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*0ymHUtYLxmWrWSiklz6MbA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*0ymHUtYLxmWrWSiklz6MbA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*0ymHUtYLxmWrWSiklz6MbA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*0ymHUtYLxmWrWSiklz6MbA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*0ymHUtYLxmWrWSiklz6MbA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="142" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*0ymHUtYLxmWrWSiklz6MbA.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph="">Using exported reversed code grep for dlopen calls</figcaption></figure><p id="3136" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">If a library is loaded via <code class="cu wa wb wc wd b"><em class="va">dlopen</em></code> without specifying its full path, it becomes vulnerable to hijacking when it is missing:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk aby"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*eIg5IlqBnphHro1kCNrYSQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*eIg5IlqBnphHro1kCNrYSQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*eIg5IlqBnphHro1kCNrYSQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*eIg5IlqBnphHro1kCNrYSQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*eIg5IlqBnphHro1kCNrYSQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*eIg5IlqBnphHro1kCNrYSQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eIg5IlqBnphHro1kCNrYSQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*eIg5IlqBnphHro1kCNrYSQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*eIg5IlqBnphHro1kCNrYSQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*eIg5IlqBnphHro1kCNrYSQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*eIg5IlqBnphHro1kCNrYSQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*eIg5IlqBnphHro1kCNrYSQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*eIg5IlqBnphHro1kCNrYSQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*eIg5IlqBnphHro1kCNrYSQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="205" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*eIg5IlqBnphHro1kCNrYSQ.png"></picture></div></div></figure><p id="ed14" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">The application tries to find a missing dylib for <code class="cu wa wb wc wd b">dlopen</code> in the below order:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk abz"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*dpVfwUIWhyKmDZi0Yuu62Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*dpVfwUIWhyKmDZi0Yuu62Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*dpVfwUIWhyKmDZi0Yuu62Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*dpVfwUIWhyKmDZi0Yuu62Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*dpVfwUIWhyKmDZi0Yuu62Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*dpVfwUIWhyKmDZi0Yuu62Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dpVfwUIWhyKmDZi0Yuu62Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*dpVfwUIWhyKmDZi0Yuu62Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*dpVfwUIWhyKmDZi0Yuu62Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*dpVfwUIWhyKmDZi0Yuu62Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*dpVfwUIWhyKmDZi0Yuu62Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*dpVfwUIWhyKmDZi0Yuu62Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*dpVfwUIWhyKmDZi0Yuu62Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*dpVfwUIWhyKmDZi0Yuu62Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="221" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*dpVfwUIWhyKmDZi0Yuu62Q.png"></picture></div></div></figure><p id="6229" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">However, in hardened programs, the relative path is blocked from loading:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk aca"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*qtC9BQHxp969cADGAoU00A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*qtC9BQHxp969cADGAoU00A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*qtC9BQHxp969cADGAoU00A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*qtC9BQHxp969cADGAoU00A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*qtC9BQHxp969cADGAoU00A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*qtC9BQHxp969cADGAoU00A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qtC9BQHxp969cADGAoU00A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*qtC9BQHxp969cADGAoU00A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*qtC9BQHxp969cADGAoU00A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*qtC9BQHxp969cADGAoU00A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*qtC9BQHxp969cADGAoU00A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*qtC9BQHxp969cADGAoU00A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*qtC9BQHxp969cADGAoU00A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*qtC9BQHxp969cADGAoU00A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="154" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*qtC9BQHxp969cADGAoU00A.png"></picture></div></div></figure><blockquote class="vb vc vd"><p id="01f6" class="ml mm va mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">Additionally, the macOS protections described earlier must be considered.</p></blockquote><h2 id="c160" class="vi ny ha bc nz vj vk dv od vl vm dx oh mw vn vo vp na vq vr vs ne vt vu vv vw bh" data-selectable-paragraph="">Exploitation — additional requirements</h2><p id="7137" class="pw-post-body-paragraph ml mm ha mn b mo ov mq mr ms ow mu mv mw ox my mz na oy nc nd ne oz ng nh ni gt bh" data-selectable-paragraph="">Suppose you find a binary not protected against Dylib Hijacking, or you have the certificate used for signing the binary and can overwrite the subordinated library. There are still a few things to remember:</p><ul class=""><li id="635a" class="ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni zb zc zd bh" data-selectable-paragraph="">Execution fails if the dylib loaded via <code class="cu wa wb wc wd b">@rpath</code> is not found in all resolved paths. The exception is dylib loaded using <code class="cu wa wb wc wd b">LC_LOAD_WEAK_DYLIB</code>:</li></ul><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk acb"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*U3bpQ6MniKzC6x6VW8Ej9A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*U3bpQ6MniKzC6x6VW8Ej9A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*U3bpQ6MniKzC6x6VW8Ej9A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*U3bpQ6MniKzC6x6VW8Ej9A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*U3bpQ6MniKzC6x6VW8Ej9A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*U3bpQ6MniKzC6x6VW8Ej9A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U3bpQ6MniKzC6x6VW8Ej9A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*U3bpQ6MniKzC6x6VW8Ej9A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*U3bpQ6MniKzC6x6VW8Ej9A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*U3bpQ6MniKzC6x6VW8Ej9A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*U3bpQ6MniKzC6x6VW8Ej9A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*U3bpQ6MniKzC6x6VW8Ej9A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*U3bpQ6MniKzC6x6VW8Ej9A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*U3bpQ6MniKzC6x6VW8Ej9A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="123" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*U3bpQ6MniKzC6x6VW8Ej9A.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph="">All subordinated libraries must exist</figcaption></figure><ul class=""><li id="c003" class="ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni zb zc zd bh" data-selectable-paragraph="">Execution also fails if the rogue binary does not contain the function’s symbols defined in the dependent binary.</li></ul><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk acc"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*EDbptsKyCMxGUw0iXwrnfQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*EDbptsKyCMxGUw0iXwrnfQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*EDbptsKyCMxGUw0iXwrnfQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*EDbptsKyCMxGUw0iXwrnfQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*EDbptsKyCMxGUw0iXwrnfQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*EDbptsKyCMxGUw0iXwrnfQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EDbptsKyCMxGUw0iXwrnfQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*EDbptsKyCMxGUw0iXwrnfQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*EDbptsKyCMxGUw0iXwrnfQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*EDbptsKyCMxGUw0iXwrnfQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*EDbptsKyCMxGUw0iXwrnfQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*EDbptsKyCMxGUw0iXwrnfQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*EDbptsKyCMxGUw0iXwrnfQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*EDbptsKyCMxGUw0iXwrnfQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="132" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*EDbptsKyCMxGUw0iXwrnfQ.png"></picture></div></div></figure><blockquote class="vb vc vd"><p id="4bdd" class="ml mm va mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">Till MacOS 12, library version had to be compatible (no longer a requirement).</p></blockquote><h2 id="f859" class="vi ny ha bc nz vj vk dv od vl vm dx oh mw vn vo vp na vq vr vs ne vt vu vv vw bh" data-selectable-paragraph=""><strong class="al">Exploitation — ReExport (existing)</strong></h2><p id="c703" class="pw-post-body-paragraph ml mm ha mn b mo ov mq mr ms ow mu mv mw ox my mz na oy nc nd ne oz ng nh ni gt bh" data-selectable-paragraph="">The most straightforward scenario is when the subordinate dylib exists, and you have written permission over it. Then, it is enough to ReExport functions from it while compiling the rogue library with your code.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk acd"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*_FqZN_c-OMmZ8vQ6f4fL9Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*_FqZN_c-OMmZ8vQ6f4fL9Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*_FqZN_c-OMmZ8vQ6f4fL9Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*_FqZN_c-OMmZ8vQ6f4fL9Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*_FqZN_c-OMmZ8vQ6f4fL9Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*_FqZN_c-OMmZ8vQ6f4fL9Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_FqZN_c-OMmZ8vQ6f4fL9Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*_FqZN_c-OMmZ8vQ6f4fL9Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*_FqZN_c-OMmZ8vQ6f4fL9Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*_FqZN_c-OMmZ8vQ6f4fL9Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*_FqZN_c-OMmZ8vQ6f4fL9Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*_FqZN_c-OMmZ8vQ6f4fL9Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*_FqZN_c-OMmZ8vQ6f4fL9Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*_FqZN_c-OMmZ8vQ6f4fL9Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="186" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*_FqZN_c-OMmZ8vQ6f4fL9Q.png"></picture></div></div></figure><p id="292b" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">Below, you can see example directory owned by a root with unprotected <code class="cu wa wb wc wd b">executable</code> suid binary and <code class="cu wa wb wc wd b">lib2.dylib</code> available to overwrite by the user:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk ace"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*GsZ1AvAYF9k9YDSDvIOUUQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*GsZ1AvAYF9k9YDSDvIOUUQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*GsZ1AvAYF9k9YDSDvIOUUQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*GsZ1AvAYF9k9YDSDvIOUUQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*GsZ1AvAYF9k9YDSDvIOUUQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*GsZ1AvAYF9k9YDSDvIOUUQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GsZ1AvAYF9k9YDSDvIOUUQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*GsZ1AvAYF9k9YDSDvIOUUQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*GsZ1AvAYF9k9YDSDvIOUUQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*GsZ1AvAYF9k9YDSDvIOUUQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*GsZ1AvAYF9k9YDSDvIOUUQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*GsZ1AvAYF9k9YDSDvIOUUQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*GsZ1AvAYF9k9YDSDvIOUUQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*GsZ1AvAYF9k9YDSDvIOUUQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="313" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*GsZ1AvAYF9k9YDSDvIOUUQ.png"></picture></div></div></figure><p id="8675" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">Since the <code class="cu wa wb wc wd b">executable</code> is not protected, it is possible to copy the <code class="cu wa wb wc wd b">lib2.dylib</code> somewhere else. Then, compile the rogue library, reexport the functions from the copied <code class="cu wa wb wc wd b">lib2.dylib</code> and overwrite the original <code class="cu wa wb wc wd b">lib2.dylib</code>.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk acf"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ammneJzB7HiQnLGH5wklkQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ammneJzB7HiQnLGH5wklkQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ammneJzB7HiQnLGH5wklkQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ammneJzB7HiQnLGH5wklkQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ammneJzB7HiQnLGH5wklkQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ammneJzB7HiQnLGH5wklkQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ammneJzB7HiQnLGH5wklkQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*ammneJzB7HiQnLGH5wklkQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ammneJzB7HiQnLGH5wklkQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ammneJzB7HiQnLGH5wklkQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ammneJzB7HiQnLGH5wklkQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ammneJzB7HiQnLGH5wklkQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ammneJzB7HiQnLGH5wklkQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ammneJzB7HiQnLGH5wklkQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="158" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*ammneJzB7HiQnLGH5wklkQ.png"></picture></div></div></figure><p id="3e9e" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">Compiling it with a valid <code class="cu wa wb wc wd b">$PWD/lib2.dylib</code> source is impossible because the compiler, by default, first removes, then writes. In such a scenario, we must compile it somewhere else where we have write permissions, modify sources using <code class="cu wa wb wc wd b">install_name_tool</code>, and overwrite the original <code class="cu wa wb wc wd b">lib2.dylib</code></p></div></div><div class="nr"><div class="ab by"><div class="ln wz lo xa lp xb cc xc cd xd cf be"><figure class="nm nn no np nq nr xf xg paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk acg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*75V9XnTHxD8-Zc14Alzw2Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*75V9XnTHxD8-Zc14Alzw2Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*75V9XnTHxD8-Zc14Alzw2Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*75V9XnTHxD8-Zc14Alzw2Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*75V9XnTHxD8-Zc14Alzw2Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*75V9XnTHxD8-Zc14Alzw2Q.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*75V9XnTHxD8-Zc14Alzw2Q.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*75V9XnTHxD8-Zc14Alzw2Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*75V9XnTHxD8-Zc14Alzw2Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*75V9XnTHxD8-Zc14Alzw2Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*75V9XnTHxD8-Zc14Alzw2Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*75V9XnTHxD8-Zc14Alzw2Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*75V9XnTHxD8-Zc14Alzw2Q.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*75V9XnTHxD8-Zc14Alzw2Q.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be ls nw c" width="1000" height="429" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*75V9XnTHxD8-Zc14Alzw2Q.png"></picture></div></div></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><p id="6060" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">After the above steps, the exploit is ready to work:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk ach"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*bNq-7nEdrsxOyExkRJ5z4w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*bNq-7nEdrsxOyExkRJ5z4w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*bNq-7nEdrsxOyExkRJ5z4w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*bNq-7nEdrsxOyExkRJ5z4w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*bNq-7nEdrsxOyExkRJ5z4w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*bNq-7nEdrsxOyExkRJ5z4w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bNq-7nEdrsxOyExkRJ5z4w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*bNq-7nEdrsxOyExkRJ5z4w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*bNq-7nEdrsxOyExkRJ5z4w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*bNq-7nEdrsxOyExkRJ5z4w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*bNq-7nEdrsxOyExkRJ5z4w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*bNq-7nEdrsxOyExkRJ5z4w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*bNq-7nEdrsxOyExkRJ5z4w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*bNq-7nEdrsxOyExkRJ5z4w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="271" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*bNq-7nEdrsxOyExkRJ5z4w.png"></picture></div></div></figure><blockquote class="vb vc vd"><p id="acc0" class="ml mm va mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">To summarize, we must consider the source path of the dylib we want to hijack — if we copy it somewhere else, we must modify its <code class="cu wa wb wc wd b">dylib_id</code> accordingly for the -<code class="cu wa wb wc wd b">reexport_library</code> work. The same rule applies to rogue binary; we must change its <code class="cu wa wb wc wd b">dylib_id</code> to where we copy it — or where it is specified it in the executable.</p></blockquote><h2 id="b841" class="vi ny ha bc nz vj vk dv od vl vm dx oh mw vn vo vp na vq vr vs ne vt vu vv vw bh" data-selectable-paragraph="">Exploitation — Recovery (missing)</h2><p id="8eec" class="pw-post-body-paragraph ml mm ha mn b mo ov mq mr ms ow mu mv mw ox my mz na oy nc nd ne oz ng nh ni gt bh" data-selectable-paragraph="">A slightly tricker scenario is when the subordinate dylib is missing, but we have write permission to the directory. There is no way to ReExport library symbols. The only way is to recreate defined functions in the rogue library.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk wn"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*LBvZHWue4JC-HxxuDr4ffA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*LBvZHWue4JC-HxxuDr4ffA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*LBvZHWue4JC-HxxuDr4ffA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*LBvZHWue4JC-HxxuDr4ffA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*LBvZHWue4JC-HxxuDr4ffA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*LBvZHWue4JC-HxxuDr4ffA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LBvZHWue4JC-HxxuDr4ffA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*LBvZHWue4JC-HxxuDr4ffA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*LBvZHWue4JC-HxxuDr4ffA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*LBvZHWue4JC-HxxuDr4ffA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*LBvZHWue4JC-HxxuDr4ffA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*LBvZHWue4JC-HxxuDr4ffA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*LBvZHWue4JC-HxxuDr4ffA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*LBvZHWue4JC-HxxuDr4ffA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="190" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*LBvZHWue4JC-HxxuDr4ffA.png"></picture></div></div></figure><p id="66ab" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">Below, you can see an example directory owned by a user with unprotected <code class="cu wa wb wc wd b">executable</code> suid binary and one subordinated library missing <code class="cu wa wb wc wd b">lib2.dylib</code>:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk aci"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*bdeOspf2DgQXqoOC47rITw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*bdeOspf2DgQXqoOC47rITw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*bdeOspf2DgQXqoOC47rITw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*bdeOspf2DgQXqoOC47rITw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*bdeOspf2DgQXqoOC47rITw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*bdeOspf2DgQXqoOC47rITw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bdeOspf2DgQXqoOC47rITw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*bdeOspf2DgQXqoOC47rITw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*bdeOspf2DgQXqoOC47rITw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*bdeOspf2DgQXqoOC47rITw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*bdeOspf2DgQXqoOC47rITw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*bdeOspf2DgQXqoOC47rITw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*bdeOspf2DgQXqoOC47rITw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*bdeOspf2DgQXqoOC47rITw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="261" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*bdeOspf2DgQXqoOC47rITw.png"></picture></div></div></figure><p id="a45e" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">If we try just to compile our previous rogue binary and place it here, we will end up with the below error message about the missing symbol:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk acj"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*0LGzFjTtskdiwe5_xh_C2A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*0LGzFjTtskdiwe5_xh_C2A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*0LGzFjTtskdiwe5_xh_C2A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*0LGzFjTtskdiwe5_xh_C2A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*0LGzFjTtskdiwe5_xh_C2A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*0LGzFjTtskdiwe5_xh_C2A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0LGzFjTtskdiwe5_xh_C2A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*0LGzFjTtskdiwe5_xh_C2A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*0LGzFjTtskdiwe5_xh_C2A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*0LGzFjTtskdiwe5_xh_C2A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*0LGzFjTtskdiwe5_xh_C2A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*0LGzFjTtskdiwe5_xh_C2A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*0LGzFjTtskdiwe5_xh_C2A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*0LGzFjTtskdiwe5_xh_C2A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="115" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*0LGzFjTtskdiwe5_xh_C2A.png"></picture></div></div></figure><p id="3452" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">The <code class="cu wa wb wc wd b">_callLib2Function</code> symbol shown above in the error message is just a stub, not the actual function name. You can inspect it in <a class="af pa" href="https://www.hopperapp.com/index.html" rel="noopener ugc nofollow" target="_blank">Hopper</a>:</p></div></div><div class="nr"><div class="ab by"><div class="ln wz lo xa lp xb cc xc cd xd cf be"><figure class="nm nn no np nq nr xf xg paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk ack"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*7eYFLHE3vn6Oy1EJ_LemWw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*7eYFLHE3vn6Oy1EJ_LemWw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*7eYFLHE3vn6Oy1EJ_LemWw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*7eYFLHE3vn6Oy1EJ_LemWw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*7eYFLHE3vn6Oy1EJ_LemWw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*7eYFLHE3vn6Oy1EJ_LemWw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*7eYFLHE3vn6Oy1EJ_LemWw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*7eYFLHE3vn6Oy1EJ_LemWw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*7eYFLHE3vn6Oy1EJ_LemWw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*7eYFLHE3vn6Oy1EJ_LemWw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*7eYFLHE3vn6Oy1EJ_LemWw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*7eYFLHE3vn6Oy1EJ_LemWw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*7eYFLHE3vn6Oy1EJ_LemWw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*7eYFLHE3vn6Oy1EJ_LemWw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"><img alt="" class="be ls nw c" width="1000" height="268" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:1250/1*7eYFLHE3vn6Oy1EJ_LemWw.png"></picture></div></div></figure></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><p id="ca68" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">Fortunately, there are no complex cases where symbols are stripped, which could make recreating the code in our rogue library tough. These symbols cannot be removed because they are not directly used in the code but are <em class="va">referenced indirectly</em>. See the below error message from the strip attempt:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk acl"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*F45n_A9cOCpRqet5ZjYzug.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*F45n_A9cOCpRqet5ZjYzug.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*F45n_A9cOCpRqet5ZjYzug.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*F45n_A9cOCpRqet5ZjYzug.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*F45n_A9cOCpRqet5ZjYzug.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*F45n_A9cOCpRqet5ZjYzug.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F45n_A9cOCpRqet5ZjYzug.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*F45n_A9cOCpRqet5ZjYzug.png 640w, https://miro.medium.com/v2/resize:fit:720/1*F45n_A9cOCpRqet5ZjYzug.png 720w, https://miro.medium.com/v2/resize:fit:750/1*F45n_A9cOCpRqet5ZjYzug.png 750w, https://miro.medium.com/v2/resize:fit:786/1*F45n_A9cOCpRqet5ZjYzug.png 786w, https://miro.medium.com/v2/resize:fit:828/1*F45n_A9cOCpRqet5ZjYzug.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*F45n_A9cOCpRqet5ZjYzug.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*F45n_A9cOCpRqet5ZjYzug.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="176" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*F45n_A9cOCpRqet5ZjYzug.png"></picture></div></div></figure><p id="2fc0" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">You can list all <strong class="mn hb">undefined external symbols</strong> using <code class="cu wa wb wc wd b">nm -m</code> or check the chained imports using <code class="cu wa wb wc wd b">CrimsonUroboros <a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/python/CrimsonUroboros.py#L1192" rel="noopener ugc nofollow" target="_blank">--chained_fixups</a></code>:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk acm"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*SjLiNW9HJrSr7hoBaDPtYw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*SjLiNW9HJrSr7hoBaDPtYw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*SjLiNW9HJrSr7hoBaDPtYw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*SjLiNW9HJrSr7hoBaDPtYw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*SjLiNW9HJrSr7hoBaDPtYw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*SjLiNW9HJrSr7hoBaDPtYw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SjLiNW9HJrSr7hoBaDPtYw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*SjLiNW9HJrSr7hoBaDPtYw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*SjLiNW9HJrSr7hoBaDPtYw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*SjLiNW9HJrSr7hoBaDPtYw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*SjLiNW9HJrSr7hoBaDPtYw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*SjLiNW9HJrSr7hoBaDPtYw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*SjLiNW9HJrSr7hoBaDPtYw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*SjLiNW9HJrSr7hoBaDPtYw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="294" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*SjLiNW9HJrSr7hoBaDPtYw.png"></picture></div></div></figure><p id="309b" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph=""><em class="va">If you want to learn more about symbol types, check my first article:</em></p><div class="yd ye yf yg yh yi"><a rel="noopener follow" target="_blank" href="/snake-apple-i-mach-o-a8eda4b87263?source=post_page-----2c955439b94e--------------------------------"><div class="yj ab iz"><div class="yk ab cl by yl ym"><h2 class="bc hb iq z yn yo yp yq yr ys yt gz bh">Snake&amp;Apple I — Mach-O</h2></div><div class="yu l"><div class="yv l yw yx yy yu yz ls yi"></div></div></div></a></div><p id="bee8" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">So, to make our rogue library work, we just need to remove <code class="cu wa wb wc wd b">_</code> from the symbol stub name, and we end up with <code class="cu wa wb wc wd b">callLib2Function</code> name:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk acn"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*uddX3vn0wZ74GSOYXeu0cQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*uddX3vn0wZ74GSOYXeu0cQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*uddX3vn0wZ74GSOYXeu0cQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*uddX3vn0wZ74GSOYXeu0cQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*uddX3vn0wZ74GSOYXeu0cQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*uddX3vn0wZ74GSOYXeu0cQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uddX3vn0wZ74GSOYXeu0cQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*uddX3vn0wZ74GSOYXeu0cQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*uddX3vn0wZ74GSOYXeu0cQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*uddX3vn0wZ74GSOYXeu0cQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*uddX3vn0wZ74GSOYXeu0cQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*uddX3vn0wZ74GSOYXeu0cQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*uddX3vn0wZ74GSOYXeu0cQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*uddX3vn0wZ74GSOYXeu0cQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="514" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*uddX3vn0wZ74GSOYXeu0cQ.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph=""><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/custom/m.c" rel="noopener ugc nofollow" target="_blank">m.c</a></figcaption></figure><p id="6c7d" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">After compiling it and placing it in the location of the missing dylib, we can finally exploit the vulnerability and achieve the privilege escalation:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk aco"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*JIZ7aP8LSSlPHyskrnxk3Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*JIZ7aP8LSSlPHyskrnxk3Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*JIZ7aP8LSSlPHyskrnxk3Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*JIZ7aP8LSSlPHyskrnxk3Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*JIZ7aP8LSSlPHyskrnxk3Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*JIZ7aP8LSSlPHyskrnxk3Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JIZ7aP8LSSlPHyskrnxk3Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*JIZ7aP8LSSlPHyskrnxk3Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*JIZ7aP8LSSlPHyskrnxk3Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*JIZ7aP8LSSlPHyskrnxk3Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*JIZ7aP8LSSlPHyskrnxk3Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*JIZ7aP8LSSlPHyskrnxk3Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*JIZ7aP8LSSlPHyskrnxk3Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*JIZ7aP8LSSlPHyskrnxk3Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="226" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*JIZ7aP8LSSlPHyskrnxk3Q.png"></picture></div></div></figure><p id="f630" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">I implemented the — <code class="cu wa wb wc wd b"><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/python/CrimsonUroboros.py#L1150" rel="noopener ugc nofollow" target="_blank">prepare_dylib</a></code> option to automate these steps:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk acp"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*bdahG4BV0AHbtCccnq6gBw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*bdahG4BV0AHbtCccnq6gBw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*bdahG4BV0AHbtCccnq6gBw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*bdahG4BV0AHbtCccnq6gBw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*bdahG4BV0AHbtCccnq6gBw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*bdahG4BV0AHbtCccnq6gBw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bdahG4BV0AHbtCccnq6gBw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*bdahG4BV0AHbtCccnq6gBw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*bdahG4BV0AHbtCccnq6gBw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*bdahG4BV0AHbtCccnq6gBw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*bdahG4BV0AHbtCccnq6gBw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*bdahG4BV0AHbtCccnq6gBw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*bdahG4BV0AHbtCccnq6gBw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*bdahG4BV0AHbtCccnq6gBw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="584" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*bdahG4BV0AHbtCccnq6gBw.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph=""><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/python/CrimsonUroboros.py#L1150" rel="noopener ugc nofollow" target="_blank">prepareRogueDylib</a></figcaption></figure><blockquote class="vb vc vd"><p id="e264" class="ml mm va mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">To summarize, to load a rogue library, it must contain functions that the dependent binary or library imports.</p></blockquote><h2 id="6c05" class="vi ny ha bc nz vj vk dv od vl vm dx oh mw vn vo vp na vq vr vs ne vt vu vv vw bh" data-selectable-paragraph="">Exploitation — SUID (history/not working)</h2><p id="c714" class="pw-post-body-paragraph ml mm ha mn b mo ov mq mr ms ow mu mv mw ox my mz na oy nc nd ne oz ng nh ni gt bh" data-selectable-paragraph="">Back in the day, there was another scenario where if you had write access to a directory, you could replace the signature of an executable binary with suid, thus removing its hardening. However, this is no longer possible as the suid is removed immediately after changing the code signature:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk acq"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*JThHmMjbeU2SBf1eLNBV2w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*JThHmMjbeU2SBf1eLNBV2w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*JThHmMjbeU2SBf1eLNBV2w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*JThHmMjbeU2SBf1eLNBV2w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*JThHmMjbeU2SBf1eLNBV2w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*JThHmMjbeU2SBf1eLNBV2w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JThHmMjbeU2SBf1eLNBV2w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*JThHmMjbeU2SBf1eLNBV2w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*JThHmMjbeU2SBf1eLNBV2w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*JThHmMjbeU2SBf1eLNBV2w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*JThHmMjbeU2SBf1eLNBV2w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*JThHmMjbeU2SBf1eLNBV2w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*JThHmMjbeU2SBf1eLNBV2w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*JThHmMjbeU2SBf1eLNBV2w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="360" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*JThHmMjbeU2SBf1eLNBV2w.png"></picture></div></div></figure><p id="def9" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">The only risk I see here is if the <code class="cu wa wb wc wd b">executable</code> binary you codesigned changed ownership to root again and is re-suid without resigning.</p><p id="42df" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">However, even though it is not a security issue, this behaviour is unusual because the binary ownership is also changed from the root to the user who codesigned it. This way, you can “<em class="va">steal</em>” ownership from the root:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk acr"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*8huMzNYPs7bXyS5zZb2ObQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*8huMzNYPs7bXyS5zZb2ObQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*8huMzNYPs7bXyS5zZb2ObQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*8huMzNYPs7bXyS5zZb2ObQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*8huMzNYPs7bXyS5zZb2ObQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*8huMzNYPs7bXyS5zZb2ObQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8huMzNYPs7bXyS5zZb2ObQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*8huMzNYPs7bXyS5zZb2ObQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*8huMzNYPs7bXyS5zZb2ObQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*8huMzNYPs7bXyS5zZb2ObQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*8huMzNYPs7bXyS5zZb2ObQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*8huMzNYPs7bXyS5zZb2ObQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*8huMzNYPs7bXyS5zZb2ObQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*8huMzNYPs7bXyS5zZb2ObQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="358" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*8huMzNYPs7bXyS5zZb2ObQ.png"></picture></div></div></figure><blockquote class="vb vc vd"><p id="1629" class="ml mm va mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">This only works if you own the directory and can read the specified file.</p></blockquote></div></div></div><div class="ab by un uo up uq" role="separator"><span class="su bv bj ur us ps"></span><span class="su bv bj ur us ps"></span><span class="su bv bj ur us"></span></div><div class="gt gu gv gw gx"><div class="ab by"><div class="cf be fx fy fz ga"><h1 id="4cf1" class="nx ny ha bc nz oa ut oc od oe uu og oh oi uv ok ol om uw oo op oq ux os ot ou bh" data-selectable-paragraph="">FINAL WORDS</h1><p id="b3b9" class="pw-post-body-paragraph ml mm ha mn b mo ov mq mr ms ow mu mv mw ox my mz na oy nc nd ne oz ng nh ni gt bh" data-selectable-paragraph="">The programs from this article (<a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/blob/main/IV.%20Dylibs/python/MachODylibLoadCommandsFinder.py" rel="noopener ugc nofollow" target="_blank"><strong class="mn hb">MachODylibLoadCommandsFinder</strong></a><strong class="mn hb"> </strong>and<strong class="mn hb"> </strong><a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/tree/main?tab=readme-ov-file#crimsonuroboros" rel="noopener ugc nofollow" target="_blank"><strong class="mn hb">CrimsonUroboros</strong></a><strong class="mn hb">) </strong>can be found in the <a class="af pa" href="https://github.com/Karmaz95/Snake_Apple" rel="noopener ugc nofollow" target="_blank"><strong class="mn hb">Snake_Apple IV. Dylib</strong></a><strong class="mn hb"> </strong>repo.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt fg nu be nv"><div class="nj nk acs"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*A-C20Y2_esTNKZypWzSRDA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*A-C20Y2_esTNKZypWzSRDA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*A-C20Y2_esTNKZypWzSRDA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*A-C20Y2_esTNKZypWzSRDA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*A-C20Y2_esTNKZypWzSRDA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*A-C20Y2_esTNKZypWzSRDA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A-C20Y2_esTNKZypWzSRDA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*A-C20Y2_esTNKZypWzSRDA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*A-C20Y2_esTNKZypWzSRDA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*A-C20Y2_esTNKZypWzSRDA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*A-C20Y2_esTNKZypWzSRDA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*A-C20Y2_esTNKZypWzSRDA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*A-C20Y2_esTNKZypWzSRDA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*A-C20Y2_esTNKZypWzSRDA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be ls nw c" width="700" height="580" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*A-C20Y2_esTNKZypWzSRDA.png"></picture></div></div><figcaption class="vf fc tw nj nk vg vh bc b bd z dr" data-selectable-paragraph="">Dylibs module of the <a class="af pa" href="https://github.com/Karmaz95/Snake_Apple/tree/main?tab=readme-ov-file#crimsonuroboros" rel="noopener ugc nofollow" target="_blank">CrimsonUroboros</a></figcaption></figure><p id="3335" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">When you are checking for potential issues with dependent libraries used by your app with <strong class="mn hb">CrimsonUroboros</strong>, there are two ways to do it. One way is to use the <code class="cu wa wb wc wd b">dylibtree</code> flag, which will generate a warning for all paths that have broken symlinks, are missing from the filesystem, or have issues with path length. Another option is the <code class="cu wa wb wc wd b">dylib_hijacking</code>, which checks if your app is protected and prints all writeable and missing paths.</p><p id="a8c9" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph=""><em class="va">If you enjoyed the article, please share it. If you have any suggestions or found a bug, please let me know in the comments.</em></p><p id="b208" class="pw-post-body-paragraph ml mm ha mn b mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni gt bh" data-selectable-paragraph="">I did not intentionally describe the <code class="cu wa wb wc wd b">DYLD_INSERT_LIBRARIES</code>, as the following article will dive into Dyld, its environment variables, and protections against code injections beyond those mentioned till now.</p><blockquote class="xo"><p id="c981" class="xp xq ha bc xr xs act acu acv acw acx ni dr" data-selectable-paragraph=""><em class="acy">Sssssssssstay tuned.</em></p></blockquote></div></div></div></div></section></div></div></article><div class="ab by"><div class="cf be fx fy fz ga"></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><div class="acz ada ab jc"><div class="qw ab"><a class="tv av am ao" href="https://medium.com/tag/cybersecurity?source=post_page-----2c955439b94e---------------cybersecurity-----------------" rel="noopener follow"><div class="qe fg cu adb gc adc add bc b bd z bh ade">Cybersecurity</div></a></div><div class="qw ab"><a class="tv av am ao" href="https://medium.com/tag/apple?source=post_page-----2c955439b94e---------------apple-----------------" rel="noopener follow"><div class="qe fg cu adb gc adc add bc b bd z bh ade">Apple</div></a></div><div class="qw ab"><a class="tv av am ao" href="https://medium.com/tag/programming?source=post_page-----2c955439b94e---------------programming-----------------" rel="noopener follow"><div class="qe fg cu adb gc adc add bc b bd z bh ade">Programming</div></a></div><div class="qw ab"><a class="tv av am ao" href="https://medium.com/tag/python?source=post_page-----2c955439b94e---------------python-----------------" rel="noopener follow"><div class="qe fg cu adb gc adc add bc b bd z bh ade">Python</div></a></div><div class="qw ab"><a class="tv av am ao" href="https://medium.com/tag/information-technology?source=post_page-----2c955439b94e---------------information_technology-----------------" rel="noopener follow"><div class="qe fg cu adb gc adc add bc b bd z bh ade">Information Technology</div></a></div></div></div></div><div class="l"></div><footer class="pb pc pd pe pf pg ph pi gs ab q pj pk c"><div class="l ae"><div class="ab by"><div class="cf be fx fy fz ga"><div class="ab cm pl"><div class="ab q kl"><div class="pm l"><span class="l pn po pp e d"><div class="ab q kl km"><div class="pw-multi-vote-icon fg gq kn ko kp"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F2c955439b94e&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fsnake-apple-iv-dylibs-2c955439b94e&amp;user=Karol+Mazurek&amp;userId=3f7ab05f0f68&amp;source=-----2c955439b94e---------------------clap_footer-----------" rel="noopener follow"><div><div class="bj" aria-hidden="false" aria-describedby="9" aria-labelledby="9"><div class="kq ao kr ks kt ku am kv kw kx kp"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ky kz la lb lc ld le"><div><div class="bj" aria-hidden="false" aria-describedby="83" aria-labelledby="83"><p class="bc b ds z dr"><button class="af ag ah ai aj ak al am an ao ap aq ar as at tp ll">52<span class="l h g f pq pr"></span></button></p></div></div></div></div></span><span class="l h g f pq pr"><div class="ab q kl km"><div class="pw-multi-vote-icon fg gq kn ko kp"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F2c955439b94e&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fsnake-apple-iv-dylibs-2c955439b94e&amp;user=Karol+Mazurek&amp;userId=3f7ab05f0f68&amp;source=-----2c955439b94e---------------------clap_footer-----------" rel="noopener follow"><div><div class="bj" aria-hidden="false" aria-describedby="10" aria-labelledby="10"><div class="kq ao kr ks kt ku am kv kw kx kp"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ky kz la lb lc ld le"><div><div class="bj" aria-hidden="false" aria-describedby="85" aria-labelledby="85"><p class="bc b ds z dr"><button class="af ag ah ai aj ak al am an ao ap aq ar as at tp ll">52</button></p></div></div></div></div></span></div><div class="bn ab"><div><div class="bj" aria-hidden="false" aria-describedby="11" aria-labelledby="11"><button class="ao kq lg lh ab q fh li lj" aria-label="responses"><svg width="24" height="24" viewBox="0 0 24 24" class="hw"><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></button></div></div></div></div><div class="ab q"><div class="ps l iz"><div><div class="bj" aria-hidden="false" aria-describedby="12" aria-labelledby="12"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2c955439b94e&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fsnake-apple-iv-dylibs-2c955439b94e&amp;source=--------------------------bookmark_footer-----------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dr ll" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div><div class="ps l iz"><div class="bj" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bj" aria-hidden="false" aria-describedby="13" aria-labelledby="13"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fh ah ai aj ak al lt an ao ap eu lu lv lj lw"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.22 4.93a.42.42 0 0 1-.12.13h.01a.45.45 0 0 1-.29.08.52.52 0 0 1-.3-.13L12.5 3v7.07a.5.5 0 0 1-.5.5.5.5 0 0 1-.5-.5V3.02l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.8a.42.42 0 0 1 .07.5zm-.1.14zm.88 2h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11a2 2 0 0 1-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.14c.1.1.15.22.15.35a.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9V8.96c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1z" fill="currentColor"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="pt pu pv pw px l bu"><div class="ab by"><div class="cf be fx fy fz ga"><div class="ci ab py cm"><div class="ab ih"><a rel="noopener follow" href="/?source=post_page-----2c955439b94e--------------------------------"><div class="l pz qa bv qb il"><div class="l fg"><img alt="Karol Mazurek" class="l fa bv qc qd cu" src="https://miro.medium.com/v2/da:true/resize:fill:144:144/0*BLalJfMaz_JDj6fg" width="72" height="72" loading="lazy"><div class="im bv l qc qd fp n in fq"></div></div></div></a></div><div class="j i d"><div class="ab"><span><button class="bc b bd z el qe em eo ep eq er es et eu ev ew ex qf ey ez fa bj fb fc">Follow</button></span><div class="dq l"><div><div><div class="bj" aria-hidden="false" aria-describedby="107" aria-labelledby="107"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe71c64288bc8&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fsnake-apple-iv-dylibs-2c955439b94e&amp;newsletterV3=3f7ab05f0f68&amp;newsletterV3Id=e71c64288bc8&amp;user=Karol+Mazurek&amp;userId=3f7ab05f0f68&amp;source=-----2c955439b94e---------------------subscribe_user-----------" rel="noopener follow"><button class="bc b bd z qj am qk ql qm qn qo qp qq qr et eu ev ew ex ey ez fa bj fb fc" aria-label="Subscribe"><svg width="38" height="38" viewBox="0 0 38 38" fill="none" class="qg qh qi"><rect x="26.25" y="9.25" width="0.5" height="6.5" rx="0.25"></rect><rect x="29.75" y="12.25" width="0.5" height="6.5" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5L19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="ab ck cm"><div class="l"><div class="ab q"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/?source=post_page-----2c955439b94e--------------------------------"><h2 class="pw-author-name bc qs qt qu qv bh"><span class="gt je">Written by <!-- -->Karol Mazurek</span></h2></a></div><div class="qw ab"><div class="l iz"><span class="pw-follower-count bc b bd z bh"><a class="af ag ah ai aj ak al am an ao ap aq ar is" rel="noopener follow" href="/followers?source=post_page-----2c955439b94e--------------------------------">1.1K Followers</a></span></div></div><div class="qx l"><p class="bc b bd z bh"><span class="gt">Offensive Security Engineer</span></p></div></div><div class="h k"><div class="ab"><span><button class="bc b bd z el qe em eo ep eq er es et eu ev ew ex qf ey ez fa bj fb fc">Follow</button></span><div class="dq l"><div><div><div class="bj" aria-hidden="false" aria-describedby="108" aria-labelledby="108"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe71c64288bc8&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fsnake-apple-iv-dylibs-2c955439b94e&amp;newsletterV3=3f7ab05f0f68&amp;newsletterV3Id=e71c64288bc8&amp;user=Karol+Mazurek&amp;userId=3f7ab05f0f68&amp;source=-----2c955439b94e---------------------subscribe_user-----------" rel="noopener follow"><button class="bc b bd z qj am qk ql qm qn qo qp qq qr et eu ev ew ex ey ez fa bj fb fc" aria-label="Subscribe"><svg width="38" height="38" viewBox="0 0 38 38" fill="none" class="qg qh qi"><rect x="26.25" y="9.25" width="0.5" height="6.5" rx="0.25"></rect><rect x="29.75" y="12.25" width="0.5" height="6.5" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5L19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="qy be qz gl gm gn go gp"></div></div></div><div class="h k j"><div class="qy be qz ra"></div><div class="ab by"><div class="cf be fx fy fz ga"><div class="rb ab kl jc"><div class="rc rd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----2c955439b94e--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Help</p></a></div><div class="rc rd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----2c955439b94e--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Status</p></a></div><div class="rc rd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/about?autoplay=1&amp;source=post_page-----2c955439b94e--------------------------------" rel="noopener follow"><p class="bc b ds z dr">About</p></a></div><div class="rc rd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----2c955439b94e--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Careers</p></a></div><div class="rc rd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="mailto:pressinquiries@medium.com?source=post_page-----2c955439b94e--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Press</p></a></div><div class="rc rd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----2c955439b94e--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Blog</p></a></div><div class="rc rd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----2c955439b94e--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Privacy</p></a></div><div class="rc rd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----2c955439b94e--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Terms</p></a></div><div class="rc rd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----2c955439b94e--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Text to speech</p></a></div><div class="rc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/business?source=post_page-----2c955439b94e--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20240614-221838-3ba87a70fa"</script><script>window.__GRAPHQL_URI__ = "https://karol-mazurek.medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-2c955439b94e","user-3f7ab05f0f68"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"updatedPostPreviewsEnabled":true,"lohpExperimentEnabled":"control","prideLogoEnabled":true},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":true,"routingEntity":{"type":"USER","id":"3f7ab05f0f68","explicit":true},"viewerIsBot":false},"debug":{"requestId":"a474fee8-9837-464e-bb84-2c914f7ef022","hybridDevServices":[],"originalSpanCarrier":{"ot-tracer-spanid":"762148801234b356","ot-tracer-traceid":"072ff82d318ac1f7","ot-tracer-sampled":"true"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fkarol-mazurek.medium.com\u002Fsnake-apple-iv-dylibs-2c955439b94e","host":"karol-mazurek.medium.com","hostname":"karol-mazurek.medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20240614-221838-3ba87a70fa","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20240614-221838-3ba87a70fa","commit":"3ba87a70fa89456c9162015acb3c1797c92f4b41"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"1*OMF3fSqH8t4xBJ9-6oZDZw.png","height":106,"width":545},"postLogo":{"imageId":"1*kFrc4tBFM_tCis-2Ic87WA.png","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"isLoggedIn":false,"collectionByDomainOrSlug({\"domainOrSlug\":\"karol-mazurek.medium.com\"})":null,"postResult({\"id\":\"2c955439b94e\"})":{"__ref":"Post:2c955439b94e"}},"MastodonAccount:karmaz@infosec.exchange":{"__typename":"MastodonAccount","domain":"infosec.exchange","username":"karmaz","id":"karmaz@infosec.exchange"},"LinkedAccounts:3f7ab05f0f68":{"__typename":"LinkedAccounts","mastodon":{"__ref":"MastodonAccount:karmaz@infosec.exchange"},"id":"3f7ab05f0f68"},"UserViewerEdge:userId:3f7ab05f0f68-viewerId:lo_feab786b6e83":{"__typename":"UserViewerEdge","id":"userId:3f7ab05f0f68-viewerId:lo_feab786b6e83","isFollowing":false,"isUser":false,"isMuting":false},"NewsletterV3:e71c64288bc8":{"__typename":"NewsletterV3","id":"e71c64288bc8","type":"NEWSLETTER_TYPE_AUTHOR","slug":"3f7ab05f0f68","name":"3f7ab05f0f68","collection":null,"user":{"__ref":"User:3f7ab05f0f68"}},"User:3f7ab05f0f68":{"__typename":"User","id":"3f7ab05f0f68","name":"Karol Mazurek","username":"karol-mazurek","newsletterV3":{"__ref":"NewsletterV3:e71c64288bc8"},"linkedAccounts":{"__ref":"LinkedAccounts:3f7ab05f0f68"},"isSuspended":false,"imageId":"0*BLalJfMaz_JDj6fg","mediumMemberAt":0,"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":1142},"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"karol-mazurek.medium.com"}},"hasSubdomain":true,"bio":"Offensive Security Engineer","isPartnerProgramEnrolled":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:3f7ab05f0f68-viewerId:lo_feab786b6e83"},"viewerIsUser":false,"postSubscribeMembershipUpsellShownAt":0,"allowNotes":true,"membership":null,"twitterScreenName":""},"Paragraph:54bf48382cb0_0":{"__typename":"Paragraph","id":"54bf48382cb0_0","name":"d443","type":"H3","href":null,"layout":null,"metadata":null,"text":"Snake&Apple IV — Dylibs","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:54bf48382cb0_1":{"__typename":"Paragraph","id":"54bf48382cb0_1","name":"520c","type":"P","href":null,"layout":null,"metadata":null,"text":"Automating Dylib Hijacking detection with Python.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*HgjbPiuRBfG57HPL":{"__typename":"ImageMetadata","id":"0*HgjbPiuRBfG57HPL","originalHeight":914,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:54bf48382cb0_2":{"__typename":"Paragraph","id":"54bf48382cb0_2","name":"a1fb","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:0*HgjbPiuRBfG57HPL"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:54bf48382cb0_3":{"__typename":"Paragraph","id":"54bf48382cb0_3","name":"e45e","type":"H3","href":null,"layout":null,"metadata":null,"text":"INTRO","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:54bf48382cb0_4":{"__typename":"Paragraph","id":"54bf48382cb0_4","name":"3b7c","type":"P","href":null,"layout":null,"metadata":null,"text":"Welcome to another article in the series on macOS security internals!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:54bf48382cb0_5":{"__typename":"Paragraph","id":"54bf48382cb0_5","name":"3ea1","type":"P","href":null,"layout":null,"metadata":null,"text":"In the Snake&Apple I — Mach-O, I briefly introduced Load Commands, which provides Dynamic Loader (dyld) information on Dynamic Libraries (dylibs) without further explanation. This article will go deep into the concept of libraries and explain…","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":7,"end":29,"href":"https:\u002F\u002Fmedium.com\u002F@karol-mazurek\u002Fsnake-apple-i-mach-o-a8eda4b87263","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Tag:cybersecurity":{"__typename":"Tag","id":"cybersecurity","displayTitle":"Cybersecurity","normalizedTagSlug":"cybersecurity"},"Tag:apple":{"__typename":"Tag","id":"apple","displayTitle":"Apple","normalizedTagSlug":"apple"},"Tag:programming":{"__typename":"Tag","id":"programming","displayTitle":"Programming","normalizedTagSlug":"programming"},"Tag:python":{"__typename":"Tag","id":"python","displayTitle":"Python","normalizedTagSlug":"python"},"Tag:information-technology":{"__typename":"Tag","id":"information-technology","displayTitle":"Information Technology","normalizedTagSlug":"information-technology"},"Post:2c955439b94e":{"__typename":"Post","id":"2c955439b94e","collection":null,"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":true,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":null,"startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:54bf48382cb0_0"},{"__ref":"Paragraph:54bf48382cb0_1"},{"__ref":"Paragraph:54bf48382cb0_2"},{"__ref":"Paragraph:54bf48382cb0_3"},{"__ref":"Paragraph:54bf48382cb0_4"},{"__ref":"Paragraph:54bf48382cb0_5"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:3f7ab05f0f68"},"inResponseToEntityType":null,"isLocked":true,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_UGC","mediumUrl":"https:\u002F\u002Fkarol-mazurek.medium.com\u002Fsnake-apple-iv-dylibs-2c955439b94e","primaryTopic":null,"topics":[],"isPublished":true,"latestPublishedVersion":"54bf48382cb0","visibility":"LOCKED","postResponses":{"__typename":"PostResponses","count":0},"createdAt":1691503543168,"firstPublishedAt":1705491070817,"latestPublishedAt":1705491070817,"clapCount":52,"allowResponses":true,"isLimitedState":false,"title":"Snake&Apple IV — Dylibs","isSeries":false,"sequence":null,"uniqueSlug":"snake-apple-iv-dylibs-2c955439b94e","socialTitle":"","socialDek":"","noIndex":null,"canonicalUrl":"","metaDescription":"","readingTime":18.389622641509433,"previewContent":{"__typename":"PreviewContent","subtitle":"Automating Dylib Hijacking detection with Python."},"previewImage":{"__ref":"ImageMetadata:0*HgjbPiuRBfG57HPL"},"isShortform":false,"seoTitle":"Snake&Apple IV—Dylib Hijacking","updatedAt":1708341965487,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"The article describes the concept of libraries and how to detect Dylib Hijacking vulnerability and secure applications against it on macOS.","isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:cybersecurity"},{"__ref":"Tag:apple"},{"__ref":"Tag:programming"},{"__ref":"Tag:python"},{"__ref":"Tag:information-technology"}],"isNewsletter":false,"statusForCollection":null,"pendingCollection":null,"detectedLanguage":"en","wordCount":3482,"layerCake":0}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"MISS"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.3cc5e3b6.js"></script><script src="https://cdn-client.medium.com/lite/static/js/2640.3217006c.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.7db0aaff.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.4ddbf12e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.2021fe63.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4398.db4d4378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7883.0e445e04.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9281.e9be8bce.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7111.b294e9da.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6481.362dec70.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8695.6f58679b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8978.4b110123.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3418.eb013b5a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3894.e3d01e2c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5514.32e692f6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5203.e7f058c5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7098.93054372.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8051.0a9d3f4b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8558.abbaadfd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1711.7605eb3e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8597.762eae49.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9174.b1b0f607.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8883.2f95bbf4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/705.e5898c57.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2911.d072adec.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8580.feeb2549.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6046.f9be485b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/500.d5389c14.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9408.22b56993.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6605.84e81b15.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6637.661bd7cf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7421.3f94f5ea.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/51.d8fb2684.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2133.c8ba56b1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.81dff084.chunk.js"></script><script>window.main();</script><script defer="" src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon="{&quot;rayId&quot;:&quot;89427b3d5fdc27c0&quot;,&quot;version&quot;:&quot;2024.4.1&quot;,&quot;token&quot;:&quot;0b5f665943484354a59c39c6833f7078&quot;}" crossorigin="anonymous"></script>
<div><div class="rn n si sj qx sk sl sm sn so sp sq sr ss st ce bm su sv sw lg sx sy"><div class="bc b ds z sz"><div class="ab cm ta tb"><div class="l" role="alert">To make Medium work, we log user data. By using Medium, you agree to our <a class="af ag ah ai aj ak al am an ao ap tc td pa" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9" rel="noopener follow" target="_blank">Privacy Policy</a>, including cookie policy.</div><div class="te tf tg th ti tj l tk iz tl"><div class="l fg n tm"><button class="af ag ah ai aj ak al am an ao ap tc td tn to ab" data-testid="close-button" aria-label="close"><svg width="19" height="19" viewBox="0 0 19 19" class="em el"><path d="M13.8 4.6L9.5 8.89 5.21 4.6l-.61.61 4.29 4.3-4.29 4.28.61.62 4.3-4.3 4.28 4.3.62-.62-4.3-4.29 4.3-4.29" fill-rule="evenodd"></path></svg></button></div></div></div></div></div></div></body></html>