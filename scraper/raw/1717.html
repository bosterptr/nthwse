<html lang="en" dir="ltr" prefix="content: http://purl.org/rss/1.0/modules/content/  dc: http://purl.org/dc/terms/  foaf: http://xmlns.com/foaf/0.1/  og: http://ogp.me/ns#  rdfs: http://www.w3.org/2000/01/rdf-schema#  schema: http://schema.org/  sioc: http://rdfs.org/sioc/ns#  sioct: http://rdfs.org/sioc/types#  skos: http://www.w3.org/2004/02/skos/core#  xsd: http://www.w3.org/2001/XMLSchema# " class=" js" style="--truste-box-overlay-height: 728px; --truste-box-overlay-margin-left: auto; --truste-box-overlay-inner-height: 728px; --truste-popframe-height: 728px;"><head><style type="text/css">.truste_visibility_visible {visibility: visible;}.truste_visibility_hidden {visibility: hidden;}</style><style type="text/css">.truste_overlay {background-color: #000;opacity: 0.4;position: fixed;z-index: 1000000;width: 100%;height: 100%;top: 0px;left: 0px;overflow: hidden;filter: Alpha(Opacity: 80);}.truste_box_overlay {position: absolute;z-index:2000000;top: 0px;left: 0px;bottom: 0px;right: 0px;border-radius: 5px;padding: 10px;width: 80%;max-width: 840px; height: var(--truste-box-overlay-height);min-width: 220px;margin: 20px auto 20px var(--truste-box-overlay-margin-left);box-sizing: content-box;}.truste_box_overlay_inner {position: relative;width: 100%;height: var(--truste-box-overlay-inner-height);outline: none;0}.truste_box_overlay_border {display: block;background: #000;opacity: 0.3;width: calc(100% + 20px);height: calc(100% + 20px);position: absolute;top: -10px;left: -10px;}.truste_cm_outerdiv {width: 100%;height: 100%;overflow: scroll;position: absolute;top: 0;left: 0;z-index: 2000000;-webkit-overflow-scrolling: touch;}.truste_popframe {border: 0px;border-radius: 2px;overflow: hidden;background: #fff;display: block;position: absolute;top: 0px;left: 0px;width: 100%;height: var(--truste-popframe-height); }</style><style type="text/css">.truste_caIcon_display {display: block !important;}</style><style type="text/css">.truste_cursor_pointer {cursor: pointer;}.truste_border_none {border: none;}</style>
        <meta charset="utf-8">
<meta name="description" content="This article explores a research project seeking to avoid spawning a conhost.exe with a commercial C2 by tricking Windows into thinking it had a console.">
<link rel="canonical" href="https://www.coresecurity.com/core-labs/articles/running-pes-inline-without-console">
<meta name="robots" content="index, follow">
<meta name="Generator" content="Drupal 10 (https://www.drupal.org)">
<meta name="MobileOptimized" content="width">
<meta name="HandheldFriendly" content="true">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="x-ua-compatible" content="ie=edge"><script type="text/javascript" async="" src="https://www.googletagmanager.com/gtag/destination?id=AW-751313354&amp;l=dataLayer&amp;cx=c"></script><script type="text/javascript" async="" src="https://www.googletagmanager.com/gtag/js?id=G-NHMHGJWX49&amp;l=dataLayer&amp;cx=c"></script><script type="text/javascript" async="" src="https://www.googletagmanager.com/gtag/js?id=G-M6K485ELH5&amp;l=dataLayer&amp;cx=c"></script><script async="" src="https://www.googletagmanager.com/gtm.js?id=GTM-KQFL4VC"></script><script type="text/javascript">(window.NREUM||(NREUM={})).init={ajax:{deny_list:["bam.nr-data.net"]}};(window.NREUM||(NREUM={})).loader_config={licenseKey:"NRJS-a139b6fb0a937cc4d2b",applicationID:"555092926"};;/*! For license information please see nr-loader-rum-1.260.1.min.js.LICENSE.txt */
(()=>{var e,t,r={234:(e,t,r)=>{"use strict";r.d(t,{P_:()=>v,Mt:()=>b,C5:()=>s,OP:()=>k,lF:()=>P,Yu:()=>_,Dg:()=>m,CX:()=>c,GE:()=>w,sU:()=>N});var n=r(8632),i=r(9567);const o={beacon:n.ce.beacon,errorBeacon:n.ce.errorBeacon,licenseKey:void 0,applicationID:void 0,sa:void 0,queueTime:void 0,applicationTime:void 0,ttGuid:void 0,user:void 0,account:void 0,product:void 0,extra:void 0,jsAttributes:{},userAttributes:void 0,atts:void 0,transactionName:void 0,tNamePlain:void 0},a={};function s(e){if(!e)throw new Error("All info objects require an agent identifier!");if(!a[e])throw new Error("Info for ".concat(e," was never set"));return a[e]}function c(e,t){if(!e)throw new Error("All info objects require an agent identifier!");a[e]=(0,i.D)(t,o);const r=(0,n.ek)(e);r&&(r.info=a[e])}const u=e=>{if(!e||"string"!=typeof e)return!1;try{document.createDocumentFragment().querySelector(e)}catch{return!1}return!0};var d=r(7056),l=r(50);const f="[data-nr-mask]",g=()=>{const e={mask_selector:"*",block_selector:"[data-nr-block]",mask_input_options:{color:!1,date:!1,"datetime-local":!1,email:!1,month:!1,number:!1,range:!1,search:!1,tel:!1,text:!1,time:!1,url:!1,week:!1,textarea:!1,select:!1,password:!0}};return{feature_flags:[],proxy:{assets:void 0,beacon:void 0},privacy:{cookies_enabled:!0},ajax:{deny_list:void 0,block_internal:!0,enabled:!0,harvestTimeSeconds:10,autoStart:!0},distributed_tracing:{enabled:void 0,exclude_newrelic_header:void 0,cors_use_newrelic_header:void 0,cors_use_tracecontext_headers:void 0,allowed_origins:void 0},session:{expiresMs:d.oD,inactiveMs:d.Hb},ssl:void 0,obfuscate:void 0,jserrors:{enabled:!0,harvestTimeSeconds:10,autoStart:!0},metrics:{enabled:!0,autoStart:!0},page_action:{enabled:!0,harvestTimeSeconds:30,autoStart:!0},page_view_event:{enabled:!0,autoStart:!0},page_view_timing:{enabled:!0,harvestTimeSeconds:30,long_task:!1,autoStart:!0},session_trace:{enabled:!0,harvestTimeSeconds:10,autoStart:!0},harvest:{tooManyRequestsDelay:60},session_replay:{autoStart:!0,enabled:!1,harvestTimeSeconds:60,preload:!1,sampling_rate:10,error_sampling_rate:100,collect_fonts:!1,inline_images:!1,inline_stylesheet:!0,mask_all_inputs:!0,get mask_text_selector(){return e.mask_selector},set mask_text_selector(t){u(t)?e.mask_selector="".concat(t,",").concat(f):""===t||null===t?e.mask_selector=f:(0,l.Z)("An invalid session_replay.mask_selector was provided. '*' will be used.",t)},get block_class(){return"nr-block"},get ignore_class(){return"nr-ignore"},get mask_text_class(){return"nr-mask"},get block_selector(){return e.block_selector},set block_selector(t){u(t)?e.block_selector+=",".concat(t):""!==t&&(0,l.Z)("An invalid session_replay.block_selector was provided and will not be used",t)},get mask_input_options(){return e.mask_input_options},set mask_input_options(t){t&&"object"==typeof t?e.mask_input_options={...t,password:!0}:(0,l.Z)("An invalid session_replay.mask_input_option was provided and will not be used",t)}},spa:{enabled:!0,harvestTimeSeconds:10,autoStart:!0},soft_navigations:{enabled:!0,harvestTimeSeconds:10,autoStart:!0}}},p={},h="All configuration objects require an agent identifier!";function v(e){if(!e)throw new Error(h);if(!p[e])throw new Error("Configuration for ".concat(e," was never set"));return p[e]}function m(e,t){if(!e)throw new Error(h);p[e]=(0,i.D)(t,g());const r=(0,n.ek)(e);r&&(r.init=p[e])}function b(e,t){if(!e)throw new Error(h);var r=v(e);if(r){for(var n=t.split("."),i=0;i<n.length-1;i++)if("object"!=typeof(r=r[n[i]]))return;r=r[n[n.length-1]]}return r}const y={accountID:void 0,trustKey:void 0,agentID:void 0,licenseKey:void 0,applicationID:void 0,xpid:void 0},A={};function w(e,t){if(!e)throw new Error("All loader-config objects require an agent identifier!");A[e]=(0,i.D)(t,y);const r=(0,n.ek)(e);r&&(r.loader_config=A[e])}const _=(0,n.mF)().o;var E=r(385),x=r(6818);const D={buildEnv:x.Re,distMethod:x.gF,version:x.q4,originTime:E.sK},S={customTransaction:void 0,disabled:!1,isolatedBacklog:!1,loaderType:void 0,maxBytes:3e4,onerror:void 0,origin:""+E._A.location,ptid:void 0,releaseIds:{},appMetadata:{},session:void 0,denyList:void 0,harvestCount:0,timeKeeper:void 0},R={};function k(e){if(!e)throw new Error("All runtime objects require an agent identifier!");if(!R[e])throw new Error("Runtime for ".concat(e," was never set"));return R[e]}function N(e,t){if(!e)throw new Error("All runtime objects require an agent identifier!");R[e]={...(0,i.D)(t,S),...D};const r=(0,n.ek)(e);r&&(r.runtime=R[e])}function P(e){return function(e){try{const t=s(e);return!!t.licenseKey&&!!t.errorBeacon&&!!t.applicationID}catch(e){return!1}}(e)}},9567:(e,t,r)=>{"use strict";r.d(t,{D:()=>i});var n=r(50);function i(e,t){try{if(!e||"object"!=typeof e)return(0,n.Z)("Setting a Configurable requires an object as input");if(!t||"object"!=typeof t)return(0,n.Z)("Setting a Configurable requires a model to set its initial properties");const r=Object.create(Object.getPrototypeOf(t),Object.getOwnPropertyDescriptors(t)),o=0===Object.keys(r).length?e:r;for(let a in o)if(void 0!==e[a])try{if(null===e[a]){r[a]=null;continue}Array.isArray(e[a])&&Array.isArray(t[a])?r[a]=Array.from(new Set([...e[a],...t[a]])):"object"==typeof e[a]&&"object"==typeof t[a]?r[a]=i(e[a],t[a]):r[a]=e[a]}catch(e){(0,n.Z)("An error occurred while setting a property of a Configurable",e)}return r}catch(e){(0,n.Z)("An error occured while setting a Configurable",e)}}},6818:(e,t,r)=>{"use strict";r.d(t,{Re:()=>i,gF:()=>o,q4:()=>n});const n="1.260.1",i="PROD",o="CDN"},385:(e,t,r)=>{"use strict";r.d(t,{Nk:()=>l,Tt:()=>c,_A:()=>a,iS:()=>s,il:()=>i,sK:()=>f,ux:()=>u,v6:()=>o,w1:()=>d});var n=r(7894);const i="undefined"!=typeof window&&!!window.document,o="undefined"!=typeof WorkerGlobalScope&&("undefined"!=typeof self&&self instanceof WorkerGlobalScope&&self.navigator instanceof WorkerNavigator||"undefined"!=typeof globalThis&&globalThis instanceof WorkerGlobalScope&&globalThis.navigator instanceof WorkerNavigator),a=i?window:"undefined"!=typeof WorkerGlobalScope&&("undefined"!=typeof self&&self instanceof WorkerGlobalScope&&self||"undefined"!=typeof globalThis&&globalThis instanceof WorkerGlobalScope&&globalThis),s=Boolean("hidden"===a?.document?.visibilityState),c=/iPad|iPhone|iPod/.test(a.navigator?.userAgent),u=c&&"undefined"==typeof SharedWorker,d=((()=>{const e=a.navigator?.userAgent?.match(/Firefox[/\s](\d+\.\d+)/);Array.isArray(e)&&e.length>=2&&e[1]})(),Boolean(i&&window.document.documentMode)),l=!!a.navigator?.sendBeacon,f=Date.now()-(0,n.z)()},1117:(e,t,r)=>{"use strict";r.d(t,{w:()=>o});var n=r(50);const i={agentIdentifier:"",ee:void 0};class o{constructor(e){try{if("object"!=typeof e)return(0,n.Z)("shared context requires an object as input");this.sharedContext={},Object.assign(this.sharedContext,i),Object.entries(e).forEach((e=>{let[t,r]=e;Object.keys(i).includes(t)&&(this.sharedContext[t]=r)}))}catch(e){(0,n.Z)("An error occurred while setting SharedContext",e)}}}},8e3:(e,t,r)=>{"use strict";r.d(t,{LP:()=>l,RP:()=>c,o5:()=>u});var n=r(8325),i=r(1284),o=r(4322),a=r(3325);const s={};function c(e,t){const r={staged:!1,priority:a.p[t]||0};d(e),s[e].get(t)||s[e].set(t,r)}function u(e,t){d(e),s[e].get(t)&&s[e].delete(t),s[e].size&&f(e)}function d(e){if(!e)throw new Error("agentIdentifier required");s[e]||(s[e]=new Map)}function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"feature",r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(d(e),!e||!s[e].get(t)||r)return g(e,t);s[e].get(t).staged=!0,f(e)}function f(e){const t=Array.from(s[e]);t.every((e=>{let[t,r]=e;return r.staged}))&&(t.sort(((e,t)=>e[1].priority-t[1].priority)),t.forEach((t=>{let[r]=t;s[e].delete(r),g(e,r)})))}function g(e,t){const r=e?n.ee.get(e):n.ee,a=o.X.handlers;if(r.backlog&&a){var s=r.backlog[t],c=a[t];if(c){for(var u=0;s&&u<s.length;++u)p(s[u],c);(0,i.D)(c,(function(e,t){(0,i.D)(t,(function(t,r){r[0].on(e,r[1])}))}))}r.isolatedBacklog||delete a[t],r.backlog[t]=null,r.emit("drain-"+t,[])}}function p(e,t){var r=e[1];(0,i.D)(t[r],(function(t,r){var n=e[0];if(r[0]===n){var i=r[1],o=e[3],a=e[2];i.apply(o,a)}}))}},8325:(e,t,r)=>{"use strict";r.d(t,{A:()=>c,ee:()=>u});var n=r(8632),i=r(2210),o=r(234);class a{constructor(e){this.contextId=e}}var s=r(3117);const c="nr@context:".concat(s.a),u=function e(t,r){var n={},s={},d={},l=!1;try{l=16===r.length&&(0,o.OP)(r).isolatedBacklog}catch(e){}var f={on:p,addEventListener:p,removeEventListener:function(e,t){var r=n[e];if(!r)return;for(var i=0;i<r.length;i++)r[i]===t&&r.splice(i,1)},emit:function(e,r,n,i,o){!1!==o&&(o=!0);if(u.aborted&&!i)return;t&&o&&t.emit(e,r,n);for(var a=g(n),c=h(e),d=c.length,l=0;l<d;l++)c[l].apply(a,r);var p=m()[s[e]];p&&p.push([f,e,r,a]);return a},get:v,listeners:h,context:g,buffer:function(e,t){const r=m();if(t=t||"feature",f.aborted)return;Object.entries(e||{}).forEach((e=>{let[n,i]=e;s[i]=t,t in r||(r[t]=[])}))},abort:function(){f._aborted=!0,Object.keys(f.backlog).forEach((e=>{delete f.backlog[e]}))},isBuffering:function(e){return!!m()[s[e]]},debugId:r,backlog:l?{}:t&&"object"==typeof t.backlog?t.backlog:{},isolatedBacklog:l};return Object.defineProperty(f,"aborted",{get:()=>{let e=f._aborted||!1;return e||(t&&(e=t.aborted),e)}}),f;function g(e){return e&&e instanceof a?e:e?(0,i.X)(e,c,(()=>new a(c))):new a(c)}function p(e,t){n[e]=h(e).concat(t)}function h(e){return n[e]||[]}function v(t){return d[t]=d[t]||e(f,t)}function m(){return f.backlog}}(void 0,"globalEE"),d=(0,n.fP)();d.ee||(d.ee=u)},5546:(e,t,r)=>{"use strict";r.d(t,{E:()=>n,p:()=>i});var n=r(8325).ee.get("handle");function i(e,t,r,i,o){o?(o.buffer([e],i),o.emit(e,t,r)):(n.buffer([e],i),n.emit(e,t,r))}},4322:(e,t,r)=>{"use strict";r.d(t,{X:()=>o});var n=r(5546);o.on=a;var i=o.handlers={};function o(e,t,r,o){a(o||n.E,i,e,t,r)}function a(e,t,r,i,o){o||(o="feature"),e||(e=n.E);var a=t[o]=t[o]||{};(a[r]=a[r]||[]).push([e,i])}},3239:(e,t,r)=>{"use strict";r.d(t,{bP:()=>s,iz:()=>c,m$:()=>a});var n=r(385);let i=!1,o=!1;try{const e={get passive(){return i=!0,!1},get signal(){return o=!0,!1}};n._A.addEventListener("test",null,e),n._A.removeEventListener("test",null,e)}catch(e){}function a(e,t){return i||o?{capture:!!e,passive:i,signal:t}:!!e}function s(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0;window.addEventListener(e,t,a(r,n))}function c(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0;document.addEventListener(e,t,a(r,n))}},3117:(e,t,r)=>{"use strict";r.d(t,{a:()=>n});const n=(0,r(4402).Rl)()},4402:(e,t,r)=>{"use strict";r.d(t,{Rl:()=>a,ky:()=>s});var n=r(385);const i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";function o(e,t){return e?15&e[t]:16*Math.random()|0}function a(){const e=n._A?.crypto||n._A?.msCrypto;let t,r=0;return e&&e.getRandomValues&&(t=e.getRandomValues(new Uint8Array(30))),i.split("").map((e=>"x"===e?o(t,r++).toString(16):"y"===e?(3&o()|8).toString(16):e)).join("")}function s(e){const t=n._A?.crypto||n._A?.msCrypto;let r,i=0;t&&t.getRandomValues&&(r=t.getRandomValues(new Uint8Array(e)));const a=[];for(var s=0;s<e;s++)a.push(o(r,i++).toString(16));return a.join("")}},7056:(e,t,r)=>{"use strict";r.d(t,{Bq:()=>n,Hb:()=>a,IK:()=>u,K4:()=>i,oD:()=>o,uT:()=>c,wO:()=>s});const n="NRBA",i="SESSION",o=144e5,a=18e5,s={STARTED:"session-started",PAUSE:"session-pause",RESET:"session-reset",RESUME:"session-resume",UPDATE:"session-update"},c={SAME_TAB:"same-tab",CROSS_TAB:"cross-tab"},u={OFF:0,FULL:1,ERROR:2}},7894:(e,t,r)=>{"use strict";function n(){return Math.floor(performance.now())}r.d(t,{z:()=>n})},50:(e,t,r)=>{"use strict";function n(e,t){"function"==typeof console.warn&&(console.warn("New Relic: ".concat(e)),t&&console.warn(t))}r.d(t,{Z:()=>n})},2825:(e,t,r)=>{"use strict";r.d(t,{N:()=>c,T:()=>s});var n=r(8325),i=r(385);const o="newrelic";const a=new Set,s={};function c(e,t){const r=n.ee.get(t);s[t]??={},e&&"object"==typeof e&&(a.has(t)||(r.emit("rumresp",[e]),s[t]=e,a.add(t),function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{i._A.dispatchEvent(new CustomEvent(o,{detail:e}))}catch(e){}}({loaded:!0})))}},2210:(e,t,r)=>{"use strict";r.d(t,{X:()=>i});var n=Object.prototype.hasOwnProperty;function i(e,t,r){if(n.call(e,t))return e[t];var i=r();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,t,{value:i,writable:!0,enumerable:!1}),i}catch(e){}return e[t]=i,i}},7872:(e,t,r)=>{"use strict";function n(e){var t=this;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=n?.leading||!1;let o;return function(){for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];i&&void 0===o&&(e.apply(t,a),o=setTimeout((()=>{o=clearTimeout(o)}),r)),i||(clearTimeout(o),o=setTimeout((()=>{e.apply(t,a)}),r))}}function i(e){var t=this;let r=!1;return function(){if(!r){r=!0;for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];e.apply(t,i)}}}r.d(t,{D:()=>n,Z:()=>i})},1284:(e,t,r)=>{"use strict";r.d(t,{D:()=>n});const n=(e,t)=>Object.entries(e||{}).map((e=>{let[r,n]=e;return t(r,n)}))},4351:(e,t,r)=>{"use strict";r.d(t,{P:()=>o});var n=r(8325);const i=()=>{const e=new WeakSet;return(t,r)=>{if("object"==typeof r&&null!==r){if(e.has(r))return;e.add(r)}return r}};function o(e){try{return JSON.stringify(e,i())}catch(e){try{n.ee.emit("internal-error",[e])}catch(e){}}}},3960:(e,t,r)=>{"use strict";r.d(t,{KB:()=>a,b2:()=>o});var n=r(3239);function i(){return"undefined"==typeof document||"complete"===document.readyState}function o(e,t){if(i())return e();(0,n.bP)("load",e,t)}function a(e){if(i())return e();(0,n.iz)("DOMContentLoaded",e)}},8632:(e,t,r)=>{"use strict";r.d(t,{EZ:()=>d,ce:()=>o,ek:()=>u,fP:()=>a,gG:()=>l,h5:()=>c,mF:()=>s});var n=r(385),i=r(7894);const o={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net"};function a(){return n._A.NREUM||(n._A.NREUM={}),void 0===n._A.newrelic&&(n._A.newrelic=n._A.NREUM),n._A.NREUM}function s(){let e=a();return e.o||(e.o={ST:n._A.setTimeout,SI:n._A.setImmediate,CT:n._A.clearTimeout,XHR:n._A.XMLHttpRequest,REQ:n._A.Request,EV:n._A.Event,PR:n._A.Promise,MO:n._A.MutationObserver,FETCH:n._A.fetch}),e}function c(e,t){let r=a();r.initializedAgents??={},t.initializedAt={ms:(0,i.z)(),date:new Date},r.initializedAgents[e]=t}function u(e){let t=a();return t.initializedAgents?.[e]}function d(e,t){a()[e]=t}function l(){return function(){let e=a();const t=e.info||{};e.info={beacon:o.beacon,errorBeacon:o.errorBeacon,...t}}(),function(){let e=a();const t=e.init||{};e.init={...t}}(),s(),function(){let e=a();const t=e.loader_config||{};e.loader_config={...t}}(),a()}},7956:(e,t,r)=>{"use strict";r.d(t,{N:()=>i});var n=r(3239);function i(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;(0,n.iz)("visibilitychange",(function(){if(t)return void("hidden"===document.visibilityState&&e());e(document.visibilityState)}),r,i)}},3081:(e,t,r)=>{"use strict";r.d(t,{gF:()=>o,mY:()=>i,t9:()=>n,vz:()=>s,xS:()=>a});const n=r(3325).D.metrics,i="sm",o="cm",a="storeSupportabilityMetrics",s="storeEventMetrics"},7633:(e,t,r)=>{"use strict";r.d(t,{t:()=>n});const n=r(3325).D.pageViewEvent},9251:(e,t,r)=>{"use strict";r.d(t,{t:()=>n});const n=r(3325).D.pageViewTiming},7144:(e,t,r)=>{"use strict";r.d(t,{Ef:()=>i});var n=r(7056);r(3325).D.sessionReplay;const i={RECORD:"recordReplay",PAUSE:"pauseReplay",REPLAY_RUNNING:"replayRunning",ERROR_DURING_REPLAY:"errorDuringReplay"};n.IK.ERROR,n.IK.FULL,n.IK.OFF},5938:(e,t,r)=>{"use strict";r.d(t,{W:()=>i});var n=r(8325);class i{constructor(e,t,r){this.agentIdentifier=e,this.aggregator=t,this.ee=n.ee.get(e),this.featureName=r,this.blocked=!1}}},2758:(e,t,r)=>{"use strict";r.d(t,{j:()=>E});var n=r(3325),i=r(234),o=r(5546),a=r(8325),s=r(8e3),c=r(3960),u=r(385),d=r(50),l=r(3081),f=r(8632),g=r(7144);const p=["setErrorHandler","finished","addToTrace","addRelease","addPageAction","setCurrentRouteName","setPageViewName","setCustomAttribute","interaction","noticeError","setUserId","setApplicationVersion","start",g.Ef.RECORD,g.Ef.PAUSE],h=["setErrorHandler","finished","addToTrace","addRelease"];var v=r(7894),m=r(7056);function b(){const e=(0,f.gG)();p.forEach((t=>{e[t]=function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];let o=[];return Object.values(e.initializedAgents).forEach((e=>{e.exposed&&e.api[t]&&o.push(e.api[t](...n))})),o.length>1?o:o[0]}(t,...n)}}))}const y={};var A=r(2825);const w=e=>{const t=e.startsWith("http");e+="/",r.p=t?e:"https://"+e};let _=!1;function E(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},p=arguments.length>2?arguments[2]:void 0,E=arguments.length>3?arguments[3]:void 0,{init:x,info:D,loader_config:S,runtime:R={loaderType:p},exposed:k=!0}=t;const N=(0,f.gG)();D||(x=N.init,D=N.info,S=N.loader_config),(0,i.Dg)(e.agentIdentifier,x||{}),(0,i.GE)(e.agentIdentifier,S||{}),D.jsAttributes??={},u.v6&&(D.jsAttributes.isWorker=!0),(0,i.CX)(e.agentIdentifier,D);const P=(0,i.P_)(e.agentIdentifier),j=[D.beacon,D.errorBeacon];_||(P.proxy.assets&&(w(P.proxy.assets),j.push(P.proxy.assets)),P.proxy.beacon&&j.push(P.proxy.beacon),b(),(0,f.EZ)("activatedFeatures",A.T),e.runSoftNavOverSpa&&=!0===P.soft_navigations.enabled&&P.feature_flags.includes("soft_nav")),R.denyList=[...P.ajax.deny_list||[],...P.ajax.block_internal?j:[]],R.ptid=e.agentIdentifier,(0,i.sU)(e.agentIdentifier,R),void 0===e.api&&(e.api=function(e,t){let f=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t||(0,s.RP)(e,"api");const p={};var b=a.ee.get(e),A=b.get("tracer");y[e]=m.IK.OFF,b.on(g.Ef.REPLAY_RUNNING,(t=>{y[e]=t}));var w="api-",_=w+"ixn-";function E(t,r,n,o){const a=(0,i.C5)(e);return null===r?delete a.jsAttributes[t]:(0,i.CX)(e,{...a,jsAttributes:{...a.jsAttributes,[t]:r}}),S(w,n,!0,o||null===r?"session":void 0)(t,r)}function x(){}h.forEach((e=>{p[e]=S(w,e,!0,"api")})),p.addPageAction=S(w,"addPageAction",!0,n.D.pageAction),p.setPageViewName=function(t,r){if("string"==typeof t)return"/"!==t.charAt(0)&&(t="/"+t),(0,i.OP)(e).customTransaction=(r||"http://custom.transaction")+t,S(w,"setPageViewName",!0)()},p.setCustomAttribute=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("string"==typeof e){if(["string","number","boolean"].includes(typeof t)||null===t)return E(e,t,"setCustomAttribute",r);(0,d.Z)("Failed to execute setCustomAttribute.\nNon-null value must be a string, number or boolean type, but a type of <".concat(typeof t,"> was provided."))}else(0,d.Z)("Failed to execute setCustomAttribute.\nName must be a string type, but a type of <".concat(typeof e,"> was provided."))},p.setUserId=function(e){if("string"==typeof e||null===e)return E("enduser.id",e,"setUserId",!0);(0,d.Z)("Failed to execute setUserId.\nNon-null value must be a string type, but a type of <".concat(typeof e,"> was provided."))},p.setApplicationVersion=function(e){if("string"==typeof e||null===e)return E("application.version",e,"setApplicationVersion",!1);(0,d.Z)("Failed to execute setApplicationVersion. Expected <String | null>, but got <".concat(typeof e,">."))},p.start=()=>{try{(0,o.p)(l.xS,["API/start/called"],void 0,n.D.metrics,b),b.emit("manual-start-all")}catch(e){(0,d.Z)("An unexpected issue occurred",e)}},p[g.Ef.RECORD]=function(){(0,o.p)(l.xS,["API/recordReplay/called"],void 0,n.D.metrics,b),(0,o.p)(g.Ef.RECORD,[],void 0,n.D.sessionReplay,b)},p[g.Ef.PAUSE]=function(){(0,o.p)(l.xS,["API/pauseReplay/called"],void 0,n.D.metrics,b),(0,o.p)(g.Ef.PAUSE,[],void 0,n.D.sessionReplay,b)},p.interaction=function(e){return(new x).get("object"==typeof e?e:{})};const D=x.prototype={createTracer:function(e,t){var r={},i=this,a="function"==typeof t;return(0,o.p)(l.xS,["API/createTracer/called"],void 0,n.D.metrics,b),f||(0,o.p)(_+"tracer",[(0,v.z)(),e,r],i,n.D.spa,b),function(){if(A.emit((a?"":"no-")+"fn-start",[(0,v.z)(),i,a],r),a)try{return t.apply(this,arguments)}catch(e){const t="string"==typeof e?new Error(e):e;throw A.emit("fn-err",[arguments,this,t],r),t}finally{A.emit("fn-end",[(0,v.z)()],r)}}}};function S(e,t,r,i){return function(){return(0,o.p)(l.xS,["API/"+t+"/called"],void 0,n.D.metrics,b),i&&(0,o.p)(e+t,[(0,v.z)(),...arguments],r?null:this,i,b),r?void 0:this}}function R(){r.e(75).then(r.bind(r,7438)).then((t=>{let{setAPI:r}=t;r(e),(0,s.LP)(e,"api")})).catch((e=>{(0,d.Z)("Downloading runtime APIs failed...",e),b.abort()}))}return["actionText","setName","setAttribute","save","ignore","onEnd","getContext","end","get"].forEach((e=>{D[e]=S(_,e,void 0,f?n.D.softNav:n.D.spa)})),p.setCurrentRouteName=f?S(_,"routeName",void 0,n.D.softNav):S(w,"routeName",!0,n.D.spa),p.noticeError=function(t,r){"string"==typeof t&&(t=new Error(t)),(0,o.p)(l.xS,["API/noticeError/called"],void 0,n.D.metrics,b),(0,o.p)("err",[t,(0,v.z)(),!1,r,!!y[e]],void 0,n.D.jserrors,b)},u.il?(0,c.b2)((()=>R()),!0):R(),p}(e.agentIdentifier,E,e.runSoftNavOverSpa)),void 0===e.exposed&&(e.exposed=k),_=!0}},8993:(e,t,r)=>{r.nc=(()=>{try{return document?.currentScript?.nonce}catch(e){}return""})()},3325:(e,t,r)=>{"use strict";r.d(t,{D:()=>n,p:()=>i});const n={ajax:"ajax",jserrors:"jserrors",metrics:"metrics",pageAction:"page_action",pageViewEvent:"page_view_event",pageViewTiming:"page_view_timing",sessionReplay:"session_replay",sessionTrace:"session_trace",softNav:"soft_navigations",spa:"spa"},i={[n.pageViewEvent]:1,[n.pageViewTiming]:2,[n.metrics]:3,[n.jserrors]:4,[n.ajax]:5,[n.sessionTrace]:6,[n.pageAction]:7,[n.spa]:8,[n.softNav]:9,[n.sessionReplay]:10}}},n={};function i(e){var t=n[e];if(void 0!==t)return t.exports;var o=n[e]={exports:{}};return r[e](o,o.exports,i),o.exports}i.m=r,i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,r)=>(i.f[r](e,t),t)),[])),i.u=e=>"nr-rum-1.260.1.min.js",i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="NRBA-1.260.1.PROD:",i.l=(r,n,o,a)=>{if(e[r])e[r].push(n);else{var s,c;if(void 0!==o)for(var u=document.getElementsByTagName("script"),d=0;d<u.length;d++){var l=u[d];if(l.getAttribute("src")==r||l.getAttribute("data-webpack")==t+o){s=l;break}}if(!s){c=!0;var f={75:"sha512-WLWoh5UWJ/3XNXjYcJoBc8bSPHGDdu86FTMTgY1yxRTQeEmWWEBFFVPIfCRSbxd8K297eHg86RaJPD+UJxG1+w=="};(s=document.createElement("script")).charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.setAttribute("data-webpack",t+o),s.src=r,0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous"),f[a]&&(s.integrity=f[a])}e[r]=[n];var g=(t,n)=>{s.onerror=s.onload=null,clearTimeout(p);var i=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((e=>e(n))),t)return t(n)},p=setTimeout(g.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=g.bind(null,s.onerror),s.onload=g.bind(null,s.onload),c&&document.head.appendChild(s)}},i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.p="https://js-agent.newrelic.com/",(()=>{var e={50:0,832:0};i.f.j=(t,r)=>{var n=i.o(e,t)?e[t]:void 0;if(0!==n)if(n)r.push(n[2]);else{var o=new Promise(((r,i)=>n=e[t]=[r,i]));r.push(n[2]=o);var a=i.p+i.u(t),s=new Error;i.l(a,(r=>{if(i.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var o=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+a+")",s.name="ChunkLoadError",s.type=o,s.request=a,n[1](s)}}),"chunk-"+t,t)}};var t=(t,r)=>{var n,o,[a,s,c]=r,u=0;if(a.some((t=>0!==e[t]))){for(n in s)i.o(s,n)&&(i.m[n]=s[n]);if(c)c(i)}for(t&&t(r);u<a.length;u++)o=a[u],i.o(e,o)&&e[o]&&e[o][0](),e[o]=0},r=self["webpackChunk:NRBA-1.260.1.PROD"]=self["webpackChunk:NRBA-1.260.1.PROD"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),(()=>{"use strict";i(8993);var e=i(50),t=i(7144),r=i(4402),n=i(8325);class o{agentIdentifier;constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ky)(16);this.agentIdentifier=e,this.ee=n.ee.get(e)}#e(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];if("function"==typeof this.api?.[t])return this.api[t](...n);(0,e.Z)("Call to agent api ".concat(t," failed. The API is not currently initialized."))}addPageAction(e,t){return this.#e("addPageAction",e,t)}setPageViewName(e,t){return this.#e("setPageViewName",e,t)}setCustomAttribute(e,t,r){return this.#e("setCustomAttribute",e,t,r)}noticeError(e,t){return this.#e("noticeError",e,t)}setUserId(e){return this.#e("setUserId",e)}setApplicationVersion(e){return this.#e("setApplicationVersion",e)}setErrorHandler(e){return this.#e("setErrorHandler",e)}finished(e){return this.#e("finished",e)}addRelease(e,t){return this.#e("addRelease",e,t)}start(e){return this.#e("start",e)}recordReplay(){return this.#e(t.Ef.RECORD)}pauseReplay(){return this.#e(t.Ef.PAUSE)}addToTrace(e){return this.#e("addToTrace",e)}setCurrentRouteName(e){return this.#e("setCurrentRouteName",e)}interaction(){return this.#e("interaction")}}var a=i(3325),s=i(234);const c=Object.values(a.D);function u(e){const t={};return c.forEach((r=>{t[r]=function(e,t){return!0===(0,s.Mt)(t,"".concat(e,".enabled"))}(r,e)})),t}var d=i(2758);var l=i(8e3),f=i(5938),g=i(3960),p=i(385);const h=e=>p.il&&!0===(0,s.Mt)(e,"privacy.cookies_enabled");function v(e){return!!s.Yu.MO&&h(e)&&!0===(0,s.Mt)(e,"session_trace.enabled")}var m=i(7872);class b extends f.W{constructor(e,t,r){let n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];super(e,t,r),this.auto=n,this.abortHandler=void 0,this.featAggregate=void 0,this.onAggregateImported=void 0,!1===(0,s.Mt)(this.agentIdentifier,"".concat(this.featureName,".autoStart"))&&(this.auto=!1),this.auto?(0,l.RP)(e,r):this.ee.on("manual-start-all",(0,m.Z)((()=>{(0,l.RP)(this.agentIdentifier,this.featureName),this.auto=!0,this.importAggregator()})))}importAggregator(){let t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.featAggregate||!this.auto)return;this.onAggregateImported=new Promise((e=>{t=e}));const n=async()=>{let n;try{if(h(this.agentIdentifier)){const{setupAgentSession:e}=await i.e(75).then(i.bind(i,7920));n=e(this.agentIdentifier)}}catch(t){(0,e.Z)("A problem occurred when starting up session manager. This page will not start or extend any session.",t),this.featureName===a.D.sessionReplay&&this.abortHandler?.()}try{if(!this.#t(this.featureName,n))return(0,l.LP)(this.agentIdentifier,this.featureName),void t(!1);const{lazyFeatureLoader:e}=await i.e(75).then(i.bind(i,8582)),{Aggregate:o}=await e(this.featureName,"aggregate");this.featAggregate=new o(this.agentIdentifier,this.aggregator,r),t(!0)}catch(r){(0,e.Z)("Downloading and initializing ".concat(this.featureName," failed..."),r),this.abortHandler?.(),(0,l.LP)(this.agentIdentifier,this.featureName,!0),t(!1),this.ee&&this.ee.abort()}};p.il?(0,g.b2)((()=>n()),!0):n()}#t(e,t){return e!==a.D.sessionReplay||(r=this.agentIdentifier,n=t,!(!v(r)||!n?.isNew&&!n?.state.sessionReplayMode));var r,n}}var y=i(7633);class A extends b{static featureName=y.t;constructor(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(e,t,y.t,r),this.importAggregator()}}var w=i(1117),_=i(1284);class E extends w.w{constructor(e){super(e),this.aggregatedData={}}store(e,t,r,n,i){var o=this.getBucket(e,t,r,i);return o.metrics=function(e,t){t||(t={count:0});return t.count+=1,(0,_.D)(e,(function(e,r){t[e]=x(r,t[e])})),t}(n,o.metrics),o}merge(e,t,r,n,i){var o=this.getBucket(e,t,n,i);if(o.metrics){var a=o.metrics;a.count+=r.count,(0,_.D)(r,(function(e,t){if("count"!==e){var n=a[e],i=r[e];i&&!i.c?a[e]=x(i.t,n):a[e]=function(e,t){if(!t)return e;t.c||(t=D(t.t));return t.min=Math.min(e.min,t.min),t.max=Math.max(e.max,t.max),t.t+=e.t,t.sos+=e.sos,t.c+=e.c,t}(i,a[e])}}))}else o.metrics=r}storeMetric(e,t,r,n){var i=this.getBucket(e,t,r);return i.stats=x(n,i.stats),i}getBucket(e,t,r,n){this.aggregatedData[e]||(this.aggregatedData[e]={});var i=this.aggregatedData[e][t];return i||(i=this.aggregatedData[e][t]={params:r||{}},n&&(i.custom=n)),i}get(e,t){return t?this.aggregatedData[e]&&this.aggregatedData[e][t]:this.aggregatedData[e]}take(e){for(var t={},r="",n=!1,i=0;i<e.length;i++)t[r=e[i]]=Object.values(this.aggregatedData[r]||{}),t[r].length&&(n=!0),delete this.aggregatedData[r];return n?t:null}}function x(e,t){return null==e?function(e){e?e.c++:e={c:1};return e}(t):t?(t.c||(t=D(t.t)),t.c+=1,t.t+=e,t.sos+=e*e,e>t.max&&(t.max=e),e<t.min&&(t.min=e),t):{t:e}}function D(e){return{t:e,min:e,max:e,sos:e*e,c:1}}var S=i(8632),R=i(4351);var k=i(5546),N=i(7956),P=i(3239),j=i(9251),T=i(7894);class I extends b{static featureName=j.t;constructor(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(e,t,j.t,r),p.il&&((0,N.N)((()=>(0,k.p)("docHidden",[(0,T.z)()],void 0,j.t,this.ee)),!0),(0,P.bP)("pagehide",(()=>(0,k.p)("winPagehide",[(0,T.z)()],void 0,j.t,this.ee))),this.importAggregator())}}var O=i(3081);class M extends b{static featureName=O.t9;constructor(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(e,t,O.t9,r),this.importAggregator()}}new class extends o{constructor(t,r){super(r),p._A?(this.sharedAggregator=new E({agentIdentifier:this.agentIdentifier}),this.features={},(0,S.h5)(this.agentIdentifier,this),this.desiredFeatures=new Set(t.features||[]),this.desiredFeatures.add(A),this.runSoftNavOverSpa=[...this.desiredFeatures].some((e=>e.featureName===a.D.softNav)),(0,d.j)(this,t,t.loaderType||"agent"),this.run()):(0,e.Z)("Failed to initialize the agent. Could not determine the runtime environment.")}get config(){return{info:this.info,init:this.init,loader_config:this.loader_config,runtime:this.runtime}}run(){try{const t=u(this.agentIdentifier),r=[...this.desiredFeatures];r.sort(((e,t)=>a.p[e.featureName]-a.p[t.featureName])),r.forEach((r=>{if(!t[r.featureName]&&r.featureName!==a.D.pageViewEvent)return;if(this.runSoftNavOverSpa&&r.featureName===a.D.spa)return;if(!this.runSoftNavOverSpa&&r.featureName===a.D.softNav)return;const n=function(e){switch(e){case a.D.ajax:return[a.D.jserrors];case a.D.sessionTrace:return[a.D.ajax,a.D.pageViewEvent];case a.D.sessionReplay:return[a.D.sessionTrace];case a.D.pageViewTiming:return[a.D.pageViewEvent];default:return[]}}(r.featureName);n.every((e=>e in this.features))||(0,e.Z)("".concat(r.featureName," is enabled but one or more dependent features has not been initialized (").concat((0,R.P)(n),"). This may cause unintended consequences or missing data...")),this.features[r.featureName]=new r(this.agentIdentifier,this.sharedAggregator)}))}catch(t){(0,e.Z)("Failed to initialize all enabled instrument classes (agent aborted) -",t);for(const e in this.features)this.features[e].abortHandler?.();const r=(0,S.fP)();delete r.initializedAgents[this.agentIdentifier]?.api,delete r.initializedAgents[this.agentIdentifier]?.features,delete this.sharedAggregator;return r.ee.get(this.agentIdentifier).abort(),!1}}}({features:[A,I,M],loaderType:"lite"})})()})();</script>
<link rel="icon" href="/themes/custom/coresecurity/favicon.ico" type="image/vnd.microsoft.icon">

        <link rel="shortcut icon" href="/themes/custom/coresecurity/favicon.ico" type="image/ico">
        <link rel="apple-touch-icon" href="/themes/custom/coresecurity/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="512x512" href="/themes/custom/coresecurity/android-chrome-512x512.png">
        <link rel="icon" type="image/png" sizes="192x192" href="/themes/custom/coresecurity/android-chrome-192x192.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/themes/custom/coresecurity/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/themes/custom/coresecurity/favicon-16x16.png">
        <link rel="manifest" href="/themes/custom/coresecurity/manifest.json">
        <title>Running PEs Inline Without a Console | Core Labs</title>
        <link rel="stylesheet" media="all" href="/sites/default/files/css/css_9YU9G9z3W2jX6iZ-x3eBpT0hCf9xhFsU77aTEukxIrI.css?delta=0&amp;language=en&amp;theme=coresecurity&amp;include=eJxljUEOwyAMBD9E4UmVAYdYdbBlmwO_b26VmuvsrMa3B16lgmOqIuFhoO8KZiRlsFTgl8dmmiM1MXRsyyj2_6ZgMO7r6aXbUuD8I3lNXZXJT-zPyJSO6cJOUA7iQMsNNEjmU71LH_8CrHVGeQ">
<link rel="stylesheet" media="all" href="/sites/default/files/css/css_Lp8vhJi2CpVZK5Mtymer9vayKwDCY0a0jDQ1ZIH2QLQ.css?delta=1&amp;language=en&amp;theme=coresecurity&amp;include=eJxljUEOwyAMBD9E4UmVAYdYdbBlmwO_b26VmuvsrMa3B16lgmOqIuFhoO8KZiRlsFTgl8dmmiM1MXRsyyj2_6ZgMO7r6aXbUuD8I3lNXZXJT-zPyJSO6cJOUA7iQMsNNEjmU71LH_8CrHVGeQ">
<link rel="stylesheet" media="print" href="/sites/default/files/css/css_4sqPO_VRgWOdjaLE52u8dbma0swrxbYx0tMCj_7i7zE.css?delta=2&amp;language=en&amp;theme=coresecurity&amp;include=eJxljUEOwyAMBD9E4UmVAYdYdbBlmwO_b26VmuvsrMa3B16lgmOqIuFhoO8KZiRlsFTgl8dmmiM1MXRsyyj2_6ZgMO7r6aXbUuD8I3lNXZXJT-zPyJSO6cJOUA7iQMsNNEjmU71LH_8CrHVGeQ">

        <!-- Start VWO Async SmartCode -->
	<link rel="preconnect" href="https://dev.visualwebsiteoptimizer.com">
	<script type="text/javascript" id="vwoCode">
		self.addEventListener("message", function(e, d) {
                var notice_behavior = getCookie('notice_behavior');
                var cmapi_cookie_privacy = getCookie('cmapi_cookie_privacy');
                	if ((notice_behavior.indexOf('us') > -1 && (document.cookie.indexOf('cmapi_cookie_privacy') < 0 || cmapi_cookie_privacy.indexOf(2) > -1))
                    || (notice_behavior.indexOf('eu') > -1 && cmapi_cookie_privacy.indexOf(2) > -1)) {
                    		vwoConsent();
                	}
            	});

            	function getCookie(cname) {
                	let name = cname + "=";
                	let decodedCookie = decodeURIComponent(document.cookie);
                	let ca = decodedCookie.split(';');
                	for(let i = 0; i <ca.length; i++) {
                    		let c = ca[i];
                    		while (c.charAt(0) == ' ') {
                    			c = c.substring(1);
                    		}
                    		if (c.indexOf(name) == 0) {
                    			return c.substring(name.length, c.length);
                    		}
                	}
                	return "";
            	}

    		function vwoConsent(){
                window._vwo_code || (function() {
                var account_id=697207,
                version=2.1,
                settings_tolerance=2000,
                hide_element='body',
                hide_element_style = 'opacity:0 !important;filter:alpha(opacity=0) !important;background:none !important',
                /* DO NOT EDIT BELOW THIS LINE */
                f=false,w=window,d=document,v=d.querySelector('#vwoCode'),cK='_vwo_'+account_id+'_settings',cc={};try{var c=JSON.parse(localStorage.getItem('_vwo_'+account_id+'_config'));cc=c&&typeof c==='object'?c:{}}catch(e){}var stT=cc.stT==='session'?w.sessionStorage:w.localStorage;code={use_existing_jquery:function(){return typeof use_existing_jquery!=='undefined'?use_existing_jquery:undefined},library_tolerance:function(){return typeof library_tolerance!=='undefined'?library_tolerance:undefined},settings_tolerance:function(){return cc.sT||settings_tolerance},hide_element_style:function(){return'{'+(cc.hES||hide_element_style)+'}'},hide_element:function(){if(performance.getEntriesByName('first-contentful-paint')[0]){return''}return typeof cc.hE==='string'?cc.hE:hide_element},getVersion:function(){return version},finish:function(e){if(!f){f=true;var t=d.getElementById('_vis_opt_path_hides');if(t)t.parentNode.removeChild(t);if(e)(new Image).src='https://dev.visualwebsiteoptimizer.com/ee.gif?a='+account_id+e}},finished:function(){return f},addScript:function(e){var t=d.createElement('script');t.type='text/javascript';if(e.src){t.src=e.src}else{t.text=e.text}d.getElementsByTagName('head')[0].appendChild(t)},load:function(e,t){var i=this.getSettings(),n=d.createElement('script'),r=this;t=t||{};if(i){n.textContent=i;d.getElementsByTagName('head')[0].appendChild(n);if(!w.VWO||VWO.caE){stT.removeItem(cK);r.load(e)}}else{var o=new XMLHttpRequest;o.open('GET',e,true);o.withCredentials=!t.dSC;o.responseType=t.responseType||'text';o.onload=function(){if(t.onloadCb){return t.onloadCb(o,e)}if(o.status===200){w._vwo_code.addScript({text:o.responseText})}else{w._vwo_code.finish('&e=loading_failure:'+e)}};o.onerror=function(){if(t.onerrorCb){return t.onerrorCb(e)}w._vwo_code.finish('&e=loading_failure:'+e)};o.send()}},getSettings:function(){try{var e=stT.getItem(cK);if(!e){return}e=JSON.parse(e);if(Date.now()>e.e){stT.removeItem(cK);return}return e.s}catch(e){return}},init:function(){if(d.URL.indexOf('__vwo_disable__')>-1)return;var e=this.settings_tolerance();w._vwo_settings_timer=setTimeout(function(){w._vwo_code.finish();stT.removeItem(cK)},e);var t;if(this.hide_element()!=='body'){t=d.createElement('style');var i=this.hide_element(),n=i?i+this.hide_element_style():'',r=d.getElementsByTagName('head')[0];t.setAttribute('id','_vis_opt_path_hides');v&&t.setAttribute('nonce',v.nonce);t.setAttribute('type','text/css');if(t.styleSheet)t.styleSheet.cssText=n;else t.appendChild(d.createTextNode(n));r.appendChild(t)}else{t=d.getElementsByTagName('head')[0];var n=d.createElement('div');n.style.cssText='z-index: 2147483647 !important;position: fixed !important;left: 0 !important;top: 0 !important;width: 100% !important;height: 100% !important;background: white !important;';n.setAttribute('id','_vis_opt_path_hides');n.classList.add('_vis_hide_layer');t.parentNode.insertBefore(n,t.nextSibling)}var o='https://dev.visualwebsiteoptimizer.com/j.php?a='+account_id+'&u='+encodeURIComponent(d.URL)+'&vn='+version;if(w.location.search.indexOf('_vwo_xhr')!==-1){this.addScript({src:o})}else{this.load(o+'&x=true')}}};w._vwo_code=code;code.init();})();(function(){var i=window;function t(){if(i._vwo_code){var e=t.hidingStyle=document.getElementById('_vis_opt_path_hides')||t.hidingStyle;if(!i._vwo_code.finished()&&!_vwo_code.libExecuted&&(!i.VWO||!VWO.dNR)){if(!document.getElementById('_vis_opt_path_hides')){document.getElementsByTagName('head')[0].appendChild(e)}requestAnimationFrame(t)}}}t()})();
		    }
	</script>
	<!-- End VWO Async SmartCode -->
        <!-- TrustArc tag start -->
        <meta http-equiv="origin-trial" content="A0jVG6h6e7DyzHk6Ud4chFRjn+M5ln+Yh7cwlzqSKu/U3zkZGg/+cL8VBF9gxD15pc4tTWfftxKbvlQMcg7fVQgAAACGeyJvcmlnaW4iOiJodHRwczovL2NvbnNlbnQudHJ1c3RhcmMuY29tOjQ0MyIsImZlYXR1cmUiOiJEaXNhYmxlVGhpcmRQYXJ0eVN0b3JhZ2VQYXJ0aXRpb25pbmciLCJleHBpcnkiOjE3MjU0MDc5OTksImlzVGhpcmRQYXJ0eSI6dHJ1ZX0="></head><body class="layout-no-sidebars page-node-105019 path-node node--type-article"><div id="consent_blackbar"></div>
        <div class="d-none truste_caIcon_display" id="teconsent" consent="undefined" aria-label="Open Cookie Preferences Modal" role="complementary"><script async="async" type="text/javascript" crossorigin="" importance="high" src="https://consent.trustarc.com/asset/notice.js/v/v1.7-518"></script><a role="link" id="icon-id010044546880883909" tabindex="0" lang="en" aria-haspopup="dialog" aria-label="Cookie Preferences, opens a dedicated popup modal window" class="truste_cursor_pointer">Cookie Preferences</a></div>
        <script async="async" src="https://consent.trustarc.com/notice?domain=helpsystems.com&amp;c=teconsent&amp;gtm=1&amp;js=nj&amp;noticeType=bb&amp;text=true&amp;pn=2&amp;cookieLink=https://www.helpsystems.com/cookie-policy&amp;privacypolicylink=https://www.helpsystems.com/privacy-policy" crossorigin="" id="truste_0.717059906761648"></script>
        <script>
            var __dispatched__ = {}; //Map of previously dispatched preference levels

            /* First step is to register with the CM API to receive callbacks when a preference update occurs. You must wait for the CM API (PrivacyManagerAPI object) to exist on the page before registering.
            */
            var __i__ = self.postMessage && setInterval(function() {
                if (self.PrivacyManagerAPI && __i__) {
                    var apiObject = {
                        PrivacyManagerAPI: {
                            action: "getConsentDecision",
                            timestamp: new Date().getTime(),
                            self: self.location.host
                        }
                    };
                    self.top.postMessage(JSON.stringify(apiObject), "*");
                    __i__ = clearInterval(__i__);
                }
            }, 50);

            /*
            Callbacks will occur in the form of a PostMessage event.
            This code listens for the appropriately formatted PostMessage event,
            gets the new consent decision, and then pushes the events into the GTM framework. Once the event is submitted, that consent decision is marked in the 'dispatched' map so it does not occur more than once.
            */
            self.addEventListener("message", function(e, d) {
                try {
                    if (e.data && (d = JSON.parse(e.data)) &&
                        (d = d.PrivacyManagerAPI) && d.capabilities && d.action == "getConsentDecision") {
                        var newDecision = self.PrivacyManagerAPI.callApi("getGDPRConsentDecision", self.location.host).consentDecision;
                        newDecision && newDecision.forEach(function(label) {
                            if (!__dispatched__[label]) {
                                self.dataLayer && self.dataLayer.push({
                                    "event": "GDPR Pref Allows " + label
                                });
                                __dispatched__[label] = 1;
                            }
                        });
                    }
                } catch (xx) {
                    /** not a cm api message **/
                }
            });
        </script>
        <!-- TrustArc tag end -->
        
        <!-- Content Grouping -->
         
                  <meta name="contentgroup1" content="CTS">              <!-- End Content Grouping -->
        <!-- Google Tag Manager -->
        <script data-cookieconsent="ignore">
            (function(w, d, s, l, i) {
                w[l] = w[l] || [];
                w[l].push({
                    'gtm.start': new Date().getTime(),
                    event: 'gtm.js'
                });
                var f = d.getElementsByTagName(s)[0],
                    j = d.createElement(s),
                    dl = l != 'dataLayer' ? '&l=' + l : '';
                j.async = true;
                j.src =
                    'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
                f.parentNode.insertBefore(j, f);
            })(window, document, 'script', 'dataLayer', 'GTM-KQFL4VC');
        </script>
        <!-- End Google Tag Manager -->
    
    
        <!-- Google Tag Manager (noscript) -->
        <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KQFL4VC" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
        <!-- End Google Tag Manager (noscript) -->
        <a href="#main-content" class="visually-hidden focusable skip-link">Skip to main content</a> 
         
          <div class="dialog-off-canvas-main-canvas" data-off-canvas-main-canvas="">
    <div id="page-wrapper">
    <div id="page">
        <header id="header" class="header" role="banner" aria-label="Site header">
                        <nav class="navbar navbar-expand-lg navbar-dark">
                <div class="container-fluid">
                    <div class="navbar-brand header-logo-wrapper">
                        <div class="logo_container">
                            <a href="/" title="Home">
                                <span class="fortra-logo base-logo">
									<img width="150" height="24" src="https://static.fortra.com/fortra-global-assets/fortra-logo-full.svg?l=704278383" alt="Fortra" class="logo-full">
									<img src="https://static.fortra.com/fortra-global-assets/fortra-logo-small.svg?l=1705268592" alt="Fortra" data-height-percentage="54" class="logo-small">
							    </span>
                                <span class="site-logo base-logo">
                                    <img width="180" height="auto" src="/themes/custom/coresecurity/images/core-security-dark-bg.svg" alt="Core Security Logo">
                                </span>
                            </a>
                        </div>
                    </div>
                    <div class="secondary-wrapper d-lg-none">
                           <nav role="navigation" id="block-secondarynavigation" class="block block-menu navigation menu--secondary-navigation d-inline-block">
          
              <ul id="block-secondarynavigation" block="block-secondarynavigation" class="clearfix nav">
                    <li class="nav-item">
                                                    <a href="https://www.fortra.com/?utm_source=coresecurity.com&amp;utm_medium=referral&amp;utm_campaign=fortra_secondarynav_link" target="_blank" class="nav-link">Fortra.com</a>
                        </li>
                <li class="nav-item">
                                                    <a href="/about/contact" class="nav-link" data-drupal-link-system-path="node/100641">Contact Us</a>
                        </li>
                <li class="nav-item">
                                                    <a href="/support" class="nav-link" data-drupal-link-system-path="node/100118">Support</a>
                        </li>
                <li class="nav-item">
                                                    <a href="/products/fortra-products" class="nav-link Array" data-drupal-link-system-path="node/104528">All Fortra Products</a>
                        </li>
                <li class="nav-item">
                                                    <a href="/products/trials" class="btn btn-primary btn btn-primary btn btn-primary nav-link Array" data-drupal-link-system-path="node/104326">FREE TRIALS</a>
                        </li>
        </ul>
  



  </nav>

                      </div>
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>

                    <div class="d-flex flex-fill flex-lg-column align-items-start ml-lg-2 ml-0">
                                                <div class="ml-auto d-none d-lg-block">
                              <nav role="navigation" id="block-secondarynavigation" class="block block-menu navigation menu--secondary-navigation d-inline-block">
          
              <ul id="block-secondarynavigation" block="block-secondarynavigation" class="clearfix nav">
                    <li class="nav-item">
                                                    <a href="https://www.fortra.com/?utm_source=coresecurity.com&amp;utm_medium=referral&amp;utm_campaign=fortra_secondarynav_link" target="_blank" class="nav-link">Fortra.com</a>
                        </li>
                <li class="nav-item">
                                                    <a href="/about/contact" class="nav-link" data-drupal-link-system-path="node/100641">Contact Us</a>
                        </li>
                <li class="nav-item">
                                                    <a href="/support" class="nav-link" data-drupal-link-system-path="node/100118">Support</a>
                        </li>
                <li class="nav-item">
                                                    <a href="/products/fortra-products" class="nav-link Array" data-drupal-link-system-path="node/104528">All Fortra Products</a>
                        </li>
                <li class="nav-item">
                                                    <a href="/products/trials" class="btn btn-primary btn btn-primary btn btn-primary nav-link Array" data-drupal-link-system-path="node/104326">FREE TRIALS</a>
                        </li>
        </ul>
  



  </nav>

                         </div>

                        <div class="collapse navbar-collapse ml-auto" id="navbarCollapse">
                                  <nav role="navigation" aria-labelledby="block-mainnavigation-menu" id="block-mainnavigation" class="block block-menu navigation menu--main navbar navbar-expand-lg">
  
        
  
            <ul class="clearfix nav navbar-nav menu-level-0">
        
                                          
                    
                      
                    
                      
                    
              
                    
      
      <li class="nav-item expanded dropdown mega-menu --mega-cyber_products --mega-cyber_solutions --mega-cyber_products --mega-cyber_solutions">
        
                                        <div class="btn-group">
    <a href="/products#cts" class="--mega-cyber_products --mega-cyber_solutions --mega-cyber_products --mega-cyber_solutions nav-link" data-drupal-link-system-path="node/104562">Cyber Threat</a>
    <button type="button" class="dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      <span class="sr-only">Toggle Dropdown</span>
    </button>
      
            <ul class="dropdown-menu menu-level-1 ">
            
                                <div class="mega-block-item">
              <nav role="navigation" aria-labelledby="block-menu-block-cyber-products-menu" id="block-menu-block-cyber-products" class="block block-menu navigation menu--main">
      
  <h4 id="block-menu-block-cyber-products-menu">Products</h4>
  

        
  
            <ul class="clearfix nav navbar-nav menu-level-0">
        
                                  
                    
      
      <li class="nav-item">
        
                  <a href="/products/core-impact" title="Penetration testing software" class="nav-link" data-drupal-link-system-path="node/100096">Core Impact</a>
                      <em class="menu-description">Penetration testing software</em>
                        </li>
                                                
                    
      
      <li class="nav-item">
        
                  <a href="/products/cobalt-strike" class="nav-link" title="Red team software" data-drupal-link-system-path="node/100101">Cobalt Strike</a>
                      <em class="menu-description">Red team software</em>
                        </li>
                                                
                    
      
      <li class="nav-item">
        
                  <a href="/products/outflank-security-tooling" class="nav-link" title="Evasive attack simulation" data-drupal-link-system-path="node/104823">Outflank Security Tooling (OST)</a>
                      <em class="menu-description">Evasive attack simulation</em>
                        </li>
                                  
                    
      
      <li class="nav-item">
        
                  <a href="/products/event-manager" title="Security information and event&nbsp;management" class="nav-link" data-drupal-link-system-path="node/100027">Event Manager</a>
                      <em class="menu-description">Security information and event&nbsp;management</em>
                        </li>
                                  
                    
      
      <li class="nav-item">
        
                  <a href="/products/powertech-antivirus" title="Server-level virus protection" class="nav-link" data-drupal-link-system-path="node/100099">Powertech Antivirus</a>
                      <em class="menu-description">Server-level virus protection</em>
                        </li>
                                  
                    
      
      <li class="nav-item">
        
                  <a href="/products/bundles" title="Layered security solutions" class="nav-link" data-drupal-link-system-path="node/104714">Product Bundles</a>
                      <em class="menu-description">Layered security solutions</em>
                        </li>
        </ul>
  



  </nav>

          </div>
                                        <div class="mega-block-item">
              <nav role="navigation" aria-labelledby="block-menu-block-cyber-solutions-menu" id="block-menu-block-cyber-solutions" class="block block-menu navigation menu--main">
      
  <h4 id="block-menu-block-cyber-solutions-menu">Solutions</h4>
  

        
  
            <ul class="clearfix nav navbar-nav menu-level-0">
        
                                  
                    
      
      <li class="nav-item">
        
                  <a href="/penetration-testing" class="nav-link" data-drupal-link-system-path="node/100085">Penetration Testing</a>
                        </li>
                                                
                    
      
      <li class="nav-item">
        
                  <a href="/services" class="nav-link" data-drupal-link-system-path="node/100004">Penetration Testing Services</a>
                        </li>
                                                
                    
      
      <li class="nav-item">
        
                  <a href="/offensive-security" class="nav-link" data-drupal-link-system-path="node/104832">Offensive Security</a>
                        </li>
                                  
                    
      
      <li class="nav-item">
        
                  <a href="/threat-detection" class="nav-link" data-drupal-link-system-path="node/100091">Threat Detection</a>
                        </li>
                                  
                    
      
      <li class="nav-item">
        
                  <a href="/siem" class="nav-link" data-drupal-link-system-path="node/100029">Security Information and Event Management</a>
                        </li>
        </ul>
  



  </nav>

          </div>
                                        
                                                                                                                                    
                    
      
      <li class="dropdown-item mega-footer-block mega-footer-block mega-footer-block mega-footer-block mega-footer-block mega-footer-block mega-footer-block">
        
                  <a href="/services" class="mega-footer-block subnav-link" title="Security consulting services" data-drupal-link-system-path="node/100004">Penetration Testing Services</a>
                      <em class="menu-description">Security consulting services</em>
                        </li>
        </ul>
  
  </div>

                        </li>
                                          
                    
                      
                    
                      
                    
              
                    
      
      <li class="nav-item expanded dropdown mega-menu --mega-identity_products --mega-identity_solutions --mega-identity_products --mega-identity_solutions">
        
                                        <div class="btn-group">
    <a href="/products#iga" class="--mega-identity_products --mega-identity_solutions --mega-identity_products --mega-identity_solutions nav-link" data-drupal-link-system-path="node/104562">Identity</a>
    <button type="button" class="dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      <span class="sr-only">Toggle Dropdown</span>
    </button>
      
            <ul class="dropdown-menu menu-level-1 ">
            
                                <div class="mega-block-item">
              <nav role="navigation" aria-labelledby="block-menu-block-identity-products-menu" id="block-menu-block-identity-products" class="block block-menu navigation menu--main">
      
  <h4 id="block-menu-block-identity-products-menu">Products</h4>
  

        
  
            <ul class="clearfix nav navbar-nav menu-level-0">
        
                                  
                    
      
      <li class="nav-item">
        
                  <a href="/products/access-assurance-suite" title="User provisioning and governance" class="nav-link" data-drupal-link-system-path="node/100082">Access Assurance Suite</a>
                      <em class="menu-description">User provisioning and governance</em>
                        </li>
                                  
                    
      
      <li class="nav-item">
        
                  <a href="/products/core-password" title="Self-service password management" class="nav-link" data-drupal-link-system-path="node/100105">Core Password &amp; Secure Reset</a>
                      <em class="menu-description">Self-service password management</em>
                        </li>
                                                
                    
      
      <li class="nav-item">
        
                  <a href="/products/core-privileged-access-manager-boks" class="nav-link" title="Privileged access management (PAM)" data-drupal-link-system-path="node/100110">Core Privileged Access Manager (BoKS)</a>
                      <em class="menu-description">Privileged access management (PAM)</em>
                        </li>
        </ul>
  



  </nav>

          </div>
                                        <div class="mega-block-item">
              <nav role="navigation" aria-labelledby="block-menu-block-identity-solutions-menu" id="block-menu-block-identity-solutions" class="block block-menu navigation menu--main">
      
  <h4 id="block-menu-block-identity-solutions-menu">Solutions</h4>
  

        
  
            <ul class="clearfix nav navbar-nav menu-level-0">
        
                                  
                    
      
      <li class="nav-item">
        
                  <a href="/privileged-access-management" class="nav-link" data-drupal-link-system-path="node/100083">Privileged Access Management</a>
                        </li>
                                  
                    
      
      <li class="nav-item">
        
                  <a href="/identity-governance-and-administration" class="nav-link" data-drupal-link-system-path="node/100084">Identity Governance &amp; Administration</a>
                        </li>
                                  
                    
      
      <li class="nav-item">
        
                  <a href="/products/core-password" class="nav-link" data-drupal-link-system-path="node/100105">Password Management</a>
                        </li>
        </ul>
  



  </nav>

          </div>
                                        
                                                                                                                                                  
                    
      
      <li class="dropdown-item mega-footer-block mega-footer-block mega-footer-block mega-footer-block mega-footer-block mega-footer-block mega-footer-block mega-footer-block">
        
                  <a href="/products/access-assurance-suite/demo" class="mega-footer-block subnav-link" data-drupal-link-system-path="node/100605">See How to Simplify Access in Your Organization | Request a Demo</a>
                        </li>
        </ul>
  
  </div>

                        </li>
                                  
                    
      
      <li class="nav-item expanded dropdown">
        
                                        <div class="btn-group">
    <a href="/industries" class="nav-link" data-drupal-link-system-path="node/100003">Industries</a>
    <button type="button" class="dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      <span class="sr-only">Toggle Dropdown</span>
    </button>
      
            <ul class="dropdown-menu menu-level-1 ">
        
                                  
                    
      
      <li class="dropdown-item">
        
                  <a href="/industries/healthcare" class="subnav-link" data-drupal-link-system-path="node/100076">Healthcare</a>
                        </li>
                                  
                    
      
      <li class="dropdown-item">
        
                  <a href="/industries/financial-services" class="subnav-link" data-drupal-link-system-path="node/100077">Financial Services</a>
                        </li>
                                  
                    
      
      <li class="dropdown-item">
        
                  <a href="/industries/government" class="subnav-link" data-drupal-link-system-path="node/100078">Federal Government</a>
                        </li>
                                  
                    
      
      <li class="dropdown-item">
        
                  <a href="/industries/retail" class="subnav-link" data-drupal-link-system-path="node/100080">Retail</a>
                        </li>
                                  
                    
      
      <li class="dropdown-item">
        
                  <a href="/industries/energy-and-utilities" class="subnav-link" data-drupal-link-system-path="node/100081">Utilities &amp; Energy</a>
                        </li>
                                  
                    
      
      <li class="dropdown-item">
        
                  <a href="/industries/higher-education" class="subnav-link" data-drupal-link-system-path="node/100079">Higher Education</a>
                        </li>
                                  
                    
      
      <li class="dropdown-item">
        
                  <a href="/compliance" class="subnav-link" data-drupal-link-system-path="node/100090">Compliance</a>
                        </li>
        </ul>
  
  </div>

                        </li>
                                  
                    
      
      <li class="nav-item expanded dropdown">
        
                                        <div class="btn-group">
    <a href="/resources" class="nav-link" data-drupal-link-system-path="resources">Resources</a>
    <button type="button" class="dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      <span class="sr-only">Toggle Dropdown</span>
    </button>
      
            <ul class="dropdown-menu menu-level-1 ">
        
                                                
                    
      
      <li class="dropdown-item">
        
                  <a href="/resources/upcoming/webinars-events" class="subnav-link" data-drupal-link-system-path="resources/upcoming/webinars-events">Upcoming Webinars &amp; Events</a>
                        </li>
                                                
                    
      
      <li class="dropdown-item">
        
                  <a href="/blog" class="subnav-link" data-drupal-link-system-path="blog">Blogs</a>
                        </li>
                                                
                    
      
      <li class="dropdown-item">
        
                  <a href="/resources?title=&amp;field_cta_type_relationship_target_id=118&amp;field_product_line_relationship_target_id=All" class="subnav-link" data-drupal-link-query="{&quot;field_cta_type_relationship_target_id&quot;:&quot;118&quot;,&quot;field_product_line_relationship_target_id&quot;:&quot;All&quot;,&quot;title&quot;:&quot;&quot;}" data-drupal-link-system-path="resources">Case Studies</a>
                        </li>
                                                
                    
      
      <li class="dropdown-item">
        
                  <a href="/resources?resource_name=&amp;field_cta_type_relationship_target_id=53&amp;field_product_line_relationship_target_id=All" class="subnav-link" data-drupal-link-query="{&quot;field_cta_type_relationship_target_id&quot;:&quot;53&quot;,&quot;field_product_line_relationship_target_id&quot;:&quot;All&quot;,&quot;resource_name&quot;:&quot;&quot;}" data-drupal-link-system-path="resources">Videos</a>
                        </li>
                                                
                    
      
      <li class="dropdown-item">
        
                  <a href="/resources?title=&amp;field_cta_type_relationship_target_id=119&amp;field_product_line_relationship_target_id=All" class="subnav-link" data-drupal-link-query="{&quot;field_cta_type_relationship_target_id&quot;:&quot;119&quot;,&quot;field_product_line_relationship_target_id&quot;:&quot;All&quot;,&quot;title&quot;:&quot;&quot;}" data-drupal-link-system-path="resources">Datasheets</a>
                        </li>
                                                
                    
      
      <li class="dropdown-item">
        
                  <a href="/resources?title=&amp;field_cta_type_relationship_target_id=52&amp;field_product_line_relationship_target_id=All" class="subnav-link" data-drupal-link-query="{&quot;field_cta_type_relationship_target_id&quot;:&quot;52&quot;,&quot;field_product_line_relationship_target_id&quot;:&quot;All&quot;,&quot;title&quot;:&quot;&quot;}" data-drupal-link-system-path="resources">Guides</a>
                        </li>
                                                
                    
      
      <li class="dropdown-item">
        
                  <a href="/resources?title=&amp;field_cta_type_relationship_target_id=54&amp;field_product_line_relationship_target_id=All" class="subnav-link" data-drupal-link-query="{&quot;field_cta_type_relationship_target_id&quot;:&quot;54&quot;,&quot;field_product_line_relationship_target_id&quot;:&quot;All&quot;,&quot;title&quot;:&quot;&quot;}" data-drupal-link-system-path="resources">Ecourses</a>
                        </li>
                                                
                    
      
      <li class="dropdown-item">
        
                  <a href="/compliance" class="subnav-link" data-drupal-link-system-path="node/100090">Compliance</a>
                        </li>
                                                
                    
      
      <li class="dropdown-item">
        
                  <a href="/resources" class="subnav-link" data-drupal-link-system-path="resources">All Resources</a>
                        </li>
        </ul>
  
  </div>

                        </li>
                                                              
              
                    
      
      <li class="nav-item expanded dropdown --dd-dropdown-menu-right">
        
                                        <div class="btn-group">
    <a href="/core-labs" class="--dd-dropdown-menu-right nav-link" data-drupal-link-system-path="node/103331">CoreLabs</a>
    <button type="button" class="dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      <span class="sr-only">Toggle Dropdown</span>
    </button>
      
            <ul class="dropdown-menu menu-level-1 dropdown-menu-right">
        
                                  
                    
      
      <li class="dropdown-item">
        
                  <a href="/core-labs/advisories" class="subnav-link" data-drupal-link-system-path="core-labs/advisories">Advisories</a>
                        </li>
                                  
                    
      
      <li class="dropdown-item">
        
                  <a href="/core-labs/exploits" class="subnav-link" data-drupal-link-system-path="node/103698">Exploits</a>
                        </li>
                                  
                    
      
      <li class="dropdown-item">
        
                  <a href="/core-labs/publications" class="subnav-link" data-drupal-link-system-path="core-labs/publications">Publications</a>
                        </li>
                                  
                    
      
      <li class="dropdown-item">
        
                  <a href="/core-labs/articles" class="subnav-link" data-drupal-link-system-path="core-labs/articles">Articles</a>
                        </li>
                                  
                    
      
      <li class="dropdown-item">
        
                  <a href="/core-labs/open-source-tools" class="subnav-link" data-drupal-link-system-path="core-labs/open-source-tools">Open Source Tools</a>
                        </li>
        </ul>
  
  </div>

                        </li>
                                                              
              
                    
      
      <li class="nav-item expanded dropdown --dd-dropdown-menu-right">
        
                                        <div class="btn-group">
    <a href="/about" class="--dd-dropdown-menu-right nav-link" data-drupal-link-system-path="node/100006">About</a>
    <button type="button" class="dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      <span class="sr-only">Toggle Dropdown</span>
    </button>
      
            <ul class="dropdown-menu menu-level-1 dropdown-menu-right">
        
                                  
                    
      
      <li class="dropdown-item">
        
                  <a href="/about/partners" class="subnav-link" data-drupal-link-system-path="node/100656">Partners</a>
                        </li>
                                                
                    
      
      <li class="dropdown-item">
        
                  <a href="https://www.fortra.com/about/careers" class="subnav-link">Careers</a>
                        </li>
                                                
                    
      
      <li class="dropdown-item">
        
                  <a href="/resources?title=&amp;field_cta_type_relationship_target_id=121&amp;field_product_line_relationship_target_id=All" class="subnav-link" data-drupal-link-query="{&quot;field_cta_type_relationship_target_id&quot;:&quot;121&quot;,&quot;field_product_line_relationship_target_id&quot;:&quot;All&quot;,&quot;title&quot;:&quot;&quot;}" data-drupal-link-system-path="resources">Press Releases</a>
                        </li>
                                  
                    
      
      <li class="dropdown-item">
        
                  <a href="/about/contact" class="subnav-link" data-drupal-link-system-path="node/100641">Contact Us</a>
                        </li>
        </ul>
  
  </div>

                        </li>
        </ul>
  



  </nav>

                         </div>
                                            </div>
                </div>
            </nav>
                    </header>

        <div id="main-wrapper" class="layout-main-wrapper clearfix">
                      <div id="main" class="main">
          <div class="row row-offcanvas row-offcanvas-left clearfix">
              <main class="main-content col" id="content" role="main">
                  <a id="main-content" tabindex="-1"></a>
                    <div data-drupal-messages-fallback="" class="hidden"></div><div id="block-coresecurity-content" class="block block-system block-system-main-block">
  
    
      <div class="content">
      

<article data-history-node-id="105019" about="/core-labs/articles/running-pes-inline-without-console" typeof="schema:Article" class="node node--type-article node--promoted node--view-mode-full article-sidebar clearfix">
        
<!--Header type = "Blue Header"-->
<header class="jumbotron jumbotron-fluid blue text-light">
 <div class="container">
    <div class="row"><div class="col-sm-12">
        <h1 class="node__title display-4">
            <div class="field field--name-field-header-title field--type-string field--label-hidden field__item"> Running PEs Inline Without a Console</div>
      </h1>

    <div class="lead"></div>
    <div class="lead"></div>
    </div><!-- END .col-sm-8 -->
    </div><!-- END .row -->
    </div><!-- END .container -->
  </header>






    <div class="node__content clearfix">
    <div class="node-content-container container">
      <div class="row">
                        <div class="col-lg-8">


            <div property="schema:text" class="clearfix text-formatted field field--name-body field--type-text-with-summary field--label-hidden field__item"><p>While reading the amazing <a href="https://github.com/Octoberfest7/Inline-Execute-PE">Inline-Execute-PE</a> by <a href="https://twitter.com/octoberfest73">Octoberfest7</a>, I noticed that to obtain the output from the PE being executed, the author needed to allocate a console, which results in a process being created (conhost.exe).
</p>
<p class="MsoNormal">Interestingly, the readme also states that a commercial C2 managed to avoid spawning a conhost.exe process by "fooling Windows into thinking it had a console." After reading this, I thought I might give it a try and attempt to achieve the same.
</p>
<p class="MsoNormal">This blogpost is the result of that research project, which took me three weeks of demanding work and led to some interesting results.
</p>
<h2>A Brief Introduction to How Consoles Work

</h2>
<p class="MsoNormal">To put it simply, a console is the black box you see when you run CMD. Programs can get user input from it and print output to it.
</p>
<p class="MsoNormal">In Windows, the console is run by a separate process called conhost.exe, which interacts with the actual executable via a series of APIs. But not all processes have a console, some have a GUI like notepad or run in detached mode like lsass. If a process wants to allocate a console, all it must do is call <a href="https://learn.microsoft.com/en-us/windows/console/allocconsole">AllocConsole</a>, which will create the conhost.exe process, initialize the standard input, output and error streams, and save a handle to the console under <samp>PEB-&gt;ProcessParameters-&gt;ConsoleHandle.</samp></p>
<p class="MsoNormal">Given that different binaries interact with the console in diverse ways, convincing binaries that we already have a console (when we do not) and redirecting its output to a pipe will require not just one trick, but several. I will go over the techniques that were used for each binary going from the simplest to the most complex.
</p>
<h2>Hello World with MinGW

</h2>
<p class="MsoNormal">I started with a simple “hello world” project in C which I cross-compiled from Linux to Windows with the MinGW compiler.
</p>
<p class="MsoNormal">Before loading and running this PE inline (meaning, in the same process as Beacon), I allocated a console with <em>AllocConsole</em>. This created a conhost.exe process; initialized the standard input, output, and error streams; and set the new <em>ConsoleHandle&nbsp;</em>on the PEB. Also, I updated the standard output and error streams by calling <a href="https://learn.microsoft.com/en-us/windows/console/setstdhandle"><em>SetStdHandle</em></a><em> </em>with the write handle of the anonymous pipe I created previously.
</p>
<pre><code class="language-plaintext">AllocConsole();
SetStdHandle(STD_OUTPUT_HANDLE, hPipeWrite);
SetStdHandle(STD_ERROR_HANDLE, hPipeWrite);
<p></p></code></pre><p class="MsoNormal">Next, I invalidated the <em>ConsoleHandle </em>on the PEB so that the program could not interact with the console anymore.
</p>
<pre><code class="language-plaintext">PEB-&gt;ProcessParameters-&gt;ConsoleHandle = 0x123;<p></p></code></pre><p class="MsoNormal">After running the program, I noticed that the redirection still worked, which seemed to indicate that the program did not actually interact with the console directly.
</p>
<p class="MsoNormal">Knowing this, I decided to modify the <em>stdout </em>FILE* structure in memory, which is defined below:
</p>
<pre><code class="language-plaintext">struct _iobuf {
    char *_ptr;
    int _cnt;
    char *_base;
    int _flag;
    int _file;
    int _charbuf;
    int _bufsiz;
    char *_tmpfname;
};
typedef struct _iobuf FILE;<p></p></code></pre><p class="MsoNormal">The<em> _file </em>attribute is supposed to be the file descriptor, but because we are using an anonymous pipe, we only have a handle. To convert the <a name="_Int_ZDgEfiu6" id="_Int_ZDgEfiu6">pipe</a> write handle to a file descriptor I called <a href="https://learn.microsoft.com/en-us/cpp/c-runtime-library/reference/open-osfhandle?view=msvc-170"><em>_open_osfhandle</em></a><em> </em>and used the resulting descriptor to set <em>stdout-&gt;_file</em>.
</p>
<p class="MsoNormal">The last change needed was to set the flags<em> (_flag) </em>to<em> _IOWRT </em>(file descriptor is writeable) and<em> _IONBF </em>(disable buffering).
</p>
<p class="MsoNormal">After this, I successfully redirected the output without having to allocate a console.</p>
<div class="align-center media-default">
  
  
  <div class="field field--name-field-media-image field--type-image field--label-visually_hidden">
    <div class="field__label visually-hidden">Image</div>
              <div class="field__item">  <img src="/sites/default/files/2023-11/running_pes_inline_without_console_img_01_redirect_output.png" width="392" height="104" alt="redirect output" loading="lazy" typeof="foaf:Image"></div>
          </div>

</div>
<p class="MsoNormal">
</p>
<p class="MsoNormal">
</p>
<h2>Hello World with MSVC

</h2>
<p class="MsoNormal">When compiling the “Hello World” program with the Microsoft compiler, I tried the same trick from before and it seemed to work fine, but when I tried to run a more complicated program (nanodump compiled with the MSVC compiler) I noticed that I got no output.
</p>
<p class="MsoNormal">It appears that if you compile your program like this, it works:</p>
<pre><code class="language-plaintext">cl.exe helloworld.c /Fe:helloworld.exe<p></p></code></pre><p class="MsoNormal">However, if you compiled like this, it does not:
</p>
<pre><code class="language-plaintext">cl.exe helloworld.c -c –nologo
link.exe /OUT:helloworld.exe -nologo libvcruntime.lib libcmt.lib ucrt.lib kernel32.lib /MACHINE:X64 -subsystem:console -nodefaultlib helloworld.obj<p></p></code></pre><p class="MsoNormal">When compiled like the second instance, the binary uses the new C Runtime implementation from <em>ucrtbase </em>instead of the legacy <em>msvcrt</em>. While investigating the issue in <a href="https://ghidra-sre.org/"><em>Ghidra</em></a>, I realized that the definition of the function <a href="https://learn.microsoft.com/en-us/cpp/c-runtime-library/reference/fileno?view=msvc-170"><em>fileno</em></a><em> </em>is different between <em>msvcrt.dll </em>and <em>ucrtbase.dll</em>.
</p>
<pre><code class="language-plaintext">msvcrt!fileno
…
mov&nbsp;    eax, dword ptr [rcx+1Ch]
add&nbsp;    rsp, 38h
ret<p></p>
ucrtbase!_fileno:
…
mov&nbsp;    eax,dword ptr [rcx+18h]
add&nbsp;    rsp,28h
ret<p></p></code></pre><p class="MsoNormal">The offset of the <em>_file</em> attribute inside the FILE structure in <em>msvcrt.dll</em> is 0x1C and in<em> ucrtbase.dll&nbsp;</em>it is 0x18, which means that the FILE structures are not the same. This explains why the previous approach was not working, I was writing the<em> _file </em>and<em> _flag </em>values at the wrong offsets.
</p>
<p class="MsoNormal">I reverse engineered&nbsp;the definition of the FILE structure as it is used in <em>ucrtbase.dll</em>:
</p>
<pre><code class="language-plaintext">typedef struct _UCRTBASE_FILE {
/*0x00 0x08*/ PVOID&nbsp; _ptr;
/*0x08 0x08*/ PVOID&nbsp; _base;
/*0x10 0x04*/ UINT32 _cnt;
/*0x14 0x04*/ UINT32 _flags;
/*0x18 0x04*/ UINT32 _file;
/*0x1c 0x04*/ UINT32 _bufsiz;
/*0x20 0x08*/ PVOID&nbsp; _charbuf;
/*0x28 0x08*/ LPSTR&nbsp; _tmpfname;
/*0x30 0x28*/ CRITICAL_SECTION _lock;
} UCRTBASE_FILE, * PUCRTBASE_FILE;<p></p></code></pre><p class="MsoNormal">Just updating the FILE definition is not enough though, because the flags changed as well. After some debugging, I determined that the flags need to be 0x2402. Also, as per Window’s <a href="https://learn.microsoft.com/en-us/archive/msdn-magazine/2003/december/break-free-of-code-deadlocks-in-critical-sections-under-windows">documentation</a>, we need to set the <em>LockCount </em>attribute on the<em> _lock structure </em>to –1.
</p>
<p class="MsoNormal">Finally, I realized that I needed to call the function <em>_open_osfhandle</em>, which is defined at <em>ucrtbase.dll </em>instead of the old <em>msvcrt.dll</em>, for the redirection to work.
</p>
<p class="MsoNormal">With all these changes, I managed to reproduce the previous technique to a binary compiled with MSVC.
</p>
<div class="align-center media-default">
  
  
  <div class="field field--name-field-media-image field--type-image field--label-visually_hidden">
    <div class="field__label visually-hidden">Image</div>
              <div class="field__item">  <img src="/sites/default/files/2023-11/running_pes_inline_without_console_img_02_reproduce_previous_technique.png" width="386" height="103" alt="reproduce previous technique" loading="lazy" typeof="foaf:Image"></div>
          </div>

</div>
<p class="MsoNormal">
</p>
<h2>CMD

</h2>
<p class="MsoNormal">An important binary that I wanted to support is <em>cmd.exe</em>, which has its own set of challenges, because when one runs <em>cmd.exe /c whoami</em>, this is not the <em>cmd.exe</em> that resolves who the current user is, but the<em> whoami.exe </em>binary which is located at C:\Windows\System32\whoami.exe. So, we want to be able to obtain the output of the processes that <em>cmd.exe </em>creates.
</p>
<p class="MsoNormal">If we allocate a console and set the write handle of the pipe as the StandardOutput and StandardError, we actually do get the output of the <em>whoami.exe </em>process.
</p>
<pre><code class="language-plaintext">AllocConsole();
SetStdHandle(STD_OUTPUT_HANDLE, hPipeWrite);
SetStdHandle(STD_ERROR_HANDLE, hPipeWrite);<p></p></code></pre><p class="MsoNormal">This means that <em>cmd.exe</em> is indeed capable of communicating both the current console and our desired output handles to its child processes. However, what we want is<em> cmd.exe </em>to pass over our output handles without needing to allocate a console. To do this, we need to set the <em>ConsoleHandle </em>on the child processes to –1, indicating that there is no console allocated, only the output handles.
</p>
<p class="MsoNormal">To prepare the parameters that will be passed onto the new process, <em>CreateProcessW </em>will call <em>BasepCreateProcessParameters</em>. This function will read some values from an undocumented internal structure called <em>ConsoleConnectionState</em>, which is populated by <em>AllocConsole</em>. I have reverse engineered its fields:
</p>
<pre><code class="language-plaintext">typedef struct _CONSOLE_CONNECTION_STATE {
/*0x00 0x01*/ BYTE&nbsp;  Flags;
/*0x08 0x08*/ HANDLE ConsoleHandle;
/*0x10 0x08*/ HANDLE ConsoleReference;
/*0x18 0x08*/ HANDLE StandardInput;
/*0x20 0x08*/ HANDLE StandardOutput;
/*0x28 0x08*/ HANDLE StandardError;
/*0x30 0x01*/ BYTE&nbsp; IsConnected;
} CONSOLE_CONNECTION_STATE, * PCONSOLE_CONNECTION_STATE;
<p></p></code></pre><p class="MsoNormal">Now, let's see an illustrative code snippet from <em>BasepCreateProcessParameters </em>where the <em>ConsoleHandle </em>for the child process is set:
</p>
<pre><code class="language-plaintext">ChildProcParams-&gt;ConsoleHandle = ConsoleConnectionState.ConsoleReference;
if (ChildProcParams-&gt;ConsoleHandle == NULL) {
    ChildProcParams-&gt;ConsoleHandle = PEB-&gt;ProcessParameters-&gt;ConsoleHandle;
}<p></p></code></pre><p class="MsoNormal">The ConsoleHandle is set to <em>ConsoleConnectionState.ConsoleReference </em>and if that is NULL, then it is set to the ConsoleHandle of the current process.
</p>
<p class="MsoNormal">Meaning, we want the <em>ConsoleReference </em>to be NULL and our own ConsoleHandle to be –1. To put it even more simply, set the <em>ConsoleReference </em>to –1. The question is, how can we get the base address of this internal structure?
</p>
<p class="MsoNormal">To find it, I relied on a function called BaseGetConsoleReference, which returns the ConsoleReference, like so:
</p>
<pre><code class="language-plaintext">HANDLE BaseGetConsoleReference(void)
{
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return ConsoleConnectionState.ConsoleReference;
}</code></pre><p>
</p>
<p>
</p><p>But we do not care about the value of the ConsoleReference, we care about the address of the ConsoleConnectionState structure. So, I simply parsed the assembly of this function to find it.
</p>
<pre><code class="language-plaintext">48 8b 05 f9 94 19 00&nbsp;   mov&nbsp;   rax,QWORD PTR [rip+0x1994f9]
c3&nbsp;                              ret</code></pre><p>To obtain its address, we need to extract the offset used by the mov instruction, which in this case is 0x1994f9. Then we add the address of the ret instruction (this is because the function uses RIP-relative addressing). The result will be the address of the ConsoleReference, so to get the base of the entire structure, we just subtract the offset of the field, which is 0x10 bytes.
</p>
<p class="MsoNormal">Once we know where this structure is, we set the <em>ConsoleReference </em>to –1, set the StandardOutput and StandardError to the write handle of our pipe and we can now get the output of the commands we run via<em> cmd.exe</em>.</p>
<div class="align-center media-default">
  
  
  <div class="field field--name-field-media-image field--type-image field--label-visually_hidden">
    <div class="field__label visually-hidden">Image</div>
              <div class="field__item">  <img src="/sites/default/files/2023-11/running_pes_inline_without_console_img_03_console_reference.png" width="480" height="323" alt="console reference" loading="lazy" typeof="foaf:Image"></div>
          </div>

</div>
<p class="MsoNormal">
</p>
<h2>PowerShell

</h2>
<p class="MsoNormal">This project would not be complete without the ability to run PowerShell without a console.
</p>
<p class="MsoNormal">This is by far the most complicated piece of the puzzle, as the PowerShell process is intimately related to the console and decoupling them is no easy task.
</p>
<p class="MsoNormal">First, I allocated a console, and invalidated the <em>ConsoleHandle</em>.
</p>
<pre><code class="language-plaintext">AllocConsole();
SetStdHandle(STD_OUTPUT_HANDLE, hWrite);
SetStdHandle(STD_ERROR_HANDLE, hWrite);
PEB-&gt;ProcessParameters-&gt;ConsoleHandle = 0x123;<p></p></code></pre><p class="MsoNormal">After doing this, I got no output, which means that the PowerShell process truly needs the console to be valid, or we get no output.
</p>
<p class="MsoNormal">To understand exactly where the handle is used, I configured a hardware breakpoint on WinDbg that will break upon read access to the <em>ConsoleHandle</em>. The <em>ConsoleHandle </em>is stored in the <a href="https://www.vergiliusproject.com/kernels/x64/Windows%2011/22H2%20(2022%20Update)/_RTL_USER_PROCESS_PARAMETERS">ProcessParameters</a> structure, which is referenced by the <a href="https://www.vergiliusproject.com/kernels/x64/Windows%2011/22H2%20(2022%20Update)/_PEB">PEB</a>, so I got its address (which in my case, was 0xF1F40) and configured the hardware breakpoint, like so:
</p>
<pre><code class="language-plaintext">0:005&gt; ba r 8 0xF1F40 "k;g"<p></p></code></pre><p class="MsoNormal">Every time that a function reads the console handle, the stack trace is going to be printed on the screen and then it is going to continue executing.
</p>
<p class="MsoNormal">After a few seconds, I had the full list of functions that read the ConsoleHandle. After some cleaning up, I got the following list:
</p>
<ul><li class="MsoListParagraphCxSpFirst" style="mso-list:l3 level1 lfo1;">SetThreadUILanguage

</li>
<li class="MsoListParagraphCxSpMiddle" style="mso-list:l3 level1 lfo1;">SetThreadPreferredUILanguages2

</li>
<li class="MsoListParagraphCxSpMiddle" style="mso-list:l3 level1 lfo1;">GetConsoleCP

</li>
<li class="MsoListParagraphCxSpMiddle" style="mso-list:l3 level1 lfo1;">GetCurrentConsoleFontEx

</li>
<li class="MsoListParagraphCxSpMiddle" style="mso-list:l3 level1 lfo1;">GetConsoleMode

</li>
<li class="MsoListParagraphCxSpMiddle" style="mso-list:l3 level1 lfo1;">GetConsoleScreenBufferInfo

</li>
<li class="MsoListParagraphCxSpMiddle" style="mso-list:l3 level1 lfo1;">GetConsoleScreenBufferInfo

</li>
<li class="MsoListParagraphCxSpMiddle" style="mso-list:l3 level1 lfo1;">GetConsoleMode

</li>
<li class="MsoListParagraphCxSpMiddle" style="mso-list:l3 level1 lfo1;">SetConsoleMode

</li>
<li class="MsoListParagraphCxSpMiddle" style="mso-list:l3 level1 lfo1;">GetConsoleMode

</li>
<li class="MsoListParagraphCxSpMiddle" style="mso-list:l3 level1 lfo1;">GetConsoleMode

</li>
<li class="MsoListParagraphCxSpLast" style="mso-list:l3 level1 lfo1;">GetConsoleMode

</li>
</ul><p class="MsoNormal">Once I knew which functions used the ConsoleHandle, I patched them in memory and replaced them with my own dummy implementation, that did nothing and returned successfully.
</p>
<p class="MsoNormal">To be sure my modifications did not break the inner workings of PowerShell, I ran the following test:
</p>
<pre><code class="language-plaintext">AllocConsole();
SetStdHandle(STD_OUTPUT_HANDLE, hWrite);
SetStdHandle(STD_ERROR_HANDLE, hWrite);
patchKernelbase();<p></p></code></pre><p class="MsoNormal">After a few bug fixes, I managed to obtain the PowerShell output, which meant my dummy implementations were working properly. I then re-ran the previous test, but this time, I invalidated the ConsoleHandle:
</p>
<pre><code class="language-plaintext">AllocConsole();
SetStdHandle(STD_OUTPUT_HANDLE, hWrite);
SetStdHandle(STD_ERROR_HANDLE, hWrite);
patchKernelbase();
PEB-&gt;ProcessParameters-&gt;ConsoleHandle = 0x123;<p></p></code></pre><p class="MsoNormal">I was confident this was going to work, but to my surprise, it did not.
</p>
<p class="MsoNormal">I thought I was surely missing some API, so I re-ran the test with the previous hardware breakpoint and got zero hits, which meant no API was reading the <em>ConsoleHandle</em>. How can it be that modifying a memory address that no one reads breaks the output redirection? I figured WinDbg was missing a read somehow and decided to continue testing.
</p>
<p class="MsoNormal">Instead of invalidating the <em>ConsoleHandle </em>before running PowerShell, I decided to do it inside one of my dummy functions, which meant that the handle would be invalidated during the execution of PowerShell and not before.
</p>
<p class="MsoNormal">I tried this on all the dummy functions, one by one, and realized that some functions allowed me to invalidate the handle (meaning I managed to redirect the output) and some did not.
</p>
<p class="MsoNormal">After some cleanup, I ended up with the following list:
</p>
<ul><li><strong>X </strong>SetThreadUILanguage<strong>

<p></p></strong></li>
<li><strong>X </strong>SetThreadPreferredUILanguages2<strong>

<p></p></strong></li>
<li><strong>X </strong>GetConsoleCP<strong>

<p></p></strong></li>
<li><strong>✓ </strong>GetCurrentConsoleFontEx<strong>

<p></p></strong></li>
<li><strong>✓ </strong>GetConsoleMode<strong>

<p></p></strong></li>
<li><strong>✓ </strong>GetConsoleScreenBufferInfo<strong>

<p></p></strong></li>
<li><strong>✓ </strong>GetConsoleScreenBufferInfo<strong>

<p></p></strong></li>
<li><strong>✓ </strong>GetConsoleMode<strong>

<p></p></strong></li>
<li><strong>✓ </strong>SetConsoleMode<strong>

<p></p></strong></li>
<li><strong>✓ </strong>GetConsoleTitleW<strong>

<p></p></strong></li>
<li><strong>✓ </strong>GetConsoleMode<strong>

<p></p></strong></li>
<li><strong>✓ </strong>GetConsoleTitleW<strong>

<p></p></strong></li>
<li><strong>✓ </strong>GetConsoleMode<strong>

<p></p></strong></li>
<li><strong>✓ </strong>SetTEBLangID<strong>

<p></p></strong></li>
<li><strong>✓ </strong>SetConsoleTitleW<strong>

<p></p></strong></li>
<li><strong>✓ </strong>GetConsoleMode<strong>

<p></p></strong></li>
<li><strong>✓ </strong>SetThreadUILanguage<strong>

<p></p></strong></li>
<li><strong>✓ </strong>GetConsoleOutputCP<strong>

<p></p></strong></li>
<li><strong>✓ </strong>GetConsoleScreenBufferInfo<strong>

<p></p></strong></li>
<li><strong>✓ </strong>GetConsoleOutputCP<strong>

<p></p></strong></li>
<li><strong>✓ </strong>SetThreadUILanguage<strong>

<p></p></strong></li>
<li><strong>✓ </strong>GetConsoleOutputC

</li>
</ul><p class="MsoNormal">From the output above, it was evident that something had to be happening in between <em>GetConsoleCP </em>and <em>GetCurrentConsoleFontEx</em>. And if we analyze the stack trace for both these function calls, we learn that they are called by the same function:
</p>
<pre><code class="language-plaintext"># Child-SP RetAddr Call Site
00 KERNELBASE!GetConsoleCP
01 Microsoft_PowerShell_ConsoleHost_ni+0x71563
02&nbsp;Microsoft_PowerShell_ConsoleHost_ni!Microsoft.PowerShell.ConsoleControl.UpdateLocaleSpecificFont+0x24
...<p></p>
# Child-SP RetAddr Call Site
00 KERNELBASE!GetCurrentConsoleFontEx
01 Microsoft_PowerShell_ConsoleHost_ni+0x73912
02 Microsoft_PowerShell_ConsoleHost_ni!Microsoft.PowerShell.ConsoleControl.GetConsoleFontInfo+0x78
03 Microsoft_PowerShell_ConsoleHost_ni!Microsoft.PowerShell.ConsoleControl.UpdateLocaleSpecificFont+0x5a
...<p></p></code></pre><p class="MsoNormal" style="margin-bottom:12.0pt;">Interestingly, the code for <em>UpdateLocaleSpecificFont </em>is public and can be found&nbsp;<a href="https://github.com/microsoft/DbgShell/blob/master/DbgShell/ConsoleControl.cs#L2666">here</a>. The relevant code snippet is:</p>
<div class="align-center media-default">
  
  
  <div class="field field--name-field-media-image field--type-image field--label-visually_hidden">
    <div class="field__label visually-hidden">Image</div>
              <div class="field__item">  <img src="/sites/default/files/2023-11/running_pes_inline_without_console_img_04_updatelocalespecificfont.png" width="480" height="312" alt="updatelocalespecificfont" loading="lazy" typeof="foaf:Image"></div>
          </div>

</div>
<p class="MsoNormal" style="margin-bottom:12.0pt;">
</p>
<p class="MsoNormal">At the start, we can see the call to <em>GetConsoleCP</em>, and at the end, the call to <em>GetCurrentConsoleFontEx</em>. This means that the issue lies in whatever <em>GetActiveScreenBufferHandle </em>is doing.
</p>
<p class="MsoNormal">After we inspect its code, we learn that it calls this function right&nbsp;<a href="https://github.com/microsoft/DbgShell/blob/master/DbgShell/ConsoleControl.cs#L592-L615">here</a>:
</p>
<div class="align-center media-default">
  
  
  <div class="field field--name-field-media-image field--type-image field--label-visually_hidden">
    <div class="field__label visually-hidden">Image</div>
              <div class="field__item">  <img src="/sites/default/files/2023-11/running_pes_inline_without_console_img_05_consolehandle.png" width="480" height="242" alt="console handle" loading="lazy" typeof="foaf:Image"></div>
          </div>

</div>
<p class="MsoNormal">
</p>
<p class="MsoNormal">The documentation from <a href="https://learn.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-createfilea">CreateFile</a> reads:
</p>
<p class="MsoQuote" style="text-align:left;" align="left"><em>CONOUT$ gets a handle to the active screen buffer, even if </em><a href="https://learn.microsoft.com/en-us/windows/console/setstdhandle"><em>SetStdHandle</em></a><em> redirects the standard output handle.
</em></p>
<p></p>
<p class="MsoNormal">This actually makes a lot of sense. PowerShell is calling <em>CreateFile </em>with CONOUT$, which will end up calling <em>NtCreateFile</em>, which will be handled by the Windows kernel. Apparently, the kernel reads the <em>ConsoleHandle </em>of the calling process to service this call, which explains why the hardware breakpoint was not being triggered—it was being read from kernel-land.
</p>
<p class="MsoNormal">If the <em>ConsoleHandle </em>is invalid (which it is in our case), <em>CreateFile </em>fails and returns INVALID_HANDLE which will make <em>GetActiveScreenBufferHandle </em>throw a “HostException” which <em>UpdateLocaleSpecificFont </em>will not catch. This means that the call to CreateFile has to succeed if we want to be able to redirect PowerShell’s output.
</p>
<p class="MsoNormal">Now that we know which functions are important, let's discuss our options of how we can redirect the output of PowerShell without allocating a console.
</p>
<h3>Memory Patching

</h3>
<p class="MsoNormal">We already know that directly modifying the instructions from the functions that want to spoof works, but that would mean that memory scanners like <a href="https://github.com/forrest-orr/moneta">Moneta</a> would be able to detect the loader very easily.&nbsp;</p>
<div class="align-center media-default">
  
  
  <div class="field field--name-field-media-image field--type-image field--label-visually_hidden">
    <div class="field__label visually-hidden">Image</div>
              <div class="field__item">  <img src="/sites/default/files/2023-11/running_pes_inline_without_console_img_06_moneta.png" width="480" height="95" alt="moneta" loading="lazy" typeof="foaf:Image"></div>
          </div>

</div>
<p class="MsoNormal">
</p>
<p class="MsoNormal">So, we will leave this approach as a last resource.
</p>
<h3>IAT Hooking

</h3>
<p class="MsoNormal">A viable alternative is IAT hooking, which means that while loading the PowerShell binary, we do not resolve the addresses of the relevant APIs correctly. Instead, we set their addresses to our own implementations that will simply mimic the real ones.
</p>
<p class="MsoNormal">However, PowerShell does not directly import the functions that we need to hook, which means that traditional IAT hooking will not work. Nonetheless, I decided to dig deeper and try to understand how function address resolution works within PowerShell.
</p>
<p class="MsoNormal">I selected, at random, one of the functions that use the<em> ConsoleHandle (SetConsoleMode)</em> and configured a software breakpoint on it. Once it got hit, I got out of the current function to inspect the function that called it.
</p>
<pre><code class="language-plaintext">0:008&gt; bp KERNELBASE!SetConsoleMode
0:008&gt; g
Breakpoint 1 hit
KERNELBASE!SetConsoleMode:
00007ffc`f5477640 4053&nbsp;           push&nbsp;   rbx
0:008&gt; gu
Microsoft_PowerShell_ConsoleHost_ni+0x72d6e<p></p></code></pre><p class="MsoNormal">After some inspection, I determined how this function calls <em>SetConsoleMode</em>. This is done with the following instructions:
</p>
<pre><code class="language-plaintext">00007ffc`c6e82d08 4c8955c0&nbsp;        mov&nbsp;   qword ptr [rbp-40h], r10
…
00007ffc`c6e82d44 488b4dc0&nbsp;       mov&nbsp;    rcx, qword ptr [rbp-40h]
00007ffc`c6e82d48 488b4920&nbsp;       mov&nbsp;    rcx, qword ptr [rcx+20h]
00007ffc`c6e82d4c 488b01&nbsp;         mov&nbsp;    rax, qword ptr [rcx]
…
00007ffc`c6e82d6c ffd0&nbsp;           call&nbsp;   rax &lt;-- calls SetConsoleMode<p></p></code></pre><p class="MsoNormal">The register r10 contained a pointer to some unknown structure that stores the address of <em>SetConsoleMode</em>. We can replicate this on WinDbg to find the address where the pointer of <em>SetConsoleMode </em>is stored in memory.
</p>
<pre><code class="language-plaintext">0:007&gt; dq rbp-40h L 1
00000000`00cfe310&nbsp;00007ffc`c6e236a0 &lt;-- start of unknown struct
0:007&gt; dq 00007ffc`c6e236a0+20h L 1
00007ffc`c6e236c0&nbsp;00007ffc`c6e28490 &lt;-- pointer stored at offset 0x20
0:007&gt; dq 00007ffc`c6e28490 L 1
00007ffc`c6e28490&nbsp;00007ffc`f68356b0 &lt;-- address of SetConsoleMode
0:007&gt; u 00007ffc`f68356b0
KERNEL32!SetConsoleMode:
00007ffc`f68356b0 ff2532b50500&nbsp;   jmp&nbsp;   qword ptr [KERNEL32!_imp_SetConsoleMode (00007ffc`f6890be8)]<p></p></code></pre><p class="MsoNormal">Ok, so we now know that <em>0x7ffcc6e28490 </em>stores the address of <em>SetConsoleMode</em>. But who sets this memory address? To find that out, I once again used a hardware breakpoint, which triggered when someone writes to that address.
</p>
<p class="MsoNormal">After I reran everything with the hardware breakpoint set, I got a hit:
</p>
<pre><code class="language-plaintext">0:007&gt; ba w 8&nbsp;00007ffc`c6e28490
0:007&gt; g
Breakpoint 1 hit
clr!NDirectMethodDesc::SetNDirectTarget+0x3c<p></p></code></pre><p class="MsoNormal">This means that the NDirectMethodDesc function on the CLR (and not PowerShell) is the one who resolves the address of SetConsoleMode. The exact process of how the resolution works is not terribly important, so I will just explain the general idea behind it.
</p>
<p class="MsoNormal">The CLR calls clr!NDirect::NDirectLink, which obtains the address of the API by calling clr!NDirectMethodDesc::FindEntryPoint and saves it in the aforementioned structure by calling clr!NDirectMethodDesc::SetNDirectTarget. The function clr!NDirectMethodDesc::FindEntryPoint works by calling KERNEL32!GetProcAddressForCaller.
</p>
<p class="MsoNormal">We can observe how the CLR resolves the all the relevant functions in real time by setting a breakpoint on GetProcAddressForCaller and printing the second arguments as a string on each hit:
</p>
<pre><code class="language-plaintext">0:013&gt; bp kernelbase!GetProcAddressForCaller "da rdx;g"&nbsp;
0:013&gt; g&nbsp;
00007ffa`7229dff3 "GetConsoleTitle"&nbsp;
00000000`1ca7eb71 "GetConsoleTitleW"&nbsp;
00007ffa`7229e0ad "SetConsoleCtrlHandler"&nbsp;
00000000`03d3dbb1 "SetConsoleCtrlHandlerW"&nbsp;
00007ffa`75ce2af5 "GetStdHandle"&nbsp;
00007ffa`767c56ce "GetConsoleMode"&nbsp;
00007ffa`7229e003 "SetConsoleTitle"&nbsp;
00000000`1ca7eb81 "SetConsoleTitleW"
...<p></p></code></pre><p class="MsoNormal">Now that we have a decent understanding of how resolving the address of these functions works, can we abuse it somehow? The answer is yes, because when the CLR resolves the address of <em>SetConsoleMode </em>(or any other function), it stores the pointer in a region of memory that is RW (readable and writeable), meaning we can search for these pointers and replace them with our own.
</p>
<p class="MsoNormal">However, this approach is not straightforward given that we would need to find and modify these pointers while PowerShell is running, but only after they are resolved and before they are used. This complicates things quite a bit, so I decided to continue searching for other alternatives.
</p>
<h3>Hardware Breakpoints

</h3>
<p class="MsoNormal">Using hardware breakpoints would allow us to redirect the execution of any function without patching its memory (so memory scanners will not be a concern), but the main issue with this approach is that each thread only has 4 slots for hardware breakpoints, and we need to hook more than 10 functions.
</p>
<p class="MsoNormal">Given that the order in which the functions are called seems to be the same every time, we could simply set a hardware breakpoint in the first function and once it is called, unset it and set it in the second function and so on. This is feasible but also unnecessary, given that there is a better way.
</p>
<p class="MsoNormal">All the functions that we need to hook, except for <em>CreateFile</em>, are just a wrapper to a lower-level API called <a href="https://learn.microsoft.com/en-us/windows/win32/api/winternl/nf-winternl-ntdeviceiocontrolfile"><em>NtDeviceIoControlFile</em></a>. So instead of worrying about more than ten functions, we only need to worry about <em>NtDeviceIoControlFile </em>and <em>CreateFile</em>.
</p>
<p class="MsoNormal">The second issue is that we can only set hardware breakpoints on the main thread. PowerShell will create other threads which will not have any hardware breakpoint set.</p>
<p class="MsoNormal">Moreover, threads created by PowerShell do indeed read the <em>ConsoleHandle </em>as can be seen next (notice the call stack does not begin in unbacked memory from Beacon):
</p>
<pre><code class="language-plaintext"># Child-SP&nbsp;         RetAddr&nbsp;              Call Site
00 KERNELBASE!GetConsoleTitleInternal+0x67 &lt;-- function that reads the ConsoleHandle
01 KERNELBASE!GetConsoleTitleW+0x20
02 Microsoft_PowerShell_ConsoleHost_ni+0x72008
03 Microsoft_PowerShell_ConsoleHost_ni+0x5a9e8
04 Microsoft_PowerShell_ConsoleHost_ni+0x6d752
05 mscorlib_ni+0x588c87
06 mscorlib_ni+0x55fbe8
07 mscorlib_ni+0x55fad5
08 mscorlib_ni+0x589d01
09 mscorlib_ni+0x588dd1
0a mscorlib_ni+0x59ae56
0b clr!CallDescrWorkerInternal+0x83
0c clr!CallDescrWorkerWithHandler+0x47
0d clr!MethodDescCallSite::CallTargetWorker+0xfa
0e clr!QueueUserWorkItemManagedCallback+0x2a
0f clr!ManagedThreadBase_DispatchInner+0x33
10 clr!ManagedThreadBase_DispatchMiddle+0x83
11 clr!ManagedThreadBase_DispatchOuter+0x87
12 clr!ManagedThreadBase_FullTransitionWithAD+0x2f
13 clr!ManagedPerAppDomainTPCount::DispatchWorkItem+0x9a
14 clr!ThreadpoolMgr::ExecuteWorkRequest+0x51
15 clr!ThreadpoolMgr::WorkerThreadStart+0xe9
16 clr!Thread::intermediateThreadProc+0x8a
17 KERNEL32!BaseThreadInitThunk+0x14
18 ntdll!RtlUserThreadStart+0x21<p></p></code></pre><p class="MsoNormal">To deal with this, we could set a hardware breakpoint on <em>CreateThread </em>so that we can configure the new thread each time that function is called. Luckily, it turns out that is not necessary because these threads do not need to work at all to recover the output. We can let them fail safely and we still get our output back.
</p>
<p class="MsoNormal">So, I only needed to set a hardware breakpoint in <em>NtDeviceIoControlFile </em>and <em>CreateFile </em>on the main thread to successfully redirect the output for PowerShell.
</p>
<p class="MsoNormal">When I detect a call to <em>CreateFile</em>, I check the first parameter. If it is “CONOUT$”, I immediately return a value other than –1. If not, I let the execution continue.</p>
<p class="MsoNormal">If <em>NtDeviceIoControFile </em>is called instead, I check the first parameter. If it is the (fake) <em>ConsoleHandle</em>, I imitate the behavior of <em>NtDeviceIoControFile </em>when a console is present. If not, I let the execution continue.
</p>
<p class="MsoNormal">After all this, I successfully spoofed a console on PowerShell and redirected its output.
</p>
<div class="align-center media-default">
  
  
  <div class="field field--name-field-media-image field--type-image field--label-visually_hidden">
    <div class="field__label visually-hidden">Image</div>
              <div class="field__item">  <img src="/sites/default/files/2023-11/running_pes_inline_without_console_img_07_spoofed_console.png" width="480" height="239" alt="spoofed console" loading="lazy" typeof="foaf:Image"></div>
          </div>

</div>
<p class="MsoNormal">
</p>
<h3>Modifying the ConsoleHandle

</h3>
<p class="MsoNormal">Another idea that came to my mind that I wanted to share was setting the <em>ConsoleHandle </em>to a handle owned by my own loader. In theory, every time <em>NtDeviceIoControleFile </em>gets called, I would receive the message and answer it the same way the console would.
</p>
<p class="MsoNormal">However, according to Microsoft’s <a href="https://learn.microsoft.com/en-us/windows/win32/api/winternl/nf-winternl-ntdeviceiocontrolfile">documentation</a>, what this function does is:
</p>
<p class="MsoQuote" style="text-align:left;" align="left"><em>Builds descriptors for the supplied buffer(s) and passes the untyped data to the device driver associated with the file handle.
</em></p>
<p></p>
<p class="MsoNormal">The description is not terribly clear, but it means that this function allows processes to interact with a device driver which can be associated with a file, a USB, or in this case a console.
</p>
<p class="MsoNormal">In other words, <em>NtDeviceIoControFile </em>was not designed for inter-process communication, the syscall expects a handle to a device driver and not something like a pipe or a socket, so this option is not feasible, unless someone proves me wrong 😊.
</p>
<h2>Running PowerShell Multiple Times

</h2>
<p class="MsoNormal">An interesting caveat that I found during the development of this tool was that while the redirection for PowerShell worked perfectly the first time, all subsequent calls failed.
</p>
<div class="align-center media-default">
  
  
  <div class="field field--name-field-media-image field--type-image field--label-visually_hidden">
    <div class="field__label visually-hidden">Image</div>
              <div class="field__item">  <img src="/sites/default/files/2023-11/running_pes_inline_without_console_img_08_failed_calls.png" width="480" height="139" alt="failed calls" loading="lazy" typeof="foaf:Image"></div>
          </div>

</div>
<p class="MsoNormal">
</p>
<p class="MsoNormal">This turned out to be because I was creating a new anonymous pipe on each run and closing it upon cleanup. PowerShell caches the first handle it uses for standard output and when it gets closed, the output redirection breaks down.
</p>
<p class="MsoNormal">To counter that, I created the anonymous pipe once and reused it on all subsequent runs. To “remember” the pipe handles in between executions, I used the new key/value storage feature that Cobalt Strike launched in <a href="https://www.cobaltstrike.com/blog/cobalt-strike-49-take-me-to-your-loader">release 4.9</a>.
</p>
<div class="align-center media-default">
  
  
  <div class="field field--name-field-media-image field--type-image field--label-visually_hidden">
    <div class="field__label visually-hidden">Image</div>
              <div class="field__item">  <img src="/sites/default/files/2023-11/running_pes_inline_without_console_img_09_key_value_storage.png" width="480" height="111" alt="key value storage" loading="lazy" typeof="foaf:Image"></div>
          </div>

</div>
<p class="MsoNormal">
</p>
<p class="MsoNormal">Lastly, this blogpost would not be complete without a screenshot of mimikatz running:</p>
<div class="align-center media-default">
  
  
  <div class="field field--name-field-media-image field--type-image field--label-visually_hidden">
    <div class="field__label visually-hidden">Image</div>
              <div class="field__item">  <img src="/sites/default/files/2023-11/running_pes_inline_without_console_img_10_mimikatz.png" width="480" height="345" alt="mimikatz" loading="lazy" typeof="foaf:Image"></div>
          </div>

</div>
<p>&nbsp;</p>
<p class="MsoNormal">
</p>
<p class="MsoNormal">
</p>
<h2>Conclusion

</h2>
<p class="MsoNormal">This is a good example of how a deeper understanding of Windows internals can help us improve our tradecraft. While this loader is by no means undetectable, it empowers others to build upon it as I built on top of other people’s work while developing it.
</p>
<p class="MsoNormal">Each time we get mess with undocumented Windows structures and functions, we risk crashing in past and future Windows versions, given that they might change without a warning. Consider that before running this or any other tool on your Beacon, always test locally before running anything on your client’s network.
</p>
<p class="MsoNormal">Check out the tool that implements all of this <a href="https://github.com/fortra/No-Consolation">here</a>.
</p>
<p class="MsoNormal">Thank you for reading and happy hacking!
</p>
</div>
      </div>
              <div class="col-lg-4">
                  
      <div class="field field--name-field-author field--type-entity-reference field--label-hidden field__items">
              <div class="field__item">

<article data-history-node-id="104559" about="/profile/santiago-pecin" class="node node--type-author node--view-mode-teaser clearfix">
  <div class="node__content clearfix">
    <div class="node-content-container container">
      <div class="row">
        <div class="col-4">
            <div class="field field--name-field-media field--type-entity-reference field--label-hidden field__item">  <a href="/profile/santiago-pecin"><img loading="lazy" src="/sites/default/files/styles/thumbnail/public/2023-08/santiago-pecin-circle-outline.png?itok=FQjbSMpA" width="100" height="98" alt="Santiago Pecin" typeof="foaf:Image" class="image-style-thumbnail">

</a>
</div>
      </div>
        <div class="col-8 pl-0">
          <div class="block-title text-uppercase">Meet the Author</div>
          <h3 class="node__title"><a href="/profile/santiago-pecin" rel="bookmark"><span class="field field--name-title field--type-string field--label-hidden">Santiago Pecin </span>
</a></h3>
          
            <div class="field field--name-field-position-title field--type-string field--label-hidden field__item">Cybersecurity Consultant</div>
      
          
            <div class="field field--name-field-company field--type-string field--label-hidden field__item">Core Security, by Fortra</div>
      
        </div>
      </div>
      <div class="row">
        <div class="col-12">
          <div class="author-link">
            <a href="/profile/santiago-pecin" rel="bookmark">View Profile <span class="arrow right" aria-hidden="true"></span></a>
          </div>
        </div>
      </div>
    </div>
  </div>
</article>
</div>
          </div>
  
                  <div class="related-nodes">
                    
  <div class="field field--name-field-related-content field--type-entity-reference field--label-above">
    <div class="field__label">Related Content</div>
          <div class="field__items">
              <div class="field__item">

<article data-history-node-id="104762" about="/core-labs/articles/creating-processes-using-system-calls" typeof="schema:Article" class="node node--type-article node--promoted node--view-mode-related-content clearfix">
    <div class="node__content clearfix">
        <div class="node-content-container container">
            <div class="row">
                                    <div class="col-12">
                        <div class="node--type text-uppercase">Article</div>
                        <div class="node--title"><a href="/core-labs/articles/creating-processes-using-system-calls" rel="bookmark"><span property="schema:name" class="field field--name-title field--type-string field--label-hidden">Creating Processes Using System Calls</span>
</a></div>
                    </div>
                            </div>
        </div>
    </div>
</article>
</div>
          <div class="field__item">

<article data-history-node-id="104591" about="/core-labs/articles/writing-beacon-object-files-flexibie-stealthy-and-compatible" typeof="schema:Article" class="node node--type-article node--promoted node--view-mode-related-content clearfix">
    <div class="node__content clearfix">
        <div class="node-content-container container">
            <div class="row">
                                    <div class="col-12">
                        <div class="node--type text-uppercase">Article</div>
                        <div class="node--title"><a href="/core-labs/articles/writing-beacon-object-files-flexibie-stealthy-and-compatible" rel="bookmark"><span property="schema:name" class="field field--name-title field--type-string field--label-hidden">Writing Beacon Object Files: Flexible, Stealthy, and Compatible</span>
</a></div>
                    </div>
                            </div>
        </div>
    </div>
</article>
</div>
          <div class="field__item">

<article data-history-node-id="104560" about="/core-labs/articles/nanodump-red-team-approach-minidumps" typeof="schema:Article" class="node node--type-article node--promoted node--view-mode-related-content clearfix">
    <div class="node__content clearfix">
        <div class="node-content-container container">
            <div class="row">
                                    <div class="col-12">
                        <div class="node--type text-uppercase">Article</div>
                        <div class="node--title"><a href="/core-labs/articles/nanodump-red-team-approach-minidumps" rel="bookmark"><span property="schema:name" class="field field--name-title field--type-string field--label-hidden">Nanodump: A Red Team Approach to Minidumps </span>
</a></div>
                    </div>
                            </div>
        </div>
    </div>
</article>
</div>
              </div>
      </div>

                  </div>
              </div>
                </div>
    </div>
                 <div class="paragraph paragraph--type--section paragraph--view-mode--default section row text-color-default">
        <div class="col-sm-12">
      <div class="container">
                                           <div class="paragraph paragraph--type--cta paragraph--view-mode--default hs-page-cta">
        <h3 class="cta-headline">
       Interested in other Red Teaming techniques? 
    </h3>
    
  <div class="clearfix text-formatted field field--name-field-cta-text field--type-text-long field--label-visually_hidden">
    <div class="field__label visually-hidden">CTA Text</div>
              <div class="field__item"><p>Learn more in our article, <em>Writing Beacon Object Files: Flexible, Stealthy, and Compatible</em>.</p>
</div>
          </div>

    <a href="/core-labs/articles/writing-beacon-object-files-flexibie-stealthy-and-compatible" class="btn btn-primary">
      READ ARTICLE
    </a>
      </div>




              </div>
    </div>
  </div>




  </div>
</article>

    </div>
  </div>


              </main>
                                  </div>
        </div>
      </div>
<footer class="site-footer footer container-fluid">
        <div id="footer-center">
        <div class="region region-footer">
            <div class="container">
                <div class="row">
                    <div class="col-lg-2 text-left text-lg-center p-3 p-lg-0 pl-lg-4">
                        <a class="logo" href="https://www.fortra.com" title="Home">
                            <img src="https://static.fortra.com/fortra-global-assets/fortra-logo-full.svg?l=704278383">
                        </a>
                    </div>
                    <div class="col-lg-5 offset-lg-2 text-center">
                        <ul class="row icons" itemscope="" itemtype="http://schema.org/Organization">
                            <li class="col-md footer-icon"><a href="/node/100641" itemprop="email"><span class="icon"><img src="/themes/custom/coresecurity/images/Email-Icon.svg" alt="Email Core Security"></span>  <span class="text comm-links" id="comm-links-email">Email Us</span></a></li>
                            <li class="col footer-icon social tw"><a href="//twitter.com/CoreSecurity" class="toplink" target="_blank"><i class="icon fab fa-x-twitter" aria-hidden="true"></i><span class="text comm-links" id="comm-links-twitter">X</span> <span class="text sr-only">Find us on
                              Twitter</span></a></li>
                            <li class="col footer-icon social in"><a href="//www.linkedin.com/company/core-security-technologies/" class="toplink" target="_blank"><i class="icon fab fa-linkedin-in" aria-hidden="true"></i><span class="text comm-links" id="comm-links-linkedin-in">LinkedIn</span> <span class="text sr-only">Find us on
                              LinkedIn</span></a></li>
                            <li class="col footer-icon social fb"><a href="https://www.facebook.com/fortraofficial" class="toplink" target="_blank"><i class="icon fab fa-facebook-f" aria-hidden="true"></i><span class="text comm-links" id="comm-links-facebook-f">Facebook</span> <span class="text sr-only">Find us on
                              Facebook</span></a></li>
                            <li class="col footer-icon social fb"><a href="https://www.youtube.com/c/CoreSecurity" class="toplink" target="_blank"><i class="icon fab fa-youtube" aria-hidden="true"></i><span class="text comm-links" id="comm-links-facebook-f">YouTube</span> <span class="text sr-only">Find us on
                              YouTube</span></a></li>
                        </ul>

                    </div>

                </div>
                <div class="row footer-menu row-eq-height">
                    <div class="col-lg-3">
                        <h3><a href="/node/100002">Products</a></h3>
                        <ul class="list-unstyled">
                            <li><a href="/node/100082">Access Assurance Suite</a></li>
                            <li><a href="/node/100096">Core Impact</a></li>
                            <li><a href="/node/100101">Cobalt Strike</a></li>
                            <li><a href="/node/100027">Event Manager</a></li>
                            <li><a href="/node/100002">Browse All Products</a></li>
                        </ul>
                    </div>
                    <div class="col-lg-5 ">
                        <h3><a href="/products">Solutions</a></h3>
                        <div class="row">
                            <div class="col-md-6">
                                <ul class="list-unstyled">
                                    <li>
                                        <h4><a href="/node/100113">Identity Governance</a></h4>
                                    </li>
                                    <li><a href="/node/100083">PAM</a></li>
                                    <li><a href="/node/100084">IGA</a></li>
                                    <li><a href="/node/100115">IAM</a></li>
                                    <li><a href="/node/100105">Password Management</a></li>
                                    <li><a href="/node/100657">Vulnerability Management</a></li>
                                    <li><a href="/node/100090">Compliance</a></li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <ul class="list-unstyled">
                                    <li>
                                        <h4><a href="/node/100095">Cyber Threat</a></h4>
                                    </li>
                                    <li><a href="/node/100085">Penetration Testing</a></li>
                                    <li><a href="/node/100086">Red Team</a></li>
                                    <li><a href="/node/100089">Phishing</a></li>
                                    <li><a href="/node/100091">Threat Detection</a></li>
                                    <li><a href="/node/100029">SIEM</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-2">
                        <h3><a href="/resources">Resources</a></h3>
                        <ul class="list-unstyled">
                            <li><a href="/node/103338">Upcoming Webinars &amp; Events</a></li>
                            <li><a href="/node/103331">Corelabs Research</a></li>
                            <li><a href="/blog">Blog</a></li>
                            <li><a href="/support/training">Training</a></li>
                        </ul>
                    </div>
                    <div class="col-lg">
                        <h3><a href="/node/100006">About</a></h3>
                        <ul class="list-unstyled">
                            <li><a href="/node/100093">Our Company</a></li>
                            <li><a href="/node/100656">Partners</a></li>
                            <li><a href="//www.fortra.com/about/careers" target="_blank">Careers</a></li>
                            <li><a href="//www.fortra.com/about/accessibility" target="_blank">Accessibility</a></li>
                        </ul>
                    </div>
                </div>
                <div class="row copyright">
                    <div class="col">
                        <h3 class="d-inline-block"><a href="/node/100118">Support</a></h3>
                        <h3 class="d-inline-block"><a href="//www.fortra.com/privacy-policy" target="_blank">Privacy Policy</a></h3>
                        <h3 class="d-inline-block"><a href="/node/100641">Contact</a></h3>
                        <h3 class="d-inline-block"><a href="//www.fortra.com/impressum">Impressum</a></h3>
                        Copyright © Fortra, LLC and its group of companies. Fortra™, the Fortra™ logos, and other identified marks are proprietary trademarks of Fortra, LLC.
                    </div>
                </div>
            </div>
        </div>
    </div>
    </footer>
</div>
</div>

  </div>
 
        
        <script type="application/json" data-drupal-selector="drupal-settings-json">{"path":{"baseUrl":"\/","scriptPath":null,"pathPrefix":"","currentPath":"node\/105019","currentPathIsAdmin":false,"isFront":false,"currentLanguage":"en"},"pluralDelimiter":"\u0003","suppressDeprecationErrors":true,"user":{"uid":0,"permissionsHash":"e94b6066720c85c43a1e5af7f0ebbfe9a2d4d279fa75e8f88c98aaf8af328522"}}</script>
<script src="/sites/default/files/js/js_xhlKiHPsSGzeJtENwqnQGDweFh3BhZkzi1UfpEBWLMg.js?scope=footer&amp;delta=0&amp;language=en&amp;theme=coresecurity&amp;include=eJxljUEOwyAMBD9E4UmVAYdYdbBlmwO_b26VmuvsrMa3B16lgmOqIuFhoO8KZiRlsFTgl8dmmiM1MXRsyyj2_6ZgMO7r6aXbUuD8I3lNXZXJT-zPyJSO6cJOUA7iQMsNNEjmU71LH_8CrHVGeQ"></script>

    <script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","licenseKey":"NRJS-a139b6fb0a937cc4d2b","applicationID":"555092926","transactionName":"bwMDNUFYXRJWAUZZCVZJIAJHUFwPGBJTVwNnBQACW1w=","queueTime":0,"applicationTime":14,"atts":"Q0QAQwlCThw=","errorBeacon":"bam.nr-data.net","agent":""}</script><script defer="" src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon="{&quot;rayId&quot;:&quot;894278615dd84137&quot;,&quot;version&quot;:&quot;2024.4.1&quot;,&quot;token&quot;:&quot;af30e0d48dc3400bbe187fb185544ca7&quot;}" crossorigin="anonymous"></script>


<iframe style="display: none;" name="trustarc_notice" id="trustarcNoticeFrame" title="Trustarc Cross-Domain Consent Frame" src="https://consent.trustarc.com/get?name=crossdomain.html&amp;domain=helpsystems.com"></iframe><div id="pop-div016586614382150366" class="truste_overlay"></div><div id="pop-div20894952002628196" class="truste_box_overlay"><div id="pop-div3042464341895577495" class="truste_box_overlay_inner" tabindex="1" role="dialog" aria-modal="true" aria-label="Your choices regarding the use of cookies on this site"><style>false</style><div class="truste_box_overlay_border"></div><iframe src="https://consent-pref.trustarc.com?type=helpsystems_110322&amp;site=helpsystems.com&amp;country=pl&amp;action=advanced&amp;locale=en&amp;behavior=expressed&amp;gtm=1&amp;layout=default_eu&amp;privacypolicylink=https%3A%2F%2Fwww.helpsystems.com%2Fprivacy-policy&amp;cookieLink=https%3A%2F%2Fwww.helpsystems.com%2Fcookie-policy&amp;behaviorManager=eu&amp;irm=false&amp;from=https://consent.trustarc.com/&amp;session=8b94a3a5-da48-4590-9a5c-d29445d12614&amp;userType=NEW" id="pop-frame0066517609534255" title="TrustArc Cookie Consent Manager" tabindex="1" scrolling="no" class="truste_popframe" name="trustarc_cm"></iframe></div></div><script type="text/javascript" id="">var consentListeners=[];window.addConsentListenerTA=function(a){consentListeners.push(a)};var onConsentChange=function(a,b){consentListeners.forEach(function(c){c(a,b)})},__dispatched__={},__i__=self.postMessage&&setInterval(function(){if(self.PrivacyManagerAPI&&__i__){var a={PrivacyManagerAPI:{action:"getConsentDecision",timestamp:(new Date).getTime(),self:self.location.host}};self.top.postMessage(JSON.stringify(a),"*");__i__=clearInterval(__i__)}},50);
self.addEventListener("message",function(a,b){try{if(a.data&&(b=JSON.parse(a.data))&&(b=b.PrivacyManagerAPI)&&b.capabilities&&"getConsentDecision"==b.action){console.log("On consent changed!");var c=window.truste.util.readCookie("notice_behavior")||truste.eu.bindMap.behavior+","+truste.eu.bindMap.behaviorManager,d=window.truste.util.readCookie("cmapi_cookie_privacy")||"";onConsentChange(d,c);self.dataLayer&&self.dataLayer.push({event:"Consent Changed"});console.log("After On consent changed!")}}catch(e){}});</script></body></html>