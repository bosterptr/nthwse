<html lang="pl" data-platform-name="Firefox" data-platform-version="126.0" data-platform-layout="Gecko" data-platform-os="Windows 10 64-bit" data-platform-description="Firefox 126.0 on Windows 10 64-bit"><head itemscope="">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="/_static/css/app-shell.fb9807d7e7ed5c68076b.css" rel="stylesheet" type="text/css" data-type="app-shell">
            <link rel="shortcut icon" href="/_static/icon/favicon.240313eb651325fefc54.ico">
            <link rel="apple-touch-icon" href="/_static/icon/apple-touch-icon.e2b8d0f81880c3bda963.png">
        <link rel="manifest" href="/manifest.json" crossorigin="use-credentials">
                <meta property="og:site_name" class="contentMetaTag" content="Tech Blog">
    <title>Moduły PowerShell – wsparcie leniwego admina czy szwajcarski scyzoryk hakera</title>
    <meta property="og:title" class="contentMetaTag" content="Moduły PowerShell – wsparcie leniwego admina czy szwajcarski scyzoryk hakera">
    <meta name="description" class="contentMetaTag" content="W pierwszej części artykułu pokazywałem przykłady użycia powershella w automatyzacji, zaprezentowałem moduły i przedstawiłem ich możliwości wykorzystania. Teraz czas na kolejną porcje informacji o powershellu.&nbsp;">
    <meta name="keywords" class="contentMetaTag" content="test">
    <meta property="og:locale" class="contentMetaTag" content="pl_PL">
    <meta property="og:description" class="contentMetaTag" content="W pierwszej części artykułu pokazywałem przykłady użycia powershella w automatyzacji, zaprezentowałem moduły i przedstawiłem ich możliwości wykorzystania. Teraz czas na kolejną porcje informacji o powershellu. ">
    <meta property="twitter:description" class="contentMetaTag" content="W pierwszej części artykułu pokazywałem przykłady użycia powershella w automatyzacji, zaprezentowałem moduły i przedstawiłem ich możliwości wykorzystania. Teraz czas na kolejną porcje informacji o powershellu. ">
    <meta property="article:published_time" class="contentMetaTag" content="2022-10-26T00:00:00">
    <meta property="article:modified_time" class="contentMetaTag" content="2022-10-26T10:47:11.552">
    
    <meta name="robots" class="contentMetaTag" content="index, follow, noodp, noydir">
    <link rel="canonical" class="contentMetaTag" href="https://techblog.ing.pl/blog/moduly-powershell-wsparcie-leniwego-admina-czy-szwajcarski-scyzoryk-hakera-czesc2">
    <meta name="google-site-verification" content="Ogv2Msh-I1oI9Kd3QK6JqZjy7GUB47-XWg3ZMqJPS4M" class="contentMetaTag">



        <link data-type="component" data-id="/blog/moduly-powershell-wsparcie-leniwego-admina-czy-szwajcarski-scyzoryk-hakera-czesc2" rel="stylesheet" type="text/css" href="/_static/css/comp/comp-content.a566bd646a434d16477a.css">
        <link data-type="component" data-id="/blog/moduly-powershell-wsparcie-leniwego-admina-czy-szwajcarski-scyzoryk-hakera-czesc2" rel="stylesheet" type="text/css" href="/_static/css/comp/comp-breadcrumbs.ec0af211211a62d537be.css">
        <link data-type="component" data-id="/blog/moduly-powershell-wsparcie-leniwego-admina-czy-szwajcarski-scyzoryk-hakera-czesc2" rel="stylesheet" type="text/css" href="/_static/css/comp/comp-page_title.002bd6f0b134ebfd3352.css">
        <link data-type="component" data-id="/blog/moduly-powershell-wsparcie-leniwego-admina-czy-szwajcarski-scyzoryk-hakera-czesc2" rel="stylesheet" type="text/css" href="/_static/css/comp/comp-related_articles.6986b5a6849912b62865.css">
        <link data-type="component" data-id="/blog/moduly-powershell-wsparcie-leniwego-admina-czy-szwajcarski-scyzoryk-hakera-czesc2" rel="stylesheet" type="text/css" href="/_static/css/comp/comp-this_article_tags.eca5dcf66ab404f123e9.css">
        <link data-type="component" data-id="/blog/moduly-powershell-wsparcie-leniwego-admina-czy-szwajcarski-scyzoryk-hakera-czesc2" rel="stylesheet" type="text/css" href="/_static/css/comp/comp-floating_menu_right.9f7d3b0387155672af2e.css">
        <link data-type="header" data-id="1500057.23e2437e85badea5acc2f33b37c8c5dc115fc2f520b6a744a8b118fb0d76402b" rel="stylesheet" type="text/css" href="/_static/css/header.51fcb589883afe414c3c.css">
        <link data-type="footer" data-id="1500019.56896b9fcf4f28cde2bdcf2032ce2f44c618c4ae71d0c5d03494a1aa9393143a" rel="stylesheet" type="text/css" href="/_static/css/footer.a7e57726b71847e402b8.css">
        <link data-type="template" data-id="1500004.edd99fc91705e9259eb508743cec30254c512c6ef8044abbcaea4e32fce6f670" rel="stylesheet" type="text/css" href="/_static/template-manager/ingbank/css/vs.21a874f8da74847aa749.css">
    <link data-id="/_api/core/user-component/tab_layout_search_header.7e5ce97ee30c9769694557153d3215d7df6ab3c60d789919689cebd5c0c9ef63" data-type="user-component" rel="stylesheet" type="text/css" loaded="yes" crossorigin="anonymous" href="/_static/user-component/tab_layout_search_header/tab_layout_search_header.068e5a606d772ecbfcef.css"><script src="https://techblog-ing.disqus.com/embed.js" data-name="disqusScript" data-timestamp="1718453105245"></script></head>
    <body class="size_large">
        <script async="" src="https://www.googletagmanager.com/gtm.js?id=GTM-WW6KXX2"></script><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-WW6KXX2');</script><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WW6KXX2" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
        <main id="site-wrapper">
            <div id="content-wrapper" data-resource-id="1500004.edd99fc91705e9259eb508743cec30254c512c6ef8044abbcaea4e32fce6f670" data-prerendering="true" data-rules="[]">
                    <div id="outlet-header" class="outlet outlet-header" data-resource-id="1500057.23e2437e85badea5acc2f33b37c8c5dc115fc2f520b6a744a8b118fb0d76402b">
                        <div class="layout_section header_section layout_element">
 <div class="layout_container layout_element">
  <div class="layout_row row layout_element">
   <div class="layout_column col-xs-12 col-sm-12 col-md-12 col-lg-12 layout_element">
    <div class="component header" data-component-type-code="header"> 
     <div class="header--techblog"> 
      <div class="logo-group"> 
       <div class="right_part"> 
        <div class="login_panel"> 
         <div class="box_inner"> 
          <div class="header_icons"> 
           <div class="right"> 
            <span class="menu_icon"> <span class="icon_menu"></span> </span> 
           </div> 
           <div class="clearFix">
            &nbsp;
           </div> 
          </div> 
         </div> 
        </div> 
       </div> 
       <div class="left"> 
        <div class="logo"> 
         <a href="/" class="logo-image" aria-label="Tech Blog - Przejdź do strony głównej"><img src="/_fileserver/item/1100100.9a14ac40f75d10c88d424701eb8ac4bf840b00627eb6c4585aa59fe6f60fc7c6" alt="ING Bank Śląski S.A. - logotyp"> <p>Tech Blog</p> </a> 
        </div> 
       </div> 
       <div class="submenu"> 
        <div class="additives"> 
         <div class="searchbar"> 
          <cms-user-component src="/_api/core/user-component/tab_layout_search_header.7e5ce97ee30c9769694557153d3215d7df6ab3c60d789919689cebd5c0c9ef63" class="js-cms-userComponent cms-userComponent" loaded="yes"><!----><div class="content_area"><!----><div class="search_box">
  <div class="decor">
    <div class="underline">
    <a href="javascript:fn.SiteSearchValidator.submitSearchForm('site-search-form-mini');" class="search_btn"><span>Szukaj</span></a>
    <form id="site-search-form-mini" action="javascript:fn.SiteSearchValidator.submitSearchForm('site-search-form-mini');">
      <input name="q" class="search_field" placeholder="Wyszukaj">
        </form>
    </div>
  </div>
</div>
<!----></div><!----></cms-user-component> 
          <div class="social_icons" role="navigation" aria-label="media społecznościowe"> 
           <ul> 
            <li class="social_icon_twitter"><a class="gtm-social-icon-twitter" target="_blank" rel="noopener noreferrer" href="https://twitter.com/INGBankSlaski">Twitter</a></li> 
            <li class="social_icon_meetup"><a class="gtm-social-icon-meetup" target="_blank" rel="noopener noreferrer" href=" https://www.meetup.com/pl-PL/Enterprise-Tech-Solutions-Meetup/">Enterprise Tech Solutions Meetup</a></li> 
            <li class="social_icon_rss"><a class="gtm-social-icon-rss" target="_blank" rel="noopener noreferrer" href="/rss">RSS Feed</a></li> 
           </ul> 
          </div> 
         </div> 
        </div> 
        <div class="clearFix">
         &nbsp;
        </div> 
        <div class="navi_panel"> 
         <cms-menu src="/_api/core/menu/menu-nawigacyjne.438e15b5e58e6d922e96c3a3949818738807ea07a09f72d0ad5b2ab253f6ef4b" class="js-cms-cmsMenu cms-cmsMenu" loaded="yes"><!---->
        <ul class="menu_list">
        <!---->
            <li class="node ">
                
            <a href="https://techblog.ing.pl/o-nas" class="" aria-current="false">
                
        <span class="cms-menu__label"><!---->O nas<!----></span>
    
            </a>
        
                
            </li>
        <!---->
            <li class="node ">
                
            <a href="https://www.ing.pl/pionteching" class="" aria-current="false">
                
        <span class="cms-menu__label"><!---->Oferty pracy<!----></span>
    
            </a>
        
                
            </li>
        <!---->
            <li class="node ">
                
            <a href="https://techblog.ing.pl/it-women" class="" aria-current="false">
                
        <span class="cms-menu__label"><!---->Podcast BreakIT Girls<!----></span>
    
            </a>
        
                
            </li>
        <!---->
            <li class="node ">
                
            <a href="https://techblog.ing.pl/techmeeting" class="" aria-current="false">
                
        <span class="cms-menu__label"><!---->Tech MeetING<!----></span>
    
            </a>
        
                
            </li>
        <!---->
        </ul>
    <!----></cms-menu> 
        </div> 
        <div class="quick_links"> 
        </div> 
       </div> 
      </div> 
      <div class="header_underlayer"></div> 
     </div> 
     <div class="clearFix">
      &nbsp;
     </div> 
    </div>
   </div>
  </div>
 </div>
</div>
                    </div>
                    <div id="outlet-content" data-content-status="page" class="outlet outlet-content pageTransitionOut" data-resource-id="/blog/moduly-powershell-wsparcie-leniwego-admina-czy-szwajcarski-scyzoryk-hakera-czesc2">
                        <div class="layout_element layout_section">
 <div class="layout_element layout_container">
  <div class="layout_element layout_row row">
   <div class="layout_element layout_column col-xs-12 col-sm-12 col-md-12 col-lg-12">
    <div id="component_wrapper_1403325339" class="layout_element component_wrapper wrapped_breadcrumbs">
     <div class="component breadcrumbs component_1403325339" data-component-id="1403325339" data-component-type-code="breadcrumbs" data-js-parameters="{&quot;getAjaxComponentUrl&quot;:&quot;/_api/ds/ingrwd-lds/component_action?component.action\u003dget_ajax_component\u0026component.id\u003d1403325339\u0026component.site\u003dQLmeEYC8HoCjSlYxcQoUUw\u003d\u003d&quot;}" id="breadcrumbs_1_13032019"><nav class="breadcrumbs__inner" itemscope="" itemtype="https://schema.org/BreadcrumbList" aria-label="nawigacja okruszkowa"><ul><li itemprop="itemListElement" itemscope="" itemtype="https://schema.org/ListItem"><a class="home" itemprop="item" aria-label="Strona główna" href="/"><span itemprop="name">Strona główna</span></a><meta content="1" itemprop="position"></li><li class="breadcrumb_item" itemprop="itemListElement" itemscope="" itemtype="https://schema.org/ListItem"><a itemprop="item" class="breadcrumb_element" href="/blog"><span itemprop="name">Tech Blog ING Bank Śląski</span></a><meta itemprop="position" content="2"></li><li class="breadcrumb_item" itemprop="itemListElement" itemscope="" itemtype="https://schema.org/ListItem"><a itemprop="item" aria-current="page" class="breadcrumb_element current_element" href="/blog/moduly-powershell-wsparcie-leniwego-admina-czy-szwajcarski-scyzoryk-hakera-czesc2"><span itemprop="name">Moduły PowerShell – wsparcie leniwego admina czy szwajcarski scyzoryk hakera - część 2</span></a><meta itemprop="position" content="3"></li></ul></nav><div class="clearFix"></div></div>
    </div>
   </div>
  </div>
 </div>
</div>
<div class="layout_element layout_section">
 <div class="layout_element layout_container">
  <div class="layout_element no_border layout_row row floating-rightmenu-container">
   <div class="layout_element layout_column col-xs-12 col-sm-12 col-md-8 col-lg-8">
    <div id="component_wrapper_1403325341" class="layout_element component_wrapper wrapped_page_title">
     <div class="component page_title component_1403325341" data-component-id="1403325341" data-component-type-code="page_title" data-js-parameters="{}" id="page_title_1_16032019"> 
      <h1>Moduły PowerShell – wsparcie leniwego admina czy szwajcarski scyzoryk hakera - część 2</h1> 
     </div>
    </div>
    <div id="component_wrapper_1403325338" class="layout_element component_wrapper wrapped_content">
     <div class="component content component_1403325338" data-component-id="1403325338" data-component-type-code="content" data-js-parameters="{}" id="content_1_13032019"> 
      <div class="content_area" id="1403325338"> 
       <p class="dateCreated single-article">26.10.2022 | <img alt="" src="/_fileserver/item/w6zfzqt.1d93470f57c21e4c05b32d1a3cbf37fbb11937c99accdc137d730f49b541e021" style="height:50px; width:50px"> <a aria-label="" href="/bartosz-chalek">Bartosz Chałek</a></p> 
      </div> 
     </div>
    </div>
    <div id="component_wrapper_1403325346" class="layout_element component_wrapper wrapped_this_article_tags">
     <div class="component this_article_tags component_1403325346" data-component-id="1403325346" data-component-type-code="this_article_tags" data-js-parameters="{}" id="this_article_tags_1_13032019"> 
      <div class="this_article_tags__list"> 
       <a class="this_article_tags__anchor" href="/blog?tag=powershell">PowerShell</a> 
      </div> 
     </div>
    </div>
    <div id="component_wrapper_1403325344" class="layout_element component_wrapper wrapped_content">
     <div class="component content component_1403325344" data-component-id="1403325344" data-component-type-code="content" data-js-parameters="{}" id="wstep"> 
      <div class="content_area" id="1403325344"> 
       <p style="text-align:justify"><strong>Wstęp</strong></p> 
       <p style="margin-bottom:11px">W pierwszej części artykułu pokazywałem przykłady użycia powershella w automatyzacji, zaprezentowałem moduły i przedstawiłem ich możliwości wykorzystania. Teraz czas na kolejną porcje informacji o powershellu.&nbsp;</p> 
       <p style="margin-bottom:11px">&nbsp;</p> 
      </div> 
     </div>
    </div>
    <div id="component_wrapper_1403325342" class="layout_element component_wrapper wrapped_content">
     <div class="component content component_1403325342" data-component-id="1403325342" data-component-type-code="content" data-js-parameters="{}" id="moduly-importowane"> 
      <div class="content_area" id="1403325342"> 
       <p style="margin-bottom:11px"><strong>Moduły importowane domyślnie</strong></p> 
       <p>Jak wcześniej wspomniałem moduł PSReadLine jest wczytywany domyślnie z katalogu C:\Program Files\WindowsPowerShell\Modules przy każdym uruchomieniu konsoli. &nbsp;Co&nbsp;jeśli jednak skopiujemy taki moduł do katalogu modułów naszego użytkownika?</p> 
       <p><img alt="" src="/_fileserver/item/jjlpeu8.8f195aedcf7908b89c992784a41dd1608b2743f9184a99469b1067fd6ddd4fea" style="height:163px; width:510px"></p> 
       <p style="margin-bottom:11px">Źródło: opracowanie własne</p> 
       <p style="margin-bottom:11px">&nbsp;</p> 
       <p>Wygląda ciekawie, ale z jakiegoś powodu powershell nie był w stanie go zaimportować…Tylko dlaczego? Pozwala nam to odkryć komenda Import-Module PSReadLine:</p> 
       <p><img alt="" src="/_fileserver/item/rywfazd.5ac28d2d39ddd9430d21f1884051897a2409e58f5451d886bdf3d4e8585ba304" style="height:115px; width:560px"></p> 
       <p style="margin-bottom:11px">Źródło: opracowanie własne</p> 
       <p style="margin-bottom:11px">&nbsp;</p> 
       <p>Jak widać występuje problem z wczytaniem pewnych plików modułu. Sprawdźmy co stanie się jeśli uruchomimy powershella z flagą –ExecutionPolicy Bypass?</p> 
       <p><img alt="" src="/_fileserver/item/eeqgi0v.982f4d639667a0f3eca95b975833f3e25cbfb6ef3f3170e5b9b77296ca040a89" style="height:153px; width:560px"></p> 
       <p style="margin-bottom:11px">Źródło: opracowanie własne</p> 
       <p style="margin-bottom:11px">&nbsp;</p> 
       <p>Jak widać moduł został nie tylko wczytany poprawnie , ale pomimo że znajduje się on też w katalogu C:\Program Files\WindowsPowerShell\Modules to został wczytany z katalogu użytkownika.</p> 
       <p>Jeśli jednak mamy uruchamiać to z flagą bypass, to równie dobrze moglibyśmy zawrzeć to w plikach profile. Spróbujmy więc doprowadzić do sytuacji kiedy moduł PSReadline zostanie wczytany bez niej.</p> 
       <p>Skoro błąd występuje przy imporcie pliku PSReadLine.format.ps1xml to spróbujmy go usunąć – ważne, żeby usunąć go również z pliku psd1 zawierającego deskryptor modułu:</p> 
       <p><img alt="" src="/_fileserver/item/gnecc5h.2a3c526918aafff932b44b7261af8e77d0800249ff94954af0d32551365b125b" style="height:323px; width:560px"></p> 
       <p>Źródło: opracowanie własne</p> 
       <p>&nbsp;</p> 
       <p><img alt="" src="/_fileserver/item/nctfklz.1f55d3c82117557ee8796ee08560a9a6f4cec3859f1734818432664553882718" style="height:110px; width:560px"></p> 
       <p>Źródło: opracowanie własne</p> 
       <p>&nbsp;</p> 
       <p style="margin-bottom:11px">Niestety moduł w dalszym ciągu nie importuje się poprawnie ze względu na blokadę pliku PSReadLine.psm1.&nbsp;Analogicznie jak wcześniej spróbujmy go usunąć:</p> 
       <p style="margin-bottom:11px"><img alt="" src="/_fileserver/item/xyzrofd.72fd4ef3634b57900b8ab5799cb685a2f063bbf59bf371539b76ca553623ede9" style="height:114px; width:560px"></p> 
       <p style="margin-bottom:11px">Źródło: opracowanie własne</p> 
       <p>&nbsp;</p> 
       <p>Jak widać udało się poprawnie wczytać moduł, a ponowne uruchomienie powershella wskazuje, że został on automatycznie załadowany. Zerkając do proces hackera można zobaczyć w modułach procesu, że wczytana została biblioteka z katalogu użytkownika:</p> 
       <p><img alt="" src="/_fileserver/item/bo5sgvl.458b7b9d1fcbeb3c6b8ebe2d8b384aeb6f85c8d3da9218eb5a9dca1f08bc2420" style="height:326px; width:560px"></p> 
       <p style="margin-bottom:11px">Źródło: opracowanie własne</p> 
       <p>&nbsp;</p> 
       <p>W tym miejscu warto się zatrzymać i zastanowić co nam to da? Jeżeli użytkownik wejdzie na dowolny inny komputer, jego profil zostanie wczytany, a następnie uruchomi konsolę powershella, to do pamięci procesu zostanie wczytana przygotowana przez nas biblioteka. Nie oznacza to jednak jeszcze uruchomienia jakiegokolwiek polecenia z tej biblioteki.</p> 
       <p>Szukając w internecie informacji o modułach powershella za pośrednictwem bibliotek dll, znalazłem ciekawy artykuł mówiący o istnieniu kilka klas i interfejsów, które są automatycznie uruchamiane przy imporcie biblioteki modułu. Te klasy to:</p> 
       <ul> 
        <li>CmdletProvider</li> 
        <li>DriveCmdletProvider</li> 
        <li>IModuleAssemblyInitializer</li> 
       </ul> 
       <p>Implementując swoją „złośliwą” bibliotekę zawierającą klasy dziedziczące po tych obiektach, jesteśmy w stanie wyzwolić swój kod już na etapie importu takiej biblioteki.</p> 
       <p>Spróbujmy przygotować przykładową klasę zawierającą „złośliwy kod”:</p> 
       <p><img alt="" src="/_fileserver/item/cblt9j9.7a3e03adcf3aa72d1e9820fe6e1f2c284899d59564eeddf507509dca7e886e34" style="height:311px; width:560px"></p> 
       <p>Źródło: opracowanie własne</p> 
       <p>&nbsp;</p> 
       <p><img alt="" src="/_fileserver/item/rbbrnks.a6f1391116a3e5b4de5157a6506899eb4ab89be318061c585d0ecc93b3857c4a" style="height:131px; width:560px"></p> 
       <p>Źródło: opracowanie własne</p> 
       <p>&nbsp;</p> 
       <p><img alt="" src="/_fileserver/item/s8dtp6b.bf026592eb7f6c682612c20533cf0b50407e5fcb2425f0d4ac8c6e9cea050215" style="height:392px; width:560px"></p> 
       <p>Źródło: opracowanie własne</p> 
       <p>&nbsp;</p> 
       <p style="margin-bottom:11px"><span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.5pt"><span style="line-height:107%"><span style="font-family:&quot;ING Me&quot;">Sukces! Udało się wykonać nasz złośliwy kod przy uruchomieniu procesu.</span></span></span></span></span></span></p> 
       <p style="margin-bottom:11px">&nbsp;</p> 
       <p style="margin-bottom:11px">Zatrzymajmy się teraz po raz drugi. Uruchamiając interaktywnie konsolę wczytujemy naszą bibliotekę, a następnie wykonujemy kawałek naszego kodu. Co jeśli powershell zostanie uruchomiony z parametrem –Command albo –File, albo jeśli ktoś uruchomi np. Powershell ISE?</p> 
       <p>Niestety, ale moduł PSReadline uruchamiany jest tylko w przypadku otwarcia interaktywnej konsoli. W przypadku powershell ise domyślnie wczytywanym modułem jest moduł ISE, który z kolei znajduje się w katalogu:</p> 
       <p><img alt="" src="/_fileserver/item/hyg1njd.79d27e00f507afb7553ddbb80ebefca80887798b0dabae0a20f843ec0734a16d" style="height:64px; width:560px"></p> 
       <p style="margin-bottom:11px">Źródło: opracowanie własne</p> 
       <p>&nbsp;</p> 
       <p>Co ciekawe, analogicznie jak w przypadku psreadline, przeniesienie modułu ISE do katalogu użytkownika pozwala na zastąpienie tego modułu naszym potencjalnie złośliwym:</p> 
       <p><img alt="" src="/_fileserver/item/y0q0omg.eb3e418185f20867dab21666217490a8fdf4ea364466483894172d9d6f4a4d0c" style="height:376px; width:560px"></p> 
       <p style="margin-bottom:11px">Źródło: opracowanie własne</p> 
       <p>&nbsp;</p> 
       <p>Jednak w dalszym ciągu wymagana jest interakcja użytkownika. Jak napisałem na początku artykułu, powershell jest używany przez wielu administratorów do automatyzacji wykonywanych operacji na komputerze np. do weryfikacji konfiguracji środowiska, przeprowadzenia automatycznych akcji, diagnostyki systemu itp. itd.</p> 
       <p>W takim razie może istnieją moduły, które są wczytywane zawsze i automatycznie tak jak PSReadLine i ISE? W tym celu trzeba zobaczyć jak mechanizm modułów działa. W procesie weryfikujemy biblioteki wczytane wraz z procesami powershell.exe i powershell_ise.exe. Warto zwrócić uwagę na bibliotekę System.Management.Automation.dll</p> 
       <p>Przy pomocy narzędzia <a aria-label="" href="https://github.com/dnSpy/dnSpy">dnSpy</a> dekompilujemy ją:</p> 
       <p><img alt="" src="/_fileserver/item/fgcblv8.b7d459975365f29d6e215060fa2ec55b915e873784b6597f7bbe7eb71ba9792f" style="height:149px; width:560px"></p> 
       <p style="margin-bottom:11px">Źródło: opracowanie własne</p> 
       <p>&nbsp;</p> 
       <p>Jest to biblioteka napisana we .Net Frameworku, więc możemy podejrzeć jej kod oraz w łatwy sposób ją debugować. Poniżej zwrócę jednak uwagę na kilka ciekawych punktów w analizie flow importu.</p> 
       <p>W obiekcie System.Management.Automation.Runspaces.InitialSessionState można znaleźć informację o domyślnych metodach, dozwolonych wbudowanych aliasach i domyślnych modułach.</p> 
       <p>W obiekcie Microsoft.PowerShell.Commands.ModuleCmdletBase znajduje się wczytywanie modułu w zależności od rozszerzenia.</p> 
       <p>Na podstawie analizy działania można zauważyć kilka potencjalnie interesujących domyślnych modułów:</p> 
       <p><img alt="" src="/_fileserver/item/1pqmze2.a82dd7af9b3aef4794a73d4b521311e652831d981a3a3d9316374ae84597a06a" style="height:104px; width:450px"></p> 
       <p style="margin-bottom:11px">Źródło: opracowanie własne</p> 
       <p style="margin-bottom:11px">&nbsp;</p> 
       <p style="margin-bottom:11px"><img alt="" src="/_fileserver/item/wmkzrz2.1ea1a06321241e41bb56261c292686221b70be6293916203825fed922e7f47e7" style="height:356px; width:560px"></p> 
       <p style="margin-bottom:11px">Źródło: opracowanie własne</p> 
       <p style="margin-bottom:11px">&nbsp;</p> 
       <p style="margin-bottom:11px">Warto w tym miejscu spojrzeć do plików psd1 tych modułów, żeby określić ich funkcjonalności. Na podstawie liczby funkcjonalności warto zwrócić uwagę na 3 moduły:</p> 
       <p style="margin-bottom:11px"><img alt="" src="/_fileserver/item/ciaelli.0c365508a97eaf02bfa0fb542c6743477fcea634f22e605356e6ba8f06174b37" style="height:158px; width:560px"></p> 
       <p style="margin-bottom:11px">Źródło: opracowanie własne</p> 
       <p style="margin-bottom:11px">&nbsp;</p> 
       <p style="margin-bottom:11px">Są to moduły bazowe, więc ich całkowita podmiana może zaburzyć ich działanie. &nbsp;W związku z tym zamiast podmieniać bibliotekę zawierającą implementację komend, warto dodać w pliku psd1 dodatkową złośliwą bibliotekę (tą którą przygotowaliśmy i użyliśmy w przykładzie PSReadLine):</p> 
       <p style="margin-bottom:11px"><img alt="" src="/_fileserver/item/ycqxghe.5bb48cbd90a323e13c85a026b40d3d3313e175fe7099c2c694dc588a5000065b" style="height:528px; width:560px"></p> 
       <p style="margin-bottom:11px">Źródło: opracowanie własne</p> 
       <p style="margin-bottom:11px">&nbsp;</p> 
       <p style="margin-bottom:11px"><img alt="" src="/_fileserver/item/y4znpo2.0b92951e3489e9b4de651f3277af653aa3093c1629d8b400c691e69e909f9e2d" style="height:424px; width:560px"></p> 
       <p style="margin-bottom:11px">Źródło: opracowanie własne</p> 
       <p style="margin-bottom:11px">&nbsp;</p> 
       <p style="margin-bottom:11px"><img alt="" src="/_fileserver/item/fwp4krs.cc3dca22d183639ba0357f8b636ac68b7a5d779375a99b8963d4ff36c2c98c0e" style="height:308px; width:560px"></p> 
       <p style="margin-bottom:11px">Źródło: opracowanie własne</p> 
       <p style="margin-bottom:11px">&nbsp;</p> 
       <p style="margin-bottom:11px"><img alt="" src="/_fileserver/item/ffwazm6.5b40f287effc3adb1a83fe3f01ac40d2a5f610605cd1addba6235d9442245128" style="height:301px; width:560px"></p> 
       <p style="margin-bottom:11px">Źródło: opracowanie własne</p> 
       <p style="margin-bottom:11px">&nbsp;</p> 
       <p style="margin-bottom:11px">Następnie można obserwować jakie skrypty są uruchamiane automatycznie:</p> 
       <p style="margin-bottom:11px"><img alt="" src="/_fileserver/item/yzyu8um.702e17aedf0381b5b2efe194cacbaedf23a3c68a6cbd0e4cac9f9a3023d67239" style="height:46px; width:560px"></p> 
       <p style="margin-bottom:11px">Źródło: opracowanie własne</p> 
       <p style="margin-bottom:11px">&nbsp;</p> 
       <p>Jaki w tym momencie mamy potencjalny zysk jako atakujący?</p> 
       <ul> 
        <li>Jest to bardzo mało znana i nieoczywista metoda uzyskania persystencji.</li> 
        <li>Możemy zaimplementować np. bardzo małego droppera, który zapisze do katalogu użytkownika we wskazanej lokalizacji odpowiednie moduły. Następnie wystarczy, że poczekamy na dowolny domyślny skrypt uruchamiany jako użytkownik lub na otwarcie powershella przez użytkownika. Jeżeli profil użytkownika jest replikowany na inne serwery/komputery istnieje szansa, że nasz malware rozprzestrzeni się po organizacji.</li> 
        <li>Jeżeli użytkownik będzie miał podwyższone uprawnienia na komputerze, to taki malware może rozprzestrzenić się na innych użytkowników komputera poprzez umieszczenie się w ich katalogach domowych.</li> 
       </ul> 
       <p>Uprzedzając pytanie: Jak taki user, nawet jako admin, miałby mieć dostęp do katalogu sieciowego innego użytkownika?</p> 
       <p>Wystarczy, że moduł skopiuje się do katalogu C:\Program Files\WindowsPowerShell\Modules. To sprawi, że każdy proces powershella, niezależnie od konta, taki złośliwy moduł wczyta:</p> 
       <p><img alt="" src="/_fileserver/item/ub2iyym.e1146ea4a3ef225e5f5c9080dddb2c00ac4f20eb88a10d6e9089d5c5888365c3" style="height:61px; width:760px"></p> 
       <p style="margin-bottom:11px">Źródło: opracowanie własne</p> 
       <p style="margin-bottom:11px">&nbsp;</p> 
      </div> 
     </div>
    </div>
    <div id="component_wrapper_1403325336" class="layout_element component_wrapper wrapped_content">
     <div class="component content component_1403325336" data-component-id="1403325336" data-component-type-code="content" data-js-parameters="{}" id="podsumowanie"> 
      <div class="content_area" id="1403325336"> 
       <p style="margin-bottom:11px"><strong>Podsumowanie</strong></p> 
       <p>Jak widać &nbsp;powershell to świetne i ułatwiające pracę,zarówno administratorom jak i hakerom,narzędzie. Skrypty i moduły powershella mogą być potężnym sprzymierzeńcem w arsenale jednych i drugich.</p> 
       <p>Zespoły Blue powinny zwrócić uwagę na pojawianie się w nowych modułów w katalogach użytkowników. Zwłaszcza na pojawianie się ich w globalnych katalogach modułów.</p> 
       <p>Zespoły Red mogą natomiast wykorzystać wskazane moduły zarówno przy próbie eksploitacji podatności pozwalających na zapis plików w systemie, jeśli w systemie dodatkowo działa jakiś skrypt który wyzwoli nasz moduł, jak również w próbach utrzymania persystencji lub stopniowego rozprzestrzeniania się w organizacji.</p> 
       <p>&nbsp;</p> 
      </div> 
     </div>
    </div>
    <div id="component_wrapper_1403325343" class="layout_element component_wrapper wrapped_user_component">
     <div class="component user_component component_1403325343" data-component-id="1403325343" data-component-type-code="user_component" data-js-parameters="{}" id="user_component_1_22022022"> 
      <cms-user-component class="js-cms-userComponent cms-userComponent" src="/_api/core/user-component/disqus" loaded="yes"><!----><div class="content_area"><!----><div class="box-default" id="disqus_thread"></div>

<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><!----></div><!----></cms-user-component> 
     </div>
    </div>
   </div>
   <div class="layout_element layout_column col-xs-12 col-sm-12 col-md-4 col-lg-4"><div class="floating_column" style="width: 406.983px; padding-left: 106.996px;">
    <div id="component_wrapper_1403325337" class="layout_element component_wrapper wrapped_content hidden-sm hidden-xs">
     <div class="component content component_1403325337" data-component-id="1403325337" data-component-type-code="content" data-js-parameters="{}" id="content_1_16032019"> 
      <div class="content_area" id="1403325337"> 
       <h3>Spis treści</h3> 
      </div> 
     </div>
    </div>
    <div id="component_wrapper_1403325340" class="layout_element component_wrapper wrapped_floating_menu_right hidden-sm hidden-xs">
     <div class="component floating_menu_right component_1403325340" data-component-id="1403325340" data-component-type-code="floating_menu_right" data-js-parameters="{}" id="floating_menu_right_1_16032019"> 
      <div id="floating_menu_right_1403325340"> 
       <div class="outer" style="width: 367.983px;"> 
        <ul> 
         <li><a href="#wstep">Wstęp</a></li> 
         <li><a href="#moduly-importowane">Moduły importowane domyślnie</a></li> 
         <li><a href="#podsumowanie">Podsumowanie</a></li> 
        </ul> 
       </div> 
      </div> 
     </div>
    </div>
    <div id="component_wrapper_1403325345" class="layout_element component_wrapper wrapped_related_articles">
     <div class="component related_articles component_1403325345" data-component-id="1403325345" data-component-type-code="related_articles" data-js-parameters="{&quot;defaultHtml&quot;:&quot;\u003ch3 class\u003d\&quot;component_header\&quot;\u003eZobacz także\u003c/h3\u003e\u003cdiv\u003e\u003cdiv class\u003d\&quot;list_content_wrapper\&quot; id\u003d\&quot;table_relatedArticlesTable_1403325345\&quot;\u003e\u003cdiv class\u003d\&quot;list_content\&quot;\u003e\u003cdiv class\u003d\&quot;list_item_odd list_item_first list_item_last\&quot;\u003e\u003cdiv class\u003d\&quot;item no_image\&quot;\u003e\u003cdiv\u003e\u003cspan class\u003d\&quot;data\&quot;\u003e25 października 2022\u003c/span\u003e\u003ch4 class\u003d\&quot;name\&quot;\u003e\u003ca href\u003d\&quot;/blog/moduly-powershell-wsparcie-leniwego-admina-czy-szwajcarski-scyzoryk-hakera-czesc1\&quot;\u003e\u003cspan\u003eModuły PowerShell – wsparcie leniwego admina czy szwajcarski scyzoryk hakera - część 1\u003c/span\u003e\u003c/a\u003e\u003c/h4\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003cdiv class\u003d\&quot;list_pagination\&quot;\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e&quot;,&quot;getAjaxComponentUrl&quot;:&quot;/_api/ds/ingrwd-lds/component_action?component.action\u003dget_ajax_component\u0026component.id\u003d1403325345\u0026component.site\u003dQLmeEYC8HoCjSlYxcQoUUw\u003d\u003d&quot;}" id="related_articles_1_19042019"><h3 class="component_header">Zobacz także</h3><div><div class="list_content_wrapper" id="table_relatedArticlesTable_1403325345"><div class="list_content"><div class="list_item_odd list_item_first list_item_last"><div class="item no_image"><div><span class="data">25 października 2022</span><h4 class="name"><a href="/blog/moduly-powershell-wsparcie-leniwego-admina-czy-szwajcarski-scyzoryk-hakera-czesc1"><span>Moduły PowerShell – wsparcie leniwego admina czy szwajcarski scyzoryk hakera - część 1</span></a></h4></div></div></div></div><div class="list_pagination"></div></div></div></div>
    </div>
   </div></div>
  </div>
 </div>
</div>
                    </div>
                    <div id="outlet-footer" class="outlet outlet-footer" data-resource-id="1500019.56896b9fcf4f28cde2bdcf2032ce2f44c618c4ae71d0c5d03494a1aa9393143a">
                        <div class="layout_section footer_section layout_element">
 <div class="layout_container layout_element">
  <div class="layout_row row layout_element">
   <div class="layout_column col-xs-12 col-sm-12 col-md-12 col-lg-12 layout_element">
    <div class="component footer notPrintable component_1500019" data-component-id="1500019" data-component-type-code="footer"> 
     <div class="text-logo"> 
      <p class="text">© 2024 ING Bank Śląski S.A. Wszelkie prawa zastrzeżone. <a role="button" class="js-cookie-policy-deputed-settings-button link" aria-haspopup="dialog" style="padding: 0; margin: 0; outline: inherit">Ustawienia&nbsp;<span lang="en">cookie</span></a> | <a href="https://www.ing.pl/indywidualni/tabele-i-regulaminy/regulacje/polityka-plikow-cookie" style="margin: 0" class="link">Polityka&nbsp;<span lang="en">cookie</span></a></p> 
      <a class="epoint-logo" href="http://www.e-point.pl/" target="_blank" rel="noreferrer noopener" aria-label="strona e-Point"><img src="/_fileserver/item/1100088.4e3b711df54e22496d81bd37fe26cf0678d9f27bfbf6422cf8bc9c187c5d33d3" alt="Utworzone przez e-Point"></a> 
     </div> 
    </div>
   </div>
  </div>
 </div>
</div>
                    </div>
            </div>
        </main>

        <script type="text/javascript" src="/_static/js/client.2718413b4c44d6a92de2.js"></script>
        <script src="/_static/js/webcomponentsjs/custom-elements-es5-adapter.3342b468203af1a14ca0.js"></script>
        <script src="/_static/js/webcomponentsjs/webcomponents-loader.js"></script>

        <script type="text/javascript" src="/_static/lib/vendor/jquery-1.9.1.min.416a3b2c3bf16d64f6b5.js" data-no-hash-src="/_static/lib/vendor/jquery-1.9.1.min.js"></script>
        <script type="text/javascript" src="/_static/lib/jquery-fn.702b5ab35e6c7b230868.js" data-no-hash-src="/_static/lib/jquery-fn.js"></script>
        <script type="text/javascript" src="/_static/lib/vendor/mobile-detect-v1.4.3.min.363a80d367e6658e72d9.js" data-no-hash-src="/_static/lib/vendor/mobile-detect-v1.4.3.min.js"></script>
        <script type="text/javascript" src="/_static/lib/components.d87eb3d43c610bda111c.js" data-no-hash-src="/_static/lib/components.js"></script>
        <script type="text/javascript" src="/_static/lib/components-utils.1d71f4b878a4da08b206.js" data-no-hash-src="/_static/lib/components-utils.js"></script>
        <script type="text/javascript" src="/_static/lib/post-message.a8494a105d66ada721b8.js" data-no-hash-src="/_static/lib/post-message.js"></script>
        <script type="text/javascript" src="/_static/lib/ui-component.f4563c0580bb250d2c71.js" data-no-hash-src="/_static/lib/ui-component.js"></script>
        <script type="text/javascript" src="/_static/lib/screen-size.efe08bc85f493e371c1a.js" data-no-hash-src="/_static/lib/screen-size.js"></script>
        <script type="text/javascript" src="/_static/lib/expandable.1c8ca965b6a93a6e8172.js" data-no-hash-src="/_static/lib/expandable.js"></script>
        <script type="text/javascript" src="/_static/lib/expandable-last-element.1e1233c5f8fe48440274.js" data-no-hash-src="/_static/lib/expandable-last-element.js"></script>
        <script type="text/javascript" src="/_static/lib/modal-utils.c4d1c273f73fce1e433c.js" data-no-hash-src="/_static/lib/modal-utils.js"></script>
        <script type="text/javascript" src="/_static/lib/CmsMenuUtils.51234795d8fd71a1f2ff.js" data-no-hash-src="/_static/lib/CmsMenuUtils.js"></script>
        <script type="text/javascript" src="/_static/lib/utils.6d82532e90fe074c63c2.js" data-no-hash-src="/_static/lib/utils.js"></script>
        <script type="text/javascript" src="/_static/lib/vendor/platform-detect.e3fa26464d9c0aabf2dc.js" data-no-hash-src="/_static/lib/vendor/platform-detect.js"></script>
        <script type="text/javascript" src="/_static/lib/platform.ae4d90a34b235c2cf065.js" data-no-hash-src="/_static/lib/platform.js"></script>
        <script type="text/javascript" src="/_static/lib/rules-for-parameters-lib.dc1c42d8fea5ab5f2e32.js" data-no-hash-src="/_static/lib/rules-for-parameters-lib.js"></script>
        <script type="text/javascript" src="/_static/lib/table-utils.7c63ad192593430e612c.js" data-no-hash-src="/_static/lib/table-utils.js"></script>
        <script type="text/javascript" src="/_api/ds/ingrwd-lds/rules_for_parameters.js" data-no-hash-src="/_api/ds/ingrwd-lds/rules_for_parameters.js"></script>
        <script type="text/javascript" src="/_static/lib/content-utils.b4fd6137f0fc5789c19e.js" data-no-hash-src="/_static/lib/content-utils.js"></script>
        <script type="text/javascript" src="/_static/lib/pagination-utils.6b1960c6074752049c59.js" data-no-hash-src="/_static/lib/pagination-utils.js"></script>
        <script type="text/javascript" src="/_static/lib/floating-menu.bbfbf1657bcb895c1490.js" data-no-hash-src="/_static/lib/floating-menu.js"></script>
        <div class="js-cookie-policy-box cpm-wrapper--hook" id="cpm-wrapper" data-banner-type="all" style="visibility: hidden; pointer-events: none; opacity: 0"><link crossorigin="anonymous" data-type="cookies-policy" rel="stylesheet" type="text/css" href="https://www.ing.pl/_api/ds/ingrwd-lds/cookie_policy/150020/cpm.css"><span class="cpm__transitionHelper isActive"></span><div class="cookie-policy-non_aggressive-popup js-cookie-policy-non_aggressive-popup"><div class="js-cookie-policy-main cookie-policy-popup cookie-policy-popup--all cpm--block"><div class="cookie-policy-content"><div class="cookie-policy-inner"><h2 class="cookie-policy-title">ING Bank Śląski (my) korzysta z cookies i innych podobnych technologii</h2><div class="cookie-policy-description"><p>Jeśli zaakceptujesz wszystkie cookies, zapiszemy w Twoim urządzeniu cookies i inne pliki (ogólnie cookies) analityczne i marketingowe (w celu profilowanego marketingu). Jeśli odrzucisz wszystkie - zapiszemy tylko cookies techniczne, niezbędne dla działania naszych stron. Cookies możesz też ustawić samodzielnie (Dostosuj). Używamy cookies zgodnie z <a tabindex="1" href="https://www.ing.pl/indywidualni/tabele-i-regulaminy/regulacje/ochrona-danych-osobowych">Polityką prywatności</a> i <a tabindex="1" href="https://www.ing.pl/cookie">Polityką cookies</a> (zwanymi Politykami), które opisują rodzaje cookies, sposoby korzystania z nich przez nas, usuwania cookies naszych oraz naszych zaufanych partnerów. Zapiszemy Twój wybór. Zgodnie z Politykami możesz zmieniać ustawienia lub wycofać zgody.</p></div><div class="cookie-policy-btn-group"><div class="cookie-policy-btn-wrapper"><button tabindex="1" class="js-cookie-policy-main-settings-button cookie-policy-button is--primary">Dostosuj</button><button tabindex="1" class="js-cookie-policy-main-decline-button cookie-policy-button is--primary">Odrzuć wszystkie</button><button tabindex="1" class="js-cookie-policy-main-accept-button cookie-policy-button is--primary">Zaakceptuj wszystkie</button></div></div></div></div></div><div class="js-cookie-policy-settings cpm--hidden cookie-policy-popup cookie-policy-popup--settings"><div class="cookie-policy-content"><div class="cookie-policy-inner"><button class="cookie-policy-arrow--left js-cookie-policy-settings-cancel-button" tabindex="1"><span class="cookie-policy__srOnly">Wyjdź z ustawień cookie</span></button><h2 class="cookie-policy-title">Ustawienia plików cookies i innych technologii</h2><div class="js-cookie-policy-settings-acceptance-form cookie-policy-description"><div class="cookie-policy-type-wrapper"><div class="cookie-policy-type"><div class="cookie-policy-type--content"><p class="cookie-policy-type--title js-cookie-policy-title">Cookie techniczne</p><div class="cookie-policy-type--description"><p>Niezbędne dla prawidłowego działania naszych stron, są więc zawsze aktywne.</p><a tabindex="1" class="cookie-policy-link"> <span class="cookie-policy-link--expand">Rozwiń</span> <span class="cookie-policy-link--collapse">Zwiń</span> <span class="sr-only"> informację o <span lang="en">Cookie</span> techniczne</span></a><div class="cookie-policy-link--content"> <p>Wykorzystujemy je m.in. do zapamiętywania wyrażonych przez Ciebie zgód. Możesz zablokować techniczne cookies w ustawieniach swojej przeglądarki, ale wówczas strona może przestać działać lub nie działać poprawnie. Za ich pomocą nie zbieramy danych osobowych.</p> </div></div></div><div class="cookie-policy-switch"><label class="cookie-policy-switch-label" for="CpmTechnicalOption"><input checked="true" class="cookie-policy-switch-input js-checkbox" disabled="disabled" id="CpmTechnicalOption" name="CpmTechnicalOption" type="checkbox"><button class="cookie-policy-switch-slider nonclickable"></button></label></div></div><div class="cookie-policy-type"><div class="cookie-policy-type--content"><p class="cookie-policy-type--title clickable js-cookie-policy-title">Cookie analityczne</p><div class="cookie-policy-type--description"><p>Umożliwiają nam gromadzenie danych na temat stron, które wyświetlasz, działań, jakie na nich podejmujesz czy miejsc, z których do nas trafiasz.</p><a tabindex="1" class="cookie-policy-link"> <span class="cookie-policy-link--expand">Rozwiń</span> <span class="cookie-policy-link--collapse">Zwiń</span> <span class="sr-only"> informację o <span lang="en">Cookie</span> analityczne</span></a><div class="cookie-policy-link--content"> <p>Dzięki cookies analitycznym możemy poprawiać funkcjonowanie strony, mierzyć skuteczność działań marketingowych i rozliczać się z partnerami biznesowymi. Za ich pomocą nie zbieramy danych osobowych.</p> </div></div></div><div class="cookie-policy-switch"><label class="cookie-policy-switch-label" for="CpmAnalyticalOption"><input class="cookie-policy-switch-input js-checkbox" id="CpmAnalyticalOption" name="CpmAnalyticalOption" type="checkbox"><button class="cookie-policy-switch-slider" tabindex="1"></button></label></div></div><div class="cookie-policy-type"><div class="cookie-policy-type--content"><p class="cookie-policy-type--title clickable js-cookie-policy-title">Cookie marketingowe</p><div class="cookie-policy-type--description"><p>Pozwalają nam na przedstawianie profilowanych informacji handlowych dostosowanych do Twoich wyborów lub stron, które odwiedzasz w Internecie.</p><a tabindex="1" class="cookie-policy-link"> <span class="cookie-policy-link--expand">Rozwiń</span> <span class="cookie-policy-link--collapse">Zwiń</span> <span class="sr-only"> informację o <span lang="en">Cookie</span> marketingowe</span></a><div class="cookie-policy-link--content"> <p>Dzięki nim wiemy, jak korzystasz z serwisu, w tym z oferowanych usług, możemy też łączyć zabrane na ich podstawie dane i informacje z innymi dotyczącymi Ciebie informacjami, które mamy lub otrzymamy w przyszłości. Zapoznaj się z <a tabindex="1" href="https://www.ing.pl/indywidualni/tabele-i-regulaminy/regulacje/ochrona-danych-osobowych">wyjaśnieniami użytych tu terminów i informacją banku</a>.</p> </div></div></div><div class="cookie-policy-switch"><label class="cookie-policy-switch-label" for="CpmMarketingOption"><input class="cookie-policy-switch-input js-checkbox" id="CpmMarketingOption" name="CpmMarketingOption" type="checkbox"><button class="cookie-policy-switch-slider" tabindex="1"></button></label></div></div></div></div><div class="cookie-policy-btn-group"><div class="cookie-policy-btn-wrapper cookie-policy-btn-wrapper--settings cookie-policy-btn-wrapper--secondary"><button tabindex="1" class="js-cookie-policy-settings-decline-all-button cookie-policy-button is--primary">Odrzuć wszystkie</button><button tabindex="1" class="js-cookie-policy-settings-decline-button cookie-policy-button is--primary">Zaakceptuj wybrane</button></div></div></div></div></div><div class="cookie-policy-recallBanner cpm--hidden"><div class="cookie-policy-recallBanner-outer"><div class="cookie-policy-recallBanner-inner"><div class="cookie-policy-recallBanner-icon"></div><div class="cookie-policy-recallBanner-content"><span class="cookie-policy-recallBanner-text">W każdej chwili możesz zmienić</span><a class="cookie-policy-recallBanner-link">ustawienia plików cookie</a><a tabindex="1" class="cookie-policy-recallBanner-button">Zamknij i nie pokazuj więcej</a></div></div></div></div><div class="cookie-policy-closeBanner cpm--hidden"><div class="cookie-policy-closeBanner-outer"><div class="cookie-policy-closeBanner-inner"><div class="cookie-policy-closeBanner-icon"></div><div class="cookie-policy-closeBanner-content"><span class="cookie-policy-closeBanner-text">Twoje ustawienia zostały zapisane</span><a class="cookie-policy-closeBanner-link">Zarządzaj ustawieniami plików cookie</a></div></div></div></div></div></div>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    <script type="text/javascript" src="/_Incapsula_Resource?SWJIYLWA=719d34d31c8e3a6e6fffd425f7e032f3&amp;ns=1&amp;cb=1233993417" async=""></script>

<script type="text/javascript" id="">(function(){window.dataLayer=window.dataLayer||[];if(3!=google_tag_manager["rm"]["11244519"](5)&&4!=google_tag_manager["rm"]["11244519"](6)){var a=0;window.addEventListener("onCookiePolicyAnalyticsAccept",function(){0==a&&(window.dataLayer.push({event:"analytics-accept"}),a=1)});window.addEventListener("onCookiePolicyAnalyticsDecline",function(){1==a&&(window.dataLayer.push({event:"analytics-decline"}),a=0)})}else if(3==google_tag_manager["rm"]["11244519"](7)||4==google_tag_manager["rm"]["11244519"](8))a=1,window.addEventListener("onCookiePolicyAnalyticsAccept",function(){0==
a&&(window.dataLayer.push({event:"analytics-accept"}),a=1)}),window.addEventListener("onCookiePolicyAnalyticsDecline",function(){1==a&&(window.dataLayer.push({event:"analytics-decline"}),a=0)})})();</script>
<script type="text/javascript" id="">window.addEventListener("beforeunload",function(){window.dataLayer.push({event:"beforeunload"})});</script><iframe style="display: none;"></iframe><div class="pub_300x250 pub_300x250m pub_728x90 text-ad textAd text_ad text_ads text-ads text-ad-links ad-text adSense adBlock adContent adBanner" style="width: 1px !important; height: 1px !important; position: absolute !important; left: -10000px !important; top: -1000px !important;"></div></body></html>