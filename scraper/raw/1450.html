<html lang="en" data-rh="lang"><head><title>Defense and Detection for Attacks Within Azure | by Ryan Hausknecht | Posts By SpecterOps Team Members</title><meta data-rh="true" charset="utf-8"><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"><meta data-rh="true" name="theme-color" content="#000000"><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"><meta data-rh="true" property="al:ios:app_name" content="Medium"><meta data-rh="true" property="al:ios:app_store_id" content="828256236"><meta data-rh="true" property="al:android:package" content="com.medium.reader"><meta data-rh="true" property="fb:app_id" content="542599432471018"><meta data-rh="true" property="og:site_name" content="Medium"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2020-02-07T16:59:21.799Z"><meta data-rh="true" name="title" content="Defense and Detection for Attacks Within Azure | by Ryan Hausknecht | Posts By SpecterOps Team Members"><meta data-rh="true" property="og:title" content="Defense and Detection for Attacks Within Azure"><meta data-rh="true" property="al:android:url" content="medium://p/bdc40f8c0766"><meta data-rh="true" property="al:ios:url" content="medium://p/bdc40f8c0766"><meta data-rh="true" property="al:android:app_name" content="Medium"><meta data-rh="true" name="description" content="In my article “Attacking Azure, AzureAD, and Introducing PowerZure”, I provided several tactics, techniques, and procedures (TTPs) on attacking Azure &amp; AzureAD, as well as released PowerZure to…"><meta data-rh="true" property="og:description" content="Utilizing Activity Log for stopping Attacks on Azure services."><meta data-rh="true" property="og:url" content="https://posts.specterops.io/detecting-attacks-within-azure-bdc40f8c0766"><meta data-rh="true" property="al:web:url" content="https://posts.specterops.io/detecting-attacks-within-azure-bdc40f8c0766"><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:653/1*akULdKgmNgcggYrwI8yw8w.png"><meta data-rh="true" property="article:author" content="https://medium.com/@hausec"><meta data-rh="true" name="author" content="Ryan Hausknecht"><meta data-rh="true" name="robots" content="index,follow,max-image-preview:large"><meta data-rh="true" name="referrer" content="unsafe-url"><meta data-rh="true" property="twitter:title" content="Defense and Detection for Attacks Within Azure"><meta data-rh="true" name="twitter:site" content="@specterops"><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/bdc40f8c0766"><meta data-rh="true" property="twitter:description" content="Utilizing Activity Log for stopping Attacks on Azure services."><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:653/1*akULdKgmNgcggYrwI8yw8w.png"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="twitter:label1" content="Reading time"><meta data-rh="true" name="twitter:data1" content="8 min read"><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:152:152/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:120:120/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:76:76/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:60:60/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/Medium-Avatar-500x500.svg" color="#171717"><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"><link data-rh="true" rel="author" href="https://medium.com/@hausec"><link data-rh="true" rel="canonical" href="https://posts.specterops.io/detecting-attacks-within-azure-bdc40f8c0766"><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/bdc40f8c0766"><style type="text/css" data-fela-rehydration="539" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="539" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-webkit-keyframes k1{0%{transform:translate(-50%, -100px)}100%{transform:translate(-50%, 0)}}@-moz-keyframes k1{0%{transform:translate(-50%, -100px)}100%{transform:translate(-50%, 0)}}@keyframes k1{0%{transform:translate(-50%, -100px)}100%{transform:translate(-50%, 0)}}</style><style type="text/css" data-fela-rehydration="539" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{fill:rgba(0, 0, 0, 1)}.av{height:22px}.aw{margin-left:16px}.ax{border:none}.ay{border-radius:20px}.az{width:240px}.ba{background:#F9F9F9}.bb path{fill:#6B6B6B}.bd{outline:none}.be{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bf{font-size:14px}.bg{width:100%}.bh{padding:10px 20px 10px 0}.bi{background-color:transparent}.bj{color:#242424}.bk::placeholder{color:#6B6B6B}.bl{display:inline-block}.bm{margin-left:12px}.bn{margin-right:12px}.bo{border-radius:4px}.bp{margin-left:24px}.bq{height:24px}.bw{background-color:#F9F9F9}.bx{border-radius:50%}.by{height:32px}.bz{width:32px}.ca{justify-content:center}.cg{max-width:680px}.ch{min-width:0}.ci{animation:k1 1.2s ease-in-out infinite}.cj{height:100vh}.ck{margin-bottom:16px}.cl{margin-top:48px}.cm{align-items:flex-start}.cn{flex-direction:column}.co{justify-content:space-between}.cp{margin-bottom:24px}.cv{width:80%}.cw{background-color:#F2F2F2}.dc{height:44px}.dd{width:44px}.de{margin:auto 0}.df{margin-bottom:4px}.dg{height:16px}.dh{width:120px}.di{width:80px}.do{margin-bottom:8px}.dp{width:96%}.dq{width:98%}.dr{width:81%}.ds{margin-left:8px}.dt{color:#6B6B6B}.du{font-size:13px}.dv{height:100%}.eo{color:#FFFFFF}.ep{fill:#FFFFFF}.eq{background:rgba(128, 128, 183, 1)}.er{border-color:rgba(128, 128, 183, 1)}.ev:disabled{cursor:inherit !important}.ew:disabled{opacity:0.3}.ex:disabled:hover{background:rgba(128, 128, 183, 1)}.ey:disabled:hover{border-color:rgba(128, 128, 183, 1)}.ez{border-radius:99em}.fa{border-width:1px}.fb{border-style:solid}.fc{box-sizing:border-box}.fd{text-decoration:none}.fe{text-align:center}.fh{margin-right:32px}.fi{position:relative}.fj{fill:#6B6B6B}.fm{background:transparent}.fn svg{margin-left:4px}.fo svg{fill:#6B6B6B}.fq{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fr{position:absolute}.fy{margin:0 24px}.gc{background:rgba(255, 255, 255, 1)}.gd{border:1px solid #F2F2F2}.ge{box-shadow:0 1px 4px #F2F2F2}.gf{max-height:100vh}.gg{overflow-y:auto}.gh{left:0}.gi{top:calc(100vh + 100px)}.gj{bottom:calc(100vh + 100px)}.gk{width:10px}.gl{pointer-events:none}.gm{word-break:break-word}.gn{word-wrap:break-word}.go:after{display:block}.gp:after{content:""}.gq:after{clear:both}.gr{line-height:1.23}.gs{letter-spacing:0}.gt{font-style:normal}.gu{font-weight:700}.hu{@media all and (max-width: 551.98px):8px}.hv{@media all and (min-width: 552px) and (max-width: 727.98px):8px}.hw{@media all and (min-width: 728px) and (max-width: 903.98px):16px}.hx{@media all and (min-width: 904px) and (max-width: 1079.98px):16px}.hy{@media all and (min-width: 1080px):16px}.ie{align-items:baseline}.if{width:48px}.ig{height:48px}.ih{border:2px solid rgba(255, 255, 255, 1)}.ii{z-index:0}.ij{box-shadow:none}.ik{border:1px solid rgba(0, 0, 0, 0.05)}.il{margin-left:-12px}.im{width:28px}.in{height:28px}.io{z-index:1}.ip{width:24px}.iq{margin-bottom:2px}.ir{flex-wrap:nowrap}.is{font-size:16px}.it{line-height:24px}.iv{margin:0 8px}.iw{display:inline}.ix{color:rgba(128, 128, 183, 1)}.iy{fill:rgba(128, 128, 183, 1)}.jb{flex:0 0 auto}.je{flex-wrap:wrap}.jh{white-space:pre-wrap}.ji{margin-right:4px}.jj{overflow:hidden}.jk{max-height:20px}.jl{text-overflow:ellipsis}.jm{display:-webkit-box}.jn{-webkit-line-clamp:1}.jo{-webkit-box-orient:vertical}.jp{word-break:break-all}.jr{padding-left:8px}.js{padding-right:8px}.kt> *{flex-shrink:0}.ku{overflow-x:scroll}.kv::-webkit-scrollbar{display:none}.kw{scrollbar-width:none}.kx{-ms-overflow-style:none}.ky{width:74px}.kz{flex-direction:row}.la{z-index:2}.ld{-webkit-user-select:none}.le{border:0}.lf{fill:rgba(117, 117, 117, 1)}.li{outline:0}.lj{user-select:none}.lk> svg{pointer-events:none}.lt{cursor:progress}.lu{opacity:1}.lv{padding:4px 0}.ly{margin-top:0px}.lz{width:16px}.mb{display:inline-flex}.mh{max-width:100%}.mi{padding:8px 2px}.mj svg{color:#6B6B6B}.na{line-height:1.12}.nb{letter-spacing:-0.022em}.nc{font-weight:600}.nx{margin-bottom:-0.28em}.ny{line-height:1.58}.nz{letter-spacing:-0.004em}.oa{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.ov{margin-bottom:-0.46em}.ow{text-decoration:underline}.pc{margin-left:auto}.pd{margin-right:auto}.pe{max-width:444px}.pk{clear:both}.pl{height:auto}.pm{margin-top:10px}.pn{max-width:728px}.pq{max-width:597px}.pr{max-width:433px}.ps{max-width:1144px}.pu{cursor:zoom-in}.pv{z-index:auto}.px{max-width:653px}.py{max-width:247px}.pz{line-height:1.18}.qn{margin-bottom:-0.31em}.qo{font-style:italic}.qp{max-width:580px}.qq{max-width:672px}.qr{padding:2px 4px}.qs{font-size:75%}.qt> strong{font-family:inherit}.qu{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.qv{max-width:591px}.qw{max-width:725px}.qx{max-width:378px}.qy{max-width:993px}.qz{box-shadow:inset 3px 0 0 0 #242424}.ra{padding-left:23px}.rb{margin-left:-20px}.rc{max-width:990px}.rd{max-width:482px}.re{margin-bottom:26px}.rf{margin-top:6px}.rg{margin-top:8px}.rh{margin-right:8px}.ri{padding:8px 16px}.rj{border-radius:100px}.rk{transition:background 300ms ease}.rm{white-space:nowrap}.rn{border-top:none}.rt{height:52px}.ru{max-height:52px}.rv{box-sizing:content-box}.rw{position:static}.ry{max-width:155px}.se{margin-right:20px}.sk{align-items:flex-end}.sl{width:76px}.sm{height:76px}.sn{border:2px solid #F9F9F9}.so{height:72px}.sp{width:72px}.sq{margin-left:-16px}.sr{width:36px}.ss{height:36px}.st{width:auto}.su{stroke:#F2F2F2}.sv{color:#F2F2F2}.sw{fill:#F2F2F2}.sx{background:#F2F2F2}.sy{border-color:#F2F2F2}.te{font-weight:500}.tf{font-size:24px}.tg{line-height:30px}.th{letter-spacing:-0.016em}.ti{margin-top:16px}.tj{height:0px}.tk{border-bottom:solid 1px #E5E5E5}.tq{margin-top:72px}.tr{padding:24px 0}.ts{margin-bottom:0px}.tt{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.es:hover{background:rgba(110, 110, 154, 1)}.et:hover{border-color:rgba(110, 110, 154, 1)}.eu:hover{cursor:pointer}.fk:hover{color:#242424}.fl:hover{fill:#242424}.fp:hover svg{fill:#242424}.fs:hover{background-color:rgba(0, 0, 0, 0.1)}.iu:hover{text-decoration:underline}.iz:hover:not(:disabled){color:rgba(110, 110, 154, 1)}.ja:hover:not(:disabled){fill:rgba(110, 110, 154, 1)}.lh:hover{fill:rgba(8, 8, 8, 1)}.lw:hover{fill:#000000}.lx:hover p{color:#000000}.ma:hover{color:#000000}.mk:hover svg{color:#000000}.rl:hover{background-color:#F2F2F2}.sz:hover{background:#F2F2F2}.ta:hover{border-color:#F2F2F2}.tb:hover{cursor:wait}.tc:hover{color:#F2F2F2}.td:hover{fill:#F2F2F2}.bc:focus-within path{fill:#242424}.lg:focus{fill:rgba(8, 8, 8, 1)}.ml:focus svg{color:#000000}.pw:focus{transform:scale(1.01)}.ll:active{border-style:none}</style><style type="text/css" data-fela-rehydration="539" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ee{font-size:14px}.ef{line-height:20px}.el{font-size:13px}.em{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:68px}.gb{max-width:680px}.hp{font-size:42px}.hq{margin-top:1.19em}.hr{margin-bottom:32px}.hs{line-height:52px}.ht{letter-spacing:-0.011em}.id{align-items:center}.kf{border-top:solid 1px #F2F2F2}.kg{border-bottom:solid 1px #F2F2F2}.kh{margin:32px 0 0}.ki{padding:3px 8px}.kr> *{margin-right:24px}.ks> :last-child{margin-right:0}.ls{margin-top:0px}.mg{margin:0}.nt{font-size:24px}.nu{margin-top:1.95em}.nv{line-height:30px}.nw{letter-spacing:-0.016em}.or{font-size:20px}.os{margin-top:0.94em}.ot{line-height:32px}.ou{letter-spacing:-0.003em}.pb{margin-top:2.14em}.pj{margin-top:56px}.qk{margin-top:1.72em}.ql{line-height:24px}.qm{letter-spacing:0}.rs{margin-bottom:88px}.sd{display:inline-block}.sj{padding-top:72px}.tp{margin-top:40px}</style><style type="text/css" data-fela-rehydration="539" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.lr{margin-top:0px}.po{margin-left:auto}.pp{text-align:center}.sc{display:inline-block}</style><style type="text/css" data-fela-rehydration="539" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.lq{margin-top:0px}.sb{display:inline-block}</style><style type="text/css" data-fela-rehydration="539" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.lo{margin-top:0px}.lp{margin-right:0px}.sa{display:inline-block}</style><style type="text/css" data-fela-rehydration="539" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.br{width:24px}.cb{margin:0 24px}.cq{height:40px}.cx{margin-bottom:44px}.dj{margin-bottom:32px}.dw{font-size:13px}.dx{line-height:20px}.eg{padding:0px 8px 1px}.ft{margin-bottom:4px}.gv{font-size:32px}.gw{margin-top:1.01em}.gx{margin-bottom:24px}.gy{line-height:38px}.gz{letter-spacing:-0.014em}.hz{align-items:flex-start}.jc{flex-direction:column}.jf{margin-bottom:2px}.jt{margin:24px -24px 0}.ju{padding:0}.kj> *{margin-right:8px}.kk> :last-child{margin-right:24px}.lb{margin-left:0px}.lm{margin-top:0px}.ln{margin-right:0px}.mc{margin:0}.mm{border:1px solid #F2F2F2}.mn{border-radius:99em}.mo{padding:0px 16px 0px 12px}.mp{height:38px}.mq{align-items:center}.ms svg{margin-right:8px}.nd{font-size:20px}.ne{margin-top:1.2em}.nf{line-height:24px}.ng{letter-spacing:0}.ob{font-size:18px}.oc{margin-top:0.67em}.od{line-height:28px}.oe{letter-spacing:-0.003em}.ox{margin-top:1.56em}.pf{margin-top:40px}.qa{font-size:16px}.qb{margin-top:1.23em}.ro{margin-bottom:80px}.rz{display:inline-block}.sf{padding-top:48px}.tl{margin-top:32px}.mr:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="539" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bu{width:64px}.ce{margin:0 64px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.ec{font-size:14px}.ed{line-height:20px}.ej{font-size:13px}.ek{padding:5px 12px}.ff{display:flex}.fw{margin-bottom:68px}.ga{max-width:680px}.hk{font-size:42px}.hl{margin-top:1.19em}.hm{margin-bottom:32px}.hn{line-height:52px}.ho{letter-spacing:-0.011em}.ic{align-items:center}.kb{border-top:solid 1px #F2F2F2}.kc{border-bottom:solid 1px #F2F2F2}.kd{margin:32px 0 0}.ke{padding:3px 8px}.kp> *{margin-right:24px}.kq> :last-child{margin-right:0}.mf{margin:0}.np{font-size:24px}.nq{margin-top:1.95em}.nr{line-height:30px}.ns{letter-spacing:-0.016em}.on{font-size:20px}.oo{margin-top:0.94em}.op{line-height:32px}.oq{letter-spacing:-0.003em}.pa{margin-top:2.14em}.pi{margin-top:56px}.qh{margin-top:1.72em}.qi{line-height:24px}.qj{letter-spacing:0}.rr{margin-bottom:88px}.si{padding-top:72px}.to{margin-top:40px}</style><style type="text/css" data-fela-rehydration="539" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bt{width:64px}.cd{margin:0 48px}.cs{height:48px}.cz{margin-bottom:52px}.dl{margin-bottom:48px}.ea{font-size:13px}.eb{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:68px}.fz{max-width:680px}.hf{font-size:42px}.hg{margin-top:1.19em}.hh{margin-bottom:32px}.hi{line-height:52px}.hj{letter-spacing:-0.011em}.ib{align-items:center}.jx{border-top:solid 1px #F2F2F2}.jy{border-bottom:solid 1px #F2F2F2}.jz{margin:32px 0 0}.ka{padding:3px 8px}.kn> *{margin-right:24px}.ko> :last-child{margin-right:0}.me{margin:0}.nl{font-size:24px}.nm{margin-top:1.95em}.nn{line-height:30px}.no{letter-spacing:-0.016em}.oj{font-size:20px}.ok{margin-top:0.94em}.ol{line-height:32px}.om{letter-spacing:-0.003em}.oz{margin-top:2.14em}.ph{margin-top:56px}.qe{margin-top:1.72em}.qf{line-height:24px}.qg{letter-spacing:0}.rq{margin-bottom:88px}.sh{padding-top:72px}.tn{margin-top:40px}</style><style type="text/css" data-fela-rehydration="539" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dy{font-size:13px}.dz{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:4px}.ha{font-size:32px}.hb{margin-top:1.01em}.hc{margin-bottom:24px}.hd{line-height:38px}.he{letter-spacing:-0.014em}.ia{align-items:flex-start}.jd{flex-direction:column}.jg{margin-bottom:2px}.jv{margin:24px 0 0}.jw{padding:0}.kl> *{margin-right:8px}.km> :last-child{margin-right:8px}.lc{margin-left:0px}.md{margin:0}.mt{border:1px solid #F2F2F2}.mu{border-radius:99em}.mv{padding:0px 16px 0px 12px}.mw{height:38px}.mx{align-items:center}.mz svg{margin-right:8px}.nh{font-size:20px}.ni{margin-top:1.2em}.nj{line-height:24px}.nk{letter-spacing:0}.of{font-size:18px}.og{margin-top:0.67em}.oh{line-height:28px}.oi{letter-spacing:-0.003em}.oy{margin-top:1.56em}.pg{margin-top:40px}.qc{font-size:16px}.qd{margin-top:1.23em}.rp{margin-bottom:80px}.sg{padding-top:48px}.tm{margin-top:32px}.my:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="539" data-fela-type="RULE" media="print">.rx{display:none}</style><style type="text/css" data-fela-rehydration="539" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.jq{max-height:none}</style><style type="text/css" data-fela-rehydration="539" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.pt{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style><script type="text/javascript" async="" src="https://www.gstatic.com/recaptcha/releases/TqxSU0dsOd2Q9IbI7CpFnJLD/recaptcha__pl.js" crossorigin="anonymous" integrity="sha384-EtuwsrUt4o3rjKbOIgbMlrdETicyC7YJiOMF4S2kRPR2c6EcUDPrB1OFkiSEO3IC"></script><script async="" src="https://cdn.branch.io/branch-latest.min.js"></script><link rel="icon" href="https://miro.medium.com/v2/resize:fill:160:160/1*D-FDlfkqivRBQZoESrwtqw.png" data-rh="true"><script type="application/ld+json" data-rh="true">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*akULdKgmNgcggYrwI8yw8w.png"],"url":"https:\u002F\u002Fposts.specterops.io\u002Fdetecting-attacks-within-azure-bdc40f8c0766","dateCreated":"2020-02-04T16:44:55.022Z","datePublished":"2020-02-04T16:44:55.022Z","dateModified":"2021-12-13T10:19:41.508Z","headline":"Defense and Detection for Attacks Within Azure - Posts By SpecterOps Team Members","name":"Defense and Detection for Attacks Within Azure - Posts By SpecterOps Team Members","description":"In my article “Attacking Azure, AzureAD, and Introducing PowerZure”, I provided several tactics, techniques, and procedures (TTPs) on attacking Azure & AzureAD, as well as released PowerZure to…","identifier":"bdc40f8c0766","author":{"@type":"Person","name":"Ryan Hausknecht","url":"https:\u002F\u002Fposts.specterops.io\u002F@hausec"},"creator":["Ryan Hausknecht"],"publisher":{"@type":"Organization","name":"Posts By SpecterOps Team Members","url":"posts.specterops.io","logo":{"@type":"ImageObject","width":149,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:186\u002F1*s-5BWBr8XsgtIU5azKNhZQ.jpeg"}},"mainEntityOfPage":"https:\u002F\u002Fposts.specterops.io\u002Fdetecting-attacks-within-azure-bdc40f8c0766"}</script><script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-7JY7T788PK" data-rh="true"></script><script data-rh="true">window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'G-7JY7T788PK');</script><script src="https://www.google.com/recaptcha/enterprise.js?render=6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp" data-rh="true"></script><script type="text/javascript" data-rh="true">(function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src="https://cdn.branch.io/branch-latest.min.js";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,"script","branch",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},"addListener applyCode autoAppIndex banner closeBanner closeJourney creditHistory credits data deepview deepviewCta first getCode init link logout redeem referrals removeListener sendSMS setBranchViewData setIdentity track validateCode trackCommerceEvent logEvent".split(" "), 0);
branch.init('key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm', {metadata: {}, 'no_journeys': true, 'disable_exit_animation': true, 'disable_entry_animation': true, 'tracking_disabled': null}, function(err, data) {});</script></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div><script>if (window.self !== window.top) window.location = "about:blank"</script></div><div class="l c"><div class="l m n o c" style="transform: translateY(0px);"><div class="p q r s t u v w x i d y z"><a class="dt ag du be ak b am an ao ap aq ar as at s u w i d q dv z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fbdc40f8c0766&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderCollection&amp;source=---two_column_layout_nav----------------------------------" rel="noopener follow">Open in app<svg width="10" height="10" viewBox="0 0 10 10" fill="none" class="ds"><path d="M.98 8.48a.37.37 0 1 0 .54.54l-.54-.54zm7.77-7.23h.38c0-.2-.17-.38-.38-.38v.38zM8.37 6.5a.37.37 0 1 0 .76 0h-.76zM3.5.87a.37.37 0 1 0 0 .76V.88zM1.52 9.03l7.5-7.5-.54-.54-7.5 7.5.54.54zm6.86-7.77V6.5h.74V1.25h-.74zm-4.88.38h5.25V.88H3.5v.74z" fill="currentColor"></path></svg></a><div class="ab q"><p class="be b dw dx dy dz ea eb ec ed ee ef dt"><span><a class="be b dw dx eg dy dz eh ea eb ei ej ed ek el ef em eo ep eq er es et eu ev ew ex ey ez fa fb fc bl fd fe" data-testid="headerSignUpButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fdetecting-attacks-within-azure-bdc40f8c0766&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign up</a></span></p><div class="aw l"><p class="be b dw dx dy dz ea eb ec ed ee ef dt"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fdetecting-attacks-within-azure-bdc40f8c0766&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=---two_column_layout_nav----------------------------------" rel="noopener follow"><svg width="120" height="27" viewBox="0 0 120 27" fill="none"><mask id="logo-wordmark-pride_svg__a" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="1" y="0" width="119" height="27"><path d="M29.69 2.36h.03v-.29h-7.26L15.7 18.05 8.96 2.07H1.12v.28l.04.01c1.32.3 2 .75 2 2.37v19c0 1.62-.68 2.07-2 2.37h-.04v.29h5.31v-.28H6.4c-1.33-.3-2-.76-2-2.38V5.83l8.67 20.56h.5l8.91-21.13V24.2c-.1 1.28-.78 1.67-1.98 1.95h-.03v.28h9.25v-.27l-.03-.01c-1.2-.28-1.89-.67-2-1.95V4.73c0-1.62.67-2.07 2-2.37zm4.23 12.58c.15-3.41 1.37-5.87 3.4-5.92.64.01 1.17.22 1.58.62.87.86 1.28 2.64 1.22 5.3h-6.2zm-.1.96h10.86v-.04c-.03-2.61-.78-4.64-2.23-6.03a7.3 7.3 0 0 0-5.05-1.87h-.04a7.31 7.31 0 0 0-5.75 2.78 10.4 10.4 0 0 0-2.08 5.72l-.02.2a7.61 7.61 0 0 0-.02.56v.58c.11 5.09 2.84 9.16 7.69 9.16 4.25 0 6.73-3.14 7.35-7.34l-.32-.11c-1.08 2.26-3.03 3.63-5.25 3.46-3.03-.23-5.35-3.32-5.13-7.06m23.12 6.89c-.36.85-1.1 1.32-2.1 1.32s-1.9-.7-2.55-1.94a12.23 12.23 0 0 1-1.06-5.49c0-4.68 1.45-7.7 3.68-7.7.94 0 1.68.47 2.03 1.28V22.8zm7.2 3.33c-1.33-.31-2-.78-2-2.49V.96l-8.07 2.39v.3l.05-.01c1.11-.1 1.87.06 2.3.47.35.32.52.8.52 1.5v3.1a5.18 5.18 0 0 0-2.89-.75c-2.33 0-4.45.98-5.99 2.78-1.6 1.86-2.44 4.42-2.44 7.38 0 5.28 2.58 8.84 6.43 8.84a5.09 5.09 0 0 0 4.89-3.34v2.81h7.23v-.29h-.03zm6.9-22.09c0-1.65-1.23-2.9-2.87-2.9a2.87 2.87 0 0 0-2.9 2.9c0 1.63 1.27 2.9 2.9 2.9a2.82 2.82 0 0 0 2.88-2.9zm1.91 22.1c-1.32-.32-2-.8-2-2.5V8.01l-7.24 2.1v.28h.05c1.56.14 1.99.68 1.99 2.53v13.51H73v-.29h-.04zm18.54 0c-1.33-.32-2-.8-2-2.5V8.01l-6.89 2.02v.29h.04c1.28.14 1.65.71 1.65 2.56v9.88a2.48 2.48 0 0 1-2.2 1.4c-1.57 0-2.43-1.08-2.43-3.02V8.01l-7.24 2.1v.28h.04c1.57.14 2 .68 2 2.53v8.36c0 .58.05 1.16.15 1.74l.13.57c.61 2.21 2.22 3.37 4.73 3.37 2.13 0 4-1.33 4.82-3.4v2.88h7.23v-.3h-.03zm28.1.3v-.3h-.03c-1.44-.34-2-.97-2-2.26V13.25c0-3.31-1.85-5.3-4.95-5.3a5.08 5.08 0 0 0-4.9 3.37c-.58-2.17-2.25-3.36-4.73-3.36a4.7 4.7 0 0 0-4.61 3.1V8.02l-7.23 2v.3h.04c1.55.14 2 .7 2 2.49v13.63h6.74v-.29h-.03c-1.15-.28-1.52-.78-1.52-2.05V11.9c.3-.71.91-1.56 2.13-1.56 1.5 0 2.26 1.05 2.26 3.12v12.97h6.75v-.29h-.03c-1.15-.28-1.52-.78-1.52-2.05V13.25a7 7 0 0 0-.1-1.21c.32-.78.97-1.7 2.23-1.7 1.53 0 2.27 1.02 2.27 3.12v12.97h7.23z" fill="#242424"></path></mask><g filter="url(#logo-wordmark-pride_svg__filter0_f_238_6555)" mask="url(#logo-wordmark-pride_svg__a)"><path d="M42.3-64.7l-15.52-6.74L-24.62 47l15.53 6.74L42.3-64.7z" fill="#000"></path><path d="M53.18-59.98L42.3-64.7-9.1 53.74l10.88 4.72 51.4-118.44z" fill="#603917"></path><path d="M64.96-54.87l-11.78-5.11L1.78 58.46l11.79 5.11 51.4-118.44z" fill="#71E2FD"></path><path d="M75.84-50.15l-10.88-4.72-51.4 118.44 10.89 4.72L75.84-50.15z" fill="#FF9BC9"></path><path d="M86.71-45.43l-10.87-4.72L24.44 68.3l10.88 4.72 51.4-118.44z" fill="#FF472F"></path><path d="M97.6-40.7L86.7-45.44 35.32 73.01l10.88 4.72L97.6-40.7z" fill="#FF8312"></path><path d="M108.47-35.99L97.6-40.7 46.2 77.73l10.88 4.72 51.4-118.44z" fill="#FFCE00"></path><path d="M120.25-30.88l-11.78-5.1-51.4 118.43 11.79 5.11 51.4-118.44z" fill="#48E348"></path><path d="M131.13-26.16l-10.88-4.72L68.86 87.56l10.88 4.72 51.4-118.44z" fill="#008EF0"></path><path d="M148.48-18.63l-17.35-7.53-51.4 118.44 17.35 7.53 51.4-118.44z" fill="#9A50FC"></path></g><defs><filter id="logo-wordmark-pride_svg__filter0_f_238_6555" x="-29.5" y="-76.33" width="182.87" height="181.03" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood><feBlend in="SourceGraphic" in2="BackgroundImageFix" result="shape"></feBlend><feGaussianBlur stdDeviation="2.45" result="effect1_foregroundBlur_238_6555"></feGaussianBlur></filter></defs></svg></a><div class="aw h"><div class="ab ax ay az ba q bb bc"><div class="bl" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bm bn ab"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.1 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0zm6.94-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .8-.79l-3.74-3.73A8.05 8.05 0 0 0 11.04 3v.01z" fill="currentColor"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ax bd be bf z bg bh bi bj bk" placeholder="Search" value=""></div></div></div><div class="h k w ff fg"><div class="fh ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---two_column_layout_nav-----------------------new_post_topnav-----------" rel="noopener follow"><div class="be b bf z dt fi fj ab q fk fl"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-label="Write"><path d="M14 4a.5.5 0 0 0 0-1v1zm7 6a.5.5 0 0 0-1 0h1zm-7-7H4v1h10V3zM3 4v16h1V4H3zm1 17h16v-1H4v1zm17-1V10h-1v10h1zm-1 1a1 1 0 0 0 1-1h-1v1zM3 20a1 1 0 0 0 1 1v-1H3zM4 3a1 1 0 0 0-1 1h1V3z" fill="currentColor"></path><path d="M17.5 4.5l-8.46 8.46a.25.25 0 0 0-.06.1l-.82 2.47c-.07.2.12.38.31.31l2.47-.82a.25.25 0 0 0 .1-.06L19.5 6.5m-2-2l2.32-2.32c.1-.1.26-.1.36 0l1.64 1.64c.1.1.1.26 0 .36L19.5 6.5m-2-2l2 2" stroke="currentColor"></path></svg><div class="ds l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fh ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" href="https://medium.com/search?source=---two_column_layout_nav----------------------------------" rel="noopener follow"><div class="be b bf z dt fi fj ab q fk fl"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-label="Search"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.1 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0zm6.94-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .8-.79l-3.74-3.73A8.05 8.05 0 0 0 11.04 3v.01z" fill="currentColor"></path></svg></div></a></div></div><div class="fh h k j"><div class="ab q"><p class="be b dw dx dy dz ea eb ec ed ee ef dt"><span><a class="be b dw dx eg dy dz eh ea eb ei ej ed ek el ef em eo ep eq er es et eu ev ew ex ey ez fa fb fc bl fd fe" data-testid="headerSignUpButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fdetecting-attacks-within-azure-bdc40f8c0766&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign up</a></span></p><div class="aw l"><p class="be b dw dx dy dz ea eb ec ed ee ef dt"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fdetecting-attacks-within-azure-bdc40f8c0766&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ax fm am ab q ao fn fo fp" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fi"><img alt="" class="l fc bx by bz cw" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"><div class="fq bx l by bz fr n ax fs"></div></div></button></div></div></div><div class="l"><div class="rx" role="dialog" aria-modal="true" tabindex="-1"><div class="wz xa bg dv uf xb ub ao xc gl xd" aria-hidden="true" role="presentation"></div><div class="xe uf xf xg xh wz dv fc xi xj xk lu xl xm ug xn xo xp xq xr xs" aria-hidden="true"></div></div><div class="ft fu fv fw fx l"><div class="ab ca"><div class="ch bg fy fz ga gb"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fr gh gi gj gk gl"></div><div class="gm gn go gp gq"><div class="ab ca"><div class="ch bg fy fz ga gb"><div><h1 id="aeab" class="pw-post-title gr gs gt be gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht bj" data-testid="storyTitle" data-selectable-paragraph="">Defense and Detection for Attacks Within Azure</h1><div class="hu hv hw hx hy"><div class="speechify-ignore ab co"><div class="speechify-ignore bg l"><div class="hz ia ib ic id ab"><div><div class="ab ie"><a href="https://medium.com/@hausec?source=post_page-----bdc40f8c0766--------------------------------" rel="noopener follow"><div><div class="bl" aria-hidden="false" aria-describedby="1" aria-labelledby="1"><div class="l if ig bx ih ii"><div class="l fi"><img alt="Ryan Hausknecht" class="l fc bx dc dd cw" src="https://miro.medium.com/v2/resize:fill:88:88/2*LFdW-NbzZFmNHuopdXF2Wg.png" width="44" height="44" loading="lazy" data-testid="authorPhoto"><div class="ij bx l dc dd fr n ik fs"></div></div></div></div></div></a><a href="https://posts.specterops.io/?source=post_page-----bdc40f8c0766--------------------------------" rel="noopener  ugc nofollow"><div class="il ab fi"><div><div class="bl" aria-hidden="false" aria-describedby="2" aria-labelledby="2"><div class="l im in bx ih io"><div class="l fi"><img alt="Posts By SpecterOps Team Members" class="l fc bx bq ip cw" src="https://miro.medium.com/v2/resize:fill:48:48/1*D-FDlfkqivRBQZoESrwtqw.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto"><div class="ij bx l bq ip fr n ik fs"></div></div></div></div></div></div></a></div></div><div class="bm bg l"><div class="ab"><div style="flex:1"><span class="be b bf z bj"><div class="iq ab q"><div class="ab q ir"><div class="ab q"><div><div class="bl" aria-hidden="false" aria-describedby="3" aria-labelledby="3"><p class="be b is it bj"><a class="af ag ah ai aj ak al am an ao ap aq ar iu" data-testid="authorName" href="https://medium.com/@hausec?source=post_page-----bdc40f8c0766--------------------------------" rel="noopener follow">Ryan Hausknecht</a></p></div></div></div><span class="iv iw" aria-hidden="true"><span class="be b bf z dt">·</span></span><p class="be b is it dt"><span><a class="ix iy ah ai aj ak al am an ao ap aq ar ew iz ja" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9689ed358206&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fdetecting-attacks-within-azure-bdc40f8c0766&amp;user=Ryan+Hausknecht&amp;userId=9689ed358206&amp;source=post_page-9689ed358206----bdc40f8c0766---------------------post_header-----------" rel="noopener follow">Follow</a></span></p></div></div></span></div></div><div class="l jb"><span class="be b bf z dt"><div class="ab cm jc jd je"><div class="jf jg ab"><div class="be b bf z dt ab jh"><span class="ji l jb">Published in</span><div><div class="l" aria-hidden="false" aria-describedby="4" aria-labelledby="4"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" data-testid="publicationName" href="https://posts.specterops.io/?source=post_page-----bdc40f8c0766--------------------------------" rel="noopener  ugc nofollow"><p class="be b bf z jj jk jl jm jn jo jp jq bj">Posts By SpecterOps Team Members</p></a></div></div></div><div class="h k"><span class="iv iw" aria-hidden="true"><span class="be b bf z dt">·</span></span></div></div><span class="be b bf z dt"><div class="ab ae"><span data-testid="storyReadTime">8 min read</span><div class="jr js l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="be b bf z dt">·</span></span></div><span data-testid="storyPublishDate">Feb 4, 2020</span></div></span></div></span></div></div></div><div class="ab co jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki"><div class="h k w ff fg q"><div class="ky l"><div class="ab q kz la"><div class="pw-multi-vote-icon fi ji lb lc ld"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspecter-ops-posts%2Fbdc40f8c0766&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fdetecting-attacks-within-azure-bdc40f8c0766&amp;user=Ryan+Hausknecht&amp;userId=9689ed358206&amp;source=-----bdc40f8c0766---------------------clap_footer-----------" rel="noopener follow"><div><div class="bl" aria-hidden="false" aria-describedby="5" aria-labelledby="5"><div class="le ao lf lg lh li am lj lk ll ld"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lm ln lo lp lq lr ls"><div><div class="bl" aria-hidden="false" aria-describedby="80" aria-labelledby="80"><p class="be b du z dt"><button class="af ag ah ai aj ak al am an ao ap aq ar as at zb ma">20<span class="l h g f sc sd"></span></button></p></div></div></div></div></div><div><div class="bl" aria-hidden="false" aria-describedby="6" aria-labelledby="6"><button class="ao le lu lv ab q fj lw lx" aria-label="responses"><svg width="24" height="24" viewBox="0 0 24 24" class="ly"><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></button></div></div></div><div class="ab q kj kk kl km kn ko kp kq kr ks kt ku kv kw kx"><div class="lz k j i d"></div><div class="h k"><div><div class="bl" aria-hidden="false" aria-describedby="7" aria-labelledby="7"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbdc40f8c0766&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fdetecting-attacks-within-azure-bdc40f8c0766&amp;source=-----bdc40f8c0766---------------------bookmark_footer-----------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div><div class="fc mb cm"><div class="l ae"><div class="ab ca"><div class="mc md me mf mg mh ch bg"><div class="ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2Fplans%3Fdimension%3Dpost_audio_button%26postId%3Dbdc40f8c0766&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fdetecting-attacks-within-azure-bdc40f8c0766&amp;source=-----bdc40f8c0766---------------------post_audio_button-----------" rel="noopener follow"><div><div class="bl" aria-hidden="false" aria-describedby="26" aria-labelledby="26"><button aria-label="Listen" data-testid="audioPlayButton" class="af fj ah ai aj ak al mi an ao ap ew mj mk lx ml mm mn mo mp s mq mr ms mt mu mv mw u mx my mz"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0zm9-10a10 10 0 1 0 0 20 10 10 0 0 0 0-20zm3.38 10.42l-4.6 3.06a.5.5 0 0 1-.78-.41V8.93c0-.4.45-.63.78-.41l4.6 3.06c.3.2.3.64 0 .84z" fill="currentColor"></path></svg><div class="j i d"><p class="be b bf z dt">Listen</p></div></button></div></div></a></span></div></div></div></div></div><div class="bl" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bl" aria-hidden="false" aria-describedby="9" aria-labelledby="9"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fj ah ai aj ak al mi an ao ap ew mj mk lx ml mm mn mo mp s mq mr ms mt mu mv mw u mx my mz"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.22 4.93a.42.42 0 0 1-.12.13h.01a.45.45 0 0 1-.29.08.52.52 0 0 1-.3-.13L12.5 3v7.07a.5.5 0 0 1-.5.5.5.5 0 0 1-.5-.5V3.02l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.8a.42.42 0 0 1 .07.5zm-.1.14zm.88 2h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11a2 2 0 0 1-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.14c.1.1.15.22.15.35a.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9V8.96c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1z" fill="currentColor"></path></svg><div class="j i d"><p class="be b bf z dt">Share</p></div></button></div></div></div></div></div></div></div></div></div><h1 id="04aa" class="na nb gt be nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx bj" data-selectable-paragraph="">Abstract</h1><p id="18b8" class="pw-post-body-paragraph ny nz gt oa b ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov gm bj" data-selectable-paragraph="">In my article “Attacking Azure, AzureAD, and Introducing PowerZure”, I provided several tactics, techniques, and procedures (TTPs) on attacking Azure &amp; AzureAD, as well as released <a class="af ow" href="https://github.com/hausec/PowerZure" rel="noopener ugc nofollow" target="_blank">PowerZure</a> to automate some of it. I firmly believe that when a new tactic or tool is written, that defensive guidelines should follow to help blue teams secure themselves from those tactics or tools. Unfortunately, Azure’s logging capabilities for operations that occur within Azure, leave much to be desired.</p><p id="4393" class="pw-post-body-paragraph ny nz gt oa b ob ox od oe of oy oh oi oj oz ol om on pa op oq or pb ot ou ov gm bj" data-selectable-paragraph="">This article’s purpose is to give an overview into the <strong class="oa gu">native</strong> Activity Log service functionality within Azure and provide insight into how to detect many of the TTPs listed in my previous article, as well as suggestions on how to acquire more detail out of the Activity Log service than just what appears on the ‘summary’ tab.</p><h1 id="bed7" class="na nb gt be nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx bj" data-selectable-paragraph="">Overview</h1><p id="eb2b" class="pw-post-body-paragraph ny nz gt oa b ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov gm bj" data-selectable-paragraph="">Whenever an operation is completed within Azure, an event is generated and kept within the Activity Log service. Within the Activity Log, the user can see all operations and apply basic filters (Time-span, severity, etc.). Operations (events) in the log are broken out based on the status of the operation, i.e. when an event is started, when it updates, when it finishes, etc. In order to see the other “sub-events” within that operation, the user must click on the event and the other status events will then populate. This is important because the details surrounding the operation depend on the status.</p><figure class="pf pg ph pi pj pk pc pd paragraph-image"><div class="pc pd pe"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*-FzFFNcu0WxKqnHFjhFKUA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*-FzFFNcu0WxKqnHFjhFKUA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*-FzFFNcu0WxKqnHFjhFKUA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*-FzFFNcu0WxKqnHFjhFKUA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*-FzFFNcu0WxKqnHFjhFKUA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*-FzFFNcu0WxKqnHFjhFKUA.png 1100w, https://miro.medium.com/v2/resize:fit:888/format:webp/1*-FzFFNcu0WxKqnHFjhFKUA.png 888w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 444px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*-FzFFNcu0WxKqnHFjhFKUA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*-FzFFNcu0WxKqnHFjhFKUA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*-FzFFNcu0WxKqnHFjhFKUA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*-FzFFNcu0WxKqnHFjhFKUA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*-FzFFNcu0WxKqnHFjhFKUA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*-FzFFNcu0WxKqnHFjhFKUA.png 1100w, https://miro.medium.com/v2/resize:fit:888/1*-FzFFNcu0WxKqnHFjhFKUA.png 888w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 444px"><img alt="" class="bg mh pl c" width="444" height="68" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:555/1*-FzFFNcu0WxKqnHFjhFKUA.png"></picture></div><figcaption class="pm fe pn pc pd po pp be b bf z dt" data-selectable-paragraph="">Figure 1: Clicking on the first event shows a sub-event.</figcaption></figure><p id="04ff" class="pw-post-body-paragraph ny nz gt oa b ob ox od oe of oy oh oi oj oz ol om on pa op oq or pb ot ou ov gm bj" data-selectable-paragraph="">For example, when a user is assigned to a role (e.g. contributor), an operation is started which creates an event, but essential details are missing.</p><figure class="pf pg ph pi pj pk pc pd paragraph-image"><div class="pc pd pq"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*NQu3kSutAmjTTpXSCKLm1Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*NQu3kSutAmjTTpXSCKLm1Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*NQu3kSutAmjTTpXSCKLm1Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*NQu3kSutAmjTTpXSCKLm1Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*NQu3kSutAmjTTpXSCKLm1Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*NQu3kSutAmjTTpXSCKLm1Q.png 1100w, https://miro.medium.com/v2/resize:fit:1194/format:webp/1*NQu3kSutAmjTTpXSCKLm1Q.png 1194w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 597px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*NQu3kSutAmjTTpXSCKLm1Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*NQu3kSutAmjTTpXSCKLm1Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*NQu3kSutAmjTTpXSCKLm1Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*NQu3kSutAmjTTpXSCKLm1Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*NQu3kSutAmjTTpXSCKLm1Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*NQu3kSutAmjTTpXSCKLm1Q.png 1100w, https://miro.medium.com/v2/resize:fit:1194/1*NQu3kSutAmjTTpXSCKLm1Q.png 1194w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 597px"><img alt="" class="bg mh pl c" width="597" height="358" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:746/1*NQu3kSutAmjTTpXSCKLm1Q.png"></picture></div><figcaption class="pm fe pn pc pd po pp be b bf z dt" data-selectable-paragraph="">Figure 2: Initial event created in Azure for a role assignment.</figcaption></figure><p id="8d05" class="pw-post-body-paragraph ny nz gt oa b ob ox od oe of oy oh oi oj oz ol om on pa op oq or pb ot ou ov gm bj" data-selectable-paragraph="">Once the operation finishes, another “sub-event” is created that then discloses the necessary details.</p><figure class="pf pg ph pi pj pk pc pd paragraph-image"><div class="pc pd pq"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*RnB6FBpF9P1S5RF-sWrDVQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*RnB6FBpF9P1S5RF-sWrDVQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*RnB6FBpF9P1S5RF-sWrDVQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*RnB6FBpF9P1S5RF-sWrDVQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*RnB6FBpF9P1S5RF-sWrDVQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*RnB6FBpF9P1S5RF-sWrDVQ.png 1100w, https://miro.medium.com/v2/resize:fit:1194/format:webp/1*RnB6FBpF9P1S5RF-sWrDVQ.png 1194w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 597px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*RnB6FBpF9P1S5RF-sWrDVQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*RnB6FBpF9P1S5RF-sWrDVQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*RnB6FBpF9P1S5RF-sWrDVQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*RnB6FBpF9P1S5RF-sWrDVQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*RnB6FBpF9P1S5RF-sWrDVQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*RnB6FBpF9P1S5RF-sWrDVQ.png 1100w, https://miro.medium.com/v2/resize:fit:1194/1*RnB6FBpF9P1S5RF-sWrDVQ.png 1194w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 597px"><img alt="" class="bg mh pl c" width="597" height="370" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:746/1*RnB6FBpF9P1S5RF-sWrDVQ.png"></picture></div><figcaption class="pm fe pn pc pd po pp be b bf z dt" data-selectable-paragraph="">Figure 3: More details revealed when clicking on the sub-event</figcaption></figure><p id="eba6" class="pw-post-body-paragraph ny nz gt oa b ob ox od oe of oy oh oi oj oz ol om on pa op oq or pb ot ou ov gm bj" data-selectable-paragraph="">In this example, the ‘Message’ field is what contains the username of the user that was added to the role, in comparison to the original event which did not contain this info.</p><h1 id="93f6" class="na nb gt be nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx bj" data-selectable-paragraph="">Alerting</h1><p id="453a" class="pw-post-body-paragraph ny nz gt oa b ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov gm bj" data-selectable-paragraph="">Alerts can be configured right from Activity Log. Whenever an operation occurs, Azure gives the option to create an alert for that operation once you click into the event.</p><figure class="pf pg ph pi pj pk pc pd paragraph-image"><div class="pc pd pr"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*7fnsdrD4vw3qx2BJ4jRNUw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*7fnsdrD4vw3qx2BJ4jRNUw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*7fnsdrD4vw3qx2BJ4jRNUw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*7fnsdrD4vw3qx2BJ4jRNUw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*7fnsdrD4vw3qx2BJ4jRNUw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*7fnsdrD4vw3qx2BJ4jRNUw.png 1100w, https://miro.medium.com/v2/resize:fit:866/format:webp/1*7fnsdrD4vw3qx2BJ4jRNUw.png 866w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 433px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*7fnsdrD4vw3qx2BJ4jRNUw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*7fnsdrD4vw3qx2BJ4jRNUw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*7fnsdrD4vw3qx2BJ4jRNUw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*7fnsdrD4vw3qx2BJ4jRNUw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*7fnsdrD4vw3qx2BJ4jRNUw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*7fnsdrD4vw3qx2BJ4jRNUw.png 1100w, https://miro.medium.com/v2/resize:fit:866/1*7fnsdrD4vw3qx2BJ4jRNUw.png 866w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 433px"><img alt="" class="bg mh pl c" width="433" height="97" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:541/1*7fnsdrD4vw3qx2BJ4jRNUw.png"></picture></div><figcaption class="pm fe pn pc pd po pp be b bf z dt" data-selectable-paragraph="">Figure 4: Option to create a new alert based on an event</figcaption></figure><p id="df0f" class="pw-post-body-paragraph ny nz gt oa b ob ox od oe of oy oh oi oj oz ol om on pa op oq or pb ot ou ov gm bj" data-selectable-paragraph="">When creating a rule, there’s an option to change the condition. When the default condition is left, it is a very general condition, as shown in Figure 5.</p><figure class="pf pg ph pi pj pk pc pd paragraph-image"><div role="button" tabindex="0" class="pt pu fi pv bg pw"><div class="pc pd ps"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Sfn2O_LchgqUbGSijsglaw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Sfn2O_LchgqUbGSijsglaw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Sfn2O_LchgqUbGSijsglaw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Sfn2O_LchgqUbGSijsglaw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Sfn2O_LchgqUbGSijsglaw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Sfn2O_LchgqUbGSijsglaw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sfn2O_LchgqUbGSijsglaw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*Sfn2O_LchgqUbGSijsglaw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Sfn2O_LchgqUbGSijsglaw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Sfn2O_LchgqUbGSijsglaw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Sfn2O_LchgqUbGSijsglaw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Sfn2O_LchgqUbGSijsglaw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Sfn2O_LchgqUbGSijsglaw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Sfn2O_LchgqUbGSijsglaw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bg mh pl c" width="700" height="119" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*Sfn2O_LchgqUbGSijsglaw.png"></picture></div></div><figcaption class="pm fe pn pc pd po pp be b bf z dt" data-selectable-paragraph="">Figure 5: The condition is set to any informational level event that succeeds. This would generate several benign alerts.</figcaption></figure><p id="6047" class="pw-post-body-paragraph ny nz gt oa b ob ox od oe of oy oh oi oj oz ol om on pa op oq or pb ot ou ov gm bj" data-selectable-paragraph="">The condition can be changed by clicking on the trash can icon and clicking ‘Add’ under condition.</p><figure class="pf pg ph pi pj pk pc pd paragraph-image"><div class="pc pd px"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*akULdKgmNgcggYrwI8yw8w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*akULdKgmNgcggYrwI8yw8w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*akULdKgmNgcggYrwI8yw8w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*akULdKgmNgcggYrwI8yw8w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*akULdKgmNgcggYrwI8yw8w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*akULdKgmNgcggYrwI8yw8w.png 1100w, https://miro.medium.com/v2/resize:fit:1306/format:webp/1*akULdKgmNgcggYrwI8yw8w.png 1306w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 653px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*akULdKgmNgcggYrwI8yw8w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*akULdKgmNgcggYrwI8yw8w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*akULdKgmNgcggYrwI8yw8w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*akULdKgmNgcggYrwI8yw8w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*akULdKgmNgcggYrwI8yw8w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*akULdKgmNgcggYrwI8yw8w.png 1100w, https://miro.medium.com/v2/resize:fit:1306/1*akULdKgmNgcggYrwI8yw8w.png 1306w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 653px"><img alt="" class="bg mh pl c" width="653" height="395" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:816/1*akULdKgmNgcggYrwI8yw8w.png"></picture></div><figcaption class="pm fe pn pc pd po pp be b bf z dt" data-selectable-paragraph="">Figure 6: Alerting conditions for Runbooks.</figcaption></figure><p id="ab9f" class="pw-post-body-paragraph ny nz gt oa b ob ox od oe of oy oh oi oj oz ol om on pa op oq or pb ot ou ov gm bj" data-selectable-paragraph="">From here, the alert action can be set to several options.</p><figure class="pf pg ph pi pj pk pc pd paragraph-image"><div class="pc pd py"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*e-EUSs5QzmPhbEL1glhP0w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*e-EUSs5QzmPhbEL1glhP0w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*e-EUSs5QzmPhbEL1glhP0w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*e-EUSs5QzmPhbEL1glhP0w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*e-EUSs5QzmPhbEL1glhP0w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*e-EUSs5QzmPhbEL1glhP0w.png 1100w, https://miro.medium.com/v2/resize:fit:494/format:webp/1*e-EUSs5QzmPhbEL1glhP0w.png 494w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 247px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*e-EUSs5QzmPhbEL1glhP0w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*e-EUSs5QzmPhbEL1glhP0w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*e-EUSs5QzmPhbEL1glhP0w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*e-EUSs5QzmPhbEL1glhP0w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*e-EUSs5QzmPhbEL1glhP0w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*e-EUSs5QzmPhbEL1glhP0w.png 1100w, https://miro.medium.com/v2/resize:fit:494/1*e-EUSs5QzmPhbEL1glhP0w.png 494w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 247px"><img alt="" class="bg mh pl c" width="247" height="319" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:309/1*e-EUSs5QzmPhbEL1glhP0w.png"></picture></div><figcaption class="pm fe pn pc pd po pp be b bf z dt" data-selectable-paragraph="">Figure 7: Alerting options</figcaption></figure><h1 id="cdc7" class="na nb gt be nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx bj" data-selectable-paragraph="">It’s All In The Details, or is it?</h1><p id="f17a" class="pw-post-body-paragraph ny nz gt oa b ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov gm bj" data-selectable-paragraph="">Getting a general event is great for alerting, however it’s key for an analyst to have details pertaining to that event such as who started the operation, what was the target object of the operation, etc. Unfortunately, there’s several operations that report minimal details.</p><h2 id="326a" class="pz nb gt be nc qa qb dx ng qc qd dz nk oj qe qf qg on qh qi qj or qk ql qm qn bj" data-selectable-paragraph="">Command Execution</h2><p id="efeb" class="pw-post-body-paragraph ny nz gt oa b ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov gm bj" data-selectable-paragraph="">When a command is run on a virtual machine, an event is created, however there is no record kept of <em class="qo">what</em> command was ran.</p><figure class="pf pg ph pi pj pk pc pd paragraph-image"><div class="pc pd qp"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Z3aqFBJq4vP0PX_gy_ZTuQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Z3aqFBJq4vP0PX_gy_ZTuQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Z3aqFBJq4vP0PX_gy_ZTuQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Z3aqFBJq4vP0PX_gy_ZTuQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Z3aqFBJq4vP0PX_gy_ZTuQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Z3aqFBJq4vP0PX_gy_ZTuQ.png 1100w, https://miro.medium.com/v2/resize:fit:1160/format:webp/1*Z3aqFBJq4vP0PX_gy_ZTuQ.png 1160w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 580px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*Z3aqFBJq4vP0PX_gy_ZTuQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Z3aqFBJq4vP0PX_gy_ZTuQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Z3aqFBJq4vP0PX_gy_ZTuQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Z3aqFBJq4vP0PX_gy_ZTuQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Z3aqFBJq4vP0PX_gy_ZTuQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Z3aqFBJq4vP0PX_gy_ZTuQ.png 1100w, https://miro.medium.com/v2/resize:fit:1160/1*Z3aqFBJq4vP0PX_gy_ZTuQ.png 1160w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 580px"><img alt="" class="bg mh pl c" width="580" height="269" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:725/1*Z3aqFBJq4vP0PX_gy_ZTuQ.png"></picture></div><figcaption class="pm fe pn pc pd po pp be b bf z dt" data-selectable-paragraph="">Figure 8: All that’s returned in the event from running a command on a VM</figcaption></figure><p id="45f1" class="pw-post-body-paragraph ny nz gt oa b ob ox od oe of oy oh oi oj oz ol om on pa op oq or pb ot ou ov gm bj" data-selectable-paragraph="">The summary tab shows when and who executed a command, but in order to see the name of the VM where execution occurred, the user must go to the JSON tab and view the ‘id’ property to see the scope of the event.</p><figure class="pf pg ph pi pj pk pc pd paragraph-image"><div class="pc pd qq"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*acX4urBAqq1pkDV_TDR5ng.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*acX4urBAqq1pkDV_TDR5ng.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*acX4urBAqq1pkDV_TDR5ng.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*acX4urBAqq1pkDV_TDR5ng.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*acX4urBAqq1pkDV_TDR5ng.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*acX4urBAqq1pkDV_TDR5ng.png 1100w, https://miro.medium.com/v2/resize:fit:1344/format:webp/1*acX4urBAqq1pkDV_TDR5ng.png 1344w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 672px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*acX4urBAqq1pkDV_TDR5ng.png 640w, https://miro.medium.com/v2/resize:fit:720/1*acX4urBAqq1pkDV_TDR5ng.png 720w, https://miro.medium.com/v2/resize:fit:750/1*acX4urBAqq1pkDV_TDR5ng.png 750w, https://miro.medium.com/v2/resize:fit:786/1*acX4urBAqq1pkDV_TDR5ng.png 786w, https://miro.medium.com/v2/resize:fit:828/1*acX4urBAqq1pkDV_TDR5ng.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*acX4urBAqq1pkDV_TDR5ng.png 1100w, https://miro.medium.com/v2/resize:fit:1344/1*acX4urBAqq1pkDV_TDR5ng.png 1344w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 672px"><img alt="" class="bg mh pl c" width="672" height="57" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:840/1*acX4urBAqq1pkDV_TDR5ng.png"></picture></div><figcaption class="pm fe pn pc pd po pp be b bf z dt" data-selectable-paragraph="">Figure 9: Name of the VM in the scope path</figcaption></figure><p id="1268" class="pw-post-body-paragraph ny nz gt oa b ob ox od oe of oy oh oi oj oz ol om on pa op oq or pb ot ou ov gm bj" data-selectable-paragraph="">Whenever a command is issued to a Windows Virtual Machine, Azure stores the inputted command as a PowerShell script located on the endpoint within</p><p id="d7da" class="pw-post-body-paragraph ny nz gt oa b ob ox od oe of oy oh oi oj oz ol om on pa op oq or pb ot ou ov gm bj" data-selectable-paragraph=""><code class="cw qr qs qt qu b">C:\Packages\Plugins\Microsoft.CPlat.Core.RunCommandWindows\1.1.3\Downloads</code></p><p id="aa0e" class="pw-post-body-paragraph ny nz gt oa b ob ox od oe of oy oh oi oj oz ol om on pa op oq or pb ot ou ov gm bj" data-selectable-paragraph="">This allows an analyst to potentially see what commands were ran on a virtual machine, provided the attacker did not delete the scripts. Of course, it’s always recommended to use additional defensive tools as well as enable script-block logging on those endpoints within Group Policy.</p><h2 id="372e" class="pz nb gt be nc qa qb dx ng qc qd dz nk oj qe qf qg on qh qi qj or qk ql qm qn bj" data-selectable-paragraph="">Key Vaults</h2><p id="7c98" class="pw-post-body-paragraph ny nz gt oa b ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov gm bj" data-selectable-paragraph="">Key Vaults are very sensitive within Azure due to their purpose. They can house certificates, passwords, and keys, so they should also be heavily monitored for access. Accessing a vault does not generate an event, nor does revealing a key. This is the intended purpose of the resource in conjunction with role-based access control; as far as Azure is concerned, it is not event-worthy if a user accesses a resource they have permission to access. Key Vaults are restricted to their owners and it’s up to the owner to edit the access policy to allow other users to access that vault. However, as a Global Contributor, a user is able to edit the permissions of <strong class="oa gu">any </strong>vault and give themselves permission to access it. This does generate an event, ‘Update Key Vault’.</p><figure class="pf pg ph pi pj pk pc pd paragraph-image"><div class="pc pd qv"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*X97ihFp957fejn3OLNSpWw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*X97ihFp957fejn3OLNSpWw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*X97ihFp957fejn3OLNSpWw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*X97ihFp957fejn3OLNSpWw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*X97ihFp957fejn3OLNSpWw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*X97ihFp957fejn3OLNSpWw.png 1100w, https://miro.medium.com/v2/resize:fit:1182/format:webp/1*X97ihFp957fejn3OLNSpWw.png 1182w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 591px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*X97ihFp957fejn3OLNSpWw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*X97ihFp957fejn3OLNSpWw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*X97ihFp957fejn3OLNSpWw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*X97ihFp957fejn3OLNSpWw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*X97ihFp957fejn3OLNSpWw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*X97ihFp957fejn3OLNSpWw.png 1100w, https://miro.medium.com/v2/resize:fit:1182/1*X97ihFp957fejn3OLNSpWw.png 1182w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 591px"><img alt="" class="bg mh pl c" width="591" height="266" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:739/1*X97ihFp957fejn3OLNSpWw.png"></picture></div><figcaption class="pm fe pn pc pd po pp be b bf z dt" data-selectable-paragraph="">Figure 6: Log of when a Key Vault is updated</figcaption></figure><p id="c97b" class="pw-post-body-paragraph ny nz gt oa b ob ox od oe of oy oh oi oj oz ol om on pa op oq or pb ot ou ov gm bj" data-selectable-paragraph="">The event summary shows who updated the vault’s permissions, however the name of the vault is in the JSON output instead of the summary.</p><figure class="pf pg ph pi pj pk pc pd paragraph-image"><div role="button" tabindex="0" class="pt pu fi pv bg pw"><div class="pc pd qw"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*wTxFby0rHMB20FXFO5IOeg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*wTxFby0rHMB20FXFO5IOeg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*wTxFby0rHMB20FXFO5IOeg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*wTxFby0rHMB20FXFO5IOeg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*wTxFby0rHMB20FXFO5IOeg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*wTxFby0rHMB20FXFO5IOeg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wTxFby0rHMB20FXFO5IOeg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*wTxFby0rHMB20FXFO5IOeg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*wTxFby0rHMB20FXFO5IOeg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*wTxFby0rHMB20FXFO5IOeg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*wTxFby0rHMB20FXFO5IOeg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*wTxFby0rHMB20FXFO5IOeg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*wTxFby0rHMB20FXFO5IOeg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*wTxFby0rHMB20FXFO5IOeg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bg mh pl c" width="700" height="94" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*wTxFby0rHMB20FXFO5IOeg.png"></picture></div></div><figcaption class="pm fe pn pc pd po pp be b bf z dt" data-selectable-paragraph="">Figure 10: The scope in the JSON tab reveals the vault name.</figcaption></figure><p id="5ad9" class="pw-post-body-paragraph ny nz gt oa b ob ox od oe of oy oh oi oj oz ol om on pa op oq or pb ot ou ov gm bj" data-selectable-paragraph="">The major problem with this, is that it does not show <em class="qo">who</em> was added to the access policy. Therefore, the only way to determine who was added, is to go into each vault and determine if all users on the access policy are meant to be there.</p><h2 id="9f43" class="pz nb gt be nc qa qb dx ng qc qd dz nk oj qe qf qg on qh qi qj or qk ql qm qn bj" data-selectable-paragraph=""><strong class="al">Runbooks</strong></h2><p id="c3b1" class="pw-post-body-paragraph ny nz gt oa b ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov gm bj" data-selectable-paragraph="">In <a class="af ow" href="https://github.com/hausec/PowerZure" rel="noopener ugc nofollow" target="_blank">PowerZure</a>, a function that takes advantages of Runbooks is Create-Backdoor. This works by creating a Runbook that will provide a new account and assign it to the Contributor role when executed. Instead of automatically executing, it generates a Webhook URI that can be passed into Execute-Backdoor which will run the Runbook on demand. This requires the Administrative Role because only Administrators can create users in Azure AD. Luckily, creating a Runbook generates several events so detection for this is straight forward. The first key event, is the creation of a Runbook, followed by the creation of a Webhook and then generation of a URI for that Webhook.</p><figure class="pf pg ph pi pj pk pc pd paragraph-image"><div class="pc pd qx"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*XcMIjvggpLYCXbTF2Un5cw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*XcMIjvggpLYCXbTF2Un5cw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*XcMIjvggpLYCXbTF2Un5cw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*XcMIjvggpLYCXbTF2Un5cw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*XcMIjvggpLYCXbTF2Un5cw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*XcMIjvggpLYCXbTF2Un5cw.png 1100w, https://miro.medium.com/v2/resize:fit:756/format:webp/1*XcMIjvggpLYCXbTF2Un5cw.png 756w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 378px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*XcMIjvggpLYCXbTF2Un5cw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*XcMIjvggpLYCXbTF2Un5cw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*XcMIjvggpLYCXbTF2Un5cw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*XcMIjvggpLYCXbTF2Un5cw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*XcMIjvggpLYCXbTF2Un5cw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*XcMIjvggpLYCXbTF2Un5cw.png 1100w, https://miro.medium.com/v2/resize:fit:756/1*XcMIjvggpLYCXbTF2Un5cw.png 756w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 378px"><img alt="" class="bg mh pl c" width="378" height="158" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:473/1*XcMIjvggpLYCXbTF2Un5cw.png"></picture></div><figcaption class="pm fe pn pc pd po pp be b bf z dt" data-selectable-paragraph="">Figure 11: Sequence of operations for ‘Create-Backdoor’ in PowerZure</figcaption></figure><p id="4627" class="pw-post-body-paragraph ny nz gt oa b ob ox od oe of oy oh oi oj oz ol om on pa op oq or pb ot ou ov gm bj" data-selectable-paragraph="">The problem with this, is that the ‘event initiated by’ field is incorrect. The field is always populated with the <em class="qo">tenant</em> Administrator, instead of the person who actually created the Runbook, if the Runbook was created from the command line. To ensure my sanity, I tested this with three different accounts, and every time the event was initiated by my administrative account, even though it wasn’t logged in anywhere.</p><figure class="pf pg ph pi pj pk pc pd paragraph-image"><div role="button" tabindex="0" class="pt pu fi pv bg pw"><div class="pc pd qy"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*K-OZoC6HbwLzIBQ-D5g5jA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*K-OZoC6HbwLzIBQ-D5g5jA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*K-OZoC6HbwLzIBQ-D5g5jA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*K-OZoC6HbwLzIBQ-D5g5jA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*K-OZoC6HbwLzIBQ-D5g5jA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*K-OZoC6HbwLzIBQ-D5g5jA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K-OZoC6HbwLzIBQ-D5g5jA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*K-OZoC6HbwLzIBQ-D5g5jA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*K-OZoC6HbwLzIBQ-D5g5jA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*K-OZoC6HbwLzIBQ-D5g5jA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*K-OZoC6HbwLzIBQ-D5g5jA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*K-OZoC6HbwLzIBQ-D5g5jA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*K-OZoC6HbwLzIBQ-D5g5jA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*K-OZoC6HbwLzIBQ-D5g5jA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bg mh pl c" width="700" height="173" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*K-OZoC6HbwLzIBQ-D5g5jA.png"></picture></div></div><figcaption class="pm fe pn pc pd po pp be b bf z dt" data-selectable-paragraph="">Figure 12: Event Initiated by field shows the tenant admin instead of the actual user for Webhook and Runbook creations when done through CLI.</figcaption></figure><p id="1ddd" class="pw-post-body-paragraph ny nz gt oa b ob ox od oe of oy oh oi oj oz ol om on pa op oq or pb ot ou ov gm bj" data-selectable-paragraph="">As for 1/24/2020, this bug has been submitted to Microsoft and I am currently awaiting their response.</p><p id="fc6c" class="pw-post-body-paragraph ny nz gt oa b ob ox od oe of oy oh oi oj oz ol om on pa op oq or pb ot ou ov gm bj" data-selectable-paragraph="">Update: As of 2/7/2020, this bug is now fixed.</p><h2 id="129d" class="pz nb gt be nc qa qb dx ng qc qd dz nk oj qe qf qg on qh qi qj or qk ql qm qn bj" data-selectable-paragraph=""><strong class="al">Group assignments</strong></h2><p id="0d42" class="pw-post-body-paragraph ny nz gt oa b ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov gm bj" data-selectable-paragraph="">Even if on-premise Activity Directory (AD) is synchronized to AzureAD, it’s not possible to add a user to an on-premise AD group. However, adding a user to a Azure group in Azure does not generate an event under the Activity Log. AzureAD has its own event viewer, called Audit Logs. This does give the necessary details of an operation, however alerts cannot be configured for these events in AzureAD unless the Log Analytics service is being used and AzureAD is configured to send logs to Log Analytics. The alert would then have to be generated from Log Analytics instead of AzureAD’s Audit Logs.</p><h2 id="8758" class="pz nb gt be nc qa qb dx ng qc qd dz nk oj qe qf qg on qh qi qj or qk ql qm qn bj" data-selectable-paragraph=""><strong class="al">Virtual Machine Disks</strong></h2><p id="6a1e" class="pw-post-body-paragraph ny nz gt oa b ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov gm bj" data-selectable-paragraph="">If an attacker compromises an account that is a Global Contributor, they may generate a link to download a VM disk. This can be detected with the operation name ‘Get Disk SAS URI’. The link is not shown in the summary or JSON tab, nor is if the disk was actually downloaded or not. Only a generic event is created with no details other than the disk name.</p><h1 id="c173" class="na nb gt be nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx bj" data-selectable-paragraph="">Defensive Approach</h1><p id="e751" class="pw-post-body-paragraph ny nz gt oa b ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov gm bj" data-selectable-paragraph="">With Azure utilizing role-based access control (RBAC), it should be treated similarly to on-premise AD group membership, meaning it should follow the method of least-privileged access. Assigning the Global Contributor role to a user gives that user a great amount of access and execution capabilities. It is suggested to review which roles are actually necessary for operation within Azure. Azure contains many built-in roles outside of the ‘Global’ roles, which can be viewed <a class="af ow" href="https://docs.microsoft.com/en-us/azure/role-based-access-control/built-in-roles" rel="noopener ugc nofollow" target="_blank">here</a>. In addition, custom role creation is a possibility that may better suit a businesses need.</p><p id="adc9" class="pw-post-body-paragraph ny nz gt oa b ob ox od oe of oy oh oi oj oz ol om on pa op oq or pb ot ou ov gm bj" data-selectable-paragraph="">Following the methodology of least-privileged access, Azure does offer the Privileged Identity Management (PIM) <a class="af ow" href="https://docs.microsoft.com/en-us/azure/active-directory/privileged-identity-management/pim-configure" rel="noopener ugc nofollow" target="_blank">service</a>, for a <a class="af ow" href="https://docs.microsoft.com/en-us/azure/active-directory/privileged-identity-management/subscription-requirements" rel="noopener ugc nofollow" target="_blank">cost</a>, but is heavily recommended.</p><blockquote class="qz ra rb"><p id="a292" class="ny nz qo oa b ob ox od oe of oy oh oi oj oz ol om on pa op oq or pb ot ou ov gm bj" data-selectable-paragraph="">Organizations want to minimize the number of people who have access to secure information or resources, because that reduces the chance of a malicious actor getting that access, or an authorized user inadvertently impacting a sensitive resource. However, users still need to carry out privileged operations in Azure AD, Azure, Office 365, or SaaS apps. Organizations can give users just-in-time (JIT) privileged access to Azure resources and Azure AD. There is a need for oversight for what those users are doing with their administrator privileges. — Microsoft</p></blockquote><p id="69e1" class="pw-post-body-paragraph ny nz gt oa b ob ox od oe of oy oh oi oj oz ol om on pa op oq or pb ot ou ov gm bj" data-selectable-paragraph="">PIM is similar to a Privileged Access Management (PAM) solution, where it gives administrative or privileged access only when needed. PIM can used on a per-resource basis. In the PIM panel, there’s three categories: Eligible, Active, and Expired. Eligible means the user is able request access to that role on that resource. Active means the user actively has that role and does not need approval. Expired means that user is no longer allowed to request access for that role and no longer has it.</p><figure class="pf pg ph pi pj pk pc pd paragraph-image"><div role="button" tabindex="0" class="pt pu fi pv bg pw"><div class="pc pd rc"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*SPqwujA8tJOp6cMVWG4okQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*SPqwujA8tJOp6cMVWG4okQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*SPqwujA8tJOp6cMVWG4okQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*SPqwujA8tJOp6cMVWG4okQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*SPqwujA8tJOp6cMVWG4okQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*SPqwujA8tJOp6cMVWG4okQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SPqwujA8tJOp6cMVWG4okQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*SPqwujA8tJOp6cMVWG4okQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*SPqwujA8tJOp6cMVWG4okQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*SPqwujA8tJOp6cMVWG4okQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*SPqwujA8tJOp6cMVWG4okQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*SPqwujA8tJOp6cMVWG4okQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*SPqwujA8tJOp6cMVWG4okQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*SPqwujA8tJOp6cMVWG4okQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="bg mh pl c" width="700" height="151" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*SPqwujA8tJOp6cMVWG4okQ.png"></picture></div></div><figcaption class="pm fe pn pc pd po pp be b bf z dt" data-selectable-paragraph="">Figure 13: ‘Contrib’ user has allowed to request access to the contributor role for a resource</figcaption></figure><p id="c2a7" class="pw-post-body-paragraph ny nz gt oa b ob ox od oe of oy oh oi oj oz ol om on pa op oq or pb ot ou ov gm bj" data-selectable-paragraph="">For example, if a user was added to PIM for a virtual machine resource and made eligible to request access to the Contributor role, then that user would only have to request to activate their privileges for that virtual machine, while not having to do that for all others. Since roles are hierarchical, if PIM is placed on the subscription, then it would affect all resources within that subscription. With PIM, it doesn’t enable the requirement for the request to be approved by default.</p><figure class="pf pg ph pi pj pk pc pd paragraph-image"><div class="pc pd pe"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*xsWuWVFGQzUn0tJqLNiKLQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*xsWuWVFGQzUn0tJqLNiKLQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*xsWuWVFGQzUn0tJqLNiKLQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*xsWuWVFGQzUn0tJqLNiKLQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*xsWuWVFGQzUn0tJqLNiKLQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*xsWuWVFGQzUn0tJqLNiKLQ.png 1100w, https://miro.medium.com/v2/resize:fit:888/format:webp/1*xsWuWVFGQzUn0tJqLNiKLQ.png 888w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 444px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*xsWuWVFGQzUn0tJqLNiKLQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*xsWuWVFGQzUn0tJqLNiKLQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*xsWuWVFGQzUn0tJqLNiKLQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*xsWuWVFGQzUn0tJqLNiKLQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*xsWuWVFGQzUn0tJqLNiKLQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*xsWuWVFGQzUn0tJqLNiKLQ.png 1100w, https://miro.medium.com/v2/resize:fit:888/1*xsWuWVFGQzUn0tJqLNiKLQ.png 888w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 444px"><img alt="" class="bg mh pl c" width="444" height="461" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:555/1*xsWuWVFGQzUn0tJqLNiKLQ.png"></picture></div><figcaption class="pm fe pn pc pd po pp be b bf z dt" data-selectable-paragraph="">Figure 14: Default activation settings for a role</figcaption></figure><p id="b236" class="pw-post-body-paragraph ny nz gt oa b ob ox od oe of oy oh oi oj oz ol om on pa op oq or pb ot ou ov gm bj" data-selectable-paragraph="">This means that by default, a user could just activate their role whenever they wanted.</p><p id="3ae3" class="pw-post-body-paragraph ny nz gt oa b ob ox od oe of oy oh oi oj oz ol om on pa op oq or pb ot ou ov gm bj" data-selectable-paragraph="">The logging for PIM, however, is properly detailed within Activity Log.</p><figure class="pf pg ph pi pj pk pc pd paragraph-image"><div class="pc pd rd"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*keD1smaMW3byijLKPCOdHQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*keD1smaMW3byijLKPCOdHQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*keD1smaMW3byijLKPCOdHQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*keD1smaMW3byijLKPCOdHQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*keD1smaMW3byijLKPCOdHQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*keD1smaMW3byijLKPCOdHQ.png 1100w, https://miro.medium.com/v2/resize:fit:964/format:webp/1*keD1smaMW3byijLKPCOdHQ.png 964w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 482px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*keD1smaMW3byijLKPCOdHQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*keD1smaMW3byijLKPCOdHQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*keD1smaMW3byijLKPCOdHQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*keD1smaMW3byijLKPCOdHQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*keD1smaMW3byijLKPCOdHQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*keD1smaMW3byijLKPCOdHQ.png 1100w, https://miro.medium.com/v2/resize:fit:964/1*keD1smaMW3byijLKPCOdHQ.png 964w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 482px"><img alt="" class="bg mh pl c" width="482" height="454" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:603/1*keD1smaMW3byijLKPCOdHQ.png"></picture></div><figcaption class="pm fe pn pc pd po pp be b bf z dt" data-selectable-paragraph="">Figure 15: The event summary when a user activates their PIM controlled role. ‘Reader’ activated the role ‘Contributor’ for the Subscription ‘Azure Test’</figcaption></figure><h1 id="3f4f" class="na nb gt be nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx bj" data-selectable-paragraph="">Final Thoughts</h1><p id="01d9" class="pw-post-body-paragraph ny nz gt oa b ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov gm bj" data-selectable-paragraph="">Azure offers several additional services that give more insight into the operations <em class="qo">within</em> resources, such as Log Analytics and Azure Sentinel, however the native logging for operations within Azure itself is not perfect. Hopefully Microsoft will implement more details into Activity Log so defenders can have the full picture of an event instead of requiring additional effort.</p></div></div></div></div></section></div></div></article><div class="ab ca"><div class="ch bg fy fz ga gb"></div></div></div><div></div><div class="m ub uc ud"><div class="bw ue uf bg xt" style="bottom: 0px;"><div class="uh t ui v uj uk ul um un uo ab q cn fi"><div class="up uq ur us ut l"><div class="am l fr uu uv"><div class="h k"><div class="l fi n uw"><button class="af ag ah ai aj ak al am an ao ap aq ar as at ab" data-testid="close-button" aria-label="close"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" class="fj dt fl fk"><path d="M5 5l7 7m7 7l-7-7m0 0l7-7m-7 7l-7 7" stroke="currentColor" stroke-linecap="round"></path></svg></button></div></div><div class="j i d"><div class="l fi n uw"><button class="af ag ah ai aj ak al am an ao ap aq ar as at ab fi ux gp uy uz va vb" data-testid="close-button" aria-label="close"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" class="fj dt fl fk"><path d="M5 5l7 7m7 7l-7-7m0 0l7-7m-7 7l-7 7" stroke="currentColor" stroke-linecap="round"></path></svg></button></div></div></div><div class="ab q jc jd vj vk"><img class="fr uc gh vl" src="https://miro.medium.com/v2/da:true/resize:fit:0/5c50caa54067fd622d2f0fac18392213bf92f6e2fae89b691e62bceb40885e74" loading="lazy" role="presentation"><div class="gx vm hc vn dl vo dm vp vq l"><svg viewBox="0 0 3940 610" class="vc vd ve vf vg hh vh hm vi hr"><path d="M594.79 308.2c0 163.76-131.85 296.52-294.5 296.52S5.8 472 5.8 308.2 137.65 11.69 300.29 11.69s294.5 132.75 294.5 296.51M917.86 308.2c0 154.16-65.93 279.12-147.25 279.12s-147.25-125-147.25-279.12S689.29 29.08 770.61 29.08s147.25 125 147.25 279.12M1050 308.2c0 138.12-23.19 250.08-51.79 250.08s-51.79-112-51.79-250.08 23.19-250.08 51.8-250.08S1050 170.09 1050 308.2M1862.77 37.4l.82-.18v-6.35h-167.48l-155.51 365.5-155.51-365.5h-180.48v6.35l.81.18c30.57 6.9 46.09 17.19 46.09 54.3v434.45c0 37.11-15.58 47.4-46.15 54.3l-.81.18V587H1327v-6.35l-.81-.18c-30.57-6.9-46.09-17.19-46.09-54.3V116.9L1479.87 587h11.33l205.59-483.21V536.9c-2.62 29.31-18 38.36-45.68 44.61l-.82.19v6.3h213.3v-6.3l-.82-.19c-27.71-6.25-43.46-15.3-46.08-44.61l-.14-445.2h.14c0-37.11 15.52-47.4 46.08-54.3m97.43 287.8c3.49-78.06 31.52-134.4 78.56-135.37 14.51.24 26.68 5 36.14 14.16 20.1 19.51 29.55 60.28 28.09 121.21zm-2.11 22h250v-1.05c-.71-59.69-18-106.12-51.34-138-28.82-27.55-71.49-42.71-116.31-42.71h-1c-23.26 0-51.79 5.64-72.09 15.86-23.11 10.7-43.49 26.7-60.45 47.7-27.3 33.83-43.84 79.55-47.86 130.93-.13 1.54-.24 3.08-.35 4.62s-.18 2.92-.25 4.39a332.64 332.64 0 0 0-.36 21.69C1860.79 507 1923.65 600 2035.3 600c98 0 155.07-71.64 169.3-167.8l-7.19-2.53c-25 51.68-69.9 83-121 79.18-69.76-5.22-123.2-75.95-118.35-161.63m532.69 157.68c-8.2 19.45-25.31 30.15-48.24 30.15s-43.89-15.74-58.78-44.34c-16-30.7-24.42-74.1-24.42-125.51 0-107 33.28-176.21 84.79-176.21 21.57 0 38.55 10.7 46.65 29.37zm165.84 76.28c-30.57-7.23-46.09-18-46.09-57V5.28L2424.77 60v6.7l1.14-.09c25.62-2.07 43 1.47 53.09 10.79 7.9 7.3 11.75 18.5 11.75 34.26v71.14c-18.31-11.69-40.09-17.38-66.52-17.38-53.6 0-102.59 22.57-137.92 63.56-36.83 42.72-56.3 101.1-56.3 168.81C2230 518.72 2289.53 600 2378.13 600c51.83 0 93.53-28.4 112.62-76.3V588h166.65v-6.66zm159.29-505.33c0-37.76-28.47-66.24-66.24-66.24-37.59 0-67 29.1-67 66.24s29.44 66.24 67 66.24c37.77 0 66.24-28.48 66.24-66.24m43.84 505.33c-30.57-7.23-46.09-18-46.09-57h-.13V166.65l-166.66 47.85v6.5l1 .09c36.06 3.21 45.93 15.63 45.93 57.77V588h166.8v-6.66zm427.05 0c-30.57-7.23-46.09-18-46.09-57V166.65L3082 212.92v6.52l.94.1c29.48 3.1 38 16.23 38 58.56v226c-9.83 19.45-28.27 31-50.61 31.78-36.23 0-56.18-24.47-56.18-68.9V166.66l-166.66 47.85V221l1 .09c36.06 3.2 45.94 15.62 45.94 57.77v191.27a214.48 214.48 0 0 0 3.47 39.82l3 13.05c14.11 50.56 51.08 77 109 77 49.06 0 92.06-30.37 111-77.89v66h166.66v-6.66zM3934.2 588v-6.67l-.81-.19c-33.17-7.65-46.09-22.07-46.09-51.43v-243.2c0-75.83-42.59-121.09-113.93-121.09-52 0-95.85 30.05-112.73 76.86-13.41-49.6-52-76.86-109.06-76.86-50.12 0-89.4 26.45-106.25 71.13v-69.87l-166.66 45.89v6.54l1 .09c35.63 3.16 45.93 15.94 45.93 57V588h155.5v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66V255.72c7-16.35 21.11-35.72 49-35.72 34.64 0 52.2 24 52.2 71.28V588h155.54v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66v-248a160.45 160.45 0 0 0-2.2-27.68c7.42-17.77 22.34-38.8 51.37-38.8 35.13 0 52.2 23.31 52.2 71.28V588z"></path></svg><h2 class="vr b ob vs vt of vu vv nl vw vx np vy vz nt wa wb wc wd">Sign up to discover human stories that deepen your understanding of the world.</h2></div><div class="ab q jc jd"><div class="we gd bo gx wf hc wg wh wi wj wk wl wm l c"><div class="ab q"><h2 class="be te is z gs bj">Free</h2></div><div class="ti wn l cw"></div><div class="ti ab"><div class="bn l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="be b bf z bj">Distraction-free reading. No ads.</p></div><div class="ti ab"><div class="bn l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="be b bf z bj">Organize your knowledge with lists and highlights.</p></div><div class="ti ab"><div class="bn l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="be b bf z bj">Tell your story. Find your audience.</p></div><div class="ck wo wn l cw"></div><span><a class="be b bf z wp ri wq wr ws wt wu eu ev wv ww wx ez bg fa fb fc bl fd fe" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fdetecting-attacks-within-azure-bdc40f8c0766&amp;source=---post_footer_upsell--bdc40f8c0766---------------------lo_non_moc_upsell-----------" rel="noopener follow">Sign up for free</a></span></div><div class="we gd bo wf wg wi wk wm l c"><div class="ab q"><svg width="64" height="64" viewBox="0 0 64 64" fill="none" class="wy rh dg lz"><path d="M39.64 40.83L33.87 56.7a1.99 1.99 0 0 1-3.74 0l-5.77-15.87a2.02 2.02 0 0 0-1.2-1.2L7.3 33.88a1.99 1.99 0 0 1 0-3.74l15.87-5.77a2.02 2.02 0 0 0 1.2-1.2L30.12 7.3a1.99 1.99 0 0 1 3.74 0l5.77 15.87a2.02 2.02 0 0 0 1.2 1.2l15.86 5.76a1.99 1.99 0 0 1 0 3.74l-15.87 5.77a2.02 2.02 0 0 0-1.2 1.2z" fill="#FFC017"></path></svg><h2 class="be te is z gs bj">Membership</h2></div><div class="ti wn l cw"></div><div class="ti ab"><div class="bn l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="be b bf z bj">Access the best member-only stories.</p></div><div class="ti ab"><div class="bn l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="be b bf z bj">Support independent authors.</p></div><div class="ti ab"><div class="bn l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="be b bf z bj">Listen to audio narrations.</p></div><div class="ti ab"><div class="bn l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="be b bf z bj">Read offline.</p></div><div class="ti ab"><div class="bn l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="be b bf z bj">Join the Partner Program and earn for your writing.</p></div><div class="ck wo wn l cw"></div><span><a class="be b bf z wp ri wq wr ws wt wu eu ev wv ww wx ez bg fa fb fc bl fd fe" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fplans&amp;source=---post_footer_upsell--bdc40f8c0766---------------------lo_non_moc_upsell-----------" rel="noopener follow">Try for 5&nbsp;$/month</a></span></div></div></div></div></div></div></div><div class="ab ca"><div class="ch bg fy fz ga gb"><div class="re rf ab je"><div class="rg ab"><a class="rh ax am ao" href="https://medium.com/tag/cybersecurity?source=post_page-----bdc40f8c0766---------------cybersecurity-----------------" rel="noopener follow"><div class="ri fi cw rj gd rk rl be b bf z bj rm">Cybersecurity</div></a></div><div class="rg ab"><a class="rh ax am ao" href="https://medium.com/tag/security?source=post_page-----bdc40f8c0766---------------security-----------------" rel="noopener follow"><div class="ri fi cw rj gd rk rl be b bf z bj rm">Security</div></a></div><div class="rg ab"><a class="rh ax am ao" href="https://medium.com/tag/cloud-computing?source=post_page-----bdc40f8c0766---------------cloud_computing-----------------" rel="noopener follow"><div class="ri fi cw rj gd rk rl be b bf z bj rm">Cloud Computing</div></a></div><div class="rg ab"><a class="rh ax am ao" href="https://medium.com/tag/cloud?source=post_page-----bdc40f8c0766---------------cloud-----------------" rel="noopener follow"><div class="ri fi cw rj gd rk rl be b bf z bj rm">Cloud</div></a></div><div class="rg ab"><a class="rh ax am ao" href="https://medium.com/tag/azure?source=post_page-----bdc40f8c0766---------------azure-----------------" rel="noopener follow"><div class="ri fi cw rj gd rk rl be b bf z bj rm">Azure</div></a></div></div></div></div><div class="l"></div><footer class="rn ro rp rq rr rs rt ru rv ab q rw io c"><div class="l ae"><div class="ab ca"><div class="ch bg fy fz ga gb"><div class="ab co rx"><div class="ab q kz"><div class="ry l"><span class="l rz sa sb e d"><div class="ab q kz la"><div class="pw-multi-vote-icon fi ji lb lc ld"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspecter-ops-posts%2Fbdc40f8c0766&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fdetecting-attacks-within-azure-bdc40f8c0766&amp;user=Ryan+Hausknecht&amp;userId=9689ed358206&amp;source=-----bdc40f8c0766---------------------clap_footer-----------" rel="noopener follow"><div><div class="bl" aria-hidden="false" aria-describedby="10" aria-labelledby="10"><div class="le ao lf lg lh li am lj lk ll ld"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lm ln lo lp lq lr ls"><div><div class="bl" aria-hidden="false" aria-describedby="86" aria-labelledby="86"><p class="be b du z dt"><button class="af ag ah ai aj ak al am an ao ap aq ar as at zb ma">20<span class="l h g f sc sd"></span></button></p></div></div></div></div></span><span class="l h g f sc sd"><div class="ab q kz la"><div class="pw-multi-vote-icon fi ji lb lc ld"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspecter-ops-posts%2Fbdc40f8c0766&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fdetecting-attacks-within-azure-bdc40f8c0766&amp;user=Ryan+Hausknecht&amp;userId=9689ed358206&amp;source=-----bdc40f8c0766---------------------clap_footer-----------" rel="noopener follow"><div><div class="bl" aria-hidden="false" aria-describedby="11" aria-labelledby="11"><div class="le ao lf lg lh li am lj lk ll ld"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lm ln lo lp lq lr ls"><div><div class="bl" aria-hidden="false" aria-describedby="88" aria-labelledby="88"><p class="be b du z dt"><button class="af ag ah ai aj ak al am an ao ap aq ar as at zb ma">20</button></p></div></div></div></div></span></div><div class="bp ab"><div><div class="bl" aria-hidden="false" aria-describedby="12" aria-labelledby="12"><button class="ao le lu lv ab q fj lw lx" aria-label="responses"><svg width="24" height="24" viewBox="0 0 24 24" class="ly"><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></button></div></div></div></div><div class="ab q"><div class="se l jb"><div><div class="bl" aria-hidden="false" aria-describedby="13" aria-labelledby="13"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fbdc40f8c0766&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fdetecting-attacks-within-azure-bdc40f8c0766&amp;source=--------------------------bookmark_footer-----------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div><div class="se l jb"><div class="bl" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bl" aria-hidden="false" aria-describedby="14" aria-labelledby="14"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fj ah ai aj ak al mi an ao ap ew mj mk lx ml"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.22 4.93a.42.42 0 0 1-.12.13h.01a.45.45 0 0 1-.29.08.52.52 0 0 1-.3-.13L12.5 3v7.07a.5.5 0 0 1-.5.5.5.5 0 0 1-.5-.5V3.02l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.8a.42.42 0 0 1 .07.5zm-.1.14zm.88 2h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11a2 2 0 0 1-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.14c.1.1.15.22.15.35a.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9V8.96c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1z" fill="currentColor"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="sf sg sh si sj l bw"><div class="ab ca"><div class="ch bg fy fz ga gb"><div class="ck ab sk co"><div class="ab ie"><a href="https://medium.com/@hausec?source=post_page-----bdc40f8c0766--------------------------------" rel="noopener follow"><div class="l sl sm bx sn ii"><div class="l fi"><img alt="Ryan Hausknecht" class="l fc bx so sp cw" src="https://miro.medium.com/v2/resize:fill:144:144/2*LFdW-NbzZFmNHuopdXF2Wg.png" width="72" height="72" loading="lazy"><div class="ij bx l so sp fr n ik fs"></div></div></div></a><a href="https://posts.specterops.io/?source=post_page-----bdc40f8c0766--------------------------------" rel="noopener follow"><div class="sq ab fi"><div><div class="bl" aria-hidden="false" aria-describedby="15" aria-labelledby="15"><div class="l sr ss bx sn io"><div class="l fi"><img alt="Posts By SpecterOps Team Members" class="l fc bx by bz cw" src="https://miro.medium.com/v2/resize:fill:64:64/1*D-FDlfkqivRBQZoESrwtqw.png" width="32" height="32" loading="lazy"><div class="ij bx l by bz fr n ik fs"></div></div></div></div></div></div></a></div><div class="j i d"><div class="ab"><span><a class="be b bf z eo ri ep eq er es et eu ev ew ex ey ez st fa fb fc bl fd fe" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9689ed358206&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fdetecting-attacks-within-azure-bdc40f8c0766&amp;user=Ryan+Hausknecht&amp;userId=9689ed358206&amp;source=post_page-9689ed358206----bdc40f8c0766---------------------follow_profile-----------" rel="noopener follow">Follow</a></span><div class="ds l"><div><div><div class="bl" aria-hidden="false" aria-describedby="115" aria-labelledby="115"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fca0f6466d12d&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fdetecting-attacks-within-azure-bdc40f8c0766&amp;newsletterV3=9689ed358206&amp;newsletterV3Id=ca0f6466d12d&amp;user=Ryan+Hausknecht&amp;userId=9689ed358206&amp;source=-----bdc40f8c0766---------------------subscribe_user-----------" rel="noopener follow"><button class="be b bf z eo am ep eq er es et eu ev ew ex ey ez fa fb fc bl fd fe" aria-label="Subscribe"><svg width="38" height="38" viewBox="0 0 38 38" fill="none" class="za ss sr"><rect x="26.25" y="9.25" width="0.5" height="6.5" rx="0.25"></rect><rect x="29.75" y="12.25" width="0.5" height="6.5" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5L19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="ab cm co"><div class="l"><div class="ab q"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab q" href="https://medium.com/@hausec?source=post_page-----bdc40f8c0766--------------------------------" rel="noopener follow"><h2 class="pw-author-name be te tf tg th bj"><span class="gm js">Written by <!-- -->Ryan Hausknecht</span></h2></a></div><div class="rg ab"><div class="l jb"><span class="pw-follower-count be b bf z bj"><a class="af ag ah ai aj ak al am an ao ap aq ar iu" href="https://medium.com/@hausec/followers?source=post_page-----bdc40f8c0766--------------------------------" rel="noopener follow">368 Followers</a></span></div><div class="be b bf z jj jk jl ab jn jo jp jq dt jh"><span class="iv l" aria-hidden="true"><span class="be b bf z dt">·</span></span><span class="l jb">Writer for </span><div><div class="l" aria-hidden="false" aria-describedby="17" aria-labelledby="17"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://posts.specterops.io/?source=post_page-----bdc40f8c0766--------------------------------" rel="noopener follow"><p class="be b bf z jj jk jl jm jn jo jp jq bj">Posts By SpecterOps Team Members</p></a></div></div></div></div><div class="ti l"><p class="be b bf z bj"><span class="gm">Security Consultant @ SpecterOps</span></p></div></div><div class="h k"><div class="ab"><span><a class="be b bf z eo ri ep eq er es et eu ev ew ex ey ez st fa fb fc bl fd fe" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9689ed358206&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fdetecting-attacks-within-azure-bdc40f8c0766&amp;user=Ryan+Hausknecht&amp;userId=9689ed358206&amp;source=post_page-9689ed358206----bdc40f8c0766---------------------follow_profile-----------" rel="noopener follow">Follow</a></span><div class="ds l"><div><div><div class="bl" aria-hidden="false" aria-describedby="117" aria-labelledby="117"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fca0f6466d12d&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fdetecting-attacks-within-azure-bdc40f8c0766&amp;newsletterV3=9689ed358206&amp;newsletterV3Id=ca0f6466d12d&amp;user=Ryan+Hausknecht&amp;userId=9689ed358206&amp;source=-----bdc40f8c0766---------------------subscribe_user-----------" rel="noopener follow"><button class="be b bf z eo am ep eq er es et eu ev ew ex ey ez fa fb fc bl fd fe" aria-label="Subscribe"><svg width="38" height="38" viewBox="0 0 38 38" fill="none" class="za ss sr"><rect x="26.25" y="9.25" width="0.5" height="6.5" rx="0.25"></rect><rect x="29.75" y="12.25" width="0.5" height="6.5" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5L19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="tj bg tk tl tm tn to tp"></div></div></div><div class="ab ca"><div class="ch bg fy fz ga gb"><div class="zc zd l"><h2 class="be te is z gs bj">More from Ryan Hausknecht and Posts By SpecterOps Team Members</h2></div><div class="ze ab kz je zf zg zh zi zj zk zl zm zn zo zp zq zr zs zt"><div class="zu zv zw zx zy zz aba abb abc abd abe abf yt abg abh abi yu abj abk abl abm"><div class="abn abo abp abq abr dv l"><article class="dv"><div class="dv rv l"><div class="bg dv"><div class="dv l"><div class="fi dv abs abt abu abv abw abx aby abz aca acb acc acd ace" role="link" data-href="https://posts.specterops.io/offensive-lateral-movement-1744ae62b14f" tabindex="0"><div class="acf"><div aria-label="Offensive Lateral Movement"><div class="ach aci acj ack acl"><img alt="Offensive Lateral Movement" class="bg acm acn aco acp bw" src="https://miro.medium.com/v2/resize:fit:849/0*IPJqjjaMPHExo4qN.png" loading="lazy"></div></div></div><div class="acg ab ca cn"><div class="ab cn acq bg acr acs act acu"><div class="vd vf acv acw acx ab q"><div class="rh l"><div><div class="l" aria-hidden="false" aria-describedby="118" aria-labelledby="118"><a tabindex="-1" href="https://medium.com/@hausec?source=author_recirc-----bdc40f8c0766----0---------------------2b795de0_4670_4793_bd58_c37efb186585-------" rel="noopener follow"><div class="l fi"><img alt="Ryan Hausknecht" class="l fc bx acy acz cw" src="https://miro.medium.com/v2/resize:fill:25:25/2*LFdW-NbzZFmNHuopdXF2Wg.png" width="20" height="20" loading="lazy"><div class="fq bx l acy acz fr n ax fs"></div></div></a></div></div></div><div class="ada l"><div><div class="l" aria-hidden="false" aria-describedby="119" aria-labelledby="119"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://medium.com/@hausec?source=author_recirc-----bdc40f8c0766----0---------------------2b795de0_4670_4793_bd58_c37efb186585-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Ryan Hausknecht</p></a></div></div></div><div class="ada l"><p class="be b du z dt">in</p></div><div class="l"><div><div class="l" aria-hidden="false" aria-describedby="120" aria-labelledby="120"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://posts.specterops.io/?source=author_recirc-----bdc40f8c0766----0---------------------2b795de0_4670_4793_bd58_c37efb186585-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Posts By SpecterOps Team Members</p></a></div></div></div></div><div class="adb l adc add ade adf adg gm"><div class="adh adi adj adk adl adm adn ado"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/offensive-lateral-movement-1744ae62b14f?source=author_recirc-----bdc40f8c0766----0---------------------2b795de0_4670_4793_bd58_c37efb186585-------"><div title=""><h2 class="be gu nd nf adp adq ng nh nj adr ads nk oj qf adt adu qg on qi adv adw qj or ql adx ady qm jj jl jm jo jq bj">Offensive Lateral Movement</h2></div><div class="adz l"><h3 class="be b is z jj aea jl jm aeb jo jq dt">Lateral movement is the process of moving from one compromised host to another. Penetration testers and red teamers alike commonly used to…</h3></div></a></div></div><span class="be b du z dt"><div class="ig ab co ae"><div class="ab q"><span>Aug 16, 2019</span><div class=""><div class="fi aec dg ab q"><div class="fr xc aed ab q"><div class="aw dg di l cw"></div></div><a class="fr lu aed ab q" tabindex="-1" rel="noopener follow" href="/offensive-lateral-movement-1744ae62b14f?source=author_recirc-----bdc40f8c0766----0---------------------2b795de0_4670_4793_bd58_c37efb186585-------"><div class="aw l"><div><div class="ab" aria-hidden="false" aria-describedby="173" aria-labelledby="173"><div class="ab q fi"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.67 10.17l2.14 2.14c1.72 1.72 4.33 2.43 5.96.8a4.38 4.38 0 0 0 .76-5.38L10.7 4.25c-.35-.53-.85-1.22-1.33-.96-.5.26 0 1.56 0 1.56l.78 1.93-3.73-3.91C5.6 1.9 4.96 1.76 4.5 2.22c-.33.33-.26.85.48 1.6.5.5 1.89 1.95 1.89 1.95.17.18.08.49-.1.66-.09.1-.2.15-.34.16a.43.43 0 0 1-.31-.13l-2.8-2.87c-.35-.35-.8-.54-1.2-.15-.4.4-.27 1.06.11 1.44l2.69 2.67.06.06c.17.18.27.63.1.8-.2.2-.46.33-.69.28a.92.92 0 0 1-.44-.28S2.5 6.84 1.89 6.23c-.4-.4-.9-.33-1.23 0-.52.52.27 1.28 1.73 2.7.39.36.82.77 1.28 1.24zm8.47-7.22c.38-.3.95-.28 1.3.24l1.57 3a5 5 0 0 1-.48 5.24l-.03.04c-.21.27-.35.43-.74.61 1.38-1.85.96-3.47-.25-5.45l-1.57-2.75v-.04c-.02-.3-.04-.7.2-.9z" fill="#6B6B6B"></path></svg><span style="margin-left: 4px;">129</span></div></div></div></div></a></div></div></div><div class="ab q aee aef"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="121" aria-labelledby="121"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1744ae62b14f&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Foffensive-lateral-movement-1744ae62b14f&amp;source=-----bdc40f8c0766----0-----------------bookmark_preview----2b795de0_4670_4793_bd58_c37efb186585-------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma aeg" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></span><div class="j i d"><div class="tj bg tk ly"></div></div></div></div></div></div></div></div></article></div></div><div class="zu zv zw zx zy zz aba abb abc abd abe abf yt abg abh abi yu abj abk abl abm"><div class="abn abo abp abq abr dv l"><article class="dv"><div class="dv rv l"><div class="bg dv"><div class="dv l"><div class="fi dv abs abt abu abv abw abx aby abz aca acb acc acd ace" role="link" data-href="https://posts.specterops.io/certified-pre-owned-d95910965cd2" tabindex="0"><div class="acf"><div aria-label="Certified Pre-Owned"><div class="ach aci acj ack acl"><img alt="Certified Pre-Owned" class="bg acm acn aco acp bw" src="https://miro.medium.com/v2/resize:fit:849/0*uf2o4Dwroh6Xb77l" loading="lazy"></div></div></div><div class="acg ab ca cn"><div class="ab cn acq bg acr acs act acu"><div class="vd vf acv acw acx ab q"><div class="rh l"><div><div class="l" aria-hidden="false" aria-describedby="122" aria-labelledby="122"><a tabindex="-1" href="https://harmj0y.medium.com/?source=author_recirc-----bdc40f8c0766----1---------------------2b795de0_4670_4793_bd58_c37efb186585-------" rel="noopener follow"><div class="l fi"><img alt="Will Schroeder" class="l fc bx acy acz cw" src="https://miro.medium.com/v2/resize:fill:25:25/1*idzSM22ouVWVRLUiU5Kpkg.jpeg" width="20" height="20" loading="lazy"><div class="fq bx l acy acz fr n ax fs"></div></div></a></div></div></div><div class="ada l"><div><div class="l" aria-hidden="false" aria-describedby="123" aria-labelledby="123"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://harmj0y.medium.com/?source=author_recirc-----bdc40f8c0766----1---------------------2b795de0_4670_4793_bd58_c37efb186585-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Will Schroeder</p></a></div></div></div><div class="ada l"><p class="be b du z dt">in</p></div><div class="l"><div><div class="l" aria-hidden="false" aria-describedby="124" aria-labelledby="124"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://posts.specterops.io/?source=author_recirc-----bdc40f8c0766----1---------------------2b795de0_4670_4793_bd58_c37efb186585-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Posts By SpecterOps Team Members</p></a></div></div></div></div><div class="adb l adc add ade adf adg gm"><div class="adh adi adj adk adl adm adn ado"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/certified-pre-owned-d95910965cd2?source=author_recirc-----bdc40f8c0766----1---------------------2b795de0_4670_4793_bd58_c37efb186585-------"><div title=""><h2 class="be gu nd nf adp adq ng nh nj adr ads nk oj qf adt adu qg on qi adv adw qj or ql adx ady qm jj jl jm jo jq bj">Certified Pre-Owned</h2></div><div class="adz l"><h3 class="be b is z jj aea jl jm aeb jo jq dt">Active Directory Certificate Services has a lot of attack potential!</h3></div></a></div></div><span class="be b du z dt"><div class="ig ab co ae"><div class="ab q"><span>Jun 17, 2021</span><div class=""><div class="fi aec dg ab q"><div class="fr xc aed ab q"><div class="aw dg di l cw"></div></div><a class="fr lu aed ab q" tabindex="-1" rel="noopener follow" href="/certified-pre-owned-d95910965cd2?source=author_recirc-----bdc40f8c0766----1---------------------2b795de0_4670_4793_bd58_c37efb186585-------"><div class="aw l"><div><div class="ab" aria-hidden="false" aria-describedby="174" aria-labelledby="174"><div class="ab q fi"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.67 10.17l2.14 2.14c1.72 1.72 4.33 2.43 5.96.8a4.38 4.38 0 0 0 .76-5.38L10.7 4.25c-.35-.53-.85-1.22-1.33-.96-.5.26 0 1.56 0 1.56l.78 1.93-3.73-3.91C5.6 1.9 4.96 1.76 4.5 2.22c-.33.33-.26.85.48 1.6.5.5 1.89 1.95 1.89 1.95.17.18.08.49-.1.66-.09.1-.2.15-.34.16a.43.43 0 0 1-.31-.13l-2.8-2.87c-.35-.35-.8-.54-1.2-.15-.4.4-.27 1.06.11 1.44l2.69 2.67.06.06c.17.18.27.63.1.8-.2.2-.46.33-.69.28a.92.92 0 0 1-.44-.28S2.5 6.84 1.89 6.23c-.4-.4-.9-.33-1.23 0-.52.52.27 1.28 1.73 2.7.39.36.82.77 1.28 1.24zm8.47-7.22c.38-.3.95-.28 1.3.24l1.57 3a5 5 0 0 1-.48 5.24l-.03.04c-.21.27-.35.43-.74.61 1.38-1.85.96-3.47-.25-5.45l-1.57-2.75v-.04c-.02-.3-.04-.7.2-.9z" fill="#6B6B6B"></path></svg><span style="margin-left: 4px;">480</span></div></div></div></div><div class="aw l"><div><div class="ab" aria-hidden="false" aria-describedby="125" aria-labelledby="125"><div class="ab q fi"><svg width="16" height="16" viewBox="0 0 16 16" fill="#6B6B6B"><path d="M12.34 11.46A5.28 5.28 0 0 0 14 7.53C14 4.48 11.4 2 8.05 2 4.71 2 2 4.48 2 7.53c0 3.05 2.71 5.52 6.06 5.52.6 0 1.18-.08 1.76-.23.17.14.35.29.55.41.78.51 1.63.77 2.51.77.17 0 .3-.08.36-.22a.37.37 0 0 0-.03-.38 4.73 4.73 0 0 1-.86-1.96v.02z" fill="#6B6B6B"></path></svg><span style="margin-left: 4px;">4</span></div></div></div></div></a></div></div></div><div class="ab q aee aef"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="126" aria-labelledby="126"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fd95910965cd2&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcertified-pre-owned-d95910965cd2&amp;source=-----bdc40f8c0766----1-----------------bookmark_preview----2b795de0_4670_4793_bd58_c37efb186585-------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma aeg" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></span><div class="j i d"><div class="tj bg tk ly"></div></div></div></div></div></div></div></div></article></div></div><div class="zu zv zw zx zy zz aba abb abc abd abe abf yt abg abh abi yu abj abk abl abm"><div class="abn abo abp abq abr dv l"><article class="dv"><div class="dv rv l"><div class="bg dv"><div class="dv l"><div class="fi dv abs abt abu abv abw abx aby abz aca acb acc acd ace" role="link" data-href="https://posts.specterops.io/an-introduction-to-manual-active-directory-querying-with-dsquery-and-ldapsearch-84943c13d7eb" tabindex="0"><div class="acf"><div aria-label="An Introduction to Manual Active Directory Querying with Dsquery and Ldapsearch"><div class="ach aci acj ack acl"><img alt="An Introduction to Manual Active Directory Querying with Dsquery and Ldapsearch" class="bg acm acn aco acp bw" src="https://miro.medium.com/v2/resize:fit:849/1*ckMjsbf15mZr_nvv8kxYXw.png" loading="lazy"></div></div></div><div class="acg ab ca cn"><div class="ab cn acq bg acr acs act acu"><div class="vd vf acv acw acx ab q"><div class="rh l"><div><div class="l" aria-hidden="false" aria-describedby="127" aria-labelledby="127"><a tabindex="-1" href="https://medium.com/@Ice_Moon?source=author_recirc-----bdc40f8c0766----2---------------------2b795de0_4670_4793_bd58_c37efb186585-------" rel="noopener follow"><div class="l fi"><img alt="Hope Walker" class="l fc bx acy acz cw" src="https://miro.medium.com/v2/resize:fill:25:25/0*1dLPs8bH356Tkfng.jpg" width="20" height="20" loading="lazy"><div class="fq bx l acy acz fr n ax fs"></div></div></a></div></div></div><div class="ada l"><div><div class="l" aria-hidden="false" aria-describedby="128" aria-labelledby="128"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://medium.com/@Ice_Moon?source=author_recirc-----bdc40f8c0766----2---------------------2b795de0_4670_4793_bd58_c37efb186585-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Hope Walker</p></a></div></div></div><div class="ada l"><p class="be b du z dt">in</p></div><div class="l"><div><div class="l" aria-hidden="false" aria-describedby="129" aria-labelledby="129"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://posts.specterops.io/?source=author_recirc-----bdc40f8c0766----2---------------------2b795de0_4670_4793_bd58_c37efb186585-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Posts By SpecterOps Team Members</p></a></div></div></div></div><div class="adb l adc add ade adf adg gm"><div class="adh adi adj adk adl adm adn ado"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/an-introduction-to-manual-active-directory-querying-with-dsquery-and-ldapsearch-84943c13d7eb?source=author_recirc-----bdc40f8c0766----2---------------------2b795de0_4670_4793_bd58_c37efb186585-------"><div title="An Introduction to Manual Active Directory Querying with Dsquery and Ldapsearch"><h2 class="be gu nd nf adp adq ng nh nj adr ads nk oj qf adt adu qg on qi adv adw qj or ql adx ady qm jj jl jm jo jq bj">An Introduction to Manual Active Directory Querying with Dsquery and Ldapsearch</h2></div><div class="adz l"><h3 class="be b is z jj aea jl jm aeb jo jq dt">Introduction</h3></div></a></div></div><span class="be b du z dt"><div class="ig ab co ae"><div class="ab q"><span>Jun 2, 2021</span><div class=""><div class="fi aec dg ab q"><div class="fr xc aed ab q"><div class="aw dg di l cw"></div></div><a class="fr lu aed ab q" tabindex="-1" rel="noopener follow" href="/an-introduction-to-manual-active-directory-querying-with-dsquery-and-ldapsearch-84943c13d7eb?source=author_recirc-----bdc40f8c0766----2---------------------2b795de0_4670_4793_bd58_c37efb186585-------"><div class="aw l"><div><div class="ab" aria-hidden="false" aria-describedby="176" aria-labelledby="176"><div class="ab q fi"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.67 10.17l2.14 2.14c1.72 1.72 4.33 2.43 5.96.8a4.38 4.38 0 0 0 .76-5.38L10.7 4.25c-.35-.53-.85-1.22-1.33-.96-.5.26 0 1.56 0 1.56l.78 1.93-3.73-3.91C5.6 1.9 4.96 1.76 4.5 2.22c-.33.33-.26.85.48 1.6.5.5 1.89 1.95 1.89 1.95.17.18.08.49-.1.66-.09.1-.2.15-.34.16a.43.43 0 0 1-.31-.13l-2.8-2.87c-.35-.35-.8-.54-1.2-.15-.4.4-.27 1.06.11 1.44l2.69 2.67.06.06c.17.18.27.63.1.8-.2.2-.46.33-.69.28a.92.92 0 0 1-.44-.28S2.5 6.84 1.89 6.23c-.4-.4-.9-.33-1.23 0-.52.52.27 1.28 1.73 2.7.39.36.82.77 1.28 1.24zm8.47-7.22c.38-.3.95-.28 1.3.24l1.57 3a5 5 0 0 1-.48 5.24l-.03.04c-.21.27-.35.43-.74.61 1.38-1.85.96-3.47-.25-5.45l-1.57-2.75v-.04c-.02-.3-.04-.7.2-.9z" fill="#6B6B6B"></path></svg><span style="margin-left: 4px;">90</span></div></div></div></div><div class="aw l"><div><div class="ab" aria-hidden="false" aria-describedby="130" aria-labelledby="130"><div class="ab q fi"><svg width="16" height="16" viewBox="0 0 16 16" fill="#6B6B6B"><path d="M12.34 11.46A5.28 5.28 0 0 0 14 7.53C14 4.48 11.4 2 8.05 2 4.71 2 2 4.48 2 7.53c0 3.05 2.71 5.52 6.06 5.52.6 0 1.18-.08 1.76-.23.17.14.35.29.55.41.78.51 1.63.77 2.51.77.17 0 .3-.08.36-.22a.37.37 0 0 0-.03-.38 4.73 4.73 0 0 1-.86-1.96v.02z" fill="#6B6B6B"></path></svg><span style="margin-left: 4px;">3</span></div></div></div></div></a></div></div></div><div class="ab q aee aef"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="131" aria-labelledby="131"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F84943c13d7eb&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fan-introduction-to-manual-active-directory-querying-with-dsquery-and-ldapsearch-84943c13d7eb&amp;source=-----bdc40f8c0766----2-----------------bookmark_preview----2b795de0_4670_4793_bd58_c37efb186585-------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma aeg" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></span><div class="j i d"><div class="tj bg tk ly"></div></div></div></div></div></div></div></div></article></div></div><div class="zu zv zw zx zy zz aba abb abc abd abe abf yt abg abh abi yu abj abk abl abm"><div class="abn abo abp abq abr dv l"><article class="dv"><div class="dv rv l"><div class="bg dv"><div class="dv l"><div class="fi dv abs abt abu abv abw abx aby abz aca acb acc acd ace" role="link" data-href="https://posts.specterops.io/kerberosity-killed-the-domain-an-offensive-kerberos-overview-eb04b1402c61" tabindex="0"><div class="acf"><div aria-label="Kerberosity Killed the Domain: An Offensive Kerberos Overview"><div class="ach aci acj ack acl"><img alt="Kerberosity Killed the Domain: An Offensive Kerberos Overview" class="bg acm acn aco acp bw" src="https://miro.medium.com/v2/resize:fit:849/0*ncY0dHeut-uZst9g.png" loading="lazy"></div></div></div><div class="acg ab ca cn"><div class="ab cn acq bg acr acs act acu"><div class="vd vf acv acw acx ab q"><div class="rh l"><div><div class="l" aria-hidden="false" aria-describedby="132" aria-labelledby="132"><a tabindex="-1" href="https://medium.com/@hausec?source=author_recirc-----bdc40f8c0766----3---------------------2b795de0_4670_4793_bd58_c37efb186585-------" rel="noopener follow"><div class="l fi"><img alt="Ryan Hausknecht" class="l fc bx acy acz cw" src="https://miro.medium.com/v2/resize:fill:25:25/2*LFdW-NbzZFmNHuopdXF2Wg.png" width="20" height="20" loading="lazy"><div class="fq bx l acy acz fr n ax fs"></div></div></a></div></div></div><div class="ada l"><div><div class="l" aria-hidden="false" aria-describedby="133" aria-labelledby="133"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://medium.com/@hausec?source=author_recirc-----bdc40f8c0766----3---------------------2b795de0_4670_4793_bd58_c37efb186585-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Ryan Hausknecht</p></a></div></div></div><div class="ada l"><p class="be b du z dt">in</p></div><div class="l"><div><div class="l" aria-hidden="false" aria-describedby="134" aria-labelledby="134"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://posts.specterops.io/?source=author_recirc-----bdc40f8c0766----3---------------------2b795de0_4670_4793_bd58_c37efb186585-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Posts By SpecterOps Team Members</p></a></div></div></div></div><div class="adb l adc add ade adf adg gm"><div class="adh adi adj adk adl adm adn ado"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/kerberosity-killed-the-domain-an-offensive-kerberos-overview-eb04b1402c61?source=author_recirc-----bdc40f8c0766----3---------------------2b795de0_4670_4793_bd58_c37efb186585-------"><div title=""><h2 class="be gu nd nf adp adq ng nh nj adr ads nk oj qf adt adu qg on qi adv adw qj or ql adx ady qm jj jl jm jo jq bj">Kerberosity Killed the Domain: An Offensive Kerberos Overview</h2></div><div class="adz l"><h3 class="be b is z jj aea jl jm aeb jo jq dt">Kerberos is the preferred way of authentication in a Windows domain, with NTLM being the alternative. Kerberos authentication is a very…</h3></div></a></div></div><span class="be b du z dt"><div class="ig ab co ae"><div class="ab q"><span>Mar 10, 2020</span><div class=""><div class="fi aec dg ab q"><div class="fr xc aed ab q"><div class="aw dg di l cw"></div></div><a class="fr lu aed ab q" tabindex="-1" rel="noopener follow" href="/kerberosity-killed-the-domain-an-offensive-kerberos-overview-eb04b1402c61?source=author_recirc-----bdc40f8c0766----3---------------------2b795de0_4670_4793_bd58_c37efb186585-------"><div class="aw l"><div><div class="ab" aria-hidden="false" aria-describedby="178" aria-labelledby="178"><div class="ab q fi"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.67 10.17l2.14 2.14c1.72 1.72 4.33 2.43 5.96.8a4.38 4.38 0 0 0 .76-5.38L10.7 4.25c-.35-.53-.85-1.22-1.33-.96-.5.26 0 1.56 0 1.56l.78 1.93-3.73-3.91C5.6 1.9 4.96 1.76 4.5 2.22c-.33.33-.26.85.48 1.6.5.5 1.89 1.95 1.89 1.95.17.18.08.49-.1.66-.09.1-.2.15-.34.16a.43.43 0 0 1-.31-.13l-2.8-2.87c-.35-.35-.8-.54-1.2-.15-.4.4-.27 1.06.11 1.44l2.69 2.67.06.06c.17.18.27.63.1.8-.2.2-.46.33-.69.28a.92.92 0 0 1-.44-.28S2.5 6.84 1.89 6.23c-.4-.4-.9-.33-1.23 0-.52.52.27 1.28 1.73 2.7.39.36.82.77 1.28 1.24zm8.47-7.22c.38-.3.95-.28 1.3.24l1.57 3a5 5 0 0 1-.48 5.24l-.03.04c-.21.27-.35.43-.74.61 1.38-1.85.96-3.47-.25-5.45l-1.57-2.75v-.04c-.02-.3-.04-.7.2-.9z" fill="#6B6B6B"></path></svg><span style="margin-left: 4px;">66</span></div></div></div></div></a></div></div></div><div class="ab q aee aef"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="135" aria-labelledby="135"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Feb04b1402c61&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fkerberosity-killed-the-domain-an-offensive-kerberos-overview-eb04b1402c61&amp;source=-----bdc40f8c0766----3-----------------bookmark_preview----2b795de0_4670_4793_bd58_c37efb186585-------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma aeg" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></span></div></div></div></div></div></div></article></div></div></div><div class="tj bg tk dj dk aeh aei aej"></div><div class="ab jc jd aek ael aem"><a class="be b bf z bj ri aen aeo aep ma lw wu eu ev ew aeq aer aes ez wf wg aet aeu aev fa fb fc bl fd fe" href="https://medium.com/@hausec?source=post_page-----bdc40f8c0766--------------------------------" rel="noopener follow"><div class="l fe">See all from Ryan Hausknecht</div></a><div class="aew aex aey aez afa afb afc afd afe ls l"><a class="be b bf z bj ri aen aeo aep ma lw wu eu ev ew aeq aer aes ez wf wg aet aeu aev fa fb fc bl fd fe" href="https://posts.specterops.io/?source=post_page-----bdc40f8c0766--------------------------------" rel="noopener follow"><div class="l fe">See all from Posts By SpecterOps Team Members</div></a></div></div></div></div><div class="tj bg tk aff afg afh afi afj"></div><div class="ab ca"><div class="ch bg fy fz ga gb"><div class="afk afl l"><h2 class="be te nd nf ng nh nj nk nl nn no np nr ns nt nv nw bj">Recommended from Medium</h2><div class="pf pg ph pi pj l"><div class="ze ab kz je zf zg zh zi zj zk zl zm zn zo zp zq zr zs zt"><div class="zu zv zw zx zy zz aba abb abc abd abe abf yt abg abh abi yu abj abk abl abm"><div class="abn abo abp abq abr dv l"><article class="dv"><div class="dv rv l"><div class="bg dv"><div class="dv l"><div class="fi dv abs abt abu abv abw abx aby abz aca acb acc acd ace" role="link" data-href="https://medium.com/r3d-buck3t/red-teaming-in-cloud-leverage-azure-frontdoor-cdn-for-c2-redirectors-79dd9ca98178" tabindex="0"><div class="acf"><div aria-label="Red Teaming in Cloud: Leverage Azure FrontDoor CDN for C2 Redirectors"><div class="ach aci acj ack acl"><img alt="Red Teaming in Cloud: Leverage Azure FrontDoor CDN for C2 Redirectors" class="bg acm acn aco acp bw" src="https://miro.medium.com/v2/resize:fit:849/1*kTru0_882oqHwY0QXscLNw.jpeg" loading="lazy"></div></div></div><div class="acg ab ca cn"><div class="ab cn acq bg acr acs act acu"><div class="vd vf acv acw acx ab q"><div class="rh l"><div><div class="l" aria-hidden="false" aria-describedby="136" aria-labelledby="136"><a tabindex="-1" href="https://nairuzabulhul.medium.com/?source=read_next_recirc-----bdc40f8c0766----0---------------------82a915b0_9a75_4642_96d8_29eff35aeade-------" rel="noopener follow"><div class="l fi"><img alt="Nairuz Abulhul" class="l fc bx acy acz cw" src="https://miro.medium.com/v2/resize:fill:25:25/0*kBFFDUVEn3zxUrt7.jpg" width="20" height="20" loading="lazy"><div class="fq bx l acy acz fr n ax fs"></div></div></a></div></div></div><div class="ada l"><div><div class="l" aria-hidden="false" aria-describedby="137" aria-labelledby="137"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://nairuzabulhul.medium.com/?source=read_next_recirc-----bdc40f8c0766----0---------------------82a915b0_9a75_4642_96d8_29eff35aeade-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Nairuz Abulhul</p></a></div></div></div><div class="ada l"><p class="be b du z dt">in</p></div><div class="l"><div><div class="l" aria-hidden="false" aria-describedby="138" aria-labelledby="138"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://medium.com/r3d-buck3t?source=read_next_recirc-----bdc40f8c0766----0---------------------82a915b0_9a75_4642_96d8_29eff35aeade-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">R3d Buck3T</p></a></div></div></div></div><div class="adb l adc add ade adf adg gm"><div class="adh adi adj adk adl adm adn ado"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/r3d-buck3t/red-teaming-in-cloud-leverage-azure-frontdoor-cdn-for-c2-redirectors-79dd9ca98178?source=read_next_recirc-----bdc40f8c0766----0---------------------82a915b0_9a75_4642_96d8_29eff35aeade-------" rel="noopener follow"><div title=""><h2 class="be gu nd nf adp adq ng nh nj adr ads nk oj qf adt adu qg on qi adv adw qj or ql adx ady qm jj jl jm jo jq bj">Red Teaming in Cloud: Leverage Azure FrontDoor CDN for C2 Redirectors</h2></div><div class="adz l"><h3 class="be b is z jj aea jl jm aeb jo jq dt">Evading Detection: Obfuscating C2 Infrastructure with Azure FrontDoor</h3></div></a></div></div><span class="be b du z dt"><div class="ig ab co ae"><div class="ab q"><span>Jan 11</span><div class=""><div class="fi aec dg ab q"><div class="fr xc aed ab q"><div class="aw dg di l cw"></div></div><a class="fr lu aed ab q" tabindex="-1" href="https://medium.com/r3d-buck3t/red-teaming-in-cloud-leverage-azure-frontdoor-cdn-for-c2-redirectors-79dd9ca98178?source=read_next_recirc-----bdc40f8c0766----0---------------------82a915b0_9a75_4642_96d8_29eff35aeade-------" rel="noopener follow"><div class="aw l"><div><div class="ab" aria-hidden="false" aria-describedby="179" aria-labelledby="179"><div class="ab q fi"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.67 10.17l2.14 2.14c1.72 1.72 4.33 2.43 5.96.8a4.38 4.38 0 0 0 .76-5.38L10.7 4.25c-.35-.53-.85-1.22-1.33-.96-.5.26 0 1.56 0 1.56l.78 1.93-3.73-3.91C5.6 1.9 4.96 1.76 4.5 2.22c-.33.33-.26.85.48 1.6.5.5 1.89 1.95 1.89 1.95.17.18.08.49-.1.66-.09.1-.2.15-.34.16a.43.43 0 0 1-.31-.13l-2.8-2.87c-.35-.35-.8-.54-1.2-.15-.4.4-.27 1.06.11 1.44l2.69 2.67.06.06c.17.18.27.63.1.8-.2.2-.46.33-.69.28a.92.92 0 0 1-.44-.28S2.5 6.84 1.89 6.23c-.4-.4-.9-.33-1.23 0-.52.52.27 1.28 1.73 2.7.39.36.82.77 1.28 1.24zm8.47-7.22c.38-.3.95-.28 1.3.24l1.57 3a5 5 0 0 1-.48 5.24l-.03.04c-.21.27-.35.43-.74.61 1.38-1.85.96-3.47-.25-5.45l-1.57-2.75v-.04c-.02-.3-.04-.7.2-.9z" fill="#6B6B6B"></path></svg><span style="margin-left: 4px;">14</span></div></div></div></div></a></div></div></div><div class="ab q aee aef"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="139" aria-labelledby="139"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F79dd9ca98178&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fr3d-buck3t%2Fred-teaming-in-cloud-leverage-azure-frontdoor-cdn-for-c2-redirectors-79dd9ca98178&amp;source=-----bdc40f8c0766----0-----------------bookmark_preview----82a915b0_9a75_4642_96d8_29eff35aeade-------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma aeg" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></span><div class="j i d"><div class="tj bg tk ly"></div></div></div></div></div></div></div></div></article></div></div><div class="zu zv zw zx zy zz aba abb abc abd abe abf yt abg abh abi yu abj abk abl abm"><div class="abn abo abp abq abr dv l"><article class="dv"><div class="dv rv l"><div class="bg dv"><div class="dv l"><div class="fi dv abs abt abu abv abw abx aby abz aca acb acc acd ace" role="link" data-href="https://detect.fyi/threat-hunting-suspicious-user-agents-3dd764470bd0" tabindex="0"><div class="acf"><div aria-label="Threat Hunting - Suspicious User Agents"><div class="ach aci acj ack acl"><img alt="Threat Hunting - Suspicious User Agents" class="bg acm acn aco acp bw" src="https://miro.medium.com/v2/resize:fit:849/1*7NOgHvwu0y5DNwRhHRMFZg.png" loading="lazy"></div></div></div><div class="acg ab ca cn"><div class="ab cn acq bg acr acs act acu"><div class="vd vf acv acw acx ab q"><div class="rh l"><div><div class="l" aria-hidden="false" aria-describedby="140" aria-labelledby="140"><a tabindex="-1" href="https://mthcht.medium.com/?source=read_next_recirc-----bdc40f8c0766----1---------------------82a915b0_9a75_4642_96d8_29eff35aeade-------" rel="noopener follow"><div class="l fi"><img alt="mthcht" class="l fc bx acy acz cw" src="https://miro.medium.com/v2/resize:fill:25:25/1*h7dUyUQgUIrGSCgdizGKYw.png" width="20" height="20" loading="lazy"><div class="fq bx l acy acz fr n ax fs"></div></div></a></div></div></div><div class="ada l"><div><div class="l" aria-hidden="false" aria-describedby="141" aria-labelledby="141"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://mthcht.medium.com/?source=read_next_recirc-----bdc40f8c0766----1---------------------82a915b0_9a75_4642_96d8_29eff35aeade-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">mthcht</p></a></div></div></div><div class="ada l"><p class="be b du z dt">in</p></div><div class="l"><div><div class="l" aria-hidden="false" aria-describedby="142" aria-labelledby="142"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://detect.fyi/?source=read_next_recirc-----bdc40f8c0766----1---------------------82a915b0_9a75_4642_96d8_29eff35aeade-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Detect FYI</p></a></div></div></div></div><div class="adb l adc add ade adf adg gm"><div class="adh adi adj adk adl adm adn ado"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://detect.fyi/threat-hunting-suspicious-user-agents-3dd764470bd0?source=read_next_recirc-----bdc40f8c0766----1---------------------82a915b0_9a75_4642_96d8_29eff35aeade-------" rel="noopener follow"><div title=""><h2 class="be gu nd nf adp adq ng nh nj adr ads nk oj qf adt adu qg on qi adv adw qj or ql adx ady qm jj jl jm jo jq bj">Threat Hunting - Suspicious User Agents</h2></div><div class="adz l"><h3 class="be b is z jj aea jl jm aeb jo jq dt">Hunting for Suspicious User Agents with Splunk</h3></div></a></div></div><span class="be b du z dt"><div class="ig ab co ae"><div class="ab q"><span>Jan 1</span><div class=""><div class="fi aec dg ab q"><div class="fr xc aed ab q"><div class="aw dg di l cw"></div></div><a class="fr lu aed ab q" tabindex="-1" href="https://detect.fyi/threat-hunting-suspicious-user-agents-3dd764470bd0?source=read_next_recirc-----bdc40f8c0766----1---------------------82a915b0_9a75_4642_96d8_29eff35aeade-------" rel="noopener follow"><div class="aw l"><div><div class="ab" aria-hidden="false" aria-describedby="180" aria-labelledby="180"><div class="ab q fi"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.67 10.17l2.14 2.14c1.72 1.72 4.33 2.43 5.96.8a4.38 4.38 0 0 0 .76-5.38L10.7 4.25c-.35-.53-.85-1.22-1.33-.96-.5.26 0 1.56 0 1.56l.78 1.93-3.73-3.91C5.6 1.9 4.96 1.76 4.5 2.22c-.33.33-.26.85.48 1.6.5.5 1.89 1.95 1.89 1.95.17.18.08.49-.1.66-.09.1-.2.15-.34.16a.43.43 0 0 1-.31-.13l-2.8-2.87c-.35-.35-.8-.54-1.2-.15-.4.4-.27 1.06.11 1.44l2.69 2.67.06.06c.17.18.27.63.1.8-.2.2-.46.33-.69.28a.92.92 0 0 1-.44-.28S2.5 6.84 1.89 6.23c-.4-.4-.9-.33-1.23 0-.52.52.27 1.28 1.73 2.7.39.36.82.77 1.28 1.24zm8.47-7.22c.38-.3.95-.28 1.3.24l1.57 3a5 5 0 0 1-.48 5.24l-.03.04c-.21.27-.35.43-.74.61 1.38-1.85.96-3.47-.25-5.45l-1.57-2.75v-.04c-.02-.3-.04-.7.2-.9z" fill="#6B6B6B"></path></svg><span style="margin-left: 4px;">232</span></div></div></div></div><div class="aw l"><div><div class="ab" aria-hidden="false" aria-describedby="143" aria-labelledby="143"><div class="ab q fi"><svg width="16" height="16" viewBox="0 0 16 16" fill="#6B6B6B"><path d="M12.34 11.46A5.28 5.28 0 0 0 14 7.53C14 4.48 11.4 2 8.05 2 4.71 2 2 4.48 2 7.53c0 3.05 2.71 5.52 6.06 5.52.6 0 1.18-.08 1.76-.23.17.14.35.29.55.41.78.51 1.63.77 2.51.77.17 0 .3-.08.36-.22a.37.37 0 0 0-.03-.38 4.73 4.73 0 0 1-.86-1.96v.02z" fill="#6B6B6B"></path></svg><span style="margin-left: 4px;">1</span></div></div></div></div></a></div></div></div><div class="ab q aee aef"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="144" aria-labelledby="144"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3dd764470bd0&amp;operation=register&amp;redirect=https%3A%2F%2Fdetect.fyi%2Fthreat-hunting-suspicious-user-agents-3dd764470bd0&amp;source=-----bdc40f8c0766----1-----------------bookmark_preview----82a915b0_9a75_4642_96d8_29eff35aeade-------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma aeg" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></span></div></div></div></div></div></div></article></div></div></div></div><div class="tj bg tk afm"></div><h2 class="be te is z gs bj">Lists</h2><div class="afn l"><div class="cm ab kz je zf zg zh zi zj zk zl zm zn zo zp zq zr zs zt"><div class="zu zv zw zx zy zz aba abb abc abd abe abf yt abg abh abi yu abj abk abl abm"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab ck cm" href="https://medium.com/@wearedelicious/list/tech-tools-541154dfb3ae?source=read_next_recirc-----bdc40f8c0766--------------------------------" rel="noopener follow"><div class="aft afu jj ab jb fi"><div class="fi acm afp bw afq"><div class="acm ig jj l"><img alt="" class="" src="https://miro.medium.com/v2/resize:fill:60:60/1*VBGWIyCtkhx8FtMSb-xumg.png" width="48" height="48" loading="lazy" role="presentation"></div></div><div class="fi acm afp bw la afr"><div class="acm ig jj l"><img alt="Close-up Shot of a Person Wearing a Robber Mask" class="" src="https://miro.medium.com/v2/resize:fill:60:60/1*UUb0HMDMuibZuDkkCazeJg.jpeg" width="48" height="48" loading="lazy"></div></div><div class="fi acm bw io afs"><div class="acm ig jj l"><img alt="" class="" src="https://miro.medium.com/v2/resize:fill:60:60/1*x0FBZgsae1ElzECF0gNKgg.jpeg" width="48" height="48" loading="lazy" role="presentation"></div></div></div><div class="aw l"><h2 class="be te is z jj aea jl jm aeb jo jq gs bj">Tech &amp; Tools</h2><div class="be b du z dt ab afo">17 stories<span class="iv l" aria-hidden="true"><span class="be b bf z dt">·</span></span>245 saves</div></div></a></div><div class="zu zv zw zx zy zz aba abb abc abd abe abf yt abg abh abi yu abj abk abl abm"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab ck cm" href="https://medium.com/@m.wasalski/list/chatgpt-3742c7a4727d?source=read_next_recirc-----bdc40f8c0766--------------------------------" rel="noopener follow"><div class="aft afu jj ab jb fi"><div class="fi acm afp bw afq"><div class="acm ig jj l"><img alt="" class="" src="https://miro.medium.com/v2/resize:fill:60:60/1*vzu3JPzaq2EZKTZNY9BhLA.png" width="48" height="48" loading="lazy" role="presentation"></div></div><div class="fi acm afp bw la afr"><div class="acm ig jj l"><img alt="AI-generated image of a cute tiny robot in the backdrop of ChatGPT’s logo" class="" src="https://miro.medium.com/v2/resize:fill:60:60/1*lEmL62oZdrOOWIzAAFKiFg.jpeg" width="48" height="48" loading="lazy"></div></div><div class="fi acm bw io afs"><div class="acm ig jj l"><img alt="" class="" src="https://miro.medium.com/v2/resize:fill:60:60/1*i2zLIwC9mftamP1dbciCeQ.jpeg" width="48" height="48" loading="lazy" role="presentation"></div></div></div><div class="aw l"><h2 class="be te is z jj aea jl jm aeb jo jq gs bj">ChatGPT</h2><div class="be b du z dt ab afo">21 stories<span class="iv l" aria-hidden="true"><span class="be b bf z dt">·</span></span>675 saves</div></div></a></div><div class="zu zv zw zx zy zz aba abb abc abd abe abf yt abg abh abi yu abj abk abl abm"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab ck cm" href="https://tomsmith585.medium.com/list/generative-ai-recommended-reading-508b0743c247?source=read_next_recirc-----bdc40f8c0766--------------------------------" rel="noopener follow"><div class="aft afu jj ab jb fi"><div class="fi acm afp bw afq"><div class="acm ig jj l"><img alt="" class="" src="https://miro.medium.com/v2/da:true/resize:fill:60:60/0*M8Jq6btD0YsgaRM1" width="48" height="48" loading="lazy" role="presentation"></div></div><div class="fi acm afp bw la afr"><div class="acm ig jj l"><img alt="" class="" src="https://miro.medium.com/v2/resize:fill:60:60/1*rsp22rKwFDjiwwCcUly56Q.jpeg" width="48" height="48" loading="lazy" role="presentation"></div></div><div class="fi acm bw io afs"><div class="acm ig jj l"><img alt="" class="" src="https://miro.medium.com/v2/resize:fill:60:60/1*PNVLDmurJ5LoCjB9Ovdnpw.png" width="48" height="48" loading="lazy" role="presentation"></div></div></div><div class="aw l"><h2 class="be te is z jj aea jl jm aeb jo jq gs bj">Generative AI Recommended Reading</h2><div class="be b du z dt ab afo">52 stories<span class="iv l" aria-hidden="true"><span class="be b bf z dt">·</span></span>1129 saves</div></div></a></div><div class="zu zv zw zx zy zz aba abb abc abd abe abf yt abg abh abi yu abj abk abl abm"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab ck cm" href="https://medium.com/@MediumStaff/list/mediums-huge-list-of-publications-accepting-submissions-7c0ec8037e61?source=read_next_recirc-----bdc40f8c0766--------------------------------" rel="noopener follow"><div class="aft afu jj ab jb fi"><div class="fi acm afp bw afq"><div class="acm ig jj l"><img alt="" class="" src="https://miro.medium.com/v2/resize:fill:60:60/1*I-niCEZgF3IO-KGOMEuYkw.png" width="48" height="48" loading="lazy" role="presentation"></div></div><div class="fi acm afp bw la afr"><div class="acm ig jj l"><img alt="" class="" src="https://miro.medium.com/v2/resize:fill:60:60/1*uPC1ZNHm3Zd1qREO8fVFjw.png" width="48" height="48" loading="lazy" role="presentation"></div></div><div class="fi acm bw io afs"><div class="acm ig jj l"><img alt="" class="" src="https://miro.medium.com/v2/resize:fill:60:60/1*n1SHUUHyI16HZB1FhK8Khw.jpeg" width="48" height="48" loading="lazy" role="presentation"></div></div></div><div class="aw l"><h2 class="be te is z jj aea jl jm aeb jo jq gs bj">Medium's Huge List of Publications Accepting Submissions</h2><div class="be b du z dt ab afo">312 stories<span class="iv l" aria-hidden="true"><span class="be b bf z dt">·</span></span>2901 saves</div></div></a></div></div></div><div class="tj bg tk aex dj aez dk afv afw afx afy afz aga"></div><div class="ze ab kz je zf zg zh zi zj zk zl zm zn zo zp zq zr zs zt"><div class="zu zv zw zx zy zz aba abb abc abd abe abf yt abg abh abi yu abj abk abl abm"><div class="abn abo abp abq abr dv l"><article class="dv"><div class="dv rv l"><div class="bg dv"><div class="dv l"><div class="fi dv abs abt abu abv abw abx aby abz aca acb acc acd ace" role="link" data-href="https://medium.com/@cyberballa/azure-honeypot-37c2cb93b4c6" tabindex="0"><div class="acf"><div aria-label="Azure Honeypot"><div class="ach aci acj ack acl"><img alt="Azure Honeypot" class="bg acm acn aco acp bw" src="https://miro.medium.com/v2/resize:fit:849/1*6q0c2JVOpoG3y-2ZyZ2BNA.png" loading="lazy"></div></div></div><div class="acg ab ca cn"><div class="ab cn acq bg acr acs act acu"><div class="vd vf acv acw acx ab q"><div class="rh l"><div><div class="l" aria-hidden="false" aria-describedby="145" aria-labelledby="145"><a tabindex="-1" href="https://medium.com/@cyberballa?source=read_next_recirc-----bdc40f8c0766----0---------------------82a915b0_9a75_4642_96d8_29eff35aeade-------" rel="noopener follow"><div class="l fi"><img alt="Cyber Balla" class="l fc bx acy acz cw" src="https://miro.medium.com/v2/resize:fill:25:25/1*vqR4Xg__f0oRI7P7A4h9EQ.png" width="20" height="20" loading="lazy"><div class="fq bx l acy acz fr n ax fs"></div></div></a></div></div></div><div class="ada l"><div><div class="l" aria-hidden="false" aria-describedby="146" aria-labelledby="146"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://medium.com/@cyberballa?source=read_next_recirc-----bdc40f8c0766----0---------------------82a915b0_9a75_4642_96d8_29eff35aeade-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Cyber Balla</p></a></div></div></div></div><div class="adb l adc add ade adf adg gm"><div class="adh adi adj adk adl adm adn ado"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/@cyberballa/azure-honeypot-37c2cb93b4c6?source=read_next_recirc-----bdc40f8c0766----0---------------------82a915b0_9a75_4642_96d8_29eff35aeade-------" rel="noopener follow"><div title=""><h2 class="be gu nd nf adp adq ng nh nj adr ads nk oj qf adt adu qg on qi adv adw qj or ql adx ady qm jj jl jm jo jq bj">Azure Honeypot</h2></div><div class="adz l"><h3 class="be b is z jj aea jl jm aeb jo jq dt">In this project, we explore the utilization of a honeypot by using T-Pot, deploying a Debian VM using Azure to install T-Pot on it.</h3></div></a></div></div><span class="be b du z dt"><div class="ig ab co ae"><div class="ab q"><span>Feb 8</span><div class=""><div class="fi aec dg ab q"><div class="fr xc aed ab q"><div class="aw dg di l cw"></div></div><a class="fr lu aed ab q" tabindex="-1" href="https://medium.com/@cyberballa/azure-honeypot-37c2cb93b4c6?source=read_next_recirc-----bdc40f8c0766----0---------------------82a915b0_9a75_4642_96d8_29eff35aeade-------" rel="noopener follow"><div class="aw l"><div><div class="ab" aria-hidden="false" aria-describedby="182" aria-labelledby="182"><div class="ab q fi"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.67 10.17l2.14 2.14c1.72 1.72 4.33 2.43 5.96.8a4.38 4.38 0 0 0 .76-5.38L10.7 4.25c-.35-.53-.85-1.22-1.33-.96-.5.26 0 1.56 0 1.56l.78 1.93-3.73-3.91C5.6 1.9 4.96 1.76 4.5 2.22c-.33.33-.26.85.48 1.6.5.5 1.89 1.95 1.89 1.95.17.18.08.49-.1.66-.09.1-.2.15-.34.16a.43.43 0 0 1-.31-.13l-2.8-2.87c-.35-.35-.8-.54-1.2-.15-.4.4-.27 1.06.11 1.44l2.69 2.67.06.06c.17.18.27.63.1.8-.2.2-.46.33-.69.28a.92.92 0 0 1-.44-.28S2.5 6.84 1.89 6.23c-.4-.4-.9-.33-1.23 0-.52.52.27 1.28 1.73 2.7.39.36.82.77 1.28 1.24zm8.47-7.22c.38-.3.95-.28 1.3.24l1.57 3a5 5 0 0 1-.48 5.24l-.03.04c-.21.27-.35.43-.74.61 1.38-1.85.96-3.47-.25-5.45l-1.57-2.75v-.04c-.02-.3-.04-.7.2-.9z" fill="#6B6B6B"></path></svg><span style="margin-left: 4px;">4</span></div></div></div></div></a></div></div></div><div class="ab q aee aef"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="147" aria-labelledby="147"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F37c2cb93b4c6&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40cyberballa%2Fazure-honeypot-37c2cb93b4c6&amp;source=-----bdc40f8c0766----0-----------------bookmark_preview----82a915b0_9a75_4642_96d8_29eff35aeade-------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma aeg" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></span><div class="j i d"><div class="tj bg tk ly"></div></div></div></div></div></div></div></div></article></div></div><div class="zu zv zw zx zy zz aba abb abc abd abe abf yt abg abh abi yu abj abk abl abm"><div class="abn abo abp abq abr dv l"><article class="dv"><div class="dv rv l"><div class="bg dv"><div class="dv l"><div class="fi dv abs abt abu abv abw abx aby abz aca acb acc acd ace" role="link" data-href="https://posts.specterops.io/one-phish-two-phish-red-teams-spew-phish-1a2f02010ed7" tabindex="0"><div class="acf"><div aria-label="One Phish Two Phish, Red Teams Spew Phish"><div class="ach aci acj ack acl"><img alt="One Phish Two Phish, Red Teams Spew Phish" class="bg acm acn aco acp bw" src="https://miro.medium.com/v2/resize:fit:849/0*7LAItowpoE5v3Rmh" loading="lazy"></div></div></div><div class="acg ab ca cn"><div class="ab cn acq bg acr acs act acu"><div class="vd vf acv acw acx ab q"><div class="rh l"><div><div class="l" aria-hidden="false" aria-describedby="148" aria-labelledby="148"><a tabindex="-1" href="https://medium.com/@fakasler?source=read_next_recirc-----bdc40f8c0766----1---------------------82a915b0_9a75_4642_96d8_29eff35aeade-------" rel="noopener follow"><div class="l fi"><img alt="Forrest Kasler" class="l fc bx acy acz cw" src="https://miro.medium.com/v2/resize:fill:25:25/0*twL-x8eyh-Q1_GWn" width="20" height="20" loading="lazy"><div class="fq bx l acy acz fr n ax fs"></div></div></a></div></div></div><div class="ada l"><div><div class="l" aria-hidden="false" aria-describedby="149" aria-labelledby="149"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://medium.com/@fakasler?source=read_next_recirc-----bdc40f8c0766----1---------------------82a915b0_9a75_4642_96d8_29eff35aeade-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Forrest Kasler</p></a></div></div></div><div class="ada l"><p class="be b du z dt">in</p></div><div class="l"><div><div class="l" aria-hidden="false" aria-describedby="150" aria-labelledby="150"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://posts.specterops.io/?source=read_next_recirc-----bdc40f8c0766----1---------------------82a915b0_9a75_4642_96d8_29eff35aeade-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Posts By SpecterOps Team Members</p></a></div></div></div></div><div class="adb l adc add ade adf adg gm"><div class="adh adi adj adk adl adm adn ado"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/one-phish-two-phish-red-teams-spew-phish-1a2f02010ed7?source=read_next_recirc-----bdc40f8c0766----1---------------------82a915b0_9a75_4642_96d8_29eff35aeade-------"><div title=""><h2 class="be gu nd nf adp adq ng nh nj adr ads nk oj qf adt adu qg on qi adv adw qj or ql adx ady qm jj jl jm jo jq bj">One Phish Two Phish, Red Teams Spew Phish</h2></div><div class="adz l"><h3 class="be b is z jj aea jl jm aeb jo jq dt">How to Give your Phishing Domains a Reputation Boost</h3></div></a></div></div><span class="be b du z dt"><div class="ig ab co ae"><div class="ab q"><span>Jun 4</span><div class=""><div class="fi aec dg ab q"><div class="fr xc aed ab q"><div class="aw dg di l cw"></div></div><a class="fr lu aed ab q" tabindex="-1" rel="noopener follow" href="/one-phish-two-phish-red-teams-spew-phish-1a2f02010ed7?source=read_next_recirc-----bdc40f8c0766----1---------------------82a915b0_9a75_4642_96d8_29eff35aeade-------"><div class="aw l"><div><div class="ab" aria-hidden="false" aria-describedby="183" aria-labelledby="183"><div class="ab q fi"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.67 10.17l2.14 2.14c1.72 1.72 4.33 2.43 5.96.8a4.38 4.38 0 0 0 .76-5.38L10.7 4.25c-.35-.53-.85-1.22-1.33-.96-.5.26 0 1.56 0 1.56l.78 1.93-3.73-3.91C5.6 1.9 4.96 1.76 4.5 2.22c-.33.33-.26.85.48 1.6.5.5 1.89 1.95 1.89 1.95.17.18.08.49-.1.66-.09.1-.2.15-.34.16a.43.43 0 0 1-.31-.13l-2.8-2.87c-.35-.35-.8-.54-1.2-.15-.4.4-.27 1.06.11 1.44l2.69 2.67.06.06c.17.18.27.63.1.8-.2.2-.46.33-.69.28a.92.92 0 0 1-.44-.28S2.5 6.84 1.89 6.23c-.4-.4-.9-.33-1.23 0-.52.52.27 1.28 1.73 2.7.39.36.82.77 1.28 1.24zm8.47-7.22c.38-.3.95-.28 1.3.24l1.57 3a5 5 0 0 1-.48 5.24l-.03.04c-.21.27-.35.43-.74.61 1.38-1.85.96-3.47-.25-5.45l-1.57-2.75v-.04c-.02-.3-.04-.7.2-.9z" fill="#6B6B6B"></path></svg><span style="margin-left: 4px;">18</span></div></div></div></div><div class="aw l"><div><div class="ab" aria-hidden="false" aria-describedby="151" aria-labelledby="151"><div class="ab q fi"><svg width="16" height="16" viewBox="0 0 16 16" fill="#6B6B6B"><path d="M12.34 11.46A5.28 5.28 0 0 0 14 7.53C14 4.48 11.4 2 8.05 2 4.71 2 2 4.48 2 7.53c0 3.05 2.71 5.52 6.06 5.52.6 0 1.18-.08 1.76-.23.17.14.35.29.55.41.78.51 1.63.77 2.51.77.17 0 .3-.08.36-.22a.37.37 0 0 0-.03-.38 4.73 4.73 0 0 1-.86-1.96v.02z" fill="#6B6B6B"></path></svg><span style="margin-left: 4px;">1</span></div></div></div></div></a></div></div></div><div class="ab q aee aef"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="152" aria-labelledby="152"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1a2f02010ed7&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fone-phish-two-phish-red-teams-spew-phish-1a2f02010ed7&amp;source=-----bdc40f8c0766----1-----------------bookmark_preview----82a915b0_9a75_4642_96d8_29eff35aeade-------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma aeg" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></span><div class="j i d"><div class="tj bg tk ly"></div></div></div></div></div></div></div></div></article></div></div><div class="zu zv zw zx zy zz aba abb abc abd abe abf yt abg abh abi yu abj abk abl abm"><div class="abn abo abp abq abr dv l"><article class="dv"><div class="dv rv l"><div class="bg dv"><div class="dv l"><div class="fi dv abs abt abu abv abw abx aby abz aca acb acc acd ace" role="link" data-href="https://mturhanlar.medium.com/microsoft-entra-id-azure-ad-penetration-test-red-team-assessment-all-in-one-tool-a74fe7b3c4c1" tabindex="0"><div class="acf"><div aria-label="Microsoft Entra ID (Azure AD) Penetration Test/Red Team Assessment All-in-One Tool"><div class="ach aci acj ack acl"><img alt="Microsoft Entra ID (Azure AD) Penetration Test/Red Team Assessment All-in-One Tool" class="bg acm acn aco acp bw" src="https://miro.medium.com/v2/resize:fit:849/1*EiRJLJ74utBg306s6qOtUw.png" loading="lazy"></div></div></div><div class="acg ab ca cn"><div class="ab cn acq bg acr acs act acu"><div class="vd vf acv acw acx ab q"><div class="rh l"><div><div class="l" aria-hidden="false" aria-describedby="153" aria-labelledby="153"><a tabindex="-1" href="https://mturhanlar.medium.com/?source=read_next_recirc-----bdc40f8c0766----2---------------------82a915b0_9a75_4642_96d8_29eff35aeade-------" rel="noopener follow"><div class="l fi"><img alt="Melih Turhanlar" class="l fc bx acy acz cw" src="https://miro.medium.com/v2/resize:fill:25:25/1*Ae86SW9a0Xptl-4tOTUo8g.png" width="20" height="20" loading="lazy"><div class="fq bx l acy acz fr n ax fs"></div></div></a></div></div></div><div class="ada l"><div><div class="l" aria-hidden="false" aria-describedby="154" aria-labelledby="154"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://mturhanlar.medium.com/?source=read_next_recirc-----bdc40f8c0766----2---------------------82a915b0_9a75_4642_96d8_29eff35aeade-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Melih Turhanlar</p></a></div></div></div></div><div class="adb l adc add ade adf adg gm"><div class="adh adi adj adk adl adm adn ado"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://mturhanlar.medium.com/microsoft-entra-id-azure-ad-penetration-test-red-team-assessment-all-in-one-tool-a74fe7b3c4c1?source=read_next_recirc-----bdc40f8c0766----2---------------------82a915b0_9a75_4642_96d8_29eff35aeade-------" rel="noopener follow"><div title="Microsoft Entra ID (Azure AD) Penetration Test/Red Team Assessment All-in-One Tool"><h2 class="be gu nd nf adp adq ng nh nj adr ads nk oj qf adt adu qg on qi adv adw qj or ql adx ady qm jj jl jm jo jq bj">Microsoft Entra ID (Azure AD) Penetration Test/Red Team Assessment All-in-One Tool</h2></div><div class="adz l"><h3 class="be b is z jj aea jl jm aeb jo jq dt">I have written about Microsoft Entra ID (Azure AD) Penetration/Red Team before. But in this blog, I will try to tell you about a single…</h3></div></a></div></div><span class="be b du z dt"><div class="ig ab co ae"><div class="ab q"><span>Feb 9</span><div class=""><div class="fi aec dg ab q"><div class="fr xc aed ab q"><div class="aw dg di l cw"></div></div><a class="fr lu aed ab q" tabindex="-1" href="https://mturhanlar.medium.com/microsoft-entra-id-azure-ad-penetration-test-red-team-assessment-all-in-one-tool-a74fe7b3c4c1?source=read_next_recirc-----bdc40f8c0766----2---------------------82a915b0_9a75_4642_96d8_29eff35aeade-------" rel="noopener follow"><div class="aw l"><div><div class="ab" aria-hidden="false" aria-describedby="185" aria-labelledby="185"><div class="ab q fi"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.67 10.17l2.14 2.14c1.72 1.72 4.33 2.43 5.96.8a4.38 4.38 0 0 0 .76-5.38L10.7 4.25c-.35-.53-.85-1.22-1.33-.96-.5.26 0 1.56 0 1.56l.78 1.93-3.73-3.91C5.6 1.9 4.96 1.76 4.5 2.22c-.33.33-.26.85.48 1.6.5.5 1.89 1.95 1.89 1.95.17.18.08.49-.1.66-.09.1-.2.15-.34.16a.43.43 0 0 1-.31-.13l-2.8-2.87c-.35-.35-.8-.54-1.2-.15-.4.4-.27 1.06.11 1.44l2.69 2.67.06.06c.17.18.27.63.1.8-.2.2-.46.33-.69.28a.92.92 0 0 1-.44-.28S2.5 6.84 1.89 6.23c-.4-.4-.9-.33-1.23 0-.52.52.27 1.28 1.73 2.7.39.36.82.77 1.28 1.24zm8.47-7.22c.38-.3.95-.28 1.3.24l1.57 3a5 5 0 0 1-.48 5.24l-.03.04c-.21.27-.35.43-.74.61 1.38-1.85.96-3.47-.25-5.45l-1.57-2.75v-.04c-.02-.3-.04-.7.2-.9z" fill="#6B6B6B"></path></svg><span style="margin-left: 4px;">12</span></div></div></div></div></a></div></div></div><div class="ab q aee aef"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="155" aria-labelledby="155"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa74fe7b3c4c1&amp;operation=register&amp;redirect=https%3A%2F%2Fmturhanlar.medium.com%2Fmicrosoft-entra-id-azure-ad-penetration-test-red-team-assessment-all-in-one-tool-a74fe7b3c4c1&amp;source=-----bdc40f8c0766----2-----------------bookmark_preview----82a915b0_9a75_4642_96d8_29eff35aeade-------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma aeg" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></span><div class="j i d"><div class="tj bg tk ly"></div></div></div></div></div></div></div></div></article></div></div><div class="zu zv zw zx zy zz aba abb abc abd abe abf yt abg abh abi yu abj abk abl abm"><div class="abn abo abp abq abr dv l"><article class="dv"><div class="dv rv l"><div class="bg dv"><div class="dv l"><div class="fi dv abs abt abu abv abw abx aby abz aca acb acc acd ace" role="link" data-href="https://medium.com/@aniswersighni/active-directory-attacks-smb-relay-attacks-ea7d8cf9a8f8" tabindex="0"><div class="acf"><div aria-label="Active Directory Attacks&nbsp;: SMB Relay Attacks"><div class="ach aci acj ack acl"><img alt="Active Directory Attacks&nbsp;: SMB Relay Attacks" class="bg acm acn aco acp bw" src="https://miro.medium.com/v2/resize:fit:849/1*6wbi_8jqXUM8Qq07VJGRLA.png" loading="lazy"></div></div></div><div class="acg ab ca cn"><div class="ab cn acq bg acr acs act acu"><div class="vd vf acv acw acx ab q"><div class="rh l"><div><div class="l" aria-hidden="false" aria-describedby="156" aria-labelledby="156"><a tabindex="-1" href="https://medium.com/@aniswersighni?source=read_next_recirc-----bdc40f8c0766----3---------------------82a915b0_9a75_4642_96d8_29eff35aeade-------" rel="noopener follow"><div class="l fi"><img alt="anis wersighni" class="l fc bx acy acz cw" src="https://miro.medium.com/v2/resize:fill:25:25/0*KzfylUMui_ExpSrd" width="20" height="20" loading="lazy"><div class="fq bx l acy acz fr n ax fs"></div></div></a></div></div></div><div class="ada l"><div><div class="l" aria-hidden="false" aria-describedby="157" aria-labelledby="157"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://medium.com/@aniswersighni?source=read_next_recirc-----bdc40f8c0766----3---------------------82a915b0_9a75_4642_96d8_29eff35aeade-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">anis wersighni</p></a></div></div></div></div><div class="adb l adc add ade adf adg gm"><div class="adh adi adj adk adl adm adn ado"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/@aniswersighni/active-directory-attacks-smb-relay-attacks-ea7d8cf9a8f8?source=read_next_recirc-----bdc40f8c0766----3---------------------82a915b0_9a75_4642_96d8_29eff35aeade-------" rel="noopener follow"><div title=""><h2 class="be gu nd nf adp adq ng nh nj adr ads nk oj qf adt adu qg on qi adv adw qj or ql adx ady qm jj jl jm jo jq bj">Active Directory Attacks&nbsp;: SMB Relay Attacks</h2></div><div class="adz l"><h3 class="be b is z jj aea jl jm aeb jo jq dt">In the previous blog of the Active Directory Attack series, we discussed LLMNR/NBT-NS Attack, which is an attack that lets you compromise…</h3></div></a></div></div><span class="be b du z dt"><div class="ig ab co ae"><div class="ab q"><span>Jan 10</span><div class=""><div class="fi aec dg ab q"><div class="fr xc aed ab q"><div class="aw dg di l cw"></div></div><a class="fr lu aed ab q" tabindex="-1" href="https://medium.com/@aniswersighni/active-directory-attacks-smb-relay-attacks-ea7d8cf9a8f8?source=read_next_recirc-----bdc40f8c0766----3---------------------82a915b0_9a75_4642_96d8_29eff35aeade-------" rel="noopener follow"><div class="aw l"><div><div class="ab" aria-hidden="false" aria-describedby="186" aria-labelledby="186"><div class="ab q fi"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.67 10.17l2.14 2.14c1.72 1.72 4.33 2.43 5.96.8a4.38 4.38 0 0 0 .76-5.38L10.7 4.25c-.35-.53-.85-1.22-1.33-.96-.5.26 0 1.56 0 1.56l.78 1.93-3.73-3.91C5.6 1.9 4.96 1.76 4.5 2.22c-.33.33-.26.85.48 1.6.5.5 1.89 1.95 1.89 1.95.17.18.08.49-.1.66-.09.1-.2.15-.34.16a.43.43 0 0 1-.31-.13l-2.8-2.87c-.35-.35-.8-.54-1.2-.15-.4.4-.27 1.06.11 1.44l2.69 2.67.06.06c.17.18.27.63.1.8-.2.2-.46.33-.69.28a.92.92 0 0 1-.44-.28S2.5 6.84 1.89 6.23c-.4-.4-.9-.33-1.23 0-.52.52.27 1.28 1.73 2.7.39.36.82.77 1.28 1.24zm8.47-7.22c.38-.3.95-.28 1.3.24l1.57 3a5 5 0 0 1-.48 5.24l-.03.04c-.21.27-.35.43-.74.61 1.38-1.85.96-3.47-.25-5.45l-1.57-2.75v-.04c-.02-.3-.04-.7.2-.9z" fill="#6B6B6B"></path></svg><span style="margin-left: 4px;">22</span></div></div></div></div></a></div></div></div><div class="ab q aee aef"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="158" aria-labelledby="158"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fea7d8cf9a8f8&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40aniswersighni%2Factive-directory-attacks-smb-relay-attacks-ea7d8cf9a8f8&amp;source=-----bdc40f8c0766----3-----------------bookmark_preview----82a915b0_9a75_4642_96d8_29eff35aeade-------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma aeg" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></span></div></div></div></div></div></div></article></div></div></div><div class="tj bg tk dj dk aeh aei aej"></div><a class="be b bf z bj ri aen aeo aep ma lw wu eu ev ew aeq aer aes ez wf wg aet aeu aev fa fb fc bl fd fe" href="https://medium.com/?source=post_page-----bdc40f8c0766--------------------------------" rel="noopener follow"><div class="l fe">See more recommendations</div></a></div></div></div><div class="h k j"><div class="tj bg tk tq"></div><div class="ab ca"><div class="ch bg fy fz ga gb"><div class="tr ab kz je"><div class="ts tt l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----bdc40f8c0766--------------------------------" rel="noopener follow"><p class="be b du z dt">Help</p></a></div><div class="ts tt l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----bdc40f8c0766--------------------------------" rel="noopener follow"><p class="be b du z dt">Status</p></a></div><div class="ts tt l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/about?autoplay=1&amp;source=post_page-----bdc40f8c0766--------------------------------" rel="noopener follow"><p class="be b du z dt">About</p></a></div><div class="ts tt l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----bdc40f8c0766--------------------------------" rel="noopener follow"><p class="be b du z dt">Careers</p></a></div><div class="ts tt l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="mailto:pressinquiries@medium.com?source=post_page-----bdc40f8c0766--------------------------------" rel="noopener follow"><p class="be b du z dt">Press</p></a></div><div class="ts tt l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----bdc40f8c0766--------------------------------" rel="noopener follow"><p class="be b du z dt">Blog</p></a></div><div class="ts tt l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----bdc40f8c0766--------------------------------" rel="noopener follow"><p class="be b du z dt">Privacy</p></a></div><div class="ts tt l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----bdc40f8c0766--------------------------------" rel="noopener follow"><p class="be b du z dt">Terms</p></a></div><div class="ts tt l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----bdc40f8c0766--------------------------------" rel="noopener follow"><p class="be b du z dt">Text to speech</p></a></div><div class="ts l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/business?source=post_page-----bdc40f8c0766--------------------------------" rel="noopener follow"><p class="be b du z dt">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20240614-221838-3ba87a70fa"</script><script>window.__GRAPHQL_URI__ = "https://posts.specterops.io/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"This request is not using the cache middleware worker","group":"disabled","tags":["group-edgeCachePosts","post-bdc40f8c0766","user-9689ed358206","collection-f05f8696e3cc"],"serverVariantState":"","middlewareEnabled":false,"cacheStatus":"DYNAMIC","shouldUseCache":false,"vary":[],"updatedPostPreviewsEnabled":false,"lohpExperimentEnabled":"control","prideLogoEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":true,"routingEntity":{"type":"COLLECTION","id":"f05f8696e3cc","explicit":true},"viewerIsBot":false},"debug":{"requestId":"73756967-46aa-4b99-be74-9917af427f36","hybridDevServices":[],"originalSpanCarrier":{"ot-tracer-spanid":"53b88c7d41450dd9","ot-tracer-traceid":"6a48b40e06d067e8","ot-tracer-sampled":"true"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fposts.specterops.io\u002Fdetecting-attacks-within-azure-bdc40f8c0766","host":"posts.specterops.io","hostname":"posts.specterops.io","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null}},"config":{"nodeEnv":"production","version":"main-20240614-221838-3ba87a70fa","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20240614-221838-3ba87a70fa","commit":"3ba87a70fa89456c9162015acb3c1797c92f4b41"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"1*OMF3fSqH8t4xBJ9-6oZDZw.png","height":106,"width":545},"postLogo":{"imageId":"1*kFrc4tBFM_tCis-2Ic87WA.png","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","isLoggedIn":false,"viewer":null,"variantFlags":[{"__typename":"VariantFlag","name":"enable_tipping_v0_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_syntax_highlight","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_legacy_feed_in_iceland","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_avatar_upload","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_remove_twitter_onboarding_step","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_home_post_menu","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_aggregator_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_explicit_signals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_deprecate_legacy_providers_v3","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_newsletter_lo_flow_custom_domains","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_stripe_customers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_footer_app_buttons","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_homepage","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_susi_redesign_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_eventstats_event_processing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_premium_tier_badge","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"price_smoke_test_yearly","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"enable_android_dynamic_aspirational_paywall","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_bg_post_post","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pp_v4","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_reading_history","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_apple_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_app_flirty_thirty","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_cache_less_following_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_explicit_signals_updated_post_previews","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_for_members_username_selection","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_lists_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rito_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"price_smoke_test_monthly","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_c","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_pub_stats","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_topic_portals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ml_rank_rex_anno","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pill_based_home_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pride_logo","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_friend_links_creation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_post_referrers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_offline_reading","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_medium_forever_introductory_discount","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"redefined_top_posts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_members_only_audio","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"browsable_stream_config_bucket","valueType":{"__typename":"VariantFlagString","value":"curated-topics"}},{"__typename":"VariantFlag","name":"enable_ios_dynamic_paywall_aspiriational","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_annual_plan","valueType":{"__typename":"VariantFlagString","value":"2c754bcc2995"}},{"__typename":"VariantFlag","name":"onboarding_tags_from_top_views","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"glyph_font_set","valueType":{"__typename":"VariantFlagString","value":"m2-unbound-source-serif-pro"}},{"__typename":"VariantFlag","name":"enable_mobile_lohp_short_hero","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"limit_user_follows","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_import","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_simplified_digest_v2_b","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"coronavirus_topic_recirc","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sharer_validate_post_share_key","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_first_story","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branch_io","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_auto_follow_on_subscribe","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_new_push_notification_endpoint","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_offline_reading","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_recaptcha_enterprise","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"mobile_custom_app_icon","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"reader_fair_distribution_non_qp","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_image_sharer","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_susi_redesign_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_social_share_sheet","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_speechify_widget","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_test_auth","valueType":{"__typename":"VariantFlagString","value":"disallow"}},{"__typename":"VariantFlag","name":"enable_entities_to_follow_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_seamless_social_sharing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"skip_fs_cache_user_vals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_iceland_forced_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_dynamic_paywall_programming","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_dynamic_programming_paywall","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_editor_new_publishing_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_two_hour_refresh","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_one_tap","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_iceland_nux","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_marketing_emails","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sprig","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_monthly_premium_plan","valueType":{"__typename":"VariantFlagString","value":"12a660186432"}},{"__typename":"VariantFlag","name":"enable_mastodon_for_members","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_starspace","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_signup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_annual_premium_plan","valueType":{"__typename":"VariantFlagString","value":"4a442ace1476"}},{"__typename":"VariantFlag","name":"signup_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"enable_ios_autorefresh","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"can_send_tips_v0","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tag_recs","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tribute_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tick_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_switch_plan_premium_tier","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_easy_resubscribe","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_response_markup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_monthly_plan","valueType":{"__typename":"VariantFlagString","value":"60e220181034"}},{"__typename":"VariantFlag","name":"disable_partner_program_enrollment","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_archive_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_friend_links_postpage_banners","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_creator_welcome_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_group_gifting","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_paypal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_speechify_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_verified_book_author","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sharer_create_post_share_key","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_rating_prompt_stories_read_threshold","valueType":{"__typename":"VariantFlagNumber"}},{"__typename":"VariantFlag","name":"crm_send_contact_to_sendgrid","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_automod","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_access","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tipping_v0_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mps_pp_writer_stats","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_trial_membership","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_maim_the_meter","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_sign_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_continue_this_thread","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_verifications_service","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"reengagement_notification_duration","valueType":{"__typename":"VariantFlagNumber"}},{"__typename":"VariantFlag","name":"enable_aurora_pub_follower_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_streamline_pub_newsletters","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_recirc_model","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"signin_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"enable_android_miro_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_diversification_rex","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_medium2_kbfd","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lo_homepage","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"textshots_userid","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"enable_braintree_google_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_server_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_client","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"rex_generator_max_candidates","valueType":{"__typename":"VariantFlagNumber"}},{"__typename":"VariantFlag","name":"enable_pre_pp_v4","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_in_app_free_trial","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_integration","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_display_paywall_after_onboarding","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_friend_links_creation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_cards","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_verified_author","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_cards_byline","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_premium_tier","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"can_receive_tips_v0","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_friend_links_postpage_banners","valueType":{"__typename":"VariantFlagBoolean","value":true}}],"collectionByDomainOrSlug({\"domainOrSlug\":\"posts.specterops.io\"})":{"__ref":"Collection:f05f8696e3cc"},"postResult({\"id\":\"bdc40f8c0766\"})":{"__ref":"Post:bdc40f8c0766"}},"ImageMetadata:1*D-FDlfkqivRBQZoESrwtqw.png":{"__typename":"ImageMetadata","id":"1*D-FDlfkqivRBQZoESrwtqw.png"},"Collection:f05f8696e3cc":{"__typename":"Collection","id":"f05f8696e3cc","favicon":{"__ref":"ImageMetadata:1*D-FDlfkqivRBQZoESrwtqw.png"},"customStyleSheet":null,"colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFF3F1FF","point":0},{"__typename":"ColorPoint","color":"#FFF1EFFF","point":0.1},{"__typename":"ColorPoint","color":"#FFEEEDFF","point":0.2},{"__typename":"ColorPoint","color":"#FFECEBFF","point":0.3},{"__typename":"ColorPoint","color":"#FFEAE9FF","point":0.4},{"__typename":"ColorPoint","color":"#FFE8E7FF","point":0.5},{"__typename":"ColorPoint","color":"#FFE5E4FF","point":0.6},{"__typename":"ColorPoint","color":"#FFE3E2FF","point":0.7},{"__typename":"ColorPoint","color":"#FFE1E0FF","point":0.8},{"__typename":"ColorPoint","color":"#FFDEDEFF","point":0.9},{"__typename":"ColorPoint","color":"#FFDCDCFF","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF8080B7","point":0},{"__typename":"ColorPoint","color":"#FF7777A8","point":0.1},{"__typename":"ColorPoint","color":"#FF6E6E9A","point":0.2},{"__typename":"ColorPoint","color":"#FF65658B","point":0.3},{"__typename":"ColorPoint","color":"#FF5C5B7D","point":0.4},{"__typename":"ColorPoint","color":"#FF52526E","point":0.5},{"__typename":"ColorPoint","color":"#FF484860","point":0.6},{"__typename":"ColorPoint","color":"#FF3D3D51","point":0.7},{"__typename":"ColorPoint","color":"#FF323241","point":0.8},{"__typename":"ColorPoint","color":"#FF262632","point":0.9},{"__typename":"ColorPoint","color":"#FF191921","point":1}]},"tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FF1E184B","colorPoints":[{"__typename":"ColorPoint","color":"#FF1E184B","point":0},{"__typename":"ColorPoint","color":"#FF3A3866","point":0.1},{"__typename":"ColorPoint","color":"#FF54537D","point":0.2},{"__typename":"ColorPoint","color":"#FF6C6C93","point":0.3},{"__typename":"ColorPoint","color":"#FF8383A6","point":0.4},{"__typename":"ColorPoint","color":"#FF9999B9","point":0.5},{"__typename":"ColorPoint","color":"#FFAEAECA","point":0.6},{"__typename":"ColorPoint","color":"#FFC3C2DB","point":0.7},{"__typename":"ColorPoint","color":"#FFD8D6EB","point":0.8},{"__typename":"ColorPoint","color":"#FFEBEAFA","point":0.9},{"__typename":"ColorPoint","color":"#FFFFFDFF","point":1}]}},"googleAnalyticsId":"UA-102239211-2","editors":[{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:74ad66811b78"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:70f84c574024"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:f4ab382d41"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:1bb43103a9a9"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:b9c2df322eaf"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:b206c297df42"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:d59f95c1ed1c"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:6e849bed7683"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:9bef3c9a8b49"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:10eca8f7a844"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:d248a36145f8"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:2562fc45d9a9"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:645ffcef8682"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:a041d7ac11fe"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:507d73de7b97"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:e7dfc7678b59"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:ff850017e32a"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:4d7214ceeaf8"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:a7b4cdae1aaa"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:760e415ea3c9"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:f95d89c4ba81"}}],"name":"Posts By SpecterOps Team Members","avatar":{"__ref":"ImageMetadata:1*D-FDlfkqivRBQZoESrwtqw.png"},"domain":"posts.specterops.io","slug":"specter-ops-posts","description":"Posts from SpecterOps team members on various topics relating information security","subscriberCount":4294,"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:f05f8696e3cc-viewerId:lo_feab786b6e83"},"twitterUsername":"specterops","facebookPageId":null,"logo":{"__ref":"ImageMetadata:1*s-5BWBr8XsgtIU5azKNhZQ.jpeg"}},"User:74ad66811b78":{"__typename":"User","id":"74ad66811b78"},"User:70f84c574024":{"__typename":"User","id":"70f84c574024"},"User:f4ab382d41":{"__typename":"User","id":"f4ab382d41"},"User:1bb43103a9a9":{"__typename":"User","id":"1bb43103a9a9"},"User:b9c2df322eaf":{"__typename":"User","id":"b9c2df322eaf"},"User:b206c297df42":{"__typename":"User","id":"b206c297df42"},"User:d59f95c1ed1c":{"__typename":"User","id":"d59f95c1ed1c"},"User:6e849bed7683":{"__typename":"User","id":"6e849bed7683"},"User:9bef3c9a8b49":{"__typename":"User","id":"9bef3c9a8b49"},"User:10eca8f7a844":{"__typename":"User","id":"10eca8f7a844"},"User:d248a36145f8":{"__typename":"User","id":"d248a36145f8"},"User:2562fc45d9a9":{"__typename":"User","id":"2562fc45d9a9"},"User:645ffcef8682":{"__typename":"User","id":"645ffcef8682"},"User:a041d7ac11fe":{"__typename":"User","id":"a041d7ac11fe"},"User:507d73de7b97":{"__typename":"User","id":"507d73de7b97"},"User:e7dfc7678b59":{"__typename":"User","id":"e7dfc7678b59"},"User:ff850017e32a":{"__typename":"User","id":"ff850017e32a"},"User:4d7214ceeaf8":{"__typename":"User","id":"4d7214ceeaf8"},"User:a7b4cdae1aaa":{"__typename":"User","id":"a7b4cdae1aaa"},"User:760e415ea3c9":{"__typename":"User","id":"760e415ea3c9"},"User:f95d89c4ba81":{"__typename":"User","id":"f95d89c4ba81"},"LinkedAccounts:9689ed358206":{"__typename":"LinkedAccounts","mastodon":null,"id":"9689ed358206"},"UserViewerEdge:userId:9689ed358206-viewerId:lo_feab786b6e83":{"__typename":"UserViewerEdge","id":"userId:9689ed358206-viewerId:lo_feab786b6e83","isFollowing":false,"isUser":false,"isMuting":false},"NewsletterV3:ca0f6466d12d":{"__typename":"NewsletterV3","id":"ca0f6466d12d","type":"NEWSLETTER_TYPE_AUTHOR","slug":"9689ed358206","name":"9689ed358206","collection":null,"user":{"__ref":"User:9689ed358206"}},"User:9689ed358206":{"__typename":"User","id":"9689ed358206","name":"Ryan Hausknecht","username":"hausec","newsletterV3":{"__ref":"NewsletterV3:ca0f6466d12d"},"linkedAccounts":{"__ref":"LinkedAccounts:9689ed358206"},"isSuspended":false,"imageId":"2*LFdW-NbzZFmNHuopdXF2Wg.png","mediumMemberAt":0,"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":368},"customDomainState":null,"hasSubdomain":false,"bio":"Security Consultant @ SpecterOps","isPartnerProgramEnrolled":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:9689ed358206-viewerId:lo_feab786b6e83"},"viewerIsUser":false,"postSubscribeMembershipUpsellShownAt":0,"allowNotes":true,"membership":null,"twitterScreenName":""},"Paragraph:e7fb9cfd19b6_0":{"__typename":"Paragraph","id":"e7fb9cfd19b6_0","name":"aeab","type":"H3","href":null,"layout":null,"metadata":null,"text":"Defense and Detection for Attacks Within Azure","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_1":{"__typename":"Paragraph","id":"e7fb9cfd19b6_1","name":"04aa","type":"H3","href":null,"layout":null,"metadata":null,"text":"Abstract","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_2":{"__typename":"Paragraph","id":"e7fb9cfd19b6_2","name":"18b8","type":"P","href":null,"layout":null,"metadata":null,"text":"In my article “Attacking Azure, AzureAD, and Introducing PowerZure”, I provided several tactics, techniques, and procedures (TTPs) on attacking Azure & AzureAD, as well as released PowerZure to automate some of it. I firmly believe that when a new tactic or tool is written, that defensive guidelines should follow to help blue teams secure themselves from those tactics or tools. Unfortunately, Azure’s logging capabilities for operations that occur within Azure, leave much to be desired.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":181,"end":190,"href":"https:\u002F\u002Fgithub.com\u002Fhausec\u002FPowerZure","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_3":{"__typename":"Paragraph","id":"e7fb9cfd19b6_3","name":"4393","type":"P","href":null,"layout":null,"metadata":null,"text":"This article’s purpose is to give an overview into the native Activity Log service functionality within Azure and provide insight into how to detect many of the TTPs listed in my previous article, as well as suggestions on how to acquire more detail out of the Activity Log service than just what appears on the ‘summary’ tab.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":55,"end":61,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_4":{"__typename":"Paragraph","id":"e7fb9cfd19b6_4","name":"bed7","type":"H3","href":null,"layout":null,"metadata":null,"text":"Overview","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_5":{"__typename":"Paragraph","id":"e7fb9cfd19b6_5","name":"eb2b","type":"P","href":null,"layout":null,"metadata":null,"text":"Whenever an operation is completed within Azure, an event is generated and kept within the Activity Log service. Within the Activity Log, the user can see all operations and apply basic filters (Time-span, severity, etc.). Operations (events) in the log are broken out based on the status of the operation, i.e. when an event is started, when it updates, when it finishes, etc. In order to see the other “sub-events” within that operation, the user must click on the event and the other status events will then populate. This is important because the details surrounding the operation depend on the status.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*-FzFFNcu0WxKqnHFjhFKUA.png":{"__typename":"ImageMetadata","id":"1*-FzFFNcu0WxKqnHFjhFKUA.png","originalHeight":68,"originalWidth":444,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e7fb9cfd19b6_6":{"__typename":"Paragraph","id":"e7fb9cfd19b6_6","name":"071a","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*-FzFFNcu0WxKqnHFjhFKUA.png"},"text":"Figure 1: Clicking on the first event shows a sub-event.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_7":{"__typename":"Paragraph","id":"e7fb9cfd19b6_7","name":"04ff","type":"P","href":null,"layout":null,"metadata":null,"text":"For example, when a user is assigned to a role (e.g. contributor), an operation is started which creates an event, but essential details are missing.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*NQu3kSutAmjTTpXSCKLm1Q.png":{"__typename":"ImageMetadata","id":"1*NQu3kSutAmjTTpXSCKLm1Q.png","originalHeight":358,"originalWidth":597,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e7fb9cfd19b6_8":{"__typename":"Paragraph","id":"e7fb9cfd19b6_8","name":"3b5d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*NQu3kSutAmjTTpXSCKLm1Q.png"},"text":"Figure 2: Initial event created in Azure for a role assignment.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_9":{"__typename":"Paragraph","id":"e7fb9cfd19b6_9","name":"8d05","type":"P","href":null,"layout":null,"metadata":null,"text":"Once the operation finishes, another “sub-event” is created that then discloses the necessary details.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*RnB6FBpF9P1S5RF-sWrDVQ.png":{"__typename":"ImageMetadata","id":"1*RnB6FBpF9P1S5RF-sWrDVQ.png","originalHeight":370,"originalWidth":597,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e7fb9cfd19b6_10":{"__typename":"Paragraph","id":"e7fb9cfd19b6_10","name":"97f2","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*RnB6FBpF9P1S5RF-sWrDVQ.png"},"text":"Figure 3: More details revealed when clicking on the sub-event","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_11":{"__typename":"Paragraph","id":"e7fb9cfd19b6_11","name":"eba6","type":"P","href":null,"layout":null,"metadata":null,"text":"In this example, the ‘Message’ field is what contains the username of the user that was added to the role, in comparison to the original event which did not contain this info.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_12":{"__typename":"Paragraph","id":"e7fb9cfd19b6_12","name":"93f6","type":"H3","href":null,"layout":null,"metadata":null,"text":"Alerting","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_13":{"__typename":"Paragraph","id":"e7fb9cfd19b6_13","name":"453a","type":"P","href":null,"layout":null,"metadata":null,"text":"Alerts can be configured right from Activity Log. Whenever an operation occurs, Azure gives the option to create an alert for that operation once you click into the event.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*7fnsdrD4vw3qx2BJ4jRNUw.png":{"__typename":"ImageMetadata","id":"1*7fnsdrD4vw3qx2BJ4jRNUw.png","originalHeight":97,"originalWidth":433,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e7fb9cfd19b6_14":{"__typename":"Paragraph","id":"e7fb9cfd19b6_14","name":"7656","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*7fnsdrD4vw3qx2BJ4jRNUw.png"},"text":"Figure 4: Option to create a new alert based on an event","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_15":{"__typename":"Paragraph","id":"e7fb9cfd19b6_15","name":"df0f","type":"P","href":null,"layout":null,"metadata":null,"text":"When creating a rule, there’s an option to change the condition. When the default condition is left, it is a very general condition, as shown in Figure 5.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Sfn2O_LchgqUbGSijsglaw.png":{"__typename":"ImageMetadata","id":"1*Sfn2O_LchgqUbGSijsglaw.png","originalHeight":194,"originalWidth":1144,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e7fb9cfd19b6_16":{"__typename":"Paragraph","id":"e7fb9cfd19b6_16","name":"4ec4","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Sfn2O_LchgqUbGSijsglaw.png"},"text":"Figure 5: The condition is set to any informational level event that succeeds. This would generate several benign alerts.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_17":{"__typename":"Paragraph","id":"e7fb9cfd19b6_17","name":"6047","type":"P","href":null,"layout":null,"metadata":null,"text":"The condition can be changed by clicking on the trash can icon and clicking ‘Add’ under condition.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*akULdKgmNgcggYrwI8yw8w.png":{"__typename":"ImageMetadata","id":"1*akULdKgmNgcggYrwI8yw8w.png","originalHeight":395,"originalWidth":653,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e7fb9cfd19b6_18":{"__typename":"Paragraph","id":"e7fb9cfd19b6_18","name":"6cd6","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*akULdKgmNgcggYrwI8yw8w.png"},"text":"Figure 6: Alerting conditions for Runbooks.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_19":{"__typename":"Paragraph","id":"e7fb9cfd19b6_19","name":"ab9f","type":"P","href":null,"layout":null,"metadata":null,"text":"From here, the alert action can be set to several options.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*e-EUSs5QzmPhbEL1glhP0w.png":{"__typename":"ImageMetadata","id":"1*e-EUSs5QzmPhbEL1glhP0w.png","originalHeight":319,"originalWidth":247,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e7fb9cfd19b6_20":{"__typename":"Paragraph","id":"e7fb9cfd19b6_20","name":"8fae","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*e-EUSs5QzmPhbEL1glhP0w.png"},"text":"Figure 7: Alerting options","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_21":{"__typename":"Paragraph","id":"e7fb9cfd19b6_21","name":"cdc7","type":"H3","href":null,"layout":null,"metadata":null,"text":"It’s All In The Details, or is it?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_22":{"__typename":"Paragraph","id":"e7fb9cfd19b6_22","name":"f17a","type":"P","href":null,"layout":null,"metadata":null,"text":"Getting a general event is great for alerting, however it’s key for an analyst to have details pertaining to that event such as who started the operation, what was the target object of the operation, etc. Unfortunately, there’s several operations that report minimal details.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_23":{"__typename":"Paragraph","id":"e7fb9cfd19b6_23","name":"326a","type":"H4","href":null,"layout":null,"metadata":null,"text":"Command Execution","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_24":{"__typename":"Paragraph","id":"e7fb9cfd19b6_24","name":"efeb","type":"P","href":null,"layout":null,"metadata":null,"text":"When a command is run on a virtual machine, an event is created, however there is no record kept of what command was ran.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":100,"end":104,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Z3aqFBJq4vP0PX_gy_ZTuQ.png":{"__typename":"ImageMetadata","id":"1*Z3aqFBJq4vP0PX_gy_ZTuQ.png","originalHeight":269,"originalWidth":580,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e7fb9cfd19b6_25":{"__typename":"Paragraph","id":"e7fb9cfd19b6_25","name":"a7b1","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Z3aqFBJq4vP0PX_gy_ZTuQ.png"},"text":"Figure 8: All that’s returned in the event from running a command on a VM","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_26":{"__typename":"Paragraph","id":"e7fb9cfd19b6_26","name":"45f1","type":"P","href":null,"layout":null,"metadata":null,"text":"The summary tab shows when and who executed a command, but in order to see the name of the VM where execution occurred, the user must go to the JSON tab and view the ‘id’ property to see the scope of the event.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*acX4urBAqq1pkDV_TDR5ng.png":{"__typename":"ImageMetadata","id":"1*acX4urBAqq1pkDV_TDR5ng.png","originalHeight":57,"originalWidth":672,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e7fb9cfd19b6_27":{"__typename":"Paragraph","id":"e7fb9cfd19b6_27","name":"7a95","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*acX4urBAqq1pkDV_TDR5ng.png"},"text":"Figure 9: Name of the VM in the scope path","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_28":{"__typename":"Paragraph","id":"e7fb9cfd19b6_28","name":"1268","type":"P","href":null,"layout":null,"metadata":null,"text":"Whenever a command is issued to a Windows Virtual Machine, Azure stores the inputted command as a PowerShell script located on the endpoint within","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_29":{"__typename":"Paragraph","id":"e7fb9cfd19b6_29","name":"d7da","type":"P","href":null,"layout":null,"metadata":null,"text":"C:\\Packages\\Plugins\\Microsoft.CPlat.Core.RunCommandWindows\\1.1.3\\Downloads","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":74,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_30":{"__typename":"Paragraph","id":"e7fb9cfd19b6_30","name":"aa0e","type":"P","href":null,"layout":null,"metadata":null,"text":"This allows an analyst to potentially see what commands were ran on a virtual machine, provided the attacker did not delete the scripts. Of course, it’s always recommended to use additional defensive tools as well as enable script-block logging on those endpoints within Group Policy.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_31":{"__typename":"Paragraph","id":"e7fb9cfd19b6_31","name":"372e","type":"H4","href":null,"layout":null,"metadata":null,"text":"Key Vaults","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_32":{"__typename":"Paragraph","id":"e7fb9cfd19b6_32","name":"7c98","type":"P","href":null,"layout":null,"metadata":null,"text":"Key Vaults are very sensitive within Azure due to their purpose. They can house certificates, passwords, and keys, so they should also be heavily monitored for access. Accessing a vault does not generate an event, nor does revealing a key. This is the intended purpose of the resource in conjunction with role-based access control; as far as Azure is concerned, it is not event-worthy if a user accesses a resource they have permission to access. Key Vaults are restricted to their owners and it’s up to the owner to edit the access policy to allow other users to access that vault. However, as a Global Contributor, a user is able to edit the permissions of any vault and give themselves permission to access it. This does generate an event, ‘Update Key Vault’.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":659,"end":663,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*X97ihFp957fejn3OLNSpWw.png":{"__typename":"ImageMetadata","id":"1*X97ihFp957fejn3OLNSpWw.png","originalHeight":266,"originalWidth":591,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e7fb9cfd19b6_33":{"__typename":"Paragraph","id":"e7fb9cfd19b6_33","name":"8573","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*X97ihFp957fejn3OLNSpWw.png"},"text":"Figure 6: Log of when a Key Vault is updated","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_34":{"__typename":"Paragraph","id":"e7fb9cfd19b6_34","name":"c97b","type":"P","href":null,"layout":null,"metadata":null,"text":"The event summary shows who updated the vault’s permissions, however the name of the vault is in the JSON output instead of the summary.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*wTxFby0rHMB20FXFO5IOeg.png":{"__typename":"ImageMetadata","id":"1*wTxFby0rHMB20FXFO5IOeg.png","originalHeight":97,"originalWidth":725,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e7fb9cfd19b6_35":{"__typename":"Paragraph","id":"e7fb9cfd19b6_35","name":"224f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*wTxFby0rHMB20FXFO5IOeg.png"},"text":"Figure 10: The scope in the JSON tab reveals the vault name.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_36":{"__typename":"Paragraph","id":"e7fb9cfd19b6_36","name":"5ad9","type":"P","href":null,"layout":null,"metadata":null,"text":"The major problem with this, is that it does not show who was added to the access policy. Therefore, the only way to determine who was added, is to go into each vault and determine if all users on the access policy are meant to be there.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":54,"end":57,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_37":{"__typename":"Paragraph","id":"e7fb9cfd19b6_37","name":"9f43","type":"H4","href":null,"layout":null,"metadata":null,"text":"Runbooks","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_38":{"__typename":"Paragraph","id":"e7fb9cfd19b6_38","name":"c3b1","type":"P","href":null,"layout":null,"metadata":null,"text":"In PowerZure, a function that takes advantages of Runbooks is Create-Backdoor. This works by creating a Runbook that will provide a new account and assign it to the Contributor role when executed. Instead of automatically executing, it generates a Webhook URI that can be passed into Execute-Backdoor which will run the Runbook on demand. This requires the Administrative Role because only Administrators can create users in Azure AD. Luckily, creating a Runbook generates several events so detection for this is straight forward. The first key event, is the creation of a Runbook, followed by the creation of a Webhook and then generation of a URI for that Webhook.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":3,"end":12,"href":"https:\u002F\u002Fgithub.com\u002Fhausec\u002FPowerZure","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*XcMIjvggpLYCXbTF2Un5cw.png":{"__typename":"ImageMetadata","id":"1*XcMIjvggpLYCXbTF2Un5cw.png","originalHeight":158,"originalWidth":378,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e7fb9cfd19b6_39":{"__typename":"Paragraph","id":"e7fb9cfd19b6_39","name":"534c","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*XcMIjvggpLYCXbTF2Un5cw.png"},"text":"Figure 11: Sequence of operations for ‘Create-Backdoor’ in PowerZure","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_40":{"__typename":"Paragraph","id":"e7fb9cfd19b6_40","name":"4627","type":"P","href":null,"layout":null,"metadata":null,"text":"The problem with this, is that the ‘event initiated by’ field is incorrect. The field is always populated with the tenant Administrator, instead of the person who actually created the Runbook, if the Runbook was created from the command line. To ensure my sanity, I tested this with three different accounts, and every time the event was initiated by my administrative account, even though it wasn’t logged in anywhere.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":115,"end":121,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*K-OZoC6HbwLzIBQ-D5g5jA.png":{"__typename":"ImageMetadata","id":"1*K-OZoC6HbwLzIBQ-D5g5jA.png","originalHeight":245,"originalWidth":993,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e7fb9cfd19b6_41":{"__typename":"Paragraph","id":"e7fb9cfd19b6_41","name":"8b43","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*K-OZoC6HbwLzIBQ-D5g5jA.png"},"text":"Figure 12: Event Initiated by field shows the tenant admin instead of the actual user for Webhook and Runbook creations when done through CLI.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_42":{"__typename":"Paragraph","id":"e7fb9cfd19b6_42","name":"1ddd","type":"P","href":null,"layout":null,"metadata":null,"text":"As for 1\u002F24\u002F2020, this bug has been submitted to Microsoft and I am currently awaiting their response.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_43":{"__typename":"Paragraph","id":"e7fb9cfd19b6_43","name":"fc6c","type":"P","href":null,"layout":null,"metadata":null,"text":"Update: As of 2\u002F7\u002F2020, this bug is now fixed.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_44":{"__typename":"Paragraph","id":"e7fb9cfd19b6_44","name":"129d","type":"H4","href":null,"layout":null,"metadata":null,"text":"Group assignments","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":17,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_45":{"__typename":"Paragraph","id":"e7fb9cfd19b6_45","name":"0d42","type":"P","href":null,"layout":null,"metadata":null,"text":"Even if on-premise Activity Directory (AD) is synchronized to AzureAD, it’s not possible to add a user to an on-premise AD group. However, adding a user to a Azure group in Azure does not generate an event under the Activity Log. AzureAD has its own event viewer, called Audit Logs. This does give the necessary details of an operation, however alerts cannot be configured for these events in AzureAD unless the Log Analytics service is being used and AzureAD is configured to send logs to Log Analytics. The alert would then have to be generated from Log Analytics instead of AzureAD’s Audit Logs.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_46":{"__typename":"Paragraph","id":"e7fb9cfd19b6_46","name":"8758","type":"H4","href":null,"layout":null,"metadata":null,"text":"Virtual Machine Disks","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_47":{"__typename":"Paragraph","id":"e7fb9cfd19b6_47","name":"6a1e","type":"P","href":null,"layout":null,"metadata":null,"text":"If an attacker compromises an account that is a Global Contributor, they may generate a link to download a VM disk. This can be detected with the operation name ‘Get Disk SAS URI’. The link is not shown in the summary or JSON tab, nor is if the disk was actually downloaded or not. Only a generic event is created with no details other than the disk name.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_48":{"__typename":"Paragraph","id":"e7fb9cfd19b6_48","name":"c173","type":"H3","href":null,"layout":null,"metadata":null,"text":"Defensive Approach","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_49":{"__typename":"Paragraph","id":"e7fb9cfd19b6_49","name":"e751","type":"P","href":null,"layout":null,"metadata":null,"text":"With Azure utilizing role-based access control (RBAC), it should be treated similarly to on-premise AD group membership, meaning it should follow the method of least-privileged access. Assigning the Global Contributor role to a user gives that user a great amount of access and execution capabilities. It is suggested to review which roles are actually necessary for operation within Azure. Azure contains many built-in roles outside of the ‘Global’ roles, which can be viewed here. In addition, custom role creation is a possibility that may better suit a businesses need.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":477,"end":481,"href":"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fazure\u002Frole-based-access-control\u002Fbuilt-in-roles","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_50":{"__typename":"Paragraph","id":"e7fb9cfd19b6_50","name":"adc9","type":"P","href":null,"layout":null,"metadata":null,"text":"Following the methodology of least-privileged access, Azure does offer the Privileged Identity Management (PIM) service, for a cost, but is heavily recommended.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":112,"end":119,"href":"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fazure\u002Factive-directory\u002Fprivileged-identity-management\u002Fpim-configure","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":127,"end":131,"href":"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fazure\u002Factive-directory\u002Fprivileged-identity-management\u002Fsubscription-requirements","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_51":{"__typename":"Paragraph","id":"e7fb9cfd19b6_51","name":"a292","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Organizations want to minimize the number of people who have access to secure information or resources, because that reduces the chance of a malicious actor getting that access, or an authorized user inadvertently impacting a sensitive resource. However, users still need to carry out privileged operations in Azure AD, Azure, Office 365, or SaaS apps. Organizations can give users just-in-time (JIT) privileged access to Azure resources and Azure AD. There is a need for oversight for what those users are doing with their administrator privileges. — Microsoft","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_52":{"__typename":"Paragraph","id":"e7fb9cfd19b6_52","name":"69e1","type":"P","href":null,"layout":null,"metadata":null,"text":"PIM is similar to a Privileged Access Management (PAM) solution, where it gives administrative or privileged access only when needed. PIM can used on a per-resource basis. In the PIM panel, there’s three categories: Eligible, Active, and Expired. Eligible means the user is able request access to that role on that resource. Active means the user actively has that role and does not need approval. Expired means that user is no longer allowed to request access for that role and no longer has it.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*SPqwujA8tJOp6cMVWG4okQ.png":{"__typename":"ImageMetadata","id":"1*SPqwujA8tJOp6cMVWG4okQ.png","originalHeight":213,"originalWidth":990,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e7fb9cfd19b6_53":{"__typename":"Paragraph","id":"e7fb9cfd19b6_53","name":"ea62","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*SPqwujA8tJOp6cMVWG4okQ.png"},"text":"Figure 13: ‘Contrib’ user has allowed to request access to the contributor role for a resource","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_54":{"__typename":"Paragraph","id":"e7fb9cfd19b6_54","name":"c2a7","type":"P","href":null,"layout":null,"metadata":null,"text":"For example, if a user was added to PIM for a virtual machine resource and made eligible to request access to the Contributor role, then that user would only have to request to activate their privileges for that virtual machine, while not having to do that for all others. Since roles are hierarchical, if PIM is placed on the subscription, then it would affect all resources within that subscription. With PIM, it doesn’t enable the requirement for the request to be approved by default.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*xsWuWVFGQzUn0tJqLNiKLQ.png":{"__typename":"ImageMetadata","id":"1*xsWuWVFGQzUn0tJqLNiKLQ.png","originalHeight":461,"originalWidth":444,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e7fb9cfd19b6_55":{"__typename":"Paragraph","id":"e7fb9cfd19b6_55","name":"3050","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*xsWuWVFGQzUn0tJqLNiKLQ.png"},"text":"Figure 14: Default activation settings for a role","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_56":{"__typename":"Paragraph","id":"e7fb9cfd19b6_56","name":"b236","type":"P","href":null,"layout":null,"metadata":null,"text":"This means that by default, a user could just activate their role whenever they wanted.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_57":{"__typename":"Paragraph","id":"e7fb9cfd19b6_57","name":"3ae3","type":"P","href":null,"layout":null,"metadata":null,"text":"The logging for PIM, however, is properly detailed within Activity Log.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*keD1smaMW3byijLKPCOdHQ.png":{"__typename":"ImageMetadata","id":"1*keD1smaMW3byijLKPCOdHQ.png","originalHeight":454,"originalWidth":482,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e7fb9cfd19b6_58":{"__typename":"Paragraph","id":"e7fb9cfd19b6_58","name":"e00d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*keD1smaMW3byijLKPCOdHQ.png"},"text":"Figure 15: The event summary when a user activates their PIM controlled role. ‘Reader’ activated the role ‘Contributor’ for the Subscription ‘Azure Test’","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_59":{"__typename":"Paragraph","id":"e7fb9cfd19b6_59","name":"3f4f","type":"H3","href":null,"layout":null,"metadata":null,"text":"Final Thoughts","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e7fb9cfd19b6_60":{"__typename":"Paragraph","id":"e7fb9cfd19b6_60","name":"01d9","type":"P","href":null,"layout":null,"metadata":null,"text":"Azure offers several additional services that give more insight into the operations within resources, such as Log Analytics and Azure Sentinel, however the native logging for operations within Azure itself is not perfect. Hopefully Microsoft will implement more details into Activity Log so defenders can have the full picture of an event instead of requiring additional effort.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":84,"end":90,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"CollectionViewerEdge:collectionId:f05f8696e3cc-viewerId:lo_feab786b6e83":{"__typename":"CollectionViewerEdge","id":"collectionId:f05f8696e3cc-viewerId:lo_feab786b6e83","isEditor":false,"isMuting":false},"ImageMetadata:1*s-5BWBr8XsgtIU5azKNhZQ.jpeg":{"__typename":"ImageMetadata","id":"1*s-5BWBr8XsgtIU5azKNhZQ.jpeg","originalWidth":2000,"originalHeight":805},"Tag:cybersecurity":{"__typename":"Tag","id":"cybersecurity","displayTitle":"Cybersecurity","normalizedTagSlug":"cybersecurity"},"Tag:security":{"__typename":"Tag","id":"security","displayTitle":"Security","normalizedTagSlug":"security"},"Tag:cloud-computing":{"__typename":"Tag","id":"cloud-computing","displayTitle":"Cloud Computing","normalizedTagSlug":"cloud-computing"},"Tag:cloud":{"__typename":"Tag","id":"cloud","displayTitle":"Cloud","normalizedTagSlug":"cloud"},"Tag:azure":{"__typename":"Tag","id":"azure","displayTitle":"Azure","normalizedTagSlug":"azure"},"Post:bdc40f8c0766":{"__typename":"Post","id":"bdc40f8c0766","collection":{"__ref":"Collection:f05f8696e3cc"},"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"39c5","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:e7fb9cfd19b6_0"},{"__ref":"Paragraph:e7fb9cfd19b6_1"},{"__ref":"Paragraph:e7fb9cfd19b6_2"},{"__ref":"Paragraph:e7fb9cfd19b6_3"},{"__ref":"Paragraph:e7fb9cfd19b6_4"},{"__ref":"Paragraph:e7fb9cfd19b6_5"},{"__ref":"Paragraph:e7fb9cfd19b6_6"},{"__ref":"Paragraph:e7fb9cfd19b6_7"},{"__ref":"Paragraph:e7fb9cfd19b6_8"},{"__ref":"Paragraph:e7fb9cfd19b6_9"},{"__ref":"Paragraph:e7fb9cfd19b6_10"},{"__ref":"Paragraph:e7fb9cfd19b6_11"},{"__ref":"Paragraph:e7fb9cfd19b6_12"},{"__ref":"Paragraph:e7fb9cfd19b6_13"},{"__ref":"Paragraph:e7fb9cfd19b6_14"},{"__ref":"Paragraph:e7fb9cfd19b6_15"},{"__ref":"Paragraph:e7fb9cfd19b6_16"},{"__ref":"Paragraph:e7fb9cfd19b6_17"},{"__ref":"Paragraph:e7fb9cfd19b6_18"},{"__ref":"Paragraph:e7fb9cfd19b6_19"},{"__ref":"Paragraph:e7fb9cfd19b6_20"},{"__ref":"Paragraph:e7fb9cfd19b6_21"},{"__ref":"Paragraph:e7fb9cfd19b6_22"},{"__ref":"Paragraph:e7fb9cfd19b6_23"},{"__ref":"Paragraph:e7fb9cfd19b6_24"},{"__ref":"Paragraph:e7fb9cfd19b6_25"},{"__ref":"Paragraph:e7fb9cfd19b6_26"},{"__ref":"Paragraph:e7fb9cfd19b6_27"},{"__ref":"Paragraph:e7fb9cfd19b6_28"},{"__ref":"Paragraph:e7fb9cfd19b6_29"},{"__ref":"Paragraph:e7fb9cfd19b6_30"},{"__ref":"Paragraph:e7fb9cfd19b6_31"},{"__ref":"Paragraph:e7fb9cfd19b6_32"},{"__ref":"Paragraph:e7fb9cfd19b6_33"},{"__ref":"Paragraph:e7fb9cfd19b6_34"},{"__ref":"Paragraph:e7fb9cfd19b6_35"},{"__ref":"Paragraph:e7fb9cfd19b6_36"},{"__ref":"Paragraph:e7fb9cfd19b6_37"},{"__ref":"Paragraph:e7fb9cfd19b6_38"},{"__ref":"Paragraph:e7fb9cfd19b6_39"},{"__ref":"Paragraph:e7fb9cfd19b6_40"},{"__ref":"Paragraph:e7fb9cfd19b6_41"},{"__ref":"Paragraph:e7fb9cfd19b6_42"},{"__ref":"Paragraph:e7fb9cfd19b6_43"},{"__ref":"Paragraph:e7fb9cfd19b6_44"},{"__ref":"Paragraph:e7fb9cfd19b6_45"},{"__ref":"Paragraph:e7fb9cfd19b6_46"},{"__ref":"Paragraph:e7fb9cfd19b6_47"},{"__ref":"Paragraph:e7fb9cfd19b6_48"},{"__ref":"Paragraph:e7fb9cfd19b6_49"},{"__ref":"Paragraph:e7fb9cfd19b6_50"},{"__ref":"Paragraph:e7fb9cfd19b6_51"},{"__ref":"Paragraph:e7fb9cfd19b6_52"},{"__ref":"Paragraph:e7fb9cfd19b6_53"},{"__ref":"Paragraph:e7fb9cfd19b6_54"},{"__ref":"Paragraph:e7fb9cfd19b6_55"},{"__ref":"Paragraph:e7fb9cfd19b6_56"},{"__ref":"Paragraph:e7fb9cfd19b6_57"},{"__ref":"Paragraph:e7fb9cfd19b6_58"},{"__ref":"Paragraph:e7fb9cfd19b6_59"},{"__ref":"Paragraph:e7fb9cfd19b6_60"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:9689ed358206"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fdetecting-attacks-within-azure-bdc40f8c0766","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"cybersecurity"},{"__typename":"Topic","slug":"programming"}],"isPublished":true,"latestPublishedVersion":"e7fb9cfd19b6","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"createdAt":1579926893230,"firstPublishedAt":1580834695022,"latestPublishedAt":1581094761799,"clapCount":20,"allowResponses":true,"isLimitedState":false,"title":"Defense and Detection for Attacks Within Azure","isSeries":false,"sequence":null,"uniqueSlug":"detecting-attacks-within-azure-bdc40f8c0766","socialTitle":"","socialDek":"","noIndex":null,"canonicalUrl":"","metaDescription":"","readingTime":7.761320754716981,"previewContent":{"__typename":"PreviewContent","subtitle":"Utilizing Activity Log for stopping Attacks on Azure services."},"previewImage":{"__ref":"ImageMetadata:1*akULdKgmNgcggYrwI8yw8w.png"},"isShortform":false,"seoTitle":"","updatedAt":1639390781508,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:cybersecurity"},{"__ref":"Tag:security"},{"__ref":"Tag:cloud-computing"},{"__ref":"Tag:cloud"},{"__ref":"Tag:azure"}],"isNewsletter":false,"statusForCollection":"APPROVED","pendingCollection":null,"detectedLanguage":"en","wordCount":1646,"layerCake":0}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.3cc5e3b6.js"></script><script src="https://cdn-client.medium.com/lite/static/js/2640.3217006c.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.7db0aaff.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.4ddbf12e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.2021fe63.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6068.e9093f2e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4398.db4d4378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7883.0e445e04.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9281.e9be8bce.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7111.b294e9da.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6481.362dec70.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8695.6f58679b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8978.4b110123.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3418.eb013b5a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3894.e3d01e2c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5514.32e692f6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5203.e7f058c5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7098.93054372.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8051.0a9d3f4b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8558.abbaadfd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1711.7605eb3e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8597.762eae49.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9174.b1b0f607.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8883.2f95bbf4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/705.e5898c57.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2911.d072adec.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8580.feeb2549.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6046.f9be485b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/500.d5389c14.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9408.22b56993.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6605.84e81b15.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6637.661bd7cf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7421.3f94f5ea.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/51.d8fb2684.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2133.c8ba56b1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.81dff084.chunk.js"></script><script>window.main();</script><div><div class="uf n xu xv ti xw xx xy xz ya yb yc yd ye yf cg bo yg yh yi lu yj yk"><div class="be b du z wp"><div class="ab co yl ym"><div class="l" role="alert">To make Medium work, we log user data. By using Medium, you agree to our <a class="af ag ah ai aj ak al am an ao ap yn yo ow" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9" rel="noopener follow" target="_blank">Privacy Policy</a>, including cookie policy.</div><div class="yp yq yr ys yt yu l yv jb yw"><div class="l fi n uw"><button class="af ag ah ai aj ak al am an ao ap yn yo yx yy ab" data-testid="close-button" aria-label="close"><svg width="19" height="19" viewBox="0 0 19 19" class="ep eo"><path d="M13.8 4.6L9.5 8.89 5.21 4.6l-.61.61 4.29 4.3-4.29 4.28.61.62 4.3-4.3 4.28 4.3.62-.62-4.3-4.29 4.3-4.29" fill-rule="evenodd"></path></svg></button></div></div></div></div></div></div><div><div class="grecaptcha-badge" data-style="bottomright" style="width: 256px; height: 60px; display: block; transition: right 0.3s; position: fixed; bottom: 14px; right: -186px; box-shadow: gray 0px 0px 5px; border-radius: 2px; overflow: hidden;"><div class="grecaptcha-logo"><iframe title="reCAPTCHA" width="256" height="60" role="presentation" name="a-uncvls1snwrn" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox allow-storage-access-by-user-activation" src="https://www.google.com/recaptcha/enterprise/anchor?ar=1&amp;k=6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp&amp;co=aHR0cHM6Ly9wb3N0cy5zcGVjdGVyb3BzLmlvOjQ0Mw..&amp;hl=pl&amp;v=TqxSU0dsOd2Q9IbI7CpFnJLD&amp;size=invisible&amp;cb=do32kq25ecm0"></iframe></div><div class="grecaptcha-error"></div><textarea id="g-recaptcha-response-100000" name="g-recaptcha-response" class="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea></div><iframe style="display: none;"></iframe></div></body></html>