<html lang="en" data-rh="lang"><head><title>Journey into Windows Kernel Exploitation: The Basics | by Jean | Neuvik</title><meta data-rh="true" charset="utf-8"><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"><meta data-rh="true" name="theme-color" content="#000000"><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"><meta data-rh="true" property="al:ios:app_name" content="Medium"><meta data-rh="true" property="al:ios:app_store_id" content="828256236"><meta data-rh="true" property="al:android:package" content="com.medium.reader"><meta data-rh="true" property="fb:app_id" content="542599432471018"><meta data-rh="true" property="og:site_name" content="Medium"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-10-24T22:29:26.157Z"><meta data-rh="true" name="title" content="Journey into Windows Kernel Exploitation: The Basics | by Jean | Neuvik"><meta data-rh="true" property="og:title" content="Journey into Windows Kernel Exploitation: The Basics"><meta data-rh="true" property="al:android:url" content="medium://p/fff72116ca33"><meta data-rh="true" property="al:ios:url" content="medium://p/fff72116ca33"><meta data-rh="true" property="al:android:app_name" content="Medium"><meta data-rh="true" name="description" content="This blogpost embarks on the initial stages of kernel exploitation. The content serves as an introduction, leading to an imminent and comprehensive whitepaper centered around this subject matter…"><meta data-rh="true" property="og:description" content="This blogpost embarks on the initial stages of kernel exploitation. The content serves as an introduction, leading to an imminent and…"><meta data-rh="true" property="og:url" content="https://blog.neuvik.com/journey-into-windows-kernel-exploitation-the-basics-fff72116ca33"><meta data-rh="true" property="al:web:url" content="https://blog.neuvik.com/journey-into-windows-kernel-exploitation-the-basics-fff72116ca33"><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:534/1*lOK_3N4qBrDcmiKlA9hjSw.jpeg"><meta data-rh="true" property="article:author" content="https://medium.com/@jean_82568"><meta data-rh="true" name="author" content="Jean"><meta data-rh="true" name="robots" content="index,follow,max-image-preview:large"><meta data-rh="true" name="referrer" content="unsafe-url"><meta data-rh="true" property="twitter:title" content="Journey into Windows Kernel Exploitation: The Basics"><meta data-rh="true" name="twitter:site" content="@Neuvik"><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/fff72116ca33"><meta data-rh="true" property="twitter:description" content="This blogpost embarks on the initial stages of kernel exploitation. The content serves as an introduction, leading to an imminent and…"><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:534/1*lOK_3N4qBrDcmiKlA9hjSw.jpeg"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="twitter:label1" content="Reading time"><meta data-rh="true" name="twitter:data1" content="17 min read"><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:152:152/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:120:120/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:76:76/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:60:60/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/Medium-Avatar-500x500.svg" color="#171717"><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"><link data-rh="true" rel="author" href="https://medium.com/@jean_82568"><link data-rh="true" rel="canonical" href="https://blog.neuvik.com/journey-into-windows-kernel-exploitation-the-basics-fff72116ca33"><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/fff72116ca33"><style type="text/css" data-fela-rehydration="541" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="541" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-webkit-keyframes k1{0%{transform:translate(-50%, -100px)}100%{transform:translate(-50%, 0)}}@-moz-keyframes k1{0%{transform:translate(-50%, -100px)}100%{transform:translate(-50%, 0)}}@keyframes k1{0%{transform:translate(-50%, -100px)}100%{transform:translate(-50%, 0)}}</style><style type="text/css" data-fela-rehydration="541" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{fill:rgba(0, 0, 0, 1)}.av{height:22px}.aw{margin-left:16px}.ax{border:none}.ay{border-radius:20px}.az{width:240px}.ba{background:#F9F9F9}.bb path{fill:#6B6B6B}.bd{outline:none}.be{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bf{font-size:14px}.bg{width:100%}.bh{padding:10px 20px 10px 0}.bi{background-color:transparent}.bj{color:#242424}.bk::placeholder{color:#6B6B6B}.bl{display:inline-block}.bm{margin-left:12px}.bn{margin-right:12px}.bo{border-radius:4px}.bp{margin-left:24px}.bq{height:24px}.bw{background-color:#F9F9F9}.bx{border-radius:50%}.by{height:32px}.bz{width:32px}.ca{justify-content:center}.cg{max-width:680px}.ch{min-width:0}.ci{animation:k1 1.2s ease-in-out infinite}.cj{height:100vh}.ck{margin-bottom:16px}.cl{margin-top:48px}.cm{align-items:flex-start}.cn{flex-direction:column}.co{justify-content:space-between}.cp{margin-bottom:24px}.cv{width:80%}.cw{background-color:#F2F2F2}.dc{height:44px}.dd{width:44px}.de{margin:auto 0}.df{margin-bottom:4px}.dg{height:16px}.dh{width:120px}.di{width:80px}.do{margin-bottom:8px}.dp{width:96%}.dq{width:98%}.dr{width:81%}.ds{margin-left:8px}.dt{color:#6B6B6B}.du{font-size:13px}.dv{height:100%}.eo{color:#FFFFFF}.ep{fill:#FFFFFF}.eq{background:rgba(79, 137, 214, 1)}.er{border-color:rgba(79, 137, 214, 1)}.ev:disabled{cursor:inherit !important}.ew:disabled{opacity:0.3}.ex:disabled:hover{background:rgba(79, 137, 214, 1)}.ey:disabled:hover{border-color:rgba(79, 137, 214, 1)}.ez{border-radius:99em}.fa{border-width:1px}.fb{border-style:solid}.fc{box-sizing:border-box}.fd{text-decoration:none}.fe{text-align:center}.fh{margin-right:32px}.fi{position:relative}.fj{fill:#6B6B6B}.fm{background:transparent}.fn svg{margin-left:4px}.fo svg{fill:#6B6B6B}.fq{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fr{position:absolute}.fy{margin:0 24px}.gc{background:rgba(255, 255, 255, 1)}.gd{border:1px solid #F2F2F2}.ge{box-shadow:0 1px 4px #F2F2F2}.gf{max-height:100vh}.gg{overflow-y:auto}.gh{left:0}.gi{top:calc(100vh + 100px)}.gj{bottom:calc(100vh + 100px)}.gk{width:10px}.gl{pointer-events:none}.gm{word-break:break-word}.gn{word-wrap:break-word}.go:after{display:block}.gp:after{content:""}.gq:after{clear:both}.gr{line-height:1.23}.gs{letter-spacing:0}.gt{font-style:normal}.gu{font-weight:700}.hu{@media all and (max-width: 551.98px):8px}.hv{@media all and (min-width: 552px) and (max-width: 727.98px):8px}.hw{@media all and (min-width: 728px) and (max-width: 903.98px):16px}.hx{@media all and (min-width: 904px) and (max-width: 1079.98px):16px}.hy{@media all and (min-width: 1080px):16px}.ie{align-items:baseline}.if{width:48px}.ig{height:48px}.ih{border:2px solid rgba(255, 255, 255, 1)}.ii{z-index:0}.ij{box-shadow:none}.ik{border:1px solid rgba(0, 0, 0, 0.05)}.il{margin-left:-12px}.im{width:28px}.in{height:28px}.io{z-index:1}.ip{width:24px}.iq{margin-bottom:2px}.ir{flex-wrap:nowrap}.is{font-size:16px}.it{line-height:24px}.iv{margin:0 8px}.iw{display:inline}.ix{color:rgba(79, 137, 214, 1)}.iy{fill:rgba(79, 137, 214, 1)}.jb{flex:0 0 auto}.je{flex-wrap:wrap}.jh{white-space:pre-wrap}.ji{margin-right:4px}.jj{overflow:hidden}.jk{max-height:20px}.jl{text-overflow:ellipsis}.jm{display:-webkit-box}.jn{-webkit-line-clamp:1}.jo{-webkit-box-orient:vertical}.jp{word-break:break-all}.jr{padding-left:8px}.js{padding-right:8px}.kt> *{flex-shrink:0}.ku{overflow-x:scroll}.kv::-webkit-scrollbar{display:none}.kw{scrollbar-width:none}.kx{-ms-overflow-style:none}.ky{width:74px}.kz{flex-direction:row}.la{z-index:2}.ld{-webkit-user-select:none}.le{border:0}.lf{fill:rgba(117, 117, 117, 1)}.li{outline:0}.lj{user-select:none}.lk> svg{pointer-events:none}.lt{cursor:progress}.lu{opacity:1}.lv{padding:4px 0}.ly{margin-top:0px}.lz{width:16px}.mb{display:inline-flex}.mh{max-width:100%}.mi{padding:8px 2px}.mj svg{color:#6B6B6B}.na{margin-left:auto}.nb{margin-right:auto}.nc{max-width:1500px}.ni{clear:both}.nk{cursor:zoom-in}.nl{z-index:auto}.nn{height:auto}.no{line-height:1.58}.np{letter-spacing:-0.004em}.nq{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.ol{margin-bottom:-0.46em}.om{max-width:534px}.os{margin-top:32px}.ot{margin-bottom:14px}.ou{padding-top:24px}.ov{padding-bottom:10px}.ow{background-color:#000000}.ox{height:3px}.oy{width:3px}.oz{margin-right:20px}.pa{line-height:1.12}.pb{letter-spacing:-0.022em}.pc{font-weight:600}.px{margin-bottom:-0.28em}.qd{text-decoration:underline}.qe{list-style-type:disc}.qf{margin-left:30px}.qg{padding-left:0px}.qm{max-width:602px}.qn{margin-top:10px}.qo{max-width:728px}.qr{box-shadow:inset 3px 0 0 0 #242424}.qs{padding-left:23px}.qt{margin-left:-20px}.qu{font-style:italic}.qv{max-width:637px}.qw{max-width:621px}.qx{overflow-x:auto}.qy{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.qz{padding:32px}.ra{border:1px solid #E5E5E5}.rb{line-height:1.4}.rc{margin-top:-0.2em}.rd{margin-bottom:-0.2em}.re{white-space:pre}.rf{min-width:fit-content}.rg{max-width:587px}.rm{margin-bottom:26px}.rn{margin-top:6px}.ro{margin-top:8px}.rp{margin-right:8px}.rq{padding:8px 16px}.rr{border-radius:100px}.rs{transition:background 300ms ease}.ru{white-space:nowrap}.rv{border-top:none}.sb{height:52px}.sc{max-height:52px}.sd{box-sizing:content-box}.se{position:static}.sg{max-width:155px}.sr{align-items:flex-end}.ss{width:76px}.st{height:76px}.su{border:2px solid #F9F9F9}.sv{height:72px}.sw{width:72px}.sx{margin-left:-16px}.sy{width:36px}.sz{height:36px}.ta{width:auto}.tb{stroke:#F2F2F2}.tc{color:#F2F2F2}.td{fill:#F2F2F2}.te{background:#F2F2F2}.tf{border-color:#F2F2F2}.tl{font-weight:500}.tm{font-size:24px}.tn{line-height:30px}.to{letter-spacing:-0.016em}.tp{margin-top:16px}.tq{height:0px}.tr{border-bottom:solid 1px #E5E5E5}.ts{margin-top:72px}.tt{padding:24px 0}.tu{margin-bottom:0px}.tv{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.es:hover{background:rgba(73, 118, 178, 1)}.et:hover{border-color:rgba(73, 118, 178, 1)}.eu:hover{cursor:pointer}.fk:hover{color:#242424}.fl:hover{fill:#242424}.fp:hover svg{fill:#242424}.fs:hover{background-color:rgba(0, 0, 0, 0.1)}.iu:hover{text-decoration:underline}.iz:hover:not(:disabled){color:rgba(73, 118, 178, 1)}.ja:hover:not(:disabled){fill:rgba(73, 118, 178, 1)}.lh:hover{fill:rgba(8, 8, 8, 1)}.lw:hover{fill:#000000}.lx:hover p{color:#000000}.ma:hover{color:#000000}.mk:hover svg{color:#000000}.rt:hover{background-color:#F2F2F2}.tg:hover{background:#F2F2F2}.th:hover{border-color:#F2F2F2}.ti:hover{cursor:wait}.tj:hover{color:#F2F2F2}.tk:hover{fill:#F2F2F2}.bc:focus-within path{fill:#242424}.lg:focus{fill:rgba(8, 8, 8, 1)}.ml:focus svg{color:#000000}.nm:focus{transform:scale(1.01)}.ll:active{border-style:none}</style><style type="text/css" data-fela-rehydration="541" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ee{font-size:14px}.ef{line-height:20px}.el{font-size:13px}.em{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:68px}.gb{max-width:680px}.hp{font-size:42px}.hq{margin-top:1.19em}.hr{margin-bottom:32px}.hs{line-height:52px}.ht{letter-spacing:-0.011em}.id{align-items:center}.kf{border-top:solid 1px #F2F2F2}.kg{border-bottom:solid 1px #F2F2F2}.kh{margin:32px 0 0}.ki{padding:3px 8px}.kr> *{margin-right:24px}.ks> :last-child{margin-right:0}.ls{margin-top:0px}.mg{margin:0}.nh{margin-top:40px}.oh{font-size:20px}.oi{margin-top:2.14em}.oj{line-height:32px}.ok{letter-spacing:-0.003em}.or{margin-top:56px}.pt{font-size:24px}.pu{margin-top:1.25em}.pv{line-height:30px}.pw{letter-spacing:-0.016em}.qc{margin-top:0.94em}.ql{margin-top:1.14em}.rl{margin-top:1.95em}.sa{margin-bottom:88px}.sl{display:inline-block}.sq{padding-top:72px}</style><style type="text/css" data-fela-rehydration="541" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.lr{margin-top:0px}.qp{margin-left:auto}.qq{text-align:center}.sk{display:inline-block}</style><style type="text/css" data-fela-rehydration="541" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.lq{margin-top:0px}.sj{display:inline-block}</style><style type="text/css" data-fela-rehydration="541" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.lo{margin-top:0px}.lp{margin-right:0px}.si{display:inline-block}</style><style type="text/css" data-fela-rehydration="541" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.br{width:24px}.cb{margin:0 24px}.cq{height:40px}.cx{margin-bottom:44px}.dj{margin-bottom:32px}.dw{font-size:13px}.dx{line-height:20px}.eg{padding:0px 8px 1px}.ft{margin-bottom:4px}.gv{font-size:32px}.gw{margin-top:1.01em}.gx{margin-bottom:24px}.gy{line-height:38px}.gz{letter-spacing:-0.014em}.hz{align-items:flex-start}.jc{flex-direction:column}.jf{margin-bottom:2px}.jt{margin:24px -24px 0}.ju{padding:0}.kj> *{margin-right:8px}.kk> :last-child{margin-right:24px}.lb{margin-left:0px}.lm{margin-top:0px}.ln{margin-right:0px}.mc{margin:0}.mm{border:1px solid #F2F2F2}.mn{border-radius:99em}.mo{padding:0px 16px 0px 12px}.mp{height:38px}.mq{align-items:center}.ms svg{margin-right:8px}.nd{margin-top:32px}.nr{font-size:18px}.ns{margin-top:1.56em}.nt{line-height:28px}.nu{letter-spacing:-0.003em}.on{margin-top:40px}.pd{font-size:20px}.pe{margin-top:0.93em}.pf{line-height:24px}.pg{letter-spacing:0}.py{margin-top:0.67em}.qh{margin-top:1.34em}.rh{margin-top:1.2em}.rw{margin-bottom:80px}.sh{display:inline-block}.sm{padding-top:48px}.mr:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="541" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bu{width:64px}.ce{margin:0 64px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.ec{font-size:14px}.ed{line-height:20px}.ej{font-size:13px}.ek{padding:5px 12px}.ff{display:flex}.fw{margin-bottom:68px}.ga{max-width:680px}.hk{font-size:42px}.hl{margin-top:1.19em}.hm{margin-bottom:32px}.hn{line-height:52px}.ho{letter-spacing:-0.011em}.ic{align-items:center}.kb{border-top:solid 1px #F2F2F2}.kc{border-bottom:solid 1px #F2F2F2}.kd{margin:32px 0 0}.ke{padding:3px 8px}.kp> *{margin-right:24px}.kq> :last-child{margin-right:0}.mf{margin:0}.ng{margin-top:40px}.od{font-size:20px}.oe{margin-top:2.14em}.of{line-height:32px}.og{letter-spacing:-0.003em}.oq{margin-top:56px}.pp{font-size:24px}.pq{margin-top:1.25em}.pr{line-height:30px}.ps{letter-spacing:-0.016em}.qb{margin-top:0.94em}.qk{margin-top:1.14em}.rk{margin-top:1.95em}.rz{margin-bottom:88px}.sp{padding-top:72px}</style><style type="text/css" data-fela-rehydration="541" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bt{width:64px}.cd{margin:0 48px}.cs{height:48px}.cz{margin-bottom:52px}.dl{margin-bottom:48px}.ea{font-size:13px}.eb{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:68px}.fz{max-width:680px}.hf{font-size:42px}.hg{margin-top:1.19em}.hh{margin-bottom:32px}.hi{line-height:52px}.hj{letter-spacing:-0.011em}.ib{align-items:center}.jx{border-top:solid 1px #F2F2F2}.jy{border-bottom:solid 1px #F2F2F2}.jz{margin:32px 0 0}.ka{padding:3px 8px}.kn> *{margin-right:24px}.ko> :last-child{margin-right:0}.me{margin:0}.nf{margin-top:40px}.nz{font-size:20px}.oa{margin-top:2.14em}.ob{line-height:32px}.oc{letter-spacing:-0.003em}.op{margin-top:56px}.pl{font-size:24px}.pm{margin-top:1.25em}.pn{line-height:30px}.po{letter-spacing:-0.016em}.qa{margin-top:0.94em}.qj{margin-top:1.14em}.rj{margin-top:1.95em}.ry{margin-bottom:88px}.so{padding-top:72px}</style><style type="text/css" data-fela-rehydration="541" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dy{font-size:13px}.dz{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:4px}.ha{font-size:32px}.hb{margin-top:1.01em}.hc{margin-bottom:24px}.hd{line-height:38px}.he{letter-spacing:-0.014em}.ia{align-items:flex-start}.jd{flex-direction:column}.jg{margin-bottom:2px}.jv{margin:24px 0 0}.jw{padding:0}.kl> *{margin-right:8px}.km> :last-child{margin-right:8px}.lc{margin-left:0px}.md{margin:0}.mt{border:1px solid #F2F2F2}.mu{border-radius:99em}.mv{padding:0px 16px 0px 12px}.mw{height:38px}.mx{align-items:center}.mz svg{margin-right:8px}.ne{margin-top:32px}.nv{font-size:18px}.nw{margin-top:1.56em}.nx{line-height:28px}.ny{letter-spacing:-0.003em}.oo{margin-top:40px}.ph{font-size:20px}.pi{margin-top:0.93em}.pj{line-height:24px}.pk{letter-spacing:0}.pz{margin-top:0.67em}.qi{margin-top:1.34em}.ri{margin-top:1.2em}.rx{margin-bottom:80px}.sn{padding-top:48px}.my:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="541" data-fela-type="RULE" media="print">.sf{display:none}</style><style type="text/css" data-fela-rehydration="541" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.jq{max-height:none}</style><style type="text/css" data-fela-rehydration="541" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.nj{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style><script type="text/javascript" async="" src="https://www.gstatic.com/recaptcha/releases/TqxSU0dsOd2Q9IbI7CpFnJLD/recaptcha__pl.js" crossorigin="anonymous" integrity="sha384-EtuwsrUt4o3rjKbOIgbMlrdETicyC7YJiOMF4S2kRPR2c6EcUDPrB1OFkiSEO3IC"></script><script async="" src="https://cdn.branch.io/branch-latest.min.js"></script><link rel="icon" href="https://miro.medium.com/v2/resize:fill:160:160/1*6vD2snnhevDB4lAZ1STPbw.png" data-rh="true"><script type="application/ld+json" data-rh="true">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*lOK_3N4qBrDcmiKlA9hjSw.jpeg"],"url":"https:\u002F\u002Fblog.neuvik.com\u002Fjourney-into-windows-kernel-exploitation-the-basics-fff72116ca33","dateCreated":"2023-08-18T17:56:05.470Z","datePublished":"2023-08-18T17:56:05.470Z","dateModified":"2023-10-24T22:29:26.157Z","headline":"Journey into Windows Kernel Exploitation: The Basics","name":"Journey into Windows Kernel Exploitation: The Basics","description":"This blogpost embarks on the initial stages of kernel exploitation. The content serves as an introduction, leading to an imminent and comprehensive whitepaper centered around this subject matter…","identifier":"fff72116ca33","author":{"@type":"Person","name":"Jean","url":"https:\u002F\u002Fblog.neuvik.com\u002F@jean_82568"},"creator":["Jean"],"publisher":{"@type":"Organization","name":"Neuvik","url":"blog.neuvik.com","logo":{"@type":"ImageObject","width":203,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:254\u002F1*lif7rzCQb8w9-u3vOHVkUA.png"}},"mainEntityOfPage":"https:\u002F\u002Fblog.neuvik.com\u002Fjourney-into-windows-kernel-exploitation-the-basics-fff72116ca33"}</script><script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-7JY7T788PK" data-rh="true"></script><script data-rh="true">window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'G-7JY7T788PK');</script><script src="https://www.google.com/recaptcha/enterprise.js?render=6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp" data-rh="true"></script><script type="text/javascript" data-rh="true">(function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src="https://cdn.branch.io/branch-latest.min.js";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,"script","branch",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},"addListener applyCode autoAppIndex banner closeBanner closeJourney creditHistory credits data deepview deepviewCta first getCode init link logout redeem referrals removeListener sendSMS setBranchViewData setIdentity track validateCode trackCommerceEvent logEvent".split(" "), 0);
branch.init('key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm', {metadata: {}, 'no_journeys': true, 'disable_exit_animation': true, 'disable_entry_animation': true, 'tracking_disabled': null}, function(err, data) {});</script></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div><script>if (window.self !== window.top) window.location = "about:blank"</script></div><div class="l c"><div class="l m n o c" style="transform: translateY(0px);"><div class="p q r s t u v w x i d y z"><a class="dt ag du be ak b am an ao ap aq ar as at s u w i d q dv z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ffff72116ca33&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderCollection&amp;source=---two_column_layout_nav----------------------------------" rel="noopener follow">Open in app<svg width="10" height="10" viewBox="0 0 10 10" fill="none" class="ds"><path d="M.98 8.48a.37.37 0 1 0 .54.54l-.54-.54zm7.77-7.23h.38c0-.2-.17-.38-.38-.38v.38zM8.37 6.5a.37.37 0 1 0 .76 0h-.76zM3.5.87a.37.37 0 1 0 0 .76V.88zM1.52 9.03l7.5-7.5-.54-.54-7.5 7.5.54.54zm6.86-7.77V6.5h.74V1.25h-.74zm-4.88.38h5.25V.88H3.5v.74z" fill="currentColor"></path></svg></a><div class="ab q"><p class="be b dw dx dy dz ea eb ec ed ee ef dt"><span><a class="be b dw dx eg dy dz eh ea eb ei ej ed ek el ef em eo ep eq er es et eu ev ew ex ey ez fa fb fc bl fd fe" data-testid="headerSignUpButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fblog.neuvik.com%2Fjourney-into-windows-kernel-exploitation-the-basics-fff72116ca33&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign up</a></span></p><div class="aw l"><p class="be b dw dx dy dz ea eb ec ed ee ef dt"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fblog.neuvik.com%2Fjourney-into-windows-kernel-exploitation-the-basics-fff72116ca33&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=---two_column_layout_nav----------------------------------" rel="noopener follow"><svg width="120" height="27" viewBox="0 0 120 27" fill="none"><mask id="logo-wordmark-pride_svg__a" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="1" y="0" width="119" height="27"><path d="M29.69 2.36h.03v-.29h-7.26L15.7 18.05 8.96 2.07H1.12v.28l.04.01c1.32.3 2 .75 2 2.37v19c0 1.62-.68 2.07-2 2.37h-.04v.29h5.31v-.28H6.4c-1.33-.3-2-.76-2-2.38V5.83l8.67 20.56h.5l8.91-21.13V24.2c-.1 1.28-.78 1.67-1.98 1.95h-.03v.28h9.25v-.27l-.03-.01c-1.2-.28-1.89-.67-2-1.95V4.73c0-1.62.67-2.07 2-2.37zm4.23 12.58c.15-3.41 1.37-5.87 3.4-5.92.64.01 1.17.22 1.58.62.87.86 1.28 2.64 1.22 5.3h-6.2zm-.1.96h10.86v-.04c-.03-2.61-.78-4.64-2.23-6.03a7.3 7.3 0 0 0-5.05-1.87h-.04a7.31 7.31 0 0 0-5.75 2.78 10.4 10.4 0 0 0-2.08 5.72l-.02.2a7.61 7.61 0 0 0-.02.56v.58c.11 5.09 2.84 9.16 7.69 9.16 4.25 0 6.73-3.14 7.35-7.34l-.32-.11c-1.08 2.26-3.03 3.63-5.25 3.46-3.03-.23-5.35-3.32-5.13-7.06m23.12 6.89c-.36.85-1.1 1.32-2.1 1.32s-1.9-.7-2.55-1.94a12.23 12.23 0 0 1-1.06-5.49c0-4.68 1.45-7.7 3.68-7.7.94 0 1.68.47 2.03 1.28V22.8zm7.2 3.33c-1.33-.31-2-.78-2-2.49V.96l-8.07 2.39v.3l.05-.01c1.11-.1 1.87.06 2.3.47.35.32.52.8.52 1.5v3.1a5.18 5.18 0 0 0-2.89-.75c-2.33 0-4.45.98-5.99 2.78-1.6 1.86-2.44 4.42-2.44 7.38 0 5.28 2.58 8.84 6.43 8.84a5.09 5.09 0 0 0 4.89-3.34v2.81h7.23v-.29h-.03zm6.9-22.09c0-1.65-1.23-2.9-2.87-2.9a2.87 2.87 0 0 0-2.9 2.9c0 1.63 1.27 2.9 2.9 2.9a2.82 2.82 0 0 0 2.88-2.9zm1.91 22.1c-1.32-.32-2-.8-2-2.5V8.01l-7.24 2.1v.28h.05c1.56.14 1.99.68 1.99 2.53v13.51H73v-.29h-.04zm18.54 0c-1.33-.32-2-.8-2-2.5V8.01l-6.89 2.02v.29h.04c1.28.14 1.65.71 1.65 2.56v9.88a2.48 2.48 0 0 1-2.2 1.4c-1.57 0-2.43-1.08-2.43-3.02V8.01l-7.24 2.1v.28h.04c1.57.14 2 .68 2 2.53v8.36c0 .58.05 1.16.15 1.74l.13.57c.61 2.21 2.22 3.37 4.73 3.37 2.13 0 4-1.33 4.82-3.4v2.88h7.23v-.3h-.03zm28.1.3v-.3h-.03c-1.44-.34-2-.97-2-2.26V13.25c0-3.31-1.85-5.3-4.95-5.3a5.08 5.08 0 0 0-4.9 3.37c-.58-2.17-2.25-3.36-4.73-3.36a4.7 4.7 0 0 0-4.61 3.1V8.02l-7.23 2v.3h.04c1.55.14 2 .7 2 2.49v13.63h6.74v-.29h-.03c-1.15-.28-1.52-.78-1.52-2.05V11.9c.3-.71.91-1.56 2.13-1.56 1.5 0 2.26 1.05 2.26 3.12v12.97h6.75v-.29h-.03c-1.15-.28-1.52-.78-1.52-2.05V13.25a7 7 0 0 0-.1-1.21c.32-.78.97-1.7 2.23-1.7 1.53 0 2.27 1.02 2.27 3.12v12.97h7.23z" fill="#242424"></path></mask><g filter="url(#logo-wordmark-pride_svg__filter0_f_238_6555)" mask="url(#logo-wordmark-pride_svg__a)"><path d="M42.3-64.7l-15.52-6.74L-24.62 47l15.53 6.74L42.3-64.7z" fill="#000"></path><path d="M53.18-59.98L42.3-64.7-9.1 53.74l10.88 4.72 51.4-118.44z" fill="#603917"></path><path d="M64.96-54.87l-11.78-5.11L1.78 58.46l11.79 5.11 51.4-118.44z" fill="#71E2FD"></path><path d="M75.84-50.15l-10.88-4.72-51.4 118.44 10.89 4.72L75.84-50.15z" fill="#FF9BC9"></path><path d="M86.71-45.43l-10.87-4.72L24.44 68.3l10.88 4.72 51.4-118.44z" fill="#FF472F"></path><path d="M97.6-40.7L86.7-45.44 35.32 73.01l10.88 4.72L97.6-40.7z" fill="#FF8312"></path><path d="M108.47-35.99L97.6-40.7 46.2 77.73l10.88 4.72 51.4-118.44z" fill="#FFCE00"></path><path d="M120.25-30.88l-11.78-5.1-51.4 118.43 11.79 5.11 51.4-118.44z" fill="#48E348"></path><path d="M131.13-26.16l-10.88-4.72L68.86 87.56l10.88 4.72 51.4-118.44z" fill="#008EF0"></path><path d="M148.48-18.63l-17.35-7.53-51.4 118.44 17.35 7.53 51.4-118.44z" fill="#9A50FC"></path></g><defs><filter id="logo-wordmark-pride_svg__filter0_f_238_6555" x="-29.5" y="-76.33" width="182.87" height="181.03" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood><feBlend in="SourceGraphic" in2="BackgroundImageFix" result="shape"></feBlend><feGaussianBlur stdDeviation="2.45" result="effect1_foregroundBlur_238_6555"></feGaussianBlur></filter></defs></svg></a><div class="aw h"><div class="ab ax ay az ba q bb bc"><div class="bl" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bm bn ab"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.1 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0zm6.94-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .8-.79l-3.74-3.73A8.05 8.05 0 0 0 11.04 3v.01z" fill="currentColor"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ax bd be bf z bg bh bi bj bk" placeholder="Search" value=""></div></div></div><div class="h k w ff fg"><div class="fh ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---two_column_layout_nav-----------------------new_post_topnav-----------" rel="noopener follow"><div class="be b bf z dt fi fj ab q fk fl"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-label="Write"><path d="M14 4a.5.5 0 0 0 0-1v1zm7 6a.5.5 0 0 0-1 0h1zm-7-7H4v1h10V3zM3 4v16h1V4H3zm1 17h16v-1H4v1zm17-1V10h-1v10h1zm-1 1a1 1 0 0 0 1-1h-1v1zM3 20a1 1 0 0 0 1 1v-1H3zM4 3a1 1 0 0 0-1 1h1V3z" fill="currentColor"></path><path d="M17.5 4.5l-8.46 8.46a.25.25 0 0 0-.06.1l-.82 2.47c-.07.2.12.38.31.31l2.47-.82a.25.25 0 0 0 .1-.06L19.5 6.5m-2-2l2.32-2.32c.1-.1.26-.1.36 0l1.64 1.64c.1.1.1.26 0 .36L19.5 6.5m-2-2l2 2" stroke="currentColor"></path></svg><div class="ds l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fh ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" href="https://medium.com/search?source=---two_column_layout_nav----------------------------------" rel="noopener follow"><div class="be b bf z dt fi fj ab q fk fl"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-label="Search"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.1 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0zm6.94-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .8-.79l-3.74-3.73A8.05 8.05 0 0 0 11.04 3v.01z" fill="currentColor"></path></svg></div></a></div></div><div class="fh h k j"><div class="ab q"><p class="be b dw dx dy dz ea eb ec ed ee ef dt"><span><a class="be b dw dx eg dy dz eh ea eb ei ej ed ek el ef em eo ep eq er es et eu ev ew ex ey ez fa fb fc bl fd fe" data-testid="headerSignUpButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fblog.neuvik.com%2Fjourney-into-windows-kernel-exploitation-the-basics-fff72116ca33&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign up</a></span></p><div class="aw l"><p class="be b dw dx dy dz ea eb ec ed ee ef dt"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fblog.neuvik.com%2Fjourney-into-windows-kernel-exploitation-the-basics-fff72116ca33&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ax fm am ab q ao fn fo fp" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fi"><img alt="" class="l fc bx by bz cw" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"><div class="fq bx l by bz fr n ax fs"></div></div></button></div></div></div><div class="l"><div class="sf" role="dialog" aria-modal="true" tabindex="-1"><div class="xb xc bg dv uh xd ud ao xe gl xf" aria-hidden="true" role="presentation"></div><div class="xg uh xh xi xj xb dv fc xk xl xm lu xn xo ui xp xq xr xs xt xu" aria-hidden="true"></div></div><div class="ft fu fv fw fx l"><div class="ab ca"><div class="ch bg fy fz ga gb"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fr gh gi gj gk gl"></div><div class="gm gn go gp gq"><div class="ab ca"><div class="ch bg fy fz ga gb"><div><h1 id="df8d" class="pw-post-title gr gs gt be gu gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht bj" data-testid="storyTitle" data-selectable-paragraph="">Journey into Windows Kernel Exploitation: The Basics</h1><div class="hu hv hw hx hy"><div class="speechify-ignore ab co"><div class="speechify-ignore bg l"><div class="hz ia ib ic id ab"><div><div class="ab ie"><a href="https://medium.com/@jean_82568?source=post_page-----fff72116ca33--------------------------------" rel="noopener follow"><div><div class="bl" aria-hidden="false" aria-describedby="1" aria-labelledby="1"><div class="l if ig bx ih ii"><div class="l fi"><img alt="Jean" class="l fc bx dc dd cw" src="https://miro.medium.com/v2/resize:fill:88:88/1*odcvWd6mq9Gr0n_DDF2u_g.jpeg" width="44" height="44" loading="lazy" data-testid="authorPhoto"><div class="ij bx l dc dd fr n ik fs"></div></div></div></div></div></a><a href="https://blog.neuvik.com/?source=post_page-----fff72116ca33--------------------------------" rel="noopener  ugc nofollow"><div class="il ab fi"><div><div class="bl" aria-hidden="false" aria-describedby="2" aria-labelledby="2"><div class="l im in bx ih io"><div class="l fi"><img alt="Neuvik" class="l fc bx bq ip cw" src="https://miro.medium.com/v2/resize:fill:48:48/1*-8PVjte6Kwo7RNpng83hTg.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto"><div class="ij bx l bq ip fr n ik fs"></div></div></div></div></div></div></a></div></div><div class="bm bg l"><div class="ab"><div style="flex:1"><span class="be b bf z bj"><div class="iq ab q"><div class="ab q ir"><div class="ab q"><div><div class="bl" aria-hidden="false" aria-describedby="3" aria-labelledby="3"><p class="be b is it bj"><a class="af ag ah ai aj ak al am an ao ap aq ar iu" data-testid="authorName" href="https://medium.com/@jean_82568?source=post_page-----fff72116ca33--------------------------------" rel="noopener follow">Jean</a></p></div></div></div><span class="iv iw" aria-hidden="true"><span class="be b bf z dt">·</span></span><p class="be b is it dt"><span><a class="ix iy ah ai aj ak al am an ao ap aq ar ew iz ja" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc6ea1883b294&amp;operation=register&amp;redirect=https%3A%2F%2Fblog.neuvik.com%2Fjourney-into-windows-kernel-exploitation-the-basics-fff72116ca33&amp;user=Jean&amp;userId=c6ea1883b294&amp;source=post_page-c6ea1883b294----fff72116ca33---------------------post_header-----------" rel="noopener follow">Follow</a></span></p></div></div></span></div></div><div class="l jb"><span class="be b bf z dt"><div class="ab cm jc jd je"><div class="jf jg ab"><div class="be b bf z dt ab jh"><span class="ji l jb">Published in</span><div><div class="l" aria-hidden="false" aria-describedby="4" aria-labelledby="4"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" data-testid="publicationName" href="https://blog.neuvik.com/?source=post_page-----fff72116ca33--------------------------------" rel="noopener  ugc nofollow"><p class="be b bf z jj jk jl jm jn jo jp jq bj">Neuvik</p></a></div></div></div><div class="h k"><span class="iv iw" aria-hidden="true"><span class="be b bf z dt">·</span></span></div></div><span class="be b bf z dt"><div class="ab ae"><span data-testid="storyReadTime">17 min read</span><div class="jr js l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="be b bf z dt">·</span></span></div><span data-testid="storyPublishDate">Aug 18, 2023</span></div></span></div></span></div></div></div><div class="ab co jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki"><div class="h k w ff fg q"><div class="ky l"><div class="ab q kz la"><div class="pw-multi-vote-icon fi ji lb lc ld"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fneuvik%2Ffff72116ca33&amp;operation=register&amp;redirect=https%3A%2F%2Fblog.neuvik.com%2Fjourney-into-windows-kernel-exploitation-the-basics-fff72116ca33&amp;user=Jean&amp;userId=c6ea1883b294&amp;source=-----fff72116ca33---------------------clap_footer-----------" rel="noopener follow"><div><div class="bl" aria-hidden="false" aria-describedby="5" aria-labelledby="5"><div class="le ao lf lg lh li am lj lk ll ld"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lm ln lo lp lq lr ls"><div><div class="bl" aria-hidden="false" aria-describedby="80" aria-labelledby="80"><p class="be b du z dt"><button class="af ag ah ai aj ak al am an ao ap aq ar as at zc ma">14<span class="l h g f sk sl"></span></button></p></div></div></div></div></div><div><div class="bl" aria-hidden="false" aria-describedby="6" aria-labelledby="6"><button class="ao le lu lv ab q fj lw lx" aria-label="responses"><svg width="24" height="24" viewBox="0 0 24 24" class="ly"><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></button></div></div></div><div class="ab q kj kk kl km kn ko kp kq kr ks kt ku kv kw kx"><div class="lz k j i d"></div><div class="h k"><div><div class="bl" aria-hidden="false" aria-describedby="7" aria-labelledby="7"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffff72116ca33&amp;operation=register&amp;redirect=https%3A%2F%2Fblog.neuvik.com%2Fjourney-into-windows-kernel-exploitation-the-basics-fff72116ca33&amp;source=-----fff72116ca33---------------------bookmark_footer-----------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div><div class="fc mb cm"><div class="l ae"><div class="ab ca"><div class="mc md me mf mg mh ch bg"><div class="ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2Fplans%3Fdimension%3Dpost_audio_button%26postId%3Dfff72116ca33&amp;operation=register&amp;redirect=https%3A%2F%2Fblog.neuvik.com%2Fjourney-into-windows-kernel-exploitation-the-basics-fff72116ca33&amp;source=-----fff72116ca33---------------------post_audio_button-----------" rel="noopener follow"><div><div class="bl" aria-hidden="false" aria-describedby="26" aria-labelledby="26"><button aria-label="Listen" data-testid="audioPlayButton" class="af fj ah ai aj ak al mi an ao ap ew mj mk lx ml mm mn mo mp s mq mr ms mt mu mv mw u mx my mz"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0zm9-10a10 10 0 1 0 0 20 10 10 0 0 0 0-20zm3.38 10.42l-4.6 3.06a.5.5 0 0 1-.78-.41V8.93c0-.4.45-.63.78-.41l4.6 3.06c.3.2.3.64 0 .84z" fill="currentColor"></path></svg><div class="j i d"><p class="be b bf z dt">Listen</p></div></button></div></div></a></span></div></div></div></div></div><div class="bl" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bl" aria-hidden="false" aria-describedby="9" aria-labelledby="9"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fj ah ai aj ak al mi an ao ap ew mj mk lx ml mm mn mo mp s mq mr ms mt mu mv mw u mx my mz"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.22 4.93a.42.42 0 0 1-.12.13h.01a.45.45 0 0 1-.29.08.52.52 0 0 1-.3-.13L12.5 3v7.07a.5.5 0 0 1-.5.5.5.5 0 0 1-.5-.5V3.02l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.8a.42.42 0 0 1 .07.5zm-.1.14zm.88 2h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11a2 2 0 0 1-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.14c.1.1.15.22.15.35a.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9V8.96c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1z" fill="currentColor"></path></svg><div class="j i d"><p class="be b bf z dt">Share</p></div></button></div></div></div></div></div></div></div></div></div><figure class="nd ne nf ng nh ni na nb paragraph-image"><div role="button" tabindex="0" class="nj nk fi nl bg nm"><div class="na nb nc"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*AgyETlODx9orsdwbgZHhOw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*AgyETlODx9orsdwbgZHhOw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*AgyETlODx9orsdwbgZHhOw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*AgyETlODx9orsdwbgZHhOw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*AgyETlODx9orsdwbgZHhOw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*AgyETlODx9orsdwbgZHhOw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AgyETlODx9orsdwbgZHhOw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*AgyETlODx9orsdwbgZHhOw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*AgyETlODx9orsdwbgZHhOw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*AgyETlODx9orsdwbgZHhOw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*AgyETlODx9orsdwbgZHhOw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*AgyETlODx9orsdwbgZHhOw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*AgyETlODx9orsdwbgZHhOw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*AgyETlODx9orsdwbgZHhOw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="“Journey into Windows Kernel Exploitation: The Basics” is the title, set above the author’s name, Jean-Francoise Maes, which is next to the Neuvik logo. A photo of the author is on the left." class="bg mh nn c" width="700" height="350" loading="eager" src="https://miro.medium.com/v2/resize:fit:875/1*AgyETlODx9orsdwbgZHhOw.png"></picture></div></div></figure><p id="27de" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">This blogpost embarks on the initial stages of kernel exploitation. The content serves as an introduction, leading to an imminent and comprehensive whitepaper centered around this subject matter. Through this, a foundation is laid for understanding how kernel drivers are developed, as well as basic understanding around key concepts that will be instrumental to comprehending the paper itself.</p><figure class="on oo op oq or ni na nb paragraph-image"><div class="na nb om"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*lOK_3N4qBrDcmiKlA9hjSw.jpeg 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*lOK_3N4qBrDcmiKlA9hjSw.jpeg 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*lOK_3N4qBrDcmiKlA9hjSw.jpeg 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*lOK_3N4qBrDcmiKlA9hjSw.jpeg 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*lOK_3N4qBrDcmiKlA9hjSw.jpeg 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*lOK_3N4qBrDcmiKlA9hjSw.jpeg 1100w, https://miro.medium.com/v2/resize:fit:1068/format:webp/1*lOK_3N4qBrDcmiKlA9hjSw.jpeg 1068w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 534px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*lOK_3N4qBrDcmiKlA9hjSw.jpeg 640w, https://miro.medium.com/v2/resize:fit:720/1*lOK_3N4qBrDcmiKlA9hjSw.jpeg 720w, https://miro.medium.com/v2/resize:fit:750/1*lOK_3N4qBrDcmiKlA9hjSw.jpeg 750w, https://miro.medium.com/v2/resize:fit:786/1*lOK_3N4qBrDcmiKlA9hjSw.jpeg 786w, https://miro.medium.com/v2/resize:fit:828/1*lOK_3N4qBrDcmiKlA9hjSw.jpeg 828w, https://miro.medium.com/v2/resize:fit:1100/1*lOK_3N4qBrDcmiKlA9hjSw.jpeg 1100w, https://miro.medium.com/v2/resize:fit:1068/1*lOK_3N4qBrDcmiKlA9hjSw.jpeg 1068w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 534px"><img alt="" class="bg mh nn c" width="534" height="467" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:668/1*lOK_3N4qBrDcmiKlA9hjSw.jpeg"></picture></div></figure></div></div></div><div class="ab ca os ot ou ov" role="separator"><span class="ow bx bl ox oy oz"></span><span class="ow bx bl ox oy oz"></span><span class="ow bx bl ox oy"></span></div><div class="gm gn go gp gq"><div class="ab ca"><div class="ch bg fy fz ga gb"><h1 id="e6f3" class="pa pb gt be pc pd pe pf pg ph pi pj pk pl pm pn po pp pq pr ps pt pu pv pw px bj" data-selectable-paragraph="">Relevance of the research</h1><p id="9ff3" class="pw-post-body-paragraph no np gt nq b nr py nt nu nv pz nx ny nz qa ob oc od qb of og oh qc oj ok ol gm bj" data-selectable-paragraph="">Over the last few years, both offense and defense have made some advancements in the infosec space. With EDRs placing hooks in usermode, offensive tradecraft evolved from utilizing naïve (not a typo) WIN32 API calls to dynamic invocation to avoid Import Address Table entries to finally utilizing syscalls and indirect syscalls.</p><p id="41d6" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">Now that offensive tradecraft effectively caught up, more and more security products are stepping away from userland hooks and are focusing more on telemetry collected from ETW, such as the ETWti provider, which used to be only accessible by defender for endpoint (at least officially, for a while) and kernel callbacks.</p><p id="63af" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">This has forced offensive tradecraft to take a look at these technologies and how to neutralize them. This blogpost is by no means anything new; research in this field has been done years ago, with popular tools such as <a class="af qd" href="https://github.com/gentilkiwi/mimikatz" rel="noopener ugc nofollow" target="_blank">mimikatz’s driver</a>, <a class="af qd" href="https://github.com/br-sn/CheekyBlinder" rel="noopener ugc nofollow" target="_blank">cheeky blinder</a>, <a class="af qd" href="https://github.com/hfiref0x/KDU" rel="noopener ugc nofollow" target="_blank">KDU</a>, <a class="af qd" href="https://github.com/jthuraisamy/TelemetrySourcerer" rel="noopener ugc nofollow" target="_blank">telemetry sourcerer</a>, etc…</p><p id="8f85" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">These tools have one thing in common though: they require a driver to be loaded, which can be problematic as loading unsigned drivers is no longer possible thanks to <a class="af qd" href="https://learn.microsoft.com/en-us/windows-hardware/drivers/install/kernel-mode-code-signing-policy--windows-vista-and-later-" rel="noopener ugc nofollow" target="_blank">Microsoft’s driver signing enforcement policy</a> which simply disallows unsigned drivers being loaded into the kernel space. Although some of the tools out there make use of signed drivers (like the mimikatz driver), there is a high chance that these known malicious drivers are signatured and will trigger alerts. This means another way to tamper with these protections or another way to load (unsigned) drivers is needed.</p><p id="e656" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">Relatively recently, there was a resurfacing of <a class="af qd" href="https://blog.talosintelligence.com/old-certificate-new-signature/" rel="noopener ugc nofollow" target="_blank">interesting research published</a> which hooks specific functions in the signtool from Microsoft, allowing drivers getting signed by outdated certs to be recognized as legitimate. This avenue has been there for a while, but flew under the radar for a lot of people until it got abused by threat actors; however, this method lacks some finesse, as it still involves dropping an unknown (self-created) driver to disk, which could still get blocked because there is no reputation attached to it.</p><p id="d281" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">Another approach is roaming publicly available cloud resources and/or git repositories in order to hunt for code signing certificates being leaked (typically in pfx format). Without much effort, it’s possible to find a variety of these pfx files, which can be brute-forced due to having a very weak password. <a class="af qd" href="https://twitter.com/curi0usJack/status/1681478069599469568" rel="noopener ugc nofollow" target="_blank">This leads to an interesting Twitter debate considering the ethics around this approach.</a></p><p id="1bdc" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">The final approach, which will be the meat of the research paper and blogpost, is utilizing vulnerable drivers to do your bidding. Depending on the vulnerabilities found in the driver(s) on a system, there are a variety of things you can do:</p><ul class=""><li id="8a72" class="no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol qe qf qg bj" data-selectable-paragraph="">Load unsigned drivers by effectively removing the driver signing enforcement</li><li id="d8fb" class="no np gt nq b nr qh nt nu nv qi nx ny nz qj ob oc od qk of og oh ql oj ok ol qe qf qg bj" data-selectable-paragraph="">Remove or add PPL protections to processes</li><li id="6955" class="no np gt nq b nr qh nt nu nv qi nx ny nz qj ob oc od qk of og oh ql oj ok ol qe qf qg bj" data-selectable-paragraph="">Remove kernel callback signals</li><li id="042d" class="no np gt nq b nr qh nt nu nv qi nx ny nz qj ob oc od qk of og oh ql oj ok ol qe qf qg bj" data-selectable-paragraph="">Patch kernel functions such as NtTraceEvent</li><li id="0150" class="no np gt nq b nr qh nt nu nv qi nx ny nz qj ob oc od qk of og oh ql oj ok ol qe qf qg bj" data-selectable-paragraph="">Neuter ETWti</li><li id="7d00" class="no np gt nq b nr qh nt nu nv qi nx ny nz qj ob oc od qk of og oh ql oj ok ol qe qf qg bj" data-selectable-paragraph="">Load rootkits</li><li id="0c21" class="no np gt nq b nr qh nt nu nv qi nx ny nz qj ob oc od qk of og oh ql oj ok ol qe qf qg bj" data-selectable-paragraph="">Etc…</li></ul><p id="ab7c" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">Drivers are still programs, developed by developers, who may or may not always be aware of secure coding principals. On top of that, kernel development is not a very straightforward feat.</p><p id="893e" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">This leads to vulnerabilities in various kernel drivers signed by reputable vendors. For a practical use case, I recommend checking out the <a class="af qd" href="https://github.com/hfiref0x/KDU" rel="noopener ugc nofollow" target="_blank">KDU project</a> on github; for a vulnerable driver list, I recommend the <a class="af qd" href="https://www.loldrivers.io/" rel="noopener ugc nofollow" target="_blank">loldriver</a> project.</p></div></div></div><div class="ab ca os ot ou ov" role="separator"><span class="ow bx bl ox oy oz"></span><span class="ow bx bl ox oy oz"></span><span class="ow bx bl ox oy"></span></div><div class="gm gn go gp gq"><div class="ab ca"><div class="ch bg fy fz ga gb"><h1 id="0119" class="pa pb gt be pc pd pe pf pg ph pi pj pk pl pm pn po pp pq pr ps pt pu pv pw px bj" data-selectable-paragraph="">User mode vs kernel mode in Windows</h1><p id="ea50" class="pw-post-body-paragraph no np gt nq b nr py nt nu nv pz nx ny nz qa ob oc od qb of og oh qc oj ok ol gm bj" data-selectable-paragraph="">Without going to much off topic, it is worth understanding the difference between what is referred to as “user mode” vs what is referred to as “kernel mode”.</p><figure class="on oo op oq or ni na nb paragraph-image"><div class="na nb qm"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*MVK4MHAx5FVPvp2HYU9Dqg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*MVK4MHAx5FVPvp2HYU9Dqg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*MVK4MHAx5FVPvp2HYU9Dqg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*MVK4MHAx5FVPvp2HYU9Dqg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*MVK4MHAx5FVPvp2HYU9Dqg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*MVK4MHAx5FVPvp2HYU9Dqg.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*MVK4MHAx5FVPvp2HYU9Dqg.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*MVK4MHAx5FVPvp2HYU9Dqg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*MVK4MHAx5FVPvp2HYU9Dqg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*MVK4MHAx5FVPvp2HYU9Dqg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*MVK4MHAx5FVPvp2HYU9Dqg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*MVK4MHAx5FVPvp2HYU9Dqg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*MVK4MHAx5FVPvp2HYU9Dqg.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*MVK4MHAx5FVPvp2HYU9Dqg.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"><img alt="" class="bg mh nn c" width="602" height="338" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:753/1*MVK4MHAx5FVPvp2HYU9Dqg.png"></picture></div><figcaption class="qn fe qo na nb qp qq be b bf z dt" data-selectable-paragraph="">Figure 1: Userland and Kernel Land — <a class="af qd" href="https://leanpub.com/windowskernelprogrammingsecondedition" rel="noopener ugc nofollow" target="_blank">Image coutsey of Pavel’s Windows Kernel Programming Book</a></figcaption></figure><p id="ca0a" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">When you use your Windows computer, you are operating in “usermode”; this is true from both normal privileges as well as elevated (administrator) privileges. This mode is where regular programs — like games, web browsers, and music players — run. In this mode, programs have limited access to your computer’s resources and can’t do anything that might mess up the whole system. It’s like a (relatively) safe playground where you can have fun without worrying too much about causing serious damage. All processes running in usermode have their own virtual memory, which cannot be directly (= without a handle with appropriate permissions) accessed by other processes. To quote the official Microsoft Documentation:</p><blockquote class="qr qs qt"><p id="2cb8" class="no np qu nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">· <em class="gt">For a 32-bit process, the virtual address space is usually the 2-gigabyte range 0x00000000 through 0x7FFFFFFF.</em></p><p id="fd72" class="no np qu nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">· <em class="gt">For a 64-bit process on 64-bit Windows, the virtual address space is the 128-terabyte range 0x000'00000000 through 0x7FFF’FFFFFFFF.</em></p></blockquote><p id="1e80" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">The virtual address space can be extended to 3-gigabyte with a switch, but the default and most commonly observed configuration is 2 gigs.</p><p id="c83a" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">In Windows the high memory of every process (0x80000000 or 0xc0000000) all the way to 0xFFFFFFFF Is reserved for kernel code, user code cannot access these regions of memory, if it tries so an access violation exception will be thrown.</p><figure class="on oo op oq or ni na nb paragraph-image"><div class="na nb qv"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*xGMdUZ5m-SymkrbFbndjGQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*xGMdUZ5m-SymkrbFbndjGQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*xGMdUZ5m-SymkrbFbndjGQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*xGMdUZ5m-SymkrbFbndjGQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*xGMdUZ5m-SymkrbFbndjGQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*xGMdUZ5m-SymkrbFbndjGQ.png 1100w, https://miro.medium.com/v2/resize:fit:1274/format:webp/1*xGMdUZ5m-SymkrbFbndjGQ.png 1274w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 637px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*xGMdUZ5m-SymkrbFbndjGQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*xGMdUZ5m-SymkrbFbndjGQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*xGMdUZ5m-SymkrbFbndjGQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*xGMdUZ5m-SymkrbFbndjGQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*xGMdUZ5m-SymkrbFbndjGQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*xGMdUZ5m-SymkrbFbndjGQ.png 1100w, https://miro.medium.com/v2/resize:fit:1274/1*xGMdUZ5m-SymkrbFbndjGQ.png 1274w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 637px"><img alt="" class="bg mh nn c" width="637" height="298" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:796/1*xGMdUZ5m-SymkrbFbndjGQ.png"></picture></div><figcaption class="qn fe qo na nb qp qq be b bf z dt" data-selectable-paragraph="">Figure 2: memory regions in Windows —<a class="af qd" href="https://leanpub.com/windowskernelprogrammingsecondedition" rel="noopener ugc nofollow" target="_blank"> Image Courtesy of Pavel’s Kernel Programming book</a></figcaption></figure><p id="c5f9" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">This hypothesis can be tested quite easily. For example, by leveraging the EnumDeviceDrivers Windows API call to retrieve an array of base addresses of all device drivers currently loaded in the system.</p><p id="99a1" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">Another valuable alternative would be to check the loaded modules of the system process (ntoskrnl.exe) in Process Hacker2 or using a third-party program such as <a class="af qd" href="https://www.nirsoft.net/utils/driverview.html" rel="noopener ugc nofollow" target="_blank">driverview</a>. If the MSDN documententation is correct, all drivers should be loaded anywhere between 0x80000000 and 0xFFFFFFFF</p><figure class="on oo op oq or ni na nb paragraph-image"><div class="na nb qw"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*SScnr1LPdkNXeRjdm_qZdQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*SScnr1LPdkNXeRjdm_qZdQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*SScnr1LPdkNXeRjdm_qZdQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*SScnr1LPdkNXeRjdm_qZdQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*SScnr1LPdkNXeRjdm_qZdQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*SScnr1LPdkNXeRjdm_qZdQ.png 1100w, https://miro.medium.com/v2/resize:fit:1242/format:webp/1*SScnr1LPdkNXeRjdm_qZdQ.png 1242w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 621px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*SScnr1LPdkNXeRjdm_qZdQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*SScnr1LPdkNXeRjdm_qZdQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*SScnr1LPdkNXeRjdm_qZdQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*SScnr1LPdkNXeRjdm_qZdQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*SScnr1LPdkNXeRjdm_qZdQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*SScnr1LPdkNXeRjdm_qZdQ.png 1100w, https://miro.medium.com/v2/resize:fit:1242/1*SScnr1LPdkNXeRjdm_qZdQ.png 1242w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 621px"><img alt="" class="bg mh nn c" width="621" height="186" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:776/1*SScnr1LPdkNXeRjdm_qZdQ.png"></picture></div><figcaption class="qn fe qo na nb qp qq be b bf z dt" data-selectable-paragraph="">Figure 3: Driver base addresses extracted by Driverview</figcaption></figure><p id="243d" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">Below is a small proof of concept that will attempt to read the magic header (MZ) value on these driver addresses, again, if MSDN documentation is correct this would result into access violations.</p><pre class="on oo op oq or qx qy qz bo ra ba bj"><span id="4d2b" class="rb pb gt qy b bf rc rd l re rf" data-selectable-paragraph=""><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;Windows.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;psapi.h&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> DRIVER_ARRAY_SIZE 1024</span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{<br>    DWORD cbNeeded = <span class="hljs-number">0</span>;<br>    LPVOID drivers[DRIVER_ARRAY_SIZE] { <span class="hljs-literal">nullptr</span> };<br>    DWORD numDrivers = <span class="hljs-number">0</span>;<br><br>    <span class="hljs-comment">// Call EnumDeviceDrivers to get the array of driver base addresses</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">EnumDeviceDrivers</span>(drivers, <span class="hljs-built_in">sizeof</span>(drivers), &amp;cbNeeded)) {<br>        <span class="hljs-comment">// Calculate the number of drivers in the array</span><br>        numDrivers = cbNeeded / <span class="hljs-built_in">sizeof</span>(LPVOID);<br><br>        <span class="hljs-comment">// Iterate through the driver base addresses and print them</span><br>        <span class="hljs-keyword">for</span> (DWORD i = <span class="hljs-number">0</span>; i &lt; numDrivers; i++) {<br>            TCHAR driverName[MAX_PATH] = <span class="hljs-built_in">TEXT</span>(<span class="hljs-string">""</span>);<br>            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">GetDeviceDriverBaseName</span>(drivers[i], driverName, MAX_PATH)) {<br>                std::wcout &lt;&lt; <span class="hljs-string">"Driver #"</span> &lt;&lt; i + <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-string">" Base Address: "</span> &lt;&lt; drivers[i] &lt;&lt; std::endl;<br>                std::wcout &lt;&lt; <span class="hljs-string">"Driver Name: "</span> &lt;&lt; driverName &lt;&lt; std::endl;<br>                std::wcout &lt;&lt; <span class="hljs-string">"Attempting to Read the MZ bytes..."</span> &lt;&lt; std::endl;<br>                <span class="hljs-type">char</span> readBuffer[<span class="hljs-number">2</span>] = {<span class="hljs-number">0</span>};<br>                <span class="hljs-type">size_t</span> bytesRead = <span class="hljs-number">0</span> ;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-built_in">ReadProcessMemory</span>((HANDLE)<span class="hljs-number">-1</span>, drivers[i], &amp;readBuffer, <span class="hljs-number">2</span>, &amp;bytesRead))<br>                {<br>                    std::wcout &lt;&lt; <span class="hljs-string">"It worked! here they are: "</span> &lt;&lt; readBuffer &lt;&lt; std::endl;<br>                }<br>                <span class="hljs-keyword">else</span><br>                {<br>                    std::cerr &lt;&lt; <span class="hljs-string">"Could not read the MZ values: Error code: "</span> &lt;&lt; <span class="hljs-built_in">GetLastError</span>() &lt;&lt; std::endl;<br>                }<br>                <span class="hljs-comment">//comment the next 3 lines of code out if you want the program to continue, just another way of reading without the RPM API call </span><br>                <span class="hljs-comment">//USHORT mz;</span><br>                <span class="hljs-comment">//mz = *(USHORT*)drivers[i];</span><br>                <span class="hljs-comment">//std::wcout &lt;&lt; mz &lt;&lt; std::endl;</span><br>            }<br>        }<br>    }<br>    <span class="hljs-keyword">else</span> {<br>        <span class="hljs-comment">// EnumDeviceDrivers failed, print error message</span><br>        std::cerr &lt;&lt; <span class="hljs-string">"EnumDeviceDrivers failed with error code: "</span> &lt;&lt; <span class="hljs-built_in">GetLastError</span>() &lt;&lt; std::endl;<br>    }<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>} </span></pre><p id="e09b" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">When this code runs, the executor should be greeted with an access violation. Let’s see if this is the case:</p><figure class="on oo op oq or ni na nb paragraph-image"><div class="na nb qm"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*U2Bkbpo6D_EvfO1XZhuaqg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*U2Bkbpo6D_EvfO1XZhuaqg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*U2Bkbpo6D_EvfO1XZhuaqg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*U2Bkbpo6D_EvfO1XZhuaqg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*U2Bkbpo6D_EvfO1XZhuaqg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*U2Bkbpo6D_EvfO1XZhuaqg.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*U2Bkbpo6D_EvfO1XZhuaqg.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*U2Bkbpo6D_EvfO1XZhuaqg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*U2Bkbpo6D_EvfO1XZhuaqg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*U2Bkbpo6D_EvfO1XZhuaqg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*U2Bkbpo6D_EvfO1XZhuaqg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*U2Bkbpo6D_EvfO1XZhuaqg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*U2Bkbpo6D_EvfO1XZhuaqg.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*U2Bkbpo6D_EvfO1XZhuaqg.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"><img alt="" class="bg mh nn c" width="602" height="278" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:753/1*U2Bkbpo6D_EvfO1XZhuaqg.png"></picture></div><figcaption class="qn fe qo na nb qp qq be b bf z dt" data-selectable-paragraph="">Figure 4: Exceptions when attempting to read kernel address from usermode</figcaption></figure><p id="6dbb" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">Upon execution, an unhandled access violation exception is thrown when the code tries to dereference the pointer to the memory location of the first driver base address (this is expected, and inline with what MSDN documentation claims).</p><p id="58d4" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">If instead, the <a class="af qd" href="https://learn.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-readprocessmemory" rel="noopener ugc nofollow" target="_blank">ReadProcessMemory </a>API is used, error code 998 is thrown which according to the MSDN documentation means “Invalid Access to Memory Location”.</p><p id="1db3" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">Let’s try the same exercise from kernel mode now.</p></div></div></div><div class="ab ca os ot ou ov" role="separator"><span class="ow bx bl ox oy oz"></span><span class="ow bx bl ox oy oz"></span><span class="ow bx bl ox oy"></span></div><div class="gm gn go gp gq"><div class="ab ca"><div class="ch bg fy fz ga gb"><h1 id="d0cd" class="pa pb gt be pc pd pe pf pg ph pi pj pk pl pm pn po pp pq pr ps pt pu pv pw px bj" data-selectable-paragraph="">Drivers 101: Basics of kernel development</h1><p id="722f" class="pw-post-body-paragraph no np gt nq b nr py nt nu nv pz nx ny nz qa ob oc od qb of og oh qc oj ok ol gm bj" data-selectable-paragraph="">If you want an excellent resource on how to start developing drivers, a reputable resource would be <a class="af qd" href="https://leanpub.com/windowskernelprogrammingsecondedition" rel="noopener ugc nofollow" target="_blank">Pavel’s Windows Kernel Programming book</a>. This book will obviously go a lot further than what this paper is going to touch upon, including setting up the actual environment to start developing kernel drivers in the first place, and how to debug them.</p><p id="76b9" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">The first thing you need to know is that, much like usermode applications, drivers need an entrypoint to start the initial code flow. In usermode, this is typically referred to as the <strong class="nq gu">main</strong> method of an application (or <strong class="nq gu">dllmain</strong> in case of a dll). In the kernel <strong class="nq gu">DriverEntry</strong> is going to be the entrypoint of a driver.</p><figure class="on oo op oq or ni na nb paragraph-image"><div class="na nb qm"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*dvW4D0VxYWO1HibVlTnxcg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*dvW4D0VxYWO1HibVlTnxcg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*dvW4D0VxYWO1HibVlTnxcg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*dvW4D0VxYWO1HibVlTnxcg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*dvW4D0VxYWO1HibVlTnxcg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*dvW4D0VxYWO1HibVlTnxcg.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*dvW4D0VxYWO1HibVlTnxcg.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*dvW4D0VxYWO1HibVlTnxcg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*dvW4D0VxYWO1HibVlTnxcg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*dvW4D0VxYWO1HibVlTnxcg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*dvW4D0VxYWO1HibVlTnxcg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*dvW4D0VxYWO1HibVlTnxcg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*dvW4D0VxYWO1HibVlTnxcg.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*dvW4D0VxYWO1HibVlTnxcg.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"><img alt="" class="bg mh nn c" width="602" height="212" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:753/1*dvW4D0VxYWO1HibVlTnxcg.png"></picture></div><figcaption class="qn fe qo na nb qp qq be b bf z dt" data-selectable-paragraph="">Figure 5: DriverEntry prototype according to MSDN documentation</figcaption></figure><p id="9ce0" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">A driver, in its bare minimum form, needs to have this function present, as well as an unload routine that would reverse all the effects the driver had on the system. Failure to have an unload routine can/will cause a leak, which is not handled until the next reboot. This can lead to some nasty consequences.</p><p id="cfee" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">Here is code for a bare minimum driver, keeping in mind that the kernel does not have the C++ runtime. If you want to learn more about this, again, Pavel’s book is a goldmine.</p><pre class="on oo op oq or qx qy qz bo ra ba bj"><span id="1c2d" class="rb pb gt qy b bf rc rd l re rf" data-selectable-paragraph=""><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Unload</span><span class="hljs-params">(_In_ PDRIVER_OBJECT DriverObject)</span> </span>{<br> <span class="hljs-built_in">UNREFERENCED_PARAMETER</span>(DriverObject);<br>}<br><br><span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span><br><span class="hljs-function">NTSTATUS<br><span class="hljs-title">DriverEntry</span><span class="hljs-params">(_In_ PDRIVER_OBJECT DriverObject, _In_ PUNICODE_STRING RegistryPath)</span> </span>{<br> <span class="hljs-built_in">UNREFERENCED_PARAMETER</span>(RegistryPath);<br> DriverObject-&gt;DriverUnload = Unload;<br> <span class="hljs-keyword">return</span> STATUS_SUCCESS;<br>}</span></pre><p id="895b" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">Now obviously, this driver is not really very exciting, but a closer look should be taken at the parameters required by the DriverEntry function: specifically, the DriverObject.</p><p id="beff" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">The DriverObject is primarily responsible for calling the appropriate functions within the driver itself based on what the driver was in fact designed to do. In driver development, functionality is passed through “major functions” as long as none of these major functions are implemented, there is no real way to communicate with the driver from usermode. There are several major functions available to driver developers, <a class="af qd" href="https://learn.microsoft.com/en-us/windows-hardware/drivers/kernel/irp-major-function-codes" rel="noopener ugc nofollow" target="_blank">you can find them in the MSDN</a> documentation if you are interested.</p><p id="eec6" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">The most noteworthy major functions are summarized in Pavel’s book:</p><figure class="on oo op oq or ni na nb paragraph-image"><div class="na nb rg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*lUyfzr-8apG2mxW4c14AWg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*lUyfzr-8apG2mxW4c14AWg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*lUyfzr-8apG2mxW4c14AWg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*lUyfzr-8apG2mxW4c14AWg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*lUyfzr-8apG2mxW4c14AWg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*lUyfzr-8apG2mxW4c14AWg.png 1100w, https://miro.medium.com/v2/resize:fit:1174/format:webp/1*lUyfzr-8apG2mxW4c14AWg.png 1174w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 587px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*lUyfzr-8apG2mxW4c14AWg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*lUyfzr-8apG2mxW4c14AWg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*lUyfzr-8apG2mxW4c14AWg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*lUyfzr-8apG2mxW4c14AWg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*lUyfzr-8apG2mxW4c14AWg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*lUyfzr-8apG2mxW4c14AWg.png 1100w, https://miro.medium.com/v2/resize:fit:1174/1*lUyfzr-8apG2mxW4c14AWg.png 1174w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 587px"><img alt="" class="bg mh nn c" width="587" height="300" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:734/1*lUyfzr-8apG2mxW4c14AWg.png"></picture></div><figcaption class="qn fe qo na nb qp qq be b bf z dt" data-selectable-paragraph="">Figure 6: Most used major functions — <a class="af qd" href="https://leanpub.com/windowskernelprogrammingsecondedition" rel="noopener ugc nofollow" target="_blank">Image Courtesy of Pavel’s Kernel Programming book</a></figcaption></figure><p id="72f8" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">In order to receive instructions from usermode, a driver needs to create a device object and create a symbolic link to the object so that we can obtain a handle to it from usermode. This is typically done using the <a class="af qd" href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/wdm/nf-wdm-iocreatedevice" rel="noopener ugc nofollow" target="_blank">IoCreateDevice</a> and <a class="af qd" href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/wdm/nf-wdm-iocreatesymboliclink" rel="noopener ugc nofollow" target="_blank">IoCreateSymbolicLink </a>API calls. Which instructions usermode can send to the kernel will depend on which major functions are implemented on the kernel side.</p><p id="13ca" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">It is best practice to use the major read (IRP_MJ_READ) and write (IRP_MJ_WRITE) functions for “pure” read and write functionality. When “more” has to be done, the best practice dictate to use the device control major function (IRP_MJ_DEVICE_CONTROL).</p><p id="6465" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">Let’s take it step by step and start from just using the IRP_MJ_READ function for now.</p><p id="e672" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">In this minimalistic proof of concept, the bare minimum driver and usermode implementation to get back the base address and DOS header of our own kernel driver is showcased. As a reminder, kernel drivers do not have access to usermode API calls (and therefore finding the base address of a kernel driver is not as straightforward as one might think, but that’s not really the topic of this blog).</p><p id="61f0" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph=""><strong class="nq gu">Driver code:</strong></p><pre class="on oo op oq or qx qy qz bo ra ba bj"><span id="6df4" class="rb pb gt qy b bf rc rd l re rf" data-selectable-paragraph=""><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;ntddk.h&gt;</span></span><br><span class="hljs-comment">//if you wanna learn more about driver IO modes, buffered,direct,neither, I recommend https://www.codeproject.com/Articles/9575/Driver-Development-Part-2-Introduction-to-Implemen</span><br><span class="hljs-comment">//another good resource for kernel base address finding: https://m0uk4.gitbook.io/notebooks/mouka/windowsinternal/find-kernel-module-address-todo#method-3-through-driver-name</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">unsigned</span> <span class="hljs-type">short</span> WORD;<br><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">struct</span> <span class="hljs-title.class">_IMAGE_DOS_HEADER</span><br>{<br> WORD e_magic;<br> WORD e_cblp;<br> WORD e_cp;<br> WORD e_crlc;<br> WORD e_cparhdr;<br> WORD e_minalloc;<br> WORD e_maxalloc;<br> WORD e_ss;<br> WORD e_sp;<br> WORD e_csum;<br> WORD e_ip;<br> WORD e_cs;<br> WORD e_lfarlc;<br> WORD e_ovno;<br> WORD e_res[<span class="hljs-number">4</span>];<br> WORD e_oemid;<br> WORD e_oeminfo;<br> WORD e_res2[<span class="hljs-number">10</span>];<br> LONG e_lfanew;<br>} IMAGE_DOS_HEADER, * PIMAGE_DOS_HEADER;<br> <br><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">struct</span> <span class="hljs-title.class">_DRIVER_INFO</span> {<br> IMAGE_DOS_HEADER DosHeader;<br> PVOID EntryPointAddress;<br>} DRIVER_INFO, * PDRIVER_INFO;<br> <br><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">enum</span> <span class="hljs-title.class">_SYSTEM_INFORMATION_CLASS</span> {<br> SystemBasicInformation,<br> SystemProcessorInformation,<br> SystemPerformanceInformation,<br> SystemTimeOfDayInformation,<br> SystemPathInformation,<br> SystemProcessInformation,<br> SystemCallCountInformation,<br> SystemDeviceInformation,<br> SystemProcessorPerformanceInformation,<br> SystemFlagsInformation,<br> SystemCallTimeInformation,<br> SystemModuleInformation,<br> SystemLocksInformation,<br> SystemStackTraceInformation,<br> SystemPagedPoolInformation,<br> SystemNonPagedPoolInformation,<br> SystemHandleInformation,<br> SystemObjectInformation,<br> SystemPageFileInformation,<br> SystemVdmInstemulInformation,<br> SystemVdmBopInformation,<br> SystemFileCacheInformation,<br> SystemPoolTagInformation,<br> SystemInterruptInformation,<br> SystemDpcBehaviorInformation,<br> SystemFullMemoryInformation,<br> SystemLoadGdiDriverInformation,<br> SystemUnloadGdiDriverInformation,<br> SystemTimeAdjustmentInformation,<br> SystemSummaryMemoryInformation,<br> SystemNextEventIdInformation,<br> SystemEventIdsInformation,<br> SystemCrashDumpInformation,<br> SystemExceptionInformation,<br> SystemCrashDumpStateInformation,<br> SystemKernelDebuggerInformation,<br> SystemContextSwitchInformation,<br> SystemRegistryQuotaInformation,<br> SystemExtendServiceTableInformation,<br> SystemPrioritySeperation,<br> SystemPlugPlayBusInformation,<br> SystemDockInformation,<br> SystemProcessorSpeedInformation,<br> SystemCurrentTimeZoneInformation,<br> SystemLookasideInformation<br>} SYSTEM_INFORMATION_CLASS, * PSYSTEM_INFORMATION_CLASS;<br> <br><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">struct</span> <span class="hljs-title.class">_SYSTEM_MODULE_ENTRY</span><br>{<br> HANDLE Section;<br> PVOID MappedBase;<br> PVOID ImageBase;<br> ULONG ImageSize;<br> ULONG Flags;<br> USHORT LoadOrderIndex;<br> USHORT InitOrderIndex;<br> USHORT LoadCount;<br> USHORT OffsetToFileName;<br> UCHAR FullPathName[<span class="hljs-number">256</span>];<br>} SYSTEM_MODULE_ENTRY, * PSYSTEM_MODULE_ENTRY;<br> <br><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">struct</span> <span class="hljs-title.class">_SYSTEM_MODULE_INFORMATION</span><br>{<br> ULONG Count;<br> SYSTEM_MODULE_ENTRY Module[<span class="hljs-number">1</span>];<br>} SYSTEM_MODULE_INFORMATION, * PSYSTEM_MODULE_INFORMATION;<br> <br> <br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Unload</span><span class="hljs-params">(_In_ PDRIVER_OBJECT DriverObject)</span></span>;<br><span class="hljs-function">NTSTATUS <span class="hljs-title">CreateClose</span><span class="hljs-params">(_In_ PDEVICE_OBJECT DeviceObject, _Inout_ PIRP Irp)</span></span>;<br><span class="hljs-function">NTSTATUS <span class="hljs-title">CompleteIrp</span><span class="hljs-params">(_Inout_ PIRP Irp, _Inout_ NTSTATUS status, _In_ ULONG_PTR info)</span></span>;<br><span class="hljs-function">NTSTATUS <span class="hljs-title">ReadBuffer</span><span class="hljs-params">(_In_ PDEVICE_OBJECT DeviceObject, _Inout_ PIRP Irp)</span></span>;<br> <br> <br> <br> <br><span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span><br>{<br> <span class="hljs-keyword">extern</span> POBJECT_TYPE* IoDriverObjectType;<br> <span class="hljs-function">NTSTATUS NTSYSAPI NTAPI <span class="hljs-title">ObReferenceObjectByName</span><span class="hljs-params">(_In_ PUNICODE_STRING ObjectPath,_In_ ULONG Attributes,_In_ PACCESS_STATE PassedAccessState,_In_ ACCESS_MASK DesiredAccess,_In_ POBJECT_TYPE ObjectType,_In_ KPROCESSOR_MODE AccessMode,_Inout_ PVOID ParseContext,_Out_ PVOID* ObjectPtr)</span></span>;<br> <span class="hljs-function">NTSTATUS <span class="hljs-title">DriverEntry</span><span class="hljs-params">(_In_ PDRIVER_OBJECT DriverObject, _In_ PUNICODE_STRING RegistryPath)</span> </span>{<br>  <span class="hljs-built_in">UNREFERENCED_PARAMETER</span>(RegistryPath);<br>  <span class="hljs-comment">//create the device object</span><br>  UNICODE_STRING devName = <span class="hljs-built_in">RTL_CONSTANT_STRING</span>(<span class="hljs-string">L"\\Device\\ReadMeDriver"</span>);<br>  PDEVICE_OBJECT DeviceObject = <span class="hljs-literal">NULL</span>;<br>  NTSTATUS status = <span class="hljs-built_in">IoCreateDevice</span>(DriverObject, <span class="hljs-number">0</span>, &amp;devName, FILE_DEVICE_UNKNOWN, <span class="hljs-number">0</span>, FALSE, &amp;DeviceObject);<br>  <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">NT_SUCCESS</span>(status)) {<br>   <span class="hljs-built_in">KdPrint</span>((<span class="hljs-string">"Failed to create device object (0x%08X)\n"</span>, status));<br>   <span class="hljs-keyword">return</span> status;<br>  }<br> <br>  <span class="hljs-comment">//make it available in usermode</span><br>  UNICODE_STRING symLink = <span class="hljs-built_in">RTL_CONSTANT_STRING</span>(<span class="hljs-string">L"\\??\\ReadDriver"</span>);<br>  status = <span class="hljs-built_in">IoCreateSymbolicLink</span>(&amp;symLink, &amp;devName);<br>  <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">NT_SUCCESS</span>(status)) {<br>   <span class="hljs-built_in">KdPrint</span>((<span class="hljs-string">"Failed to create symbolic link (0x%08X)\n"</span>, status));<br>   <span class="hljs-built_in">IoDeleteDevice</span>(DeviceObject);<br>   <span class="hljs-keyword">return</span> status;<br>  }<br> <br>  <span class="hljs-comment">//Buffered IO is simplest here, as Usermode and kernelmode are using same buffer</span><br>  DeviceObject-&gt;Flags |= DO_BUFFERED_IO;<br> <br>  <span class="hljs-comment">//major functions </span><br>  DriverObject-&gt;DriverUnload = Unload;<br>  DriverObject-&gt;MajorFunction[IRP_MJ_CREATE] = CreateClose;<br>  DriverObject-&gt;MajorFunction[IRP_MJ_CLOSE] = CreateClose;<br>  DriverObject-&gt;MajorFunction[IRP_MJ_READ] = ReadBuffer;<br>  <span class="hljs-keyword">return</span> STATUS_SUCCESS;<br> }<br>}<br> <br><span class="hljs-function">_Use_decl_annotations_<br>VOID <span class="hljs-title">Unload</span><span class="hljs-params">(_In_ PDRIVER_OBJECT DriverObject)</span> </span>{<br> UNICODE_STRING symLink = <span class="hljs-built_in">RTL_CONSTANT_STRING</span>(<span class="hljs-string">L"\\??\\ReadDriver"</span>);<br> <span class="hljs-comment">// delete symbolic link</span><br> <span class="hljs-built_in">IoDeleteSymbolicLink</span>(&amp;symLink);<br> <span class="hljs-comment">// delete device object</span><br> <span class="hljs-built_in">IoDeleteDevice</span>(DriverObject-&gt;DeviceObject);<br>}<br><br><span class="hljs-function">_Use_decl_annotations_<br>NTSTATUS <span class="hljs-title">CompleteIrp</span><span class="hljs-params">(PIRP Irp, NTSTATUS status = STATUS_SUCCESS, ULONG_PTR info = <span class="hljs-number">0</span>)</span> </span>{<br> Irp-&gt;IoStatus.Status = status;<br> Irp-&gt;IoStatus.Information = info;<br> <span class="hljs-built_in">IoCompleteRequest</span>(Irp, IO_NO_INCREMENT);<br> <span class="hljs-keyword">return</span> status;<br>}<br><br><span class="hljs-function">_Use_decl_annotations_<br>NTSTATUS <span class="hljs-title">CreateClose</span><span class="hljs-params">(PDEVICE_OBJECT DeviceObject, PIRP Irp)</span><br></span>{<br> <span class="hljs-built_in">UNREFERENCED_PARAMETER</span>(DeviceObject);<br> <span class="hljs-keyword">return</span> <span class="hljs-built_in">CompleteIrp</span>(Irp);<br>}<br> <br> <br><span class="hljs-function">PVOID <span class="hljs-title">GetDriverBaseAddress</span><span class="hljs-params">()</span><br></span>{<br> UNICODE_STRING targetDeviceName;<br> NTSTATUS status = STATUS_UNSUCCESSFUL;<br> PDRIVER_OBJECT pKbdDriverObject = <span class="hljs-literal">NULL</span>;<br> <br> <span class="hljs-built_in">RtlInitUnicodeString</span>(&amp;targetDeviceName, <span class="hljs-string">L"\\Driver\\ReadMeDriver"</span>);<br> <span class="hljs-comment">// Try to get the target device object</span><br> status = <span class="hljs-built_in">ObReferenceObjectByName</span>(&amp;targetDeviceName, OBJ_CASE_INSENSITIVE, <span class="hljs-literal">NULL</span>, <span class="hljs-number">0</span>, *IoDriverObjectType, KernelMode, <span class="hljs-literal">NULL</span>, (PVOID*)&amp;pKbdDriverObject);<br> <span class="hljs-built_in">KdPrint</span>((<span class="hljs-string">"READDRV: STATUS: 0x%08X\n"</span>, status));<br> <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">NT_SUCCESS</span>(status))<br> {<br>  <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<br> }<br> <span class="hljs-built_in">KdPrint</span>((<span class="hljs-string">"READDRV: OBJ FOUND\n"</span>));<br> <span class="hljs-comment">//DbgPrint("DriverObject Attributes:\n");</span><br> <span class="hljs-comment">//DbgPrint("  DriverStart: 0x%p\n", pKbdDriverObject-&gt;DriverStart);</span><br> <span class="hljs-comment">//DbgPrint("  DriverSize: 0x%x\n", pKbdDriverObject-&gt;DriverSize);</span><br> <span class="hljs-comment">//DbgPrint("  DriverSection: 0x%p\n", pKbdDriverObject-&gt;DriverSection);</span><br> PVOID baseAddress = pKbdDriverObject-&gt;DriverStart;<br> <span class="hljs-built_in">ObDereferenceObject</span>(pKbdDriverObject);<br> <span class="hljs-keyword">return</span> baseAddress;<br> <br>}<br> <br><span class="hljs-function">_Use_decl_annotations_<br>NTSTATUS <span class="hljs-title">ReadBuffer</span><span class="hljs-params">(PDEVICE_OBJECT DeviceObject, PIRP Irp)</span><br></span>{<br> <span class="hljs-built_in">UNREFERENCED_PARAMETER</span>(DeviceObject);<br> <span class="hljs-keyword">auto</span> status = STATUS_SUCCESS;<br> <span class="hljs-keyword">auto</span> stack = <span class="hljs-built_in">IoGetCurrentIrpStackLocation</span>(Irp);<br> <span class="hljs-keyword">auto</span> len = stack-&gt;Parameters.Read.Length;<br> <span class="hljs-keyword">auto</span> buffer = Irp-&gt;AssociatedIrp.SystemBuffer;<br> <span class="hljs-keyword">if</span> (len &lt; <span class="hljs-built_in">sizeof</span>(DRIVER_INFO))<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">CompleteIrp</span>(Irp, STATUS_INVALID_BUFFER_SIZE);<br> <span class="hljs-keyword">if</span> (!buffer)<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">CompleteIrp</span>(Irp, STATUS_INSUFFICIENT_RESOURCES);<br> <br> PDRIVER_INFO driverInfo = (PDRIVER_INFO)buffer;<br> PVOID baseAddress = <span class="hljs-built_in">GetDriverBaseAddress</span>();<br> <span class="hljs-built_in">RtlCopyMemory</span>(&amp;(driverInfo-&gt;DosHeader), baseAddress, <span class="hljs-built_in">sizeof</span>(IMAGE_DOS_HEADER));<br> driverInfo-&gt;EntryPointAddress = baseAddress;<br> <span class="hljs-built_in">DbgPrint</span>(<span class="hljs-string">" READDRV:  BaseAddr: 0x%p\n"</span>, baseAddress);<br> <span class="hljs-built_in">DbgPrint</span>(<span class="hljs-string">" READDRV:  DOS_MAGIC: 0x%X \n"</span>, driverInfo-&gt;DosHeader.e_magic);<br> <span class="hljs-keyword">return</span> <span class="hljs-built_in">CompleteIrp</span>(Irp, status, <span class="hljs-built_in">sizeof</span>(DRIVER_INFO));<br>}</span></pre><p id="f3ec" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph=""><strong class="nq gu">Corresponding usermode application:</strong></p><pre class="on oo op oq or qx qy qz bo ra ba bj"><span id="2b75" class="rb pb gt qy b bf rc rd l re rf" data-selectable-paragraph=""><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;Windows.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">struct</span> <span class="hljs-title.class">_DRIVER_INFO</span> {<br> IMAGE_DOS_HEADER DosHeader;<br> PVOID EntryPointAddress;<br>} DRIVER_INFO, * PDRIVER_INFO;<br><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">Error</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span>* msg)</span> </span>{<br> <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%s: error=%u\n"</span>, msg, ::<span class="hljs-built_in">GetLastError</span>());<br> <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>}<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span><br></span>{<br> HANDLE hDevice = <span class="hljs-built_in">CreateFile</span>(<span class="hljs-string">L"\\\\.\\ReadDriver"</span>, GENERIC_READ,<span class="hljs-number">0</span>, <span class="hljs-literal">nullptr</span>, OPEN_EXISTING, <span class="hljs-number">0</span>, <span class="hljs-literal">nullptr</span>);<br> <span class="hljs-keyword">if</span> (hDevice == INVALID_HANDLE_VALUE) {<br>   <span class="hljs-keyword">return</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Failed to open device"</span>);<br> }<br><br> <span class="hljs-comment">//BYTE buffer[sizeof DRIVER_INFO] = {0};</span><br> DRIVER_INFO driverInfo = {<span class="hljs-number">0</span>};<br> DWORD bytes = <span class="hljs-number">0</span> ;<br> BOOL ok = <span class="hljs-built_in">ReadFile</span>(hDevice, &amp;driverInfo, <span class="hljs-built_in">sizeof</span>(DRIVER_INFO), &amp;bytes, <span class="hljs-literal">nullptr</span>);<br> <span class="hljs-keyword">if</span> (!ok)<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"failed to read"</span>);<br> <span class="hljs-keyword">if</span> (bytes != <span class="hljs-built_in">sizeof</span>(DRIVER_INFO))<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Wrong number of bytes\n"</span>);<br><br> <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Driver Base Address 0x%p\n"</span>,driverInfo.EntryPointAddress);<br> <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Magic MZ value in hex (expecting 0x5A4D (MZ)): 0x%X\n"</span>, driverInfo.DosHeader.e_magic);<br> <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br> <br>}</span></pre><p id="64fc" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">Unsurprisingly after creating a service for the kernel driver and starting it and running the usermode application to interface with the driver, we get the expected loaded address of the driver alongside with the expected magic byte value — indicating that, indeed, kernel drivers can of course access kernel space addresses.</p><figure class="on oo op oq or ni na nb paragraph-image"><div class="na nb qm"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*IoqJDQe0aMotF7fwQlj09Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*IoqJDQe0aMotF7fwQlj09Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*IoqJDQe0aMotF7fwQlj09Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*IoqJDQe0aMotF7fwQlj09Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*IoqJDQe0aMotF7fwQlj09Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*IoqJDQe0aMotF7fwQlj09Q.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*IoqJDQe0aMotF7fwQlj09Q.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*IoqJDQe0aMotF7fwQlj09Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*IoqJDQe0aMotF7fwQlj09Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*IoqJDQe0aMotF7fwQlj09Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*IoqJDQe0aMotF7fwQlj09Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*IoqJDQe0aMotF7fwQlj09Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*IoqJDQe0aMotF7fwQlj09Q.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*IoqJDQe0aMotF7fwQlj09Q.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"><img alt="" class="bg mh nn c" width="602" height="200" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:753/1*IoqJDQe0aMotF7fwQlj09Q.png"></picture></div><figcaption class="qn fe qo na nb qp qq be b bf z dt" data-selectable-paragraph="">Figure 7: Reading from Kernel land passing it back to userland</figcaption></figure></div></div></div><div class="ab ca os ot ou ov" role="separator"><span class="ow bx bl ox oy oz"></span><span class="ow bx bl ox oy oz"></span><span class="ow bx bl ox oy"></span></div><div class="gm gn go gp gq"><div class="ab ca"><div class="ch bg fy fz ga gb"><h1 id="ae8b" class="pa pb gt be pc pd pe pf pg ph pi pj pk pl pm pn po pp pq pr ps pt pu pv pw px bj" data-selectable-paragraph="">Drivers 201: IOCTL codes</h1><p id="34d5" class="pw-post-body-paragraph no np gt nq b nr py nt nu nv pz nx ny nz qa ob oc od qb of og oh qc oj ok ol gm bj" data-selectable-paragraph="">Now that there is a basic understanding of major functions, particularly the read function, it should become clear that the read function does just that: read. As a user, you do not get to give the kernel driver any other instructions other than “please perform whatever the developer has implemented as the major read function.”</p><p id="01e3" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">In order for users to get to pass more data to the driver, and thus get more freedom (not just read, but also write or even combinations of the two), there is the concept of IO control functions.</p><p id="41fc" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">This time the usermode application is not simply calling the <a class="af qd" href="https://learn.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-readfile" rel="noopener ugc nofollow" target="_blank">ReadFile </a>api call but instead is using an API call called <a class="af qd" href="https://learn.microsoft.com/en-us/windows/win32/api/ioapiset/nf-ioapiset-deviceiocontrol" rel="noopener ugc nofollow" target="_blank">DeviceIoControl</a>. This API call sends a specific “control code” to the driver, which, in case the control code is implemented, is going to perform a specific operation.</p><figure class="on oo op oq or ni na nb paragraph-image"><div class="na nb qm"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*jF0QIdM8qDCy6OTSp8whqQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*jF0QIdM8qDCy6OTSp8whqQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*jF0QIdM8qDCy6OTSp8whqQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*jF0QIdM8qDCy6OTSp8whqQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*jF0QIdM8qDCy6OTSp8whqQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*jF0QIdM8qDCy6OTSp8whqQ.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*jF0QIdM8qDCy6OTSp8whqQ.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*jF0QIdM8qDCy6OTSp8whqQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*jF0QIdM8qDCy6OTSp8whqQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*jF0QIdM8qDCy6OTSp8whqQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*jF0QIdM8qDCy6OTSp8whqQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*jF0QIdM8qDCy6OTSp8whqQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*jF0QIdM8qDCy6OTSp8whqQ.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*jF0QIdM8qDCy6OTSp8whqQ.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"><img alt="" class="bg mh nn c" width="602" height="306" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:753/1*jF0QIdM8qDCy6OTSp8whqQ.png"></picture></div><figcaption class="qn fe qo na nb qp qq be b bf z dt" data-selectable-paragraph="">Figure 8: DeviceIoControl function prototype according to MSDN documentation</figcaption></figure><p id="334e" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">In order to fully understand these functions, a macro needs to be discussed that is accessible for kernel developers. This macro is designed to make sense of control codes so there is somewhat of a logic to it. <strong class="nq gu">This is crucial to understand, as this will form the basis of IOCTL fuzzing which will be covered in the research paper.</strong></p><pre class="on oo op oq or qx qy qz bo ra ba bj"><span id="ba75" class="rb pb gt qy b bf rc rd l re rf" data-selectable-paragraph=""><span class="hljs-meta">#<span class="hljs-keyword">define</span> CTL_CODE( DeviceType, Function, Method, Access ) </span><br>(((DeviceType) &lt;&lt; <span class="hljs-number">16</span>) | ((Access) &lt;&lt; <span class="hljs-number">14</span>) | ((Function) &lt;&lt; <span class="hljs-number">2</span>) | (Method) \</span></pre><p id="82bb" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">Let’s attempt to break down the macro, as this is going to help understand IOCTL fuzzing later on in this paper.</p><p id="b879" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">The <strong class="nq gu">first</strong> parameter is device type, this can be <a class="af qd" href="https://learn.microsoft.com/en-us/windows-hardware/drivers/kernel/specifying-device-types" rel="noopener ugc nofollow" target="_blank">one of the devices that have already been defined by Microsoft</a> such as a keyboard or a mouse, but it could also be software based types such as a mailslot or a named pipe. According to msdn documentation <strong class="nq gu">values of less than 0x8000 are reserved by Microsoft.</strong></p><p id="92ee" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">The <strong class="nq gu">second</strong> parameter is the function, this is the identifier of the function that needs to be resolved by the kernel (this is going to be the bit that makes this IOCTL code unique, because there is a possibility all other bits might be the same). According to msdn documentation, <strong class="nq gu">Values of less than 0x800 are reserved by Microsoft</strong>.</p><p id="859b" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">The <strong class="nq gu">third</strong> parameter is the Transfertype, this is going to determine how data is passed to and from the driver. The options are:</p><ul class=""><li id="3621" class="no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol qe qf qg bj" data-selectable-paragraph="">METHOD_BUFFERED</li><li id="50f6" class="no np gt nq b nr qh nt nu nv qi nx ny nz qj ob oc od qk of og oh ql oj ok ol qe qf qg bj" data-selectable-paragraph="">METHOD_IN_DIRECT / METHOD_OUT_DIRECT</li><li id="5f24" class="no np gt nq b nr qh nt nu nv qi nx ny nz qj ob oc od qk of og oh ql oj ok ol qe qf qg bj" data-selectable-paragraph="">METHOD_NEITHER</li></ul><p id="45f5" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">It’s recommended to <a class="af qd" href="https://learn.microsoft.com/en-us/windows-hardware/drivers/kernel/buffer-descriptions-for-i-o-control-codes" rel="noopener ugc nofollow" target="_blank">read the msdn</a> documentation and/or Pavel’s book for a detailed description of how this works.</p><p id="50b0" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">It is important to note that according to the msdn documentation:<br><strong class="nq gu">METHOD_BUFFERED is the primary transfer type method for intermediate drivers </strong>(which will typically be the drivers that are interesting for attacks).</p><p id="5dfa" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">From a high level point of view, buffered means that input and output buffers are the same, whereas DirectIO has two distinct buffers:</p><ul class=""><li id="3783" class="no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol qe qf qg bj" data-selectable-paragraph="">the Irp-&gt;AssociatedIrp.SystemBuffer as input buffer</li><li id="b3ab" class="no np gt nq b nr qh nt nu nv qi nx ny nz qj ob oc od qk of og oh ql oj ok ol qe qf qg bj" data-selectable-paragraph="">the Irp-&gt;MdlAddress that can be used as additional input buffer or output buffer.</li></ul><p id="b686" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph=""><strong class="nq gu">Lastly</strong> is the FileAccess parameter your options are:</p><ul class=""><li id="5512" class="no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol qe qf qg bj" data-selectable-paragraph="">FILE_READ</li><li id="db50" class="no np gt nq b nr qh nt nu nv qi nx ny nz qj ob oc od qk of og oh ql oj ok ol qe qf qg bj" data-selectable-paragraph="">FILE_WRITE</li><li id="a6b6" class="no np gt nq b nr qh nt nu nv qi nx ny nz qj ob oc od qk of og oh ql oj ok ol qe qf qg bj" data-selectable-paragraph="">ANY</li></ul><p id="404a" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">Most kernel drivers use the ANY file access to make sure that any usermode application would not break in case the kernel driver gets new functionalities that suddenly are going to be using Read Write primitives.</p><p id="f0b2" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">To the astute reader of this section, one can deduce that there is a high probability that custom IOCTL codes are going to be in the 0x8000 range for the device, 0x800 range for the function and then have 0 (METHOD_BUFFERED) and then have another 0 (FILE_ANY_ACCESS), if we take the bit shifting into account that would mean custom IOCTL codes are typically going to be found in the range of</p><p id="c564" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph=""><strong class="nq gu">0x80012004</strong> (CTL_CODE(0x8001,0x801,0,0))</p><p id="c5b3" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">and</p><p id="e1b1" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph=""><strong class="nq gu">0x89992264</strong>(CTL_CODE(0x8999,0x899,0,0))</p><p id="2aa7" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">To further strengthen the concept of IOCTL codes, a PoC can be found bleow that implements an IOCTL code with METHOD_BUFFERED and FILE_ANY_ACCESS access which accepts a structure from usermode that was inspired by a popular vulnerability in the MSI RTCORE64.SYS driver.</p><p id="50a3" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph=""><strong class="nq gu">Driver code:</strong></p><pre class="on oo op oq or qx qy qz bo ra ba bj"><span id="81c4" class="rb pb gt qy b bf rc rd l re rf" data-selectable-paragraph=""><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;ntddk.h&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ReadDriverCode 0x8069</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> IOCTL_ReadDriverMemory CTL_CODE(ReadDriverCode,0x869,METHOD_BUFFERED,FILE_ANY_ACCESS)</span><br><br><span class="hljs-keyword">typedef</span> <span class="hljs-type">unsigned</span> <span class="hljs-type">short</span> WORD;<br><span class="hljs-keyword">typedef</span> <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> BYTE;<br><span class="hljs-keyword">typedef</span> ULONGLONG DWORD64;<br><span class="hljs-keyword">typedef</span> ULONG DWORD;<br><br><span class="hljs-comment">//inspired by MSI RTCORE64.sys vuln</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">struct</span> <span class="hljs-title.class">_MEMORY_READ</span> {<br> BYTE Pad0[<span class="hljs-number">8</span>];<br> DWORD64 Address;<br> BYTE Pad1[<span class="hljs-number">8</span>];<br> DWORD ReadSize;<br> DWORD Value;<br> BYTE Pad3[<span class="hljs-number">16</span>];<br>}MEMORY_READ, * PMEMORY_READ;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Unload</span><span class="hljs-params">(_In_ PDRIVER_OBJECT DriverObject)</span></span>;<br><span class="hljs-function">NTSTATUS <span class="hljs-title">CreateClose</span><span class="hljs-params">(_In_ PDEVICE_OBJECT DeviceObject, _Inout_ PIRP Irp)</span></span>;<br><span class="hljs-function">NTSTATUS <span class="hljs-title">CompleteIrp</span><span class="hljs-params">(_InOut_ PIRP Irp, _InOut_ NTSTATUS status, _In_ ULONG_PTR info)</span></span>;<br><span class="hljs-function">NTSTATUS <span class="hljs-title">ReadNotimplemented</span><span class="hljs-params">(_In_ PDEVICE_OBJECT DeviceObject, _Inout_ PIRP Irp)</span></span>;<br><span class="hljs-function">NTSTATUS <span class="hljs-title">ReadKernelMemory</span><span class="hljs-params">(_In_ PDEVICE_OBJECT DeviceObject, _Inout_ PIRP Irp)</span></span>;<br><br><br><br><br><span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span><br>{<br>  <span class="hljs-function">NTSTATUS <span class="hljs-title">DriverEntry</span><span class="hljs-params">(_In_ PDRIVER_OBJECT DriverObject, _In_ PUNICODE_STRING RegistryPath)</span> </span>{<br>  <span class="hljs-built_in">UNREFERENCED_PARAMETER</span>(RegistryPath);<br>  <span class="hljs-comment">//create the device object</span><br>  UNICODE_STRING devName = <span class="hljs-built_in">RTL_CONSTANT_STRING</span>(<span class="hljs-string">L"\\Device\\ReadDriverIOCTL"</span>);<br>  PDEVICE_OBJECT DeviceObject = <span class="hljs-literal">NULL</span>;<br>  NTSTATUS status = <span class="hljs-built_in">IoCreateDevice</span>(DriverObject, <span class="hljs-number">0</span>, &amp;devName, FILE_DEVICE_UNKNOWN, <span class="hljs-number">0</span>, FALSE, &amp;DeviceObject);<br>  <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">NT_SUCCESS</span>(status)) {<br>   <span class="hljs-built_in">KdPrint</span>((<span class="hljs-string">"Failed to create device object (0x%08X)\n"</span>, status));<br>   <span class="hljs-keyword">return</span> status;<br>  }<br><br>  <span class="hljs-comment">//make it available in usermode</span><br>  UNICODE_STRING symLink = <span class="hljs-built_in">RTL_CONSTANT_STRING</span>(<span class="hljs-string">L"\\??\\ReadDriverIOCTL"</span>);<br>  status = <span class="hljs-built_in">IoCreateSymbolicLink</span>(&amp;symLink, &amp;devName);<br>  <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">NT_SUCCESS</span>(status)) {<br>   <span class="hljs-built_in">KdPrint</span>((<span class="hljs-string">"Failed to create symbolic link (0x%08X)\n"</span>, status));<br>   <span class="hljs-built_in">IoDeleteDevice</span>(DeviceObject);<br>   <span class="hljs-keyword">return</span> status;<br>  }<br><br>  <span class="hljs-comment">//Buffered IO is simplest here, as Usermode and kernelmode are using same buffer</span><br>  DeviceObject-&gt;Flags |= DO_BUFFERED_IO;<br><br>  <span class="hljs-comment">//major functions </span><br>  DriverObject-&gt;DriverUnload = Unload;<br>  DriverObject-&gt;MajorFunction[IRP_MJ_CREATE] = CreateClose;<br>  DriverObject-&gt;MajorFunction[IRP_MJ_CLOSE] = CreateClose;<br>  DriverObject-&gt;MajorFunction[IRP_MJ_READ] = ReadNotimplemented;<br>  DriverObject-&gt;MajorFunction[IRP_MJ_DEVICE_CONTROL] = ReadKernelMemory;<br>  <span class="hljs-keyword">return</span> STATUS_SUCCESS;<br> }<br>}<br><br><span class="hljs-function">_Use_decl_annotations_<br>NTSTATUS <span class="hljs-title">CompleteIrp</span><span class="hljs-params">(PIRP Irp, NTSTATUS status = STATUS_SUCCESS, ULONG_PTR info = <span class="hljs-number">0</span>)</span> </span>{<br> Irp-&gt;IoStatus.Status = status;<br> Irp-&gt;IoStatus.Information = info;<br> <span class="hljs-built_in">IoCompleteRequest</span>(Irp, IO_NO_INCREMENT);<br> <span class="hljs-keyword">return</span> status;<br>}<br><br><span class="hljs-function">_Use_decl_annotations_<br>NTSTATUS <span class="hljs-title">ReadNotimplemented</span><span class="hljs-params">(PDEVICE_OBJECT DeviceObject, PIRP Irp)</span><br></span>{<br> <span class="hljs-built_in">UNREFERENCED_PARAMETER</span>(DeviceObject);<br> <span class="hljs-built_in">KdPrint</span>((<span class="hljs-string">"IRP_MJ_READ is not implemented in this driver, use IOCTL instead\n"</span>));<br> <span class="hljs-keyword">return</span> <span class="hljs-built_in">CompleteIrp</span>(Irp);<br>}<br><br><span class="hljs-function">_Use_decl_annotations_<br>NTSTATUS <span class="hljs-title">ReadKernelMemory</span><span class="hljs-params">(PDEVICE_OBJECT DeviceObject, PIRP Irp)</span><br></span>{<br> <span class="hljs-built_in">UNREFERENCED_PARAMETER</span>(DeviceObject);<br> <span class="hljs-keyword">auto</span> stack = <span class="hljs-built_in">IoGetCurrentIrpStackLocation</span>(Irp);<br> <span class="hljs-keyword">auto</span> ctlcode = stack-&gt;Parameters.DeviceIoControl;<br> NTSTATUS status = STATUS_INVALID_DEVICE_REQUEST;<br> ULONG_PTR totalWritten = <span class="hljs-number">0</span>;<br> <span class="hljs-keyword">switch</span> (ctlcode.IoControlCode)<br> {<br>  <span class="hljs-keyword">case</span> IOCTL_ReadDriverMemory:<br>  {<br>   <span class="hljs-keyword">if</span> (ctlcode.OutputBufferLength &lt; <span class="hljs-built_in">sizeof</span>(MEMORY_READ)) {<br>    <span class="hljs-built_in">KdPrint</span>((<span class="hljs-string">"IOCTLDRV: buffer does not seem to be correct length.\n"</span>));<br>    status = STATUS_BUFFER_TOO_SMALL;<br>    <span class="hljs-keyword">break</span>;<br>   }<br>   <span class="hljs-keyword">auto</span> buffer = Irp-&gt;AssociatedIrp.SystemBuffer;<br>   <span class="hljs-keyword">if</span> (buffer == <span class="hljs-literal">nullptr</span>) {<br>    <span class="hljs-built_in">KdPrint</span>((<span class="hljs-string">"IOCTLDRV: buffer does not seem to point to anything.\n"</span>));<br>    status = STATUS_INVALID_PARAMETER;<br>    <span class="hljs-keyword">break</span>;<br>   }<br><br>   PMEMORY_READ memread = (PMEMORY_READ)buffer;<br>   <span class="hljs-built_in">KdPrint</span>((<span class="hljs-string">"IOCTLDRV: IOCTL ReadDriverMemory Called Successfully \nMemread Struct:\n"</span>));<br>   <span class="hljs-built_in">KdPrint</span>((<span class="hljs-string">"IOCTLDRV: memread Address: 0x%X  \n"</span>, memread-&gt;Address));<br>   <span class="hljs-built_in">KdPrint</span>((<span class="hljs-string">"IOCTLDRV: memread Size: %d \n"</span>, memread-&gt;ReadSize));<br>   <span class="hljs-built_in">RtlCopyMemory</span>(&amp;(memread-&gt;Value), (<span class="hljs-type">void</span>*)memread-&gt;Address, memread-&gt;ReadSize);<br>   <span class="hljs-built_in">KdPrint</span>((<span class="hljs-string">"IOCTLDRV: memread Value: 0x%X \n"</span>, memread-&gt;Value));<br>   status = STATUS_SUCCESS;<br>   totalWritten = <span class="hljs-built_in">sizeof</span>(MEMORY_READ);<br>   <span class="hljs-built_in">KdPrint</span>((<span class="hljs-string">"IOCTLDRV: struct value to return: Value: %llu \n"</span>, <span class="hljs-built_in">sizeof</span>(totalWritten)));<br>   <span class="hljs-keyword">break</span>;<br>  }<br> }<br> <span class="hljs-keyword">return</span> <span class="hljs-built_in">CompleteIrp</span>(Irp, status,totalWritten);<br>}<br><br><span class="hljs-function">_Use_decl_annotations_<br><span class="hljs-type">void</span> <span class="hljs-title">Unload</span><span class="hljs-params">(PDRIVER_OBJECT DriverObject)</span> </span>{<br> UNICODE_STRING symLink = <span class="hljs-built_in">RTL_CONSTANT_STRING</span>(<span class="hljs-string">L"\\??\\ReadDriverIOCTL"</span>);<br> <span class="hljs-comment">// delete symbolic link</span><br> <span class="hljs-built_in">IoDeleteSymbolicLink</span>(&amp;symLink);<br> <span class="hljs-comment">// delete device object</span><br> <span class="hljs-built_in">IoDeleteDevice</span>(DriverObject-&gt;DeviceObject);<br>}<br><br><br><span class="hljs-function">_Use_decl_annotations_<br>NTSTATUS <span class="hljs-title">CreateClose</span><span class="hljs-params">(PDEVICE_OBJECT DeviceObject, PIRP Irp)</span><br></span>{<br> <span class="hljs-built_in">UNREFERENCED_PARAMETER</span>(DeviceObject);<br> <span class="hljs-keyword">return</span> <span class="hljs-built_in">CompleteIrp</span>(Irp);<br>}</span></pre><p id="5793" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph=""><strong class="nq gu">Corresponding user application</strong></p><pre class="on oo op oq or qx qy qz bo ra ba bj"><span id="3e6c" class="rb pb gt qy b bf rc rd l re rf" data-selectable-paragraph=""><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;Windows.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iomanip&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span><br><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ReadDriverCode 0x8069</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> IOCTL_ReadDriverMemory CTL_CODE(ReadDriverCode,0x869,METHOD_BUFFERED,FILE_ANY_ACCESS)</span><br><br><span class="hljs-comment">//inspired by MSI RTCORE64.sys vuln</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">struct</span> <span class="hljs-title.class">_MEMORY_READ</span> {<br> BYTE Pad0[<span class="hljs-number">8</span>];<br> DWORD64 Address;<br> BYTE Pad1[<span class="hljs-number">8</span>];<br> DWORD ReadSize;<br> DWORD Value;<br> BYTE Pad3[<span class="hljs-number">16</span>];<br>}MEMORY_READ, * PMEMORY_READ;<br><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">Error</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span>* msg)</span> </span>{<br> <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%s: error=%u\n"</span>, msg, ::<span class="hljs-built_in">GetLastError</span>());<br> <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>}<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span><br></span>{<br> HANDLE hDevice = <span class="hljs-built_in">CreateFile</span>(<span class="hljs-string">L"\\\\.\\ReadDriverIOCTL"</span>, GENERIC_READ | GENERIC_WRITE, <span class="hljs-number">0</span>, <span class="hljs-literal">nullptr</span>, OPEN_EXISTING, <span class="hljs-number">0</span>, <span class="hljs-literal">nullptr</span>);<br> <span class="hljs-keyword">if</span> (hDevice == INVALID_HANDLE_VALUE) {<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Failed to open device"</span>);<br> }<br> MEMORY_READ memread{ <span class="hljs-number">0</span> };<br> <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>)<br> {<br>        std::string addressStr;<br><br>        std::cout &lt;&lt; <span class="hljs-string">"Enter an address - you WILL bugcheck if its not a valid start of a kernel address! (or press Ctrl+C to exit): "</span>;<br>        std::<span class="hljs-built_in">getline</span>(std::cin, addressStr);<br>        LPVOID address = <span class="hljs-literal">nullptr</span>;<br><br>        <span class="hljs-keyword">try</span><br>        {<br>            <span class="hljs-type">size_t</span> startPos = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">if</span> (addressStr.<span class="hljs-built_in">length</span>() &gt;= <span class="hljs-number">2</span> &amp;&amp; addressStr.<span class="hljs-built_in">substr</span>(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>) == <span class="hljs-string">"0x"</span>)<br>            {<br>                startPos = <span class="hljs-number">2</span>; <span class="hljs-comment">// Skip "0x" prefix</span><br>            }<br><br>            address = <span class="hljs-built_in">reinterpret_cast</span>&lt;LPVOID&gt;(std::<span class="hljs-built_in">stoull</span>(addressStr.<span class="hljs-built_in">substr</span>(startPos), <span class="hljs-number">0</span>, <span class="hljs-number">16</span>));<br>        }<br>        <span class="hljs-built_in">catch</span> (<span class="hljs-type">const</span> std::invalid_argument&amp; ex)<br>        {   std::cout &lt;&lt; <span class="hljs-string">"Invalid input: "</span> &lt;&lt; ex.<span class="hljs-built_in">what</span>() &lt;&lt; std::endl;<br>            <span class="hljs-keyword">continue</span>;<br>        }<br>        memread.Address = (DWORD64)address;<br>        memread.ReadSize = <span class="hljs-number">2</span>;<br>        DWORD bytes;<br>        std::cout &lt;&lt; std::endl;<br><br>        <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">DeviceIoControl</span>(hDevice, IOCTL_ReadDriverMemory, &amp;memread,<span class="hljs-built_in">sizeof</span>(memread), &amp;memread,<span class="hljs-built_in">sizeof</span>(memread), &amp;bytes, <span class="hljs-literal">nullptr</span>))<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"failed in DeviceIoControl"</span>);<br><br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"First  bytes at location 0x%p: 0x%X\n"</span>,(LPVOID)memread.Address, memread.Value);<br><br>    }<br> <br> <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br><br>}</span></pre><p id="67ac" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">When executing the user application, users can now specify an arbitrary address in the kernel virtual address space and get back the bytes at that specific location. This could form the basis of an offensive driver that for example enumerates PPL protection.</p><figure class="on oo op oq or ni na nb paragraph-image"><div class="na nb qm"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*hOzrwXOcoPLxogmM0CkwbQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*hOzrwXOcoPLxogmM0CkwbQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*hOzrwXOcoPLxogmM0CkwbQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*hOzrwXOcoPLxogmM0CkwbQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*hOzrwXOcoPLxogmM0CkwbQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*hOzrwXOcoPLxogmM0CkwbQ.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*hOzrwXOcoPLxogmM0CkwbQ.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*hOzrwXOcoPLxogmM0CkwbQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*hOzrwXOcoPLxogmM0CkwbQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*hOzrwXOcoPLxogmM0CkwbQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*hOzrwXOcoPLxogmM0CkwbQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*hOzrwXOcoPLxogmM0CkwbQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*hOzrwXOcoPLxogmM0CkwbQ.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*hOzrwXOcoPLxogmM0CkwbQ.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"><img alt="" class="bg mh nn c" width="602" height="65" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:753/1*hOzrwXOcoPLxogmM0CkwbQ.png"></picture></div></figure><figure class="on oo op oq or ni na nb paragraph-image"><div role="button" tabindex="0" class="nj nk fi nl bg nm"><div class="na nb qm"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*JvYn4I1aI6O8O5JNouF-sA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*JvYn4I1aI6O8O5JNouF-sA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*JvYn4I1aI6O8O5JNouF-sA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*JvYn4I1aI6O8O5JNouF-sA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*JvYn4I1aI6O8O5JNouF-sA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*JvYn4I1aI6O8O5JNouF-sA.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*JvYn4I1aI6O8O5JNouF-sA.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*JvYn4I1aI6O8O5JNouF-sA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*JvYn4I1aI6O8O5JNouF-sA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*JvYn4I1aI6O8O5JNouF-sA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*JvYn4I1aI6O8O5JNouF-sA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*JvYn4I1aI6O8O5JNouF-sA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*JvYn4I1aI6O8O5JNouF-sA.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*JvYn4I1aI6O8O5JNouF-sA.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"><img alt="" class="bg mh nn c" width="602" height="89" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:753/1*JvYn4I1aI6O8O5JNouF-sA.png"></picture></div></div><figcaption class="qn fe qo na nb qp qq be b bf z dt" data-selectable-paragraph="">Figure 9: Interaction with the IOCTL driver</figcaption></figure></div></div></div><div class="ab ca os ot ou ov" role="separator"><span class="ow bx bl ox oy oz"></span><span class="ow bx bl ox oy oz"></span><span class="ow bx bl ox oy"></span></div><div class="gm gn go gp gq"><div class="ab ca"><div class="ch bg fy fz ga gb"><h1 id="715a" class="pa pb gt be pc pd pe pf pg ph pi pj pk pl pm pn po pp pq pr ps pt pu pv pw px bj" data-selectable-paragraph="">Conclusion</h1><p id="5085" class="pw-post-body-paragraph no np gt nq b nr py nt nu nv pz nx ny nz qa ob oc od qb of og oh qc oj ok ol gm bj" data-selectable-paragraph="">This article provides a basic understanding of how userland programs interact with kernel. With this understanding comes comprehension of potential attack paths, development of offensive drivers, or even research into exploitation of kernel driver vulnerabilities.</p><h1 id="c5ee" class="pa pb gt be pc pd rh pf pg ph ri pj pk pl rj pn po pp rk pr ps pt rl pv pw px bj" data-selectable-paragraph="">What’s Next?</h1><p id="f215" class="pw-post-body-paragraph no np gt nq b nr py nt nu nv pz nx ny nz qa ob oc od qb of og oh qc oj ok ol gm bj" data-selectable-paragraph="">An in-depth whitepaper will be published soon, walking through finding and exploiting kernel driver vulnerabilities. Stay tuned.</p></div></div></div><div class="ab ca os ot ou ov" role="separator"><span class="ow bx bl ox oy oz"></span><span class="ow bx bl ox oy oz"></span><span class="ow bx bl ox oy"></span></div><div class="gm gn go gp gq"><div class="ab ca"><div class="ch bg fy fz ga gb"><h1 id="556c" class="pa pb gt be pc pd pe pf pg ph pi pj pk pl pm pn po pp pq pr ps pt pu pv pw px bj" data-selectable-paragraph="">Further reading</h1><p id="b2ab" class="pw-post-body-paragraph no np gt nq b nr py nt nu nv pz nx ny nz qa ob oc od qb of og oh qc oj ok ol gm bj" data-selectable-paragraph="">Some interesting references in case you can’t wait to start your kernel exploitation journey:</p><ul class=""><li id="7a87" class="no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol qe qf qg bj" data-selectable-paragraph=""><a class="af qd" href="https://voidsec.com/windows-drivers-reverse-engineering-methodology/#driver-buddy-reloaded" rel="noopener ugc nofollow" target="_blank">https://voidsec.com/windows-drivers-reverse-engineering-methodology/#driver-buddy-reloaded</a></li><li id="040d" class="no np gt nq b nr qh nt nu nv qi nx ny nz qj ob oc od qk of og oh ql oj ok ol qe qf qg bj" data-selectable-paragraph=""><a class="af qd" href="https://alice.climent-pommeret.red/posts/process-killer-driver/" rel="noopener ugc nofollow" target="_blank">https://alice.climent-pommeret.red/posts/process-killer-driver/</a></li></ul></div></div></div><div class="ab ca os ot ou ov" role="separator"><span class="ow bx bl ox oy oz"></span><span class="ow bx bl ox oy oz"></span><span class="ow bx bl ox oy"></span></div><div class="gm gn go gp gq"><div class="ab ca"><div class="ch bg fy fz ga gb"><h1 id="bcab" class="pa pb gt be pc pd pe pf pg ph pi pj pk pl pm pn po pp pq pr ps pt pu pv pw px bj" data-selectable-paragraph="">About the Author</h1><p id="625a" class="pw-post-body-paragraph no np gt nq b nr py nt nu nv pz nx ny nz qa ob oc od qb of og oh qc oj ok ol gm bj" data-selectable-paragraph="">Jean-Francois Maes is a Red Teamer and researcher currently working with Neuvik Solution’s Advanced Assessments team. On top of his work with Neuvik, he is also a SANS author and instructor for the SEC565: Red Team Operations and SEC699: Purple Team Tactics courses.</p><p id="0225" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">You can find Jean on social media here:</p><ul class=""><li id="97e9" class="no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol qe qf qg bj" data-selectable-paragraph=""><strong class="nq gu">Twitter</strong>: <a class="af qd" href="https://twitter.com/jean_maes_1994" rel="noopener ugc nofollow" target="_blank">https://twitter.com/jean_maes_1994</a></li><li id="a519" class="no np gt nq b nr qh nt nu nv qi nx ny nz qj ob oc od qk of og oh ql oj ok ol qe qf qg bj" data-selectable-paragraph=""><strong class="nq gu">LinkedIn</strong>: <a class="af qd" href="https://www.linkedin.com/in/jean-francois-maes/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/jean-francois-maes/</a></li></ul><p id="8d2f" class="pw-post-body-paragraph no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol gm bj" data-selectable-paragraph="">You can learn more about Neuvik here:</p><ul class=""><li id="90d9" class="no np gt nq b nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol qe qf qg bj" data-selectable-paragraph=""><strong class="nq gu">Website</strong>: <a class="af qd" href="https://www.neuvik.com/" rel="noopener ugc nofollow" target="_blank">Neuvik | Cybersecurity Expertise</a></li><li id="a1ef" class="no np gt nq b nr qh nt nu nv qi nx ny nz qj ob oc od qk of og oh ql oj ok ol qe qf qg bj" data-selectable-paragraph=""><strong class="nq gu">Twitter</strong>: <a class="af qd" href="https://twitter.com/Neuvik" rel="noopener ugc nofollow" target="_blank">https://twitter.com/Neuvik</a></li><li id="1c78" class="no np gt nq b nr qh nt nu nv qi nx ny nz qj ob oc od qk of og oh ql oj ok ol qe qf qg bj" data-selectable-paragraph=""><strong class="nq gu">LinkedIn</strong>: <a class="af qd" href="https://www.linkedin.com/company/neuvik-solutions/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/company/neuvik-solutions/</a></li></ul></div></div></div></div></section></div></div></article><div class="ab ca"><div class="ch bg fy fz ga gb"></div></div></div><div></div><div class="m ud ue uf"><div class="bw ug uh bg xv" style="bottom: 0px;"><div class="uj t uk v ul um un uo up uq ab q cn fi"><div class="ur us ut uu uv l"><div class="am l fr uw ux"><div class="h k"><div class="l fi n uy"><button class="af ag ah ai aj ak al am an ao ap aq ar as at ab" data-testid="close-button" aria-label="close"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" class="fj dt fl fk"><path d="M5 5l7 7m7 7l-7-7m0 0l7-7m-7 7l-7 7" stroke="currentColor" stroke-linecap="round"></path></svg></button></div></div><div class="j i d"><div class="l fi n uy"><button class="af ag ah ai aj ak al am an ao ap aq ar as at ab fi uz gp va vb vc vd" data-testid="close-button" aria-label="close"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" class="fj dt fl fk"><path d="M5 5l7 7m7 7l-7-7m0 0l7-7m-7 7l-7 7" stroke="currentColor" stroke-linecap="round"></path></svg></button></div></div></div><div class="ab q jc jd vl vm"><img class="fr ue gh vn" src="https://miro.medium.com/v2/da:true/resize:fit:0/5c50caa54067fd622d2f0fac18392213bf92f6e2fae89b691e62bceb40885e74" loading="lazy" role="presentation"><div class="gx vo hc vp dl vq dm vr vs l"><svg viewBox="0 0 3940 610" class="ve vf vg vh vi hh vj hm vk hr"><path d="M594.79 308.2c0 163.76-131.85 296.52-294.5 296.52S5.8 472 5.8 308.2 137.65 11.69 300.29 11.69s294.5 132.75 294.5 296.51M917.86 308.2c0 154.16-65.93 279.12-147.25 279.12s-147.25-125-147.25-279.12S689.29 29.08 770.61 29.08s147.25 125 147.25 279.12M1050 308.2c0 138.12-23.19 250.08-51.79 250.08s-51.79-112-51.79-250.08 23.19-250.08 51.8-250.08S1050 170.09 1050 308.2M1862.77 37.4l.82-.18v-6.35h-167.48l-155.51 365.5-155.51-365.5h-180.48v6.35l.81.18c30.57 6.9 46.09 17.19 46.09 54.3v434.45c0 37.11-15.58 47.4-46.15 54.3l-.81.18V587H1327v-6.35l-.81-.18c-30.57-6.9-46.09-17.19-46.09-54.3V116.9L1479.87 587h11.33l205.59-483.21V536.9c-2.62 29.31-18 38.36-45.68 44.61l-.82.19v6.3h213.3v-6.3l-.82-.19c-27.71-6.25-43.46-15.3-46.08-44.61l-.14-445.2h.14c0-37.11 15.52-47.4 46.08-54.3m97.43 287.8c3.49-78.06 31.52-134.4 78.56-135.37 14.51.24 26.68 5 36.14 14.16 20.1 19.51 29.55 60.28 28.09 121.21zm-2.11 22h250v-1.05c-.71-59.69-18-106.12-51.34-138-28.82-27.55-71.49-42.71-116.31-42.71h-1c-23.26 0-51.79 5.64-72.09 15.86-23.11 10.7-43.49 26.7-60.45 47.7-27.3 33.83-43.84 79.55-47.86 130.93-.13 1.54-.24 3.08-.35 4.62s-.18 2.92-.25 4.39a332.64 332.64 0 0 0-.36 21.69C1860.79 507 1923.65 600 2035.3 600c98 0 155.07-71.64 169.3-167.8l-7.19-2.53c-25 51.68-69.9 83-121 79.18-69.76-5.22-123.2-75.95-118.35-161.63m532.69 157.68c-8.2 19.45-25.31 30.15-48.24 30.15s-43.89-15.74-58.78-44.34c-16-30.7-24.42-74.1-24.42-125.51 0-107 33.28-176.21 84.79-176.21 21.57 0 38.55 10.7 46.65 29.37zm165.84 76.28c-30.57-7.23-46.09-18-46.09-57V5.28L2424.77 60v6.7l1.14-.09c25.62-2.07 43 1.47 53.09 10.79 7.9 7.3 11.75 18.5 11.75 34.26v71.14c-18.31-11.69-40.09-17.38-66.52-17.38-53.6 0-102.59 22.57-137.92 63.56-36.83 42.72-56.3 101.1-56.3 168.81C2230 518.72 2289.53 600 2378.13 600c51.83 0 93.53-28.4 112.62-76.3V588h166.65v-6.66zm159.29-505.33c0-37.76-28.47-66.24-66.24-66.24-37.59 0-67 29.1-67 66.24s29.44 66.24 67 66.24c37.77 0 66.24-28.48 66.24-66.24m43.84 505.33c-30.57-7.23-46.09-18-46.09-57h-.13V166.65l-166.66 47.85v6.5l1 .09c36.06 3.21 45.93 15.63 45.93 57.77V588h166.8v-6.66zm427.05 0c-30.57-7.23-46.09-18-46.09-57V166.65L3082 212.92v6.52l.94.1c29.48 3.1 38 16.23 38 58.56v226c-9.83 19.45-28.27 31-50.61 31.78-36.23 0-56.18-24.47-56.18-68.9V166.66l-166.66 47.85V221l1 .09c36.06 3.2 45.94 15.62 45.94 57.77v191.27a214.48 214.48 0 0 0 3.47 39.82l3 13.05c14.11 50.56 51.08 77 109 77 49.06 0 92.06-30.37 111-77.89v66h166.66v-6.66zM3934.2 588v-6.67l-.81-.19c-33.17-7.65-46.09-22.07-46.09-51.43v-243.2c0-75.83-42.59-121.09-113.93-121.09-52 0-95.85 30.05-112.73 76.86-13.41-49.6-52-76.86-109.06-76.86-50.12 0-89.4 26.45-106.25 71.13v-69.87l-166.66 45.89v6.54l1 .09c35.63 3.16 45.93 15.94 45.93 57V588h155.5v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66V255.72c7-16.35 21.11-35.72 49-35.72 34.64 0 52.2 24 52.2 71.28V588h155.54v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66v-248a160.45 160.45 0 0 0-2.2-27.68c7.42-17.77 22.34-38.8 51.37-38.8 35.13 0 52.2 23.31 52.2 71.28V588z"></path></svg><h2 class="vt b nr vu vv nv vw vx pl vy vz pp wa wb pt wc wd we wf">Sign up to discover human stories that deepen your understanding of the world.</h2></div><div class="ab q jc jd"><div class="wg gd bo gx wh hc wi wj wk wl wm wn wo l c"><div class="ab q"><h2 class="be tl is z gs bj">Free</h2></div><div class="tp wp l cw"></div><div class="tp ab"><div class="bn l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="be b bf z bj">Distraction-free reading. No ads.</p></div><div class="tp ab"><div class="bn l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="be b bf z bj">Organize your knowledge with lists and highlights.</p></div><div class="tp ab"><div class="bn l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="be b bf z bj">Tell your story. Find your audience.</p></div><div class="ck wq wp l cw"></div><span><a class="be b bf z wr rq ws wt wu wv ww eu ev wx wy wz ez bg fa fb fc bl fd fe" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fblog.neuvik.com%2Fjourney-into-windows-kernel-exploitation-the-basics-fff72116ca33&amp;source=---post_footer_upsell--fff72116ca33---------------------lo_non_moc_upsell-----------" rel="noopener follow">Sign up for free</a></span></div><div class="wg gd bo wh wi wk wm wo l c"><div class="ab q"><svg width="64" height="64" viewBox="0 0 64 64" fill="none" class="xa rp dg lz"><path d="M39.64 40.83L33.87 56.7a1.99 1.99 0 0 1-3.74 0l-5.77-15.87a2.02 2.02 0 0 0-1.2-1.2L7.3 33.88a1.99 1.99 0 0 1 0-3.74l15.87-5.77a2.02 2.02 0 0 0 1.2-1.2L30.12 7.3a1.99 1.99 0 0 1 3.74 0l5.77 15.87a2.02 2.02 0 0 0 1.2 1.2l15.86 5.76a1.99 1.99 0 0 1 0 3.74l-15.87 5.77a2.02 2.02 0 0 0-1.2 1.2z" fill="#FFC017"></path></svg><h2 class="be tl is z gs bj">Membership</h2></div><div class="tp wp l cw"></div><div class="tp ab"><div class="bn l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="be b bf z bj">Access the best member-only stories.</p></div><div class="tp ab"><div class="bn l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="be b bf z bj">Support independent authors.</p></div><div class="tp ab"><div class="bn l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="be b bf z bj">Listen to audio narrations.</p></div><div class="tp ab"><div class="bn l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="be b bf z bj">Read offline.</p></div><div class="tp ab"><div class="bn l"><svg width="11" height="11" viewBox="0 0 11 11"><path d="M0 6.31l3.7 3.7.9.91.67-1.1 5.3-8.79L8.84 0l-5.3 8.8 1.57-.2-3.7-3.7L0 6.3z"></path></svg></div><p class="be b bf z bj">Join the Partner Program and earn for your writing.</p></div><div class="ck wq wp l cw"></div><span><a class="be b bf z wr rq ws wt wu wv ww eu ev wx wy wz ez bg fa fb fc bl fd fe" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fplans&amp;source=---post_footer_upsell--fff72116ca33---------------------lo_non_moc_upsell-----------" rel="noopener follow">Try for 5&nbsp;$/month</a></span></div></div></div></div></div></div></div><div class="ab ca"><div class="ch bg fy fz ga gb"><div class="rm rn ab je"><div class="ro ab"><a class="rp ax am ao" href="https://medium.com/tag/kernel-exploit?source=post_page-----fff72116ca33---------------kernel_exploit-----------------" rel="noopener follow"><div class="rq fi cw rr gd rs rt be b bf z bj ru">Kernel Exploit</div></a></div><div class="ro ab"><a class="rp ax am ao" href="https://medium.com/tag/tutorial?source=post_page-----fff72116ca33---------------tutorial-----------------" rel="noopener follow"><div class="rq fi cw rr gd rs rt be b bf z bj ru">Tutorial</div></a></div><div class="ro ab"><a class="rp ax am ao" href="https://medium.com/tag/pentesting?source=post_page-----fff72116ca33---------------pentesting-----------------" rel="noopener follow"><div class="rq fi cw rr gd rs rt be b bf z bj ru">Pentesting</div></a></div></div></div></div><div class="l"></div><footer class="rv rw rx ry rz sa sb sc sd ab q se io c"><div class="l ae"><div class="ab ca"><div class="ch bg fy fz ga gb"><div class="ab co sf"><div class="ab q kz"><div class="sg l"><span class="l sh si sj e d"><div class="ab q kz la"><div class="pw-multi-vote-icon fi ji lb lc ld"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fneuvik%2Ffff72116ca33&amp;operation=register&amp;redirect=https%3A%2F%2Fblog.neuvik.com%2Fjourney-into-windows-kernel-exploitation-the-basics-fff72116ca33&amp;user=Jean&amp;userId=c6ea1883b294&amp;source=-----fff72116ca33---------------------clap_footer-----------" rel="noopener follow"><div><div class="bl" aria-hidden="false" aria-describedby="10" aria-labelledby="10"><div class="le ao lf lg lh li am lj lk ll ld"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lm ln lo lp lq lr ls"><div><div class="bl" aria-hidden="false" aria-describedby="86" aria-labelledby="86"><p class="be b du z dt"><button class="af ag ah ai aj ak al am an ao ap aq ar as at zc ma">14<span class="l h g f sk sl"></span></button></p></div></div></div></div></span><span class="l h g f sk sl"><div class="ab q kz la"><div class="pw-multi-vote-icon fi ji lb lc ld"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fneuvik%2Ffff72116ca33&amp;operation=register&amp;redirect=https%3A%2F%2Fblog.neuvik.com%2Fjourney-into-windows-kernel-exploitation-the-basics-fff72116ca33&amp;user=Jean&amp;userId=c6ea1883b294&amp;source=-----fff72116ca33---------------------clap_footer-----------" rel="noopener follow"><div><div class="bl" aria-hidden="false" aria-describedby="11" aria-labelledby="11"><div class="le ao lf lg lh li am lj lk ll ld"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lm ln lo lp lq lr ls"><div><div class="bl" aria-hidden="false" aria-describedby="88" aria-labelledby="88"><p class="be b du z dt"><button class="af ag ah ai aj ak al am an ao ap aq ar as at zc ma">14</button></p></div></div></div></div></span></div><div class="bp ab"><div><div class="bl" aria-hidden="false" aria-describedby="12" aria-labelledby="12"><button class="ao le lu lv ab q fj lw lx" aria-label="responses"><svg width="24" height="24" viewBox="0 0 24 24" class="ly"><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></button></div></div></div></div><div class="ab q"><div class="oz l jb"><div><div class="bl" aria-hidden="false" aria-describedby="13" aria-labelledby="13"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ffff72116ca33&amp;operation=register&amp;redirect=https%3A%2F%2Fblog.neuvik.com%2Fjourney-into-windows-kernel-exploitation-the-basics-fff72116ca33&amp;source=--------------------------bookmark_footer-----------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div><div class="oz l jb"><div class="bl" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bl" aria-hidden="false" aria-describedby="14" aria-labelledby="14"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fj ah ai aj ak al mi an ao ap ew mj mk lx ml"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.22 4.93a.42.42 0 0 1-.12.13h.01a.45.45 0 0 1-.29.08.52.52 0 0 1-.3-.13L12.5 3v7.07a.5.5 0 0 1-.5.5.5.5 0 0 1-.5-.5V3.02l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.8a.42.42 0 0 1 .07.5zm-.1.14zm.88 2h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11a2 2 0 0 1-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.14c.1.1.15.22.15.35a.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9V8.96c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1z" fill="currentColor"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="sm sn so sp sq l bw"><div class="ab ca"><div class="ch bg fy fz ga gb"><div class="ck ab sr co"><div class="ab ie"><a href="https://medium.com/@jean_82568?source=post_page-----fff72116ca33--------------------------------" rel="noopener follow"><div class="l ss st bx su ii"><div class="l fi"><img alt="Jean" class="l fc bx sv sw cw" src="https://miro.medium.com/v2/resize:fill:144:144/1*odcvWd6mq9Gr0n_DDF2u_g.jpeg" width="72" height="72" loading="lazy"><div class="ij bx l sv sw fr n ik fs"></div></div></div></a><a href="https://blog.neuvik.com/?source=post_page-----fff72116ca33--------------------------------" rel="noopener follow"><div class="sx ab fi"><div><div class="bl" aria-hidden="false" aria-describedby="15" aria-labelledby="15"><div class="l sy sz bx su io"><div class="l fi"><img alt="Neuvik" class="l fc bx by bz cw" src="https://miro.medium.com/v2/resize:fill:64:64/1*-8PVjte6Kwo7RNpng83hTg.png" width="32" height="32" loading="lazy"><div class="ij bx l by bz fr n ik fs"></div></div></div></div></div></div></a></div><div class="j i d"><div class="ab"><span><a class="be b bf z eo rq ep eq er es et eu ev ew ex ey ez ta fa fb fc bl fd fe" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc6ea1883b294&amp;operation=register&amp;redirect=https%3A%2F%2Fblog.neuvik.com%2Fjourney-into-windows-kernel-exploitation-the-basics-fff72116ca33&amp;user=Jean&amp;userId=c6ea1883b294&amp;source=post_page-c6ea1883b294----fff72116ca33---------------------follow_profile-----------" rel="noopener follow">Follow</a></span><div class="ds l"><div><div><div class="bl" aria-hidden="false" aria-describedby="115" aria-labelledby="115"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fc6ea1883b294%2Flazily-enable-writer-subscription&amp;operation=register&amp;redirect=https%3A%2F%2Fblog.neuvik.com%2Fjourney-into-windows-kernel-exploitation-the-basics-fff72116ca33&amp;user=Jean&amp;userId=c6ea1883b294&amp;source=-----fff72116ca33---------------------subscribe_user-----------" rel="noopener follow"><button class="be b bf z eo am ep eq er es et eu ev ew ex ey ez fa fb fc bl fd fe" aria-label="Subscribe"><svg width="38" height="38" viewBox="0 0 38 38" fill="none" class="zb sz sy"><rect x="26.25" y="9.25" width="0.5" height="6.5" rx="0.25"></rect><rect x="29.75" y="12.25" width="0.5" height="6.5" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5L19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="ab cm co"><div class="l"><div class="ab q"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab q" href="https://medium.com/@jean_82568?source=post_page-----fff72116ca33--------------------------------" rel="noopener follow"><h2 class="pw-author-name be tl tm tn to bj"><span class="gm js">Written by <!-- -->Jean</span></h2></a></div><div class="ro ab"><div class="l jb"><span class="pw-follower-count be b bf z bj"><a class="af ag ah ai aj ak al am an ao ap aq ar iu" href="https://medium.com/@jean_82568/followers?source=post_page-----fff72116ca33--------------------------------" rel="noopener follow">36 Followers</a></span></div><div class="be b bf z jj jk jl ab jn jo jp jq dt jh"><span class="iv l" aria-hidden="true"><span class="be b bf z dt">·</span></span><span class="l jb">Writer for </span><div><div class="l" aria-hidden="false" aria-describedby="17" aria-labelledby="17"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://blog.neuvik.com/?source=post_page-----fff72116ca33--------------------------------" rel="noopener follow"><p class="be b bf z jj jk jl jm jn jo jp jq bj">Neuvik</p></a></div></div></div></div><div class="tp l"><p class="be b bf z bj"><span class="gm">Red Teamer / Course Author / Instructor</span></p></div></div><div class="h k"><div class="ab"><span><a class="be b bf z eo rq ep eq er es et eu ev ew ex ey ez ta fa fb fc bl fd fe" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc6ea1883b294&amp;operation=register&amp;redirect=https%3A%2F%2Fblog.neuvik.com%2Fjourney-into-windows-kernel-exploitation-the-basics-fff72116ca33&amp;user=Jean&amp;userId=c6ea1883b294&amp;source=post_page-c6ea1883b294----fff72116ca33---------------------follow_profile-----------" rel="noopener follow">Follow</a></span><div class="ds l"><div><div><div class="bl" aria-hidden="false" aria-describedby="117" aria-labelledby="117"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2Fc6ea1883b294%2Flazily-enable-writer-subscription&amp;operation=register&amp;redirect=https%3A%2F%2Fblog.neuvik.com%2Fjourney-into-windows-kernel-exploitation-the-basics-fff72116ca33&amp;user=Jean&amp;userId=c6ea1883b294&amp;source=-----fff72116ca33---------------------subscribe_user-----------" rel="noopener follow"><button class="be b bf z eo am ep eq er es et eu ev ew ex ey ez fa fb fc bl fd fe" aria-label="Subscribe"><svg width="38" height="38" viewBox="0 0 38 38" fill="none" class="zb sz sy"><rect x="26.25" y="9.25" width="0.5" height="6.5" rx="0.25"></rect><rect x="29.75" y="12.25" width="0.5" height="6.5" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5L19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="tq bg tr nd ne nf ng nh"></div></div></div><div class="ab ca"><div class="ch bg fy fz ga gb"><div class="zd ze l"><h2 class="be tl is z gs bj">More from Jean and Neuvik</h2></div><div class="zf ab kz je zg zh zi zj zk zl zm zn zo zp zq zr zs zt zu"><div class="zv zw zx zy zz aba abb abc abd abe abf abg yu abh abi abj yv abk abl abm abn"><div class="abo abp abq abr abs dv l"><article class="dv"><div class="dv sd l"><div class="bg dv"><div class="dv l"><div class="fi dv abt abu abv abw abx aby abz aca acb acc acd ace acf" role="link" data-href="https://blog.neuvik.com/technical-case-study-the-tale-of-privilege-escalation-vs-the-unstartable-service-3cc01bd232c9" tabindex="0"><div class="acg"><div aria-label="Published Citrix Applications"><div class="aci acj ack acl acm"><img alt="Published Citrix Applications" class="bg acn aco acp acq bw" src="https://miro.medium.com/v2/resize:fit:849/1*u-VGzRzJug2lgVzZ7AgUyw.png" loading="lazy"></div></div></div><div class="ach ab ca cn"><div class="ab cn acr bg acs act acu acv"><div class="vf vh acw acx acy ab q"><div class="rp l"><div><div class="l" aria-hidden="false" aria-describedby="118" aria-labelledby="118"><a tabindex="-1" href="https://medium.com/@dmay3r?source=author_recirc-----fff72116ca33----0---------------------553cd05f_0635_41b8_82dd_d6ab67569890-------" rel="noopener follow"><div class="l fi"><img alt="Dave Mayer" class="l fc bx acz ada cw" src="https://miro.medium.com/v2/resize:fill:25:25/1*MWsbi3oVYBzJyenz6GzXUw.png" width="20" height="20" loading="lazy"><div class="fq bx l acz ada fr n ax fs"></div></div></a></div></div></div><div class="adb l"><div><div class="l" aria-hidden="false" aria-describedby="119" aria-labelledby="119"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://medium.com/@dmay3r?source=author_recirc-----fff72116ca33----0---------------------553cd05f_0635_41b8_82dd_d6ab67569890-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Dave Mayer</p></a></div></div></div><div class="adb l"><p class="be b du z dt">in</p></div><div class="l"><div><div class="l" aria-hidden="false" aria-describedby="120" aria-labelledby="120"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://blog.neuvik.com/?source=author_recirc-----fff72116ca33----0---------------------553cd05f_0635_41b8_82dd_d6ab67569890-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Neuvik</p></a></div></div></div></div><div class="adc add ade adf adg adh adi adj adk adl l gm"><div class="adm adn ado adp adq adr ads adt"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/technical-case-study-the-tale-of-privilege-escalation-vs-the-unstartable-service-3cc01bd232c9?source=author_recirc-----fff72116ca33----0---------------------553cd05f_0635_41b8_82dd_d6ab67569890-------"><div title="Technical Case Study: The Tale of Privilege Escalation vs the Unstartable Service"><h2 class="be gu pd pf adu adv pg ph pj adw adx pk nz ady adz aea aeb od aec aed aee aef oh aeg aeh aei aej jj jl jm jo jq bj">Technical Case Study: The Tale of Privilege Escalation vs the Unstartable Service</h2></div><div class="aek l"><h3 class="be b is z jj ael jl jm aem jo jq dt">In this technical case study, Neuvik’s Director of Advanced Assessments in Europe, Jean Maes, and MD of Advanced Assessments, Dave Mayer…</h3></div></a></div></div><span class="be b du z dt"><div class="ab q"><span>7 min read</span><span class="iv l" aria-hidden="true"><span class="be b bf z dt">·</span></span><span>Apr 18, 2024</span></div></span><div class="aen aeo aep aeq aer l"><div class="ab co"><div class="am aes aet aeu aev aew aex aey aez afa afb ab q"><div class="ab q kz la"><div class="pw-multi-vote-icon fi ji lb lc ld"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fneuvik%2F3cc01bd232c9&amp;operation=register&amp;redirect=https%3A%2F%2Fblog.neuvik.com%2Ftechnical-case-study-the-tale-of-privilege-escalation-vs-the-unstartable-service-3cc01bd232c9&amp;user=Dave+Mayer&amp;userId=f78b92a4329e&amp;source=-----3cc01bd232c9----0-----------------clap_footer----553cd05f_0635_41b8_82dd_d6ab67569890-------" rel="noopener follow"><div><div class="bl" aria-hidden="false" aria-describedby="121" aria-labelledby="121"><div class="le ao lf lg lh li am lj lk ll ld"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lm ln lo lp lq lr ls"><div><div class="bl" aria-hidden="false" aria-describedby="210" aria-labelledby="210"><p class="be b du z dt"><button class="af ag ah ai aj ak al am an ao ap aq ar as at zc ma">3<span class="l h g f sk sl"></span></button></p></div></div></div></div><div class="afc l"><div><div class="bl" aria-hidden="false" aria-describedby="122" aria-labelledby="122"><a class="af fj ah le aj ak al lv an ao ap aq ar as at lu ab q lw lx" aria-label="responses" rel="noopener follow" href="/technical-case-study-the-tale-of-privilege-escalation-vs-the-unstartable-service-3cc01bd232c9?responsesOpen=true&amp;sortBy=REVERSE_CHRON&amp;source=author_recirc-----fff72116ca33----0---------------------553cd05f_0635_41b8_82dd_d6ab67569890-------"><svg width="24" height="24" viewBox="0 0 24 24" class=""><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></a></div></div></div></div><div class="ab q afd afe"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="123" aria-labelledby="123"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3cc01bd232c9&amp;operation=register&amp;redirect=https%3A%2F%2Fblog.neuvik.com%2Ftechnical-case-study-the-tale-of-privilege-escalation-vs-the-unstartable-service-3cc01bd232c9&amp;source=-----fff72116ca33----0-----------------bookmark_preview----553cd05f_0635_41b8_82dd_d6ab67569890-------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></div><div class="j i d"><div class="tq bg tr os"></div></div></div></div></div></div></div></div></article></div></div><div class="zv zw zx zy zz aba abb abc abd abe abf abg yu abh abi abj yv abk abl abm abn"><div class="abo abp abq abr abs dv l"><article class="dv"><div class="dv sd l"><div class="bg dv"><div class="dv l"><div class="fi dv abt abu abv abw abx aby abz aca acb acc acd ace acf" role="link" data-href="https://blog.neuvik.com/cyber-risk-fraud-and-the-impact-of-emerging-technologies-2024f88bc811" tabindex="0"><div class="acg"><div aria-label="“Cyber Risk, Fraud, and the Impact of Emerging Technologies” by Ryan Leirvik &amp; Tillery. (Photos of both authors shown to the left beside the Neuvik logo.)"><div class="aci acj ack acl acm"><img alt="“Cyber Risk, Fraud, and the Impact of Emerging Technologies” by Ryan Leirvik &amp; Tillery. (Photos of both authors shown to the left beside the Neuvik logo.)" class="bg acn aco acp acq bw" src="https://miro.medium.com/v2/resize:fit:849/1*Cd1CL1zGp-Ok89gGmRnAYw.png" loading="lazy"></div></div></div><div class="ach ab ca cn"><div class="ab cn acr bg acs act acu acv"><div class="vf vh acw acx acy ab q"><div class="rp l"><div><div class="l" aria-hidden="false" aria-describedby="124" aria-labelledby="124"><a tabindex="-1" href="https://medium.com/@neuvik_solutions?source=author_recirc-----fff72116ca33----1---------------------553cd05f_0635_41b8_82dd_d6ab67569890-------" rel="noopener follow"><div class="l fi"><img alt="Neuvik Solutions" class="l fc bx acz ada cw" src="https://miro.medium.com/v2/resize:fill:25:25/1*6vD2snnhevDB4lAZ1STPbw.png" width="20" height="20" loading="lazy"><div class="fq bx l acz ada fr n ax fs"></div></div></a></div></div></div><div class="adb l"><div><div class="l" aria-hidden="false" aria-describedby="125" aria-labelledby="125"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://medium.com/@neuvik_solutions?source=author_recirc-----fff72116ca33----1---------------------553cd05f_0635_41b8_82dd_d6ab67569890-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Neuvik Solutions</p></a></div></div></div><div class="adb l"><p class="be b du z dt">in</p></div><div class="l"><div><div class="l" aria-hidden="false" aria-describedby="126" aria-labelledby="126"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://blog.neuvik.com/?source=author_recirc-----fff72116ca33----1---------------------553cd05f_0635_41b8_82dd_d6ab67569890-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Neuvik</p></a></div></div></div></div><div class="adc add ade adf adg adh adi adj adk adl l gm"><div class="adm adn ado adp adq adr ads adt"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/cyber-risk-fraud-and-the-impact-of-emerging-technologies-2024f88bc811?source=author_recirc-----fff72116ca33----1---------------------553cd05f_0635_41b8_82dd_d6ab67569890-------"><div title=""><h2 class="be gu pd pf adu adv pg ph pj adw adx pk nz ady adz aea aeb od aec aed aee aef oh aeg aeh aei aej jj jl jm jo jq bj">Cyber Risk, Fraud, and the Impact of Emerging Technologies</h2></div><div class="aek l"><h3 class="be b is z jj ael jl jm aem jo jq dt">New Technology as a Source of Fraud and Risk</h3></div></a></div></div><span class="be b du z dt"><div class="ab q"><span>10 min read</span><span class="iv l" aria-hidden="true"><span class="be b bf z dt">·</span></span>2 days ago</div></span><div class="aen aeo aep aeq aer l"><div class="ab co"><div class="am aes aet aeu aev aew aex aey aez afa afb ab q"><div class="ab q kz la"><div class="pw-multi-vote-icon fi ji lb lc ld"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fneuvik%2F2024f88bc811&amp;operation=register&amp;redirect=https%3A%2F%2Fblog.neuvik.com%2Fcyber-risk-fraud-and-the-impact-of-emerging-technologies-2024f88bc811&amp;user=Neuvik+Solutions&amp;userId=8ba3f726ea81&amp;source=-----2024f88bc811----1-----------------clap_footer----553cd05f_0635_41b8_82dd_d6ab67569890-------" rel="noopener follow"><div><div class="bl" aria-hidden="false" aria-describedby="127" aria-labelledby="127"><div class="le ao lf lg lh li am lj lk ll ld"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lm ln lo lp lq lr ls"><div><div class="bl" aria-hidden="false" aria-describedby="212" aria-labelledby="212"><p class="be b du z dt"><button class="af ag ah ai aj ak al am an ao ap aq ar as at zc ma">1<span class="l h g f sk sl"></span></button></p></div></div></div></div><div class="afc l"><div><div class="bl" aria-hidden="false" aria-describedby="128" aria-labelledby="128"><a class="af fj ah le aj ak al lv an ao ap aq ar as at lu ab q lw lx" aria-label="responses" rel="noopener follow" href="/cyber-risk-fraud-and-the-impact-of-emerging-technologies-2024f88bc811?responsesOpen=true&amp;sortBy=REVERSE_CHRON&amp;source=author_recirc-----fff72116ca33----1---------------------553cd05f_0635_41b8_82dd_d6ab67569890-------"><svg width="24" height="24" viewBox="0 0 24 24" class=""><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></a></div></div></div></div><div class="ab q afd afe"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="129" aria-labelledby="129"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F2024f88bc811&amp;operation=register&amp;redirect=https%3A%2F%2Fblog.neuvik.com%2Fcyber-risk-fraud-and-the-impact-of-emerging-technologies-2024f88bc811&amp;source=-----fff72116ca33----1-----------------bookmark_preview----553cd05f_0635_41b8_82dd_d6ab67569890-------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></div><div class="j i d"><div class="tq bg tr os"></div></div></div></div></div></div></div></div></article></div></div><div class="zv zw zx zy zz aba abb abc abd abe abf abg yu abh abi abj yv abk abl abm abn"><div class="abo abp abq abr abs dv l"><article class="dv"><div class="dv sd l"><div class="bg dv"><div class="dv l"><div class="fi dv abt abu abv abw abx aby abz aca acb acc acd ace acf" role="link" data-href="https://blog.neuvik.com/how-to-evaluate-audit-excessive-permissions-in-aws-96d7708ddb5" tabindex="0"><div class="acg"><div aria-label="“How to Evaluate &amp; Audit Excessive Permissions in AWS” is the title. Beneath it is the name of the author, “Moses Frost,” next to the Neuvik logo. A photo of the author is set to the left."><div class="aci acj ack acl acm"><img alt="“How to Evaluate &amp; Audit Excessive Permissions in AWS” is the title. Beneath it is the name of the author, “Moses Frost,” next to the Neuvik logo. A photo of the author is set to the left." class="bg acn aco acp acq bw" src="https://miro.medium.com/v2/resize:fit:849/1*pKzaZr0lo-NcX-C8UnP32Q.png" loading="lazy"></div></div></div><div class="ach ab ca cn"><div class="ab cn acr bg acs act acu acv"><div class="vf vh acw acx acy ab q"><div class="rp l"><div><div class="l" aria-hidden="false" aria-describedby="130" aria-labelledby="130"><a tabindex="-1" href="https://medium.com/@neuvik_solutions?source=author_recirc-----fff72116ca33----2---------------------553cd05f_0635_41b8_82dd_d6ab67569890-------" rel="noopener follow"><div class="l fi"><img alt="Neuvik Solutions" class="l fc bx acz ada cw" src="https://miro.medium.com/v2/resize:fill:25:25/1*6vD2snnhevDB4lAZ1STPbw.png" width="20" height="20" loading="lazy"><div class="fq bx l acz ada fr n ax fs"></div></div></a></div></div></div><div class="adb l"><div><div class="l" aria-hidden="false" aria-describedby="131" aria-labelledby="131"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://medium.com/@neuvik_solutions?source=author_recirc-----fff72116ca33----2---------------------553cd05f_0635_41b8_82dd_d6ab67569890-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Neuvik Solutions</p></a></div></div></div><div class="adb l"><p class="be b du z dt">in</p></div><div class="l"><div><div class="l" aria-hidden="false" aria-describedby="132" aria-labelledby="132"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://blog.neuvik.com/?source=author_recirc-----fff72116ca33----2---------------------553cd05f_0635_41b8_82dd_d6ab67569890-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Neuvik</p></a></div></div></div></div><div class="adc add ade adf adg adh adi adj adk adl l gm"><div class="adm adn ado adp adq adr ads adt"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/how-to-evaluate-audit-excessive-permissions-in-aws-96d7708ddb5?source=author_recirc-----fff72116ca33----2---------------------553cd05f_0635_41b8_82dd_d6ab67569890-------"><div title=""><h2 class="be gu pd pf adu adv pg ph pj adw adx pk nz ady adz aea aeb od aec aed aee aef oh aeg aeh aei aej jj jl jm jo jq bj">How to Evaluate &amp; Audit Excessive Permissions in AWS</h2></div><div class="aek l"><h3 class="be b is z jj ael jl jm aem jo jq dt">Enabling excessive permissions in Cloud infrastructure can easily lead to unauthorized access, but regularly auditing AWS permissions can…</h3></div></a></div></div><span class="be b du z dt"><div class="ab q"><span>6 min read</span><span class="iv l" aria-hidden="true"><span class="be b bf z dt">·</span></span><span>Feb 9, 2023</span></div></span><div class="aen aeo aep aeq aer l"><div class="ab co"><div class="am aes aet aeu aev aew aex aey aez afa afb ab q"><div class="ab q kz la"><div class="pw-multi-vote-icon fi ji lb lc ld"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fneuvik%2F96d7708ddb5&amp;operation=register&amp;redirect=https%3A%2F%2Fblog.neuvik.com%2Fhow-to-evaluate-audit-excessive-permissions-in-aws-96d7708ddb5&amp;user=Neuvik+Solutions&amp;userId=8ba3f726ea81&amp;source=-----96d7708ddb5----2-----------------clap_footer----553cd05f_0635_41b8_82dd_d6ab67569890-------" rel="noopener follow"><div><div class="bl" aria-hidden="false" aria-describedby="133" aria-labelledby="133"><div class="le ao lf lg lh li am lj lk ll ld"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lm ln lo lp lq lr ls"><div><div class="bl" aria-hidden="false" aria-describedby="214" aria-labelledby="214"><p class="be b du z dt"><button class="af ag ah ai aj ak al am an ao ap aq ar as at zc ma">12<span class="l h g f sk sl"></span></button></p></div></div></div></div><div class="afc l"><div><div class="bl" aria-hidden="false" aria-describedby="134" aria-labelledby="134"><a class="af fj ah le aj ak al lv an ao ap aq ar as at lu ab q lw lx" aria-label="responses" rel="noopener follow" href="/how-to-evaluate-audit-excessive-permissions-in-aws-96d7708ddb5?responsesOpen=true&amp;sortBy=REVERSE_CHRON&amp;source=author_recirc-----fff72116ca33----2---------------------553cd05f_0635_41b8_82dd_d6ab67569890-------"><svg width="24" height="24" viewBox="0 0 24 24" class=""><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></a></div></div></div></div><div class="ab q afd afe"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="135" aria-labelledby="135"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F96d7708ddb5&amp;operation=register&amp;redirect=https%3A%2F%2Fblog.neuvik.com%2Fhow-to-evaluate-audit-excessive-permissions-in-aws-96d7708ddb5&amp;source=-----fff72116ca33----2-----------------bookmark_preview----553cd05f_0635_41b8_82dd_d6ab67569890-------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></div><div class="j i d"><div class="tq bg tr os"></div></div></div></div></div></div></div></div></article></div></div><div class="zv zw zx zy zz aba abb abc abd abe abf abg yu abh abi abj yv abk abl abm abn"><div class="abo abp abq abr abs dv l"><article class="dv"><div class="dv sd l"><div class="bg dv"><div class="dv l"><div class="fi dv abt abu abv abw abx aby abz aca acb acc acd ace acf" role="link" data-href="https://blog.neuvik.com/a-retrospective-vulnerability-case-study-the-qa-testers-pov-5a3ec6b2e439" tabindex="0"><div class="acg"><div aria-label="“A Retrospective Vulnerability Case Study: The QA Tester’s POV” is the title, set above the Neuvik logo to indicate company blog authorship. To the left is a picture of a screen with a large blue and white checkmark symbolizing quality assurance."><div class="aci acj ack acl acm"><img alt="“A Retrospective Vulnerability Case Study: The QA Tester’s POV” is the title, set above the Neuvik logo to indicate company blog authorship. To the left is a picture of a screen with a large blue and white checkmark symbolizing quality assurance." class="bg acn aco acp acq bw" src="https://miro.medium.com/v2/resize:fit:849/1*kp-V6MgswtYeM2oZbk-7vw.png" loading="lazy"></div></div></div><div class="ach ab ca cn"><div class="ab cn acr bg acs act acu acv"><div class="vf vh acw acx acy ab q"><div class="rp l"><div><div class="l" aria-hidden="false" aria-describedby="136" aria-labelledby="136"><a tabindex="-1" href="https://medium.com/@neuvik_solutions?source=author_recirc-----fff72116ca33----3---------------------553cd05f_0635_41b8_82dd_d6ab67569890-------" rel="noopener follow"><div class="l fi"><img alt="Neuvik Solutions" class="l fc bx acz ada cw" src="https://miro.medium.com/v2/resize:fill:25:25/1*6vD2snnhevDB4lAZ1STPbw.png" width="20" height="20" loading="lazy"><div class="fq bx l acz ada fr n ax fs"></div></div></a></div></div></div><div class="adb l"><div><div class="l" aria-hidden="false" aria-describedby="137" aria-labelledby="137"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://medium.com/@neuvik_solutions?source=author_recirc-----fff72116ca33----3---------------------553cd05f_0635_41b8_82dd_d6ab67569890-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Neuvik Solutions</p></a></div></div></div><div class="adb l"><p class="be b du z dt">in</p></div><div class="l"><div><div class="l" aria-hidden="false" aria-describedby="138" aria-labelledby="138"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://blog.neuvik.com/?source=author_recirc-----fff72116ca33----3---------------------553cd05f_0635_41b8_82dd_d6ab67569890-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Neuvik</p></a></div></div></div></div><div class="adc add ade adf adg adh adi adj adk adl l gm"><div class="adm adn ado adp adq adr ads adt"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/a-retrospective-vulnerability-case-study-the-qa-testers-pov-5a3ec6b2e439?source=author_recirc-----fff72116ca33----3---------------------553cd05f_0635_41b8_82dd_d6ab67569890-------"><div title=""><h2 class="be gu pd pf adu adv pg ph pj adw adx pk nz ady adz aea aeb od aec aed aee aef oh aeg aeh aei aej jj jl jm jo jq bj">A Retrospective Vulnerability Case Study: The QA Tester’s POV</h2></div><div class="aek l"><h3 class="be b is z jj ael jl jm aem jo jq dt">In our March 2nd blog, we discuss what can be learned from a red teamer when finding a vulnerability in an operational system. Red teamers…</h3></div></a></div></div><span class="be b du z dt"><div class="ab q"><span>8 min read</span><span class="iv l" aria-hidden="true"><span class="be b bf z dt">·</span></span><span>Mar 16, 2023</span></div></span><div class="aen aeo aep aeq aer l"><div class="ab co"><div class="am aes aet aeu aev aew aex aey aez afa afb ab q"><div class="ab q kz la"><div class="pw-multi-vote-icon fi ji lb lc ld"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fneuvik%2F5a3ec6b2e439&amp;operation=register&amp;redirect=https%3A%2F%2Fblog.neuvik.com%2Fa-retrospective-vulnerability-case-study-the-qa-testers-pov-5a3ec6b2e439&amp;user=Neuvik+Solutions&amp;userId=8ba3f726ea81&amp;source=-----5a3ec6b2e439----3-----------------clap_footer----553cd05f_0635_41b8_82dd_d6ab67569890-------" rel="noopener follow"><div><div class="bl" aria-hidden="false" aria-describedby="139" aria-labelledby="139"><div class="le ao lf lg lh li am lj lk ll ld"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lm ln lo lp lq lr ls"><div><div class="bl" aria-hidden="false" aria-describedby="216" aria-labelledby="216"><p class="be b du z dt"><button class="af ag ah ai aj ak al am an ao ap aq ar as at zc ma">2<span class="l h g f sk sl"></span></button></p></div></div></div></div><div class="afc l"><div><div class="bl" aria-hidden="false" aria-describedby="140" aria-labelledby="140"><a class="af fj ah le aj ak al lv an ao ap aq ar as at lu ab q lw lx" aria-label="responses" rel="noopener follow" href="/a-retrospective-vulnerability-case-study-the-qa-testers-pov-5a3ec6b2e439?responsesOpen=true&amp;sortBy=REVERSE_CHRON&amp;source=author_recirc-----fff72116ca33----3---------------------553cd05f_0635_41b8_82dd_d6ab67569890-------"><svg width="24" height="24" viewBox="0 0 24 24" class=""><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg><p class="be b du z dt"><span class="pw-responses-count aff ly">2</span></p></a></div></div></div></div><div class="ab q afd afe"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="141" aria-labelledby="141"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5a3ec6b2e439&amp;operation=register&amp;redirect=https%3A%2F%2Fblog.neuvik.com%2Fa-retrospective-vulnerability-case-study-the-qa-testers-pov-5a3ec6b2e439&amp;source=-----fff72116ca33----3-----------------bookmark_preview----553cd05f_0635_41b8_82dd_d6ab67569890-------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></div></div></div></div></div></div></div></article></div></div></div><div class="tq bg tr dj dk afg afh afi"></div><div class="ab jc jd afj afk afl"><a class="be b bf z bj rq afm afn afo ma lw ww eu ev ew afp afq afr ez wh wi afs aft afu fa fb fc bl fd fe" href="https://medium.com/@jean_82568?source=post_page-----fff72116ca33--------------------------------" rel="noopener follow"><div class="l fe">See all from Jean</div></a><div class="afv afw afx afy afz aga agb agc agd ls l"><a class="be b bf z bj rq afm afn afo ma lw ww eu ev ew afp afq afr ez wh wi afs aft afu fa fb fc bl fd fe" href="https://blog.neuvik.com/?source=post_page-----fff72116ca33--------------------------------" rel="noopener follow"><div class="l fe">See all from Neuvik</div></a></div></div></div></div><div class="tq bg tr age agf agg agh agi"></div><div class="ab ca"><div class="ch bg fy fz ga gb"><div class="agj agk l"><h2 class="be tl pd pf pg ph pj pk pl pn po pp pr ps pt pv pw bj">Recommended from Medium</h2><div class="on oo op oq or l"><div class="zf ab kz je zg zh zi zj zk zl zm zn zo zp zq zr zs zt zu"><div class="zv zw zx zy zz aba abb abc abd abe abf abg yu abh abi abj yv abk abl abm abn"><div class="abo abp abq abr abs dv l"><article class="dv"><div class="dv sd l"><div class="bg dv"><div class="dv l"><div class="fi dv abt abu abv abw abx aby abz aca acb acc acd ace acf" role="link" data-href="https://levelup.gitconnected.com/the-resume-that-got-a-software-engineer-a-300-000-job-at-google-8c5a1ecff40f" tabindex="0"><div class="acg"><div aria-label="The resume that got a software engineer a $300,000 job at Google."><div class="aci acj ack acl acm"><img alt="The resume that got a software engineer a $300,000 job at Google." class="bg acn aco acp acq bw" src="https://miro.medium.com/v2/resize:fit:849/1*-tpw_l_dLxBYJJ0JhHnf8A.png" loading="lazy"></div></div></div><div class="ach ab ca cn"><div class="ab cn acr bg acs act acu acv"><div class="vf vh acw acx acy ab q"><div class="rp l"><div><div class="l" aria-hidden="false" aria-describedby="142" aria-labelledby="142"><a tabindex="-1" href="https://alexcancode.medium.com/?source=read_next_recirc-----fff72116ca33----0---------------------6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><div class="l fi"><img alt="Alexander Nguyen" class="l fc bx acz ada cw" src="https://miro.medium.com/v2/resize:fill:25:25/1*cwYWYCjbeXNc_pAtTeq_Zg.jpeg" width="20" height="20" loading="lazy"><div class="fq bx l acz ada fr n ax fs"></div></div></a></div></div></div><div class="adb l"><div><div class="l" aria-hidden="false" aria-describedby="143" aria-labelledby="143"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://alexcancode.medium.com/?source=read_next_recirc-----fff72116ca33----0---------------------6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Alexander Nguyen</p></a></div></div></div><div class="adb l"><p class="be b du z dt">in</p></div><div class="l"><div><div class="l" aria-hidden="false" aria-describedby="144" aria-labelledby="144"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://levelup.gitconnected.com/?source=read_next_recirc-----fff72116ca33----0---------------------6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Level Up Coding</p></a></div></div></div></div><div class="adc add ade adf adg adh adi adj adk adl l gm"><div class="adm adn ado adp adq adr ads adt"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://levelup.gitconnected.com/the-resume-that-got-a-software-engineer-a-300-000-job-at-google-8c5a1ecff40f?source=read_next_recirc-----fff72116ca33----0---------------------6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><div title=""><h2 class="be gu pd pf adu adv pg ph pj adw adx pk nz ady adz aea aeb od aec aed aee aef oh aeg aeh aei aej jj jl jm jo jq bj">The resume that got a software engineer a $300,000 job at Google.</h2></div><div class="aek l"><h3 class="be b is z jj ael jl jm aem jo jq dt">1-page. Well-formatted.</h3></div></a></div></div><span class="be b du z dt"><div class="ab q"><div class="sd ab"><div class="bl" aria-hidden="false" aria-describedby="145" aria-labelledby="145"><button class="l ax ao am" aria-label="Member-only story"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="146" aria-labelledby="146"><svg width="16" height="16" viewBox="0 0 64 64" fill="none"><path d="M39.64 40.83L33.87 56.7a1.99 1.99 0 0 1-3.74 0l-5.77-15.87a2.02 2.02 0 0 0-1.2-1.2L7.3 33.88a1.99 1.99 0 0 1 0-3.74l15.87-5.77a2.02 2.02 0 0 0 1.2-1.2L30.12 7.3a1.99 1.99 0 0 1 3.74 0l5.77 15.87a2.02 2.02 0 0 0 1.2 1.2l15.86 5.76a1.99 1.99 0 0 1 0 3.74l-15.87 5.77a2.02 2.02 0 0 0-1.2 1.2z" fill="#FFC017"></path></svg></div></div></div></button></div></div><span class="iv l" aria-hidden="true"><span class="be b bf z dt">·</span></span><span>4 min read</span><span class="iv l" aria-hidden="true"><span class="be b bf z dt">·</span></span><span>Jun 1, 2024</span></div></span><div class="aen aeo aep aeq aer l"><div class="ab co"><div class="am aes aet aeu aev aew aex aey aez afa afb ab q"><div class="ab q kz la"><div class="pw-multi-vote-icon fi ji lb lc ld"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fgitconnected%2F8c5a1ecff40f&amp;operation=register&amp;redirect=https%3A%2F%2Flevelup.gitconnected.com%2Fthe-resume-that-got-a-software-engineer-a-300-000-job-at-google-8c5a1ecff40f&amp;user=Alexander+Nguyen&amp;userId=a148fd75c2e9&amp;source=-----8c5a1ecff40f----0-----------------clap_footer----6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><div><div class="bl" aria-hidden="false" aria-describedby="147" aria-labelledby="147"><div class="le ao lf lg lh li am lj lk ll ld"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lm ln lo lp lq lr ls"><div><div class="bl" aria-hidden="false" aria-describedby="218" aria-labelledby="218"><p class="be b du z dt"><button class="af ag ah ai aj ak al am an ao ap aq ar as at zc ma">4.4K<span class="l h g f sk sl"></span></button></p></div></div></div></div><div class="afc l"><div><div class="bl" aria-hidden="false" aria-describedby="148" aria-labelledby="148"><a class="af fj ah le aj ak al lv an ao ap aq ar as at lu ab q lw lx" aria-label="responses" href="https://levelup.gitconnected.com/the-resume-that-got-a-software-engineer-a-300-000-job-at-google-8c5a1ecff40f?responsesOpen=true&amp;sortBy=REVERSE_CHRON&amp;source=read_next_recirc-----fff72116ca33----0---------------------6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><svg width="24" height="24" viewBox="0 0 24 24" class=""><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg><p class="be b du z dt"><span class="pw-responses-count aff ly">53</span></p></a></div></div></div></div><div class="ab q afd afe"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="149" aria-labelledby="149"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8c5a1ecff40f&amp;operation=register&amp;redirect=https%3A%2F%2Flevelup.gitconnected.com%2Fthe-resume-that-got-a-software-engineer-a-300-000-job-at-google-8c5a1ecff40f&amp;source=-----fff72116ca33----0-----------------bookmark_preview----6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></div><div class="j i d"><div class="tq bg tr os"></div></div></div></div></div></div></div></div></article></div></div><div class="zv zw zx zy zz aba abb abc abd abe abf abg yu abh abi abj yv abk abl abm abn"><div class="abo abp abq abr abs dv l"><article class="dv"><div class="dv sd l"><div class="bg dv"><div class="dv l"><div class="fi dv abt abu abv abw abx aby abz aca acb acc acd ace acf" role="link" data-href="https://levelup.gitconnected.com/4-xsss-with-a-simple-optimized-payload-900753538e90" tabindex="0"><div class="acg"><div aria-label="XSS on bugcrowd program triaged"><div class="aci acj ack acl acm"><img alt="XSS on bugcrowd program triaged" class="bg acn aco acp acq bw" src="https://miro.medium.com/v2/resize:fit:849/0*zSLvzPhUE6hzkGhL" loading="lazy"></div></div></div><div class="ach ab ca cn"><div class="ab cn acr bg acs act acu acv"><div class="vf vh acw acx acy ab q"><div class="rp l"><div><div class="l" aria-hidden="false" aria-describedby="150" aria-labelledby="150"><a tabindex="-1" href="https://hamzaavvan.medium.com/?source=read_next_recirc-----fff72116ca33----1---------------------6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><div class="l fi"><img alt="Hamza Avvan" class="l fc bx acz ada cw" src="https://miro.medium.com/v2/resize:fill:25:25/1*kgFWSlHvBAo1S5O1NtO4AQ@2x.jpeg" width="20" height="20" loading="lazy"><div class="fq bx l acz ada fr n ax fs"></div></div></a></div></div></div><div class="adb l"><div><div class="l" aria-hidden="false" aria-describedby="151" aria-labelledby="151"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://hamzaavvan.medium.com/?source=read_next_recirc-----fff72116ca33----1---------------------6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Hamza Avvan</p></a></div></div></div><div class="adb l"><p class="be b du z dt">in</p></div><div class="l"><div><div class="l" aria-hidden="false" aria-describedby="152" aria-labelledby="152"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://levelup.gitconnected.com/?source=read_next_recirc-----fff72116ca33----1---------------------6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Level Up Coding</p></a></div></div></div></div><div class="adc add ade adf adg adh adi adj adk adl l gm"><div class="adm adn ado adp adq adr ads adt"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://levelup.gitconnected.com/4-xsss-with-a-simple-optimized-payload-900753538e90?source=read_next_recirc-----fff72116ca33----1---------------------6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><div title=""><h2 class="be gu pd pf adu adv pg ph pj adw adx pk nz ady adz aea aeb od aec aed aee aef oh aeg aeh aei aej jj jl jm jo jq bj">4 XSSs With A Simple &amp; Optimized Payload</h2></div><div class="aek l"><h3 class="be b is z jj ael jl jm aem jo jq dt">Check out how I earned $1250 by bypassing WAF in Steal User Information — Chaining XSS &amp; Http Parameter Pollution using an amazing…</h3></div></a></div></div><span class="be b du z dt"><div class="ab q"><div class="sd ab"><div class="bl" aria-hidden="false" aria-describedby="153" aria-labelledby="153"><button class="l ax ao am" aria-label="Member-only story"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="154" aria-labelledby="154"><svg width="16" height="16" viewBox="0 0 64 64" fill="none"><path d="M39.64 40.83L33.87 56.7a1.99 1.99 0 0 1-3.74 0l-5.77-15.87a2.02 2.02 0 0 0-1.2-1.2L7.3 33.88a1.99 1.99 0 0 1 0-3.74l15.87-5.77a2.02 2.02 0 0 0 1.2-1.2L30.12 7.3a1.99 1.99 0 0 1 3.74 0l5.77 15.87a2.02 2.02 0 0 0 1.2 1.2l15.86 5.76a1.99 1.99 0 0 1 0 3.74l-15.87 5.77a2.02 2.02 0 0 0-1.2 1.2z" fill="#FFC017"></path></svg></div></div></div></button></div></div><span class="iv l" aria-hidden="true"><span class="be b bf z dt">·</span></span><span>3 min read</span><span class="iv l" aria-hidden="true"><span class="be b bf z dt">·</span></span><span>May 11, 2024</span></div></span><div class="aen aeo aep aeq aer l"><div class="ab co"><div class="am aes aet aeu aev aew aex aey aez afa afb ab q"><div class="ab q kz la"><div class="pw-multi-vote-icon fi ji lb lc ld"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fgitconnected%2F900753538e90&amp;operation=register&amp;redirect=https%3A%2F%2Flevelup.gitconnected.com%2F4-xsss-with-a-simple-optimized-payload-900753538e90&amp;user=Hamza+Avvan&amp;userId=a444de91b76d&amp;source=-----900753538e90----1-----------------clap_footer----6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><div><div class="bl" aria-hidden="false" aria-describedby="155" aria-labelledby="155"><div class="le ao lf lg lh li am lj lk ll ld"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lm ln lo lp lq lr ls"><div><div class="bl" aria-hidden="false" aria-describedby="220" aria-labelledby="220"><p class="be b du z dt"><button class="af ag ah ai aj ak al am an ao ap aq ar as at zc ma">278<span class="l h g f sk sl"></span></button></p></div></div></div></div><div class="afc l"><div><div class="bl" aria-hidden="false" aria-describedby="156" aria-labelledby="156"><a class="af fj ah le aj ak al lv an ao ap aq ar as at lu ab q lw lx" aria-label="responses" href="https://levelup.gitconnected.com/4-xsss-with-a-simple-optimized-payload-900753538e90?responsesOpen=true&amp;sortBy=REVERSE_CHRON&amp;source=read_next_recirc-----fff72116ca33----1---------------------6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><svg width="24" height="24" viewBox="0 0 24 24" class=""><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg><p class="be b du z dt"><span class="pw-responses-count aff ly">2</span></p></a></div></div></div></div><div class="ab q afd afe"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="157" aria-labelledby="157"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F900753538e90&amp;operation=register&amp;redirect=https%3A%2F%2Flevelup.gitconnected.com%2F4-xsss-with-a-simple-optimized-payload-900753538e90&amp;source=-----fff72116ca33----1-----------------bookmark_preview----6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></div></div></div></div></div></div></div></article></div></div></div></div><div class="tq bg tr agl"></div><h2 class="be tl is z gs bj">Lists</h2><div class="os l"><div class="cm ab kz je zg zh zi zj zk zl zm zn zo zp zq zr zs zt zu"><div class="zv zw zx zy zz aba abb abc abd abe abf abg yu abh abi abj yv abk abl abm abn"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab ck cm" href="https://medium.com/@wearedelicious/list/tech-tools-541154dfb3ae?source=read_next_recirc-----fff72116ca33--------------------------------" rel="noopener follow"><div class="agr ags jj ab jb fi"><div class="fi acn agn bw ago"><div class="acn ig jj l"><img alt="" class="" src="https://miro.medium.com/v2/resize:fill:60:60/1*VBGWIyCtkhx8FtMSb-xumg.png" width="48" height="48" loading="lazy" role="presentation"></div></div><div class="fi acn agn bw la agp"><div class="acn ig jj l"><img alt="Close-up Shot of a Person Wearing a Robber Mask" class="" src="https://miro.medium.com/v2/resize:fill:60:60/1*UUb0HMDMuibZuDkkCazeJg.jpeg" width="48" height="48" loading="lazy"></div></div><div class="fi acn bw io agq"><div class="acn ig jj l"><img alt="" class="" src="https://miro.medium.com/v2/resize:fill:60:60/1*x0FBZgsae1ElzECF0gNKgg.jpeg" width="48" height="48" loading="lazy" role="presentation"></div></div></div><div class="aw l"><h2 class="be tl is z jj ael jl jm aem jo jq gs bj">Tech &amp; Tools</h2><div class="be b du z dt ab agm">17 stories<span class="iv l" aria-hidden="true"><span class="be b bf z dt">·</span></span>245 saves</div></div></a></div><div class="zv zw zx zy zz aba abb abc abd abe abf abg yu abh abi abj yv abk abl abm abn"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab ck cm" href="https://eddiebarth.medium.com/list/general-coding-knowledge-f2d429d4f0cd?source=read_next_recirc-----fff72116ca33--------------------------------" rel="noopener follow"><div class="agr ags jj ab jb fi"><div class="fi acn agn bw ago"><div class="acn ig jj l"><img alt="" class="" src="https://miro.medium.com/v2/resize:fill:60:60/1*zPtGTCNOwu1p3kzn_sZFVQ.png" width="48" height="48" loading="lazy" role="presentation"></div></div><div class="fi acn agn bw la agp"><div class="acn ig jj l"><img alt="" class="" src="https://miro.medium.com/v2/da:true/resize:fill:60:60/0*kQIvhDkl0ixPpv4z" width="48" height="48" loading="lazy" role="presentation"></div></div><div class="fi acn bw io agq"><div class="acn ig jj l"><img alt="" class="" src="https://miro.medium.com/v2/resize:fill:60:60/1*ERYx0IB1pN-5ZX98cKAoUw.png" width="48" height="48" loading="lazy" role="presentation"></div></div></div><div class="aw l"><h2 class="be tl is z jj ael jl jm aem jo jq gs bj">General Coding Knowledge</h2><div class="be b du z dt ab agm">20 stories<span class="iv l" aria-hidden="true"><span class="be b bf z dt">·</span></span>1292 saves</div></div></a></div><div class="zv zw zx zy zz aba abb abc abd abe abf abg yu abh abi abj yv abk abl abm abn"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab ck cm" href="https://minoraxis.medium.com/list/icon-design-846bd38354b6?source=read_next_recirc-----fff72116ca33--------------------------------" rel="noopener follow"><div class="agr ags jj ab jb fi"><div class="fi acn agn bw ago"><div class="acn ig jj l"><img alt="A set of bold icons including a skull, notification bell, and hamburger" class="" src="https://miro.medium.com/v2/da:true/resize:fill:60:60/0*NodLEUJwJji9-a7k" width="48" height="48" loading="lazy"></div></div><div class="fi acn agn bw la agp"><div class="acn ig jj l"><img alt="" class="" src="https://miro.medium.com/v2/da:true/resize:fill:60:60/1*RW-EGZs0FkdKeRz-ot9UOA.gif" width="48" height="48" loading="lazy" role="presentation"></div></div><div class="fi acn bw io agq"><div class="acn ig jj l"><img alt="Detailed photograph, of an ancient cave painting, featuring modern icons, from time magazine, made with DALLE" class="" src="https://miro.medium.com/v2/resize:fill:60:60/1*R9aptJpaxxaqL2xs0Yj4vA.jpeg" width="48" height="48" loading="lazy"></div></div></div><div class="aw l"><h2 class="be tl is z jj ael jl jm aem jo jq gs bj">Icon Design</h2><div class="be b du z dt ab agm">36 stories<span class="iv l" aria-hidden="true"><span class="be b bf z dt">·</span></span>328 saves</div></div></a></div><div class="zv zw zx zy zz aba abb abc abd abe abf abg yu abh abi abj yv abk abl abm abn"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab ck cm" href="https://medium.com/@MediumStaff/list/mediums-huge-list-of-publications-accepting-submissions-7c0ec8037e61?source=read_next_recirc-----fff72116ca33--------------------------------" rel="noopener follow"><div class="agr ags jj ab jb fi"><div class="fi acn agn bw ago"><div class="acn ig jj l"><img alt="" class="" src="https://miro.medium.com/v2/resize:fill:60:60/1*I-niCEZgF3IO-KGOMEuYkw.png" width="48" height="48" loading="lazy" role="presentation"></div></div><div class="fi acn agn bw la agp"><div class="acn ig jj l"><img alt="" class="" src="https://miro.medium.com/v2/resize:fill:60:60/1*uPC1ZNHm3Zd1qREO8fVFjw.png" width="48" height="48" loading="lazy" role="presentation"></div></div><div class="fi acn bw io agq"><div class="acn ig jj l"><img alt="" class="" src="https://miro.medium.com/v2/resize:fill:60:60/1*n1SHUUHyI16HZB1FhK8Khw.jpeg" width="48" height="48" loading="lazy" role="presentation"></div></div></div><div class="aw l"><h2 class="be tl is z jj ael jl jm aem jo jq gs bj">Medium's Huge List of Publications Accepting Submissions</h2><div class="be b du z dt ab agm">312 stories<span class="iv l" aria-hidden="true"><span class="be b bf z dt">·</span></span>2901 saves</div></div></a></div></div></div><div class="tq bg tr afw dj afy dk agt agu agv agw agx agy"></div><div class="zf ab kz je zg zh zi zj zk zl zm zn zo zp zq zr zs zt zu"><div class="zv zw zx zy zz aba abb abc abd abe abf abg yu abh abi abj yv abk abl abm abn"><div class="abo abp abq abr abs dv l"><article class="dv"><div class="dv sd l"><div class="bg dv"><div class="dv l"><div class="fi dv abt abu abv abw abx aby abz aca acb acc acd ace acf" role="link" data-href="https://kongsec.medium.com/js-for-bug-bounties-2-0-extreme-edition-2024-f167fa48276a" tabindex="0"><div class="acg"><div aria-label="JS for Bug Bounties 2.0 Extreme Edition 2024"><div class="aci acj ack acl acm"><img alt="JS for Bug Bounties 2.0 Extreme Edition 2024" class="bg acn aco acp acq bw" src="https://miro.medium.com/v2/resize:fit:849/1*v4Tz5IkXG5xauPQd_Cvd_g.png" loading="lazy"></div></div></div><div class="ach ab ca cn"><div class="ab cn acr bg acs act acu acv"><div class="vf vh acw acx acy ab q"><div class="rp l"><div><div class="l" aria-hidden="false" aria-describedby="158" aria-labelledby="158"><a tabindex="-1" href="https://kongsec.medium.com/?source=read_next_recirc-----fff72116ca33----0---------------------6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><div class="l fi"><img alt="Kongsec" class="l fc bx acz ada cw" src="https://miro.medium.com/v2/resize:fill:25:25/1*lj874R-FtwEE6dyn37IWcQ.png" width="20" height="20" loading="lazy"><div class="fq bx l acz ada fr n ax fs"></div></div></a></div></div></div><div class="adb l"><div><div class="l" aria-hidden="false" aria-describedby="159" aria-labelledby="159"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://kongsec.medium.com/?source=read_next_recirc-----fff72116ca33----0---------------------6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Kongsec</p></a></div></div></div></div><div class="adc add ade adf adg adh adi adj adk adl l gm"><div class="adm adn ado adp adq adr ads adt"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://kongsec.medium.com/js-for-bug-bounties-2-0-extreme-edition-2024-f167fa48276a?source=read_next_recirc-----fff72116ca33----0---------------------6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><div title=""><h2 class="be gu pd pf adu adv pg ph pj adw adx pk nz ady adz aea aeb od aec aed aee aef oh aeg aeh aei aej jj jl jm jo jq bj">JS for Bug Bounties 2.0 Extreme Edition 2024</h2></div><div class="aek l"><h3 class="be b is z jj ael jl jm aem jo jq dt">Hi everyone,</h3></div></a></div></div><span class="be b du z dt"><div class="ab q"><span>5 min read</span><span class="iv l" aria-hidden="true"><span class="be b bf z dt">·</span></span><span>Jun 7, 2024</span></div></span><div class="aen aeo aep aeq aer l"><div class="ab co"><div class="am aes aet aeu aev aew aex aey aez afa afb ab q"><div class="ab q kz la"><div class="pw-multi-vote-icon fi ji lb lc ld"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Ff167fa48276a&amp;operation=register&amp;redirect=https%3A%2F%2Fkongsec.medium.com%2Fjs-for-bug-bounties-2-0-extreme-edition-2024-f167fa48276a&amp;user=Kongsec&amp;userId=fc7a50af845&amp;source=-----f167fa48276a----0-----------------clap_footer----6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><div><div class="bl" aria-hidden="false" aria-describedby="160" aria-labelledby="160"><div class="le ao lf lg lh li am lj lk ll ld"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lm ln lo lp lq lr ls"><div><div class="bl" aria-hidden="false" aria-describedby="222" aria-labelledby="222"><p class="be b du z dt"><button class="af ag ah ai aj ak al am an ao ap aq ar as at zc ma">715<span class="l h g f sk sl"></span></button></p></div></div></div></div><div class="afc l"><div><div class="bl" aria-hidden="false" aria-describedby="161" aria-labelledby="161"><a class="af fj ah le aj ak al lv an ao ap aq ar as at lu ab q lw lx" aria-label="responses" href="https://kongsec.medium.com/js-for-bug-bounties-2-0-extreme-edition-2024-f167fa48276a?responsesOpen=true&amp;sortBy=REVERSE_CHRON&amp;source=read_next_recirc-----fff72116ca33----0---------------------6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><svg width="24" height="24" viewBox="0 0 24 24" class=""><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg><p class="be b du z dt"><span class="pw-responses-count aff ly">4</span></p></a></div></div></div></div><div class="ab q afd afe"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="162" aria-labelledby="162"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Ff167fa48276a&amp;operation=register&amp;redirect=https%3A%2F%2Fkongsec.medium.com%2Fjs-for-bug-bounties-2-0-extreme-edition-2024-f167fa48276a&amp;source=-----fff72116ca33----0-----------------bookmark_preview----6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></div><div class="j i d"><div class="tq bg tr os"></div></div></div></div></div></div></div></div></article></div></div><div class="zv zw zx zy zz aba abb abc abd abe abf abg yu abh abi abj yv abk abl abm abn"><div class="abo abp abq abr abs dv l"><article class="dv"><div class="dv sd l"><div class="bg dv"><div class="dv l"><div class="fi dv abt abu abv abw abx aby abz aca acb acc acd ace acf" role="link" data-href="https://machiavellli.medium.com/how-i-got-my-first-bounty-65ad8a1763de" tabindex="0"><div class="acg"><div aria-label="How I Got My First €€€€ Bounty"><div class="aci acj ack acl acm"><img alt="How I Got My First €€€€ Bounty" class="bg acn aco acp acq bw" src="https://miro.medium.com/v2/resize:fit:849/1*myYtv3B4kw4eQcnsjE-5Kw.png" loading="lazy"></div></div></div><div class="ach ab ca cn"><div class="ab cn acr bg acs act acu acv"><div class="vf vh acw acx acy ab q"><div class="rp l"><div><div class="l" aria-hidden="false" aria-describedby="163" aria-labelledby="163"><a tabindex="-1" href="https://machiavellli.medium.com/?source=read_next_recirc-----fff72116ca33----1---------------------6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><div class="l fi"><img alt="Machiavelli" class="l fc bx acz ada cw" src="https://miro.medium.com/v2/resize:fill:25:25/1*zLtLjSvuXsXYW_s7Pq5SRw.jpeg" width="20" height="20" loading="lazy"><div class="fq bx l acz ada fr n ax fs"></div></div></a></div></div></div><div class="adb l"><div><div class="l" aria-hidden="false" aria-describedby="164" aria-labelledby="164"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://machiavellli.medium.com/?source=read_next_recirc-----fff72116ca33----1---------------------6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Machiavelli</p></a></div></div></div></div><div class="adc add ade adf adg adh adi adj adk adl l gm"><div class="adm adn ado adp adq adr ads adt"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://machiavellli.medium.com/how-i-got-my-first-bounty-65ad8a1763de?source=read_next_recirc-----fff72116ca33----1---------------------6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><div title=""><h2 class="be gu pd pf adu adv pg ph pj adw adx pk nz ady adz aea aeb od aec aed aee aef oh aeg aeh aei aej jj jl jm jo jq bj">How I Got My First €€€€ Bounty</h2></div><div class="aek l"><h3 class="be b is z jj ael jl jm aem jo jq dt">I’ll share In this write-up how I discovered my first €€€€ bounty.</h3></div></a></div></div><span class="be b du z dt"><div class="ab q"><span>2 min read</span><span class="iv l" aria-hidden="true"><span class="be b bf z dt">·</span></span><span>Jun 3, 2024</span></div></span><div class="aen aeo aep aeq aer l"><div class="ab co"><div class="am aes aet aeu aev aew aex aey aez afa afb ab q"><div class="ab q kz la"><div class="pw-multi-vote-icon fi ji lb lc ld"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F65ad8a1763de&amp;operation=register&amp;redirect=https%3A%2F%2Fmachiavellli.medium.com%2Fhow-i-got-my-first-bounty-65ad8a1763de&amp;user=Machiavelli&amp;userId=62aa1cfa89d&amp;source=-----65ad8a1763de----1-----------------clap_footer----6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><div><div class="bl" aria-hidden="false" aria-describedby="165" aria-labelledby="165"><div class="le ao lf lg lh li am lj lk ll ld"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lm ln lo lp lq lr ls"><div><div class="bl" aria-hidden="false" aria-describedby="224" aria-labelledby="224"><p class="be b du z dt"><button class="af ag ah ai aj ak al am an ao ap aq ar as at zc ma">379<span class="l h g f sk sl"></span></button></p></div></div></div></div><div class="afc l"><div><div class="bl" aria-hidden="false" aria-describedby="166" aria-labelledby="166"><a class="af fj ah le aj ak al lv an ao ap aq ar as at lu ab q lw lx" aria-label="responses" href="https://machiavellli.medium.com/how-i-got-my-first-bounty-65ad8a1763de?responsesOpen=true&amp;sortBy=REVERSE_CHRON&amp;source=read_next_recirc-----fff72116ca33----1---------------------6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><svg width="24" height="24" viewBox="0 0 24 24" class=""><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg><p class="be b du z dt"><span class="pw-responses-count aff ly">4</span></p></a></div></div></div></div><div class="ab q afd afe"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="167" aria-labelledby="167"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F65ad8a1763de&amp;operation=register&amp;redirect=https%3A%2F%2Fmachiavellli.medium.com%2Fhow-i-got-my-first-bounty-65ad8a1763de&amp;source=-----fff72116ca33----1-----------------bookmark_preview----6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></div><div class="j i d"><div class="tq bg tr os"></div></div></div></div></div></div></div></div></article></div></div><div class="zv zw zx zy zz aba abb abc abd abe abf abg yu abh abi abj yv abk abl abm abn"><div class="abo abp abq abr abs dv l"><article class="dv"><div class="dv sd l"><div class="bg dv"><div class="dv l"><div class="fi dv abt abu abv abw abx aby abz aca acb acc acd ace acf" role="link" data-href="https://an0nbil.medium.com/the-only-recon-methodology-you-need-cf6c3aff1af1" tabindex="0"><div class="acg"><div aria-label="The only recon methodology you need."><div class="aci acj ack acl acm"><img alt="The only recon methodology you need." class="bg acn aco acp acq bw" src="https://miro.medium.com/v2/resize:fit:849/1*rbN4yk0DKuNkka5K8ptJUg.jpeg" loading="lazy"></div></div></div><div class="ach ab ca cn"><div class="ab cn acr bg acs act acu acv"><div class="vf vh acw acx acy ab q"><div class="rp l"><div><div class="l" aria-hidden="false" aria-describedby="168" aria-labelledby="168"><a tabindex="-1" href="https://an0nbil.medium.com/?source=read_next_recirc-----fff72116ca33----2---------------------6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><div class="l fi"><img alt="an0nbil" class="l fc bx acz ada cw" src="https://miro.medium.com/v2/resize:fill:25:25/1*dUNqqReKHaTBZkMi1R3hQw.jpeg" width="20" height="20" loading="lazy"><div class="fq bx l acz ada fr n ax fs"></div></div></a></div></div></div><div class="adb l"><div><div class="l" aria-hidden="false" aria-describedby="169" aria-labelledby="169"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://an0nbil.medium.com/?source=read_next_recirc-----fff72116ca33----2---------------------6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">an0nbil</p></a></div></div></div></div><div class="adc add ade adf adg adh adi adj adk adl l gm"><div class="adm adn ado adp adq adr ads adt"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://an0nbil.medium.com/the-only-recon-methodology-you-need-cf6c3aff1af1?source=read_next_recirc-----fff72116ca33----2---------------------6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><div title=""><h2 class="be gu pd pf adu adv pg ph pj adw adx pk nz ady adz aea aeb od aec aed aee aef oh aeg aeh aei aej jj jl jm jo jq bj">The only recon methodology you need.</h2></div><div class="aek l"><h3 class="be b is z jj ael jl jm aem jo jq dt">the best way to recon using just one tool.</h3></div></a></div></div><span class="be b du z dt"><div class="ab q"><span>6 min read</span><span class="iv l" aria-hidden="true"><span class="be b bf z dt">·</span></span><span>Jun 6, 2024</span></div></span><div class="aen aeo aep aeq aer l"><div class="ab co"><div class="am aes aet aeu aev aew aex aey aez afa afb ab q"><div class="ab q kz la"><div class="pw-multi-vote-icon fi ji lb lc ld"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fcf6c3aff1af1&amp;operation=register&amp;redirect=https%3A%2F%2Fan0nbil.medium.com%2Fthe-only-recon-methodology-you-need-cf6c3aff1af1&amp;user=an0nbil&amp;userId=d68c1e6e7a34&amp;source=-----cf6c3aff1af1----2-----------------clap_footer----6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><div><div class="bl" aria-hidden="false" aria-describedby="170" aria-labelledby="170"><div class="le ao lf lg lh li am lj lk ll ld"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lm ln lo lp lq lr ls"><div><div class="bl" aria-hidden="false" aria-describedby="226" aria-labelledby="226"><p class="be b du z dt"><button class="af ag ah ai aj ak al am an ao ap aq ar as at zc ma">248<span class="l h g f sk sl"></span></button></p></div></div></div></div><div class="afc l"><div><div class="bl" aria-hidden="false" aria-describedby="171" aria-labelledby="171"><a class="af fj ah le aj ak al lv an ao ap aq ar as at lu ab q lw lx" aria-label="responses" href="https://an0nbil.medium.com/the-only-recon-methodology-you-need-cf6c3aff1af1?responsesOpen=true&amp;sortBy=REVERSE_CHRON&amp;source=read_next_recirc-----fff72116ca33----2---------------------6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><svg width="24" height="24" viewBox="0 0 24 24" class=""><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></a></div></div></div></div><div class="ab q afd afe"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="172" aria-labelledby="172"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcf6c3aff1af1&amp;operation=register&amp;redirect=https%3A%2F%2Fan0nbil.medium.com%2Fthe-only-recon-methodology-you-need-cf6c3aff1af1&amp;source=-----fff72116ca33----2-----------------bookmark_preview----6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></div><div class="j i d"><div class="tq bg tr os"></div></div></div></div></div></div></div></div></article></div></div><div class="zv zw zx zy zz aba abb abc abd abe abf abg yu abh abi abj yv abk abl abm abn"><div class="abo abp abq abr abs dv l"><article class="dv"><div class="dv sd l"><div class="bg dv"><div class="dv l"><div class="fi dv abt abu abv abw abx aby abz aca acb acc acd ace acf" role="link" data-href="https://infosecwriteups.com/bypass-firewall-by-finding-origin-ip-41ba984e1342" tabindex="0"><div class="acg"><div aria-label="Bypass Firewall by Finding Origin IP"><div class="aci acj ack acl acm"><img alt="Bypass Firewall by Finding Origin IP" class="bg acn aco acp acq bw" src="https://miro.medium.com/v2/resize:fit:849/0*aBpUhgc2JCrcq_k2.png" loading="lazy"></div></div></div><div class="ach ab ca cn"><div class="ab cn acr bg acs act acu acv"><div class="vf vh acw acx acy ab q"><div class="rp l"><div><div class="l" aria-hidden="false" aria-describedby="173" aria-labelledby="173"><a tabindex="-1" href="https://ott3rly.medium.com/?source=read_next_recirc-----fff72116ca33----3---------------------6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><div class="l fi"><img alt="Ott3rly" class="l fc bx acz ada cw" src="https://miro.medium.com/v2/resize:fill:25:25/1*QA4SKMoKSnE8F_SSE4GgCA.jpeg" width="20" height="20" loading="lazy"><div class="fq bx l acz ada fr n ax fs"></div></div></a></div></div></div><div class="adb l"><div><div class="l" aria-hidden="false" aria-describedby="174" aria-labelledby="174"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://ott3rly.medium.com/?source=read_next_recirc-----fff72116ca33----3---------------------6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">Ott3rly</p></a></div></div></div><div class="adb l"><p class="be b du z dt">in</p></div><div class="l"><div><div class="l" aria-hidden="false" aria-describedby="175" aria-labelledby="175"><a class="af ag ah ai aj ak al am an ao ap aq ar iu ab q" href="https://infosecwriteups.com/?source=read_next_recirc-----fff72116ca33----3---------------------6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><p class="be b du z jj jk jl jm jn jo jp jq bj">InfoSec Write-ups</p></a></div></div></div></div><div class="adc add ade adf adg adh adi adj adk adl l gm"><div class="adm adn ado adp adq adr ads adt"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://infosecwriteups.com/bypass-firewall-by-finding-origin-ip-41ba984e1342?source=read_next_recirc-----fff72116ca33----3---------------------6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><div title=""><h2 class="be gu pd pf adu adv pg ph pj adw adx pk nz ady adz aea aeb od aec aed aee aef oh aeg aeh aei aej jj jl jm jo jq bj">Bypass Firewall by Finding Origin IP</h2></div><div class="aek l"><h3 class="be b is z jj ael jl jm aem jo jq dt">Bypass WAF by finding origin IP address as a method. We will explore multiple ways how you can do it.</h3></div></a></div></div><span class="be b du z dt"><div class="ab q"><span>5 min read</span><span class="iv l" aria-hidden="true"><span class="be b bf z dt">·</span></span><span>May 6, 2024</span></div></span><div class="aen aeo aep aeq aer l"><div class="ab co"><div class="am aes aet aeu aev aew aex aey aez afa afb ab q"><div class="ab q kz la"><div class="pw-multi-vote-icon fi ji lb lc ld"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fbugbountywriteup%2F41ba984e1342&amp;operation=register&amp;redirect=https%3A%2F%2Finfosecwriteups.com%2Fbypass-firewall-by-finding-origin-ip-41ba984e1342&amp;user=Ott3rly&amp;userId=50a926e10f4b&amp;source=-----41ba984e1342----3-----------------clap_footer----6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><div><div class="bl" aria-hidden="false" aria-describedby="176" aria-labelledby="176"><div class="le ao lf lg lh li am lj lk ll ld"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lm ln lo lp lq lr ls"><div><div class="bl" aria-hidden="false" aria-describedby="228" aria-labelledby="228"><p class="be b du z dt"><button class="af ag ah ai aj ak al am an ao ap aq ar as at zc ma">624<span class="l h g f sk sl"></span></button></p></div></div></div></div><div class="afc l"><div><div class="bl" aria-hidden="false" aria-describedby="177" aria-labelledby="177"><a class="af fj ah le aj ak al lv an ao ap aq ar as at lu ab q lw lx" aria-label="responses" href="https://infosecwriteups.com/bypass-firewall-by-finding-origin-ip-41ba984e1342?responsesOpen=true&amp;sortBy=REVERSE_CHRON&amp;source=read_next_recirc-----fff72116ca33----3---------------------6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><svg width="24" height="24" viewBox="0 0 24 24" class=""><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg><p class="be b du z dt"><span class="pw-responses-count aff ly">5</span></p></a></div></div></div></div><div class="ab q afd afe"><div class=""><div><div class="bl" aria-hidden="false" aria-describedby="178" aria-labelledby="178"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F41ba984e1342&amp;operation=register&amp;redirect=https%3A%2F%2Finfosecwriteups.com%2Fbypass-firewall-by-finding-origin-ip-41ba984e1342&amp;source=-----fff72116ca33----3-----------------bookmark_preview----6b5640ee_7808_43ec_847e_d100769b2f05-------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dt ma" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div></div></div></div></div></div></div></div></div></div></article></div></div></div><div class="tq bg tr dj dk afg afh afi"></div><a class="be b bf z bj rq afm afn afo ma lw ww eu ev ew afp afq afr ez wh wi afs aft afu fa fb fc bl fd fe" href="https://medium.com/?source=post_page-----fff72116ca33--------------------------------" rel="noopener follow"><div class="l fe">See more recommendations</div></a></div></div></div><div class="h k j"><div class="tq bg tr ts"></div><div class="ab ca"><div class="ch bg fy fz ga gb"><div class="tt ab kz je"><div class="tu tv l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----fff72116ca33--------------------------------" rel="noopener follow"><p class="be b du z dt">Help</p></a></div><div class="tu tv l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----fff72116ca33--------------------------------" rel="noopener follow"><p class="be b du z dt">Status</p></a></div><div class="tu tv l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/about?autoplay=1&amp;source=post_page-----fff72116ca33--------------------------------" rel="noopener follow"><p class="be b du z dt">About</p></a></div><div class="tu tv l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----fff72116ca33--------------------------------" rel="noopener follow"><p class="be b du z dt">Careers</p></a></div><div class="tu tv l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="mailto:pressinquiries@medium.com?source=post_page-----fff72116ca33--------------------------------" rel="noopener follow"><p class="be b du z dt">Press</p></a></div><div class="tu tv l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----fff72116ca33--------------------------------" rel="noopener follow"><p class="be b du z dt">Blog</p></a></div><div class="tu tv l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fff72116ca33--------------------------------" rel="noopener follow"><p class="be b du z dt">Privacy</p></a></div><div class="tu tv l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fff72116ca33--------------------------------" rel="noopener follow"><p class="be b du z dt">Terms</p></a></div><div class="tu tv l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----fff72116ca33--------------------------------" rel="noopener follow"><p class="be b du z dt">Text to speech</p></a></div><div class="tu l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/business?source=post_page-----fff72116ca33--------------------------------" rel="noopener follow"><p class="be b du z dt">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20240614-221838-3ba87a70fa"</script><script>window.__GRAPHQL_URI__ = "https://blog.neuvik.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"This request is not using the cache middleware worker","group":"disabled","tags":["group-edgeCachePosts","post-fff72116ca33","user-c6ea1883b294","collection-7385dc8da6d2"],"serverVariantState":"","middlewareEnabled":false,"cacheStatus":"DYNAMIC","shouldUseCache":false,"vary":[],"updatedPostPreviewsEnabled":false,"lohpExperimentEnabled":"control","prideLogoEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":true,"routingEntity":{"type":"COLLECTION","id":"7385dc8da6d2","explicit":true},"viewerIsBot":false},"debug":{"requestId":"126d4e29-509c-4f5f-ab81-dc6b7248de5e","hybridDevServices":[],"originalSpanCarrier":{"ot-tracer-spanid":"63117c8e4e04f77c","ot-tracer-traceid":"4ad3ca426f92dddb","ot-tracer-sampled":"true"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fblog.neuvik.com\u002Fjourney-into-windows-kernel-exploitation-the-basics-fff72116ca33","host":"blog.neuvik.com","hostname":"blog.neuvik.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null}},"config":{"nodeEnv":"production","version":"main-20240614-221838-3ba87a70fa","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20240614-221838-3ba87a70fa","commit":"3ba87a70fa89456c9162015acb3c1797c92f4b41"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"1*OMF3fSqH8t4xBJ9-6oZDZw.png","height":106,"width":545},"postLogo":{"imageId":"1*kFrc4tBFM_tCis-2Ic87WA.png","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","isLoggedIn":false,"variantFlags":[{"__typename":"VariantFlag","name":"enable_ios_offline_reading","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_pub_stats","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_paypal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_homepage","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_medium_forever_introductory_discount","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pill_based_home_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"onboarding_tags_from_top_views","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pp_v4","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pre_pp_v4","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_cards","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_auto_follow_on_subscribe","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_for_members","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_offline_reading","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_marketing_emails","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_client","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_integration","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_footer_app_buttons","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_image_sharer","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_annual_premium_plan","valueType":{"__typename":"VariantFlagString","value":"4a442ace1476"}},{"__typename":"VariantFlag","name":"disable_partner_program_enrollment","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_automod","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_annual_plan","valueType":{"__typename":"VariantFlagString","value":"2c754bcc2995"}},{"__typename":"VariantFlag","name":"enable_cache_less_following_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"mobile_custom_app_icon","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_bg_post_post","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_speechify_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"price_smoke_test_monthly","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"available_monthly_plan","valueType":{"__typename":"VariantFlagString","value":"60e220181034"}},{"__typename":"VariantFlag","name":"enable_legacy_feed_in_iceland","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tick_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_diversification_rex","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_test_auth","valueType":{"__typename":"VariantFlagString","value":"disallow"}},{"__typename":"VariantFlag","name":"enable_braintree_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_first_story","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_recaptcha_enterprise","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"reader_fair_distribution_non_qp","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"textshots_userid","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"enable_iceland_forced_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sprig","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mps_pp_writer_stats","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_new_push_notification_endpoint","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_remove_twitter_onboarding_step","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_access","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_c","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_sign_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"skip_fs_cache_user_vals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_members_only_audio","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_syntax_highlight","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_cards_byline","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_premium_tier","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_topic_portals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_premium_tier_badge","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_entities_to_follow_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_newsletter_lo_flow_custom_domains","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branch_io","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_import","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_dynamic_paywall_programming","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_easy_resubscribe","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_avatar_upload","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_reading_history","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"can_send_tips_v0","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sharer_validate_post_share_key","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tipping_v0_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_pub_follower_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_google_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_continue_this_thread","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lo_homepage","valueType":{"__typename":"VariantFlagString","value":"group_2"}},{"__typename":"VariantFlag","name":"enable_recirc_model","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_signup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_friend_links_postpage_banners","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_verified_author","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_trial_membership","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_medium2_kbfd","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_susi_redesign_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_friend_links_postpage_banners","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_dynamic_aspirational_paywall","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_eventstats_event_processing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sharer_create_post_share_key","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_monthly_premium_plan","valueType":{"__typename":"VariantFlagString","value":"12a660186432"}},{"__typename":"VariantFlag","name":"android_enable_lists_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pride_logo","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"price_smoke_test_yearly","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"enable_lite_archive_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ml_rank_rex_anno","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"rex_generator_max_candidates","valueType":{"__typename":"VariantFlagNumber"}},{"__typename":"VariantFlag","name":"enable_google_one_tap","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_simplified_digest_v2_b","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"glyph_font_set","valueType":{"__typename":"VariantFlagString","value":"m2-unbound-source-serif-pro"}},{"__typename":"VariantFlag","name":"ios_in_app_free_trial","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"reengagement_notification_duration","valueType":{"__typename":"VariantFlagNumber"}},{"__typename":"VariantFlag","name":"enable_switch_plan_premium_tier","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_two_hour_refresh","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_dynamic_programming_paywall","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_deprecate_legacy_providers_v3","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_all_recs_surfaces","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"coronavirus_topic_recirc","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_susi_redesign_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_home_post_menu","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_server_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_rating_prompt_stories_read_threshold","valueType":{"__typename":"VariantFlagNumber"}},{"__typename":"VariantFlag","name":"enable_braintree_apple_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_friend_links_creation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"can_receive_tips_v0","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"crm_send_contact_to_sendgrid","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rito_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"signin_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"android_enable_editor_new_publishing_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_miro_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_for_members_username_selection","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_starspace","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_speechify_widget","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_group_gifting","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tag_recs","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_creator_welcome_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mobile_lohp_short_hero","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"signup_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"ios_display_paywall_after_onboarding","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_dynamic_paywall_aspiriational","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"redefined_top_posts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_autorefresh","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_stripe_customers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_verified_book_author","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_seamless_social_sharing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_user_follows","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"browsable_stream_config_bucket","valueType":{"__typename":"VariantFlagString","value":"curated-topics"}},{"__typename":"VariantFlag","name":"ios_enable_friend_links_creation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_iceland_nux","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_aggregator_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_social_share_sheet","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_post_referrers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_response_markup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_streamline_pub_newsletters","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tipping_v0_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_app_flirty_thirty","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_maim_the_meter","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tribute_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_verifications_service","valueType":{"__typename":"VariantFlagBoolean","value":true}}],"viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"blog.neuvik.com\"})":{"__ref":"Collection:7385dc8da6d2"},"postResult({\"id\":\"fff72116ca33\"})":{"__ref":"Post:fff72116ca33"}},"ImageMetadata:1*6vD2snnhevDB4lAZ1STPbw.png":{"__typename":"ImageMetadata","id":"1*6vD2snnhevDB4lAZ1STPbw.png"},"Collection:7385dc8da6d2":{"__typename":"Collection","id":"7385dc8da6d2","favicon":{"__ref":"ImageMetadata:1*6vD2snnhevDB4lAZ1STPbw.png"},"customStyleSheet":null,"colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFE8F4FF","point":0},{"__typename":"ColorPoint","color":"#FFE4F3FF","point":0.1},{"__typename":"ColorPoint","color":"#FFE0F1FF","point":0.2},{"__typename":"ColorPoint","color":"#FFDBF0FF","point":0.3},{"__typename":"ColorPoint","color":"#FFD7EEFF","point":0.4},{"__typename":"ColorPoint","color":"#FFD2EDFF","point":0.5},{"__typename":"ColorPoint","color":"#FFCDEBFF","point":0.6},{"__typename":"ColorPoint","color":"#FFC8E9FF","point":0.7},{"__typename":"ColorPoint","color":"#FFC3E8FF","point":0.8},{"__typename":"ColorPoint","color":"#FFBEE6FF","point":0.9},{"__typename":"ColorPoint","color":"#FFB9E5FF","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF4F89D6","point":0},{"__typename":"ColorPoint","color":"#FF4C7FC4","point":0.1},{"__typename":"ColorPoint","color":"#FF4976B2","point":0.2},{"__typename":"ColorPoint","color":"#FF456CA1","point":0.3},{"__typename":"ColorPoint","color":"#FF40618F","point":0.4},{"__typename":"ColorPoint","color":"#FF3A577E","point":0.5},{"__typename":"ColorPoint","color":"#FF344C6D","point":0.6},{"__typename":"ColorPoint","color":"#FF2E415B","point":0.7},{"__typename":"ColorPoint","color":"#FF26354A","point":0.8},{"__typename":"ColorPoint","color":"#FF1D2838","point":0.9},{"__typename":"ColorPoint","color":"#FF131B26","point":1}]},"tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FF074E99","colorPoints":[{"__typename":"ColorPoint","color":"#FF074E99","point":0},{"__typename":"ColorPoint","color":"#FF3064A8","point":0.1},{"__typename":"ColorPoint","color":"#FF4C79B6","point":0.2},{"__typename":"ColorPoint","color":"#FF658CC3","point":0.3},{"__typename":"ColorPoint","color":"#FF7C9ED0","point":0.4},{"__typename":"ColorPoint","color":"#FF92B0DC","point":0.5},{"__typename":"ColorPoint","color":"#FFA7C1E7","point":0.6},{"__typename":"ColorPoint","color":"#FFBCD1F2","point":0.7},{"__typename":"ColorPoint","color":"#FFD0E1FC","point":0.8},{"__typename":"ColorPoint","color":"#FFE4F1FF","point":0.9},{"__typename":"ColorPoint","color":"#FFF7FFFF","point":1}]}},"googleAnalyticsId":null,"editors":[{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:f78b92a4329e"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:418d24b8d2ac"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:d145062bf0ca"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:8ba3f726ea81"}}],"name":"Neuvik","avatar":{"__ref":"ImageMetadata:1*-8PVjte6Kwo7RNpng83hTg.png"},"domain":"blog.neuvik.com","slug":"neuvik","description":"Blog posts from Neuvik on various cybersecurity topics","subscriberCount":17,"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:7385dc8da6d2-viewerId:lo_7f7941ed61ce"},"twitterUsername":"Neuvik","facebookPageId":null,"logo":{"__ref":"ImageMetadata:1*lif7rzCQb8w9-u3vOHVkUA.png"}},"User:f78b92a4329e":{"__typename":"User","id":"f78b92a4329e"},"User:418d24b8d2ac":{"__typename":"User","id":"418d24b8d2ac"},"User:d145062bf0ca":{"__typename":"User","id":"d145062bf0ca"},"User:8ba3f726ea81":{"__typename":"User","id":"8ba3f726ea81"},"ImageMetadata:1*-8PVjte6Kwo7RNpng83hTg.png":{"__typename":"ImageMetadata","id":"1*-8PVjte6Kwo7RNpng83hTg.png"},"LinkedAccounts:c6ea1883b294":{"__typename":"LinkedAccounts","mastodon":null,"id":"c6ea1883b294"},"UserViewerEdge:userId:c6ea1883b294-viewerId:lo_7f7941ed61ce":{"__typename":"UserViewerEdge","id":"userId:c6ea1883b294-viewerId:lo_7f7941ed61ce","isFollowing":false,"isUser":false,"isMuting":false},"User:c6ea1883b294":{"__typename":"User","id":"c6ea1883b294","linkedAccounts":{"__ref":"LinkedAccounts:c6ea1883b294"},"isSuspended":false,"imageId":"1*odcvWd6mq9Gr0n_DDF2u_g.jpeg","mediumMemberAt":0,"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"name":"Jean","socialStats":{"__typename":"SocialStats","followerCount":36},"username":"jean_82568","customDomainState":null,"hasSubdomain":false,"bio":"Red Teamer \u002F Course Author \u002F Instructor","isPartnerProgramEnrolled":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:c6ea1883b294-viewerId:lo_7f7941ed61ce"},"viewerIsUser":false,"newsletterV3":null,"postSubscribeMembershipUpsellShownAt":0,"allowNotes":true,"membership":null,"twitterScreenName":""},"Paragraph:69c64e89e99e_0":{"__typename":"Paragraph","id":"69c64e89e99e_0","name":"df8d","type":"H3","href":null,"layout":null,"metadata":null,"text":"Journey into Windows Kernel Exploitation: The Basics","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*AgyETlODx9orsdwbgZHhOw.png":{"__typename":"ImageMetadata","id":"1*AgyETlODx9orsdwbgZHhOw.png","originalHeight":750,"originalWidth":1500,"focusPercentX":null,"focusPercentY":null,"alt":"“Journey into Windows Kernel Exploitation: The Basics” is the title, set above the author’s name, Jean-Francoise Maes, which is next to the Neuvik logo. A photo of the author is on the left."},"Paragraph:69c64e89e99e_1":{"__typename":"Paragraph","id":"69c64e89e99e_1","name":"eed8","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*AgyETlODx9orsdwbgZHhOw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_2":{"__typename":"Paragraph","id":"69c64e89e99e_2","name":"27de","type":"P","href":null,"layout":null,"metadata":null,"text":"This blogpost embarks on the initial stages of kernel exploitation. The content serves as an introduction, leading to an imminent and comprehensive whitepaper centered around this subject matter. Through this, a foundation is laid for understanding how kernel drivers are developed, as well as basic understanding around key concepts that will be instrumental to comprehending the paper itself.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*lOK_3N4qBrDcmiKlA9hjSw.jpeg":{"__typename":"ImageMetadata","id":"1*lOK_3N4qBrDcmiKlA9hjSw.jpeg","originalHeight":467,"originalWidth":534,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:69c64e89e99e_3":{"__typename":"Paragraph","id":"69c64e89e99e_3","name":"102d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*lOK_3N4qBrDcmiKlA9hjSw.jpeg"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_4":{"__typename":"Paragraph","id":"69c64e89e99e_4","name":"e6f3","type":"H3","href":null,"layout":null,"metadata":null,"text":"Relevance of the research","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_5":{"__typename":"Paragraph","id":"69c64e89e99e_5","name":"9ff3","type":"P","href":null,"layout":null,"metadata":null,"text":"Over the last few years, both offense and defense have made some advancements in the infosec space. With EDRs placing hooks in usermode, offensive tradecraft evolved from utilizing naïve (not a typo) WIN32 API calls to dynamic invocation to avoid Import Address Table entries to finally utilizing syscalls and indirect syscalls.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_6":{"__typename":"Paragraph","id":"69c64e89e99e_6","name":"41d6","type":"P","href":null,"layout":null,"metadata":null,"text":"Now that offensive tradecraft effectively caught up, more and more security products are stepping away from userland hooks and are focusing more on telemetry collected from ETW, such as the ETWti provider, which used to be only accessible by defender for endpoint (at least officially, for a while) and kernel callbacks.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_7":{"__typename":"Paragraph","id":"69c64e89e99e_7","name":"63af","type":"P","href":null,"layout":null,"metadata":null,"text":"This has forced offensive tradecraft to take a look at these technologies and how to neutralize them. This blogpost is by no means anything new; research in this field has been done years ago, with popular tools such as mimikatz’s driver, cheeky blinder, KDU, telemetry sourcerer, etc…","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":220,"end":237,"href":"https:\u002F\u002Fgithub.com\u002Fgentilkiwi\u002Fmimikatz","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":239,"end":253,"href":"https:\u002F\u002Fgithub.com\u002Fbr-sn\u002FCheekyBlinder","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":255,"end":258,"href":"https:\u002F\u002Fgithub.com\u002Fhfiref0x\u002FKDU","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":260,"end":279,"href":"https:\u002F\u002Fgithub.com\u002Fjthuraisamy\u002FTelemetrySourcerer","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_8":{"__typename":"Paragraph","id":"69c64e89e99e_8","name":"8f85","type":"P","href":null,"layout":null,"metadata":null,"text":"These tools have one thing in common though: they require a driver to be loaded, which can be problematic as loading unsigned drivers is no longer possible thanks to Microsoft’s driver signing enforcement policy which simply disallows unsigned drivers being loaded into the kernel space. Although some of the tools out there make use of signed drivers (like the mimikatz driver), there is a high chance that these known malicious drivers are signatured and will trigger alerts. This means another way to tamper with these protections or another way to load (unsigned) drivers is needed.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":166,"end":211,"href":"https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fwindows-hardware\u002Fdrivers\u002Finstall\u002Fkernel-mode-code-signing-policy--windows-vista-and-later-","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_9":{"__typename":"Paragraph","id":"69c64e89e99e_9","name":"e656","type":"P","href":null,"layout":null,"metadata":null,"text":"Relatively recently, there was a resurfacing of interesting research published which hooks specific functions in the signtool from Microsoft, allowing drivers getting signed by outdated certs to be recognized as legitimate. This avenue has been there for a while, but flew under the radar for a lot of people until it got abused by threat actors; however, this method lacks some finesse, as it still involves dropping an unknown (self-created) driver to disk, which could still get blocked because there is no reputation attached to it.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":48,"end":78,"href":"https:\u002F\u002Fblog.talosintelligence.com\u002Fold-certificate-new-signature\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_10":{"__typename":"Paragraph","id":"69c64e89e99e_10","name":"d281","type":"P","href":null,"layout":null,"metadata":null,"text":"Another approach is roaming publicly available cloud resources and\u002For git repositories in order to hunt for code signing certificates being leaked (typically in pfx format). Without much effort, it’s possible to find a variety of these pfx files, which can be brute-forced due to having a very weak password. This leads to an interesting Twitter debate considering the ethics around this approach.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":309,"end":397,"href":"https:\u002F\u002Ftwitter.com\u002Fcuri0usJack\u002Fstatus\u002F1681478069599469568","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_11":{"__typename":"Paragraph","id":"69c64e89e99e_11","name":"1bdc","type":"P","href":null,"layout":null,"metadata":null,"text":"The final approach, which will be the meat of the research paper and blogpost, is utilizing vulnerable drivers to do your bidding. Depending on the vulnerabilities found in the driver(s) on a system, there are a variety of things you can do:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_12":{"__typename":"Paragraph","id":"69c64e89e99e_12","name":"8a72","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Load unsigned drivers by effectively removing the driver signing enforcement","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_13":{"__typename":"Paragraph","id":"69c64e89e99e_13","name":"d8fb","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Remove or add PPL protections to processes","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_14":{"__typename":"Paragraph","id":"69c64e89e99e_14","name":"6955","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Remove kernel callback signals","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_15":{"__typename":"Paragraph","id":"69c64e89e99e_15","name":"042d","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Patch kernel functions such as NtTraceEvent","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_16":{"__typename":"Paragraph","id":"69c64e89e99e_16","name":"0150","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Neuter ETWti","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_17":{"__typename":"Paragraph","id":"69c64e89e99e_17","name":"7d00","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Load rootkits","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_18":{"__typename":"Paragraph","id":"69c64e89e99e_18","name":"0c21","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Etc…","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_19":{"__typename":"Paragraph","id":"69c64e89e99e_19","name":"ab7c","type":"P","href":null,"layout":null,"metadata":null,"text":"Drivers are still programs, developed by developers, who may or may not always be aware of secure coding principals. On top of that, kernel development is not a very straightforward feat.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_20":{"__typename":"Paragraph","id":"69c64e89e99e_20","name":"893e","type":"P","href":null,"layout":null,"metadata":null,"text":"This leads to vulnerabilities in various kernel drivers signed by reputable vendors. For a practical use case, I recommend checking out the KDU project on github; for a vulnerable driver list, I recommend the loldriver project.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":140,"end":151,"href":"https:\u002F\u002Fgithub.com\u002Fhfiref0x\u002FKDU","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":209,"end":218,"href":"https:\u002F\u002Fwww.loldrivers.io\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_21":{"__typename":"Paragraph","id":"69c64e89e99e_21","name":"0119","type":"H3","href":null,"layout":null,"metadata":null,"text":"User mode vs kernel mode in Windows","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_22":{"__typename":"Paragraph","id":"69c64e89e99e_22","name":"ea50","type":"P","href":null,"layout":null,"metadata":null,"text":"Without going to much off topic, it is worth understanding the difference between what is referred to as “user mode” vs what is referred to as “kernel mode”.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*MVK4MHAx5FVPvp2HYU9Dqg.png":{"__typename":"ImageMetadata","id":"1*MVK4MHAx5FVPvp2HYU9Dqg.png","originalHeight":338,"originalWidth":602,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:69c64e89e99e_23":{"__typename":"Paragraph","id":"69c64e89e99e_23","name":"35cf","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*MVK4MHAx5FVPvp2HYU9Dqg.png"},"text":"Figure 1: Userland and Kernel Land — Image coutsey of Pavel’s Windows Kernel Programming Book","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":37,"end":93,"href":"https:\u002F\u002Fleanpub.com\u002Fwindowskernelprogrammingsecondedition","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_24":{"__typename":"Paragraph","id":"69c64e89e99e_24","name":"ca0a","type":"P","href":null,"layout":null,"metadata":null,"text":"When you use your Windows computer, you are operating in “usermode”; this is true from both normal privileges as well as elevated (administrator) privileges. This mode is where regular programs — like games, web browsers, and music players — run. In this mode, programs have limited access to your computer’s resources and can’t do anything that might mess up the whole system. It’s like a (relatively) safe playground where you can have fun without worrying too much about causing serious damage. All processes running in usermode have their own virtual memory, which cannot be directly (= without a handle with appropriate permissions) accessed by other processes. To quote the official Microsoft Documentation:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_25":{"__typename":"Paragraph","id":"69c64e89e99e_25","name":"2cb8","type":"BQ","href":null,"layout":null,"metadata":null,"text":"· For a 32-bit process, the virtual address space is usually the 2-gigabyte range 0x00000000 through 0x7FFFFFFF.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":2,"end":112,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_26":{"__typename":"Paragraph","id":"69c64e89e99e_26","name":"fd72","type":"BQ","href":null,"layout":null,"metadata":null,"text":"· For a 64-bit process on 64-bit Windows, the virtual address space is the 128-terabyte range 0x000'00000000 through 0x7FFF’FFFFFFFF.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":2,"end":133,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_27":{"__typename":"Paragraph","id":"69c64e89e99e_27","name":"1e80","type":"P","href":null,"layout":null,"metadata":null,"text":"The virtual address space can be extended to 3-gigabyte with a switch, but the default and most commonly observed configuration is 2 gigs.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_28":{"__typename":"Paragraph","id":"69c64e89e99e_28","name":"c83a","type":"P","href":null,"layout":null,"metadata":null,"text":"In Windows the high memory of every process (0x80000000 or 0xc0000000) all the way to 0xFFFFFFFF Is reserved for kernel code, user code cannot access these regions of memory, if it tries so an access violation exception will be thrown.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*xGMdUZ5m-SymkrbFbndjGQ.png":{"__typename":"ImageMetadata","id":"1*xGMdUZ5m-SymkrbFbndjGQ.png","originalHeight":298,"originalWidth":637,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:69c64e89e99e_29":{"__typename":"Paragraph","id":"69c64e89e99e_29","name":"b4db","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*xGMdUZ5m-SymkrbFbndjGQ.png"},"text":"Figure 2: memory regions in Windows — Image Courtesy of Pavel’s Kernel Programming book","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":37,"end":87,"href":"https:\u002F\u002Fleanpub.com\u002Fwindowskernelprogrammingsecondedition","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_30":{"__typename":"Paragraph","id":"69c64e89e99e_30","name":"c5f9","type":"P","href":null,"layout":null,"metadata":null,"text":"This hypothesis can be tested quite easily. For example, by leveraging the EnumDeviceDrivers Windows API call to retrieve an array of base addresses of all device drivers currently loaded in the system.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_31":{"__typename":"Paragraph","id":"69c64e89e99e_31","name":"99a1","type":"P","href":null,"layout":null,"metadata":null,"text":"Another valuable alternative would be to check the loaded modules of the system process (ntoskrnl.exe) in Process Hacker2 or using a third-party program such as driverview. If the MSDN documententation is correct, all drivers should be loaded anywhere between 0x80000000 and 0xFFFFFFFF","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":161,"end":171,"href":"https:\u002F\u002Fwww.nirsoft.net\u002Futils\u002Fdriverview.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*SScnr1LPdkNXeRjdm_qZdQ.png":{"__typename":"ImageMetadata","id":"1*SScnr1LPdkNXeRjdm_qZdQ.png","originalHeight":186,"originalWidth":621,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:69c64e89e99e_32":{"__typename":"Paragraph","id":"69c64e89e99e_32","name":"7bc1","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*SScnr1LPdkNXeRjdm_qZdQ.png"},"text":"Figure 3: Driver base addresses extracted by Driverview","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_33":{"__typename":"Paragraph","id":"69c64e89e99e_33","name":"243d","type":"P","href":null,"layout":null,"metadata":null,"text":"Below is a small proof of concept that will attempt to read the magic header (MZ) value on these driver addresses, again, if MSDN documentation is correct this would result into access violations.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_34":{"__typename":"Paragraph","id":"69c64e89e99e_34","name":"4d2b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"#include \u003Ciostream\u003E\n#include \u003CWindows.h\u003E\n#include \u003Cpsapi.h\u003E\n\n#define DRIVER_ARRAY_SIZE 1024\n\nint main() {\n    DWORD cbNeeded = 0;\n    LPVOID drivers[DRIVER_ARRAY_SIZE] { nullptr };\n    DWORD numDrivers = 0;\n\n    \u002F\u002F Call EnumDeviceDrivers to get the array of driver base addresses\n    if (EnumDeviceDrivers(drivers, sizeof(drivers), &cbNeeded)) {\n        \u002F\u002F Calculate the number of drivers in the array\n        numDrivers = cbNeeded \u002F sizeof(LPVOID);\n\n        \u002F\u002F Iterate through the driver base addresses and print them\n        for (DWORD i = 0; i \u003C numDrivers; i++) {\n            TCHAR driverName[MAX_PATH] = TEXT(\"\");\n            if (GetDeviceDriverBaseName(drivers[i], driverName, MAX_PATH)) {\n                std::wcout \u003C\u003C \"Driver #\" \u003C\u003C i + 1 \u003C\u003C \" Base Address: \" \u003C\u003C drivers[i] \u003C\u003C std::endl;\n                std::wcout \u003C\u003C \"Driver Name: \" \u003C\u003C driverName \u003C\u003C std::endl;\n                std::wcout \u003C\u003C \"Attempting to Read the MZ bytes...\" \u003C\u003C std::endl;\n                char readBuffer[2] = {0};\n                size_t bytesRead = 0 ;\n                if (ReadProcessMemory((HANDLE)-1, drivers[i], &readBuffer, 2, &bytesRead))\n                {\n                    std::wcout \u003C\u003C \"It worked! here they are: \" \u003C\u003C readBuffer \u003C\u003C std::endl;\n                }\n                else\n                {\n                    std::cerr \u003C\u003C \"Could not read the MZ values: Error code: \" \u003C\u003C GetLastError() \u003C\u003C std::endl;\n                }\n                \u002F\u002Fcomment the next 3 lines of code out if you want the program to continue, just another way of reading without the RPM API call \n                \u002F\u002FUSHORT mz;\n                \u002F\u002Fmz = *(USHORT*)drivers[i];\n                \u002F\u002Fstd::wcout \u003C\u003C mz \u003C\u003C std::endl;\n            }\n        }\n    }\n    else {\n        \u002F\u002F EnumDeviceDrivers failed, print error message\n        std::cerr \u003C\u003C \"EnumDeviceDrivers failed with error code: \" \u003C\u003C GetLastError() \u003C\u003C std::endl;\n    }\n\n    return 0;\n} ","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"cpp"},"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_35":{"__typename":"Paragraph","id":"69c64e89e99e_35","name":"e09b","type":"P","href":null,"layout":null,"metadata":null,"text":"When this code runs, the executor should be greeted with an access violation. Let’s see if this is the case:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*U2Bkbpo6D_EvfO1XZhuaqg.png":{"__typename":"ImageMetadata","id":"1*U2Bkbpo6D_EvfO1XZhuaqg.png","originalHeight":278,"originalWidth":602,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:69c64e89e99e_36":{"__typename":"Paragraph","id":"69c64e89e99e_36","name":"95fe","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*U2Bkbpo6D_EvfO1XZhuaqg.png"},"text":"Figure 4: Exceptions when attempting to read kernel address from usermode","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_37":{"__typename":"Paragraph","id":"69c64e89e99e_37","name":"6dbb","type":"P","href":null,"layout":null,"metadata":null,"text":"Upon execution, an unhandled access violation exception is thrown when the code tries to dereference the pointer to the memory location of the first driver base address (this is expected, and inline with what MSDN documentation claims).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_38":{"__typename":"Paragraph","id":"69c64e89e99e_38","name":"58d4","type":"P","href":null,"layout":null,"metadata":null,"text":"If instead, the ReadProcessMemory API is used, error code 998 is thrown which according to the MSDN documentation means “Invalid Access to Memory Location”.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":16,"end":34,"href":"https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fwindows\u002Fwin32\u002Fapi\u002Fmemoryapi\u002Fnf-memoryapi-readprocessmemory","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_39":{"__typename":"Paragraph","id":"69c64e89e99e_39","name":"1db3","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s try the same exercise from kernel mode now.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_40":{"__typename":"Paragraph","id":"69c64e89e99e_40","name":"d0cd","type":"H3","href":null,"layout":null,"metadata":null,"text":"Drivers 101: Basics of kernel development","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_41":{"__typename":"Paragraph","id":"69c64e89e99e_41","name":"722f","type":"P","href":null,"layout":null,"metadata":null,"text":"If you want an excellent resource on how to start developing drivers, a reputable resource would be Pavel’s Windows Kernel Programming book. This book will obviously go a lot further than what this paper is going to touch upon, including setting up the actual environment to start developing kernel drivers in the first place, and how to debug them.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":100,"end":139,"href":"https:\u002F\u002Fleanpub.com\u002Fwindowskernelprogrammingsecondedition","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_42":{"__typename":"Paragraph","id":"69c64e89e99e_42","name":"76b9","type":"P","href":null,"layout":null,"metadata":null,"text":"The first thing you need to know is that, much like usermode applications, drivers need an entrypoint to start the initial code flow. In usermode, this is typically referred to as the main method of an application (or dllmain in case of a dll). In the kernel DriverEntry is going to be the entrypoint of a driver.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":184,"end":188,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":218,"end":225,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":259,"end":270,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*dvW4D0VxYWO1HibVlTnxcg.png":{"__typename":"ImageMetadata","id":"1*dvW4D0VxYWO1HibVlTnxcg.png","originalHeight":212,"originalWidth":602,"focusPercentX":-1,"focusPercentY":-1,"alt":""},"Paragraph:69c64e89e99e_43":{"__typename":"Paragraph","id":"69c64e89e99e_43","name":"e2b2","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*dvW4D0VxYWO1HibVlTnxcg.png"},"text":"Figure 5: DriverEntry prototype according to MSDN documentation","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_44":{"__typename":"Paragraph","id":"69c64e89e99e_44","name":"9ce0","type":"P","href":null,"layout":null,"metadata":null,"text":"A driver, in its bare minimum form, needs to have this function present, as well as an unload routine that would reverse all the effects the driver had on the system. Failure to have an unload routine can\u002Fwill cause a leak, which is not handled until the next reboot. This can lead to some nasty consequences.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_45":{"__typename":"Paragraph","id":"69c64e89e99e_45","name":"cfee","type":"P","href":null,"layout":null,"metadata":null,"text":"Here is code for a bare minimum driver, keeping in mind that the kernel does not have the C++ runtime. If you want to learn more about this, again, Pavel’s book is a goldmine.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_46":{"__typename":"Paragraph","id":"69c64e89e99e_46","name":"1c2d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"void Unload(_In_ PDRIVER_OBJECT DriverObject) {\n UNREFERENCED_PARAMETER(DriverObject);\n}\n\nextern \"C\"\nNTSTATUS\nDriverEntry(_In_ PDRIVER_OBJECT DriverObject, _In_ PUNICODE_STRING RegistryPath) {\n UNREFERENCED_PARAMETER(RegistryPath);\n DriverObject-\u003EDriverUnload = Unload;\n return STATUS_SUCCESS;\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"cpp"},"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_47":{"__typename":"Paragraph","id":"69c64e89e99e_47","name":"895b","type":"P","href":null,"layout":null,"metadata":null,"text":"Now obviously, this driver is not really very exciting, but a closer look should be taken at the parameters required by the DriverEntry function: specifically, the DriverObject.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_48":{"__typename":"Paragraph","id":"69c64e89e99e_48","name":"beff","type":"P","href":null,"layout":null,"metadata":null,"text":"The DriverObject is primarily responsible for calling the appropriate functions within the driver itself based on what the driver was in fact designed to do. In driver development, functionality is passed through “major functions” as long as none of these major functions are implemented, there is no real way to communicate with the driver from usermode. There are several major functions available to driver developers, you can find them in the MSDN documentation if you are interested.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":422,"end":451,"href":"https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fwindows-hardware\u002Fdrivers\u002Fkernel\u002Firp-major-function-codes","anchorType":"LINK","userId":"","linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_49":{"__typename":"Paragraph","id":"69c64e89e99e_49","name":"eec6","type":"P","href":null,"layout":null,"metadata":null,"text":"The most noteworthy major functions are summarized in Pavel’s book:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*lUyfzr-8apG2mxW4c14AWg.png":{"__typename":"ImageMetadata","id":"1*lUyfzr-8apG2mxW4c14AWg.png","originalHeight":300,"originalWidth":587,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:69c64e89e99e_50":{"__typename":"Paragraph","id":"69c64e89e99e_50","name":"72df","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*lUyfzr-8apG2mxW4c14AWg.png"},"text":"Figure 6: Most used major functions — Image Courtesy of Pavel’s Kernel Programming book","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":38,"end":87,"href":"https:\u002F\u002Fleanpub.com\u002Fwindowskernelprogrammingsecondedition","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_51":{"__typename":"Paragraph","id":"69c64e89e99e_51","name":"72f8","type":"P","href":null,"layout":null,"metadata":null,"text":"In order to receive instructions from usermode, a driver needs to create a device object and create a symbolic link to the object so that we can obtain a handle to it from usermode. This is typically done using the IoCreateDevice and IoCreateSymbolicLink API calls. Which instructions usermode can send to the kernel will depend on which major functions are implemented on the kernel side.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":215,"end":229,"href":"https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fwindows-hardware\u002Fdrivers\u002Fddi\u002Fwdm\u002Fnf-wdm-iocreatedevice","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":234,"end":255,"href":"https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fwindows-hardware\u002Fdrivers\u002Fddi\u002Fwdm\u002Fnf-wdm-iocreatesymboliclink","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_52":{"__typename":"Paragraph","id":"69c64e89e99e_52","name":"13ca","type":"P","href":null,"layout":null,"metadata":null,"text":"It is best practice to use the major read (IRP_MJ_READ) and write (IRP_MJ_WRITE) functions for “pure” read and write functionality. When “more” has to be done, the best practice dictate to use the device control major function (IRP_MJ_DEVICE_CONTROL).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_53":{"__typename":"Paragraph","id":"69c64e89e99e_53","name":"6465","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s take it step by step and start from just using the IRP_MJ_READ function for now.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_54":{"__typename":"Paragraph","id":"69c64e89e99e_54","name":"e672","type":"P","href":null,"layout":null,"metadata":null,"text":"In this minimalistic proof of concept, the bare minimum driver and usermode implementation to get back the base address and DOS header of our own kernel driver is showcased. As a reminder, kernel drivers do not have access to usermode API calls (and therefore finding the base address of a kernel driver is not as straightforward as one might think, but that’s not really the topic of this blog).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_55":{"__typename":"Paragraph","id":"69c64e89e99e_55","name":"61f0","type":"P","href":null,"layout":null,"metadata":null,"text":"Driver code:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_56":{"__typename":"Paragraph","id":"69c64e89e99e_56","name":"6df4","type":"PRE","href":null,"layout":null,"metadata":null,"text":"#include \u003Cntddk.h\u003E\n\u002F\u002Fif you wanna learn more about driver IO modes, buffered,direct,neither, I recommend https:\u002F\u002Fwww.codeproject.com\u002FArticles\u002F9575\u002FDriver-Development-Part-2-Introduction-to-Implemen\n\u002F\u002Fanother good resource for kernel base address finding: https:\u002F\u002Fm0uk4.gitbook.io\u002Fnotebooks\u002Fmouka\u002Fwindowsinternal\u002Ffind-kernel-module-address-todo#method-3-through-driver-name\ntypedef unsigned short WORD;\ntypedef struct _IMAGE_DOS_HEADER\n{\n WORD e_magic;\n WORD e_cblp;\n WORD e_cp;\n WORD e_crlc;\n WORD e_cparhdr;\n WORD e_minalloc;\n WORD e_maxalloc;\n WORD e_ss;\n WORD e_sp;\n WORD e_csum;\n WORD e_ip;\n WORD e_cs;\n WORD e_lfarlc;\n WORD e_ovno;\n WORD e_res[4];\n WORD e_oemid;\n WORD e_oeminfo;\n WORD e_res2[10];\n LONG e_lfanew;\n} IMAGE_DOS_HEADER, * PIMAGE_DOS_HEADER;\n \ntypedef struct _DRIVER_INFO {\n IMAGE_DOS_HEADER DosHeader;\n PVOID EntryPointAddress;\n} DRIVER_INFO, * PDRIVER_INFO;\n \ntypedef enum _SYSTEM_INFORMATION_CLASS {\n SystemBasicInformation,\n SystemProcessorInformation,\n SystemPerformanceInformation,\n SystemTimeOfDayInformation,\n SystemPathInformation,\n SystemProcessInformation,\n SystemCallCountInformation,\n SystemDeviceInformation,\n SystemProcessorPerformanceInformation,\n SystemFlagsInformation,\n SystemCallTimeInformation,\n SystemModuleInformation,\n SystemLocksInformation,\n SystemStackTraceInformation,\n SystemPagedPoolInformation,\n SystemNonPagedPoolInformation,\n SystemHandleInformation,\n SystemObjectInformation,\n SystemPageFileInformation,\n SystemVdmInstemulInformation,\n SystemVdmBopInformation,\n SystemFileCacheInformation,\n SystemPoolTagInformation,\n SystemInterruptInformation,\n SystemDpcBehaviorInformation,\n SystemFullMemoryInformation,\n SystemLoadGdiDriverInformation,\n SystemUnloadGdiDriverInformation,\n SystemTimeAdjustmentInformation,\n SystemSummaryMemoryInformation,\n SystemNextEventIdInformation,\n SystemEventIdsInformation,\n SystemCrashDumpInformation,\n SystemExceptionInformation,\n SystemCrashDumpStateInformation,\n SystemKernelDebuggerInformation,\n SystemContextSwitchInformation,\n SystemRegistryQuotaInformation,\n SystemExtendServiceTableInformation,\n SystemPrioritySeperation,\n SystemPlugPlayBusInformation,\n SystemDockInformation,\n SystemProcessorSpeedInformation,\n SystemCurrentTimeZoneInformation,\n SystemLookasideInformation\n} SYSTEM_INFORMATION_CLASS, * PSYSTEM_INFORMATION_CLASS;\n \ntypedef struct _SYSTEM_MODULE_ENTRY\n{\n HANDLE Section;\n PVOID MappedBase;\n PVOID ImageBase;\n ULONG ImageSize;\n ULONG Flags;\n USHORT LoadOrderIndex;\n USHORT InitOrderIndex;\n USHORT LoadCount;\n USHORT OffsetToFileName;\n UCHAR FullPathName[256];\n} SYSTEM_MODULE_ENTRY, * PSYSTEM_MODULE_ENTRY;\n \ntypedef struct _SYSTEM_MODULE_INFORMATION\n{\n ULONG Count;\n SYSTEM_MODULE_ENTRY Module[1];\n} SYSTEM_MODULE_INFORMATION, * PSYSTEM_MODULE_INFORMATION;\n \n \nvoid Unload(_In_ PDRIVER_OBJECT DriverObject);\nNTSTATUS CreateClose(_In_ PDEVICE_OBJECT DeviceObject, _Inout_ PIRP Irp);\nNTSTATUS CompleteIrp(_Inout_ PIRP Irp, _Inout_ NTSTATUS status, _In_ ULONG_PTR info);\nNTSTATUS ReadBuffer(_In_ PDEVICE_OBJECT DeviceObject, _Inout_ PIRP Irp);\n \n \n \n \nextern \"C\"\n{\n extern POBJECT_TYPE* IoDriverObjectType;\n NTSTATUS NTSYSAPI NTAPI ObReferenceObjectByName(_In_ PUNICODE_STRING ObjectPath,_In_ ULONG Attributes,_In_ PACCESS_STATE PassedAccessState,_In_ ACCESS_MASK DesiredAccess,_In_ POBJECT_TYPE ObjectType,_In_ KPROCESSOR_MODE AccessMode,_Inout_ PVOID ParseContext,_Out_ PVOID* ObjectPtr);\n NTSTATUS DriverEntry(_In_ PDRIVER_OBJECT DriverObject, _In_ PUNICODE_STRING RegistryPath) {\n  UNREFERENCED_PARAMETER(RegistryPath);\n  \u002F\u002Fcreate the device object\n  UNICODE_STRING devName = RTL_CONSTANT_STRING(L\"\\\\Device\\\\ReadMeDriver\");\n  PDEVICE_OBJECT DeviceObject = NULL;\n  NTSTATUS status = IoCreateDevice(DriverObject, 0, &devName, FILE_DEVICE_UNKNOWN, 0, FALSE, &DeviceObject);\n  if (!NT_SUCCESS(status)) {\n   KdPrint((\"Failed to create device object (0x%08X)\\n\", status));\n   return status;\n  }\n \n  \u002F\u002Fmake it available in usermode\n  UNICODE_STRING symLink = RTL_CONSTANT_STRING(L\"\\\\??\\\\ReadDriver\");\n  status = IoCreateSymbolicLink(&symLink, &devName);\n  if (!NT_SUCCESS(status)) {\n   KdPrint((\"Failed to create symbolic link (0x%08X)\\n\", status));\n   IoDeleteDevice(DeviceObject);\n   return status;\n  }\n \n  \u002F\u002FBuffered IO is simplest here, as Usermode and kernelmode are using same buffer\n  DeviceObject-\u003EFlags |= DO_BUFFERED_IO;\n \n  \u002F\u002Fmajor functions \n  DriverObject-\u003EDriverUnload = Unload;\n  DriverObject-\u003EMajorFunction[IRP_MJ_CREATE] = CreateClose;\n  DriverObject-\u003EMajorFunction[IRP_MJ_CLOSE] = CreateClose;\n  DriverObject-\u003EMajorFunction[IRP_MJ_READ] = ReadBuffer;\n  return STATUS_SUCCESS;\n }\n}\n \n_Use_decl_annotations_\nVOID Unload(_In_ PDRIVER_OBJECT DriverObject) {\n UNICODE_STRING symLink = RTL_CONSTANT_STRING(L\"\\\\??\\\\ReadDriver\");\n \u002F\u002F delete symbolic link\n IoDeleteSymbolicLink(&symLink);\n \u002F\u002F delete device object\n IoDeleteDevice(DriverObject-\u003EDeviceObject);\n}\n\n_Use_decl_annotations_\nNTSTATUS CompleteIrp(PIRP Irp, NTSTATUS status = STATUS_SUCCESS, ULONG_PTR info = 0) {\n Irp-\u003EIoStatus.Status = status;\n Irp-\u003EIoStatus.Information = info;\n IoCompleteRequest(Irp, IO_NO_INCREMENT);\n return status;\n}\n\n_Use_decl_annotations_\nNTSTATUS CreateClose(PDEVICE_OBJECT DeviceObject, PIRP Irp)\n{\n UNREFERENCED_PARAMETER(DeviceObject);\n return CompleteIrp(Irp);\n}\n \n \nPVOID GetDriverBaseAddress()\n{\n UNICODE_STRING targetDeviceName;\n NTSTATUS status = STATUS_UNSUCCESSFUL;\n PDRIVER_OBJECT pKbdDriverObject = NULL;\n \n RtlInitUnicodeString(&targetDeviceName, L\"\\\\Driver\\\\ReadMeDriver\");\n \u002F\u002F Try to get the target device object\n status = ObReferenceObjectByName(&targetDeviceName, OBJ_CASE_INSENSITIVE, NULL, 0, *IoDriverObjectType, KernelMode, NULL, (PVOID*)&pKbdDriverObject);\n KdPrint((\"READDRV: STATUS: 0x%08X\\n\", status));\n if (!NT_SUCCESS(status))\n {\n  return nullptr;\n }\n KdPrint((\"READDRV: OBJ FOUND\\n\"));\n \u002F\u002FDbgPrint(\"DriverObject Attributes:\\n\");\n \u002F\u002FDbgPrint(\"  DriverStart: 0x%p\\n\", pKbdDriverObject-\u003EDriverStart);\n \u002F\u002FDbgPrint(\"  DriverSize: 0x%x\\n\", pKbdDriverObject-\u003EDriverSize);\n \u002F\u002FDbgPrint(\"  DriverSection: 0x%p\\n\", pKbdDriverObject-\u003EDriverSection);\n PVOID baseAddress = pKbdDriverObject-\u003EDriverStart;\n ObDereferenceObject(pKbdDriverObject);\n return baseAddress;\n \n}\n \n_Use_decl_annotations_\nNTSTATUS ReadBuffer(PDEVICE_OBJECT DeviceObject, PIRP Irp)\n{\n UNREFERENCED_PARAMETER(DeviceObject);\n auto status = STATUS_SUCCESS;\n auto stack = IoGetCurrentIrpStackLocation(Irp);\n auto len = stack-\u003EParameters.Read.Length;\n auto buffer = Irp-\u003EAssociatedIrp.SystemBuffer;\n if (len \u003C sizeof(DRIVER_INFO))\n  return CompleteIrp(Irp, STATUS_INVALID_BUFFER_SIZE);\n if (!buffer)\n  return CompleteIrp(Irp, STATUS_INSUFFICIENT_RESOURCES);\n \n PDRIVER_INFO driverInfo = (PDRIVER_INFO)buffer;\n PVOID baseAddress = GetDriverBaseAddress();\n RtlCopyMemory(&(driverInfo-\u003EDosHeader), baseAddress, sizeof(IMAGE_DOS_HEADER));\n driverInfo-\u003EEntryPointAddress = baseAddress;\n DbgPrint(\" READDRV:  BaseAddr: 0x%p\\n\", baseAddress);\n DbgPrint(\" READDRV:  DOS_MAGIC: 0x%X \\n\", driverInfo-\u003EDosHeader.e_magic);\n return CompleteIrp(Irp, status, sizeof(DRIVER_INFO));\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"cpp"},"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_57":{"__typename":"Paragraph","id":"69c64e89e99e_57","name":"f3ec","type":"P","href":null,"layout":null,"metadata":null,"text":"Corresponding usermode application:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":35,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_58":{"__typename":"Paragraph","id":"69c64e89e99e_58","name":"2b75","type":"PRE","href":null,"layout":null,"metadata":null,"text":"#include \u003CWindows.h\u003E\n#include \u003Ciostream\u003E\n\ntypedef struct _DRIVER_INFO {\n IMAGE_DOS_HEADER DosHeader;\n PVOID EntryPointAddress;\n} DRIVER_INFO, * PDRIVER_INFO;\n\n\nint Error(const char* msg) {\n printf(\"%s: error=%u\\n\", msg, ::GetLastError());\n return 1;\n}\n\nint main()\n{\n HANDLE hDevice = CreateFile(L\"\\\\\\\\.\\\\ReadDriver\", GENERIC_READ,0, nullptr, OPEN_EXISTING, 0, nullptr);\n if (hDevice == INVALID_HANDLE_VALUE) {\n   return Error(\"Failed to open device\");\n }\n\n \u002F\u002FBYTE buffer[sizeof DRIVER_INFO] = {0};\n DRIVER_INFO driverInfo = {0};\n DWORD bytes = 0 ;\n BOOL ok = ReadFile(hDevice, &driverInfo, sizeof(DRIVER_INFO), &bytes, nullptr);\n if (!ok)\n  return Error(\"failed to read\");\n if (bytes != sizeof(DRIVER_INFO))\n  printf(\"Wrong number of bytes\\n\");\n\n printf(\"Driver Base Address 0x%p\\n\",driverInfo.EntryPointAddress);\n printf(\"Magic MZ value in hex (expecting 0x5A4D (MZ)): 0x%X\\n\", driverInfo.DosHeader.e_magic);\n return 0;\n \n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"cpp"},"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_59":{"__typename":"Paragraph","id":"69c64e89e99e_59","name":"64fc","type":"P","href":null,"layout":null,"metadata":null,"text":"Unsurprisingly after creating a service for the kernel driver and starting it and running the usermode application to interface with the driver, we get the expected loaded address of the driver alongside with the expected magic byte value — indicating that, indeed, kernel drivers can of course access kernel space addresses.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*IoqJDQe0aMotF7fwQlj09Q.png":{"__typename":"ImageMetadata","id":"1*IoqJDQe0aMotF7fwQlj09Q.png","originalHeight":200,"originalWidth":602,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:69c64e89e99e_60":{"__typename":"Paragraph","id":"69c64e89e99e_60","name":"139c","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*IoqJDQe0aMotF7fwQlj09Q.png"},"text":"Figure 7: Reading from Kernel land passing it back to userland","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_61":{"__typename":"Paragraph","id":"69c64e89e99e_61","name":"ae8b","type":"H3","href":null,"layout":null,"metadata":null,"text":"Drivers 201: IOCTL codes","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_62":{"__typename":"Paragraph","id":"69c64e89e99e_62","name":"34d5","type":"P","href":null,"layout":null,"metadata":null,"text":"Now that there is a basic understanding of major functions, particularly the read function, it should become clear that the read function does just that: read. As a user, you do not get to give the kernel driver any other instructions other than “please perform whatever the developer has implemented as the major read function.”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_63":{"__typename":"Paragraph","id":"69c64e89e99e_63","name":"01e3","type":"P","href":null,"layout":null,"metadata":null,"text":"In order for users to get to pass more data to the driver, and thus get more freedom (not just read, but also write or even combinations of the two), there is the concept of IO control functions.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_64":{"__typename":"Paragraph","id":"69c64e89e99e_64","name":"41fc","type":"P","href":null,"layout":null,"metadata":null,"text":"This time the usermode application is not simply calling the ReadFile api call but instead is using an API call called DeviceIoControl. This API call sends a specific “control code” to the driver, which, in case the control code is implemented, is going to perform a specific operation.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":61,"end":70,"href":"https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fwindows\u002Fwin32\u002Fapi\u002Ffileapi\u002Fnf-fileapi-readfile","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":119,"end":134,"href":"https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fwindows\u002Fwin32\u002Fapi\u002Fioapiset\u002Fnf-ioapiset-deviceiocontrol","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*jF0QIdM8qDCy6OTSp8whqQ.png":{"__typename":"ImageMetadata","id":"1*jF0QIdM8qDCy6OTSp8whqQ.png","originalHeight":306,"originalWidth":602,"focusPercentX":-1,"focusPercentY":-1,"alt":""},"Paragraph:69c64e89e99e_65":{"__typename":"Paragraph","id":"69c64e89e99e_65","name":"ad0c","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*jF0QIdM8qDCy6OTSp8whqQ.png"},"text":"Figure 8: DeviceIoControl function prototype according to MSDN documentation","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_66":{"__typename":"Paragraph","id":"69c64e89e99e_66","name":"334e","type":"P","href":null,"layout":null,"metadata":null,"text":"In order to fully understand these functions, a macro needs to be discussed that is accessible for kernel developers. This macro is designed to make sense of control codes so there is somewhat of a logic to it. This is crucial to understand, as this will form the basis of IOCTL fuzzing which will be covered in the research paper.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":211,"end":331,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_67":{"__typename":"Paragraph","id":"69c64e89e99e_67","name":"ba75","type":"PRE","href":null,"layout":null,"metadata":null,"text":"#define CTL_CODE( DeviceType, Function, Method, Access ) \n(((DeviceType) \u003C\u003C 16) | ((Access) \u003C\u003C 14) | ((Function) \u003C\u003C 2) | (Method) \\","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"cpp"},"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_68":{"__typename":"Paragraph","id":"69c64e89e99e_68","name":"82bb","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s attempt to break down the macro, as this is going to help understand IOCTL fuzzing later on in this paper.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_69":{"__typename":"Paragraph","id":"69c64e89e99e_69","name":"b879","type":"P","href":null,"layout":null,"metadata":null,"text":"The first parameter is device type, this can be one of the devices that have already been defined by Microsoft such as a keyboard or a mouse, but it could also be software based types such as a mailslot or a named pipe. According to msdn documentation values of less than 0x8000 are reserved by Microsoft.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":48,"end":110,"href":"https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fwindows-hardware\u002Fdrivers\u002Fkernel\u002Fspecifying-device-types","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":4,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":252,"end":305,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_70":{"__typename":"Paragraph","id":"69c64e89e99e_70","name":"92ee","type":"P","href":null,"layout":null,"metadata":null,"text":"The second parameter is the function, this is the identifier of the function that needs to be resolved by the kernel (this is going to be the bit that makes this IOCTL code unique, because there is a possibility all other bits might be the same). According to msdn documentation, Values of less than 0x800 are reserved by Microsoft.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":4,"end":10,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":280,"end":331,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_71":{"__typename":"Paragraph","id":"69c64e89e99e_71","name":"859b","type":"P","href":null,"layout":null,"metadata":null,"text":"The third parameter is the Transfertype, this is going to determine how data is passed to and from the driver. The options are:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":4,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_72":{"__typename":"Paragraph","id":"69c64e89e99e_72","name":"3621","type":"ULI","href":null,"layout":null,"metadata":null,"text":"METHOD_BUFFERED","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_73":{"__typename":"Paragraph","id":"69c64e89e99e_73","name":"50f6","type":"ULI","href":null,"layout":null,"metadata":null,"text":"METHOD_IN_DIRECT \u002F METHOD_OUT_DIRECT","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_74":{"__typename":"Paragraph","id":"69c64e89e99e_74","name":"5f24","type":"ULI","href":null,"layout":null,"metadata":null,"text":"METHOD_NEITHER","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_75":{"__typename":"Paragraph","id":"69c64e89e99e_75","name":"45f5","type":"P","href":null,"layout":null,"metadata":null,"text":"It’s recommended to read the msdn documentation and\u002For Pavel’s book for a detailed description of how this works.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":20,"end":33,"href":"https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fwindows-hardware\u002Fdrivers\u002Fkernel\u002Fbuffer-descriptions-for-i-o-control-codes","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_76":{"__typename":"Paragraph","id":"69c64e89e99e_76","name":"50b0","type":"P","href":null,"layout":null,"metadata":null,"text":"It is important to note that according to the msdn documentation:\nMETHOD_BUFFERED is the primary transfer type method for intermediate drivers (which will typically be the drivers that are interesting for attacks).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":66,"end":143,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_77":{"__typename":"Paragraph","id":"69c64e89e99e_77","name":"5dfa","type":"P","href":null,"layout":null,"metadata":null,"text":"From a high level point of view, buffered means that input and output buffers are the same, whereas DirectIO has two distinct buffers:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_78":{"__typename":"Paragraph","id":"69c64e89e99e_78","name":"3783","type":"ULI","href":null,"layout":null,"metadata":null,"text":"the Irp-\u003EAssociatedIrp.SystemBuffer as input buffer","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_79":{"__typename":"Paragraph","id":"69c64e89e99e_79","name":"b3ab","type":"ULI","href":null,"layout":null,"metadata":null,"text":"the Irp-\u003EMdlAddress that can be used as additional input buffer or output buffer.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_80":{"__typename":"Paragraph","id":"69c64e89e99e_80","name":"b686","type":"P","href":null,"layout":null,"metadata":null,"text":"Lastly is the FileAccess parameter your options are:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_81":{"__typename":"Paragraph","id":"69c64e89e99e_81","name":"5512","type":"ULI","href":null,"layout":null,"metadata":null,"text":"FILE_READ","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_82":{"__typename":"Paragraph","id":"69c64e89e99e_82","name":"db50","type":"ULI","href":null,"layout":null,"metadata":null,"text":"FILE_WRITE","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_83":{"__typename":"Paragraph","id":"69c64e89e99e_83","name":"a6b6","type":"ULI","href":null,"layout":null,"metadata":null,"text":"ANY","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_84":{"__typename":"Paragraph","id":"69c64e89e99e_84","name":"404a","type":"P","href":null,"layout":null,"metadata":null,"text":"Most kernel drivers use the ANY file access to make sure that any usermode application would not break in case the kernel driver gets new functionalities that suddenly are going to be using Read Write primitives.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_85":{"__typename":"Paragraph","id":"69c64e89e99e_85","name":"f0b2","type":"P","href":null,"layout":null,"metadata":null,"text":"To the astute reader of this section, one can deduce that there is a high probability that custom IOCTL codes are going to be in the 0x8000 range for the device, 0x800 range for the function and then have 0 (METHOD_BUFFERED) and then have another 0 (FILE_ANY_ACCESS), if we take the bit shifting into account that would mean custom IOCTL codes are typically going to be found in the range of","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_86":{"__typename":"Paragraph","id":"69c64e89e99e_86","name":"c564","type":"P","href":null,"layout":null,"metadata":null,"text":"0x80012004 (CTL_CODE(0x8001,0x801,0,0))","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":10,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_87":{"__typename":"Paragraph","id":"69c64e89e99e_87","name":"c5b3","type":"P","href":null,"layout":null,"metadata":null,"text":"and","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_88":{"__typename":"Paragraph","id":"69c64e89e99e_88","name":"e1b1","type":"P","href":null,"layout":null,"metadata":null,"text":"0x89992264(CTL_CODE(0x8999,0x899,0,0))","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":10,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_89":{"__typename":"Paragraph","id":"69c64e89e99e_89","name":"2aa7","type":"P","href":null,"layout":null,"metadata":null,"text":"To further strengthen the concept of IOCTL codes, a PoC can be found bleow that implements an IOCTL code with METHOD_BUFFERED and FILE_ANY_ACCESS access which accepts a structure from usermode that was inspired by a popular vulnerability in the MSI RTCORE64.SYS driver.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_90":{"__typename":"Paragraph","id":"69c64e89e99e_90","name":"50a3","type":"P","href":null,"layout":null,"metadata":null,"text":"Driver code:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_91":{"__typename":"Paragraph","id":"69c64e89e99e_91","name":"81c4","type":"PRE","href":null,"layout":null,"metadata":null,"text":"#include \u003Cntddk.h\u003E\n\n#define ReadDriverCode 0x8069\n#define IOCTL_ReadDriverMemory CTL_CODE(ReadDriverCode,0x869,METHOD_BUFFERED,FILE_ANY_ACCESS)\n\ntypedef unsigned short WORD;\ntypedef unsigned char BYTE;\ntypedef ULONGLONG DWORD64;\ntypedef ULONG DWORD;\n\n\u002F\u002Finspired by MSI RTCORE64.sys vuln\ntypedef struct _MEMORY_READ {\n BYTE Pad0[8];\n DWORD64 Address;\n BYTE Pad1[8];\n DWORD ReadSize;\n DWORD Value;\n BYTE Pad3[16];\n}MEMORY_READ, * PMEMORY_READ;\n\nvoid Unload(_In_ PDRIVER_OBJECT DriverObject);\nNTSTATUS CreateClose(_In_ PDEVICE_OBJECT DeviceObject, _Inout_ PIRP Irp);\nNTSTATUS CompleteIrp(_InOut_ PIRP Irp, _InOut_ NTSTATUS status, _In_ ULONG_PTR info);\nNTSTATUS ReadNotimplemented(_In_ PDEVICE_OBJECT DeviceObject, _Inout_ PIRP Irp);\nNTSTATUS ReadKernelMemory(_In_ PDEVICE_OBJECT DeviceObject, _Inout_ PIRP Irp);\n\n\n\n\nextern \"C\"\n{\n  NTSTATUS DriverEntry(_In_ PDRIVER_OBJECT DriverObject, _In_ PUNICODE_STRING RegistryPath) {\n  UNREFERENCED_PARAMETER(RegistryPath);\n  \u002F\u002Fcreate the device object\n  UNICODE_STRING devName = RTL_CONSTANT_STRING(L\"\\\\Device\\\\ReadDriverIOCTL\");\n  PDEVICE_OBJECT DeviceObject = NULL;\n  NTSTATUS status = IoCreateDevice(DriverObject, 0, &devName, FILE_DEVICE_UNKNOWN, 0, FALSE, &DeviceObject);\n  if (!NT_SUCCESS(status)) {\n   KdPrint((\"Failed to create device object (0x%08X)\\n\", status));\n   return status;\n  }\n\n  \u002F\u002Fmake it available in usermode\n  UNICODE_STRING symLink = RTL_CONSTANT_STRING(L\"\\\\??\\\\ReadDriverIOCTL\");\n  status = IoCreateSymbolicLink(&symLink, &devName);\n  if (!NT_SUCCESS(status)) {\n   KdPrint((\"Failed to create symbolic link (0x%08X)\\n\", status));\n   IoDeleteDevice(DeviceObject);\n   return status;\n  }\n\n  \u002F\u002FBuffered IO is simplest here, as Usermode and kernelmode are using same buffer\n  DeviceObject-\u003EFlags |= DO_BUFFERED_IO;\n\n  \u002F\u002Fmajor functions \n  DriverObject-\u003EDriverUnload = Unload;\n  DriverObject-\u003EMajorFunction[IRP_MJ_CREATE] = CreateClose;\n  DriverObject-\u003EMajorFunction[IRP_MJ_CLOSE] = CreateClose;\n  DriverObject-\u003EMajorFunction[IRP_MJ_READ] = ReadNotimplemented;\n  DriverObject-\u003EMajorFunction[IRP_MJ_DEVICE_CONTROL] = ReadKernelMemory;\n  return STATUS_SUCCESS;\n }\n}\n\n_Use_decl_annotations_\nNTSTATUS CompleteIrp(PIRP Irp, NTSTATUS status = STATUS_SUCCESS, ULONG_PTR info = 0) {\n Irp-\u003EIoStatus.Status = status;\n Irp-\u003EIoStatus.Information = info;\n IoCompleteRequest(Irp, IO_NO_INCREMENT);\n return status;\n}\n\n_Use_decl_annotations_\nNTSTATUS ReadNotimplemented(PDEVICE_OBJECT DeviceObject, PIRP Irp)\n{\n UNREFERENCED_PARAMETER(DeviceObject);\n KdPrint((\"IRP_MJ_READ is not implemented in this driver, use IOCTL instead\\n\"));\n return CompleteIrp(Irp);\n}\n\n_Use_decl_annotations_\nNTSTATUS ReadKernelMemory(PDEVICE_OBJECT DeviceObject, PIRP Irp)\n{\n UNREFERENCED_PARAMETER(DeviceObject);\n auto stack = IoGetCurrentIrpStackLocation(Irp);\n auto ctlcode = stack-\u003EParameters.DeviceIoControl;\n NTSTATUS status = STATUS_INVALID_DEVICE_REQUEST;\n ULONG_PTR totalWritten = 0;\n switch (ctlcode.IoControlCode)\n {\n  case IOCTL_ReadDriverMemory:\n  {\n   if (ctlcode.OutputBufferLength \u003C sizeof(MEMORY_READ)) {\n    KdPrint((\"IOCTLDRV: buffer does not seem to be correct length.\\n\"));\n    status = STATUS_BUFFER_TOO_SMALL;\n    break;\n   }\n   auto buffer = Irp-\u003EAssociatedIrp.SystemBuffer;\n   if (buffer == nullptr) {\n    KdPrint((\"IOCTLDRV: buffer does not seem to point to anything.\\n\"));\n    status = STATUS_INVALID_PARAMETER;\n    break;\n   }\n\n   PMEMORY_READ memread = (PMEMORY_READ)buffer;\n   KdPrint((\"IOCTLDRV: IOCTL ReadDriverMemory Called Successfully \\nMemread Struct:\\n\"));\n   KdPrint((\"IOCTLDRV: memread Address: 0x%X  \\n\", memread-\u003EAddress));\n   KdPrint((\"IOCTLDRV: memread Size: %d \\n\", memread-\u003EReadSize));\n   RtlCopyMemory(&(memread-\u003EValue), (void*)memread-\u003EAddress, memread-\u003EReadSize);\n   KdPrint((\"IOCTLDRV: memread Value: 0x%X \\n\", memread-\u003EValue));\n   status = STATUS_SUCCESS;\n   totalWritten = sizeof(MEMORY_READ);\n   KdPrint((\"IOCTLDRV: struct value to return: Value: %llu \\n\", sizeof(totalWritten)));\n   break;\n  }\n }\n return CompleteIrp(Irp, status,totalWritten);\n}\n\n_Use_decl_annotations_\nvoid Unload(PDRIVER_OBJECT DriverObject) {\n UNICODE_STRING symLink = RTL_CONSTANT_STRING(L\"\\\\??\\\\ReadDriverIOCTL\");\n \u002F\u002F delete symbolic link\n IoDeleteSymbolicLink(&symLink);\n \u002F\u002F delete device object\n IoDeleteDevice(DriverObject-\u003EDeviceObject);\n}\n\n\n_Use_decl_annotations_\nNTSTATUS CreateClose(PDEVICE_OBJECT DeviceObject, PIRP Irp)\n{\n UNREFERENCED_PARAMETER(DeviceObject);\n return CompleteIrp(Irp);\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"cpp"},"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_92":{"__typename":"Paragraph","id":"69c64e89e99e_92","name":"5793","type":"P","href":null,"layout":null,"metadata":null,"text":"Corresponding user application","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":30,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_93":{"__typename":"Paragraph","id":"69c64e89e99e_93","name":"3e6c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"#include \u003CWindows.h\u003E\n#include \u003Ciostream\u003E\n#include \u003Ciomanip\u003E\n#include \u003Cstring\u003E\n\n\n#define ReadDriverCode 0x8069\n#define IOCTL_ReadDriverMemory CTL_CODE(ReadDriverCode,0x869,METHOD_BUFFERED,FILE_ANY_ACCESS)\n\n\u002F\u002Finspired by MSI RTCORE64.sys vuln\ntypedef struct _MEMORY_READ {\n BYTE Pad0[8];\n DWORD64 Address;\n BYTE Pad1[8];\n DWORD ReadSize;\n DWORD Value;\n BYTE Pad3[16];\n}MEMORY_READ, * PMEMORY_READ;\n\n\nint Error(const char* msg) {\n printf(\"%s: error=%u\\n\", msg, ::GetLastError());\n return 1;\n}\n\nint main()\n{\n HANDLE hDevice = CreateFile(L\"\\\\\\\\.\\\\ReadDriverIOCTL\", GENERIC_READ | GENERIC_WRITE, 0, nullptr, OPEN_EXISTING, 0, nullptr);\n if (hDevice == INVALID_HANDLE_VALUE) {\n  return Error(\"Failed to open device\");\n }\n MEMORY_READ memread{ 0 };\n while (true)\n {\n        std::string addressStr;\n\n        std::cout \u003C\u003C \"Enter an address - you WILL bugcheck if its not a valid start of a kernel address! (or press Ctrl+C to exit): \";\n        std::getline(std::cin, addressStr);\n        LPVOID address = nullptr;\n\n        try\n        {\n            size_t startPos = 0;\n            if (addressStr.length() \u003E= 2 && addressStr.substr(0, 2) == \"0x\")\n            {\n                startPos = 2; \u002F\u002F Skip \"0x\" prefix\n            }\n\n            address = reinterpret_cast\u003CLPVOID\u003E(std::stoull(addressStr.substr(startPos), 0, 16));\n        }\n        catch (const std::invalid_argument& ex)\n        {   std::cout \u003C\u003C \"Invalid input: \" \u003C\u003C ex.what() \u003C\u003C std::endl;\n            continue;\n        }\n        memread.Address = (DWORD64)address;\n        memread.ReadSize = 2;\n        DWORD bytes;\n        std::cout \u003C\u003C std::endl;\n\n        if (!DeviceIoControl(hDevice, IOCTL_ReadDriverMemory, &memread,sizeof(memread), &memread,sizeof(memread), &bytes, nullptr))\n            return Error(\"failed in DeviceIoControl\");\n\n        printf(\"First  bytes at location 0x%p: 0x%X\\n\",(LPVOID)memread.Address, memread.Value);\n\n    }\n \n return 0;\n\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"cpp"},"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_94":{"__typename":"Paragraph","id":"69c64e89e99e_94","name":"67ac","type":"P","href":null,"layout":null,"metadata":null,"text":"When executing the user application, users can now specify an arbitrary address in the kernel virtual address space and get back the bytes at that specific location. This could form the basis of an offensive driver that for example enumerates PPL protection.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*hOzrwXOcoPLxogmM0CkwbQ.png":{"__typename":"ImageMetadata","id":"1*hOzrwXOcoPLxogmM0CkwbQ.png","originalHeight":65,"originalWidth":602,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:69c64e89e99e_95":{"__typename":"Paragraph","id":"69c64e89e99e_95","name":"86c4","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*hOzrwXOcoPLxogmM0CkwbQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*JvYn4I1aI6O8O5JNouF-sA.png":{"__typename":"ImageMetadata","id":"1*JvYn4I1aI6O8O5JNouF-sA.png","originalHeight":88,"originalWidth":602,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:69c64e89e99e_96":{"__typename":"Paragraph","id":"69c64e89e99e_96","name":"e6ea","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*JvYn4I1aI6O8O5JNouF-sA.png"},"text":"Figure 9: Interaction with the IOCTL driver","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_97":{"__typename":"Paragraph","id":"69c64e89e99e_97","name":"715a","type":"H3","href":null,"layout":null,"metadata":null,"text":"Conclusion","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_98":{"__typename":"Paragraph","id":"69c64e89e99e_98","name":"5085","type":"P","href":null,"layout":null,"metadata":null,"text":"This article provides a basic understanding of how userland programs interact with kernel. With this understanding comes comprehension of potential attack paths, development of offensive drivers, or even research into exploitation of kernel driver vulnerabilities.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_99":{"__typename":"Paragraph","id":"69c64e89e99e_99","name":"c5ee","type":"H3","href":null,"layout":null,"metadata":null,"text":"What’s Next?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_100":{"__typename":"Paragraph","id":"69c64e89e99e_100","name":"f215","type":"P","href":null,"layout":null,"metadata":null,"text":"An in-depth whitepaper will be published soon, walking through finding and exploiting kernel driver vulnerabilities. Stay tuned.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_101":{"__typename":"Paragraph","id":"69c64e89e99e_101","name":"556c","type":"H3","href":null,"layout":null,"metadata":null,"text":"Further reading","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_102":{"__typename":"Paragraph","id":"69c64e89e99e_102","name":"b2ab","type":"P","href":null,"layout":null,"metadata":null,"text":"Some interesting references in case you can’t wait to start your kernel exploitation journey:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_103":{"__typename":"Paragraph","id":"69c64e89e99e_103","name":"7a87","type":"ULI","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fvoidsec.com\u002Fwindows-drivers-reverse-engineering-methodology\u002F#driver-buddy-reloaded","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":90,"href":"https:\u002F\u002Fvoidsec.com\u002Fwindows-drivers-reverse-engineering-methodology\u002F#driver-buddy-reloaded","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_104":{"__typename":"Paragraph","id":"69c64e89e99e_104","name":"040d","type":"ULI","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Falice.climent-pommeret.red\u002Fposts\u002Fprocess-killer-driver\u002F","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":63,"href":"https:\u002F\u002Falice.climent-pommeret.red\u002Fposts\u002Fprocess-killer-driver\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_105":{"__typename":"Paragraph","id":"69c64e89e99e_105","name":"bcab","type":"H3","href":null,"layout":null,"metadata":null,"text":"About the Author","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_106":{"__typename":"Paragraph","id":"69c64e89e99e_106","name":"625a","type":"P","href":null,"layout":null,"metadata":null,"text":"Jean-Francois Maes is a Red Teamer and researcher currently working with Neuvik Solution’s Advanced Assessments team. On top of his work with Neuvik, he is also a SANS author and instructor for the SEC565: Red Team Operations and SEC699: Purple Team Tactics courses.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_107":{"__typename":"Paragraph","id":"69c64e89e99e_107","name":"0225","type":"P","href":null,"layout":null,"metadata":null,"text":"You can find Jean on social media here:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_108":{"__typename":"Paragraph","id":"69c64e89e99e_108","name":"97e9","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Twitter: https:\u002F\u002Ftwitter.com\u002Fjean_maes_1994","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":9,"end":43,"href":"https:\u002F\u002Ftwitter.com\u002Fjean_maes_1994","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_109":{"__typename":"Paragraph","id":"69c64e89e99e_109","name":"a519","type":"ULI","href":null,"layout":null,"metadata":null,"text":"LinkedIn: https:\u002F\u002Fwww.linkedin.com\u002Fin\u002Fjean-francois-maes\u002F","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":10,"end":57,"href":"https:\u002F\u002Fwww.linkedin.com\u002Fin\u002Fjean-francois-maes\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_110":{"__typename":"Paragraph","id":"69c64e89e99e_110","name":"8d2f","type":"P","href":null,"layout":null,"metadata":null,"text":"You can learn more about Neuvik here:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_111":{"__typename":"Paragraph","id":"69c64e89e99e_111","name":"90d9","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Website: Neuvik | Cybersecurity Expertise","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":9,"end":41,"href":"https:\u002F\u002Fwww.neuvik.com\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_112":{"__typename":"Paragraph","id":"69c64e89e99e_112","name":"a1ef","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Twitter: https:\u002F\u002Ftwitter.com\u002FNeuvik","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":9,"end":35,"href":"https:\u002F\u002Ftwitter.com\u002FNeuvik","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:69c64e89e99e_113":{"__typename":"Paragraph","id":"69c64e89e99e_113","name":"1c78","type":"ULI","href":null,"layout":null,"metadata":null,"text":"LinkedIn: https:\u002F\u002Fwww.linkedin.com\u002Fcompany\u002Fneuvik-solutions\u002F","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":10,"end":60,"href":"https:\u002F\u002Fwww.linkedin.com\u002Fcompany\u002Fneuvik-solutions\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"CollectionViewerEdge:collectionId:7385dc8da6d2-viewerId:lo_7f7941ed61ce":{"__typename":"CollectionViewerEdge","id":"collectionId:7385dc8da6d2-viewerId:lo_7f7941ed61ce","isEditor":false,"isMuting":false},"ImageMetadata:1*lif7rzCQb8w9-u3vOHVkUA.png":{"__typename":"ImageMetadata","id":"1*lif7rzCQb8w9-u3vOHVkUA.png","originalWidth":6452,"originalHeight":1900},"Tag:kernel-exploit":{"__typename":"Tag","id":"kernel-exploit","displayTitle":"Kernel Exploit","normalizedTagSlug":"kernel-exploit"},"Tag:tutorial":{"__typename":"Tag","id":"tutorial","displayTitle":"Tutorial","normalizedTagSlug":"tutorial"},"Tag:pentesting":{"__typename":"Tag","id":"pentesting","displayTitle":"Pentesting","normalizedTagSlug":"pentesting"},"Post:fff72116ca33":{"__typename":"Post","id":"fff72116ca33","collection":{"__ref":"Collection:7385dc8da6d2"},"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"117b","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"0936","startIndex":4,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"9e9b","startIndex":21,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"b422","startIndex":40,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"df36","startIndex":61,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"605b","startIndex":97,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"e565","startIndex":101,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"4e73","startIndex":105,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:69c64e89e99e_0"},{"__ref":"Paragraph:69c64e89e99e_1"},{"__ref":"Paragraph:69c64e89e99e_2"},{"__ref":"Paragraph:69c64e89e99e_3"},{"__ref":"Paragraph:69c64e89e99e_4"},{"__ref":"Paragraph:69c64e89e99e_5"},{"__ref":"Paragraph:69c64e89e99e_6"},{"__ref":"Paragraph:69c64e89e99e_7"},{"__ref":"Paragraph:69c64e89e99e_8"},{"__ref":"Paragraph:69c64e89e99e_9"},{"__ref":"Paragraph:69c64e89e99e_10"},{"__ref":"Paragraph:69c64e89e99e_11"},{"__ref":"Paragraph:69c64e89e99e_12"},{"__ref":"Paragraph:69c64e89e99e_13"},{"__ref":"Paragraph:69c64e89e99e_14"},{"__ref":"Paragraph:69c64e89e99e_15"},{"__ref":"Paragraph:69c64e89e99e_16"},{"__ref":"Paragraph:69c64e89e99e_17"},{"__ref":"Paragraph:69c64e89e99e_18"},{"__ref":"Paragraph:69c64e89e99e_19"},{"__ref":"Paragraph:69c64e89e99e_20"},{"__ref":"Paragraph:69c64e89e99e_21"},{"__ref":"Paragraph:69c64e89e99e_22"},{"__ref":"Paragraph:69c64e89e99e_23"},{"__ref":"Paragraph:69c64e89e99e_24"},{"__ref":"Paragraph:69c64e89e99e_25"},{"__ref":"Paragraph:69c64e89e99e_26"},{"__ref":"Paragraph:69c64e89e99e_27"},{"__ref":"Paragraph:69c64e89e99e_28"},{"__ref":"Paragraph:69c64e89e99e_29"},{"__ref":"Paragraph:69c64e89e99e_30"},{"__ref":"Paragraph:69c64e89e99e_31"},{"__ref":"Paragraph:69c64e89e99e_32"},{"__ref":"Paragraph:69c64e89e99e_33"},{"__ref":"Paragraph:69c64e89e99e_34"},{"__ref":"Paragraph:69c64e89e99e_35"},{"__ref":"Paragraph:69c64e89e99e_36"},{"__ref":"Paragraph:69c64e89e99e_37"},{"__ref":"Paragraph:69c64e89e99e_38"},{"__ref":"Paragraph:69c64e89e99e_39"},{"__ref":"Paragraph:69c64e89e99e_40"},{"__ref":"Paragraph:69c64e89e99e_41"},{"__ref":"Paragraph:69c64e89e99e_42"},{"__ref":"Paragraph:69c64e89e99e_43"},{"__ref":"Paragraph:69c64e89e99e_44"},{"__ref":"Paragraph:69c64e89e99e_45"},{"__ref":"Paragraph:69c64e89e99e_46"},{"__ref":"Paragraph:69c64e89e99e_47"},{"__ref":"Paragraph:69c64e89e99e_48"},{"__ref":"Paragraph:69c64e89e99e_49"},{"__ref":"Paragraph:69c64e89e99e_50"},{"__ref":"Paragraph:69c64e89e99e_51"},{"__ref":"Paragraph:69c64e89e99e_52"},{"__ref":"Paragraph:69c64e89e99e_53"},{"__ref":"Paragraph:69c64e89e99e_54"},{"__ref":"Paragraph:69c64e89e99e_55"},{"__ref":"Paragraph:69c64e89e99e_56"},{"__ref":"Paragraph:69c64e89e99e_57"},{"__ref":"Paragraph:69c64e89e99e_58"},{"__ref":"Paragraph:69c64e89e99e_59"},{"__ref":"Paragraph:69c64e89e99e_60"},{"__ref":"Paragraph:69c64e89e99e_61"},{"__ref":"Paragraph:69c64e89e99e_62"},{"__ref":"Paragraph:69c64e89e99e_63"},{"__ref":"Paragraph:69c64e89e99e_64"},{"__ref":"Paragraph:69c64e89e99e_65"},{"__ref":"Paragraph:69c64e89e99e_66"},{"__ref":"Paragraph:69c64e89e99e_67"},{"__ref":"Paragraph:69c64e89e99e_68"},{"__ref":"Paragraph:69c64e89e99e_69"},{"__ref":"Paragraph:69c64e89e99e_70"},{"__ref":"Paragraph:69c64e89e99e_71"},{"__ref":"Paragraph:69c64e89e99e_72"},{"__ref":"Paragraph:69c64e89e99e_73"},{"__ref":"Paragraph:69c64e89e99e_74"},{"__ref":"Paragraph:69c64e89e99e_75"},{"__ref":"Paragraph:69c64e89e99e_76"},{"__ref":"Paragraph:69c64e89e99e_77"},{"__ref":"Paragraph:69c64e89e99e_78"},{"__ref":"Paragraph:69c64e89e99e_79"},{"__ref":"Paragraph:69c64e89e99e_80"},{"__ref":"Paragraph:69c64e89e99e_81"},{"__ref":"Paragraph:69c64e89e99e_82"},{"__ref":"Paragraph:69c64e89e99e_83"},{"__ref":"Paragraph:69c64e89e99e_84"},{"__ref":"Paragraph:69c64e89e99e_85"},{"__ref":"Paragraph:69c64e89e99e_86"},{"__ref":"Paragraph:69c64e89e99e_87"},{"__ref":"Paragraph:69c64e89e99e_88"},{"__ref":"Paragraph:69c64e89e99e_89"},{"__ref":"Paragraph:69c64e89e99e_90"},{"__ref":"Paragraph:69c64e89e99e_91"},{"__ref":"Paragraph:69c64e89e99e_92"},{"__ref":"Paragraph:69c64e89e99e_93"},{"__ref":"Paragraph:69c64e89e99e_94"},{"__ref":"Paragraph:69c64e89e99e_95"},{"__ref":"Paragraph:69c64e89e99e_96"},{"__ref":"Paragraph:69c64e89e99e_97"},{"__ref":"Paragraph:69c64e89e99e_98"},{"__ref":"Paragraph:69c64e89e99e_99"},{"__ref":"Paragraph:69c64e89e99e_100"},{"__ref":"Paragraph:69c64e89e99e_101"},{"__ref":"Paragraph:69c64e89e99e_102"},{"__ref":"Paragraph:69c64e89e99e_103"},{"__ref":"Paragraph:69c64e89e99e_104"},{"__ref":"Paragraph:69c64e89e99e_105"},{"__ref":"Paragraph:69c64e89e99e_106"},{"__ref":"Paragraph:69c64e89e99e_107"},{"__ref":"Paragraph:69c64e89e99e_108"},{"__ref":"Paragraph:69c64e89e99e_109"},{"__ref":"Paragraph:69c64e89e99e_110"},{"__ref":"Paragraph:69c64e89e99e_111"},{"__ref":"Paragraph:69c64e89e99e_112"},{"__ref":"Paragraph:69c64e89e99e_113"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:c6ea1883b294"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fblog.neuvik.com\u002Fjourney-into-windows-kernel-exploitation-the-basics-fff72116ca33","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"cybersecurity"},{"__typename":"Topic","slug":"programming"}],"isPublished":true,"latestPublishedVersion":"69c64e89e99e","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"createdAt":1692272221118,"firstPublishedAt":1692381365470,"latestPublishedAt":1698186566157,"clapCount":14,"allowResponses":true,"isLimitedState":false,"title":"Journey into Windows Kernel Exploitation: The Basics","isSeries":false,"sequence":null,"uniqueSlug":"journey-into-windows-kernel-exploitation-the-basics-fff72116ca33","socialTitle":"","socialDek":"","noIndex":null,"canonicalUrl":"","metaDescription":"","readingTime":16.451886792452832,"previewContent":{"__typename":"PreviewContent","subtitle":"This blogpost embarks on the initial stages of kernel exploitation. The content serves as an introduction, leading to an imminent and…"},"previewImage":{"__ref":"ImageMetadata:1*lOK_3N4qBrDcmiKlA9hjSw.jpeg"},"isShortform":false,"seoTitle":"","updatedAt":1698186566157,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:kernel-exploit"},{"__ref":"Tag:tutorial"},{"__ref":"Tag:pentesting"}],"isNewsletter":false,"statusForCollection":"APPROVED","pendingCollection":null,"detectedLanguage":"en","wordCount":4002,"layerCake":6}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.3cc5e3b6.js"></script><script src="https://cdn-client.medium.com/lite/static/js/2640.3217006c.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.7db0aaff.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.4ddbf12e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.2021fe63.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6068.e9093f2e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4398.db4d4378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7883.0e445e04.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9281.e9be8bce.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7111.b294e9da.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6481.362dec70.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8695.6f58679b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8978.4b110123.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3418.eb013b5a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3894.e3d01e2c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5514.32e692f6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5203.e7f058c5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7098.93054372.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8051.0a9d3f4b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8558.abbaadfd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1711.7605eb3e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8597.762eae49.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9174.b1b0f607.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8883.2f95bbf4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/705.e5898c57.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2911.d072adec.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8580.feeb2549.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6046.f9be485b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/500.d5389c14.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9408.22b56993.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6605.84e81b15.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6637.661bd7cf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7421.3f94f5ea.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/51.d8fb2684.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2133.c8ba56b1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.81dff084.chunk.js"></script><script>window.main();</script><script defer="" src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon="{&quot;rayId&quot;:&quot;89426e9b69bc411a&quot;,&quot;version&quot;:&quot;2024.4.1&quot;,&quot;token&quot;:&quot;0b5f665943484354a59c39c6833f7078&quot;}" crossorigin="anonymous"></script>
<div><div class="grecaptcha-badge" data-style="bottomright" style="width: 256px; height: 60px; display: block; transition: right 0.3s; position: fixed; bottom: 14px; right: -186px; box-shadow: gray 0px 0px 5px; border-radius: 2px; overflow: hidden;"><div class="grecaptcha-logo"><iframe title="reCAPTCHA" width="256" height="60" role="presentation" name="a-d5dib9nw7yy" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox allow-storage-access-by-user-activation" src="https://www.google.com/recaptcha/enterprise/anchor?ar=1&amp;k=6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp&amp;co=aHR0cHM6Ly9ibG9nLm5ldXZpay5jb206NDQz&amp;hl=pl&amp;v=TqxSU0dsOd2Q9IbI7CpFnJLD&amp;size=invisible&amp;cb=oocpllo451p6"></iframe></div><div class="grecaptcha-error"></div><textarea id="g-recaptcha-response-100000" name="g-recaptcha-response" class="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea></div><iframe style="display: none;"></iframe></div><div><div class="uh n xw xx tp xy xz ya yb yc yd ye yf yg yh cg bo ow yi yj lu yk yl"><div class="be b du z wr"><div class="ab co ym yn"><div class="l" role="alert">To make Medium work, we log user data. By using Medium, you agree to our <a class="af ag ah ai aj ak al am an ao ap yo yp qd" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9" rel="noopener follow" target="_blank">Privacy Policy</a>, including cookie policy.</div><div class="yq yr ys yt yu yv l yw jb yx"><div class="l fi n uy"><button class="af ag ah ai aj ak al am an ao ap yo yp yy yz ab" data-testid="close-button" aria-label="close"><svg width="19" height="19" viewBox="0 0 19 19" class="ep eo"><path d="M13.8 4.6L9.5 8.89 5.21 4.6l-.61.61 4.29 4.3-4.29 4.28.61.62 4.3-4.3 4.28 4.3.62-.62-4.3-4.29 4.3-4.29" fill-rule="evenodd"></path></svg></button></div></div></div></div></div></div></body></html>